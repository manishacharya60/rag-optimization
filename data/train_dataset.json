[
    {
        "id": "1",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define int long long\n\nsigned main(){\n\n\tint n;\n\n\tcin>>n;\n\n\tint count=0;\n\n\tint k=sqrt(n);\n\n\tint maxi=1;\n\n\tfor(int i=1; i<n; i++){\n\n\t\tfor(int j=2; j<n; j++){\n\n\t\t\tif(pow(i,j)<=n){\n\n\t\t\tcount=pow(i,j);\n\n\t\t\tmaxi=max(count,maxi);\n\n\t\t//\tcout<<i<<\" \"<<j<<\" \"<<maxi<<endl;\n\n\t\t}\n\n\t}}\n\n\tcout<<maxi;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main() {\n\n\tint n; cin >> n;\n\n\tint mx = 1;\n\n\tfor (int i = 2; i * i <= n; ++i) {\n\n\t\tint s = i;\n\n\t\twhile (s * i <= n)\n\n\t\t\ts *= i;\n\n\t\tmx = max(s, mx);\n\n\t}\n\n\tcout << mx;\n\n\treturn 0;\n\n}"
    },
    {
        "id": "2",
        "source_code": "#include <iostream>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <string>\n\n#include <cmath>\n\n\n\nusing namespace std;\n\n\n\nint main() {\n\n    \n\n    int X;\n\n    cin >> X;\n\n    \n\n    int ans=1;\n\n    \n\n    for(int b=1;b<=1000;b++){\n\n        for(int p=2;p<=10;p++){\n\n            if((pow(b,p)<=X)&&(pow(b,p)>=ans)){\n\n                ans = pow(b,p);\n\n            }\n\n        }\n\n    }\n\n    \n\n    cout << ans << endl;\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <string>\n\n#include <cmath>\n\n#include <set>\n\n#include <sstream>\n\n#include <bitset>\n\n\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n\n#define REP(i,n)  FOR(i,0,n)\n\n\n\ntypedef long long ll;\n\n\n\nusing namespace std;\n\n\n\nint main() {\n\n    \n\n    int x;\n\n    cin >> x;\n\n    int ans=1;\n\n    FOR(b, 2, 32){\n\n        FOR(p, 2, 10){\n\n            if((pow(b, p)>ans)&&(pow(b, p)<=x)){\n\n                ans = pow(b, p);\n\n            }\n\n        }\n\n    }\n\n    \n\n    cout << ans << endl;\n\n    \n\n    \n\n    return 0;\n\n}\n"
    },
    {
        "id": "3",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#include <math.h>\n\n#include <iomanip>\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\n\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n\nconst int INF=1001001001;\n\nvector<pair<int64_t,int64_t>>prime_factorize(int64_t x){\n\n  vector<pair<int64_t,int64_t>>p;\n\n  for(int64_t i=2;i*i<=x;i++){\n\n    int cnt=0;\n\n    if(x%i==0){\n\n    while(x%i==0){cnt++;x/=i;}\n\n    p.push_back(make_pair(i,cnt));\n\n    }\n\n  }\n\n  if(x!=1){p.push_back(make_pair(x,1));}\n\n  return p; \n\n}\n\n\n\nint main() {\n\n  int X;\n\n  cin>>X;\n\n  int ans=1;\n\n  for(int b=1;b<=X;b++){\n\n    for(int p=2;p<=X;p++){\n\n      int s=pow(b,p);\n\n      if(s<=X){chmax(ans,s);}\n\n    }\n\n  }\n\n  cout<<ans<<endl;\n\n  return 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#include <math.h>\n\n#include <iomanip>\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\n\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n\n\n\nconst int mod=1e9+7;\n\nconst int INF=1001001001;\n\n\n\nint main() {\n\n  int x;\n\n  cin>>x;\n\n  int MAX=1;\n\n  for(int i=2;i*i<=x;i++){\n\n    int p=i;\n\n    while(p*i<=x){\n\n      p*=i;\n\n    }\n\n    chmax(MAX,p);\n\n  }\n\n  cout<<MAX<<endl;\n\n  return 0;  \n\n}"
    },
    {
        "id": "4",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std ;\n\n\n\nint main () {\n\n  int  N ;\n\n  cin >> N ;\n\n  int ans = 0 ;\n\n  for(int i = 1 ; i <= 1+N ; i++ ){\n\n    for(int j = 2 ; j <= 2+N ; j++ ){\n\n      int pre = pow(i,j) ;\n\n      if( pre <= N ) ans = max(ans,pre) ;\n\n    }\n\n  }\n\n  cout << ans << endl ;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std ;\n\n\n\nint main () {\n\n  int  N ;\n\n  cin >> N ;\n\n  int ans = 0 ;\n\n  for(int i = 1 ; i <= 1+N ; i++ ){\n\n    for(int j = 2 ; j <= 2+N ; j++ ){\n\n      int pre = pow(i,j) ;\n\n      if( pre <= N ) ans = max(ans,pre) ;\n\n      else break ;\n\n    }\n\n  }\n\n  cout << ans << endl ;\n\n}\n"
    },
    {
        "id": "5",
        "source_code": "/** author: __nishad__ **/\n\n\n\n#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\n\n\ntypedef long long ll ;\n\ntypedef vector<ll> vll ;\n\n\n\n#define IOS ios::sync_with_stdio(false); cin.tie(0); cout.tie(0);\n\n#define all(v) (v).begin(),(v).end()\n\n#define precision(k) cout<<setprecision(k)<<fixed;\n\n#define loop(i,a) for(int i=0; i<a;i++)\n\n#define loop2(i,a,b) for(int i=(a);i<=(b);++i)\n\n#define minv(v) *min_element(all(v))\n\n#define maxv(v) *max_element(all(v))\n\n#define getpos(v,x) (lower_bound(v.begin(),v.end(),x)-v.begin())\n\n#define unq(v) sort(all(v)),(v).erase(unique((v).begin(),(v).end()),(v).end())\n\n#define pb push_back\n\n#define pi 3.14159265358979323\n\n#define endl \"\\n\"\n\n\n\nint main()\n\n{\n\n    IOS;\n\n\n\n    ll x, i, j;\n\n    vll v;\n\n    cin>>x;\n\n\n\n    if(x == 1)\n\n        cout<<\"1\";\n\n    else{\n\n        for(i=1; i<=x; i++){\n\n            for(j=2; j<=x; j++){\n\n                if(pow(i, j) == int(pow(i, j)) && (pow(i, j) <= x)){\n\n                    v.pb(pow(i, j));\n\n                }\n\n            }\n\n        }\n\n        sort(all(v));\n\n\n\n        cout<<v[v.size()-1];\n\n    }\n\n\n\n\n\n\n\n}\n\n\n",
        "optimized_code": "/** author: __nishad__ **/\n\n\n\n#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\n\n\ntypedef long long ll ;\n\ntypedef vector<ll> vll ;\n\n\n\n#define IOS ios::sync_with_stdio(false); cin.tie(0); cout.tie(0);\n\n#define all(v) (v).begin(),(v).end()\n\n#define precision(k) cout<<setprecision(k)<<fixed;\n\n#define loop(i,a) for(int i=0; i<a;i++)\n\n#define loop2(i,a,b) for(int i=(a);i<=(b);++i)\n\n#define minv(v) *min_element(all(v))\n\n#define maxv(v) *max_element(all(v))\n\n#define getpos(v,x) (lower_bound(v.begin(),v.end(),x)-v.begin())\n\n#define unq(v) sort(all(v)),(v).erase(unique((v).begin(),(v).end()),(v).end())\n\n#define pb push_back\n\n#define pi 3.14159265358979323\n\n#define endl \"\\n\"\n\n\n\nint main()\n\n{\n\n    IOS;\n\n\n\n    ll x, i, j, p;\n\n    vll v;\n\n    cin>>x;\n\n\n\n    if(x == 1)\n\n        cout<<\"1\";\n\n    else{\n\n        for(i=1; i<=x; i++){\n\n            for(j=2; j<=x; j++){\n\n                p = pow(i, j);\n\n                if(p == int(p) && (p <= x)){\n\n                    v.pb(p);\n\n                }\n\n            }\n\n        }\n\n        sort(all(v));\n\n\n\n        cout<<v[v.size()-1];\n\n    }\n\n\n\n\n\n\n\n}\n\n\n"
    },
    {
        "id": "6",
        "source_code": "#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n\nusing P = pair<int, int>;\n\nconst int MOD = 1000000007;\n\n\n\nint main() {\n\n    int X;\n\n    cin >> X;\n\n    int maxValue = 1;\n\n    for (int i = 1; i <= X; i++) {  // O(N^2) -> 1000 * 1000 = 10^6\n\n        for (int j = 2; j <= X; j++) {\n\n            if (pow(i, j) <= X) {\n\n                maxValue = max(maxValue, (int)pow(i, j));\n\n            }\n\n        }\n\n    }\n\n\n\n    cout << maxValue << endl;\n\n\n\n    return 0;\n\n}\n",
        "optimized_code": "#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n\nusing P = pair<int, int>;\n\nconst int MOD = 1000000007;\n\n\n\nint main() {\n\n    int X;\n\n    cin >> X;\n\n    int maxValue = 1;\n\n    vector<bool> expo(X + 1);\n\n\n\n    expo[1] = true;\n\n    for (int i = 2; i <= X; i++) {\n\n        int tmp = i * i;\n\n        while (tmp <= X) {\n\n            expo[tmp] = true;\n\n            tmp *= i;\n\n        }\n\n    }\n\n\n\n    for (int i = X; 1 <= i; i--) {\n\n        if (expo[i]){\n\n            cout << i << endl;\n\n            break;\n\n        }\n\n    }\n\n\n\n    return 0;\n\n}\n"
    },
    {
        "id": "7",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main(){\n\n  int X;\n\n  cin >> X;\n\n  double ans=1;\n\n  for(int i=X;i>0;--i){\n\n    for(int j=1;j<=sqrt(X);++j){\n\n      for(int k=2;k<=10;++k){\n\n        if(pow(j,k)<=X) ans=max(ans,pow(j,k));\n\n      }\n\n    }\n\n  }\n\n  cout << ans << endl;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int,int> pii;\n\ntypedef pair<long long,long long> pll;\n\n#define ep emplace_back\n\n#define pb push_back\n\n#define mp make_pair\n\n#define rep(i,n) for(int i=0;i<(n);++i)\n\n#define all(v) v.begin(), v.end()\n\n#define revall(v) v.rbegin(), v.rend()\n\nconstexpr int mod=1000000007;\n\nconstexpr int mod1=998244353;\n\nvector<int> dx={0,1,0,-1},dy={-1,0,1,0};\n\nbool inside(int y,int x,int h,int w){ if(y<h && y>=0 && x<w && x>=0) return true; return false; }\n\ntemplate<class T> inline bool chmin(T& a, T b){ if(a > b){ a = b; return true; } return false; }\n\ntemplate<class T> inline bool chmax(T& a, T b){ if(a < b){ a = b; return true; } return false; }\n\n\n\n\n\n\n\n\n\n\n\n\n\nint main(){\n\n\tcin.tie(0);\n\n\tios::sync_with_stdio(false);\n\n\tint n;cin >> n;\n\n\tint ans = 1;\n\n\tfor(int i = 2; i * i <= n; i++){\n\n\t\tint t = i;\n\n\t\tfor(int j = 2; j < n; j++){\n\n\t\t\tt *= i;\n\n\t\t\tif(t > n) break;\n\n\t\t\tans = max(ans, t);\n\n\t\t}\n\n\t}\n\n\tcout << ans << endl;\n\n}\n"
    },
    {
        "id": "8",
        "source_code": "#include<iostream>\n\n#include<vector>\n\n#include<algorithm>\n\n#include<cctype>\n\n#include<utility>\n\n#include<string>\n\n#include<cmath>\n\n\n\n#define REP(n) for(int i = 0;i < n;i++)\n\n#define LLREP(n) for(long long int  i = 0;i < n;i++)\n\ntypedef long long int ll;\n\nusing namespace std;\n\n#define MAX_A 100005\n\n\n\nint main(){\n\n\n\n    int x;\n\n    cin >> x;\n\n    int ans = 1;\n\n    for(int i =1;i <= x;i++){\n\n        for(int j = 2;j <= x;j++){\n\n            if(pow(i,j)<= x){\n\n                ans = max(ans,(int)pow(i,j));\n\n            }\n\n            \n\n        }\n\n        //cout << ans << endl;\n\n    }\n\n    cout << ans << endl;\n\n\n\n   \n\n    return 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<vector>\n\n#include<algorithm>\n\n#include<cmath>\n\nusing namespace std;\n\n\n\n\n\nint main() {\n\n\n\n\tint n;\n\n\tcin >> n;\n\n\n\n\tint ans = 1;\n\n\n\n\tfor (int i = 2; i <= n; i++) {\n\n\n\n\t\tint num = i;\n\n\t\tif (i*i > n)\n\n\t\t{\n\n\t\t\tbreak;\n\n\t\t}\n\n\t\twhile (num * i <= n) {\n\n\t\t\tnum *= i;\n\n\t\t}\n\n\t\tans = max(ans, num);\n\n\t}\n\n\tcout << ans << endl;\n\n\treturn 0;\n\n}"
    },
    {
        "id": "9",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef unsigned long long ull;\n\n\n\nint mypow(int n, int p) {\n\n    if (p == 0) return 1;\n\n    else if (p & 1) {\n\n        return n * mypow(n, p - 1);\n\n    } else {\n\n        int half = mypow(n, p >> 1);\n\n        return half * half;\n\n    }\n\n}\n\n\n\nint main() {\n\n    int x;\n\n    cin >> x;\n\n    int ans = 1;\n\n    for (int j = 1; j <= x; ++j) {\n\n        for (int i = 2; i <= x; ++i) {\n\n            int tmp = mypow(j, i);\n\n            if (tmp <= x) ans = max(tmp, ans);\n\n        }\n\n    }\n\n    cout << ans << endl;\n\n    return 0;\n\n}\n\n\n\nstatic int speedUp = []() {\n\n    ios::sync_with_stdio(false);\n\n    cin.tie(nullptr);\n\n    cout.tie(nullptr);\n\n    return 0;\n\n}();",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef unsigned long long ull;\n\n\n\nint mypow(int n, int p) {\n\n    if (p == 0) return 1;\n\n    else if (p & 1) {\n\n        return n * mypow(n, p - 1);\n\n    } else {\n\n        int half = mypow(n, p >> 1);\n\n        return half * half;\n\n    }\n\n}\n\n\n\nint main() {\n\n    int x;\n\n    cin >> x;\n\n    int ans = 1;\n\n    for (int j = 2; j <= sqrt(x); ++j) {\n\n        int tmp = j;\n\n        int cnt = 0;\n\n        while (tmp < x) {\n\n            tmp *= j;\n\n            ++cnt;\n\n        }\n\n        if (tmp == x) ++cnt;\n\n        else tmp /= j;\n\n        if (cnt >= 2)\n\n            ans = max(tmp, ans);\n\n    }\n\n    cout << ans << endl;\n\n    return 0;\n\n}\n\n\n\nstatic int speedUp = []() {\n\n    ios::sync_with_stdio(false);\n\n    cin.tie(nullptr);\n\n    cout.tie(nullptr);\n\n    return 0;\n\n}();"
    },
    {
        "id": "10",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <math.h>\n\nusing namespace std;\n\nbool isPrime(int n)\n\n{\n\n\tif (n < 2)return false;\n\n\tfor (int i = 2; i < n; i++)\n\n\t{\n\n\t\tif (n % i == 0)return false;\n\n\t}\n\n}\n\nint gcd(int a, int b)\n\n{\n\n\tfor (int i = min(a, b); i >= 2; i--)\n\n\t{\n\n\t\tif (a % i == 0 && b % i == 0) return i;\n\n\t}\n\n\treturn 1;\n\n}\n\nint main()\n\n{\n\n\tint X;\n\n\tcin >> X;\n\n\tint ans = 1;\n\n\tfor (int b = X; b > 1; b--)\n\n\t{\n\n\t\tfor (int p = 2; p <= X; p++)\n\n\t\t{\n\n\t\t\tint t = pow(b, p);\n\n\t\t\tif (t <= X)\n\n\t\t\t{\n\n\t\t\t\tans = max(t, ans);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcout << ans << endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <math.h>\n\nusing namespace std;\n\nbool isPrime(int n)\n\n{\n\n\tif (n < 2)return false;\n\n\tfor (int i = 2; i < n; i++)\n\n\t{\n\n\t\tif (n % i == 0)return false;\n\n\t}\n\n}\n\nint gcd(int a, int b)\n\n{\n\n\tfor (int i = min(a, b); i >= 2; i--)\n\n\t{\n\n\t\tif (a % i == 0 && b % i == 0) return i;\n\n\t}\n\n\treturn 1;\n\n}\n\nint main()\n\n{\n\n\tint X;\n\n\tcin >> X;\n\n\tint ans = 1;\n\n\tfor (int b = X; b > 1; b--)\n\n\t{\n\n\t\tfor (int p = 2; p <= X; p++)\n\n\t\t{\n\n\t\t\tint t = pow(b, p);\n\n\t\t\tif (t <= X)\n\n\t\t\t{\n\n\t\t\t\tans = max(t, ans);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcout << ans << endl;\n\n\treturn 0;\n\n}"
    },
    {
        "id": "11",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint f[4][4];\n\nint main()\n\n{\n\n    int a,b,c;\n\n    scanf(\"%d%d%d\",&f[1][1],&f[1][2],&f[2][2]);\n\n    a=f[2][2]*3;\n\n    f[1][3]=a-f[1][1]-f[1][2];\n\n    f[3][1]=a-f[1][3]-f[2][2];\n\n    f[3][3]=a-f[1][1]-f[2][2];\n\n    f[2][1]=a-f[1][1]-f[3][1];\n\n    f[2][3]=a-f[2][1]-f[2][2];\n\n    f[3][2]=a-f[1][2]-f[2][2];\n\n    for(int i=1;i<=3;i++)\n\n    {\n\n        for(int j=1;j<=3;j++)\n\n        {\n\n            printf(\"%d \",f[i][j]);\n\n        }\n\n        printf(\"\\n\");\n\n    }\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint f[4][4];\n\nint main()\n\n{\n\n    int a,b,c;\n\n    scanf(\"%d%d%d\",&f[1][1],&f[1][2],&f[2][2]);//\u5148\u628a\u4f4d\u7f6e\u90fd\u653e\u597d\n\n    a=f[2][2]*3;//a\u8bb0\u5f55\u884c\uff0c\u5217\uff0c\u659c\u7ebf\u7684\u548c\u3002\u6211\u4eec\u77e5\u9053\uff0c\u8fd9\u79cd3*3\u7684\u65b9\u683c\u586b\u6570\u6bcf\u4e00\u884c\uff0c\u6bcf\u4e00\u5217\uff0c\u6bcf\u4e00\u659c\u7ebf\u7684\u548c\u90fd\u7b49\u4e8e\u4e2d\u95f4\u6570\u76843\u500d\n\n    f[1][3]=a-f[1][1]-f[1][2];\n\n    f[3][1]=a-f[1][3]-f[2][2];\n\n    f[3][3]=a-f[1][1]-f[2][2];\n\n    f[2][1]=a-f[1][1]-f[3][1];\n\n    f[2][3]=a-f[2][1]-f[2][2];\n\n    f[3][2]=a-f[1][2]-f[2][2];//\u8fd9\u4e00\u5927\u6bb5\u662f\u8ba1\u7b97\uff0c\u987a\u5e8f\u5f88\u91cd\u8981\n\n    for(int i=1;i<=3;i++)\n\n    {\n\n        for(int j=1;j<=3;j++)\n\n        {\n\n            printf(\"%d \",f[i][j]);//\u77e9\u9635\u8f93\u51fa\n\n        }\n\n        printf(\"\\n\");\n\n    }\n\n    return 0;\n\n}"
    },
    {
        "id": "12",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n\tint a[3][3],x,i;\n\n\tcin>>a[0][0]>>a[0][1]>>a[1][1];\n\n\tx=a[1][1]*3;\n\n\ta[0][2]=x-a[0][0]-a[0][1];\n\n\ta[2][1]=x-a[0][1]-a[1][1];\n\n\ta[2][2]=x-a[0][0]-a[1][1];\n\n\ta[2][0]=x-a[1][1]-a[0][2];\n\n\ta[1][0]=x-a[0][0]-a[2][0];\n\n\ta[1][2]=x-a[0][2]-a[2][2];\n\n\tfor(i=0;i<3;i++){\n\n\t\tcout<<a[i][0]<<\" \"<<a[i][1]<<\" \"<<a[i][2]<<endl;\n\n\t}\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint a,b,c;\n\nint main()\n\n{\n\n\tscanf(\"%d%d%d\",&a,&b,&c);\n\n\tprintf(\"%d %d %d\\n\",a,b,3*c-a-b);\n\n\tprintf(\"%d %d %d\\n\",(c<<2)-(a<<1)-b,c,(a<<1)+b-(c<<1));\n\n\tprintf(\"%d %d %d\\n\",a+b-c,(c<<1)-b,(c<<1)-a);\n\n\treturn 0 ;\n\n}"
    },
    {
        "id": "13",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n        int A,B,C;\n\n        cin>>A>>B>>C;\n\n        cout<<A<<' '<<B<<' '<<C*3-A-B<<endl<<4*C-2*A-B<<' '<<C<<' '<<2*A+B-2*C<<endl<<A+B-C<<' '<<C*2-B<<' '<<C*2-A;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint a,b,c;\n\nint main()\n\n{\n\n\tscanf(\"%d%d%d\",&a,&b,&c);\n\n\tprintf(\"%d %d %d\\n\",a,b,3*c-a-b);\n\n\tprintf(\"%d %d %d\\n\",(c<<2)-(a<<1)-b,c,(a<<1)+b-(c<<1));\n\n\tprintf(\"%d %d %d\\n\",a+b-c,(c<<1)-b,(c<<1)-a);\n\n\treturn 0 ;\n\n}"
    },
    {
        "id": "14",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main(){\n\n\n\n  int a,b,c,d,e,f,g,h,i;\n\n  \n\n  cin>>a>>b>>e;\n\n\n\n\n\n  for(int s=-(1e6);s<=(1e6);s++){\n\n\n\n    h=s-(b+e);\n\n\n\n    c=s-(a+b);\n\n\n\n    i=s-(a+e);\n\n\n\n    f=s-(c+i);\n\n\n\n    d=s-(e+f);\n\n\n\n    g=s-(c+e);\n\n\n\n    if(a+b+c==s&&d+e+f==s&&g+h+i==s&&a+d+g==s&&b+e+h==s&&c+f+i==s&&a+e+i==s&&c+e+g==s){\n\n\n\n      cout<<a<<' '<<b<<' '<<c<<endl;\n\n      \n\n      cout<<d<<' '<<e<<' '<<f<<endl;\n\n      \n\n      cout<<g<<' '<<h<<' '<<i<<endl;\n\n      \n\n      return 0;\n\n    }\n\n    \n\n  }\n\n  \n\n  return 0;\n\n}\n",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main(){\n\n\n\n  int a,b,c,d,e,f,g,h,i;\n\n  \n\n  cin>>a>>b>>e;\n\n\n\n\n\n  for(int s=-300;s<=300;s++){\n\n\n\n    h=s-(b+e);\n\n\n\n    c=s-(a+b);\n\n\n\n    i=s-(a+e);\n\n\n\n    f=s-(c+i);\n\n\n\n    d=s-(e+f);\n\n\n\n    g=s-(c+e);\n\n\n\n    if(a+b+c==s&&d+e+f==s&&g+h+i==s&&a+d+g==s&&b+e+h==s&&c+f+i==s&&a+e+i==s&&c+e+g==s){\n\n\n\n      cout<<a<<' '<<b<<' '<<c<<endl;\n\n      \n\n      cout<<d<<' '<<e<<' '<<f<<endl;\n\n      \n\n      cout<<g<<' '<<h<<' '<<i<<endl;\n\n      \n\n      return 0;\n\n    }\n\n    \n\n  }\n\n  \n\n  return 0;\n\n}\n"
    },
    {
        "id": "15",
        "source_code": "#include <cstdio>\n\n#include <cstring>\n\n#define MIN(A,B) ((A)<=(B)?(A):(B))\n\n#define MAX(A,B) ((A)>=(B)?(A):(B))\n\nint X,Y,Z,V[4],E[51],A[51];\n\ndouble dp[51][5001];\n\nint main() {\n\n\twhile(scanf(\"%d %d %d\",&X,&Y,&Z),X) {\n\n\t\tfor(int i=0;i<X;i++) {\n\n\t\t\tscanf(\"%d\",&V[i]);\n\n\t\t}\n\n\t\tmemset(E,0,sizeof(E));\n\n\t\tmemset(A,0,sizeof(A));\n\n\t\tfor(int i=0;i<Z;i++) {\n\n\t\t\tint n;\n\n\t\t\tscanf(\"%d\",&n);\n\n\t\t\tscanf(\"%d %d\",&E[n],&A[n]);\n\n\t\t}\n\n\t\tmemset(dp,0,sizeof(dp));\n\n\t\tdp[0][0]=1;\n\n\t\tfor(int i=0;i<Y;i++) {\n\n\t\t\tfor(int j=0;j<=5000;j++) {\n\n\t\t\t\tfor(int k=0;k<X;k++) {\n\n\t\t\t\t\tint next=MIN(Y,i+V[k]),money=j;\n\n\t\t\t\t\tif(E[next]==2) money+=A[next];\n\n\t\t\t\t\tif(E[next]==3) money=MAX(0,money-A[next]);\n\n\t\t\t\t\tif(E[next]==1) next=MIN(Y,next+A[next]);\n\n\t\t\t\t\tdp[next][money]+=dp[i][j]/X;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tdouble sum=0;\n\n\t\tfor(int i=0;i<=5000;i++) {\n\n\t\t\tsum+=i*dp[Y][i];\n\n\t\t}\n\n\t\tprintf(\"%d\\n\",(int)sum);\n\n\t}\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#define MIN(A,B) ((A)<=(B)?(A):(B))\n\n#define MAX(A,B) ((A)>=(B)?(A):(B))\n\nint X,Y,Z,V[4],E[51],A[51];\n\ndouble dp[51][5001];\n\nint main() {\n\n\twhile(scanf(\"%d %d %d\",&X,&Y,&Z),X) {\n\n\t\tfor(int i=0;i<X;i++) {\n\n\t\t\tscanf(\"%d\",&V[i]);\n\n\t\t}\n\n\t\tmemset(E,0,sizeof(E));\n\n\t\tmemset(A,0,sizeof(A));\n\n\t\tfor(int i=0;i<Z;i++) {\n\n\t\t\tint n;\n\n\t\t\tscanf(\"%d\",&n);\n\n\t\t\tscanf(\"%d %d\",&E[n],&A[n]);\n\n\t\t}\n\n\t\tmemset(dp,0,sizeof(dp));\n\n\t\tdp[0][0]=1;\n\n\t\tfor(int i=0;i<Y;i++) {\n\n\t\t\tfor(int j=0;j<=5000;j++) {\n\n\t\t\t\tif(dp[i][j]==0) continue;\n\n\t\t\t\tfor(int k=0;k<X;k++) {\n\n\t\t\t\t\tint next=MIN(Y,i+V[k]),money=j;\n\n\t\t\t\t\tif(E[next]==2) money+=A[next];\n\n\t\t\t\t\tif(E[next]==3) money=MAX(0,money-A[next]);\n\n\t\t\t\t\tif(E[next]==1) next=MIN(Y,next+A[next]);\n\n\t\t\t\t\tdp[next][money]+=dp[i][j]/X;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tdouble sum=0;\n\n\t\tfor(int i=0;i<=5000;i++) {\n\n\t\t\tsum+=i*dp[Y][i];\n\n\t\t}\n\n\t\tprintf(\"%d\\n\",(int)sum);\n\n\t}\n\n}"
    },
    {
        "id": "16",
        "source_code": "#include<iostream>\n\n#include<string>\n\n#include<algorithm>\n\n#include<cctype>\n\n#include<vector>\n\n#include<map>\n\n#include<iomanip>\n\nusing namespace std;\n\n#define fr first\n\n#define sc second\n\ntypedef pair<int,int> P;\n\nint main(){\n\n  int X,Y,Z,N,E,A;\n\n  while(cin >> X >> Y >> Z , X){\n\n    int jump[X];\n\n    P ivent[Y+1];\n\n    for(int i = 0 ; i <= Y ; i++ ) ivent[i] = P( 0 , 0 );\n\n    double dp[51][5001]={{}};\n\n    dp[0][0] = 1.0;\n\n\n\n    for(int i = 0 ; i < X ; i++ ){\n\n      cin >> jump[i];\n\n    }\n\n    for(int i = 0 ; i < Z ; i++ ){\n\n      cin >> N >> E >> A;\n\n      switch(E){\n\n      case 1: ivent[N].fr = A; break;\n\n      case 2: ivent[N].sc = A; break;\n\n      case 3: ivent[N].sc = -A; break;\n\n      }\n\n    }\n\n    for(int i = 0 , limit = 0 ; i < Y ; i++ , limit += 100 ){\n\n      for(int j = 0 ; j <= limit ; j++ ){\n\n        if(dp[i][j]){\n\n          for(int k = 0 , p_mas , p_money ; k < X ; k++ ){\n\n            p_mas = min( i + jump[k] , Y );\n\n            p_money = max(0,ivent[p_mas].sc + j );\n\n            p_mas = min( p_mas + ivent[p_mas].fr , Y );\n\n\n\n            dp[p_mas][p_money] += dp[i][j] / X;\n\n          }\n\n        }\n\n      }\n\n    }\n\n    double ans = 0.0;\n\n    for(int i = 0 ; i < 5001 ; i++ ){\n\n      ans += dp[Y][i] * i;\n\n    }\n\n    cout << (int)ans << endl;\n\n  }\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<string>\n\n#include<algorithm>\n\n#include<cctype>\n\n#include<vector>\n\n#include<map>\n\n#include<iomanip>\n\nusing namespace std;\n\n#define fr first\n\n#define sc second\n\ntypedef pair<int,int> P;\n\nint main(){\n\n  int X,Y,Z,N,E,A;\n\n  double dp[51][5001];\n\n  int jump[4];\n\n  P ivent[51];\n\n  while(cin >> X >> Y >> Z , X){\n\n    for(int i = 0 , limit = 0 ; i <= Y ; i++ , limit += 100 ){\n\n      ivent[i] = P( 0 , 0 );\n\n      for(int j = 0 ; j <= limit ; j++ ) dp[i][j] = 0.0;\n\n    }\n\n    dp[0][0] = 1.0;\n\n\n\n    for(int i = 0 ; i < X ; i++ ){\n\n      cin >> jump[i];\n\n    }\n\n    for(int i = 0 ; i < Z ; i++ ){\n\n      cin >> N >> E >> A;\n\n      switch(E){\n\n      case 1: ivent[N].fr = A; break;\n\n      case 2: ivent[N].sc = A; break;\n\n      case 3: ivent[N].sc = -A; break;\n\n      }\n\n    }\n\n    for(int i = 0 , limit = 0 ; i < Y ; i++ , limit += 100 ){\n\n      for(int j = 0 ; j <= limit ; j++ ){\n\n        if(dp[i][j]){\n\n          for(int k = 0 , p_mas , p_money ; k < X ; k++ ){\n\n            p_mas = min( i + jump[k] , Y );\n\n            p_money = max(0,ivent[p_mas].sc + j );\n\n            p_mas = min( p_mas + ivent[p_mas].fr , Y );\n\n\n\n            dp[p_mas][p_money] += dp[i][j] / X;\n\n          }\n\n        }\n\n      }\n\n    }\n\n    double ans = 0.0;\n\n    for(int i = 0 ; i < 5001 ; i++ ){\n\n      ans += dp[Y][i] * i;\n\n    }\n\n    cout << (int)ans << endl;\n\n  }\n\n}"
    },
    {
        "id": "17",
        "source_code": "#include <cstdio>\n\n#include <map>\n\n\n\n//#define scanf scanf_s\n\n\n\nconst int kMaxSquare = 64;\n\n\n\nint roulette[4];\n\n\n\ntypedef struct{\n\n\tint type;\n\n\tint value;\n\n} BoardState;\n\n\n\nBoardState board[kMaxSquare];\n\n\n\nint bp(int X, int Y){\n\n\tstd::map<int, double> bp[kMaxSquare];\n\n\tdouble prob = 1.0f / static_cast<double>(X);\n\n\n\n\tbp[0][0] = 1.0f;\n\n\tfor (int n = 0; n < Y; n++){\n\n\t\tfor (std::map<int, double>::iterator it = bp[n].begin(); it != bp[n].end(); it++){\n\n\t\t\tfor (int k = 0; k < X; k++){\n\n\t\t\t\tint pos = (n + roulette[k] < Y) ? n + roulette[k] : Y;\n\n\t\t\t\tif (board[pos].type == 1)\n\n\t\t\t\t\tbp[(pos + board[pos].value < Y) ? pos + board[pos].value : Y][it->first] \n\n\t\t\t\t\t\t+= it->second * prob;\n\n\t\t\t\telse if (board[pos].type == 2)\n\n\t\t\t\t\tbp[pos][it->first + board[pos].value] += it->second * prob;\n\n\t\t\t\telse if (board[pos].type == 3)\n\n\t\t\t\t\tbp[pos][(it->first - board[pos].value > 0) ? it->first - board[pos].value : 0] \n\n\t\t\t\t\t\t+= it->second * prob;\n\n\t\t\t\telse\n\n\t\t\t\t\tbp[pos][it->first] += it->second * prob;\t\t\t\t\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tdouble res = 0.0f;\n\n\tfor (std::map<int, double>::iterator it = bp[Y].begin(); it != bp[Y].end(); it++)\n\n\t\tres += static_cast<double>(it->first) * it->second;\n\n\treturn static_cast<int>(res);\n\n}\n\n\n\nint main(){\n\n\twhile (1){\n\n\t\tint X, Y, Z; //X:????????\u00ac?????????????????\u00b0, Y: ??????????????\u00b0(???: ????????????), Z: ???????????????????????\u00b0\n\n\t\tscanf(\"%d %d %d\", &X, &Y, &Z);\n\n\t\tif (X == 0) return 0;\n\n\t\tfor (int i = 0; i < X; i++)\n\n\t\t\tscanf(\"%d\", &roulette[i]);\n\n\t\tfor (int i = 0; i < kMaxSquare; i++)\n\n\t\t\tboard[i] = { 0, 0 };\n\n\t\tfor (; Z > 0; Z--){\n\n\t\t\tint N, E, A; //N: ?????????, E: ??????????\u00a8????, A: ??????????????\u00a7????????\u00b0 or ?\u00a2????????????????\n\n\t\t\tscanf(\"%d %d %d\", &N, &E, &A);\n\n\t\t\tboard[N] = { E, A };\n\n\t\t}\n\n\t\tprintf(\"%d\\n\", bp(X, Y));\n\n\t}\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n\n\n//#define scanf scanf_s\n\n\n\nconst int kMaxSquare = 64;\n\nconst int kMaxMoney = 5100;\n\nconst int kMaxGainMoney = 100;\n\n\n\nint roulette[4];\n\n\n\ntypedef struct{\n\n\tint type;\n\n\tint value;\n\n} BoardState;\n\n\n\nBoardState board[kMaxSquare];\n\n\n\nint bp(int X, int Y){\n\n\tfloat bp[kMaxSquare][kMaxMoney];\n\n\tfloat prob = 1.0f / static_cast<float>(X);\n\n\n\n  for(int n = 0; n <= Y; n++)\n\n    for(int m = 0; m <= Y*kMaxGainMoney; m++)\n\n      bp[n][m] = 0.0f;\n\n  bp[0][0] = 1.0f;\n\n\tfor (int n = 0; n < Y; n++){\n\n    for (int m = 0; m <= kMaxGainMoney * n; m++){\n\n      if(bp[n][m] == 0.0f) continue;\n\n\t\t\tfor (int k = 0; k < X; k++){\n\n        int pos = std::min(n+roulette[k], Y);\n\n\t\t\t\tif (board[pos].type == 1)\n\n          bp[std::min(pos + board[pos].value, Y)][m] += bp[n][m] * prob;\n\n\t\t\t\telse if (board[pos].type == 2)\n\n\t\t\t\t\tbp[pos][m + board[pos].value] += bp[n][m]* prob;\n\n\t\t\t\telse if (board[pos].type == 3)\n\n          bp[pos][std::max(m - board[pos].value, 0)] += bp[n][m] * prob;\n\n\t\t\t\telse\n\n\t\t\t\t\tbp[pos][m] += bp[n][m] * prob;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tfloat res = 0.0f;\n\n  for (int m = 0; m <= Y * kMaxGainMoney; m++)\n\n\t\tres += static_cast<float>(m) * bp[Y][m];\n\n\treturn static_cast<int>(res);\n\n}\n\n\n\nint main(){\n\n\twhile (1){\n\n\t\tint X, Y, Z;\n\n\t\tscanf(\"%d %d %d\", &X, &Y, &Z);\n\n\t\tif (X == 0) return 0;\n\n\t\tfor (int i = 0; i < X; i++)\n\n\t\t\tscanf(\"%d\", &roulette[i]);\n\n\t\tfor (int i = 0; i < kMaxSquare; i++)\n\n\t\t\tboard[i] = { 0, 0 };\n\n\t\tfor (; Z > 0; Z--){\n\n\t\t\tint N, E, A;\n\n\t\t\tscanf(\"%d %d %d\", &N, &E, &A);\n\n\t\t\tboard[N] = { E, A };\n\n\t\t}\n\n\t\tprintf(\"%d\\n\", bp(X, Y));\n\n\t}\n\n}"
    },
    {
        "id": "18",
        "source_code": "#include <cstdio>\n\n#include <map>\n\n\n\n//#define scanf scanf_s\n\n\n\nconst int kMaxSquare = 64;\n\n\n\nint roulette[4];\n\n\n\ntypedef struct{\n\n\tint type;\n\n\tint value;\n\n} BoardState;\n\n\n\nBoardState board[kMaxSquare];\n\n\n\nint bp(int X, int Y){\n\n\tstd::map<int, double> bp[kMaxSquare];\n\n\tdouble prob = 1.0f / static_cast<double>(X);\n\n\n\n\tbp[0][0] = 1.0f;\n\n\tfor (int n = 0; n < Y; n++){\n\n\t\tfor (std::map<int, double>::iterator it = bp[n].begin(); it != bp[n].end(); it++){\n\n\t\t\tfor (int k = 0; k < X; k++){\n\n\t\t\t\tint pos = (n + roulette[k] < Y) ? n + roulette[k] : Y;\n\n\t\t\t\tif (board[pos].type == 1)\n\n\t\t\t\t\tbp[(pos + board[pos].value < Y) ? pos + board[pos].value : Y][it->first] \n\n\t\t\t\t\t\t+= it->second * prob;\n\n\t\t\t\telse if (board[pos].type == 2)\n\n\t\t\t\t\tbp[pos][it->first + board[pos].value] += it->second * prob;\n\n\t\t\t\telse if (board[pos].type == 3)\n\n\t\t\t\t\tbp[pos][(it->first - board[pos].value > 0) ? it->first - board[pos].value : 0] \n\n\t\t\t\t\t\t+= it->second * prob;\n\n\t\t\t\telse\n\n\t\t\t\t\tbp[pos][it->first] += it->second * prob;\t\t\t\t\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tdouble res = 0.0f;\n\n\tfor (std::map<int, double>::iterator it = bp[Y].begin(); it != bp[Y].end(); it++)\n\n\t\tres += static_cast<double>(it->first) * it->second;\n\n\treturn static_cast<int>(res);\n\n}\n\n\n\nint main(){\n\n\twhile (1){\n\n\t\tint X, Y, Z; //X:????????\u00ac?????????????????\u00b0, Y: ??????????????\u00b0(???: ????????????), Z: ???????????????????????\u00b0\n\n\t\tscanf(\"%d %d %d\", &X, &Y, &Z);\n\n\t\tif (X == 0) return 0;\n\n\t\tfor (int i = 0; i < X; i++)\n\n\t\t\tscanf(\"%d\", &roulette[i]);\n\n\t\tfor (int i = 0; i < kMaxSquare; i++)\n\n\t\t\tboard[i] = { 0, 0 };\n\n\t\tfor (; Z > 0; Z--){\n\n\t\t\tint N, E, A; //N: ?????????, E: ??????????\u00a8????, A: ??????????????\u00a7????????\u00b0 or ?\u00a2????????????????\n\n\t\t\tscanf(\"%d %d %d\", &N, &E, &A);\n\n\t\t\tboard[N] = { E, A };\n\n\t\t}\n\n\t\tprintf(\"%d\\n\", bp(X, Y));\n\n\t}\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n\n\n//#define scanf scanf_s\n\n\n\nconst int kMaxSquare = 64;\n\nconst int kMaxMoney = 5100;\n\nconst int kMaxGainMoney = 100;\n\n\n\nint roulette[4];\n\n\n\ntypedef struct{\n\n\tint type;\n\n\tint value;\n\n} BoardState;\n\n\n\nBoardState board[kMaxSquare];\n\n\n\nint bp(int X, int Y){\n\n\tfloat bp[kMaxSquare][kMaxMoney];\n\n\tfloat prob = 1.0f / static_cast<float>(X);\n\n\n\n  for(int n = 0; n <= Y; n++)\n\n    for(int m = 0; m <= Y*kMaxGainMoney; m++)\n\n      bp[n][m] = 0.0f;\n\n  bp[0][0] = 1.0f;\n\n\tfor (int n = 0; n < Y; n++){\n\n    int mmax = n * kMaxGainMoney;\n\n    for (int m = 0; m <= mmax; m++){\n\n      if(bp[n][m] == 0.0f) continue;\n\n\t\t\tfor (int k = 0; k < X; k++){\n\n        int pos = std::min(n+roulette[k], Y);\n\n\t\t\t\tif (board[pos].type == 1)\n\n          bp[std::min(pos + board[pos].value, Y)][m] += bp[n][m] * prob;\n\n\t\t\t\telse if (board[pos].type == 2)\n\n\t\t\t\t\tbp[pos][m + board[pos].value] += bp[n][m]* prob;\n\n\t\t\t\telse if (board[pos].type == 3)\n\n          bp[pos][std::max(m - board[pos].value, 0)] += bp[n][m] * prob;\n\n\t\t\t\telse\n\n\t\t\t\t\tbp[pos][m] += bp[n][m] * prob;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tfloat res = 0.0f;\n\n  int mmax = Y * kMaxGainMoney;\n\n  for (int m = 0; m <= mmax; m++)\n\n\t\tres += static_cast<float>(m) * bp[Y][m];\n\n\treturn static_cast<int>(res);\n\n}\n\n\n\nint main(){\n\n\twhile (1){\n\n\t\tint X, Y, Z;\n\n\t\tscanf(\"%d %d %d\", &X, &Y, &Z);\n\n\t\tif (X == 0) return 0;\n\n\t\tfor (int i = 0; i < X; i++)\n\n\t\t\tscanf(\"%d\", &roulette[i]);\n\n\t\tfor (int i = 0; i < kMaxSquare; i++)\n\n\t\t\tboard[i] = { 0, 0 };\n\n\t\tfor (; Z > 0; Z--){\n\n\t\t\tint N, E, A;\n\n\t\t\tscanf(\"%d %d %d\", &N, &E, &A);\n\n\t\t\tboard[N] = { E, A };\n\n\t\t}\n\n\t\tprintf(\"%d\\n\", bp(X, Y));\n\n\t}\n\n}"
    },
    {
        "id": "19",
        "source_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <climits>\n\n#include <cfloat>\n\n#include <ctime>\n\n#include <map>\n\n#include <utility>\n\n#include <set>\n\n#include <iostream>\n\n#include <memory>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <sstream>\n\n#include <complex>\n\n#include <stack>\n\n#include <queue>\n\n#include <numeric>\n\n\n\nusing namespace std;\n\n\n\n#ifdef _MSC_VER\n\n#define __typeof__ decltype\n\n\n\ntemplate <class T>\n\nint __builtin_popcount(T n) { return n ? 1 + __builtin_popcount(n & (n - 1)) : 0; }\n\n#endif\n\n\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\n\n#define all(c) (c).begin(), (c).end()\n\n#define rall(c) (c).rbegin(), (c).rend()\n\n#define popcount __builtin_popcount\n\n\n\nconst double EPS = 1e-8;\n\ntypedef long long ll;\n\ntypedef pair<int, int> pint;\n\n\n\n\n\nint main()\n\n{\n\n\tint x, y, z;\n\n\twhile (scanf(\"%d%d%d\", &x, &y, &z), x|y|z)\n\n\t{\n\n\t\tdouble p = 1.0 / x;\n\n\t\tint v[4], e[51], a[51];\n\n\t\tfor (int i = 0; i < x; ++i)\n\n\t\t\tscanf(\"%d\", v + i);\n\n\t\tmemset(e, 0, sizeof(e));\n\n\t\tfor (int i = 0; i < z; ++i)\n\n\t\t{\n\n\t\t\tint t;\n\n\t\t\tscanf(\"%d\", &t);\n\n\t\t\tscanf(\"%d%d\", e + t, a + t);\n\n\t\t}\n\n\n\n\t\tstatic double dp[51][5001];\n\n\t\tfor (int i = 0; i <= y; ++i)\n\n\t\t\tfor (int j = 0; j <= 5000; ++j)\n\n\t\t\t\tdp[i][j] = 0;\n\n\t\tdp[0][0] = 1;\n\n\t\tfor (int i = 0; i < y; ++i)\n\n\t\t{\n\n\t\t\tfor (int j = 0; j <= 5000; ++j)\n\n\t\t\t{\n\n\t\t\t\tfor (int k = 0; k < x; ++k)\n\n\t\t\t\t{\n\n\t\t\t\t\tint to = min(y, i + v[k]);\n\n\t\t\t\t\tint money = j;\n\n\t\t\t\t\tif (e[to] == 1)\n\n\t\t\t\t\t\tto = min(y, to + a[to]);\n\n\t\t\t\t\telse if (e[to] == 2)\n\n\t\t\t\t\t\tmoney = min(5000, money + a[to]);\n\n\t\t\t\t\telse if (e[to] == 3)\n\n\t\t\t\t\t\tmoney = max(0, money - a[to]);\n\n\n\n\t\t\t\t\tdp[to][money] += dp[i][j] * p;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\tdouble res = 0;\n\n\t\tfor (int i = 0; i <= 5000; ++i)\n\n\t\t\tres += i * dp[y][i];\n\n\n\n\t\tprintf(\"%d\\n\", (int)res);\n\n\t}\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <climits>\n\n#include <cfloat>\n\n#include <ctime>\n\n#include <map>\n\n#include <utility>\n\n#include <set>\n\n#include <iostream>\n\n#include <memory>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <sstream>\n\n#include <complex>\n\n#include <stack>\n\n#include <queue>\n\n#include <numeric>\n\n\n\nusing namespace std;\n\n\n\n#ifdef _MSC_VER\n\n#define __typeof__ decltype\n\n\n\ntemplate <class T>\n\nint __builtin_popcount(T n) { return n ? 1 + __builtin_popcount(n & (n - 1)) : 0; }\n\n#endif\n\n\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\n\n#define all(c) (c).begin(), (c).end()\n\n#define rall(c) (c).rbegin(), (c).rend()\n\n#define popcount __builtin_popcount\n\n\n\nconst double EPS = 1e-8;\n\ntypedef long long ll;\n\ntypedef pair<int, int> pint;\n\n\n\n\n\nint main()\n\n{\n\n\tint x, y, z;\n\n\twhile (scanf(\"%d%d%d\", &x, &y, &z), x|y|z)\n\n\t{\n\n\t\tdouble p = 1.0 / x;\n\n\t\tint v[4], e[51], a[51];\n\n\t\tfor (int i = 0; i < x; ++i)\n\n\t\t\tscanf(\"%d\", v + i);\n\n\t\tmemset(e, 0, sizeof(e));\n\n\t\tfor (int i = 0; i < z; ++i)\n\n\t\t{\n\n\t\t\tint t;\n\n\t\t\tscanf(\"%d\", &t);\n\n\t\t\tscanf(\"%d%d\", e + t, a + t);\n\n\t\t}\n\n\n\n\t\tstatic double dp[51][5001];\n\n\t\tfor (int i = 0; i <= y; ++i)\n\n\t\t\tfor (int j = 0; j <= 5000; ++j)\n\n\t\t\t\tdp[i][j] = 0;\n\n\t\tdp[0][0] = 1;\n\n\t\tfor (int i = 0; i < y; ++i)\n\n\t\t{\n\n\t\t\tfor (int j = 0; j <= 5000; ++j)\n\n\t\t\t{\n\n\t\t\t\tif (dp[i][j] == 0)\n\n\t\t\t\t\tcontinue;\n\n\n\n\t\t\t\tfor (int k = 0; k < x; ++k)\n\n\t\t\t\t{\n\n\t\t\t\t\tint to = min(y, i + v[k]);\n\n\t\t\t\t\tint money = j;\n\n\t\t\t\t\tif (e[to] == 1)\n\n\t\t\t\t\t\tto = min(y, to + a[to]);\n\n\t\t\t\t\telse if (e[to] == 2)\n\n\t\t\t\t\t\tmoney = min(5000, money + a[to]);\n\n\t\t\t\t\telse if (e[to] == 3)\n\n\t\t\t\t\t\tmoney = max(0, money - a[to]);\n\n\n\n\t\t\t\t\tdp[to][money] += dp[i][j] * p;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\tdouble res = 0;\n\n\t\tfor (int i = 0; i <= 5000; ++i)\n\n\t\t\tres += i * dp[y][i];\n\n\n\n\t\tprintf(\"%d\\n\", (int)res);\n\n\t}\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "21",
        "source_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <climits>\n\n#include <cfloat>\n\n#include <ctime>\n\n#include <map>\n\n#include <utility>\n\n#include <set>\n\n#include <iostream>\n\n#include <memory>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <sstream>\n\n#include <complex>\n\n#include <stack>\n\n#include <queue>\n\n#include <numeric>\n\n\n\nusing namespace std;\n\n\n\n#ifdef _MSC_VER\n\n#define __typeof__ decltype\n\n\n\ntemplate <class T>\n\nint __builtin_popcount(T n) { return n ? 1 + __builtin_popcount(n & (n - 1)) : 0; }\n\n#endif\n\n\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\n\n#define all(c) (c).begin(), (c).end()\n\n#define rall(c) (c).rbegin(), (c).rend()\n\n#define popcount __builtin_popcount\n\n\n\nconst double EPS = 1e-8;\n\ntypedef long long ll;\n\ntypedef pair<int, int> pint;\n\n\n\n\n\nint main()\n\n{\n\n\tint x, y, z;\n\n\twhile (scanf(\"%d%d%d\", &x, &y, &z), x|y|z)\n\n\t{\n\n\t\tdouble p = 1.0 / x;\n\n\t\tint v[4], e[51], a[51];\n\n\t\tfor (int i = 0; i < x; ++i)\n\n\t\t\tscanf(\"%d\", v + i);\n\n\t\tmemset(e, 0, sizeof(e));\n\n\t\tfor (int i = 0; i < z; ++i)\n\n\t\t{\n\n\t\t\tint t;\n\n\t\t\tscanf(\"%d\", &t);\n\n\t\t\tscanf(\"%d%d\", e + t, a + t);\n\n\t\t}\n\n\n\n\t\tstatic double dp[51][5001];\n\n\t\tfor (int i = 0; i <= y; ++i)\n\n\t\t\tfor (int j = 0; j <= 5000; ++j)\n\n\t\t\t\tdp[i][j] = 0;\n\n\t\tdp[0][0] = 1;\n\n\t\tfor (int i = 0; i < y; ++i)\n\n\t\t{\n\n\t\t\tfor (int j = 0; j <= 5000; ++j)\n\n\t\t\t{\n\n\t\t\t\tfor (int k = 0; k < x; ++k)\n\n\t\t\t\t{\n\n\t\t\t\t\tint to = min(y, i + v[k]);\n\n\t\t\t\t\tint money = j;\n\n\t\t\t\t\tif (e[to] == 1)\n\n\t\t\t\t\t\tto = min(y, to + a[to]);\n\n\t\t\t\t\telse if (e[to] == 2)\n\n\t\t\t\t\t\tmoney = min(5000, money + a[to]);\n\n\t\t\t\t\telse if (e[to] == 3)\n\n\t\t\t\t\t\tmoney = max(0, money - a[to]);\n\n\n\n\t\t\t\t\tdp[to][money] += dp[i][j] * p;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\tdouble res = 0;\n\n\t\tfor (int i = 0; i <= 5000; ++i)\n\n\t\t\tres += i * dp[y][i];\n\n\n\n\t\tprintf(\"%d\\n\", (int)res);\n\n\t}\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <climits>\n\n#include <cfloat>\n\n#include <ctime>\n\n#include <map>\n\n#include <utility>\n\n#include <set>\n\n#include <iostream>\n\n#include <memory>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <sstream>\n\n#include <complex>\n\n#include <stack>\n\n#include <queue>\n\n#include <numeric>\n\n\n\nusing namespace std;\n\n\n\n#ifdef _MSC_VER\n\n#define __typeof__ decltype\n\n\n\ntemplate <class T>\n\nint __builtin_popcount(T n) { return n ? 1 + __builtin_popcount(n & (n - 1)) : 0; }\n\n#endif\n\n\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\n\n#define all(c) (c).begin(), (c).end()\n\n#define rall(c) (c).rbegin(), (c).rend()\n\n#define popcount __builtin_popcount\n\n\n\nconst double EPS = 1e-8;\n\ntypedef long long ll;\n\ntypedef pair<int, int> pint;\n\n\n\n\n\nint main()\n\n{\n\n\tint x, y, z;\n\n\twhile (scanf(\"%d%d%d\", &x, &y, &z), x|y|z)\n\n\t{\n\n\t\tfloat p = 1.0 / x;\n\n\t\tint v[4], e[51], a[51];\n\n\t\tfor (int i = 0; i < x; ++i)\n\n\t\t\tscanf(\"%d\", v + i);\n\n\t\tmemset(e, 0, sizeof(e));\n\n\t\tfor (int i = 0; i < z; ++i)\n\n\t\t{\n\n\t\t\tint t;\n\n\t\t\tscanf(\"%d\", &t);\n\n\t\t\tscanf(\"%d%d\", e + t, a + t);\n\n\t\t}\n\n\n\n\t\tstatic float dp[51][5001];\n\n\t\tfor (int i = 0; i <= y; ++i)\n\n\t\t\tfor (int j = 0; j <= 5000; ++j)\n\n\t\t\t\tdp[i][j] = 0;\n\n\t\tdp[0][0] = 1;\n\n\t\tfor (int i = 0; i < y; ++i)\n\n\t\t{\n\n\t\t\tfor (int j = 0; j <= 5000; ++j)\n\n\t\t\t{\n\n\t\t\t\tif (dp[i][j] == 0)\n\n\t\t\t\t\tcontinue;\n\n\n\n\t\t\t\tfor (int k = 0; k < x; ++k)\n\n\t\t\t\t{\n\n\t\t\t\t\tint to = min(y, i + v[k]);\n\n\t\t\t\t\tint money = j;\n\n\t\t\t\t\tif (e[to] == 1)\n\n\t\t\t\t\t\tto = min(y, to + a[to]);\n\n\t\t\t\t\telse if (e[to] == 2)\n\n\t\t\t\t\t\tmoney = min(5000, money + a[to]);\n\n\t\t\t\t\telse if (e[to] == 3)\n\n\t\t\t\t\t\tmoney = max(0, money - a[to]);\n\n\n\n\t\t\t\t\tdp[to][money] += dp[i][j] * p;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\tdouble res = 0;\n\n\t\tfor (int i = 0; i <= 5000; ++i)\n\n\t\t\tres += i * dp[y][i];\n\n\n\n\t\tprintf(\"%d\\n\", (int)res);\n\n\t}\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "22",
        "source_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <climits>\n\n#include <cfloat>\n\n#include <ctime>\n\n#include <map>\n\n#include <utility>\n\n#include <set>\n\n#include <iostream>\n\n#include <memory>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <sstream>\n\n#include <complex>\n\n#include <stack>\n\n#include <queue>\n\n#include <numeric>\n\n\n\nusing namespace std;\n\n\n\n#ifdef _MSC_VER\n\n#define __typeof__ decltype\n\n\n\ntemplate <class T>\n\nint __builtin_popcount(T n) { return n ? 1 + __builtin_popcount(n & (n - 1)) : 0; }\n\n#endif\n\n\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\n\n#define all(c) (c).begin(), (c).end()\n\n#define rall(c) (c).rbegin(), (c).rend()\n\n#define popcount __builtin_popcount\n\n\n\nconst double EPS = 1e-8;\n\ntypedef long long ll;\n\ntypedef pair<int, int> pint;\n\n\n\n\n\nint main()\n\n{\n\n\tint x, y, z;\n\n\twhile (scanf(\"%d%d%d\", &x, &y, &z), x|y|z)\n\n\t{\n\n\t\tdouble p = 1.0 / x;\n\n\t\tint v[4], e[51], a[51];\n\n\t\tfor (int i = 0; i < x; ++i)\n\n\t\t\tscanf(\"%d\", v + i);\n\n\t\tmemset(e, 0, sizeof(e));\n\n\t\tfor (int i = 0; i < z; ++i)\n\n\t\t{\n\n\t\t\tint t;\n\n\t\t\tscanf(\"%d\", &t);\n\n\t\t\tscanf(\"%d%d\", e + t, a + t);\n\n\t\t}\n\n\n\n\t\tstatic double dp[51][5001];\n\n\t\tfor (int i = 0; i <= y; ++i)\n\n\t\t\tfor (int j = 0; j <= 5000; ++j)\n\n\t\t\t\tdp[i][j] = 0;\n\n\t\tdp[0][0] = 1;\n\n\t\tfor (int i = 0; i < y; ++i)\n\n\t\t{\n\n\t\t\tfor (int j = 0; j <= 5000; ++j)\n\n\t\t\t{\n\n\t\t\t\tfor (int k = 0; k < x; ++k)\n\n\t\t\t\t{\n\n\t\t\t\t\tint to = min(y, i + v[k]);\n\n\t\t\t\t\tint money = j;\n\n\t\t\t\t\tif (e[to] == 1)\n\n\t\t\t\t\t\tto = min(y, to + a[to]);\n\n\t\t\t\t\telse if (e[to] == 2)\n\n\t\t\t\t\t\tmoney = min(5000, money + a[to]);\n\n\t\t\t\t\telse if (e[to] == 3)\n\n\t\t\t\t\t\tmoney = max(0, money - a[to]);\n\n\n\n\t\t\t\t\tdp[to][money] += dp[i][j] * p;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\tdouble res = 0;\n\n\t\tfor (int i = 0; i <= 5000; ++i)\n\n\t\t\tres += i * dp[y][i];\n\n\n\n\t\tprintf(\"%d\\n\", (int)res);\n\n\t}\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <climits>\n\n#include <cfloat>\n\n#include <ctime>\n\n#include <map>\n\n#include <utility>\n\n#include <set>\n\n#include <iostream>\n\n#include <memory>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <sstream>\n\n#include <complex>\n\n#include <stack>\n\n#include <queue>\n\n#include <numeric>\n\n\n\nusing namespace std;\n\n\n\n#ifdef _MSC_VER\n\n#define __typeof__ decltype\n\n\n\ntemplate <class T>\n\nint __builtin_popcount(T n) { return n ? 1 + __builtin_popcount(n & (n - 1)) : 0; }\n\n#endif\n\n\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\n\n#define all(c) (c).begin(), (c).end()\n\n#define rall(c) (c).rbegin(), (c).rend()\n\n#define popcount __builtin_popcount\n\n\n\nconst double EPS = 1e-8;\n\ntypedef long long ll;\n\ntypedef pair<int, int> pint;\n\n\n\n\n\nint main()\n\n{\n\n\tint x, y, z;\n\n\twhile (scanf(\"%d%d%d\", &x, &y, &z), x|y|z)\n\n\t{\n\n\t\tfloat p = 1.0 / x;\n\n\t\tint v[4], e[51], a[51];\n\n\t\tfor (int i = 0; i < x; ++i)\n\n\t\t\tscanf(\"%d\", v + i);\n\n\t\tmemset(e, 0, sizeof(e));\n\n\t\tfor (int i = 0; i < z; ++i)\n\n\t\t{\n\n\t\t\tint t;\n\n\t\t\tscanf(\"%d\", &t);\n\n\t\t\tscanf(\"%d%d\", e + t, a + t);\n\n\t\t}\n\n\t\tint max_money = 0;\n\n\t\tfor (int i = 0; i < y; ++i)\n\n\t\t\tif (e[i] == 2)\n\n\t\t\t\tmax_money += a[i];\n\n\n\n\t\tstatic float dp[51][5001];\n\n\t\tfor (int i = 0; i <= y; ++i)\n\n\t\t\tfor (int j = 0; j <= max_money; ++j)\n\n\t\t\t\tdp[i][j] = 0;\n\n\t\tdp[0][0] = 1;\n\n\t\tfor (int i = 0; i < y; ++i)\n\n\t\t{\n\n\t\t\tfor (int j = 0; j <= max_money; ++j)\n\n\t\t\t{\n\n\t\t\t\tif (dp[i][j] == 0)\n\n\t\t\t\t\tcontinue;\n\n\n\n\t\t\t\tfor (int k = 0; k < x; ++k)\n\n\t\t\t\t{\n\n\t\t\t\t\tint to = min(y, i + v[k]);\n\n\t\t\t\t\tint money = j;\n\n\t\t\t\t\tif (e[to] == 1)\n\n\t\t\t\t\t\tto = min(y, to + a[to]);\n\n\t\t\t\t\telse if (e[to] == 2)\n\n\t\t\t\t\t\tmoney += a[to];\n\n\t\t\t\t\telse if (e[to] == 3)\n\n\t\t\t\t\t\tmoney = max(0, money - a[to]);\n\n\n\n\t\t\t\t\tdp[to][money] += dp[i][j] * p;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\tfloat res = 0;\n\n\t\tfor (int i = 0; i <= max_money; ++i)\n\n\t\t\tres += i * dp[y][i];\n\n\n\n\t\tprintf(\"%d\\n\", (int)res);\n\n\t}\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "23",
        "source_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <climits>\n\n#include <cfloat>\n\n#include <ctime>\n\n#include <map>\n\n#include <utility>\n\n#include <set>\n\n#include <iostream>\n\n#include <memory>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <sstream>\n\n#include <complex>\n\n#include <stack>\n\n#include <queue>\n\n#include <numeric>\n\n\n\nusing namespace std;\n\n\n\n#ifdef _MSC_VER\n\n#define __typeof__ decltype\n\n\n\ntemplate <class T>\n\nint __builtin_popcount(T n) { return n ? 1 + __builtin_popcount(n & (n - 1)) : 0; }\n\n#endif\n\n\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\n\n#define all(c) (c).begin(), (c).end()\n\n#define rall(c) (c).rbegin(), (c).rend()\n\n#define popcount __builtin_popcount\n\n\n\nconst double EPS = 1e-8;\n\ntypedef long long ll;\n\ntypedef pair<int, int> pint;\n\n\n\n\n\nint main()\n\n{\n\n\tint x, y, z;\n\n\twhile (scanf(\"%d%d%d\", &x, &y, &z), x|y|z)\n\n\t{\n\n\t\tdouble p = 1.0 / x;\n\n\t\tint v[4], e[51], a[51];\n\n\t\tfor (int i = 0; i < x; ++i)\n\n\t\t\tscanf(\"%d\", v + i);\n\n\t\tmemset(e, 0, sizeof(e));\n\n\t\tfor (int i = 0; i < z; ++i)\n\n\t\t{\n\n\t\t\tint t;\n\n\t\t\tscanf(\"%d\", &t);\n\n\t\t\tscanf(\"%d%d\", e + t, a + t);\n\n\t\t}\n\n\n\n\t\tstatic double dp[51][5001];\n\n\t\tfor (int i = 0; i <= y; ++i)\n\n\t\t\tfor (int j = 0; j <= 5000; ++j)\n\n\t\t\t\tdp[i][j] = 0;\n\n\t\tdp[0][0] = 1;\n\n\t\tfor (int i = 0; i < y; ++i)\n\n\t\t{\n\n\t\t\tfor (int j = 0; j <= 5000; ++j)\n\n\t\t\t{\n\n\t\t\t\tif (dp[i][j] == 0)\n\n\t\t\t\t\tcontinue;\n\n\n\n\t\t\t\tfor (int k = 0; k < x; ++k)\n\n\t\t\t\t{\n\n\t\t\t\t\tint to = min(y, i + v[k]);\n\n\t\t\t\t\tint money = j;\n\n\t\t\t\t\tif (e[to] == 1)\n\n\t\t\t\t\t\tto = min(y, to + a[to]);\n\n\t\t\t\t\telse if (e[to] == 2)\n\n\t\t\t\t\t\tmoney = min(5000, money + a[to]);\n\n\t\t\t\t\telse if (e[to] == 3)\n\n\t\t\t\t\t\tmoney = max(0, money - a[to]);\n\n\n\n\t\t\t\t\tdp[to][money] += dp[i][j] * p;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\tdouble res = 0;\n\n\t\tfor (int i = 0; i <= 5000; ++i)\n\n\t\t\tres += i * dp[y][i];\n\n\n\n\t\tprintf(\"%d\\n\", (int)res);\n\n\t}\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <climits>\n\n#include <cfloat>\n\n#include <ctime>\n\n#include <map>\n\n#include <utility>\n\n#include <set>\n\n#include <iostream>\n\n#include <memory>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <sstream>\n\n#include <complex>\n\n#include <stack>\n\n#include <queue>\n\n#include <numeric>\n\n\n\nusing namespace std;\n\n\n\n#ifdef _MSC_VER\n\n#define __typeof__ decltype\n\n\n\ntemplate <class T>\n\nint __builtin_popcount(T n) { return n ? 1 + __builtin_popcount(n & (n - 1)) : 0; }\n\n#endif\n\n\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\n\n#define all(c) (c).begin(), (c).end()\n\n#define rall(c) (c).rbegin(), (c).rend()\n\n#define popcount __builtin_popcount\n\n\n\nconst double EPS = 1e-8;\n\ntypedef long long ll;\n\ntypedef pair<int, int> pint;\n\n\n\n\n\nint main()\n\n{\n\n\tint x, y, z;\n\n\twhile (scanf(\"%d%d%d\", &x, &y, &z), x|y|z)\n\n\t{\n\n\t\tfloat p = 1.0 / x;\n\n\t\tint v[4], e[51], a[51];\n\n\t\tfor (int i = 0; i < x; ++i)\n\n\t\t\tscanf(\"%d\", v + i);\n\n\t\tmemset(e, 0, sizeof(e));\n\n\t\tfor (int i = 0; i < z; ++i)\n\n\t\t{\n\n\t\t\tint t;\n\n\t\t\tscanf(\"%d\", &t);\n\n\t\t\tscanf(\"%d%d\", e + t, a + t);\n\n\t\t}\n\n\t\tint max_money = 0;\n\n\t\tfor (int i = 0; i < y; ++i)\n\n\t\t\tif (e[i] == 2)\n\n\t\t\t\tmax_money += a[i];\n\n\n\n\t\tstatic float dp[51][5001];\n\n\t\tfor (int i = 0; i <= y; ++i)\n\n\t\t\tfor (int j = 0; j <= max_money; ++j)\n\n\t\t\t\tdp[i][j] = 0;\n\n\t\tdp[0][0] = 1;\n\n\t\tfor (int i = 0; i < y; ++i)\n\n\t\t{\n\n\t\t\tfor (int j = 0; j <= max_money; ++j)\n\n\t\t\t{\n\n\t\t\t\tif (dp[i][j] == 0)\n\n\t\t\t\t\tcontinue;\n\n\n\n\t\t\t\tfor (int k = 0; k < x; ++k)\n\n\t\t\t\t{\n\n\t\t\t\t\tint to = min(y, i + v[k]);\n\n\t\t\t\t\tint money = j;\n\n\t\t\t\t\tif (e[to] == 1)\n\n\t\t\t\t\t\tto = min(y, to + a[to]);\n\n\t\t\t\t\telse if (e[to] == 2)\n\n\t\t\t\t\t\tmoney += a[to];\n\n\t\t\t\t\telse if (e[to] == 3)\n\n\t\t\t\t\t\tmoney = max(0, money - a[to]);\n\n\n\n\t\t\t\t\tdp[to][money] += dp[i][j] * p;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\tfloat res = 0;\n\n\t\tfor (int i = 0; i <= max_money; ++i)\n\n\t\t\tres += i * dp[y][i];\n\n\n\n\t\tprintf(\"%d\\n\", (int)res);\n\n\t}\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "24",
        "source_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <climits>\n\n#include <cfloat>\n\n#include <ctime>\n\n#include <map>\n\n#include <utility>\n\n#include <set>\n\n#include <iostream>\n\n#include <memory>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <sstream>\n\n#include <complex>\n\n#include <stack>\n\n#include <queue>\n\n#include <numeric>\n\n\n\nusing namespace std;\n\n\n\n#ifdef _MSC_VER\n\n#define __typeof__ decltype\n\n\n\ntemplate <class T>\n\nint __builtin_popcount(T n) { return n ? 1 + __builtin_popcount(n & (n - 1)) : 0; }\n\n#endif\n\n\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\n\n#define all(c) (c).begin(), (c).end()\n\n#define rall(c) (c).rbegin(), (c).rend()\n\n#define popcount __builtin_popcount\n\n\n\nconst double EPS = 1e-8;\n\ntypedef long long ll;\n\ntypedef pair<int, int> pint;\n\n\n\n\n\nint main()\n\n{\n\n\tint x, y, z;\n\n\twhile (scanf(\"%d%d%d\", &x, &y, &z), x|y|z)\n\n\t{\n\n\t\tfloat p = 1.0 / x;\n\n\t\tint v[4], e[51], a[51];\n\n\t\tfor (int i = 0; i < x; ++i)\n\n\t\t\tscanf(\"%d\", v + i);\n\n\t\tmemset(e, 0, sizeof(e));\n\n\t\tfor (int i = 0; i < z; ++i)\n\n\t\t{\n\n\t\t\tint t;\n\n\t\t\tscanf(\"%d\", &t);\n\n\t\t\tscanf(\"%d%d\", e + t, a + t);\n\n\t\t}\n\n\n\n\t\tstatic float dp[51][5001];\n\n\t\tfor (int i = 0; i <= y; ++i)\n\n\t\t\tfor (int j = 0; j <= 5000; ++j)\n\n\t\t\t\tdp[i][j] = 0;\n\n\t\tdp[0][0] = 1;\n\n\t\tfor (int i = 0; i < y; ++i)\n\n\t\t{\n\n\t\t\tfor (int j = 0; j <= 5000; ++j)\n\n\t\t\t{\n\n\t\t\t\tif (dp[i][j] == 0)\n\n\t\t\t\t\tcontinue;\n\n\n\n\t\t\t\tfor (int k = 0; k < x; ++k)\n\n\t\t\t\t{\n\n\t\t\t\t\tint to = min(y, i + v[k]);\n\n\t\t\t\t\tint money = j;\n\n\t\t\t\t\tif (e[to] == 1)\n\n\t\t\t\t\t\tto = min(y, to + a[to]);\n\n\t\t\t\t\telse if (e[to] == 2)\n\n\t\t\t\t\t\tmoney = min(5000, money + a[to]);\n\n\t\t\t\t\telse if (e[to] == 3)\n\n\t\t\t\t\t\tmoney = max(0, money - a[to]);\n\n\n\n\t\t\t\t\tdp[to][money] += dp[i][j] * p;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\tdouble res = 0;\n\n\t\tfor (int i = 0; i <= 5000; ++i)\n\n\t\t\tres += i * dp[y][i];\n\n\n\n\t\tprintf(\"%d\\n\", (int)res);\n\n\t}\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <climits>\n\n#include <cfloat>\n\n#include <ctime>\n\n#include <map>\n\n#include <utility>\n\n#include <set>\n\n#include <iostream>\n\n#include <memory>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <sstream>\n\n#include <complex>\n\n#include <stack>\n\n#include <queue>\n\n#include <numeric>\n\n\n\nusing namespace std;\n\n\n\n#ifdef _MSC_VER\n\n#define __typeof__ decltype\n\n\n\ntemplate <class T>\n\nint __builtin_popcount(T n) { return n ? 1 + __builtin_popcount(n & (n - 1)) : 0; }\n\n#endif\n\n\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\n\n#define all(c) (c).begin(), (c).end()\n\n#define rall(c) (c).rbegin(), (c).rend()\n\n#define popcount __builtin_popcount\n\n\n\nconst double EPS = 1e-8;\n\ntypedef long long ll;\n\ntypedef pair<int, int> pint;\n\n\n\n\n\nint main()\n\n{\n\n\tint x, y, z;\n\n\twhile (scanf(\"%d%d%d\", &x, &y, &z), x|y|z)\n\n\t{\n\n\t\tfloat p = 1.0 / x;\n\n\t\tint v[4], e[51], a[51];\n\n\t\tfor (int i = 0; i < x; ++i)\n\n\t\t\tscanf(\"%d\", v + i);\n\n\t\tmemset(e, 0, sizeof(e));\n\n\t\tfor (int i = 0; i < z; ++i)\n\n\t\t{\n\n\t\t\tint t;\n\n\t\t\tscanf(\"%d\", &t);\n\n\t\t\tscanf(\"%d%d\", e + t, a + t);\n\n\t\t}\n\n\t\tint max_money = 0;\n\n\t\tfor (int i = 0; i < y; ++i)\n\n\t\t\tif (e[i] == 2)\n\n\t\t\t\tmax_money += a[i];\n\n\n\n\t\tstatic float dp[51][5001];\n\n\t\tfor (int i = 0; i <= y; ++i)\n\n\t\t\tfor (int j = 0; j <= max_money; ++j)\n\n\t\t\t\tdp[i][j] = 0;\n\n\t\tdp[0][0] = 1;\n\n\t\tfor (int i = 0; i < y; ++i)\n\n\t\t{\n\n\t\t\tfor (int j = 0; j <= max_money; ++j)\n\n\t\t\t{\n\n\t\t\t\tif (dp[i][j] == 0)\n\n\t\t\t\t\tcontinue;\n\n\n\n\t\t\t\tfor (int k = 0; k < x; ++k)\n\n\t\t\t\t{\n\n\t\t\t\t\tint to = min(y, i + v[k]);\n\n\t\t\t\t\tint money = j;\n\n\t\t\t\t\tif (e[to] == 1)\n\n\t\t\t\t\t\tto = min(y, to + a[to]);\n\n\t\t\t\t\telse if (e[to] == 2)\n\n\t\t\t\t\t\tmoney += a[to];\n\n\t\t\t\t\telse if (e[to] == 3)\n\n\t\t\t\t\t\tmoney = max(0, money - a[to]);\n\n\n\n\t\t\t\t\tdp[to][money] += dp[i][j] * p;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\tfloat res = 0;\n\n\t\tfor (int i = 0; i <= max_money; ++i)\n\n\t\t\tres += i * dp[y][i];\n\n\n\n\t\tprintf(\"%d\\n\", (int)res);\n\n\t}\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "25",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\n#define FOR(i,e) for(int i=0;i<(int)(e);i++)\n\nusing namespace std;\n\n\n\nint main(){\n\n  double pb[100][5001];\n\n  int x,y,z;\n\n  int v[4],e[51],a[51];\n\n\n\n  while(cin >> x >> y >> z && (x||y||z)){\n\n\n\n    FOR(i,x)cin >> v[i];\n\n    FOR(i,y+1)e[i] = a[i] = 0;\n\n    FOR(i,z){\n\n      int n,m,l;\n\n      cin >> n >> m >> l;\n\n      e[n] = m; a[n] = l;\n\n    }\n\n\n\n    FOR(i,y+1)FOR(j,5001)pb[i][j] = 0.0;\n\n    pb[0][0] = 1.0;\n\n\n\n    FOR(i,y)FOR(j,5001){\n\n      FOR(k,x){\n\n\tif(pb[i][j] == 0.0)continue;\n\n\tint next = min(y,i+v[k]),value = j;\n\n\tif(e[next] == 1)next = min(y,next+a[next]);\n\n\telse if(e[next] == 2)value = j + a[next];\n\n\telse if(e[next] == 3)value = max(0,j-a[next]);\n\n\tpb[next][value] += pb[i][j]/x;\n\n      }\n\n    }\n\n\n\n    double ans = 0.0;\n\n    FOR(i,5001)ans += pb[y][i] * i;\n\n    cout << (int)(ans) << endl;\n\n  }\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\nusing namespace std;\n\n\n\nint main(){\n\n  double pb[100][5001];\n\n  int x,y,z,n,m,l,ub;\n\n  int v[4],e[51],a[51];\n\n\n\n  while(cin >> x >> y >> z && (x||y||z)){\n\n\n\n    for(int i=0;i<x;i++)cin >> v[i];\n\n    for(int i=0;i<=y;i++)e[i] = a[i] = 0;\n\n    ub = 0;\n\n    for(int i=0;i<z;i++){\n\n      cin >> n >> m >> l;\n\n      e[n] = m; a[n] = l;\n\n      if(m==2)ub += a[n];\n\n    }\n\n\n\n    for(int i=0;i<=y;i++)\n\n      for(int j=0;j<=ub;j++)pb[i][j] = 0.0;\n\n    pb[0][0] = 1.0;\n\n\n\n    for(int i=0;i<y;i++)\n\n      for(int j=0;j<=ub;j++){\n\n\tif(pb[i][j] == 0.0)continue;\n\n\tfor(int k=0;k<x;k++){\n\n\t  int next = min(y,i+v[k]),value = j;\n\n\t  if(e[next] == 1)next = min(y,next+a[next]);\n\n\t  else if(e[next] == 2)value = j + a[next];\n\n\t  else if(e[next] == 3)value = max(0,j-a[next]);\n\n\t  pb[next][value] += pb[i][j]/x;\n\n\t}\n\n      }\n\n    \n\n\n\n    double ans = 0.0;\n\n    for(int i=0;i<=ub;i++)ans += pb[y][i] * i;\n\n    cout << (int)(ans) << endl;\n\n  }\n\n}"
    },
    {
        "id": "26",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\n#define FOR(i,e) for(int i=0;i<(int)(e);i++)\n\nusing namespace std;\n\n\n\nint main(){\n\n  double pb[100][5001];\n\n  int x,y,z;\n\n  int v[4],e[51],a[51];\n\n\n\n  while(cin >> x >> y >> z && (x||y||z)){\n\n\n\n    FOR(i,x)cin >> v[i];\n\n    FOR(i,y+1)e[i] = a[i] = 0;\n\n    FOR(i,z){\n\n      int n,m,l;\n\n      cin >> n >> m >> l;\n\n      e[n] = m; a[n] = l;\n\n    }\n\n\n\n    FOR(i,y+1)FOR(j,5001)pb[i][j] = 0.0;\n\n    pb[0][0] = 1.0;\n\n\n\n    FOR(i,y)FOR(j,5001){\n\n      FOR(k,x){\n\n\tif(pb[i][j] == 0.0)continue;\n\n\tint next = min(y,i+v[k]),value = j;\n\n\tif(e[next] == 1)next = min(y,next+a[next]);\n\n\telse if(e[next] == 2)value = j + a[next];\n\n\telse if(e[next] == 3)value = max(0,j-a[next]);\n\n\tpb[next][value] += pb[i][j]/x;\n\n      }\n\n    }\n\n\n\n    double ans = 0.0;\n\n    FOR(i,5001)ans += pb[y][i] * i;\n\n    cout << (int)(ans) << endl;\n\n  }\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\n\n\nint main(){\n\n  double pb[100][5001];\n\n  int x,y,z,n,m,l,ub,i,j,k;\n\n  int v[4],e[51],a[51];\n\n\n\n  while(scanf(\"%d %d %d\",&x,&y,&z) && (x||y||z)){\n\n\n\n    for(i=0;i<x;i++)scanf(\"%d\",&v[i]);\n\n    for(i=0;i<=y;i++)e[i] = a[i] = 0;\n\n    ub = 0;\n\n    for(i=0;i<z;i++){\n\n      scanf(\"%d %d %d\",&n,&m,&l);\n\n      e[n] = m; a[n] = l;\n\n      if(m==2)ub += a[n];\n\n    }\n\n\n\n    for(i=0;i<=y;i++)\n\n      for(j=0;j<=ub;j++)pb[i][j] = 0.0;\n\n    pb[0][0] = 1.0;\n\n\n\n    for(i=0;i<y;i++)\n\n      for(j=0;j<=ub;j++){\n\n\tif(pb[i][j] == 0.0)continue;\n\n\tfor(k=0;k<x;k++){\n\n\t  n = min(y,i+v[k]),m = j;\n\n\t  if(e[n] == 1)n = min(y,n+a[n]);\n\n\t  else if(e[n] == 2)m = j + a[n];\n\n\t  else if(e[n] == 3)m = max(0,j-a[n]);\n\n\t  pb[n][m] += pb[i][j]/x;\n\n\t}\n\n      }\n\n    \n\n\n\n    double ans = 0.0;\n\n    for(i=0;i<=ub;i++)ans += pb[y][i] * i;\n\n    printf(\"%d\\n\",(int)ans);\n\n  }\n\n}"
    },
    {
        "id": "27",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\nusing namespace std;\n\n\n\nint main(){\n\n  double pb[100][5001];\n\n  int x,y,z,n,m,l,ub;\n\n  int v[4],e[51],a[51];\n\n\n\n  while(cin >> x >> y >> z && (x||y||z)){\n\n\n\n    for(int i=0;i<x;i++)cin >> v[i];\n\n    for(int i=0;i<=y;i++)e[i] = a[i] = 0;\n\n    ub = 0;\n\n    for(int i=0;i<z;i++){\n\n      cin >> n >> m >> l;\n\n      e[n] = m; a[n] = l;\n\n      if(m==2)ub += a[n];\n\n    }\n\n\n\n    for(int i=0;i<=y;i++)\n\n      for(int j=0;j<=ub;j++)pb[i][j] = 0.0;\n\n    pb[0][0] = 1.0;\n\n\n\n    for(int i=0;i<y;i++)\n\n      for(int j=0;j<=ub;j++){\n\n\tif(pb[i][j] == 0.0)continue;\n\n\tfor(int k=0;k<x;k++){\n\n\t  int next = min(y,i+v[k]),value = j;\n\n\t  if(e[next] == 1)next = min(y,next+a[next]);\n\n\t  else if(e[next] == 2)value = j + a[next];\n\n\t  else if(e[next] == 3)value = max(0,j-a[next]);\n\n\t  pb[next][value] += pb[i][j]/x;\n\n\t}\n\n      }\n\n    \n\n\n\n    double ans = 0.0;\n\n    for(int i=0;i<=ub;i++)ans += pb[y][i] * i;\n\n    cout << (int)(ans) << endl;\n\n  }\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\n\n\nint main(){\n\n  double pb[100][5001];\n\n  int x,y,z,n,m,l,ub,i,j,k;\n\n  int v[4],e[51],a[51];\n\n\n\n  while(scanf(\"%d %d %d\",&x,&y,&z) && (x||y||z)){\n\n\n\n    for(i=0;i<x;i++)scanf(\"%d\",&v[i]);\n\n    for(i=0;i<=y;i++)e[i] = a[i] = 0;\n\n    ub = 0;\n\n    for(i=0;i<z;i++){\n\n      scanf(\"%d %d %d\",&n,&m,&l);\n\n      e[n] = m; a[n] = l;\n\n      if(m==2)ub += a[n];\n\n    }\n\n\n\n    for(i=0;i<=y;i++)\n\n      for(j=0;j<=ub;j++)pb[i][j] = 0.0;\n\n    pb[0][0] = 1.0;\n\n\n\n    for(i=0;i<y;i++)\n\n      for(j=0;j<=ub;j++){\n\n\tif(pb[i][j] == 0.0)continue;\n\n\tfor(k=0;k<x;k++){\n\n\t  n = min(y,i+v[k]),m = j;\n\n\t  if(e[n] == 1)n = min(y,n+a[n]);\n\n\t  else if(e[n] == 2)m = j + a[n];\n\n\t  else if(e[n] == 3)m = max(0,j-a[n]);\n\n\t  pb[n][m] += pb[i][j]/x;\n\n\t}\n\n      }\n\n    \n\n\n\n    double ans = 0.0;\n\n    for(i=0;i<=ub;i++)ans += pb[y][i] * i;\n\n    printf(\"%d\\n\",(int)ans);\n\n  }\n\n}"
    },
    {
        "id": "28",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n\n#define REP(i,n) FOR(i,0,n)\n\n#define ALL(v) (v).begin(),(v).end()\n\n#define fi first\n\n#define se second\n\n\n\ntemplate<typename A, typename B> inline bool chmax(A &a, B b) { if (a<b) { a=b; return 1; } return 0; }\n\ntemplate<typename A, typename B> inline bool chmin(A &a, B b) { if (a>b) { a=b; return 1; } return 0; }\n\n\n\ntypedef long long ll;\n\ntypedef pair<int, int> pii;\n\ntypedef pair<ll, ll> pll;\n\ntypedef pair<int, pii> pip;\n\n\n\nconst ll INF = 1ll<<29;\n\nconst ll MOD = 1000000007;\n\nconst double EPS = 1e-5;\n\n\n\ndouble dp[51][10001]; // i, sum+5000 = ?\u00a2????\n\nint X, Y, Z;\n\nint V[4];\n\nvector<pii> g[51];\n\npii event[51];\n\n\n\nint main() {\n\n\twhile (cin >> X >> Y >> Z, X || Y || Z) {\n\n\t\tREP(i, X) scanf(\"%d\", V + i);\n\n\t\t\n\n\t\tfill(event, event + Y + 1, pii(0, 0));\n\n\t\tREP(i, Y + 1) g[i].clear();\n\n\t\t\n\n\t\tfill(dp[0], dp[Y + 1], 0);\n\n\t\t\n\n\t\tREP(i, Z) {\n\n\t\t\tint n, e, a;\n\n\t\t\tscanf(\"%d %d %d\", &n, &e, &a);\n\n\t\t\tif (e == 1) {\n\n\t\t\t\tevent[n] = pii(1, a);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tif (e == 3) a = -a;\n\n\t\t\t\tevent[n] = pii(2, a);\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tREP(i, Y) {\n\n\t\t\tREP(j, X) {\n\n\t\t\t\tint p = min(i + V[j], Y);\n\n\t\t\t\tint c = 0;\n\n\t\t\t\t\n\n\t\t\t\tif (event[p].fi == 1) p = min(p + event[p].se, Y);\n\n\t\t\t\telse if (event[p].fi == 2) c = event[p].se;\n\n\t\t\t\t\n\n\t\t\t\tg[i].push_back(pii(p, c));\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tdp[0][5000] = 1;\n\n\t\tREP(i, Y) {\n\n\t\t\tREP(j, 10001) {\n\n\t\t\t\tif (dp[i][j] == 0) continue;\n\n\t\t\t\t\n\n\t\t\t\tREP(k, g[i].size()) {\n\n\t\t\t\t\tint np = g[i][k].fi;\n\n\t\t\t\t\tint nc = max(j + g[i][k].se, 5000);\n\n\t\t\t\t\t\n\n\t\t\t\t\tdp[np][nc] += dp[i][j] / X;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tdouble ans = 0;\n\n\t\tFOR(i, 5000, 10001) if (dp[Y][i] != 0)\n\n\t\t\tans += (i - 5000) * dp[Y][i];\n\n\t\tans += EPS;\n\n\t\t\n\n\t\tprintf(\"%d\\n\", (int)ans);\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n\n#define REP(i,n) FOR(i,0,n)\n\n#define ALL(v) (v).begin(),(v).end()\n\n#define fi first\n\n#define se second\n\n\n\ntemplate<typename A, typename B> inline bool chmax(A &a, B b) { if (a<b) { a=b; return 1; } return 0; }\n\ntemplate<typename A, typename B> inline bool chmin(A &a, B b) { if (a>b) { a=b; return 1; } return 0; }\n\n\n\ntypedef long long ll;\n\ntypedef pair<int, int> pii;\n\ntypedef pair<ll, ll> pll;\n\ntypedef pair<int, pii> pip;\n\n\n\nconst ll INF = 1ll<<29;\n\nconst ll MOD = 1000000007;\n\nconst double EPS = 1e-5;\n\n\n\ndouble dp[51][5001]; // i, sum = ?\u00a2????\n\nint X, Y, Z;\n\nint V[4];\n\nvector<pii> g[51];\n\npii event[51];\n\n\n\nint main() {\n\n\twhile (cin >> X >> Y >> Z, X || Y || Z) {\n\n\t\tREP(i, X) scanf(\"%d\", V + i);\n\n\t\t\n\n\t\tfill(event, event + Y + 1, pii(0, 0));\n\n\t\tREP(i, Y + 1) g[i].clear();\n\n\t\t\n\n\t\tfill(dp[0], dp[Y + 1], 0);\n\n\t\t\n\n\t\tREP(i, Z) {\n\n\t\t\tint n, e, a;\n\n\t\t\tscanf(\"%d %d %d\", &n, &e, &a);\n\n\t\t\tif (e == 1) {\n\n\t\t\t\tevent[n] = pii(1, a);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tif (e == 3) a = -a;\n\n\t\t\t\tevent[n] = pii(2, a);\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tREP(i, Y) {\n\n\t\t\tREP(j, X) {\n\n\t\t\t\tint p = min(i + V[j], Y);\n\n\t\t\t\tint c = 0;\n\n\t\t\t\t\n\n\t\t\t\tif (event[p].fi == 1) p = min(p + event[p].se, Y);\n\n\t\t\t\telse if (event[p].fi == 2) c = event[p].se;\n\n\t\t\t\t\n\n\t\t\t\tg[i].push_back(pii(p, c));\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tdp[0][0] = 1;\n\n\t\tREP(i, Y) {\n\n\t\t\tREP(j, 5001) {\n\n\t\t\t\tif (dp[i][j] == 0) continue;\n\n\t\t\t\t\n\n\t\t\t\tREP(k, g[i].size()) {\n\n\t\t\t\t\tint np = g[i][k].fi;\n\n\t\t\t\t\tint nc = max(j + g[i][k].se, 0);\n\n\t\t\t\t\t\n\n\t\t\t\t\tdp[np][nc] += dp[i][j] / X;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tdouble ans = 0;\n\n\t\tREP(i, 5001) if (dp[Y][i] != 0)\n\n\t\t\tans += i * dp[Y][i];\n\n\t\tans += EPS;\n\n\t\t\n\n\t\tprintf(\"%d\\n\", (int)ans);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "29",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\ntemplate <typename T> constexpr T inf = numeric_limits<T>::has_infinity ? numeric_limits<T>::infinity() : numeric_limits<T>::max() / 4;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T, typename U> istream& operator>>(istream& is, pair<T, U>& a) { return is >> a.first >> a.second; }\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\nvoid LOG(const int& x) { cerr << x << \"\\n\"; }\n\nvoid LOG(const vector<int>& a) { for (int x : a) cerr << x << \" \"; cerr << \"\\n\"; }\n\ntemplate<typename T, std::size_t S> void LOG(const T (&a)[S]) { REP(i, S) cerr << a[i] << \" \"; cerr << \"\\n\"; }\n\ntemplate<typename T, std::size_t S, std::size_t R> void LOG(const T (&a)[S][R]) { REP(i, S) { REP(j, R) cerr << a[i][j] << \" \"; cerr << \"\\n\"; } }\n\n\n\nint ceil(int a, int b) { return (a - 1) / b + 1; }\n\ni64 gcd(i64 a, i64 b) { while (b != 0) { i64 t = b; b = a % b; a = t; } return a; }\n\ni64 lcm(i64 a, i64 b) { return a / gcd(a, b) * b; }\n\ni64 gcd(const vector<i64>& v) { return accumulate(ALL(v), 1LL, static_cast<i64(*)(i64, i64)>(gcd)); }\n\ni64 lcm(const vector<i64>& v) { return v.empty() ? 0LL : accumulate(v.begin() + 1, v.end(), v[0], static_cast<i64(*)(i64, i64)>(lcm)); }\n\ni64 pow(i64 x, i64 y, i64 z) { i64 a = 1; while (y > 0) { if (y & 1) a = a * x % z; x = x * x % z; y /= 2; } return a; }\n\ni64 inv(i64 x, i64 m) { return pow(x, m - 2, m); }\n\n\n\n#define COMP(key) [](const auto& a, const auto& b) { return a.key < b.key; }\n\n\n\nstruct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); cout << fixed << setprecision(10); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  vector<i64> ABC;\n\n  REP(u, x) {\n\n    REP(v, y) {\n\n      REP(w, z) {\n\n        if (u * v * w > k) break;\n\n        ABC.push_back(A[u] + B[v] + C[w]);\n\n      }\n\n    }\n\n  }\n\n  sort(ALL(ABC), greater<i64>());\n\n  REP(i, k) {\n\n    cout << ABC[i] << endl;\n\n  }\n\n}",
        "optimized_code": "// #include <bits/stdc++.h>\n\n#include <cstdio>\n\n#include <vector>\n\n#include <functional>\n\n#include <algorithm>\n\n#include <queue>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  for(;;) {\n\n    char c = getchar();\n\n    if ('0' <= c && c <= '9') {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nsigned main() {\n\n//  i32 x, y, z, k;\n\n//  scanf(\"%d%d%d%d\", &x, &y, &z, &k);\n\n  i32 x = read<i32>(),\n\n      y = read<i32>(),\n\n      z = read<i32>(),\n\n      k = read<i32>();\n\n  vector<i64> A(x), B(y), C(z);\n\n//  REP(i, x) scanf(\"%lld\", &A[i]);\n\n//  REP(i, y) scanf(\"%lld\", &B[i]);\n\n//  REP(i, z) scanf(\"%lld\", &C[i]);\n\n  REP(i, x) A[i] = read<i64>();\n\n  REP(i, y) B[i] = read<i64>();\n\n  REP(i, z) C[i] = read<i64>();\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using P = pair<i64, i64>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], 0});\n\n  set<i64> S;\n\n  S.insert(0);\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i64 q = Q.top().second;\n\n    Q.pop();\n\n    printf(\"%lld\\n\", p);\n\n    i32 u = q & 1023;\n\n    i32 v = q >> 10 & 1023;\n\n    i32 w = q >> 20 & 1023;\n\n    i64 u1 = q + 1;\n\n    i64 v1 = q + (1 << 10);\n\n    i64 w1 = q + (1 << 20);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}"
    },
    {
        "id": "30",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\nstruct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using T = tuple<i32, i32, i32>;\n\n  using P = pair<i64, T>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], make_tuple(0, 0, 0)});\n\n  set<T> S;\n\n  S.insert(make_tuple(0, 0, 0));\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i32 u, v, w;\n\n    tie(u, v, w) = Q.top().second;\n\n    Q.pop();\n\n    cout << p << endl;\n\n    auto u1 = make_tuple(u + 1, v, w);\n\n    auto v1 = make_tuple(u, v + 1, w);\n\n    auto w1 = make_tuple(u, v, w + 1);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}",
        "optimized_code": "// #include <bits/stdc++.h>\n\n#include <cstdio>\n\n#include <vector>\n\n#include <functional>\n\n#include <algorithm>\n\n#include <queue>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  for(;;) {\n\n    char c = getchar();\n\n    if ('0' <= c && c <= '9') {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nsigned main() {\n\n//  i32 x, y, z, k;\n\n//  scanf(\"%d%d%d%d\", &x, &y, &z, &k);\n\n  i32 x = read<i32>(),\n\n      y = read<i32>(),\n\n      z = read<i32>(),\n\n      k = read<i32>();\n\n  vector<i64> A(x), B(y), C(z);\n\n//  REP(i, x) scanf(\"%lld\", &A[i]);\n\n//  REP(i, y) scanf(\"%lld\", &B[i]);\n\n//  REP(i, z) scanf(\"%lld\", &C[i]);\n\n  REP(i, x) A[i] = read<i64>();\n\n  REP(i, y) B[i] = read<i64>();\n\n  REP(i, z) C[i] = read<i64>();\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using P = pair<i64, i64>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], 0});\n\n  set<i64> S;\n\n  S.insert(0);\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i64 q = Q.top().second;\n\n    Q.pop();\n\n    printf(\"%lld\\n\", p);\n\n    i32 u = q & 1023;\n\n    i32 v = q >> 10 & 1023;\n\n    i32 w = q >> 20 & 1023;\n\n    i64 u1 = q + 1;\n\n    i64 v1 = q + (1 << 10);\n\n    i64 w1 = q + (1 << 20);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}"
    },
    {
        "id": "31",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\n// struct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using T = tuple<i32, i32, i32>;\n\n  using P = pair<i64, T>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], make_tuple(0, 0, 0)});\n\n  set<T> S;\n\n  S.insert(make_tuple(0, 0, 0));\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i32 u, v, w;\n\n    tie(u, v, w) = Q.top().second;\n\n    Q.pop();\n\n    cout << p << endl;\n\n    auto u1 = make_tuple(u + 1, v, w);\n\n    auto v1 = make_tuple(u, v + 1, w);\n\n    auto w1 = make_tuple(u, v, w + 1);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}",
        "optimized_code": "// #include <bits/stdc++.h>\n\n#include <cstdio>\n\n#include <vector>\n\n#include <functional>\n\n#include <algorithm>\n\n#include <queue>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  for(;;) {\n\n    char c = getchar();\n\n    if ('0' <= c && c <= '9') {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nsigned main() {\n\n//  i32 x, y, z, k;\n\n//  scanf(\"%d%d%d%d\", &x, &y, &z, &k);\n\n  i32 x = read<i32>(),\n\n      y = read<i32>(),\n\n      z = read<i32>(),\n\n      k = read<i32>();\n\n  vector<i64> A(x), B(y), C(z);\n\n//  REP(i, x) scanf(\"%lld\", &A[i]);\n\n//  REP(i, y) scanf(\"%lld\", &B[i]);\n\n//  REP(i, z) scanf(\"%lld\", &C[i]);\n\n  REP(i, x) A[i] = read<i64>();\n\n  REP(i, y) B[i] = read<i64>();\n\n  REP(i, z) C[i] = read<i64>();\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using P = pair<i64, i64>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], 0});\n\n  set<i64> S;\n\n  S.insert(0);\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i64 q = Q.top().second;\n\n    Q.pop();\n\n    printf(\"%lld\\n\", p);\n\n    i32 u = q & 1023;\n\n    i32 v = q >> 10 & 1023;\n\n    i32 w = q >> 20 & 1023;\n\n    i64 u1 = q + 1;\n\n    i64 v1 = q + (1 << 10);\n\n    i64 w1 = q + (1 << 20);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}"
    },
    {
        "id": "32",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\ntemplate <typename T> constexpr T inf = numeric_limits<T>::has_infinity ? numeric_limits<T>::infinity() : numeric_limits<T>::max() / 4;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T, typename U> istream& operator>>(istream& is, pair<T, U>& a) { return is >> a.first >> a.second; }\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\nvoid LOG(const int& x) { cerr << x << \"\\n\"; }\n\nvoid LOG(const vector<int>& a) { for (int x : a) cerr << x << \" \"; cerr << \"\\n\"; }\n\ntemplate<typename T, std::size_t S> void LOG(const T (&a)[S]) { REP(i, S) cerr << a[i] << \" \"; cerr << \"\\n\"; }\n\ntemplate<typename T, std::size_t S, std::size_t R> void LOG(const T (&a)[S][R]) { REP(i, S) { REP(j, R) cerr << a[i][j] << \" \"; cerr << \"\\n\"; } }\n\n\n\nint ceil(int a, int b) { return (a - 1) / b + 1; }\n\ni64 gcd(i64 a, i64 b) { while (b != 0) { i64 t = b; b = a % b; a = t; } return a; }\n\ni64 lcm(i64 a, i64 b) { return a / gcd(a, b) * b; }\n\ni64 gcd(const vector<i64>& v) { return accumulate(ALL(v), 1LL, static_cast<i64(*)(i64, i64)>(gcd)); }\n\ni64 lcm(const vector<i64>& v) { return v.empty() ? 0LL : accumulate(v.begin() + 1, v.end(), v[0], static_cast<i64(*)(i64, i64)>(lcm)); }\n\ni64 pow(i64 x, i64 y, i64 z) { i64 a = 1; while (y > 0) { if (y & 1) a = a * x % z; x = x * x % z; y /= 2; } return a; }\n\ni64 inv(i64 x, i64 m) { return pow(x, m - 2, m); }\n\n\n\n#define COMP(key) [](const auto& a, const auto& b) { return a.key < b.key; }\n\n\n\nstruct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); cout << fixed << setprecision(10); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  vector<i64> AB(x * y);\n\n  REP(i, x) {\n\n    REP(j, y) {\n\n      AB[i * y + j] = A[i] + B[j];\n\n    }\n\n  }\n\n  sort(ALL(AB));\n\n  i32 w = min(k, x * y);\n\n  vector<i64> ABC(w * z);\n\n  REP(i, w) {\n\n    REP(j, z) {\n\n      ABC[i * z + j] = AB[AB.size() - i - 1] + C[j];\n\n    }\n\n  }\n\n  sort(ALL(ABC));\n\n  auto iter = ABC.end();\n\n  REP(_, k) {\n\n    iter--;\n\n    cout << *iter << endl;\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <vector>\n\n#include <functional>\n\n#include <algorithm>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  for(;;) {\n\n    char c = getchar();\n\n    if ('0' <= c && c <= '9') {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nsigned main() {\n\n//  i32 x, y, z, k;\n\n//  scanf(\"%d%d%d%d\", &x, &y, &z, &k);\n\n  i32 x = read<i32>(),\n\n      y = read<i32>(),\n\n      z = read<i32>(),\n\n      k = read<i32>();\n\n  vector<i64> A(x), B(y), C(z);\n\n//  REP(i, x) scanf(\"%lld\", &A[i]);\n\n//  REP(i, y) scanf(\"%lld\", &B[i]);\n\n//  REP(i, z) scanf(\"%lld\", &C[i]);\n\n  REP(i, x) A[i] = read<i64>();\n\n  REP(i, y) B[i] = read<i64>();\n\n  REP(i, z) C[i] = read<i64>();\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using P = pair<i64, i64>;\n\n  set<P> Q;\n\n  Q.insert({-(A[0] + B[0] + C[0]), 0});\n\n  REP(_, k) {\n\n    i64 p = -(*Q.begin()).first;\n\n    i64 q = (*Q.begin()).second;\n\n    printf(\"%lld\\n\", p);\n\n    Q.erase(Q.begin());\n\n    i32 u = q & 1023;\n\n    i32 v = q >> 10 & 1023;\n\n    i32 w = q >> 20 & 1023;\n\n    i64 u1 = q + 1;\n\n    i64 v1 = q + (1 << 10);\n\n    i64 w1 = q + (1 << 20);\n\n    if (u + 1 < x) Q.insert({-(A[u + 1] + B[v] + C[w]), u1});\n\n    if (v + 1 < y) Q.insert({-(A[u] + B[v + 1] + C[w]), v1});\n\n    if (w + 1 < z) Q.insert({-(A[u] + B[v] + C[w + 1]), w1});\n\n  }\n\n}"
    },
    {
        "id": "33",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\ntemplate <typename T> constexpr T inf = numeric_limits<T>::has_infinity ? numeric_limits<T>::infinity() : numeric_limits<T>::max() / 4;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T, typename U> istream& operator>>(istream& is, pair<T, U>& a) { return is >> a.first >> a.second; }\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\nvoid LOG(const int& x) { cerr << x << \"\\n\"; }\n\nvoid LOG(const vector<int>& a) { for (int x : a) cerr << x << \" \"; cerr << \"\\n\"; }\n\ntemplate<typename T, std::size_t S> void LOG(const T (&a)[S]) { REP(i, S) cerr << a[i] << \" \"; cerr << \"\\n\"; }\n\ntemplate<typename T, std::size_t S, std::size_t R> void LOG(const T (&a)[S][R]) { REP(i, S) { REP(j, R) cerr << a[i][j] << \" \"; cerr << \"\\n\"; } }\n\n\n\nint ceil(int a, int b) { return (a - 1) / b + 1; }\n\ni64 gcd(i64 a, i64 b) { while (b != 0) { i64 t = b; b = a % b; a = t; } return a; }\n\ni64 lcm(i64 a, i64 b) { return a / gcd(a, b) * b; }\n\ni64 gcd(const vector<i64>& v) { return accumulate(ALL(v), 1LL, static_cast<i64(*)(i64, i64)>(gcd)); }\n\ni64 lcm(const vector<i64>& v) { return v.empty() ? 0LL : accumulate(v.begin() + 1, v.end(), v[0], static_cast<i64(*)(i64, i64)>(lcm)); }\n\ni64 pow(i64 x, i64 y, i64 z) { i64 a = 1; while (y > 0) { if (y & 1) a = a * x % z; x = x * x % z; y /= 2; } return a; }\n\ni64 inv(i64 x, i64 m) { return pow(x, m - 2, m); }\n\n\n\n#define COMP(key) [](const auto& a, const auto& b) { return a.key < b.key; }\n\n\n\nstruct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); cout << fixed << setprecision(10); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  vector<i64> ABC;\n\n  REP(u, x) {\n\n    REP(v, y) {\n\n      REP(w, z) {\n\n        if (u * v * w > k) break;\n\n        ABC.push_back(A[u] + B[v] + C[w]);\n\n      }\n\n    }\n\n  }\n\n  sort(ALL(ABC), greater<i64>());\n\n  REP(i, k) {\n\n    cout << ABC[i] << endl;\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <vector>\n\n#include <functional>\n\n#include <algorithm>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  for(;;) {\n\n    char c = getchar();\n\n    if ('0' <= c && c <= '9') {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nsigned main() {\n\n//  i32 x, y, z, k;\n\n//  scanf(\"%d%d%d%d\", &x, &y, &z, &k);\n\n  i32 x = read<i32>(),\n\n      y = read<i32>(),\n\n      z = read<i32>(),\n\n      k = read<i32>();\n\n  vector<i64> A(x), B(y), C(z);\n\n//  REP(i, x) scanf(\"%lld\", &A[i]);\n\n//  REP(i, y) scanf(\"%lld\", &B[i]);\n\n//  REP(i, z) scanf(\"%lld\", &C[i]);\n\n  REP(i, x) A[i] = read<i64>();\n\n  REP(i, y) B[i] = read<i64>();\n\n  REP(i, z) C[i] = read<i64>();\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using P = pair<i64, i64>;\n\n  set<P> Q;\n\n  Q.insert({-(A[0] + B[0] + C[0]), 0});\n\n  REP(_, k) {\n\n    i64 p = -(*Q.begin()).first;\n\n    i64 q = (*Q.begin()).second;\n\n    printf(\"%lld\\n\", p);\n\n    Q.erase(Q.begin());\n\n    i32 u = q & 1023;\n\n    i32 v = q >> 10 & 1023;\n\n    i32 w = q >> 20 & 1023;\n\n    i64 u1 = q + 1;\n\n    i64 v1 = q + (1 << 10);\n\n    i64 w1 = q + (1 << 20);\n\n    if (u + 1 < x) Q.insert({-(A[u + 1] + B[v] + C[w]), u1});\n\n    if (v + 1 < y) Q.insert({-(A[u] + B[v + 1] + C[w]), v1});\n\n    if (w + 1 < z) Q.insert({-(A[u] + B[v] + C[w + 1]), w1});\n\n  }\n\n}"
    },
    {
        "id": "34",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\nstruct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using T = tuple<i32, i32, i32>;\n\n  using P = pair<i64, T>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], make_tuple(0, 0, 0)});\n\n  set<T> S;\n\n  S.insert(make_tuple(0, 0, 0));\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i32 u, v, w;\n\n    tie(u, v, w) = Q.top().second;\n\n    Q.pop();\n\n    cout << p << endl;\n\n    auto u1 = make_tuple(u + 1, v, w);\n\n    auto v1 = make_tuple(u, v + 1, w);\n\n    auto w1 = make_tuple(u, v, w + 1);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <vector>\n\n#include <functional>\n\n#include <algorithm>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  for(;;) {\n\n    char c = getchar();\n\n    if ('0' <= c && c <= '9') {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nsigned main() {\n\n//  i32 x, y, z, k;\n\n//  scanf(\"%d%d%d%d\", &x, &y, &z, &k);\n\n  i32 x = read<i32>(),\n\n      y = read<i32>(),\n\n      z = read<i32>(),\n\n      k = read<i32>();\n\n  vector<i64> A(x), B(y), C(z);\n\n//  REP(i, x) scanf(\"%lld\", &A[i]);\n\n//  REP(i, y) scanf(\"%lld\", &B[i]);\n\n//  REP(i, z) scanf(\"%lld\", &C[i]);\n\n  REP(i, x) A[i] = read<i64>();\n\n  REP(i, y) B[i] = read<i64>();\n\n  REP(i, z) C[i] = read<i64>();\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using P = pair<i64, i64>;\n\n  set<P> Q;\n\n  Q.insert({-(A[0] + B[0] + C[0]), 0});\n\n  REP(_, k) {\n\n    i64 p = -(*Q.begin()).first;\n\n    i64 q = (*Q.begin()).second;\n\n    printf(\"%lld\\n\", p);\n\n    Q.erase(Q.begin());\n\n    i32 u = q & 1023;\n\n    i32 v = q >> 10 & 1023;\n\n    i32 w = q >> 20 & 1023;\n\n    i64 u1 = q + 1;\n\n    i64 v1 = q + (1 << 10);\n\n    i64 w1 = q + (1 << 20);\n\n    if (u + 1 < x) Q.insert({-(A[u + 1] + B[v] + C[w]), u1});\n\n    if (v + 1 < y) Q.insert({-(A[u] + B[v + 1] + C[w]), v1});\n\n    if (w + 1 < z) Q.insert({-(A[u] + B[v] + C[w + 1]), w1});\n\n  }\n\n}"
    },
    {
        "id": "35",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\n// struct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using T = tuple<i32, i32, i32>;\n\n  using P = pair<i64, T>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], make_tuple(0, 0, 0)});\n\n  set<T> S;\n\n  S.insert(make_tuple(0, 0, 0));\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i32 u, v, w;\n\n    tie(u, v, w) = Q.top().second;\n\n    Q.pop();\n\n    cout << p << endl;\n\n    auto u1 = make_tuple(u + 1, v, w);\n\n    auto v1 = make_tuple(u, v + 1, w);\n\n    auto w1 = make_tuple(u, v, w + 1);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <vector>\n\n#include <functional>\n\n#include <algorithm>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  for(;;) {\n\n    char c = getchar();\n\n    if ('0' <= c && c <= '9') {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nsigned main() {\n\n//  i32 x, y, z, k;\n\n//  scanf(\"%d%d%d%d\", &x, &y, &z, &k);\n\n  i32 x = read<i32>(),\n\n      y = read<i32>(),\n\n      z = read<i32>(),\n\n      k = read<i32>();\n\n  vector<i64> A(x), B(y), C(z);\n\n//  REP(i, x) scanf(\"%lld\", &A[i]);\n\n//  REP(i, y) scanf(\"%lld\", &B[i]);\n\n//  REP(i, z) scanf(\"%lld\", &C[i]);\n\n  REP(i, x) A[i] = read<i64>();\n\n  REP(i, y) B[i] = read<i64>();\n\n  REP(i, z) C[i] = read<i64>();\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using P = pair<i64, i64>;\n\n  set<P> Q;\n\n  Q.insert({-(A[0] + B[0] + C[0]), 0});\n\n  REP(_, k) {\n\n    i64 p = -(*Q.begin()).first;\n\n    i64 q = (*Q.begin()).second;\n\n    printf(\"%lld\\n\", p);\n\n    Q.erase(Q.begin());\n\n    i32 u = q & 1023;\n\n    i32 v = q >> 10 & 1023;\n\n    i32 w = q >> 20 & 1023;\n\n    i64 u1 = q + 1;\n\n    i64 v1 = q + (1 << 10);\n\n    i64 w1 = q + (1 << 20);\n\n    if (u + 1 < x) Q.insert({-(A[u + 1] + B[v] + C[w]), u1});\n\n    if (v + 1 < y) Q.insert({-(A[u] + B[v + 1] + C[w]), v1});\n\n    if (w + 1 < z) Q.insert({-(A[u] + B[v] + C[w + 1]), w1});\n\n  }\n\n}"
    },
    {
        "id": "36",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\ntemplate <typename T> constexpr T inf = numeric_limits<T>::has_infinity ? numeric_limits<T>::infinity() : numeric_limits<T>::max() / 4;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T, typename U> istream& operator>>(istream& is, pair<T, U>& a) { return is >> a.first >> a.second; }\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\nvoid LOG(const int& x) { cerr << x << \"\\n\"; }\n\nvoid LOG(const vector<int>& a) { for (int x : a) cerr << x << \" \"; cerr << \"\\n\"; }\n\ntemplate<typename T, std::size_t S> void LOG(const T (&a)[S]) { REP(i, S) cerr << a[i] << \" \"; cerr << \"\\n\"; }\n\ntemplate<typename T, std::size_t S, std::size_t R> void LOG(const T (&a)[S][R]) { REP(i, S) { REP(j, R) cerr << a[i][j] << \" \"; cerr << \"\\n\"; } }\n\n\n\nint ceil(int a, int b) { return (a - 1) / b + 1; }\n\ni64 gcd(i64 a, i64 b) { while (b != 0) { i64 t = b; b = a % b; a = t; } return a; }\n\ni64 lcm(i64 a, i64 b) { return a / gcd(a, b) * b; }\n\ni64 gcd(const vector<i64>& v) { return accumulate(ALL(v), 1LL, static_cast<i64(*)(i64, i64)>(gcd)); }\n\ni64 lcm(const vector<i64>& v) { return v.empty() ? 0LL : accumulate(v.begin() + 1, v.end(), v[0], static_cast<i64(*)(i64, i64)>(lcm)); }\n\ni64 pow(i64 x, i64 y, i64 z) { i64 a = 1; while (y > 0) { if (y & 1) a = a * x % z; x = x * x % z; y /= 2; } return a; }\n\ni64 inv(i64 x, i64 m) { return pow(x, m - 2, m); }\n\n\n\n#define COMP(key) [](const auto& a, const auto& b) { return a.key < b.key; }\n\n\n\nstruct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); cout << fixed << setprecision(10); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  vector<i64> AB(x * y);\n\n  REP(i, x) {\n\n    REP(j, y) {\n\n      AB[i * y + j] = A[i] + B[j];\n\n    }\n\n  }\n\n  sort(ALL(AB));\n\n  i32 w = min(k, x * y);\n\n  vector<i64> ABC(w * z);\n\n  REP(i, w) {\n\n    REP(j, z) {\n\n      ABC[i * z + j] = AB[AB.size() - i - 1] + C[j];\n\n    }\n\n  }\n\n  sort(ALL(ABC));\n\n  auto iter = ABC.end();\n\n  REP(_, k) {\n\n    iter--;\n\n    cout << *iter << endl;\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i] = a % 10;\n\n    a = a / 10;\n\n    ++i;\n\n  }\n\n  while (i > 0) {\n\n    --i;\n\n    putchar_unlocked(buf[i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 AB[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = -read<i64>();\n\n  REP(i, Y) B[i] = -read<i64>();\n\n  REP(i, Z) C[i] = -read<i64>();\n\n  sort(A, A + X);\n\n  sort(B, B + Y);\n\n  sort(C, C + Z);\n\n  using P = pair<i64, i32>;\n\n  set<P> Q, R;\n\n  Q.insert({A[0] + B[0], 0});\n\n  i32 L = min(K, X * Y);\n\n  REP(i, L) {\n\n    i64 p = (*Q.begin()).first;\n\n    i64 q = (*Q.begin()).second;\n\n    AB[i] = p;\n\n    Q.erase(Q.begin());\n\n    i32 u = q >> 10;\n\n    i32 v = q & 1023;\n\n    if (u + 1 < X && (u + 1) * v < L) Q.insert({A[u + 1] + B[v], q + 1024});\n\n    if (v + 1 < Y && u * (v + 1) < L) Q.insert({A[u] + B[v + 1], q + 1});\n\n  }\n\n  R.insert({AB[0] + C[0], 0});\n\n  REP(_, K) {\n\n    i64 p = (*R.begin()).first;\n\n    i64 q = (*R.begin()).second;\n\n    // printf(\"%lld\\n\", -p);\n\n    writeln(-p);\n\n    R.erase(R.begin());\n\n    i32 u = q >> 10;\n\n    i32 v = q & 1023;\n\n    if (u + 1 < L && (u + 1) * v < K) R.insert({AB[u + 1] + C[v], q + 1024});\n\n    if (v + 1 < Z && u * (v + 1) < K) R.insert({AB[u] + C[v + 1], q + 1});\n\n  }\n\n}"
    },
    {
        "id": "37",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\ntemplate <typename T> constexpr T inf = numeric_limits<T>::has_infinity ? numeric_limits<T>::infinity() : numeric_limits<T>::max() / 4;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T, typename U> istream& operator>>(istream& is, pair<T, U>& a) { return is >> a.first >> a.second; }\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\nvoid LOG(const int& x) { cerr << x << \"\\n\"; }\n\nvoid LOG(const vector<int>& a) { for (int x : a) cerr << x << \" \"; cerr << \"\\n\"; }\n\ntemplate<typename T, std::size_t S> void LOG(const T (&a)[S]) { REP(i, S) cerr << a[i] << \" \"; cerr << \"\\n\"; }\n\ntemplate<typename T, std::size_t S, std::size_t R> void LOG(const T (&a)[S][R]) { REP(i, S) { REP(j, R) cerr << a[i][j] << \" \"; cerr << \"\\n\"; } }\n\n\n\nint ceil(int a, int b) { return (a - 1) / b + 1; }\n\ni64 gcd(i64 a, i64 b) { while (b != 0) { i64 t = b; b = a % b; a = t; } return a; }\n\ni64 lcm(i64 a, i64 b) { return a / gcd(a, b) * b; }\n\ni64 gcd(const vector<i64>& v) { return accumulate(ALL(v), 1LL, static_cast<i64(*)(i64, i64)>(gcd)); }\n\ni64 lcm(const vector<i64>& v) { return v.empty() ? 0LL : accumulate(v.begin() + 1, v.end(), v[0], static_cast<i64(*)(i64, i64)>(lcm)); }\n\ni64 pow(i64 x, i64 y, i64 z) { i64 a = 1; while (y > 0) { if (y & 1) a = a * x % z; x = x * x % z; y /= 2; } return a; }\n\ni64 inv(i64 x, i64 m) { return pow(x, m - 2, m); }\n\n\n\n#define COMP(key) [](const auto& a, const auto& b) { return a.key < b.key; }\n\n\n\nstruct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); cout << fixed << setprecision(10); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  vector<i64> ABC;\n\n  REP(u, x) {\n\n    REP(v, y) {\n\n      REP(w, z) {\n\n        if (u * v * w > k) break;\n\n        ABC.push_back(A[u] + B[v] + C[w]);\n\n      }\n\n    }\n\n  }\n\n  sort(ALL(ABC), greater<i64>());\n\n  REP(i, k) {\n\n    cout << ABC[i] << endl;\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i] = a % 10;\n\n    a = a / 10;\n\n    ++i;\n\n  }\n\n  while (i > 0) {\n\n    --i;\n\n    putchar_unlocked(buf[i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 AB[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = -read<i64>();\n\n  REP(i, Y) B[i] = -read<i64>();\n\n  REP(i, Z) C[i] = -read<i64>();\n\n  sort(A, A + X);\n\n  sort(B, B + Y);\n\n  sort(C, C + Z);\n\n  using P = pair<i64, i32>;\n\n  set<P> Q, R;\n\n  Q.insert({A[0] + B[0], 0});\n\n  i32 L = min(K, X * Y);\n\n  REP(i, L) {\n\n    i64 p = (*Q.begin()).first;\n\n    i64 q = (*Q.begin()).second;\n\n    AB[i] = p;\n\n    Q.erase(Q.begin());\n\n    i32 u = q >> 10;\n\n    i32 v = q & 1023;\n\n    if (u + 1 < X && (u + 1) * v < L) Q.insert({A[u + 1] + B[v], q + 1024});\n\n    if (v + 1 < Y && u * (v + 1) < L) Q.insert({A[u] + B[v + 1], q + 1});\n\n  }\n\n  R.insert({AB[0] + C[0], 0});\n\n  REP(_, K) {\n\n    i64 p = (*R.begin()).first;\n\n    i64 q = (*R.begin()).second;\n\n    // printf(\"%lld\\n\", -p);\n\n    writeln(-p);\n\n    R.erase(R.begin());\n\n    i32 u = q >> 10;\n\n    i32 v = q & 1023;\n\n    if (u + 1 < L && (u + 1) * v < K) R.insert({AB[u + 1] + C[v], q + 1024});\n\n    if (v + 1 < Z && u * (v + 1) < K) R.insert({AB[u] + C[v + 1], q + 1});\n\n  }\n\n}"
    },
    {
        "id": "38",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\nstruct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using T = tuple<i32, i32, i32>;\n\n  using P = pair<i64, T>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], make_tuple(0, 0, 0)});\n\n  set<T> S;\n\n  S.insert(make_tuple(0, 0, 0));\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i32 u, v, w;\n\n    tie(u, v, w) = Q.top().second;\n\n    Q.pop();\n\n    cout << p << endl;\n\n    auto u1 = make_tuple(u + 1, v, w);\n\n    auto v1 = make_tuple(u, v + 1, w);\n\n    auto w1 = make_tuple(u, v, w + 1);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i] = a % 10;\n\n    a = a / 10;\n\n    ++i;\n\n  }\n\n  while (i > 0) {\n\n    --i;\n\n    putchar_unlocked(buf[i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 AB[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = -read<i64>();\n\n  REP(i, Y) B[i] = -read<i64>();\n\n  REP(i, Z) C[i] = -read<i64>();\n\n  sort(A, A + X);\n\n  sort(B, B + Y);\n\n  sort(C, C + Z);\n\n  using P = pair<i64, i32>;\n\n  set<P> Q, R;\n\n  Q.insert({A[0] + B[0], 0});\n\n  i32 L = min(K, X * Y);\n\n  REP(i, L) {\n\n    i64 p = (*Q.begin()).first;\n\n    i64 q = (*Q.begin()).second;\n\n    AB[i] = p;\n\n    Q.erase(Q.begin());\n\n    i32 u = q >> 10;\n\n    i32 v = q & 1023;\n\n    if (u + 1 < X && (u + 1) * v < L) Q.insert({A[u + 1] + B[v], q + 1024});\n\n    if (v + 1 < Y && u * (v + 1) < L) Q.insert({A[u] + B[v + 1], q + 1});\n\n  }\n\n  R.insert({AB[0] + C[0], 0});\n\n  REP(_, K) {\n\n    i64 p = (*R.begin()).first;\n\n    i64 q = (*R.begin()).second;\n\n    // printf(\"%lld\\n\", -p);\n\n    writeln(-p);\n\n    R.erase(R.begin());\n\n    i32 u = q >> 10;\n\n    i32 v = q & 1023;\n\n    if (u + 1 < L && (u + 1) * v < K) R.insert({AB[u + 1] + C[v], q + 1024});\n\n    if (v + 1 < Z && u * (v + 1) < K) R.insert({AB[u] + C[v + 1], q + 1});\n\n  }\n\n}"
    },
    {
        "id": "39",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\nstruct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  auto solve = [&](i32 P) {\n\n    i32 cnt = 0;\n\n    REP(u, x) {\n\n      REP(v, y) {\n\n        REP(w, z) {\n\n          if (A[u] + B[v] + C[w] < P) break;\n\n          cnt++;\n\n          if (cnt >= k) return true;\n\n        }\n\n      }\n\n    }\n\n    return false;\n\n  };\n\n  i64 l = 0;\n\n  i64 r = A[0] + B[0] + C[0];\n\n  while (l < r) {\n\n    i64 m = (l + r + 1) / 2;\n\n    if (solve(m)) {\n\n      l = m;\n\n    } else {\n\n      r = m - 1;\n\n    }\n\n  }\n\n  vector<i64> ans;\n\n  REP(u, x) {\n\n    REP(v, y) {\n\n      REP(w, z) {\n\n        i64 p = A[u] + B[v] + C[w];\n\n        if (p < l) break;\n\n        if (p >= l) ans.push_back(p);\n\n      }\n\n    }\n\n  }\n\n  sort(ALL(ans), greater<i64>());\n\n  REP(i, k) {\n\n    cout << ans[i] << endl;\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i] = a % 10;\n\n    a = a / 10;\n\n    ++i;\n\n  }\n\n  while (i > 0) {\n\n    --i;\n\n    putchar_unlocked(buf[i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 AB[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = -read<i64>();\n\n  REP(i, Y) B[i] = -read<i64>();\n\n  REP(i, Z) C[i] = -read<i64>();\n\n  sort(A, A + X);\n\n  sort(B, B + Y);\n\n  sort(C, C + Z);\n\n  using P = pair<i64, i32>;\n\n  set<P> Q, R;\n\n  Q.insert({A[0] + B[0], 0});\n\n  i32 L = min(K, X * Y);\n\n  REP(i, L) {\n\n    i64 p = (*Q.begin()).first;\n\n    i64 q = (*Q.begin()).second;\n\n    AB[i] = p;\n\n    Q.erase(Q.begin());\n\n    i32 u = q >> 10;\n\n    i32 v = q & 1023;\n\n    if (u + 1 < X && (u + 1) * v < L) Q.insert({A[u + 1] + B[v], q + 1024});\n\n    if (v + 1 < Y && u * (v + 1) < L) Q.insert({A[u] + B[v + 1], q + 1});\n\n  }\n\n  R.insert({AB[0] + C[0], 0});\n\n  REP(_, K) {\n\n    i64 p = (*R.begin()).first;\n\n    i64 q = (*R.begin()).second;\n\n    // printf(\"%lld\\n\", -p);\n\n    writeln(-p);\n\n    R.erase(R.begin());\n\n    i32 u = q >> 10;\n\n    i32 v = q & 1023;\n\n    if (u + 1 < L && (u + 1) * v < K) R.insert({AB[u + 1] + C[v], q + 1024});\n\n    if (v + 1 < Z && u * (v + 1) < K) R.insert({AB[u] + C[v + 1], q + 1});\n\n  }\n\n}"
    },
    {
        "id": "40",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\n// struct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using T = tuple<i32, i32, i32>;\n\n  using P = pair<i64, T>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], make_tuple(0, 0, 0)});\n\n  set<T> S;\n\n  S.insert(make_tuple(0, 0, 0));\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i32 u, v, w;\n\n    tie(u, v, w) = Q.top().second;\n\n    Q.pop();\n\n    cout << p << endl;\n\n    auto u1 = make_tuple(u + 1, v, w);\n\n    auto v1 = make_tuple(u, v + 1, w);\n\n    auto w1 = make_tuple(u, v, w + 1);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i] = a % 10;\n\n    a = a / 10;\n\n    ++i;\n\n  }\n\n  while (i > 0) {\n\n    --i;\n\n    putchar_unlocked(buf[i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 AB[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = -read<i64>();\n\n  REP(i, Y) B[i] = -read<i64>();\n\n  REP(i, Z) C[i] = -read<i64>();\n\n  sort(A, A + X);\n\n  sort(B, B + Y);\n\n  sort(C, C + Z);\n\n  using P = pair<i64, i32>;\n\n  set<P> Q, R;\n\n  Q.insert({A[0] + B[0], 0});\n\n  i32 L = min(K, X * Y);\n\n  REP(i, L) {\n\n    i64 p = (*Q.begin()).first;\n\n    i64 q = (*Q.begin()).second;\n\n    AB[i] = p;\n\n    Q.erase(Q.begin());\n\n    i32 u = q >> 10;\n\n    i32 v = q & 1023;\n\n    if (u + 1 < X && (u + 1) * v < L) Q.insert({A[u + 1] + B[v], q + 1024});\n\n    if (v + 1 < Y && u * (v + 1) < L) Q.insert({A[u] + B[v + 1], q + 1});\n\n  }\n\n  R.insert({AB[0] + C[0], 0});\n\n  REP(_, K) {\n\n    i64 p = (*R.begin()).first;\n\n    i64 q = (*R.begin()).second;\n\n    // printf(\"%lld\\n\", -p);\n\n    writeln(-p);\n\n    R.erase(R.begin());\n\n    i32 u = q >> 10;\n\n    i32 v = q & 1023;\n\n    if (u + 1 < L && (u + 1) * v < K) R.insert({AB[u + 1] + C[v], q + 1024});\n\n    if (v + 1 < Z && u * (v + 1) < K) R.insert({AB[u] + C[v + 1], q + 1});\n\n  }\n\n}"
    },
    {
        "id": "41",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n// using i32 = std::int_fast32_t;\n\n// using i64 = std::int_fast64_t;\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\n// struct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  scanf(\"%d%d%d%d\", &x, &y, &z, &k);\n\n//  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  REP(i, x) scanf(\"%lld\", &A[i]);\n\n  REP(i, x) scanf(\"%lld\", &B[i]);\n\n  REP(i, x) scanf(\"%lld\", &C[i]);\n\n//  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using T = tuple<i32, i32, i32>;\n\n  using P = pair<i64, T>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], make_tuple(0, 0, 0)});\n\n  set<T> S;\n\n  S.insert(make_tuple(0, 0, 0));\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i32 u, v, w;\n\n    tie(u, v, w) = Q.top().second;\n\n    Q.pop();\n\n    cout << p << endl;\n\n    auto u1 = make_tuple(u + 1, v, w);\n\n    auto v1 = make_tuple(u, v + 1, w);\n\n    auto w1 = make_tuple(u, v, w + 1);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i] = a % 10;\n\n    a = a / 10;\n\n    ++i;\n\n  }\n\n  while (i > 0) {\n\n    --i;\n\n    putchar_unlocked(buf[i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 AB[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = -read<i64>();\n\n  REP(i, Y) B[i] = -read<i64>();\n\n  REP(i, Z) C[i] = -read<i64>();\n\n  sort(A, A + X);\n\n  sort(B, B + Y);\n\n  sort(C, C + Z);\n\n  using P = pair<i64, i32>;\n\n  set<P> Q, R;\n\n  Q.insert({A[0] + B[0], 0});\n\n  i32 L = min(K, X * Y);\n\n  REP(i, L) {\n\n    i64 p = (*Q.begin()).first;\n\n    i64 q = (*Q.begin()).second;\n\n    AB[i] = p;\n\n    Q.erase(Q.begin());\n\n    i32 u = q >> 10;\n\n    i32 v = q & 1023;\n\n    if (u + 1 < X && (u + 1) * v < L) Q.insert({A[u + 1] + B[v], q + 1024});\n\n    if (v + 1 < Y && u * (v + 1) < L) Q.insert({A[u] + B[v + 1], q + 1});\n\n  }\n\n  R.insert({AB[0] + C[0], 0});\n\n  REP(_, K) {\n\n    i64 p = (*R.begin()).first;\n\n    i64 q = (*R.begin()).second;\n\n    // printf(\"%lld\\n\", -p);\n\n    writeln(-p);\n\n    R.erase(R.begin());\n\n    i32 u = q >> 10;\n\n    i32 v = q & 1023;\n\n    if (u + 1 < L && (u + 1) * v < K) R.insert({AB[u + 1] + C[v], q + 1024});\n\n    if (v + 1 < Z && u * (v + 1) < K) R.insert({AB[u] + C[v + 1], q + 1});\n\n  }\n\n}"
    },
    {
        "id": "42",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\ntemplate <typename T> constexpr T inf = numeric_limits<T>::has_infinity ? numeric_limits<T>::infinity() : numeric_limits<T>::max() / 4;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T, typename U> istream& operator>>(istream& is, pair<T, U>& a) { return is >> a.first >> a.second; }\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\nvoid LOG(const int& x) { cerr << x << \"\\n\"; }\n\nvoid LOG(const vector<int>& a) { for (int x : a) cerr << x << \" \"; cerr << \"\\n\"; }\n\ntemplate<typename T, std::size_t S> void LOG(const T (&a)[S]) { REP(i, S) cerr << a[i] << \" \"; cerr << \"\\n\"; }\n\ntemplate<typename T, std::size_t S, std::size_t R> void LOG(const T (&a)[S][R]) { REP(i, S) { REP(j, R) cerr << a[i][j] << \" \"; cerr << \"\\n\"; } }\n\n\n\nint ceil(int a, int b) { return (a - 1) / b + 1; }\n\ni64 gcd(i64 a, i64 b) { while (b != 0) { i64 t = b; b = a % b; a = t; } return a; }\n\ni64 lcm(i64 a, i64 b) { return a / gcd(a, b) * b; }\n\ni64 gcd(const vector<i64>& v) { return accumulate(ALL(v), 1LL, static_cast<i64(*)(i64, i64)>(gcd)); }\n\ni64 lcm(const vector<i64>& v) { return v.empty() ? 0LL : accumulate(v.begin() + 1, v.end(), v[0], static_cast<i64(*)(i64, i64)>(lcm)); }\n\ni64 pow(i64 x, i64 y, i64 z) { i64 a = 1; while (y > 0) { if (y & 1) a = a * x % z; x = x * x % z; y /= 2; } return a; }\n\ni64 inv(i64 x, i64 m) { return pow(x, m - 2, m); }\n\n\n\n#define COMP(key) [](const auto& a, const auto& b) { return a.key < b.key; }\n\n\n\nstruct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); cout << fixed << setprecision(10); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  vector<i64> AB(x * y);\n\n  REP(i, x) {\n\n    REP(j, y) {\n\n      AB[i * y + j] = A[i] + B[j];\n\n    }\n\n  }\n\n  sort(ALL(AB));\n\n  i32 w = min(k, x * y);\n\n  vector<i64> ABC(w * z);\n\n  REP(i, w) {\n\n    REP(j, z) {\n\n      ABC[i * z + j] = AB[AB.size() - i - 1] + C[j];\n\n    }\n\n  }\n\n  sort(ALL(ABC));\n\n  auto iter = ABC.end();\n\n  REP(_, k) {\n\n    iter--;\n\n    cout << *iter << endl;\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (register int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i++] = a % 10;\n\n    a = a / 10;\n\n  }\n\n  while (i > 0) {\n\n    putchar_unlocked(buf[--i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 ABC[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = read<i64>();\n\n  REP(i, Y) B[i] = read<i64>();\n\n  REP(i, Z) C[i] = read<i64>();\n\n  sort(A, A + X, greater<i64>());\n\n  sort(B, B + Y, greater<i64>());\n\n  sort(C, C + Z, greater<i64>());\n\n  i64 A0 = A[0],\n\n      B0 = B[0],\n\n      C0 = C[0];\n\n  REP(i, X) A[i] = A0 - A[i];\n\n  REP(i, Y) B[i] = B0 - B[i];\n\n  REP(i, Z) C[i] = C0 - C[i];\n\n  i64 l = 0,\n\n      r = A0 + B0 + C0,\n\n      m;\n\n  while (l < r) {\n\n    m = (l + r) / 2;\n\n    i32 cnt = 0;\n\n    REP(i, X) {\n\n      if (A[i] > m) break;\n\n      REP(j, Y) {\n\n        if (A[i] + B[j] > m) break;\n\n        REP(k, Z) {\n\n          if (A[i] + B[j] + C[k] > m) break;\n\n          ++cnt;\n\n          if (cnt >= K) {\n\n            r = m;\n\n            goto NEXT;\n\n          }\n\n        }\n\n      }\n\n    }\n\n    l = m + 1;\n\n    NEXT:;\n\n  }\n\n  i32 c = 0;\n\n  REP(i, X) {\n\n    if (A[i] >= l) break;\n\n    REP(j, Y) {\n\n      if (A[i] + B[j] >= l) break;\n\n      REP(k, Z) {\n\n        if (A[i] + B[j] + C[k] >= l) break;\n\n        ABC[c++] = A[i] + B[j] + C[k];\n\n      }\n\n    }\n\n  }\n\n  sort(ABC, ABC + c);\n\n  REP(i, c) {\n\n    writeln(A0 + B0 + C0 - ABC[i]);\n\n  }\n\n  REP(_, K - c) {\n\n    writeln(A0 + B0 + C0 - l);\n\n  }\n\n}"
    },
    {
        "id": "43",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\ntemplate <typename T> constexpr T inf = numeric_limits<T>::has_infinity ? numeric_limits<T>::infinity() : numeric_limits<T>::max() / 4;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T, typename U> istream& operator>>(istream& is, pair<T, U>& a) { return is >> a.first >> a.second; }\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\nvoid LOG(const int& x) { cerr << x << \"\\n\"; }\n\nvoid LOG(const vector<int>& a) { for (int x : a) cerr << x << \" \"; cerr << \"\\n\"; }\n\ntemplate<typename T, std::size_t S> void LOG(const T (&a)[S]) { REP(i, S) cerr << a[i] << \" \"; cerr << \"\\n\"; }\n\ntemplate<typename T, std::size_t S, std::size_t R> void LOG(const T (&a)[S][R]) { REP(i, S) { REP(j, R) cerr << a[i][j] << \" \"; cerr << \"\\n\"; } }\n\n\n\nint ceil(int a, int b) { return (a - 1) / b + 1; }\n\ni64 gcd(i64 a, i64 b) { while (b != 0) { i64 t = b; b = a % b; a = t; } return a; }\n\ni64 lcm(i64 a, i64 b) { return a / gcd(a, b) * b; }\n\ni64 gcd(const vector<i64>& v) { return accumulate(ALL(v), 1LL, static_cast<i64(*)(i64, i64)>(gcd)); }\n\ni64 lcm(const vector<i64>& v) { return v.empty() ? 0LL : accumulate(v.begin() + 1, v.end(), v[0], static_cast<i64(*)(i64, i64)>(lcm)); }\n\ni64 pow(i64 x, i64 y, i64 z) { i64 a = 1; while (y > 0) { if (y & 1) a = a * x % z; x = x * x % z; y /= 2; } return a; }\n\ni64 inv(i64 x, i64 m) { return pow(x, m - 2, m); }\n\n\n\n#define COMP(key) [](const auto& a, const auto& b) { return a.key < b.key; }\n\n\n\nstruct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); cout << fixed << setprecision(10); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  vector<i64> ABC;\n\n  REP(u, x) {\n\n    REP(v, y) {\n\n      REP(w, z) {\n\n        if (u * v * w > k) break;\n\n        ABC.push_back(A[u] + B[v] + C[w]);\n\n      }\n\n    }\n\n  }\n\n  sort(ALL(ABC), greater<i64>());\n\n  REP(i, k) {\n\n    cout << ABC[i] << endl;\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (register int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i++] = a % 10;\n\n    a = a / 10;\n\n  }\n\n  while (i > 0) {\n\n    putchar_unlocked(buf[--i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 ABC[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = read<i64>();\n\n  REP(i, Y) B[i] = read<i64>();\n\n  REP(i, Z) C[i] = read<i64>();\n\n  sort(A, A + X, greater<i64>());\n\n  sort(B, B + Y, greater<i64>());\n\n  sort(C, C + Z, greater<i64>());\n\n  i64 A0 = A[0],\n\n      B0 = B[0],\n\n      C0 = C[0];\n\n  REP(i, X) A[i] = A0 - A[i];\n\n  REP(i, Y) B[i] = B0 - B[i];\n\n  REP(i, Z) C[i] = C0 - C[i];\n\n  i64 l = 0,\n\n      r = A0 + B0 + C0,\n\n      m;\n\n  while (l < r) {\n\n    m = (l + r) / 2;\n\n    i32 cnt = 0;\n\n    REP(i, X) {\n\n      if (A[i] > m) break;\n\n      REP(j, Y) {\n\n        if (A[i] + B[j] > m) break;\n\n        REP(k, Z) {\n\n          if (A[i] + B[j] + C[k] > m) break;\n\n          ++cnt;\n\n          if (cnt >= K) {\n\n            r = m;\n\n            goto NEXT;\n\n          }\n\n        }\n\n      }\n\n    }\n\n    l = m + 1;\n\n    NEXT:;\n\n  }\n\n  i32 c = 0;\n\n  REP(i, X) {\n\n    if (A[i] >= l) break;\n\n    REP(j, Y) {\n\n      if (A[i] + B[j] >= l) break;\n\n      REP(k, Z) {\n\n        if (A[i] + B[j] + C[k] >= l) break;\n\n        ABC[c++] = A[i] + B[j] + C[k];\n\n      }\n\n    }\n\n  }\n\n  sort(ABC, ABC + c);\n\n  REP(i, c) {\n\n    writeln(A0 + B0 + C0 - ABC[i]);\n\n  }\n\n  REP(_, K - c) {\n\n    writeln(A0 + B0 + C0 - l);\n\n  }\n\n}"
    },
    {
        "id": "44",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\nstruct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using T = tuple<i32, i32, i32>;\n\n  using P = pair<i64, T>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], make_tuple(0, 0, 0)});\n\n  set<T> S;\n\n  S.insert(make_tuple(0, 0, 0));\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i32 u, v, w;\n\n    tie(u, v, w) = Q.top().second;\n\n    Q.pop();\n\n    cout << p << endl;\n\n    auto u1 = make_tuple(u + 1, v, w);\n\n    auto v1 = make_tuple(u, v + 1, w);\n\n    auto w1 = make_tuple(u, v, w + 1);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (register int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i++] = a % 10;\n\n    a = a / 10;\n\n  }\n\n  while (i > 0) {\n\n    putchar_unlocked(buf[--i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 ABC[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = read<i64>();\n\n  REP(i, Y) B[i] = read<i64>();\n\n  REP(i, Z) C[i] = read<i64>();\n\n  sort(A, A + X, greater<i64>());\n\n  sort(B, B + Y, greater<i64>());\n\n  sort(C, C + Z, greater<i64>());\n\n  i64 A0 = A[0],\n\n      B0 = B[0],\n\n      C0 = C[0];\n\n  REP(i, X) A[i] = A0 - A[i];\n\n  REP(i, Y) B[i] = B0 - B[i];\n\n  REP(i, Z) C[i] = C0 - C[i];\n\n  i64 l = 0,\n\n      r = A0 + B0 + C0,\n\n      m;\n\n  while (l < r) {\n\n    m = (l + r) / 2;\n\n    i32 cnt = 0;\n\n    REP(i, X) {\n\n      if (A[i] > m) break;\n\n      REP(j, Y) {\n\n        if (A[i] + B[j] > m) break;\n\n        REP(k, Z) {\n\n          if (A[i] + B[j] + C[k] > m) break;\n\n          ++cnt;\n\n          if (cnt >= K) {\n\n            r = m;\n\n            goto NEXT;\n\n          }\n\n        }\n\n      }\n\n    }\n\n    l = m + 1;\n\n    NEXT:;\n\n  }\n\n  i32 c = 0;\n\n  REP(i, X) {\n\n    if (A[i] >= l) break;\n\n    REP(j, Y) {\n\n      if (A[i] + B[j] >= l) break;\n\n      REP(k, Z) {\n\n        if (A[i] + B[j] + C[k] >= l) break;\n\n        ABC[c++] = A[i] + B[j] + C[k];\n\n      }\n\n    }\n\n  }\n\n  sort(ABC, ABC + c);\n\n  REP(i, c) {\n\n    writeln(A0 + B0 + C0 - ABC[i]);\n\n  }\n\n  REP(_, K - c) {\n\n    writeln(A0 + B0 + C0 - l);\n\n  }\n\n}"
    },
    {
        "id": "45",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\nstruct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  auto solve = [&](i32 P) {\n\n    i32 cnt = 0;\n\n    REP(u, x) {\n\n      REP(v, y) {\n\n        REP(w, z) {\n\n          if (A[u] + B[v] + C[w] < P) break;\n\n          cnt++;\n\n          if (cnt >= k) return true;\n\n        }\n\n      }\n\n    }\n\n    return false;\n\n  };\n\n  i64 l = 0;\n\n  i64 r = A[0] + B[0] + C[0];\n\n  while (l < r) {\n\n    i64 m = (l + r + 1) / 2;\n\n    if (solve(m)) {\n\n      l = m;\n\n    } else {\n\n      r = m - 1;\n\n    }\n\n  }\n\n  vector<i64> ans;\n\n  REP(u, x) {\n\n    REP(v, y) {\n\n      REP(w, z) {\n\n        i64 p = A[u] + B[v] + C[w];\n\n        if (p < l) break;\n\n        if (p >= l) ans.push_back(p);\n\n      }\n\n    }\n\n  }\n\n  sort(ALL(ans), greater<i64>());\n\n  REP(i, k) {\n\n    cout << ans[i] << endl;\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (register int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i++] = a % 10;\n\n    a = a / 10;\n\n  }\n\n  while (i > 0) {\n\n    putchar_unlocked(buf[--i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 ABC[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = read<i64>();\n\n  REP(i, Y) B[i] = read<i64>();\n\n  REP(i, Z) C[i] = read<i64>();\n\n  sort(A, A + X, greater<i64>());\n\n  sort(B, B + Y, greater<i64>());\n\n  sort(C, C + Z, greater<i64>());\n\n  i64 A0 = A[0],\n\n      B0 = B[0],\n\n      C0 = C[0];\n\n  REP(i, X) A[i] = A0 - A[i];\n\n  REP(i, Y) B[i] = B0 - B[i];\n\n  REP(i, Z) C[i] = C0 - C[i];\n\n  i64 l = 0,\n\n      r = A0 + B0 + C0,\n\n      m;\n\n  while (l < r) {\n\n    m = (l + r) / 2;\n\n    i32 cnt = 0;\n\n    REP(i, X) {\n\n      if (A[i] > m) break;\n\n      REP(j, Y) {\n\n        if (A[i] + B[j] > m) break;\n\n        REP(k, Z) {\n\n          if (A[i] + B[j] + C[k] > m) break;\n\n          ++cnt;\n\n          if (cnt >= K) {\n\n            r = m;\n\n            goto NEXT;\n\n          }\n\n        }\n\n      }\n\n    }\n\n    l = m + 1;\n\n    NEXT:;\n\n  }\n\n  i32 c = 0;\n\n  REP(i, X) {\n\n    if (A[i] >= l) break;\n\n    REP(j, Y) {\n\n      if (A[i] + B[j] >= l) break;\n\n      REP(k, Z) {\n\n        if (A[i] + B[j] + C[k] >= l) break;\n\n        ABC[c++] = A[i] + B[j] + C[k];\n\n      }\n\n    }\n\n  }\n\n  sort(ABC, ABC + c);\n\n  REP(i, c) {\n\n    writeln(A0 + B0 + C0 - ABC[i]);\n\n  }\n\n  REP(_, K - c) {\n\n    writeln(A0 + B0 + C0 - l);\n\n  }\n\n}"
    },
    {
        "id": "46",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing i32 = std::int_fast32_t;\n\nusing i64 = std::int_fast64_t;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\n// struct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using T = tuple<i32, i32, i32>;\n\n  using P = pair<i64, T>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], make_tuple(0, 0, 0)});\n\n  set<T> S;\n\n  S.insert(make_tuple(0, 0, 0));\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i32 u, v, w;\n\n    tie(u, v, w) = Q.top().second;\n\n    Q.pop();\n\n    cout << p << endl;\n\n    auto u1 = make_tuple(u + 1, v, w);\n\n    auto v1 = make_tuple(u, v + 1, w);\n\n    auto w1 = make_tuple(u, v, w + 1);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (register int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i++] = a % 10;\n\n    a = a / 10;\n\n  }\n\n  while (i > 0) {\n\n    putchar_unlocked(buf[--i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 ABC[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = read<i64>();\n\n  REP(i, Y) B[i] = read<i64>();\n\n  REP(i, Z) C[i] = read<i64>();\n\n  sort(A, A + X, greater<i64>());\n\n  sort(B, B + Y, greater<i64>());\n\n  sort(C, C + Z, greater<i64>());\n\n  i64 A0 = A[0],\n\n      B0 = B[0],\n\n      C0 = C[0];\n\n  REP(i, X) A[i] = A0 - A[i];\n\n  REP(i, Y) B[i] = B0 - B[i];\n\n  REP(i, Z) C[i] = C0 - C[i];\n\n  i64 l = 0,\n\n      r = A0 + B0 + C0,\n\n      m;\n\n  while (l < r) {\n\n    m = (l + r) / 2;\n\n    i32 cnt = 0;\n\n    REP(i, X) {\n\n      if (A[i] > m) break;\n\n      REP(j, Y) {\n\n        if (A[i] + B[j] > m) break;\n\n        REP(k, Z) {\n\n          if (A[i] + B[j] + C[k] > m) break;\n\n          ++cnt;\n\n          if (cnt >= K) {\n\n            r = m;\n\n            goto NEXT;\n\n          }\n\n        }\n\n      }\n\n    }\n\n    l = m + 1;\n\n    NEXT:;\n\n  }\n\n  i32 c = 0;\n\n  REP(i, X) {\n\n    if (A[i] >= l) break;\n\n    REP(j, Y) {\n\n      if (A[i] + B[j] >= l) break;\n\n      REP(k, Z) {\n\n        if (A[i] + B[j] + C[k] >= l) break;\n\n        ABC[c++] = A[i] + B[j] + C[k];\n\n      }\n\n    }\n\n  }\n\n  sort(ABC, ABC + c);\n\n  REP(i, c) {\n\n    writeln(A0 + B0 + C0 - ABC[i]);\n\n  }\n\n  REP(_, K - c) {\n\n    writeln(A0 + B0 + C0 - l);\n\n  }\n\n}"
    },
    {
        "id": "47",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n// using i32 = std::int_fast32_t;\n\n// using i64 = std::int_fast64_t;\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\n// struct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  scanf(\"%d%d%d%d\", &x, &y, &z, &k);\n\n//  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  REP(i, x) scanf(\"%lld\", &A[i]);\n\n  REP(i, x) scanf(\"%lld\", &B[i]);\n\n  REP(i, x) scanf(\"%lld\", &C[i]);\n\n//  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using T = tuple<i32, i32, i32>;\n\n  using P = pair<i64, T>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], make_tuple(0, 0, 0)});\n\n  set<T> S;\n\n  S.insert(make_tuple(0, 0, 0));\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i32 u, v, w;\n\n    tie(u, v, w) = Q.top().second;\n\n    Q.pop();\n\n    cout << p << endl;\n\n    auto u1 = make_tuple(u + 1, v, w);\n\n    auto v1 = make_tuple(u, v + 1, w);\n\n    auto w1 = make_tuple(u, v, w + 1);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (register int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i++] = a % 10;\n\n    a = a / 10;\n\n  }\n\n  while (i > 0) {\n\n    putchar_unlocked(buf[--i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 ABC[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = read<i64>();\n\n  REP(i, Y) B[i] = read<i64>();\n\n  REP(i, Z) C[i] = read<i64>();\n\n  sort(A, A + X, greater<i64>());\n\n  sort(B, B + Y, greater<i64>());\n\n  sort(C, C + Z, greater<i64>());\n\n  i64 A0 = A[0],\n\n      B0 = B[0],\n\n      C0 = C[0];\n\n  REP(i, X) A[i] = A0 - A[i];\n\n  REP(i, Y) B[i] = B0 - B[i];\n\n  REP(i, Z) C[i] = C0 - C[i];\n\n  i64 l = 0,\n\n      r = A0 + B0 + C0,\n\n      m;\n\n  while (l < r) {\n\n    m = (l + r) / 2;\n\n    i32 cnt = 0;\n\n    REP(i, X) {\n\n      if (A[i] > m) break;\n\n      REP(j, Y) {\n\n        if (A[i] + B[j] > m) break;\n\n        REP(k, Z) {\n\n          if (A[i] + B[j] + C[k] > m) break;\n\n          ++cnt;\n\n          if (cnt >= K) {\n\n            r = m;\n\n            goto NEXT;\n\n          }\n\n        }\n\n      }\n\n    }\n\n    l = m + 1;\n\n    NEXT:;\n\n  }\n\n  i32 c = 0;\n\n  REP(i, X) {\n\n    if (A[i] >= l) break;\n\n    REP(j, Y) {\n\n      if (A[i] + B[j] >= l) break;\n\n      REP(k, Z) {\n\n        if (A[i] + B[j] + C[k] >= l) break;\n\n        ABC[c++] = A[i] + B[j] + C[k];\n\n      }\n\n    }\n\n  }\n\n  sort(ABC, ABC + c);\n\n  REP(i, c) {\n\n    writeln(A0 + B0 + C0 - ABC[i]);\n\n  }\n\n  REP(_, K - c) {\n\n    writeln(A0 + B0 + C0 - l);\n\n  }\n\n}"
    },
    {
        "id": "48",
        "source_code": "// #include <bits/stdc++.h>\n\n#include <cstdio>\n\n#include <vector>\n\n#include <functional>\n\n#include <algorithm>\n\n#include <queue>\n\n#include <set>\n\nusing namespace std;\n\n\n\n// using i32 = std::int_fast32_t;\n\n// using i64 = std::int_fast64_t;\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\n// template<typename T> istream& operator>>(istream& is, vector<T>& a) { for (T& x : a) is >> x; return is; }\n\n\n\n// struct InitCpp { InitCpp() { cin.tie(nullptr); ios::sync_with_stdio(false); } } initCpp;\n\n\n\nsigned main() {\n\n  i32 x, y, z, k;\n\n  scanf(\"%d%d%d%d\", &x, &y, &z, &k);\n\n//  cin >> x >> y >> z >> k;\n\n  vector<i64> A(x), B(y), C(z);\n\n  REP(i, x) scanf(\"%lld\", &A[i]);\n\n  REP(i, x) scanf(\"%lld\", &B[i]);\n\n  REP(i, x) scanf(\"%lld\", &C[i]);\n\n//  cin >> A >> B >> C;\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using T = tuple<i32, i32, i32>;\n\n  using P = pair<i64, T>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], make_tuple(0, 0, 0)});\n\n  set<T> S;\n\n  S.insert(make_tuple(0, 0, 0));\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i32 u, v, w;\n\n    tie(u, v, w) = Q.top().second;\n\n    Q.pop();\n\n    printf(\"%lld\\n\", p);\n\n    // cout << p << endl;\n\n    auto u1 = make_tuple(u + 1, v, w);\n\n    auto v1 = make_tuple(u, v + 1, w);\n\n    auto w1 = make_tuple(u, v, w + 1);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (register int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i++] = a % 10;\n\n    a = a / 10;\n\n  }\n\n  while (i > 0) {\n\n    putchar_unlocked(buf[--i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 ABC[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = read<i64>();\n\n  REP(i, Y) B[i] = read<i64>();\n\n  REP(i, Z) C[i] = read<i64>();\n\n  sort(A, A + X, greater<i64>());\n\n  sort(B, B + Y, greater<i64>());\n\n  sort(C, C + Z, greater<i64>());\n\n  i64 A0 = A[0],\n\n      B0 = B[0],\n\n      C0 = C[0];\n\n  REP(i, X) A[i] = A0 - A[i];\n\n  REP(i, Y) B[i] = B0 - B[i];\n\n  REP(i, Z) C[i] = C0 - C[i];\n\n  i64 l = 0,\n\n      r = A0 + B0 + C0,\n\n      m;\n\n  while (l < r) {\n\n    m = (l + r) / 2;\n\n    i32 cnt = 0;\n\n    REP(i, X) {\n\n      if (A[i] > m) break;\n\n      REP(j, Y) {\n\n        if (A[i] + B[j] > m) break;\n\n        REP(k, Z) {\n\n          if (A[i] + B[j] + C[k] > m) break;\n\n          ++cnt;\n\n          if (cnt >= K) {\n\n            r = m;\n\n            goto NEXT;\n\n          }\n\n        }\n\n      }\n\n    }\n\n    l = m + 1;\n\n    NEXT:;\n\n  }\n\n  i32 c = 0;\n\n  REP(i, X) {\n\n    if (A[i] >= l) break;\n\n    REP(j, Y) {\n\n      if (A[i] + B[j] >= l) break;\n\n      REP(k, Z) {\n\n        if (A[i] + B[j] + C[k] >= l) break;\n\n        ABC[c++] = A[i] + B[j] + C[k];\n\n      }\n\n    }\n\n  }\n\n  sort(ABC, ABC + c);\n\n  REP(i, c) {\n\n    writeln(A0 + B0 + C0 - ABC[i]);\n\n  }\n\n  REP(_, K - c) {\n\n    writeln(A0 + B0 + C0 - l);\n\n  }\n\n}"
    },
    {
        "id": "49",
        "source_code": "// #include <bits/stdc++.h>\n\n#include <cstdio>\n\n#include <vector>\n\n#include <functional>\n\n#include <algorithm>\n\n#include <queue>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  for(;;) {\n\n    char c = getchar();\n\n    if ('0' <= c && c <= '9') {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nsigned main() {\n\n//  i32 x, y, z, k;\n\n//  scanf(\"%d%d%d%d\", &x, &y, &z, &k);\n\n  i32 x = read<i32>(),\n\n      y = read<i32>(),\n\n      z = read<i32>(),\n\n      k = read<i32>();\n\n  vector<i64> A(x), B(y), C(z);\n\n//  REP(i, x) scanf(\"%lld\", &A[i]);\n\n//  REP(i, y) scanf(\"%lld\", &B[i]);\n\n//  REP(i, z) scanf(\"%lld\", &C[i]);\n\n  REP(i, x) A[i] = read<i64>();\n\n  REP(i, y) B[i] = read<i64>();\n\n  REP(i, z) C[i] = read<i64>();\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using P = pair<i64, i64>;\n\n  priority_queue<P> Q;\n\n  Q.push({A[0] + B[0] + C[0], 0});\n\n  set<i64> S;\n\n  S.insert(0);\n\n  REP(_, k) {\n\n    i64 p = Q.top().first;\n\n    i64 q = Q.top().second;\n\n    Q.pop();\n\n    printf(\"%lld\\n\", p);\n\n    i32 u = q & 1023;\n\n    i32 v = q >> 10 & 1023;\n\n    i32 w = q >> 20 & 1023;\n\n    i64 u1 = q + 1;\n\n    i64 v1 = q + (1 << 10);\n\n    i64 w1 = q + (1 << 20);\n\n    if (u + 1 < x && !S.count(u1)) { S.insert(u1); Q.push({A[u + 1] + B[v] + C[w], u1}); }\n\n    if (v + 1 < y && !S.count(v1)) { S.insert(v1); Q.push({A[u] + B[v + 1] + C[w], v1}); }\n\n    if (w + 1 < z && !S.count(w1)) { S.insert(w1); Q.push({A[u] + B[v] + C[w + 1], w1}); }\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (register int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i++] = a % 10;\n\n    a = a / 10;\n\n  }\n\n  while (i > 0) {\n\n    putchar_unlocked(buf[--i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 ABC[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = read<i64>();\n\n  REP(i, Y) B[i] = read<i64>();\n\n  REP(i, Z) C[i] = read<i64>();\n\n  sort(A, A + X, greater<i64>());\n\n  sort(B, B + Y, greater<i64>());\n\n  sort(C, C + Z, greater<i64>());\n\n  i64 A0 = A[0],\n\n      B0 = B[0],\n\n      C0 = C[0];\n\n  REP(i, X) A[i] = A0 - A[i];\n\n  REP(i, Y) B[i] = B0 - B[i];\n\n  REP(i, Z) C[i] = C0 - C[i];\n\n  i64 l = 0,\n\n      r = A0 + B0 + C0,\n\n      m;\n\n  while (l < r) {\n\n    m = (l + r) / 2;\n\n    i32 cnt = 0;\n\n    REP(i, X) {\n\n      if (A[i] > m) break;\n\n      REP(j, Y) {\n\n        if (A[i] + B[j] > m) break;\n\n        REP(k, Z) {\n\n          if (A[i] + B[j] + C[k] > m) break;\n\n          ++cnt;\n\n          if (cnt >= K) {\n\n            r = m;\n\n            goto NEXT;\n\n          }\n\n        }\n\n      }\n\n    }\n\n    l = m + 1;\n\n    NEXT:;\n\n  }\n\n  i32 c = 0;\n\n  REP(i, X) {\n\n    if (A[i] >= l) break;\n\n    REP(j, Y) {\n\n      if (A[i] + B[j] >= l) break;\n\n      REP(k, Z) {\n\n        if (A[i] + B[j] + C[k] >= l) break;\n\n        ABC[c++] = A[i] + B[j] + C[k];\n\n      }\n\n    }\n\n  }\n\n  sort(ABC, ABC + c);\n\n  REP(i, c) {\n\n    writeln(A0 + B0 + C0 - ABC[i]);\n\n  }\n\n  REP(_, K - c) {\n\n    writeln(A0 + B0 + C0 - l);\n\n  }\n\n}"
    },
    {
        "id": "50",
        "source_code": "#include <cstdio>\n\n#include <vector>\n\n#include <functional>\n\n#include <algorithm>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) FOR(i, 0, stop)\n\n#define FOR(i, start, stop) for (int i = start, i##_len = stop; i < i##_len; ++i)\n\n#define RREP(i, n) for (int i = n; i-- > 0;)\n\n#define ALL(v) (v).begin(), (v).end()\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  for(;;) {\n\n    char c = getchar();\n\n    if ('0' <= c && c <= '9') {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nsigned main() {\n\n//  i32 x, y, z, k;\n\n//  scanf(\"%d%d%d%d\", &x, &y, &z, &k);\n\n  i32 x = read<i32>(),\n\n      y = read<i32>(),\n\n      z = read<i32>(),\n\n      k = read<i32>();\n\n  vector<i64> A(x), B(y), C(z);\n\n//  REP(i, x) scanf(\"%lld\", &A[i]);\n\n//  REP(i, y) scanf(\"%lld\", &B[i]);\n\n//  REP(i, z) scanf(\"%lld\", &C[i]);\n\n  REP(i, x) A[i] = read<i64>();\n\n  REP(i, y) B[i] = read<i64>();\n\n  REP(i, z) C[i] = read<i64>();\n\n  sort(ALL(A), greater<i64>());\n\n  sort(ALL(B), greater<i64>());\n\n  sort(ALL(C), greater<i64>());\n\n  using P = pair<i64, i64>;\n\n  set<P> Q;\n\n  Q.insert({-(A[0] + B[0] + C[0]), 0});\n\n  REP(_, k) {\n\n    i64 p = -(*Q.begin()).first;\n\n    i64 q = (*Q.begin()).second;\n\n    printf(\"%lld\\n\", p);\n\n    Q.erase(Q.begin());\n\n    i32 u = q & 1023;\n\n    i32 v = q >> 10 & 1023;\n\n    i32 w = q >> 20 & 1023;\n\n    i64 u1 = q + 1;\n\n    i64 v1 = q + (1 << 10);\n\n    i64 w1 = q + (1 << 20);\n\n    if (u + 1 < x) Q.insert({-(A[u + 1] + B[v] + C[w]), u1});\n\n    if (v + 1 < y) Q.insert({-(A[u] + B[v + 1] + C[w]), v1});\n\n    if (w + 1 < z) Q.insert({-(A[u] + B[v] + C[w + 1]), w1});\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (register int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i++] = a % 10;\n\n    a = a / 10;\n\n  }\n\n  while (i > 0) {\n\n    putchar_unlocked(buf[--i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 ABC[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = read<i64>();\n\n  REP(i, Y) B[i] = read<i64>();\n\n  REP(i, Z) C[i] = read<i64>();\n\n  sort(A, A + X, greater<i64>());\n\n  sort(B, B + Y, greater<i64>());\n\n  sort(C, C + Z, greater<i64>());\n\n  i64 A0 = A[0],\n\n      B0 = B[0],\n\n      C0 = C[0];\n\n  REP(i, X) A[i] = A0 - A[i];\n\n  REP(i, Y) B[i] = B0 - B[i];\n\n  REP(i, Z) C[i] = C0 - C[i];\n\n  i64 l = 0,\n\n      r = A0 + B0 + C0,\n\n      m;\n\n  while (l < r) {\n\n    m = (l + r) / 2;\n\n    i32 cnt = 0;\n\n    REP(i, X) {\n\n      if (A[i] > m) break;\n\n      REP(j, Y) {\n\n        if (A[i] + B[j] > m) break;\n\n        REP(k, Z) {\n\n          if (A[i] + B[j] + C[k] > m) break;\n\n          ++cnt;\n\n          if (cnt >= K) {\n\n            r = m;\n\n            goto NEXT;\n\n          }\n\n        }\n\n      }\n\n    }\n\n    l = m + 1;\n\n    NEXT:;\n\n  }\n\n  i32 c = 0;\n\n  REP(i, X) {\n\n    if (A[i] >= l) break;\n\n    REP(j, Y) {\n\n      if (A[i] + B[j] >= l) break;\n\n      REP(k, Z) {\n\n        if (A[i] + B[j] + C[k] >= l) break;\n\n        ABC[c++] = A[i] + B[j] + C[k];\n\n      }\n\n    }\n\n  }\n\n  sort(ABC, ABC + c);\n\n  REP(i, c) {\n\n    writeln(A0 + B0 + C0 - ABC[i]);\n\n  }\n\n  REP(_, K - c) {\n\n    writeln(A0 + B0 + C0 - l);\n\n  }\n\n}"
    },
    {
        "id": "51",
        "source_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i] = a % 10;\n\n    a = a / 10;\n\n    ++i;\n\n  }\n\n  while (i > 0) {\n\n    --i;\n\n    putchar_unlocked(buf[i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 AB[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = -read<i64>();\n\n  REP(i, Y) B[i] = -read<i64>();\n\n  REP(i, Z) C[i] = -read<i64>();\n\n  sort(A, A + X);\n\n  sort(B, B + Y);\n\n  sort(C, C + Z);\n\n  using P = pair<i64, i32>;\n\n  set<P> Q, R;\n\n  Q.insert({A[0] + B[0], 0});\n\n  i32 L = min(K, X * Y);\n\n  REP(i, L) {\n\n    i64 p = (*Q.begin()).first;\n\n    i64 q = (*Q.begin()).second;\n\n    AB[i] = p;\n\n    Q.erase(Q.begin());\n\n    i32 u = q >> 10;\n\n    i32 v = q & 1023;\n\n    if (u + 1 < X && (u + 1) * v < L) Q.insert({A[u + 1] + B[v], q + 1024});\n\n    if (v + 1 < Y && u * (v + 1) < L) Q.insert({A[u] + B[v + 1], q + 1});\n\n  }\n\n  R.insert({AB[0] + C[0], 0});\n\n  REP(_, K) {\n\n    i64 p = (*R.begin()).first;\n\n    i64 q = (*R.begin()).second;\n\n    // printf(\"%lld\\n\", -p);\n\n    writeln(-p);\n\n    R.erase(R.begin());\n\n    i32 u = q >> 10;\n\n    i32 v = q & 1023;\n\n    if (u + 1 < L && (u + 1) * v < K) R.insert({AB[u + 1] + C[v], q + 1024});\n\n    if (v + 1 < Z && u * (v + 1) < K) R.insert({AB[u] + C[v + 1], q + 1});\n\n  }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <set>\n\nusing namespace std;\n\n\n\nusing i32 = int;\n\nusing i64 = long long;\n\n\n\n#define REP(i, stop) for (register int i = 0; i < stop; ++i)\n\n\n\ntemplate<typename T>\n\nT read() {\n\n  T a = 0;\n\n  register int c;\n\n  for(;;) {\n\n    c = getchar_unlocked();\n\n    if (c & 16) {\n\n      a = a * 10 + c - 48;\n\n    } else {\n\n      return a;\n\n    }\n\n  }\n\n}\n\n\n\nvoid writeln(i64 a) {\n\n  char buf[20];\n\n  register int i = 0;\n\n  // if (a <= 0)\n\n  while (a > 0) {\n\n    buf[i++] = a % 10;\n\n    a = a / 10;\n\n  }\n\n  while (i > 0) {\n\n    putchar_unlocked(buf[--i] + 48);\n\n  }\n\n  putchar_unlocked('\\n');\n\n}\n\n\n\ni64 A[1000], B[1000], C[1000];\n\ni64 ABC[3000];\n\nsigned main() {\n\n  i32 X = read<i32>(),\n\n      Y = read<i32>(),\n\n      Z = read<i32>(),\n\n      K = read<i32>();\n\n  REP(i, X) A[i] = read<i64>();\n\n  REP(i, Y) B[i] = read<i64>();\n\n  REP(i, Z) C[i] = read<i64>();\n\n  sort(A, A + X, greater<i64>());\n\n  sort(B, B + Y, greater<i64>());\n\n  sort(C, C + Z, greater<i64>());\n\n  i64 A0 = A[0],\n\n      B0 = B[0],\n\n      C0 = C[0];\n\n  REP(i, X) A[i] = A0 - A[i];\n\n  REP(i, Y) B[i] = B0 - B[i];\n\n  REP(i, Z) C[i] = C0 - C[i];\n\n  i64 l = 0,\n\n      r = A0 + B0 + C0,\n\n      m;\n\n  while (l < r) {\n\n    m = (l + r) / 2;\n\n    i32 cnt = 0;\n\n    REP(i, X) {\n\n      if (A[i] > m) break;\n\n      REP(j, Y) {\n\n        if (A[i] + B[j] > m) break;\n\n        REP(k, Z) {\n\n          if (A[i] + B[j] + C[k] > m) break;\n\n          ++cnt;\n\n          if (cnt >= K) {\n\n            r = m;\n\n            goto NEXT;\n\n          }\n\n        }\n\n      }\n\n    }\n\n    l = m + 1;\n\n    NEXT:;\n\n  }\n\n  i32 c = 0;\n\n  REP(i, X) {\n\n    if (A[i] >= l) break;\n\n    REP(j, Y) {\n\n      if (A[i] + B[j] >= l) break;\n\n      REP(k, Z) {\n\n        if (A[i] + B[j] + C[k] >= l) break;\n\n        ABC[c++] = A[i] + B[j] + C[k];\n\n      }\n\n    }\n\n  }\n\n  sort(ABC, ABC + c);\n\n  REP(i, c) {\n\n    writeln(A0 + B0 + C0 - ABC[i]);\n\n  }\n\n  REP(_, K - c) {\n\n    writeln(A0 + B0 + C0 - l);\n\n  }\n\n}"
    },
    {
        "id": "52",
        "source_code": "#include <bits/stdc++.h>\n\n#define repd(i,a,b) for (int i=(a);i<(b);i++)\n\n#define rep(i,n) repd(i,0,n)\n\n#define int long long\n\ntypedef long long ll;\n\nusing namespace std;\n\nconst int MOD = 1000000007;\n\nconst int INF = 1000000000000000000;\n\nconst double EPS = 1e-10;\n\nconst pair<int,int> fd[] = {make_pair(1,0),make_pair(-1,0),make_pair(0,1),make_pair(0,-1)}; \n\n\n\nstruct edge { int to, cost; };\n\nvector<edge> g[110000];\n\nint d[110000];\n\nint v,e,s,t;\n\n\n\nvoid dijkstra(int s, int d[], vector<edge> g[]){\n\n  priority_queue<pair<int,int>, vector<pair<int,int>>, greater<pair<int,int>>> que;\n\n  fill(d,d+v+1, INF);d[s] = 0;que.push(pair<int,int>(0,s));\n\n  while(!que.empty()){\n\n    pair<int,int> p = que.top();que.pop();\n\n    int v = p.second;\n\n    if(d[v]<p.first)continue;\n\n    rep(i,g[v].size()){\n\n      edge e = g[v][i];\n\n      if(d[e.to] > d[v] + e.cost){\n\n        d[e.to] = d[v] + e.cost;\n\n        que.push(pair<int,int>(d[e.to], e.to));\n\n      }\n\n    }\n\n  }\n\n}\n\n\n\nsigned main(){\n\n  int x,y,z,k;cin>>x>>y>>z>>k;\n\n  int a[1100], b[1100], c[1100];rep(i,x)cin>>a[i];rep(i,y)cin>>b[i];rep(i,z)cin>>c[i];\n\n  vector<int> d(x*y);int ind = 0;\n\n  rep(i,x){\n\n    rep(j,y){\n\n      d[ind] = a[i]+b[j];\n\n      ind++;\n\n    }\n\n  }\n\n  sort(d.begin(), d.end(),greater<int>());sort(c,c+z,greater<int>());\n\n  deque<int> q;\n\n  rep(i,z){\n\n    rep(j,min(k,x*y)){\n\n      q.push_back(c[i]+d[j]);\n\n    }\n\n  }\n\n  sort(q.begin(), q.end(), greater<int>());\n\n  rep(i,k){\n\n    cout << q[i] << endl;\n\n  }\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define repd(i,a,b) for (int i=(a);i<(b);i++)\n\n#define rep(i,n) repd(i,0,n)\n\n#define int long long\n\ntypedef long long ll;\n\nusing namespace std;\n\nconst int MOD = 1000000007;\n\nconst int INF = 1010000000;\n\nconst double EPS = 1e-10;\n\nconst pair<int,int> fd[] = {make_pair(1,0),make_pair(-1,0),make_pair(0,1),make_pair(0,-1)}; \n\n\n\nvector<int> init(int size){\n\n  vector<int> par(size,-1);\n\n  return par;\n\n}\n\n\n\nint root(int x, vector<int>& par){\n\n  if(par[x] < 0){\n\n    return x;\n\n  }else{\n\n    return par[x] = root(par[x],par);\n\n  }\n\n}\n\n\n\nbool same(int x, int y, vector<int>& par){\n\n  return root(x, par) == root(y, par);\n\n}\n\n\n\nvoid unite(int x, int y, vector<int>& par){\n\n  x = root(x, par), y = root(y, par);\n\n  if(same(x,y, par))return;\n\n  par[x] += par[y];\n\n  par[y] = x;\n\n}\n\n\n\nint size(int x, vector<int>& par){\n\n  return -par[root(x, par)];\n\n}\n\n\n\nint pow(int x, int n){\n\n  if(n == 0)return 1;\n\n  if(n % 2 == 0)return pow(x * x % MOD, n/2);\n\n  else return x * pow(x, n-1) % MOD;\n\n}\n\n\n\nsigned main(){\n\n  int x,y,z,k;cin>>x>>y>>z>>k;\n\n  int a[1100], b[1100], c[1100];rep(i,x)cin>>a[i];rep(i,y)cin>>b[i];rep(i,z)cin>>c[i];\n\n  sort(a,a+x,greater<int>());sort(b,b+y,greater<int>());sort(c,c+z,greater<int>());\n\n  vector<int> v;\n\n  rep(i,x){\n\n    rep(j,y){\n\n      rep(l,z){\n\n        if((i+1)*(j+1)*(l+1) > k)break;\n\n        v.push_back(a[i]+b[j]+c[l]);\n\n      }\n\n    }\n\n  }\n\n  sort(v.begin(), v.end(), greater<int>());\n\n  rep(i,k)cout << v[i] << endl;\n\n}\n"
    },
    {
        "id": "53",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\n#define rall(x) (x).rbegin(), (x).rend()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nstruct P {\n\n    ll taste;\n\n    int a;\n\n    int b;\n\n    int c;\n\n\n\n    bool operator<(const P &another) const {\n\n        return taste < another.taste;\n\n    };\n\n};\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X + 2000, -10000000000);\n\n    vector<ll> B(Y + 2000, -10000000000);\n\n    vector<ll> C(Z + 2000, -10000000000);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(rall(A));\n\n    sort(rall(B));\n\n    sort(rall(C));\n\n\n\n    priority_queue<P> pq;\n\n    P init = {A[0] + B[0] + C[0], 0, 0, 0};\n\n    pq.push(init);\n\n    map<vector<int>, int> cnt;\n\n    cnt[{0, 0, 0}]++;\n\n    vector<ll> ans;\n\n\n\n    while (!pq.empty() && ans.size() < K) {\n\n        P q = pq.top();\n\n        pq.pop();\n\n        // printf(\"taste=%d a=%d b=%d c=%d\\n\", q.taste, q.a, q.b, q.c);\n\n        ans.push_back(q.taste);\n\n        P newq1 = {A[q.a + 1] + B[q.b] + C[q.c], q.a + 1, q.b, q.c};\n\n        P newq2 = {A[q.a] + B[q.b + 1] + C[q.c], q.a, q.b + 1, q.c};\n\n        P newq3 = {A[q.a] + B[q.b] + C[q.c + 1], q.a, q.b, q.c + 1};\n\n\n\n        if (q.a+1<X && cnt[{q.a + 1, q.b, q.c}] == 0) {\n\n            // cout << \"1\u3060\u3088\" << endl;\n\n            pq.push(newq1);\n\n            cnt[{q.a + 1, q.b, q.c}]++;\n\n        }\n\n        if (q.b+1<Y && cnt[{q.a, q.b + 1, q.c}] == 0) {\n\n            // cout << \"2\u3060\u3088\" << endl;\n\n            pq.push(newq2);\n\n            cnt[{q.a, q.b + 1, q.c}]++;\n\n        }\n\n        if (q.c+1<Z && cnt[{q.a, q.b, q.c + 1}] == 0) {\n\n            // cout << \"3\u3060\u3088\" << endl;\n\n            pq.push(newq3);\n\n            cnt[{q.a, q.b, q.c + 1}]++;\n\n        }\n\n    }\n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nvector<ll> AB;\n\nvector<ll> ans;\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X);\n\n    vector<ll> B(Y);\n\n    vector<ll> C(Z);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(all(C));\n\n    reverse(all(C));\n\n\n\n    rep(x, X) rep(y, Y) {\n\n        AB.push_back(A[x] + B[y]);\n\n    }\n\n    sort(all(AB));\n\n    reverse(all(AB));\n\n\n\n    rep(i, min(X*Y, K)) rep(z, min(K, Z)) {\n\n        ans.push_back(AB[i] + C[z]);\n\n    }\n\n    sort(all(ans));\n\n    reverse(all(ans));\n\n\n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n"
    },
    {
        "id": "54",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\n#define rall(x) (x).rbegin(), (x).rend()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nstruct P {\n\n    ll taste;\n\n    int a;\n\n    int b;\n\n    int c;\n\n\n\n    bool operator<(const P &d) const {\n\n        if (a == d.a && b == d.b && c == d.c) {\n\n            return taste < d.taste;\n\n        } else if (a != d.a) {\n\n            return a < d.a;\n\n        } else if (b != d.b) {\n\n            return b < d.b;\n\n        } else {\n\n            return c < d.c;\n\n        }\n\n    };\n\n};\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X + 2000, -10000000000);\n\n    vector<ll> B(Y + 2000, -10000000000);\n\n    vector<ll> C(Z + 2000, -10000000000);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(rall(A));\n\n    sort(rall(B));\n\n    sort(rall(C));\n\n\n\n    auto compare = [](P a, P b) {\n\n      return a.taste < b.taste;\n\n    };\n\n\n\n    priority_queue<P,vector<P>,decltype(compare)> pq {compare};\n\n    P init = {A[0] + B[0] + C[0], 0, 0, 0};\n\n    pq.push(init);\n\n    map<P, int> cnt;\n\n    cnt[init]++;\n\n    vector<ll> ans;\n\n\n\n    while (!pq.empty() && ans.size() < K) {\n\n        P q = pq.top();\n\n        pq.pop();\n\n        ans.push_back(q.taste);\n\n        P newq1 = {A[q.a + 1] + B[q.b] + C[q.c], q.a + 1, q.b, q.c};\n\n        P newq2 = {A[q.a] + B[q.b + 1] + C[q.c], q.a, q.b + 1, q.c};\n\n        P newq3 = {A[q.a] + B[q.b] + C[q.c + 1], q.a, q.b, q.c + 1};\n\n\n\n        if (cnt[newq1] == 0) {\n\n            pq.push(newq1);\n\n            cnt[newq1]++;\n\n        }\n\n        if (cnt[newq2] == 0) {\n\n            pq.push(newq2);\n\n            cnt[newq2]++;\n\n        }\n\n        if (cnt[newq3] == 0) {\n\n            pq.push(newq3);\n\n            cnt[newq3]++;\n\n        }\n\n    }\n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nvector<ll> AB;\n\nvector<ll> ans;\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X);\n\n    vector<ll> B(Y);\n\n    vector<ll> C(Z);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(all(C));\n\n    reverse(all(C));\n\n\n\n    rep(x, X) rep(y, Y) {\n\n        AB.push_back(A[x] + B[y]);\n\n    }\n\n    sort(all(AB));\n\n    reverse(all(AB));\n\n\n\n    rep(i, min(X*Y, K)) rep(z, min(K, Z)) {\n\n        ans.push_back(AB[i] + C[z]);\n\n    }\n\n    sort(all(ans));\n\n    reverse(all(ans));\n\n\n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n"
    },
    {
        "id": "55",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\n#define rall(x) (x).rbegin(), (x).rend()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nstruct P {\n\n    ll taste;\n\n    int a;\n\n    int b;\n\n    int c;\n\n\n\n    bool operator<(const P &another) const {\n\n        return taste < another.taste;\n\n    };\n\n};\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X + 2000, -10000000000);\n\n    vector<ll> B(Y + 2000, -10000000000);\n\n    vector<ll> C(Z + 2000, -10000000000);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(rall(A));\n\n    sort(rall(B));\n\n    sort(rall(C));\n\n\n\n    priority_queue<P> pq;\n\n    P init = {A[0] + B[0] + C[0], 0, 0, 0};\n\n    pq.push(init);\n\n    map<vector<int>, int> cnt;\n\n    cnt[{0, 0, 0}]++;\n\n    vector<ll> ans;\n\n\n\n    while (!pq.empty() && ans.size() < K) {\n\n        P q = pq.top();\n\n        pq.pop();\n\n        // printf(\"taste=%d a=%d b=%d c=%d\\n\", q.taste, q.a, q.b, q.c);\n\n        ans.push_back(q.taste);\n\n        P newq1 = {A[q.a + 1] + B[q.b] + C[q.c], q.a + 1, q.b, q.c};\n\n        P newq2 = {A[q.a] + B[q.b + 1] + C[q.c], q.a, q.b + 1, q.c};\n\n        P newq3 = {A[q.a] + B[q.b] + C[q.c + 1], q.a, q.b, q.c + 1};\n\n\n\n        if (q.a+1<X && cnt[{q.a + 1, q.b, q.c}] == 0) {\n\n            // cout << \"1\u3060\u3088\" << endl;\n\n            pq.push(newq1);\n\n            cnt[{q.a + 1, q.b, q.c}]++;\n\n        }\n\n        if (q.b+1<Y && cnt[{q.a, q.b + 1, q.c}] == 0) {\n\n            // cout << \"2\u3060\u3088\" << endl;\n\n            pq.push(newq2);\n\n            cnt[{q.a, q.b + 1, q.c}]++;\n\n        }\n\n        if (q.c+1<Z && cnt[{q.a, q.b, q.c + 1}] == 0) {\n\n            // cout << \"3\u3060\u3088\" << endl;\n\n            pq.push(newq3);\n\n            cnt[{q.a, q.b, q.c + 1}]++;\n\n        }\n\n    }\n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nvector<ll> AB;\n\nvector<ll> ans;\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X);\n\n    vector<ll> B(Y);\n\n    vector<ll> C(Z);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(all(C),greater<ll>());\n\n\n\n    rep(x, X) rep(y, Y) {\n\n        AB.push_back(A[x] + B[y]);\n\n    }\n\n    sort(all(AB),greater<ll>());\n\n\n\n    rep(i, min(X*Y, K)) rep(z, min(K, Z)) {\n\n        ans.push_back(AB[i] + C[z]);\n\n    }\n\n    sort(all(ans),greater<ll>());\n\n\n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n"
    },
    {
        "id": "56",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\n#define rall(x) (x).rbegin(), (x).rend()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nstruct P {\n\n    ll taste;\n\n    int a;\n\n    int b;\n\n    int c;\n\n\n\n    bool operator<(const P &d) const {\n\n        if (a == d.a && b == d.b && c == d.c) {\n\n            return taste < d.taste;\n\n        } else if (a != d.a) {\n\n            return a < d.a;\n\n        } else if (b != d.b) {\n\n            return b < d.b;\n\n        } else {\n\n            return c < d.c;\n\n        }\n\n    };\n\n};\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X + 2000, -10000000000);\n\n    vector<ll> B(Y + 2000, -10000000000);\n\n    vector<ll> C(Z + 2000, -10000000000);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(rall(A));\n\n    sort(rall(B));\n\n    sort(rall(C));\n\n\n\n    auto compare = [](P a, P b) {\n\n      return a.taste < b.taste;\n\n    };\n\n\n\n    priority_queue<P,vector<P>,decltype(compare)> pq {compare};\n\n    P init = {A[0] + B[0] + C[0], 0, 0, 0};\n\n    pq.push(init);\n\n    map<P, int> cnt;\n\n    cnt[init]++;\n\n    vector<ll> ans;\n\n\n\n    while (!pq.empty() && ans.size() < K) {\n\n        P q = pq.top();\n\n        pq.pop();\n\n        ans.push_back(q.taste);\n\n        P newq1 = {A[q.a + 1] + B[q.b] + C[q.c], q.a + 1, q.b, q.c};\n\n        P newq2 = {A[q.a] + B[q.b + 1] + C[q.c], q.a, q.b + 1, q.c};\n\n        P newq3 = {A[q.a] + B[q.b] + C[q.c + 1], q.a, q.b, q.c + 1};\n\n\n\n        if (cnt[newq1] == 0) {\n\n            pq.push(newq1);\n\n            cnt[newq1]++;\n\n        }\n\n        if (cnt[newq2] == 0) {\n\n            pq.push(newq2);\n\n            cnt[newq2]++;\n\n        }\n\n        if (cnt[newq3] == 0) {\n\n            pq.push(newq3);\n\n            cnt[newq3]++;\n\n        }\n\n    }\n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nvector<ll> AB;\n\nvector<ll> ans;\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X);\n\n    vector<ll> B(Y);\n\n    vector<ll> C(Z);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(all(C),greater<ll>());\n\n\n\n    rep(x, X) rep(y, Y) {\n\n        AB.push_back(A[x] + B[y]);\n\n    }\n\n    sort(all(AB),greater<ll>());\n\n\n\n    rep(i, min(X*Y, K)) rep(z, min(K, Z)) {\n\n        ans.push_back(AB[i] + C[z]);\n\n    }\n\n    sort(all(ans),greater<ll>());\n\n\n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n"
    },
    {
        "id": "57",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\n#define rall(x) (x).rbegin(), (x).rend()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nstruct P {\n\n    ll taste;\n\n    int a;\n\n    int b;\n\n    int c;\n\n\n\n    bool operator<(const P &another) const {\n\n        return taste < another.taste;\n\n    };\n\n};\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X + 2000, -10000000000);\n\n    vector<ll> B(Y + 2000, -10000000000);\n\n    vector<ll> C(Z + 2000, -10000000000);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(rall(A));\n\n    sort(rall(B));\n\n    sort(rall(C));\n\n\n\n    priority_queue<P> pq;\n\n    P init = {A[0] + B[0] + C[0], 0, 0, 0};\n\n    pq.push(init);\n\n    map<vector<int>, int> cnt;\n\n    cnt[{0, 0, 0}]++;\n\n    vector<ll> ans;\n\n\n\n    while (!pq.empty() && ans.size() < K) {\n\n        P q = pq.top();\n\n        pq.pop();\n\n        // printf(\"taste=%d a=%d b=%d c=%d\\n\", q.taste, q.a, q.b, q.c);\n\n        ans.push_back(q.taste);\n\n        P newq1 = {A[q.a + 1] + B[q.b] + C[q.c], q.a + 1, q.b, q.c};\n\n        P newq2 = {A[q.a] + B[q.b + 1] + C[q.c], q.a, q.b + 1, q.c};\n\n        P newq3 = {A[q.a] + B[q.b] + C[q.c + 1], q.a, q.b, q.c + 1};\n\n\n\n        if (q.a+1<X && cnt[{q.a + 1, q.b, q.c}] == 0) {\n\n            // cout << \"1\u3060\u3088\" << endl;\n\n            pq.push(newq1);\n\n            cnt[{q.a + 1, q.b, q.c}]++;\n\n        }\n\n        if (q.b+1<Y && cnt[{q.a, q.b + 1, q.c}] == 0) {\n\n            // cout << \"2\u3060\u3088\" << endl;\n\n            pq.push(newq2);\n\n            cnt[{q.a, q.b + 1, q.c}]++;\n\n        }\n\n        if (q.c+1<Z && cnt[{q.a, q.b, q.c + 1}] == 0) {\n\n            // cout << \"3\u3060\u3088\" << endl;\n\n            pq.push(newq3);\n\n            cnt[{q.a, q.b, q.c + 1}]++;\n\n        }\n\n    }\n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\n#define rall(x) (x).rbegin(), (x).rend()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nvector<ll> AB;\n\nvector<ll> ans;\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X);\n\n    vector<ll> B(Y);\n\n    vector<ll> C(Z);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(rall(C));\n\n\n\n    rep(x, X) rep(y, Y) {\n\n        AB.push_back(A[x] + B[y]);\n\n    }\n\n    sort(rall(AB));\n\n\n\n    rep(i, min(X*Y, K)) rep(z, min(K, Z)) {\n\n        ans.push_back(AB[i] + C[z]);\n\n    }\n\n    sort(rall(ans));\n\n\n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n"
    },
    {
        "id": "58",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\n#define rall(x) (x).rbegin(), (x).rend()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nstruct P {\n\n    ll taste;\n\n    int a;\n\n    int b;\n\n    int c;\n\n\n\n    bool operator<(const P &d) const {\n\n        if (a == d.a && b == d.b && c == d.c) {\n\n            return taste < d.taste;\n\n        } else if (a != d.a) {\n\n            return a < d.a;\n\n        } else if (b != d.b) {\n\n            return b < d.b;\n\n        } else {\n\n            return c < d.c;\n\n        }\n\n    };\n\n};\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X + 2000, -10000000000);\n\n    vector<ll> B(Y + 2000, -10000000000);\n\n    vector<ll> C(Z + 2000, -10000000000);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(rall(A));\n\n    sort(rall(B));\n\n    sort(rall(C));\n\n\n\n    auto compare = [](P a, P b) {\n\n      return a.taste < b.taste;\n\n    };\n\n\n\n    priority_queue<P,vector<P>,decltype(compare)> pq {compare};\n\n    P init = {A[0] + B[0] + C[0], 0, 0, 0};\n\n    pq.push(init);\n\n    map<P, int> cnt;\n\n    cnt[init]++;\n\n    vector<ll> ans;\n\n\n\n    while (!pq.empty() && ans.size() < K) {\n\n        P q = pq.top();\n\n        pq.pop();\n\n        ans.push_back(q.taste);\n\n        P newq1 = {A[q.a + 1] + B[q.b] + C[q.c], q.a + 1, q.b, q.c};\n\n        P newq2 = {A[q.a] + B[q.b + 1] + C[q.c], q.a, q.b + 1, q.c};\n\n        P newq3 = {A[q.a] + B[q.b] + C[q.c + 1], q.a, q.b, q.c + 1};\n\n\n\n        if (cnt[newq1] == 0) {\n\n            pq.push(newq1);\n\n            cnt[newq1]++;\n\n        }\n\n        if (cnt[newq2] == 0) {\n\n            pq.push(newq2);\n\n            cnt[newq2]++;\n\n        }\n\n        if (cnt[newq3] == 0) {\n\n            pq.push(newq3);\n\n            cnt[newq3]++;\n\n        }\n\n    }\n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\n#define rall(x) (x).rbegin(), (x).rend()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nvector<ll> AB;\n\nvector<ll> ans;\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X);\n\n    vector<ll> B(Y);\n\n    vector<ll> C(Z);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(rall(C));\n\n\n\n    rep(x, X) rep(y, Y) {\n\n        AB.push_back(A[x] + B[y]);\n\n    }\n\n    sort(rall(AB));\n\n\n\n    rep(i, min(X*Y, K)) rep(z, min(K, Z)) {\n\n        ans.push_back(AB[i] + C[z]);\n\n    }\n\n    sort(rall(ans));\n\n\n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n"
    },
    {
        "id": "59",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\n#define rall(x) (x).rbegin(), (x).rend()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nstruct P {\n\n    ll taste;\n\n    int a;\n\n    int b;\n\n    int c;\n\n\n\n    bool operator<(const P &another) const {\n\n        return taste < another.taste;\n\n    };\n\n};\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X + 2000, -10000000000);\n\n    vector<ll> B(Y + 2000, -10000000000);\n\n    vector<ll> C(Z + 2000, -10000000000);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(rall(A));\n\n    sort(rall(B));\n\n    sort(rall(C));\n\n\n\n    priority_queue<P> pq;\n\n    P init = {A[0] + B[0] + C[0], 0, 0, 0};\n\n    pq.push(init);\n\n    map<vector<int>, int> cnt;\n\n    cnt[{0, 0, 0}]++;\n\n    vector<ll> ans;\n\n\n\n    while (!pq.empty() && ans.size() < K) {\n\n        P q = pq.top();\n\n        pq.pop();\n\n        // printf(\"taste=%d a=%d b=%d c=%d\\n\", q.taste, q.a, q.b, q.c);\n\n        ans.push_back(q.taste);\n\n        P newq1 = {A[q.a + 1] + B[q.b] + C[q.c], q.a + 1, q.b, q.c};\n\n        P newq2 = {A[q.a] + B[q.b + 1] + C[q.c], q.a, q.b + 1, q.c};\n\n        P newq3 = {A[q.a] + B[q.b] + C[q.c + 1], q.a, q.b, q.c + 1};\n\n\n\n        if (q.a+1<X && cnt[{q.a + 1, q.b, q.c}] == 0) {\n\n            // cout << \"1\u3060\u3088\" << endl;\n\n            pq.push(newq1);\n\n            cnt[{q.a + 1, q.b, q.c}]++;\n\n        }\n\n        if (q.b+1<Y && cnt[{q.a, q.b + 1, q.c}] == 0) {\n\n            // cout << \"2\u3060\u3088\" << endl;\n\n            pq.push(newq2);\n\n            cnt[{q.a, q.b + 1, q.c}]++;\n\n        }\n\n        if (q.c+1<Z && cnt[{q.a, q.b, q.c + 1}] == 0) {\n\n            // cout << \"3\u3060\u3088\" << endl;\n\n            pq.push(newq3);\n\n            cnt[{q.a, q.b, q.c + 1}]++;\n\n        }\n\n    }\n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\n#define rall(x) (x).rbegin(), (x).rend()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nvector<ll> ans;\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X);\n\n    vector<ll> B(Y);\n\n    vector<ll> C(Z);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(rall(A));\n\n    sort(rall(B));\n\n    sort(rall(C));\n\n\n\n    rep(i,X)rep(j,Y)rep(k,Z){\n\n        if(i*j*k>K)break;\n\n        ans.push_back(A[i]+B[j]+C[k]);\n\n    }\n\n    sort(rall(ans));\n\n \n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n"
    },
    {
        "id": "60",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\n#define rall(x) (x).rbegin(), (x).rend()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nstruct P {\n\n    ll taste;\n\n    int a;\n\n    int b;\n\n    int c;\n\n\n\n    bool operator<(const P &d) const {\n\n        if (a == d.a && b == d.b && c == d.c) {\n\n            return taste < d.taste;\n\n        } else if (a != d.a) {\n\n            return a < d.a;\n\n        } else if (b != d.b) {\n\n            return b < d.b;\n\n        } else {\n\n            return c < d.c;\n\n        }\n\n    };\n\n};\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X + 2000, -10000000000);\n\n    vector<ll> B(Y + 2000, -10000000000);\n\n    vector<ll> C(Z + 2000, -10000000000);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(rall(A));\n\n    sort(rall(B));\n\n    sort(rall(C));\n\n\n\n    auto compare = [](P a, P b) {\n\n      return a.taste < b.taste;\n\n    };\n\n\n\n    priority_queue<P,vector<P>,decltype(compare)> pq {compare};\n\n    P init = {A[0] + B[0] + C[0], 0, 0, 0};\n\n    pq.push(init);\n\n    map<P, int> cnt;\n\n    cnt[init]++;\n\n    vector<ll> ans;\n\n\n\n    while (!pq.empty() && ans.size() < K) {\n\n        P q = pq.top();\n\n        pq.pop();\n\n        ans.push_back(q.taste);\n\n        P newq1 = {A[q.a + 1] + B[q.b] + C[q.c], q.a + 1, q.b, q.c};\n\n        P newq2 = {A[q.a] + B[q.b + 1] + C[q.c], q.a, q.b + 1, q.c};\n\n        P newq3 = {A[q.a] + B[q.b] + C[q.c + 1], q.a, q.b, q.c + 1};\n\n\n\n        if (cnt[newq1] == 0) {\n\n            pq.push(newq1);\n\n            cnt[newq1]++;\n\n        }\n\n        if (cnt[newq2] == 0) {\n\n            pq.push(newq2);\n\n            cnt[newq2]++;\n\n        }\n\n        if (cnt[newq3] == 0) {\n\n            pq.push(newq3);\n\n            cnt[newq3]++;\n\n        }\n\n    }\n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define all(x) (x).begin(), (x).end()\n\n#define rall(x) (x).rbegin(), (x).rend()\n\nusing ll = long long;\n\nusing namespace std;\n\n\n\nvector<ll> ans;\n\n\n\nint main() {\n\n    int X, Y, Z, K;\n\n    cin >> X >> Y >> Z >> K;\n\n    vector<ll> A(X);\n\n    vector<ll> B(Y);\n\n    vector<ll> C(Z);\n\n    rep(i, X) cin >> A[i];\n\n    rep(i, Y) cin >> B[i];\n\n    rep(i, Z) cin >> C[i];\n\n    sort(rall(A));\n\n    sort(rall(B));\n\n    sort(rall(C));\n\n\n\n    rep(i,X)rep(j,Y)rep(k,Z){\n\n        if(i*j*k>K)break;\n\n        ans.push_back(A[i]+B[j]+C[k]);\n\n    }\n\n    sort(rall(ans));\n\n \n\n    rep(i, K) cout << ans[i] << endl;\n\n}\n"
    },
    {
        "id": "61",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nconst int N = 100010;\n\n\n\nstruct Heap{\n\n\tHeap *l, *r;\n\n\tint val, len, size;\n\n}*root[N], Pool[N * 2], *cur = Pool;\n\n\n\nint fa[N];\n\npriority_queue<pair<int, int> >Q;\n\n\n\nHeap *newnode(int val_)\n\n{\n\n\tcur++;\n\n\tcur -> len = 0;\n\n\tcur -> size = 1;\n\n\tcur -> val = val_;\n\n\tcur -> l = cur -> r = NULL;\n\n\treturn cur;\n\n}\n\n\n\nHeap *Merge(Heap *A, Heap *B)\n\n{\n\n\tif(!A)return B;\n\n\tif(!B)return A;\n\n\tif(A -> val > B -> val)swap(A, B);\n\n\tA -> r = Merge(A -> r, B);\n\n\tA -> size = (A -> l ? A -> l -> size : 0) + (A -> r ? A -> r -> size : 0) + 1;\n\n\tif(!(A -> l))swap(A -> l, A -> r);\n\n\tif(A -> l && A -> r && A -> l -> len < A -> r -> len)swap(A -> l, A -> r);\n\n\tif(A -> r)A -> len = A -> r -> len + 1;\n\n\telse A -> len = 0;\n\n\treturn A;\n\n}\n\n\n\nint getf(int u)\n\n{\n\n\tif(u == fa[u])return u;\n\n\treturn fa[u] = getf(fa[u]);\n\n}\n\n\n\nint main()\n\n{\n\n\tint n, m;\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 1; i <= n; i++)\n\n\t{\n\n\t\tint val;\n\n\t\tscanf(\"%d\", &val);\n\n\t\troot[i] = newnode(val);\n\n\t\tfa[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++)\n\n\t{\n\n\t\tint x, y;\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++; y++;\n\n\t\tint u, v;\n\n\t\tu = getf(x), v = getf(y);\n\n\t\tif(u > v)swap(u, v);\n\n\t\tfa[v] = u;\n\n\t\troot[u] = Merge(root[u], root[v]);\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t\tif(getf(i) == i)\n\n\t\t{\n\n\t\t\tQ.push(make_pair(root[i] -> size, i));\n\n\t\t}\n\n\tlong long ans = 0;\n\n\twhile(Q.size() > 1)\n\n\t{\n\n\t\tpair<int, int> v1 = Q.top();\n\n\t\tQ.pop();\n\n\t\tpair<int, int> v2 = Q.top();\n\n\t\tQ.pop();\n\n\t\tint u = v1.second, v = v2.second;\n\n\t\tif(!root[u] || !root[v])\n\n\t\t{\n\n\t\t\tputs(\"Impossible\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tans += (root[u] -> val + root[v] -> val);\n\n\t\tif(u > v)swap(u, v);\n\n\t\tfa[v] = u;\n\n\t\troot[u] = Merge(Merge(root[u] -> l, root[u] -> r), Merge(root[v] -> l, root[v] -> r));\n\n\t\tif(root[u])Q.push(make_pair(root[u] -> size, u));\n\n\t\telse Q.push(make_pair(0, u));\n\n\t}\n\n\tcout << ans << endl;\n\n}"
    },
    {
        "id": "62",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\n#include <algorithm>\n\n#define N 100010\n\nint n,m,c[N],d[N],k[N];char vis[N];\n\nint fa[N];\n\nint find(int x) {\n\n\treturn ~fa[x]?fa[x]=find(fa[x]):x;\n\n}\n\ninline void join(int a,int b) {\n\n\tint x=find(a),y=find(b);\n\n\tif(x!=y) {\n\n\t\tfa[x]=y;\n\n\t\tif(d[k[y]]>d[k[x]]) k[y]=k[x];\n\n\t}\n\n}\n\nint main() {\n\n\tint a,b;long long ans=0;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tif(n-2*m>2) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(n-1==m) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tmemset(fa,-1,sizeof(fa));\n\n\tfor(int i=0;i<n;++i) scanf(\"%d\",d+i),k[i]=i;\n\n\tfor(int i=0;i<m;++i) {\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tjoin(a,b);\n\n\t}\n\n\tfor(int i=0;i<n;++i) if(!~fa[i]) vis[k[i]]=1,ans+=d[k[i]];\n\n\ta=0;\n\n\tfor(int i=0;i<n;++i) if(!vis[i]) c[a++]=d[i];\n\n\tstd::sort(c,c+a);\n\n\tb=n-m-2;\n\n\tfor(int i=0;i<b;++i) ans+=c[i];\n\n\tprintf(\"%lld\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "63",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nconst int N = 100010;\n\n\n\nstruct Heap{\n\n\tHeap *l, *r;\n\n\tint val, len, size;\n\n}*root[N], Pool[N * 2], *cur = Pool;\n\n\n\nint fa[N];\n\npriority_queue<pair<int, int> >Q;\n\n\n\nHeap *newnode(int val_)\n\n{\n\n\tcur++;\n\n\tcur -> len = 0;\n\n\tcur -> size = 1;\n\n\tcur -> val = val_;\n\n\tcur -> l = cur -> r = NULL;\n\n\treturn cur;\n\n}\n\n\n\nHeap *Merge(Heap *A, Heap *B)\n\n{\n\n\tif(!A)return B;\n\n\tif(!B)return A;\n\n\tif(A -> val > B -> val)swap(A, B);\n\n\tA -> r = Merge(A -> r, B);\n\n\tA -> size = (A -> l ? A -> l -> size : 0) + (A -> r ? A -> r -> size : 0) + 1;\n\n\tif(!(A -> l))swap(A -> l, A -> r);\n\n\tif(A -> l && A -> r && A -> l -> len < A -> r -> len)swap(A -> l, A -> r);\n\n\tif(A -> r)A -> len = A -> r -> len + 1;\n\n\telse A -> len = 0;\n\n\treturn A;\n\n}\n\n\n\nint getf(int u)\n\n{\n\n\tif(u == fa[u])return u;\n\n\treturn fa[u] = getf(fa[u]);\n\n}\n\n\n\nint main()\n\n{\n\n\tint n, m;\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 1; i <= n; i++)\n\n\t{\n\n\t\tint val;\n\n\t\tscanf(\"%d\", &val);\n\n\t\troot[i] = newnode(val);\n\n\t\tfa[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++)\n\n\t{\n\n\t\tint x, y;\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++; y++;\n\n\t\tint u, v;\n\n\t\tu = getf(x), v = getf(y);\n\n\t\tif(u > v)swap(u, v);\n\n\t\tfa[v] = u;\n\n\t\troot[u] = Merge(root[u], root[v]);\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t\tif(getf(i) == i)\n\n\t\t{\n\n\t\t\tQ.push(make_pair(root[i] -> size, i));\n\n\t\t}\n\n\tlong long ans = 0;\n\n\twhile(Q.size() > 1)\n\n\t{\n\n\t\tpair<int, int> v1 = Q.top();\n\n\t\tQ.pop();\n\n\t\tpair<int, int> v2 = Q.top();\n\n\t\tQ.pop();\n\n\t\tint u = v1.second, v = v2.second;\n\n\t\tif(!root[u] || !root[v])\n\n\t\t{\n\n\t\t\tputs(\"Impossible\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tans += (root[u] -> val + root[v] -> val);\n\n\t\tif(u > v)swap(u, v);\n\n\t\tfa[v] = u;\n\n\t\troot[u] = Merge(Merge(root[u] -> l, root[u] -> r), Merge(root[v] -> l, root[v] -> r));\n\n\t\tif(root[u])Q.push(make_pair(root[u] -> size, u));\n\n\t\telse Q.push(make_pair(0, u));\n\n\t}\n\n\tcout << ans << endl;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\n#include <algorithm>\n\n#define N 100010\n\nint n,m,c[N],d[N],k[N];char vis[N];\n\nint fa[N];\n\nint find(int x) {\n\n\treturn ~fa[x]?fa[x]=find(fa[x]):x;\n\n}\n\ninline void join(int a,int b) {\n\n\tint x=find(a),y=find(b);\n\n\tif(x!=y) {\n\n\t\tfa[x]=y;\n\n\t\tif(d[k[y]]>d[k[x]]) k[y]=k[x];\n\n\t}\n\n}\n\nint main() {\n\n\tint a,b;long long ans=0;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tif(n-2*m>2) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(n-1==m) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tmemset(fa,-1,sizeof(fa));\n\n\tfor(int i=0;i<n;++i) scanf(\"%d\",d+i),k[i]=i;\n\n\tfor(int i=0;i<m;++i) {\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tjoin(a,b);\n\n\t}\n\n\tfor(int i=0;i<n;++i) if(!~fa[i]) vis[k[i]]=1,ans+=d[k[i]];\n\n\ta=0;\n\n\tfor(int i=0;i<n;++i) if(!vis[i]) c[a++]=d[i];\n\n\tstd::sort(c,c+a);\n\n\tb=n-m-2;\n\n\tfor(int i=0;i<b;++i) ans+=c[i];\n\n\tprintf(\"%lld\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "64",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n#include <stdlib.h>\n\n#include <string.h>\n\n#include <algorithm>\n\n#define MN 200000\n\n#define MM 200000\n\n#define INF 0x7fffffff\n\nint n,m,a[MN+5];\n\nint hd[MN+5],nxt[MM+5],to[MM+5],rn=0;\n\nint mi1,mi2,lc=0,l[MN+5],lft=2,cnt=0;\n\nlong long ans=0;\n\nbool usd[MN+5],usd2[MN+5];\n\ninline void add(int u,int v){\n\n\t++rn;\n\n\tnxt[rn]=hd[u],hd[u]=rn;\n\n\tto[rn]=v;\n\n}\n\nvoid dfs(int u){\n\n\tusd[u]=true;\n\n\tif(a[u]<mi1){\n\n\t\tmi1=a[u];\n\n\t\tmi2=u;\n\n\t}\n\n\tfor(int i=hd[u];i!=-1;i=nxt[i])\n\n\t\tif(!usd[to[i]]) dfs(to[i]);\n\n}\n\nint main(){\n\n\tmemset(hd,0xff,sizeof(hd));\n\n\tmemset(usd,0,sizeof(usd));\n\n\tmemset(usd2,0,sizeof(usd2));\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tscanf(\"%d\",&a[i]);\n\n\tfor(int i=1;i<=m;i++){\n\n\t\tint u,v; scanf(\"%d%d\",&u,&v);\n\n\t\tu++,v++; add(u,v),add(v,u);\n\n\t}\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tmi1=INF;\n\n\t\tif(!usd[i]) dfs(i);\n\n\t\telse continue;\n\n\t\tcnt++;\n\n\t\tans+=mi1; usd2[mi2]=true;\n\n\t}\n\n\tif(cnt==1) puts(\"0\"),exit(0);\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tif(!usd2[i]) l[++lc]=a[i];\n\n\tif(lc<(n-1-m)*2-cnt) puts(\"Impossible\"),exit(0);\n\n\tstd::sort(l+1,l+1+lc);\n\n\tfor(int i=1;i<=(n-1-m)*2-cnt;i++)\n\n\t\tans+=l[i];\n\n\tprintf(\"%lld\",ans);\n\n}"
    },
    {
        "id": "65",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100005;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            s.erase(s.find(mi[fa[i]]));\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "66",
        "source_code": "#include <stdio.h>\n\n#include <stdlib.h>\n\n#include <string.h>\n\n#include <algorithm>\n\n#define MN 200000\n\n#define MM 200000\n\n#define INF 0x7fffffff\n\nint n,m,a[MN+5];\n\nint hd[MN+5],nxt[MM+5],to[MM+5],rn=0;\n\nint mi1,mi2,lc=0,l[MN+5],lft=2,cnt=0;\n\nlong long ans=0;\n\nbool usd[MN+5],usd2[MN+5];\n\ninline void add(int u,int v){\n\n\t++rn;\n\n\tnxt[rn]=hd[u],hd[u]=rn;\n\n\tto[rn]=v;\n\n}\n\nvoid dfs(int u){\n\n\tusd[u]=true;\n\n\tif(a[u]<mi1){\n\n\t\tmi1=a[u];\n\n\t\tmi2=u;\n\n\t}\n\n\tfor(int i=hd[u];i!=-1;i=nxt[i])\n\n\t\tif(!usd[to[i]]) dfs(to[i]);\n\n}\n\nint main(){\n\n\tmemset(hd,0xff,sizeof(hd));\n\n\tmemset(usd,0,sizeof(usd));\n\n\tmemset(usd2,0,sizeof(usd2));\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tscanf(\"%d\",&a[i]);\n\n\tfor(int i=1;i<=m;i++){\n\n\t\tint u,v; scanf(\"%d%d\",&u,&v);\n\n\t\tu++,v++; add(u,v),add(v,u);\n\n\t}\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tmi1=INF;\n\n\t\tif(!usd[i]) dfs(i);\n\n\t\telse continue;\n\n\t\tcnt++;\n\n\t\tans+=mi1; usd2[mi2]=true;\n\n\t}\n\n\tif(cnt==1) puts(\"0\"),exit(0);\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tif(!usd2[i]) l[++lc]=a[i];\n\n\tif(lc<(n-1-m)*2-cnt) puts(\"Impossible\"),exit(0);\n\n\tstd::sort(l+1,l+1+lc);\n\n\tfor(int i=1;i<=(n-1-m)*2-cnt;i++)\n\n\t\tans+=l[i];\n\n\tprintf(\"%lld\",ans);\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100005;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            s.erase(s.find(mi[fa[i]]));\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "67",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ninline int read(){\n\n\tint x=0,f=1;char ch=getchar();\n\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\n\treturn x*f;\n\n}\n\n#define MN 100005\n\nint n,m,fa[MN],vis[MN],cnt,p[MN],ct;\n\nlong long a[MN],ans;\n\nint findf(int x){return fa[x]==x?fa[x]:fa[x]=findf(fa[x]);}\n\nvoid union_(int x,int y){x=findf(x);y=findf(y);fa[x]=y;return;}\n\nvector<int> pic[MN];\n\nint main(){\n\n\tn=read(),m=read();\n\n\tregister int i,j,x,y;\n\n\tfor(i=1;i<=n;i++) a[i]=read(),fa[i]=i;\n\n\tfor(i=1;i<=m;i++){\n\n\t\tx=read()+1,y=read()+1;\n\n\t\tunion_(x,y);\n\n\t}\n\n\tif(m==n-1) return puts(\"0\"),0;\n\n\tif((n-m-1)*2>n) return puts(\"Impossible\\n\"),0;\n\n\tfor(i=1;i<=n;i++){\n\n\t\tif(vis[findf(i)]) pic[vis[fa[i]]].push_back(a[i]);\n\n\t\telse pic[vis[findf(i)]=++cnt].push_back(a[i]);\n\n\t}\n\n\tfor(i=1;i<=cnt;i++){\n\n\t\tsort(pic[i].begin(),pic[i].end()),ans+=pic[i][0];\n\n\t\tfor(j=1;j<pic[i].size();j++) p[++ct]=pic[i][j];\n\n\t}\n\n\tsort(p+1,p+ct+1);\n\n\tfor(i=1;i<=n-m-2;i++) ans+=p[i];\n\n\tprintf(\"%lld\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100005;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            s.erase(s.find(mi[fa[i]]));\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "68",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100010;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            s.erase(s.find(mi[fa[i]]));\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "69",
        "source_code": "#include <stdio.h>\n\n#include <stdlib.h>\n\n#include <string.h>\n\n#include <algorithm>\n\n#define MN 200000\n\n#define MM 200000\n\n#define INF 0x7fffffff\n\nint n,m,a[MN+5];\n\nint hd[MN+5],nxt[MM+5],to[MM+5],rn=0;\n\nint mi1,mi2,lc=0,l[MN+5],lft=2,cnt=0;\n\nlong long ans=0;\n\nbool usd[MN+5],usd2[MN+5];\n\ninline void add(int u,int v){\n\n\t++rn;\n\n\tnxt[rn]=hd[u],hd[u]=rn;\n\n\tto[rn]=v;\n\n}\n\nvoid dfs(int u){\n\n\tusd[u]=true;\n\n\tif(a[u]<mi1){\n\n\t\tmi1=a[u];\n\n\t\tmi2=u;\n\n\t}\n\n\tfor(int i=hd[u];i!=-1;i=nxt[i])\n\n\t\tif(!usd[to[i]]) dfs(to[i]);\n\n}\n\nint main(){\n\n\tmemset(hd,0xff,sizeof(hd));\n\n\tmemset(usd,0,sizeof(usd));\n\n\tmemset(usd2,0,sizeof(usd2));\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tscanf(\"%d\",&a[i]);\n\n\tfor(int i=1;i<=m;i++){\n\n\t\tint u,v; scanf(\"%d%d\",&u,&v);\n\n\t\tu++,v++; add(u,v),add(v,u);\n\n\t}\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tmi1=INF;\n\n\t\tif(!usd[i]) dfs(i);\n\n\t\telse continue;\n\n\t\tcnt++;\n\n\t\tans+=mi1; usd2[mi2]=true;\n\n\t}\n\n\tif(cnt==1) puts(\"0\"),exit(0);\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tif(!usd2[i]) l[++lc]=a[i];\n\n\tif(lc<(n-1-m)*2-cnt) puts(\"Impossible\"),exit(0);\n\n\tstd::sort(l+1,l+1+lc);\n\n\tfor(int i=1;i<=(n-1-m)*2-cnt;i++)\n\n\t\tans+=l[i];\n\n\tprintf(\"%lld\",ans);\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100010;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            s.erase(s.find(mi[fa[i]]));\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "70",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ninline int read(){\n\n\tint x=0,f=1;char ch=getchar();\n\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\n\treturn x*f;\n\n}\n\n#define MN 100005\n\nint n,m,fa[MN],vis[MN],cnt,p[MN],ct;\n\nlong long a[MN],ans;\n\nint findf(int x){return fa[x]==x?fa[x]:fa[x]=findf(fa[x]);}\n\nvoid union_(int x,int y){x=findf(x);y=findf(y);fa[x]=y;return;}\n\nvector<int> pic[MN];\n\nint main(){\n\n\tn=read(),m=read();\n\n\tregister int i,j,x,y;\n\n\tfor(i=1;i<=n;i++) a[i]=read(),fa[i]=i;\n\n\tfor(i=1;i<=m;i++){\n\n\t\tx=read()+1,y=read()+1;\n\n\t\tunion_(x,y);\n\n\t}\n\n\tif(m==n-1) return puts(\"0\"),0;\n\n\tif((n-m-1)*2>n) return puts(\"Impossible\\n\"),0;\n\n\tfor(i=1;i<=n;i++){\n\n\t\tif(vis[findf(i)]) pic[vis[fa[i]]].push_back(a[i]);\n\n\t\telse pic[vis[findf(i)]=++cnt].push_back(a[i]);\n\n\t}\n\n\tfor(i=1;i<=cnt;i++){\n\n\t\tsort(pic[i].begin(),pic[i].end()),ans+=pic[i][0];\n\n\t\tfor(j=1;j<pic[i].size();j++) p[++ct]=pic[i][j];\n\n\t}\n\n\tsort(p+1,p+ct+1);\n\n\tfor(i=1;i<=n-m-2;i++) ans+=p[i];\n\n\tprintf(\"%lld\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100010;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            s.erase(s.find(mi[fa[i]]));\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "71",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<algorithm>\n\n#include<cstring>\n\n#include<string>\n\n#include<vector>\n\n#include<bitset>\n\n#include<queue>\n\n#include<map>\n\n#include<set>\n\nusing namespace std;\n\n#define ri register int \n\n#define il inline\n\n#define pairint pair<int,int>\n\n#define mp make_pair\n\n#define pb push_back\n\n#define fi first\n\n#define se second\n\n#define LL long long\n\n#define gc getchar\n\ntemplate<class T>il void in(T &x)\n\n{\n\n    x=0;bool f=0;char c=gc();\n\n    while(c<'0'||c>'9') \n\n    {\n\n        if(c=='-') f=1;\n\n        c=gc();\n\n    }\n\n    while(c>='0'&&c<='9') x=x*10+(c^'0'),c=gc();\n\n    if(f) x=-x;\n\n} \n\n#undef gc\n\n#define N 100005\n\n#define M N<<1\n\nint n,m;\n\nint val[N];\n\nint v[M],nx[M];\n\nint head[N],cnte=1;\n\nil void adde(int uu,int vv)\n\n{\n\n\tv[++cnte]=vv,nx[cnte]=head[uu];\n\n\thead[uu]=cnte;\n\n}\n\nbool vis[N];\n\nint cnt;\n\npriority_queue<int,vector<int>,greater<int> > q[N];\n\nvoid dfs(int x)\n\n{\n\n\tq[cnt].push(val[x]);\n\n\tvis[x]=1;\n\n\tfor(ri i=head[x];i;i=nx[i])\n\n\t\tif(!vis[v[i]]) dfs(v[i]);\n\n}\n\nsigned main()\n\n{\n\n#ifdef M207\n\n    freopen(\"in.in\",\"r\",stdin);\n\n#endif\n\n\tin(n),in(m);\n\n\tfor(ri i=1;i<=n;++i) in(val[i]);\n\n\tfor(ri i=1,a,b;i<=m;++i)\n\n\t{\n\n\t\tin(a),in(b); ++a,++b;\n\n\t\tadde(a,b);adde(b,a);\n\n\t}\n\n\tfor(ri i=1;i<=n;++i)\n\n\t\tif(!vis[i])\n\n\t\t{\n\n\t\t\t++cnt;\n\n\t\t\tdfs(i);\n\n\t\t}\n\n\tif(cnt==1)\n\n\t{\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tLL ans=0;\n\n\tfor(ri i=1;i<=cnt;++i)\n\n\t{\n\n\t\tans+=q[i].top();\n\n\t\tq[i].pop();\n\n\t\twhile(!q[i].empty()) q[0].push(q[i].top()),q[i].pop();\n\n\t}\n\n\tcnt-=2;\n\n\tif((int)q[0].size()<cnt) \n\n\t{\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\twhile(cnt--) ans+=q[0].top(),q[0].pop();\n\n\tprintf(\"%lld\",ans);\n\n    return 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn=100005;\n\npriority_queue<int,vector<int>,greater<int> >q;\n\nvector<int>vec[maxn];\n\nint a[maxn],fa[maxn];\n\nint Find(int x){return fa[x]==x?fa[x]:fa[x]=Find(fa[x]);}\n\nvoid Union(int x,int y){\n\n    int xx=Find(x),yy=Find(y);\n\n    if(xx!=yy) fa[xx]=yy;\n\n}\n\nvoid read(int &ret){\n\n    ret=0;\n\n    char ch=getchar();\n\n    while(ch>'9'||ch<'0') ch=getchar();\n\n    while(ch>='0'&&ch<='9'){\n\n        ret=ret*10+ch-'0';\n\n        ch=getchar();\n\n    }\n\n}\n\nint main(){\n\n    int n,m;\n\n    read(n),read(m);\n\n    for(int i=0;i<=n;i++) fa[i]=i;\n\n    for(int i=0;i<n;i++){read(a[i]);}\n\n    int u,v;\n\n    for(int i=1;i<=m;i++){\n\n        read(u),read(v);\n\n        Union(u,v);\n\n    }\n\n    if(n==m+1){puts(\"0\");return 0;}\n\n    for(int i=0;i<n;i++){vec[Find(i)].push_back(a[i]);}\n\n    long long ans=0;\n\n    int cnt=0;\n\n    for(int i=0;i<n;i++){\n\n        if(vec[i].size()){\n\n            sort(vec[i].begin(),vec[i].end());\n\n            ans+=vec[i][0];\n\n            cnt++;\n\n            for(int j=1;j<vec[i].size();j++) q.push(vec[i][j]);\n\n        }\n\n    }\n\n    if((n-m-1)*2>n){puts(\"Impossible\");return 0;}\n\n    while(!q.empty()){\n\n        if(cnt>=(n-m-1)*2) break;\n\n        ans+=q.top();q.pop();\n\n        cnt+=1;\n\n    }\n\n    printf(\"%lld\\n\",ans);\n\n    return 0;\n\n}\n"
    },
    {
        "id": "72",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll=long long;\n\ntemplate<class T> using V = vector<T>;\n\ntemplate<class T, class U> using P = pair<T, U>;\n\nusing vll = V<ll>;\n\nusing vvll = V<vll>;\n\n#define rep(i, k, n) for (ll i=k; i<(ll)n; ++i)\n\n#define REP(i, n) rep(i, 0, n)\n\n\n\nconst ll MOD = 10007;\n\nconst ll HIGHINF = (ll)1e18;\n\n\n\nvll forest(100000, -1);\n\nvvll nodes(100000, vll());\n\nvll a(100000);\n\nV<bool> used(100000, false);\n\n\n\nll dfs(ll i, ll k) {\n\n  ll mini = i;\n\n  REP(nxt, nodes.at(i).size()) {\n\n    if (forest.at(nodes.at(i).at(nxt)) == -1) {\n\n      forest.at(nodes.at(i).at(nxt)) = k;\n\n      ll ci = dfs(nodes.at(i).at(nxt), k);\n\n      if (a.at(mini) > a.at(ci)) mini = ci;\n\n    }\n\n  }\n\n  return mini;\n\n}\n\n\n\nint main() {\n\n  ll n, m; cin >> n >> m;\n\n  REP(i, n) cin >> a.at(i);\n\n  REP(i, m) {\n\n    ll x, y; cin >> x >> y;\n\n    nodes.at(x).push_back(y);\n\n    nodes.at(y).push_back(x);\n\n  }\n\n  if (m == n-1) cout << 0 << endl;\n\n  else if (n < 2*(n-m-1)) cout << \"Impossible\" << endl;\n\n  else {\n\n    ll k = 0;\n\n    REP(i, n) {\n\n      if (forest.at(i) == -1) {\n\n        forest.at(i) = k;\n\n        ll mini = dfs(i, k);\n\n        used.at(mini) = true;\n\n        k++;\n\n      }\n\n    }\n\n    ll ans = 0, c = 0;\n\n    priority_queue<ll, vll, greater<ll>> pq;\n\n    REP(i, n) {\n\n      if (!used.at(i)) pq.push(a.at(i));\n\n      else {\n\n        ans += a.at(i); c++;\n\n      }\n\n    }\n\n    REP(i, 2*(n-m-1)-c) {\n\n      ans += pq.top(); pq.pop();\n\n    }\n\n    cout << ans << endl;\n\n  }\n\n  return 0;\n\n}\n",
        "optimized_code": "#include <iostream>\n\n#include <array>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <bitset>\n\n#include <set>\n\n#include <unordered_set>\n\n#include <cmath>\n\n#include <complex>\n\n#include <deque>\n\n#include <iterator>\n\n#include <numeric>\n\n#include <map>\n\n#include <unordered_map>\n\n#include <queue>\n\n#include <stack>\n\n#include <string>\n\n#include <tuple>\n\n#include <utility>\n\n#include <limits>\n\n#include <iomanip>\n\n#include <functional>\n\n#include <cassert>\n\nusing namespace std;\n\n\n\nusing ll=long long;\n\ntemplate<class T> using V = vector<T>;\n\ntemplate<class T, class U> using P = pair<T, U>;\n\nusing vll = V<ll>;\n\nusing vvll = V<vll>;\n\n#define rep(i, k, n) for (ll i=k; i<(ll)n; ++i)\n\n#define REP(i, n) rep(i, 0, n)\n\n#define ALL(v) v.begin(),v.end()\n\ntemplate < class T > inline bool chmax(T& a, T b) {if (a < b) { a=b; return true; } return false; }\n\ntemplate < class T > inline bool chmin(T& a, T b) {if (a > b) { a=b; return true; } return false; }\n\n#define DEBUG_VLL(vec) REP(sz, vec.size()) std::cerr<<vec[sz]<<(sz==vec.size()-1?'\\n':' ');\n\n\n\nconst long long MOD = 1000000007;\n\nconst long long HIGHINF = (long long)1e18;\n\nconst int INF = (int)1e9;\n\n\n\nll n, m;\n\nvll a;\n\nV< V<int> > edges;\n\n\n\nV<int> col;\n\nvoid dfs(int i, int p, int c) {\n\n    if (col[i] != -1) return;\n\n    col[i] = c;\n\n    for (int e: edges[i]) {\n\n        if (e == p) continue;\n\n        if (col[e] == -1) dfs(e, i, c);\n\n    }\n\n}\n\n\n\nint main() {\n\n    cin.tie(0);\n\n    ios::sync_with_stdio(false);\n\n    cin >> n >> m;\n\n    a.resize(n), edges.resize(n);\n\n    for (ll i = 0; i < n; i++) cin >> a[i];\n\n    for (ll i = 0; i < m; i++) {\n\n        int x, y; cin >> x >> y;\n\n        edges[x].emplace_back(y);\n\n        edges[y].emplace_back(x);\n\n    }\n\n\n\n    if (n - m == 1) cout << 0 << '\\n';\n\n    else if (n > 2 * (m + 1)) cout << \"Impossible\\n\";\n\n    else {\n\n        col.resize(n, -1);\n\n        int c = 0;\n\n        for (int i = 0; i < n; i++) {\n\n            if (col[i] == -1) {\n\n                dfs(i, -1, c);\n\n                c++;\n\n            }\n\n        }\n\n\n\n        vvll aset(c);\n\n        for (int i = 0; i < n; i++) {\n\n            aset[col[i]].emplace_back(a[i]);\n\n        }\n\n\n\n        ll ans = 0;\n\n        priority_queue<ll> pq;\n\n        for (int i = 0; i < c; i++) {\n\n            sort(ALL(aset[i]));\n\n            ans += aset[i][0];\n\n            for (int j = 1; j < aset[i].size(); j++) {\n\n                pq.push(-(aset[i][j]));\n\n            }\n\n        }\n\n\n\n        for (int i = 0; i < 2 * (n - m - 1) - c; i++) {\n\n            ans += -pq.top();\n\n            pq.pop();\n\n        }\n\n        cout << ans << '\\n';\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "73",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\n\n\nconst int maxn = 1e5 + 5;\n\n\n\nint n, m, k;\n\nint w[maxn], f[maxn];\n\nll ans;\n\npriority_queue <int, vector<int>, greater<int>> q[maxn];\n\nmultiset <int> s;\n\n\n\nint find(int x)\n\n{\n\n\treturn f[x] == x ? x : f[x] = find(f[x]);\n\n}\n\n\n\nvoid merge(int x, int y)\n\n{\n\n\tint fx = find(x);\n\n\tint fy = find(y);\n\n\tif(fx != fy)\n\n\t\tf[fx] = fy;\n\n}\n\n\n\nint main()\n\n{\n\n\tint u, v;\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tk = n - m;\n\n\tif(2 * k - 2 > n)\n\n\t{\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(k == 1)\n\n\t{\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t{\n\n\t\tscanf(\"%d\", &w[i]);\n\n\t\tf[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++)\n\n\t{\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++, v++;\n\n\t\tmerge(u, v);\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t{\n\n\t\tfind(i);\n\n\t\tq[f[i]].push(w[i]);\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t\tif(!q[i].empty())\n\n\t\t{\n\n\t\t\tans += q[i].top();\n\n\t\t\tq[i].pop();\n\n\t//\t\tprintf(\"val = %lld\\n\", val);\n\n\t\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t\twhile(!q[i].empty())\n\n\t\t{\n\n\t\t\ts.insert(q[i].top());\n\n\t\t\tq[i].pop();\n\n\t\t}\t\n\n//\tfor(auto it = s.begin(); it != s.end(); it++)\n\n//\t\tprintf(\"%d\\n\", *it);\n\n\tauto it = s.begin();\n\n\tfor(int i = 1; i <= k - 2; i++, it++)\n\n\t{\n\n\t\tans += *it;\n\n\t//\tprintf(\"%lld\\n\", ans);\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nconst int MAXN = 101010;\n\n\n\nint a[MAXN];\n\n\n\nclass Node {\n\npublic:\n\n\tint v;\n\n\tNode *l, *r;\n\n\tint key;\n\n\t\n\n\tNode(int x) {\n\n\t\tv = a[x];\n\n\t\tl = r = 0;\n\n\t\tkey = 1;\n\n\t}\n\n};\n\n\n\n//set<pair<int,int> > s;\n\n\n\nclass Road {\n\npublic:\n\n\tint t, next;\n\n}e[MAXN * 2];\n\nint p[MAXN];\n\nint z = -1;\n\n\n\nint vis[MAXN];\n\n\n\nvoid add(int u, int v) {\n\n\t++z;\n\n\te[z].t = v;\n\n\te[z].next = p[u];\n\n\tp[u] = z;\n\n}\n\n\n\nNode *root[MAXN];\n\n\n\nint getkey(Node *now) {\n\n\treturn now ? now->key : 0;\n\n}\n\n\n\nvoid update(Node *now) {\n\n\tnow->key = getkey(now->r) + 1;\n\n}\n\n\n\nNode* merge(Node *&l, Node *&r) {\n\n\tif(!l)\n\n\t\treturn r;\n\n\tif(!r)\n\n\t\treturn l;\n\n//\tcout<<l->v<<\" \"<<r->v<<endl;\n\n\tif(l->v < r->v) {\n\n\t\tl->r = merge(l->r, r);\n\n\t\tif(getkey(l->l) < getkey(l->r))\n\n\t\t\tswap(l->l, l->r);\n\n\t\tupdate(l);\n\n\t\treturn l;\n\n\t}\n\n\telse {\n\n\t\tr->r = merge(l, r->r);\n\n\t\tif(getkey(r->l) < getkey(r->r))\n\n\t\t\tswap(r->l, r->r);\n\n\t\tupdate(r);\n\n\t\treturn r;\n\n\t}\n\n}\n\n\n\nvoid dfs(int u, int fa, int tag) {\n\n\tvis[u] = tag;\n\n\tif(u != tag) {\n\n\t\troot[tag] = merge(root[tag], root[u]);\n\n\t\troot[u] = 0;\n\n\t}\n\n\tfor(int tmp = p[u]; tmp != -1; tmp = e[tmp].next) {\n\n\t\tif(e[tmp].t != fa) {\n\n\t\t\tdfs(e[tmp].t, u, tag);\n\n\t\t}\n\n\t}\n\n} \n\n\n\nvoid del(Node *&now) {\n\n\t//print(now);\n\n\tnow = merge(now->l, now->r);\n\n}\n\n\n\n\n\nint n, m;\n\n\n\nint main() {\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 0; i < n; ++i) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\t\troot[i] = new Node(i);\n\n\t}\n\n\tint u, v;\n\n\tmemset(p, -1, sizeof(p));\n\n\t\n\n\tfor(int i = 1; i <= m; ++i) {\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tadd(u, v);\n\n\t\tadd(v, u);\n\n\t}\n\n\tmemset(vis, -1, sizeof(vis));\n\n\t\n\n\tint cnt = 0;\n\n\tlong long ss = 0;\n\n\tNode *tmp = 0;\n\n\tfor(int i = 0; i < n; ++i) {\n\n\t\tif(vis[i] == -1) {\n\n\t\t\t++cnt;\n\n\t\t\tdfs(i, -1, i);\n\n\t\t\tss += root[i]->v;\n\n\t\t\tdel(root[i]);\n\n\t\t\ttmp = merge(tmp, root[i]);\n\n\t\t}\n\n\t}\n\n\tif((n - 1 - m) * 2 > n) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(m == n - 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\t\n\n\tint need = (n - 1 - m) * 2 - cnt;\n\n\tfor(int i = 1; i <= need; ++i) {\n\n\t\tss += tmp->v;\n\n\t\tdel(tmp);\n\n\t}\n\n\t\n\n\t//if(cnt >= n - 1) {\n\n\t\tprintf(\"%lld\\n\", ss);\n\n\t//}\n\n\t/*else {\n\n\t\tputs(\"Impossible\");\n\n\t}*/\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "74",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\n\n\nconst int maxn = 1e5 + 5;\n\n\n\nint n, m, k;\n\nint w[maxn], f[maxn];\n\nll ans;\n\npriority_queue <int, vector<int>, greater<int>> q[maxn];\n\nmultiset <int> s;\n\n\n\nint find(int x)\n\n{\n\n\treturn f[x] == x ? x : f[x] = find(f[x]);\n\n}\n\n\n\nvoid merge(int x, int y)\n\n{\n\n\tint fx = find(x);\n\n\tint fy = find(y);\n\n\tif(fx != fy)\n\n\t\tf[fx] = fy;\n\n}\n\n\n\nint main()\n\n{\n\n\tint u, v;\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tk = n - m;\n\n\tif(2 * k - 2 > n)\n\n\t{\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(k == 1)\n\n\t{\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t{\n\n\t\tscanf(\"%d\", &w[i]);\n\n\t\tf[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++)\n\n\t{\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++, v++;\n\n\t\tmerge(u, v);\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t{\n\n\t\tfind(i);\n\n\t\tq[f[i]].push(w[i]);\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t\tif(!q[i].empty())\n\n\t\t{\n\n\t\t\tans += q[i].top();\n\n\t\t\tq[i].pop();\n\n\t//\t\tprintf(\"val = %lld\\n\", val);\n\n\t\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t\twhile(!q[i].empty())\n\n\t\t{\n\n\t\t\ts.insert(q[i].top());\n\n\t\t\tq[i].pop();\n\n\t\t}\t\n\n//\tfor(auto it = s.begin(); it != s.end(); it++)\n\n//\t\tprintf(\"%d\\n\", *it);\n\n\tauto it = s.begin();\n\n\tfor(int i = 1; i <= k - 2; i++, it++)\n\n\t{\n\n\t\tans += *it;\n\n\t//\tprintf(\"%lld\\n\", ans);\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#define maxn 100005\n\n#define LL long long\n\nusing namespace std;\n\nint n,m,fa[maxn],use[maxn],cnt;\n\nLL ans;\n\nstruct node { int w;bool vis; } a[maxn];\n\nbool cmp(node p,node q) \n\n{\n\n\tif(p.vis) return false;\n\n\tif(q.vis) return true;\n\n\treturn p.w<q.w; \n\n}\n\nint find(int x)\n\n{\n\n\tif(fa[x]==x) return x;\n\n\treturn fa[x]=find(fa[x]);\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d\",&a[i].w);\n\n\t\tfa[i]=i;use[i]=i;\n\n\t\ta[i].vis=true;\n\n\t}\n\n\tfor(int i=1;i<=m;i++)\n\n\t{\n\n\t\tint u,v;\n\n\t\tscanf(\"%d%d\",&u,&v);\n\n\t\tu++,v++;\n\n\t\tint r1=find(u),r2=find(v);\n\n\t\tif(r1!=r2)\n\n\t\t{\n\n\t\t\tif(a[use[r2]].w<a[use[r1]].w)\n\n\t\t\t{\n\n\t\t\t\ta[use[r1]].vis=false;\n\n\t\t\t\tuse[r1]=use[r2];\n\n\t\t\t}\n\n\t\t\telse a[use[r2]].vis=false;\n\n\t\t\tfa[r2]=r1;\n\n\t\t}\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tif(find(i)==i) \n\n\t\t{\n\n\t\t\tans+=1ll*a[use[i]].w;\n\n\t\t\tcnt++;\n\n\t\t}\n\n\tif(cnt==1)\n\n\t{\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tsort(a+1,a+n+1,cmp);\n\n\tfor(int i=1;i<=cnt-2;i++)\n\n\t\tif(a[i].vis)\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\telse ans+=1ll*a[i].w;\n\n\tprintf(\"%lld\\n\",ans);\n\n}"
    },
    {
        "id": "75",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nconst int MAXN = 101010;\n\n\n\nint a[MAXN];\n\n\n\nclass Node {\n\npublic:\n\n\tint v;\n\n\tNode *l, *r;\n\n\tint key;\n\n\t\n\n\tNode(int x) {\n\n\t\tv = a[x];\n\n\t\tl = r = 0;\n\n\t\tkey = 1;\n\n\t}\n\n};\n\n\n\n//set<pair<int,int> > s;\n\n\n\nclass Road {\n\npublic:\n\n\tint t, next;\n\n}e[MAXN * 2];\n\nint p[MAXN];\n\nint z = -1;\n\n\n\nint vis[MAXN];\n\n\n\nvoid add(int u, int v) {\n\n\t++z;\n\n\te[z].t = v;\n\n\te[z].next = p[u];\n\n\tp[u] = z;\n\n}\n\n\n\nNode *root[MAXN];\n\n\n\nint getkey(Node *now) {\n\n\treturn now ? now->key : 0;\n\n}\n\n\n\nvoid update(Node *now) {\n\n\tnow->key = getkey(now->r) + 1;\n\n}\n\n\n\nNode* merge(Node *&l, Node *&r) {\n\n\tif(!l)\n\n\t\treturn r;\n\n\tif(!r)\n\n\t\treturn l;\n\n//\tcout<<l->v<<\" \"<<r->v<<endl;\n\n\tif(l->v < r->v) {\n\n\t\tl->r = merge(l->r, r);\n\n\t\tif(getkey(l->l) < getkey(l->r))\n\n\t\t\tswap(l->l, l->r);\n\n\t\tupdate(l);\n\n\t\treturn l;\n\n\t}\n\n\telse {\n\n\t\tr->r = merge(l, r->r);\n\n\t\tif(getkey(r->l) < getkey(r->r))\n\n\t\t\tswap(r->l, r->r);\n\n\t\tupdate(r);\n\n\t\treturn r;\n\n\t}\n\n}\n\n\n\nvoid dfs(int u, int fa, int tag) {\n\n\tvis[u] = tag;\n\n\tif(u != tag) {\n\n\t\troot[tag] = merge(root[tag], root[u]);\n\n\t\troot[u] = 0;\n\n\t}\n\n\tfor(int tmp = p[u]; tmp != -1; tmp = e[tmp].next) {\n\n\t\tif(e[tmp].t != fa) {\n\n\t\t\tdfs(e[tmp].t, u, tag);\n\n\t\t}\n\n\t}\n\n} \n\n\n\nvoid del(Node *&now) {\n\n\t//print(now);\n\n\tnow = merge(now->l, now->r);\n\n}\n\n\n\n\n\nint n, m;\n\n\n\nint main() {\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 0; i < n; ++i) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\t\troot[i] = new Node(i);\n\n\t}\n\n\tint u, v;\n\n\tmemset(p, -1, sizeof(p));\n\n\t\n\n\tfor(int i = 1; i <= m; ++i) {\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tadd(u, v);\n\n\t\tadd(v, u);\n\n\t}\n\n\tmemset(vis, -1, sizeof(vis));\n\n\t\n\n\tint cnt = 0;\n\n\tlong long ss = 0;\n\n\tNode *tmp = 0;\n\n\tfor(int i = 0; i < n; ++i) {\n\n\t\tif(vis[i] == -1) {\n\n\t\t\t++cnt;\n\n\t\t\tdfs(i, -1, i);\n\n\t\t\tss += root[i]->v;\n\n\t\t\tdel(root[i]);\n\n\t\t\ttmp = merge(tmp, root[i]);\n\n\t\t}\n\n\t}\n\n\tif((n - 1 - m) * 2 > n) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(m == n - 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\t\n\n\tint need = (n - 1 - m) * 2 - cnt;\n\n\tfor(int i = 1; i <= need; ++i) {\n\n\t\tss += tmp->v;\n\n\t\tdel(tmp);\n\n\t}\n\n\t\n\n\t//if(cnt >= n - 1) {\n\n\t\tprintf(\"%lld\\n\", ss);\n\n\t//}\n\n\t/*else {\n\n\t\tputs(\"Impossible\");\n\n\t}*/\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#define maxn 100005\n\n#define LL long long\n\nusing namespace std;\n\nint n,m,fa[maxn],use[maxn],cnt;\n\nLL ans;\n\nstruct node { int w;bool vis; } a[maxn];\n\nbool cmp(node p,node q) \n\n{\n\n\tif(p.vis) return false;\n\n\tif(q.vis) return true;\n\n\treturn p.w<q.w; \n\n}\n\nint find(int x)\n\n{\n\n\tif(fa[x]==x) return x;\n\n\treturn fa[x]=find(fa[x]);\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d\",&a[i].w);\n\n\t\tfa[i]=i;use[i]=i;\n\n\t\ta[i].vis=true;\n\n\t}\n\n\tfor(int i=1;i<=m;i++)\n\n\t{\n\n\t\tint u,v;\n\n\t\tscanf(\"%d%d\",&u,&v);\n\n\t\tu++,v++;\n\n\t\tint r1=find(u),r2=find(v);\n\n\t\tif(r1!=r2)\n\n\t\t{\n\n\t\t\tif(a[use[r2]].w<a[use[r1]].w)\n\n\t\t\t{\n\n\t\t\t\ta[use[r1]].vis=false;\n\n\t\t\t\tuse[r1]=use[r2];\n\n\t\t\t}\n\n\t\t\telse a[use[r2]].vis=false;\n\n\t\t\tfa[r2]=r1;\n\n\t\t}\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tif(find(i)==i) \n\n\t\t{\n\n\t\t\tans+=1ll*a[use[i]].w;\n\n\t\t\tcnt++;\n\n\t\t}\n\n\tif(cnt==1)\n\n\t{\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tsort(a+1,a+n+1,cmp);\n\n\tfor(int i=1;i<=cnt-2;i++)\n\n\t\tif(a[i].vis)\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\telse ans+=1ll*a[i].w;\n\n\tprintf(\"%lld\\n\",ans);\n\n}"
    },
    {
        "id": "76",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\n\n\nconst int maxn = 1e5 + 5;\n\n\n\nint n, m, k;\n\nint w[maxn], f[maxn];\n\nll ans;\n\npriority_queue <int, vector<int>, greater<int>> q[maxn];\n\nmultiset <int> s;\n\n\n\nint find(int x)\n\n{\n\n\treturn f[x] == x ? x : f[x] = find(f[x]);\n\n}\n\n\n\nvoid merge(int x, int y)\n\n{\n\n\tint fx = find(x);\n\n\tint fy = find(y);\n\n\tif(fx != fy)\n\n\t\tf[fx] = fy;\n\n}\n\n\n\nint main()\n\n{\n\n\tint u, v;\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tk = n - m;\n\n\tif(2 * k - 2 > n)\n\n\t{\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(k == 1)\n\n\t{\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t{\n\n\t\tscanf(\"%d\", &w[i]);\n\n\t\tf[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++)\n\n\t{\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++, v++;\n\n\t\tmerge(u, v);\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t{\n\n\t\tfind(i);\n\n\t\tq[f[i]].push(w[i]);\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t\tif(!q[i].empty())\n\n\t\t{\n\n\t\t\tans += q[i].top();\n\n\t\t\tq[i].pop();\n\n\t//\t\tprintf(\"val = %lld\\n\", val);\n\n\t\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t\twhile(!q[i].empty())\n\n\t\t{\n\n\t\t\ts.insert(q[i].top());\n\n\t\t\tq[i].pop();\n\n\t\t}\t\n\n//\tfor(auto it = s.begin(); it != s.end(); it++)\n\n//\t\tprintf(\"%d\\n\", *it);\n\n\tauto it = s.begin();\n\n\tfor(int i = 1; i <= k - 2; i++, it++)\n\n\t{\n\n\t\tans += *it;\n\n\t//\tprintf(\"%lld\\n\", ans);\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<algorithm>\n\ntypedef long long ll;\n\nconst int N=1e5+5,INF=1e9+7;\n\nint n,m,par[N],id[N],a[N];\n\nvoid init(){\n\n    for(int i=0;i<n;i++) par[i]=i,id[i]=i;\n\n}\n\nint fd(int x) {\n\n    return par[x]==x?x:par[x]=fd(par[x]);\n\n}\n\nint main() {\n\n    scanf(\"%d%d\",&n,&m);\n\n    for(int i=0;i<n;i++) scanf(\"%d\",a+i);init();\n\n    int x,y;\n\n    while(m--) {\n\n        scanf(\"%d%d\",&x,&y);\n\n        x=fd(x);y=fd(y);\n\n        if(x==y) continue;\n\n        if(a[id[y]]>a[id[x]]) id[y]=id[x];\n\n        par[x]=y;\n\n    }\n\n    ll ans=0;int tot=0;\n\n    for(int i=0;i<n;i++) if(fd(i)==i) tot++,ans+=a[id[i]],a[id[i]]=INF;\n\n    if(tot==1) printf(\"0\\n\");\n\n    else {\n\n        std::sort(a,a+n);bool ok=true;\n\n        for(int i=0;i<tot-2;i++) {\n\n            ans+=a[i];\n\n            if(a[i]>=INF) ok=false;\n\n        }\n\n        if(ok) printf(\"%lld\\n\",ans);\n\n        else printf(\"Impossible\\n\");\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "77",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nconst int MAXN = 101010;\n\n\n\nint a[MAXN];\n\n\n\nclass Node {\n\npublic:\n\n\tint v;\n\n\tNode *l, *r;\n\n\tint key;\n\n\t\n\n\tNode(int x) {\n\n\t\tv = a[x];\n\n\t\tl = r = 0;\n\n\t\tkey = 1;\n\n\t}\n\n};\n\n\n\n//set<pair<int,int> > s;\n\n\n\nclass Road {\n\npublic:\n\n\tint t, next;\n\n}e[MAXN * 2];\n\nint p[MAXN];\n\nint z = -1;\n\n\n\nint vis[MAXN];\n\n\n\nvoid add(int u, int v) {\n\n\t++z;\n\n\te[z].t = v;\n\n\te[z].next = p[u];\n\n\tp[u] = z;\n\n}\n\n\n\nNode *root[MAXN];\n\n\n\nint getkey(Node *now) {\n\n\treturn now ? now->key : 0;\n\n}\n\n\n\nvoid update(Node *now) {\n\n\tnow->key = getkey(now->r) + 1;\n\n}\n\n\n\nNode* merge(Node *&l, Node *&r) {\n\n\tif(!l)\n\n\t\treturn r;\n\n\tif(!r)\n\n\t\treturn l;\n\n//\tcout<<l->v<<\" \"<<r->v<<endl;\n\n\tif(l->v < r->v) {\n\n\t\tl->r = merge(l->r, r);\n\n\t\tif(getkey(l->l) < getkey(l->r))\n\n\t\t\tswap(l->l, l->r);\n\n\t\tupdate(l);\n\n\t\treturn l;\n\n\t}\n\n\telse {\n\n\t\tr->r = merge(l, r->r);\n\n\t\tif(getkey(r->l) < getkey(r->r))\n\n\t\t\tswap(r->l, r->r);\n\n\t\tupdate(r);\n\n\t\treturn r;\n\n\t}\n\n}\n\n\n\nvoid dfs(int u, int fa, int tag) {\n\n\tvis[u] = tag;\n\n\tif(u != tag) {\n\n\t\troot[tag] = merge(root[tag], root[u]);\n\n\t\troot[u] = 0;\n\n\t}\n\n\tfor(int tmp = p[u]; tmp != -1; tmp = e[tmp].next) {\n\n\t\tif(e[tmp].t != fa) {\n\n\t\t\tdfs(e[tmp].t, u, tag);\n\n\t\t}\n\n\t}\n\n} \n\n\n\nvoid del(Node *&now) {\n\n\t//print(now);\n\n\tnow = merge(now->l, now->r);\n\n}\n\n\n\n\n\nint n, m;\n\n\n\nint main() {\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 0; i < n; ++i) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\t\troot[i] = new Node(i);\n\n\t}\n\n\tint u, v;\n\n\tmemset(p, -1, sizeof(p));\n\n\t\n\n\tfor(int i = 1; i <= m; ++i) {\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tadd(u, v);\n\n\t\tadd(v, u);\n\n\t}\n\n\tmemset(vis, -1, sizeof(vis));\n\n\t\n\n\tint cnt = 0;\n\n\tlong long ss = 0;\n\n\tNode *tmp = 0;\n\n\tfor(int i = 0; i < n; ++i) {\n\n\t\tif(vis[i] == -1) {\n\n\t\t\t++cnt;\n\n\t\t\tdfs(i, -1, i);\n\n\t\t\tss += root[i]->v;\n\n\t\t\tdel(root[i]);\n\n\t\t\ttmp = merge(tmp, root[i]);\n\n\t\t}\n\n\t}\n\n\tif((n - 1 - m) * 2 > n) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(m == n - 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\t\n\n\tint need = (n - 1 - m) * 2 - cnt;\n\n\tfor(int i = 1; i <= need; ++i) {\n\n\t\tss += tmp->v;\n\n\t\tdel(tmp);\n\n\t}\n\n\t\n\n\t//if(cnt >= n - 1) {\n\n\t\tprintf(\"%lld\\n\", ss);\n\n\t//}\n\n\t/*else {\n\n\t\tputs(\"Impossible\");\n\n\t}*/\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<algorithm>\n\ntypedef long long ll;\n\nconst int N=1e5+5,INF=1e9+7;\n\nint n,m,par[N],id[N],a[N];\n\nvoid init(){\n\n    for(int i=0;i<n;i++) par[i]=i,id[i]=i;\n\n}\n\nint fd(int x) {\n\n    return par[x]==x?x:par[x]=fd(par[x]);\n\n}\n\nint main() {\n\n    scanf(\"%d%d\",&n,&m);\n\n    for(int i=0;i<n;i++) scanf(\"%d\",a+i);init();\n\n    int x,y;\n\n    while(m--) {\n\n        scanf(\"%d%d\",&x,&y);\n\n        x=fd(x);y=fd(y);\n\n        if(x==y) continue;\n\n        if(a[id[y]]>a[id[x]]) id[y]=id[x];\n\n        par[x]=y;\n\n    }\n\n    ll ans=0;int tot=0;\n\n    for(int i=0;i<n;i++) if(fd(i)==i) tot++,ans+=a[id[i]],a[id[i]]=INF;\n\n    if(tot==1) printf(\"0\\n\");\n\n    else {\n\n        std::sort(a,a+n);bool ok=true;\n\n        for(int i=0;i<tot-2;i++) {\n\n            ans+=a[i];\n\n            if(a[i]>=INF) ok=false;\n\n        }\n\n        if(ok) printf(\"%lld\\n\",ans);\n\n        else printf(\"Impossible\\n\");\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "78",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\n\n\nconst int maxn = 1e5 + 5;\n\n\n\nint n, m, k;\n\nint w[maxn], f[maxn];\n\nll ans;\n\npriority_queue <int, vector<int>, greater<int>> q[maxn];\n\nmultiset <int> s;\n\n\n\nint find(int x)\n\n{\n\n\treturn f[x] == x ? x : f[x] = find(f[x]);\n\n}\n\n\n\nvoid merge(int x, int y)\n\n{\n\n\tint fx = find(x);\n\n\tint fy = find(y);\n\n\tif(fx != fy)\n\n\t\tf[fx] = fy;\n\n}\n\n\n\nint main()\n\n{\n\n\tint u, v;\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tk = n - m;\n\n\tif(2 * k - 2 > n)\n\n\t{\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(k == 1)\n\n\t{\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t{\n\n\t\tscanf(\"%d\", &w[i]);\n\n\t\tf[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++)\n\n\t{\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++, v++;\n\n\t\tmerge(u, v);\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t{\n\n\t\tfind(i);\n\n\t\tq[f[i]].push(w[i]);\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t\tif(!q[i].empty())\n\n\t\t{\n\n\t\t\tans += q[i].top();\n\n\t\t\tq[i].pop();\n\n\t//\t\tprintf(\"val = %lld\\n\", val);\n\n\t\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t\twhile(!q[i].empty())\n\n\t\t{\n\n\t\t\ts.insert(q[i].top());\n\n\t\t\tq[i].pop();\n\n\t\t}\t\n\n//\tfor(auto it = s.begin(); it != s.end(); it++)\n\n//\t\tprintf(\"%d\\n\", *it);\n\n\tauto it = s.begin();\n\n\tfor(int i = 1; i <= k - 2; i++, it++)\n\n\t{\n\n\t\tans += *it;\n\n\t//\tprintf(\"%lld\\n\", ans);\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cstdio>\n\nusing namespace std;\n\nint t[101000];\n\nint val[101000],b[101000],c[101000],k2=0;\n\nint h[101000],nxt[201000],K=0,to[201000];\n\nvoid ins(int u,int v){nxt[++K]=h[u];h[u]=K;to[K]=v;}\n\nint Min;\n\nvoid dfs(int x,int o)\n\n{\n\n\tt[x]=o;Min=min(Min,val[x]);c[++k2]=x;\n\n\tfor(int i=h[x];i;i=nxt[i])if(!t[to[i]])dfs(to[i],o);\n\n}\n\nint main()\n\n{\n\n\tint n,m;scanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",&val[i]);\n\n\tfor(int i=1;i<=m;i++)\n\n\t{\n\n\t\tint u,v;scanf(\"%d%d\",&u,&v);u++;v++;ins(u,v);ins(v,u);\n\n\t}\n\n\tint cnt=0,s=0;long long ans=0;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tif(!t[i])\n\n\t\t{\n\n\t\t\tMin=1e9;k2=0;\n\n\t\t\tdfs(i,++s);\n\n\t\t\tfor(int j=1;j<=k2;j++)if(val[c[j]]==Min){ans+=Min;Min=1e9;}else b[++cnt]=val[c[j]];\n\n\t\t}\n\n\t}\n\n\tif(s==1)return 0*puts(\"0\");\n\n\tint lst=(s-1)*2-s;\n\n\tsort(b+1,b+cnt+1);\n\n\tif(lst>cnt)return 0*puts(\"Impossible\");\n\n\tfor(int i=1;i<=lst;i++)ans+=b[i];\n\n\tprintf(\"%lld\",ans);return 0;\n\n } "
    },
    {
        "id": "79",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nconst int MAXN = 101010;\n\n\n\nint a[MAXN];\n\n\n\nclass Node {\n\npublic:\n\n\tint v;\n\n\tNode *l, *r;\n\n\tint key;\n\n\t\n\n\tNode(int x) {\n\n\t\tv = a[x];\n\n\t\tl = r = 0;\n\n\t\tkey = 1;\n\n\t}\n\n};\n\n\n\n//set<pair<int,int> > s;\n\n\n\nclass Road {\n\npublic:\n\n\tint t, next;\n\n}e[MAXN * 2];\n\nint p[MAXN];\n\nint z = -1;\n\n\n\nint vis[MAXN];\n\n\n\nvoid add(int u, int v) {\n\n\t++z;\n\n\te[z].t = v;\n\n\te[z].next = p[u];\n\n\tp[u] = z;\n\n}\n\n\n\nNode *root[MAXN];\n\n\n\nint getkey(Node *now) {\n\n\treturn now ? now->key : 0;\n\n}\n\n\n\nvoid update(Node *now) {\n\n\tnow->key = getkey(now->r) + 1;\n\n}\n\n\n\nNode* merge(Node *&l, Node *&r) {\n\n\tif(!l)\n\n\t\treturn r;\n\n\tif(!r)\n\n\t\treturn l;\n\n//\tcout<<l->v<<\" \"<<r->v<<endl;\n\n\tif(l->v < r->v) {\n\n\t\tl->r = merge(l->r, r);\n\n\t\tif(getkey(l->l) < getkey(l->r))\n\n\t\t\tswap(l->l, l->r);\n\n\t\tupdate(l);\n\n\t\treturn l;\n\n\t}\n\n\telse {\n\n\t\tr->r = merge(l, r->r);\n\n\t\tif(getkey(r->l) < getkey(r->r))\n\n\t\t\tswap(r->l, r->r);\n\n\t\tupdate(r);\n\n\t\treturn r;\n\n\t}\n\n}\n\n\n\nvoid dfs(int u, int fa, int tag) {\n\n\tvis[u] = tag;\n\n\tif(u != tag) {\n\n\t\troot[tag] = merge(root[tag], root[u]);\n\n\t\troot[u] = 0;\n\n\t}\n\n\tfor(int tmp = p[u]; tmp != -1; tmp = e[tmp].next) {\n\n\t\tif(e[tmp].t != fa) {\n\n\t\t\tdfs(e[tmp].t, u, tag);\n\n\t\t}\n\n\t}\n\n} \n\n\n\nvoid del(Node *&now) {\n\n\t//print(now);\n\n\tnow = merge(now->l, now->r);\n\n}\n\n\n\n\n\nint n, m;\n\n\n\nint main() {\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 0; i < n; ++i) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\t\troot[i] = new Node(i);\n\n\t}\n\n\tint u, v;\n\n\tmemset(p, -1, sizeof(p));\n\n\t\n\n\tfor(int i = 1; i <= m; ++i) {\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tadd(u, v);\n\n\t\tadd(v, u);\n\n\t}\n\n\tmemset(vis, -1, sizeof(vis));\n\n\t\n\n\tint cnt = 0;\n\n\tlong long ss = 0;\n\n\tNode *tmp = 0;\n\n\tfor(int i = 0; i < n; ++i) {\n\n\t\tif(vis[i] == -1) {\n\n\t\t\t++cnt;\n\n\t\t\tdfs(i, -1, i);\n\n\t\t\tss += root[i]->v;\n\n\t\t\tdel(root[i]);\n\n\t\t\ttmp = merge(tmp, root[i]);\n\n\t\t}\n\n\t}\n\n\tif((n - 1 - m) * 2 > n) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(m == n - 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\t\n\n\tint need = (n - 1 - m) * 2 - cnt;\n\n\tfor(int i = 1; i <= need; ++i) {\n\n\t\tss += tmp->v;\n\n\t\tdel(tmp);\n\n\t}\n\n\t\n\n\t//if(cnt >= n - 1) {\n\n\t\tprintf(\"%lld\\n\", ss);\n\n\t//}\n\n\t/*else {\n\n\t\tputs(\"Impossible\");\n\n\t}*/\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cstdio>\n\nusing namespace std;\n\nint t[101000];\n\nint val[101000],b[101000],c[101000],k2=0;\n\nint h[101000],nxt[201000],K=0,to[201000];\n\nvoid ins(int u,int v){nxt[++K]=h[u];h[u]=K;to[K]=v;}\n\nint Min;\n\nvoid dfs(int x,int o)\n\n{\n\n\tt[x]=o;Min=min(Min,val[x]);c[++k2]=x;\n\n\tfor(int i=h[x];i;i=nxt[i])if(!t[to[i]])dfs(to[i],o);\n\n}\n\nint main()\n\n{\n\n\tint n,m;scanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",&val[i]);\n\n\tfor(int i=1;i<=m;i++)\n\n\t{\n\n\t\tint u,v;scanf(\"%d%d\",&u,&v);u++;v++;ins(u,v);ins(v,u);\n\n\t}\n\n\tint cnt=0,s=0;long long ans=0;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tif(!t[i])\n\n\t\t{\n\n\t\t\tMin=1e9;k2=0;\n\n\t\t\tdfs(i,++s);\n\n\t\t\tfor(int j=1;j<=k2;j++)if(val[c[j]]==Min){ans+=Min;Min=1e9;}else b[++cnt]=val[c[j]];\n\n\t\t}\n\n\t}\n\n\tif(s==1)return 0*puts(\"0\");\n\n\tint lst=(s-1)*2-s;\n\n\tsort(b+1,b+cnt+1);\n\n\tif(lst>cnt)return 0*puts(\"Impossible\");\n\n\tfor(int i=1;i<=lst;i++)ans+=b[i];\n\n\tprintf(\"%lld\",ans);return 0;\n\n } "
    },
    {
        "id": "80",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\n\n\nconst int maxn = 1e5 + 5;\n\n\n\nint n, m, k;\n\nint w[maxn], f[maxn];\n\nll ans;\n\npriority_queue <int, vector<int>, greater<int>> q[maxn];\n\nmultiset <int> s;\n\n\n\nint find(int x)\n\n{\n\n\treturn f[x] == x ? x : f[x] = find(f[x]);\n\n}\n\n\n\nvoid merge(int x, int y)\n\n{\n\n\tint fx = find(x);\n\n\tint fy = find(y);\n\n\tif(fx != fy)\n\n\t\tf[fx] = fy;\n\n}\n\n\n\nint main()\n\n{\n\n\tint u, v;\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tk = n - m;\n\n\tif(2 * k - 2 > n)\n\n\t{\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(k == 1)\n\n\t{\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t{\n\n\t\tscanf(\"%d\", &w[i]);\n\n\t\tf[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++)\n\n\t{\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++, v++;\n\n\t\tmerge(u, v);\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t{\n\n\t\tfind(i);\n\n\t\tq[f[i]].push(w[i]);\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t\tif(!q[i].empty())\n\n\t\t{\n\n\t\t\tans += q[i].top();\n\n\t\t\tq[i].pop();\n\n\t//\t\tprintf(\"val = %lld\\n\", val);\n\n\t\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t\twhile(!q[i].empty())\n\n\t\t{\n\n\t\t\ts.insert(q[i].top());\n\n\t\t\tq[i].pop();\n\n\t\t}\t\n\n//\tfor(auto it = s.begin(); it != s.end(); it++)\n\n//\t\tprintf(\"%d\\n\", *it);\n\n\tauto it = s.begin();\n\n\tfor(int i = 1; i <= k - 2; i++, it++)\n\n\t{\n\n\t\tans += *it;\n\n\t//\tprintf(\"%lld\\n\", ans);\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<algorithm>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<vector>\n\n\n\nconst int Maxv = 100020, INF = 0x7fffffff; \n\nstd::vector<int> g[Maxv]; \n\nint v[Maxv], fa[Maxv], idx[Maxv], cnt, n, m; \n\nlong long ans; \n\nbool vis[Maxv]; \n\n\n\ninline int read(){\n\n    int x = 0, f = 1; \n\n    char ch = getchar(); \n\n    while (ch < '0' || ch > '9') {\n\n        if (ch == '-') {\n\n            f = -1; \n\n        }\n\n        ch = getchar(); \n\n    }\n\n    while (ch >= '0' && ch <= '9') {\n\n        x = (x << 3) + (x << 1) + ch - '0'; \n\n        ch = getchar();\n\n    }\n\n    return x * f; \n\n}\n\n\n\nbool cmp(int a, int b){\n\n    return v[a] < v[b]; \n\n}\n\n\n\ninline int find(int x){\n\n    if (fa[x] == x) {\n\n        return x; \n\n    }\n\n    else {\n\n        fa[x] = find(fa[x]);\n\n    }\n\n    return fa[x]; \n\n}\n\n\n\ninline void merge(int u, int v){\n\n    int fu = find(u); \n\n    int fv = find(v); \n\n    if (fu != fv) {\n\n        fa[fu] = fv; \n\n    }\n\n    cnt++; \n\n}\n\n\n\nint main(){\n\n    n = read();\n\n    m = read(); \n\n    for (int i = 1; i <= n; i++) {\n\n        v[i] = read(); \n\n        fa[i] = i; \n\n    }\n\n    for (int i = 1; i <= m; i++) {\n\n        int u = read() + 1; \n\n        int v = read() + 1; \n\n        merge(u, v); \n\n    }\n\n    if (cnt == n - 1) {\n\n        printf(\"0\"); \n\n        return 0; \n\n    }\n\n    int k = (n - 1 - cnt) << 1; \n\n    if (k > n) {\n\n        printf(\"Impossible\"); \n\n        return 0; \n\n    }\n\n    for (int i = 1; i <= n; i++) {\n\n        idx[i] = i; \n\n    }\n\n    std::sort(idx + 1, idx + n + 1, cmp); \n\n    for (int i = 1; i <= n; i++) {\n\n        int fi = find(i); \n\n        g[fi].push_back(i); \n\n    }\n\n    for (int i = 1; i <= n; i++) {\n\n        if (i == fa[i]) {\n\n            int Min = INF;\n\n            int Index; \n\n            for (int j = 0; j < g[i].size(); j++) {\n\n                if (v[g[i][j]] < Min) {\n\n                    Min = v[ g[i][j] ]; \n\n                    Index = g[i][j]; \n\n                }\n\n            } \n\n            ans += Min; \n\n            vis[Index] = true; \n\n            k--; \n\n        }\n\n    }\n\n    for (int i = 1; i <= n; i++) {\n\n        if (k && !vis[ idx[i] ]) {\n\n            ans += v[ idx[i] ]; \n\n            vis[ idx[i] ] = true; \n\n            k--; \n\n        }\n\n    }\n\n    printf(\"%lld\", ans); \n\n    return 0; \n\n}"
    },
    {
        "id": "81",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\n\n\nconst int maxn = 1e5 + 5;\n\n\n\nint n, m, k;\n\nint w[maxn], f[maxn];\n\nll ans;\n\npriority_queue <int, vector<int>, greater<int>> q[maxn];\n\nmultiset <int> s;\n\n\n\nint find(int x)\n\n{\n\n\treturn f[x] == x ? x : f[x] = find(f[x]);\n\n}\n\n\n\nvoid merge(int x, int y)\n\n{\n\n\tint fx = find(x);\n\n\tint fy = find(y);\n\n\tif(fx != fy)\n\n\t\tf[fx] = fy;\n\n}\n\n\n\nint main()\n\n{\n\n\tint u, v;\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tk = n - m;\n\n\tif(2 * k - 2 > n)\n\n\t{\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(k == 1)\n\n\t{\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t{\n\n\t\tscanf(\"%d\", &w[i]);\n\n\t\tf[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++)\n\n\t{\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++, v++;\n\n\t\tmerge(u, v);\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t{\n\n\t\tfind(i);\n\n\t\tq[f[i]].push(w[i]);\n\n\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t\tif(!q[i].empty())\n\n\t\t{\n\n\t\t\tans += q[i].top();\n\n\t\t\tq[i].pop();\n\n\t//\t\tprintf(\"val = %lld\\n\", val);\n\n\t\t}\n\n\tfor(int i = 1; i <= n; i++)\n\n\t\twhile(!q[i].empty())\n\n\t\t{\n\n\t\t\ts.insert(q[i].top());\n\n\t\t\tq[i].pop();\n\n\t\t}\t\n\n//\tfor(auto it = s.begin(); it != s.end(); it++)\n\n//\t\tprintf(\"%d\\n\", *it);\n\n\tauto it = s.begin();\n\n\tfor(int i = 1; i <= k - 2; i++, it++)\n\n\t{\n\n\t\tans += *it;\n\n\t//\tprintf(\"%lld\\n\", ans);\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\nlong long n,m,a[100005],b[100005],fa[100005],ans=0,cnt=0;\n\ninline long long find(long long x){\n\n\treturn fa[x]?fa[x]=find(fa[x]):x;\n\n}\n\ninline long long max(long long x,long long y){\n\n\treturn x>y?x:y;\n\n}\n\ninline long long read(){\n\n\tchar c=getchar();\n\n\tfor(;c>'9'||c<'0';) c=getchar();\n\n\tlong long x=0;\n\n\tfor(;c>='0'&&c<='9';){\n\n\t\tx=(x<<3)+(x<<1)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\treturn x;\n\n}\n\nint main(){\n\n\tn=read(),m=read();\n\n\tif(m==n-1){\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(long long i=1;i<=n;i++)\n\n\t\ta[i]=read(),ans+=a[i];\n\n\tfor(long long i=1;i<=m;i++){\n\n\t\tlong long x=read(),y=read();\n\n\t\tx=find(x+1),y=find(y+1);\n\n\t\tans-=max(a[x],a[y]);\n\n\t\tb[++cnt]=max(a[x],a[y]);\n\n\t\tif(a[x]<a[y]) fa[y]=x;\n\n\t\telse fa[x]=y;\n\n\t}\n\n\tif(n-m>cnt+2){\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tsort(b+1,b+cnt+1);\n\n\tfor(long long i=1;i<=n-m-2;i++) ans+=b[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0; \n\n}"
    },
    {
        "id": "82",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nconst int MAXN = 101010;\n\n\n\nint a[MAXN];\n\n\n\nclass Node {\n\npublic:\n\n\tint v;\n\n\tNode *l, *r;\n\n\tint key;\n\n\t\n\n\tNode(int x) {\n\n\t\tv = a[x];\n\n\t\tl = r = 0;\n\n\t\tkey = 1;\n\n\t}\n\n};\n\n\n\n//set<pair<int,int> > s;\n\n\n\nclass Road {\n\npublic:\n\n\tint t, next;\n\n}e[MAXN * 2];\n\nint p[MAXN];\n\nint z = -1;\n\n\n\nint vis[MAXN];\n\n\n\nvoid add(int u, int v) {\n\n\t++z;\n\n\te[z].t = v;\n\n\te[z].next = p[u];\n\n\tp[u] = z;\n\n}\n\n\n\nNode *root[MAXN];\n\n\n\nint getkey(Node *now) {\n\n\treturn now ? now->key : 0;\n\n}\n\n\n\nvoid update(Node *now) {\n\n\tnow->key = getkey(now->r) + 1;\n\n}\n\n\n\nNode* merge(Node *&l, Node *&r) {\n\n\tif(!l)\n\n\t\treturn r;\n\n\tif(!r)\n\n\t\treturn l;\n\n//\tcout<<l->v<<\" \"<<r->v<<endl;\n\n\tif(l->v < r->v) {\n\n\t\tl->r = merge(l->r, r);\n\n\t\tif(getkey(l->l) < getkey(l->r))\n\n\t\t\tswap(l->l, l->r);\n\n\t\tupdate(l);\n\n\t\treturn l;\n\n\t}\n\n\telse {\n\n\t\tr->r = merge(l, r->r);\n\n\t\tif(getkey(r->l) < getkey(r->r))\n\n\t\t\tswap(r->l, r->r);\n\n\t\tupdate(r);\n\n\t\treturn r;\n\n\t}\n\n}\n\n\n\nvoid dfs(int u, int fa, int tag) {\n\n\tvis[u] = tag;\n\n\tif(u != tag) {\n\n\t\troot[tag] = merge(root[tag], root[u]);\n\n\t\troot[u] = 0;\n\n\t}\n\n\tfor(int tmp = p[u]; tmp != -1; tmp = e[tmp].next) {\n\n\t\tif(e[tmp].t != fa) {\n\n\t\t\tdfs(e[tmp].t, u, tag);\n\n\t\t}\n\n\t}\n\n} \n\n\n\nvoid del(Node *&now) {\n\n\t//print(now);\n\n\tnow = merge(now->l, now->r);\n\n}\n\n\n\n\n\nint n, m;\n\n\n\nint main() {\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 0; i < n; ++i) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\t\troot[i] = new Node(i);\n\n\t}\n\n\tint u, v;\n\n\tmemset(p, -1, sizeof(p));\n\n\t\n\n\tfor(int i = 1; i <= m; ++i) {\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tadd(u, v);\n\n\t\tadd(v, u);\n\n\t}\n\n\tmemset(vis, -1, sizeof(vis));\n\n\t\n\n\tint cnt = 0;\n\n\tlong long ss = 0;\n\n\tNode *tmp = 0;\n\n\tfor(int i = 0; i < n; ++i) {\n\n\t\tif(vis[i] == -1) {\n\n\t\t\t++cnt;\n\n\t\t\tdfs(i, -1, i);\n\n\t\t\tss += root[i]->v;\n\n\t\t\tdel(root[i]);\n\n\t\t\ttmp = merge(tmp, root[i]);\n\n\t\t}\n\n\t}\n\n\tif((n - 1 - m) * 2 > n) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(m == n - 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\t\n\n\tint need = (n - 1 - m) * 2 - cnt;\n\n\tfor(int i = 1; i <= need; ++i) {\n\n\t\tss += tmp->v;\n\n\t\tdel(tmp);\n\n\t}\n\n\t\n\n\t//if(cnt >= n - 1) {\n\n\t\tprintf(\"%lld\\n\", ss);\n\n\t//}\n\n\t/*else {\n\n\t\tputs(\"Impossible\");\n\n\t}*/\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\nlong long n,m,a[100005],b[100005],fa[100005],ans=0,cnt=0;\n\ninline long long find(long long x){\n\n\treturn fa[x]?fa[x]=find(fa[x]):x;\n\n}\n\ninline long long max(long long x,long long y){\n\n\treturn x>y?x:y;\n\n}\n\ninline long long read(){\n\n\tchar c=getchar();\n\n\tfor(;c>'9'||c<'0';) c=getchar();\n\n\tlong long x=0;\n\n\tfor(;c>='0'&&c<='9';){\n\n\t\tx=(x<<3)+(x<<1)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\treturn x;\n\n}\n\nint main(){\n\n\tn=read(),m=read();\n\n\tif(m==n-1){\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(long long i=1;i<=n;i++)\n\n\t\ta[i]=read(),ans+=a[i];\n\n\tfor(long long i=1;i<=m;i++){\n\n\t\tlong long x=read(),y=read();\n\n\t\tx=find(x+1),y=find(y+1);\n\n\t\tans-=max(a[x],a[y]);\n\n\t\tb[++cnt]=max(a[x],a[y]);\n\n\t\tif(a[x]<a[y]) fa[y]=x;\n\n\t\telse fa[x]=y;\n\n\t}\n\n\tif(n-m>cnt+2){\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tsort(b+1,b+cnt+1);\n\n\tfor(long long i=1;i<=n-m-2;i++) ans+=b[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0; \n\n}"
    },
    {
        "id": "83",
        "source_code": "#include<algorithm>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<vector>\n\n\n\nconst int Maxv = 100020, INF = 0x7fffffff; \n\nstd::vector<int> g[Maxv]; \n\nint v[Maxv], fa[Maxv], idx[Maxv], cnt, n, m; \n\nlong long ans; \n\nbool vis[Maxv]; \n\n\n\ninline int read(){\n\n    int x = 0, f = 1; \n\n    char ch = getchar(); \n\n    while (ch < '0' || ch > '9') {\n\n        if (ch == '-') {\n\n            f = -1; \n\n        }\n\n        ch = getchar(); \n\n    }\n\n    while (ch >= '0' && ch <= '9') {\n\n        x = (x << 3) + (x << 1) + ch - '0'; \n\n        ch = getchar();\n\n    }\n\n    return x * f; \n\n}\n\n\n\nbool cmp(int a, int b){\n\n    return v[a] < v[b]; \n\n}\n\n\n\ninline int find(int x){\n\n    if (fa[x] == x) {\n\n        return x; \n\n    }\n\n    else {\n\n        fa[x] = find(fa[x]);\n\n    }\n\n    return fa[x]; \n\n}\n\n\n\ninline void merge(int u, int v){\n\n    int fu = find(u); \n\n    int fv = find(v); \n\n    if (fu != fv) {\n\n        fa[fu] = fv; \n\n    }\n\n    cnt++; \n\n}\n\n\n\nint main(){\n\n    n = read();\n\n    m = read(); \n\n    for (int i = 1; i <= n; i++) {\n\n        v[i] = read(); \n\n        fa[i] = i; \n\n    }\n\n    for (int i = 1; i <= m; i++) {\n\n        int u = read() + 1; \n\n        int v = read() + 1; \n\n        merge(u, v); \n\n    }\n\n    if (cnt == n - 1) {\n\n        printf(\"0\"); \n\n        return 0; \n\n    }\n\n    int k = (n - 1 - cnt) << 1; \n\n    if (k > n) {\n\n        printf(\"Impossible\"); \n\n        return 0; \n\n    }\n\n    for (int i = 1; i <= n; i++) {\n\n        idx[i] = i; \n\n    }\n\n    std::sort(idx + 1, idx + n + 1, cmp); \n\n    for (int i = 1; i <= n; i++) {\n\n        int fi = find(i); \n\n        g[fi].push_back(i); \n\n    }\n\n    for (int i = 1; i <= n; i++) {\n\n        if (i == fa[i]) {\n\n            int Min = INF;\n\n            int Index; \n\n            for (int j = 0; j < g[i].size(); j++) {\n\n                if (v[g[i][j]] < Min) {\n\n                    Min = v[ g[i][j] ]; \n\n                    Index = g[i][j]; \n\n                }\n\n            } \n\n            ans += Min; \n\n            vis[Index] = true; \n\n            k--; \n\n        }\n\n    }\n\n    for (int i = 1; i <= n; i++) {\n\n        if (k && !vis[ idx[i] ]) {\n\n            ans += v[ idx[i] ]; \n\n            vis[ idx[i] ] = true; \n\n            k--; \n\n        }\n\n    }\n\n    printf(\"%lld\", ans); \n\n    return 0; \n\n}",
        "optimized_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\nlong long n,m,a[100005],b[100005],fa[100005],ans=0,cnt=0;\n\ninline long long find(long long x){\n\n\treturn fa[x]?fa[x]=find(fa[x]):x;\n\n}\n\ninline long long max(long long x,long long y){\n\n\treturn x>y?x:y;\n\n}\n\ninline long long read(){\n\n\tchar c=getchar();\n\n\tfor(;c>'9'||c<'0';) c=getchar();\n\n\tlong long x=0;\n\n\tfor(;c>='0'&&c<='9';){\n\n\t\tx=(x<<3)+(x<<1)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\treturn x;\n\n}\n\nint main(){\n\n\tn=read(),m=read();\n\n\tif(m==n-1){\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(long long i=1;i<=n;i++)\n\n\t\ta[i]=read(),ans+=a[i];\n\n\tfor(long long i=1;i<=m;i++){\n\n\t\tlong long x=read(),y=read();\n\n\t\tx=find(x+1),y=find(y+1);\n\n\t\tans-=max(a[x],a[y]);\n\n\t\tb[++cnt]=max(a[x],a[y]);\n\n\t\tif(a[x]<a[y]) fa[y]=x;\n\n\t\telse fa[x]=y;\n\n\t}\n\n\tif(n-m>cnt+2){\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tsort(b+1,b+cnt+1);\n\n\tfor(long long i=1;i<=n-m-2;i++) ans+=b[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0; \n\n}"
    },
    {
        "id": "84",
        "source_code": "#include <iostream>\n\n#include <cassert>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <queue>\n\n#include <set>\n\nusing namespace std;\n\nint N,M;\n\nint T[100005];\n\nint A[100005];\n\nlong long rez;\n\nmultiset<int> G[100005];\n\nint fi(int nod){\n\n    if(T[nod] <= 0){\n\n        return nod;\n\n    }\n\n    return T[nod] = fi(T[nod]);\n\n}\n\nvoid u(int x,int y,bool baga){\n\n    x = fi(x);\n\n    y = fi(y);\n\n    if(baga){\n\n        rez += *G[x].begin();G[x].erase(G[x].begin());\n\n        rez += *G[y].begin();G[y].erase(G[y].begin());\n\n        T[x]++;\n\n        T[y]++;\n\n    }\n\n    if(T[x] < T[y]){\n\n        for(auto it:G[y]){\n\n            G[x].insert(it);\n\n        }\n\n        T[x] += T[y];\n\n        T[y] = x;\n\n    }\n\n    else{\n\n        for(auto it:G[x]){\n\n            G[y].insert(it);\n\n        }\n\n        T[y] += T[x];\n\n        T[x] = y;\n\n    }\n\n}\n\nclass cmp{\n\n    public:\n\n    bool operator() (int a,int b){\n\n        return T[a] > T[b];\n\n    }\n\n};\n\npriority_queue<int,vector<int>,cmp> H;\n\nint main(){\n\n    cin >> N >> M;\n\n    for(int i = 1;i <= N;i++){\n\n        cin >> A[i];\n\n        T[i] = -1;\n\n        G[i].insert(A[i]);\n\n    }\n\n    for(int i = 1;i <= M;i++){\n\n        int x,y;\n\n        cin >> x >> y;\n\n        x++;\n\n        y++;\n\n        u(x,y,0);\n\n    }\n\n    for(int i = 1;i <= N;i++){\n\n        if(T[i] <= 0){\n\n            H.push(i);\n\n        }\n\n    }\n\n    rez = 0;\n\n    while(M < N - 1){\n\n        if(H.size() < 2){\n\n            cout << \"Impossible\";\n\n            return 0;\n\n        }\n\n        int a = H.top();H.pop();\n\n        int b = H.top();H.pop();\n\n        if(T[b] == 0){\n\n            cout << \"Impossible\";\n\n            return 0;\n\n        }\n\n        u(a,b,1);\n\n        H.push(fi(a));\n\n        M++;\n\n    }\n\n    cout << rez;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <vector>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nconst int NMAX = 1e5;\n\n\n\nint n,m;\n\nvector<int> graph[NMAX + 5];\n\nint val[NMAX + 5];\n\nbool viz[NMAX + 5];\n\n\n\nint dfs(int nod){\n\n\tviz[nod] = 1;\n\n\tint ans = nod;\n\n\tfor(auto it:graph[nod]){\n\n\t\tif(!viz[it]){\n\n\t\t\tint tmp = dfs(it);\n\n\t\t\tif(val[tmp] < val[ans]){\n\n\t\t\t\tans = tmp;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn ans;\n\n}\n\n\n\nint main(){\n\n\t\n\n\tscanf(\"%d %d\",&n,&m);\n\n\t\n\n\tfor(int i = 0;i < n;i++){\n\n\t\tscanf(\"%d\",&val[i]);\n\n\t}\n\n\t\n\n\tfor(int i = 0;i < m;i++){\n\n\t\tint x,y;\n\n\t\tscanf(\"%d %d\",&x,&y);\n\n\t\tgraph[x].push_back(y);\n\n\t\tgraph[y].push_back(x);\n\n\t}\n\n\t\n\n\tif(2 * (n - m - 1) > n){\n\n\t\tprintf(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\t\n\n\tif(m == n - 1){\n\n\t\tprintf(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\t\n\n\tlong long ans = 0;\n\n\t\n\n\tfor(int i = 0;i < n;i++){\n\n\t\tif(!viz[i]){\n\n\t\t\tint tmp = dfs(i);\n\n\t\t\tans += val[tmp];\n\n\t\t\tval[tmp] = 1 << 30;\n\n\t\t}\n\n\t}\n\n\t\n\n\tsort(val,val + n);\n\n\t\n\n\tfor(int i = 0;i < n - m - 2;i++){\n\n\t\tans += val[i];\n\n\t}\n\n\t\n\n\tprintf(\"%lld\",ans);\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "88",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n\nvector<ll> v[100000];\n\nbool used[100000] = {};\n\nconst ll INF = 1145148931919810;\n\nmap<ll, ll> a;\n\npair<ll, ll> dfs(ll now){\n\n\tused[now] = 1;\n\n\tpair<ll, ll> ret = pair<ll, ll>(a[now], now);\n\n\tfor(ll next : v[now]){\n\n\t\tif(used[next]) continue;\n\n\t\tpair<ll, ll> tmp = dfs(next);\n\n\t\tif(tmp.first < ret.first) ret = tmp;\n\n\t}\n\n\treturn ret;\n\n}\n\nint main(){\n\n\tll n, m; cin >> n >> m;\n\n\tfor(ll i = 0; i < n; i++){\n\n\t\tll po; cin >> po;\n\n\t\ta[i] = po;\n\n\t}\n\n\tfor(ll i = 0; i < m; i++){\n\n\t\tll x, y; cin >> x >> y;\n\n\t\tv[x].push_back(y);\n\n\t\tv[y].push_back(x);\n\n\t}\n\n\tll ans = 0;\n\n\tll ren = 0;\n\n\tfor(ll i = 0; i < n; i++){\n\n\t\tif(used[i]) continue;\n\n\t\tpair<ll, ll> tmp = dfs(i);\n\n\t\tren++;\n\n\t\tans += tmp.first;\n\n\t\ta.erase(tmp.second);\n\n\t}\n\n\tif(ren == 1){\n\n\t\tcout << 0 << endl;\n\n\t\treturn 0;\n\n\t}\n\n\tif(2 * ren - 2 > n){\n\n\t\tcout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tvector<ll> po;\n\n\tfor(auto ite = a.begin(); ite != a.end(); ite++) po.push_back(ite->second);\n\n\tsort(po.begin(), po.end());\n\n\tfor(ll i = 0; i + ren < 2 * ren - 2; i++) ans += po[i];\n\n\tcout << ans << endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "// #define DEBUGGING\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define endl '\\n'\n\n#define ALL(V) (V).begin(), (V).end()\n\n#define ALLR(V) (V).rbegin(), (V).rend()\n\n\n\ntemplate <typename T> using V = vector<T>;\n\ntemplate <typename T> using VV = V<V<T>>;\n\nusing ll = int64_t;\n\nusing ull = uint64_t;\n\nusing PLL = pair<ll, ll>;\n\n\n\ntemplate <typename T> const T& var_min(const T &t) { return t; }\n\ntemplate <typename T> const T& var_max(const T &t) { return t; }\n\ntemplate <typename T, typename... Tail> const T& var_min(const T &t, const Tail&... tail) { return min(t, var_min(tail...)); }\n\ntemplate <typename T, typename... Tail> const T& var_max(const T &t, const Tail&... tail) { return max(t, var_max(tail...)); }\n\ntemplate <typename T, typename... Tail> void chmin(T &t, const Tail&... tail) { t = var_min(t, tail...); }\n\ntemplate <typename T, typename... Tail> void chmax(T &t, const Tail&... tail) { t = var_max(t, tail...); }\n\ntemplate <typename T> const T& clamp(const T &t, const T &low, const T &high) { return max(low, min(high, t)); }\n\ntemplate <typename T> void chclamp(T &t, const T &low, const T &high) { t = clamp(t, low, high); }\n\n\n\nnamespace init__ {\n\n\n\nstruct InitIO {\n\n    InitIO() {\n\n        cin.tie(nullptr);\n\n        ios_base::sync_with_stdio(false);\n\n        cout << fixed << setprecision(30);\n\n    }\n\n} init_io;\n\n\n\n}\n\n\n\n#ifdef DEBUGGING\n\n// #include \"../debug/debug.cpp\"\n\n#include \"../../debug/debug.cpp\"\n\n#else\n\n#define DEBUG(...) 0\n\n#define DEBUG_SEPARATOR_LINE 0\n\n#endif\n\n\n\ntemplate <typename T>\n\nT make_v(T init) { return init; }\n\n\n\ntemplate <typename T, typename... Tail>\n\nauto make_v(T init, size_t s, Tail... tail) {\n\n#define rec make_v(init, tail...)\n\n    return V<decltype(rec)>(s, rec);\n\n#undef rec\n\n}\n\n\n\nstruct Solver {\n\n    using PQ = priority_queue<ll, V<ll>, greater<ll>>;\n\n    ll N;\n\n    V<ll> costs;\n\n    VV<ll> edges;\n\n\n\n    Solver(ll arg_N) \n\n        : N(arg_N),\n\n          costs(arg_N),\n\n          edges(arg_N) \n\n    {\n\n        ll M;\n\n        cin >> M;\n\n        for(auto &&ele : costs) cin >> ele;\n\n        for(ll i = 0; i < M; i++) {\n\n            ll a, b;\n\n            cin >> a >> b;\n\n            edges[a].push_back(b);\n\n            edges[b].push_back(a);\n\n        }\n\n    }\n\n\n\n    void dfs(ll cur, V<ll> &nodes, V<bool> &visited) {\n\n        visited[cur] = true;\n\n        nodes.push_back(cur);\n\n        for(ll nxt : edges[cur]) if(!visited[nxt]) dfs(nxt, nodes, visited);\n\n    }\n\n\n\n    VV<ll> calc_forest() {\n\n        V<bool> visited(N);\n\n        VV<ll> ret;\n\n        for(ll i = 0; i < N; i++) {\n\n            if(visited[i]) continue;\n\n            V<ll> tree;\n\n            dfs(i, tree, visited);\n\n            ret.push_back(move(tree));\n\n        }\n\n        return ret;\n\n    }\n\n\n\n    ll solve() {\n\n        auto forest = calc_forest();\n\n        DEBUG(forest);\n\n        ll add_edges = 2 * (forest.size() - 1);\n\n        if(N < add_edges) return -1;\n\n        if(!add_edges) return 0;\n\n        V<PQ> costs_pq;\n\n        for(auto &&tree : forest) {\n\n            PQ pq;\n\n            for(ll node : tree) pq.push(costs[node]);\n\n            costs_pq.push_back(move(pq));\n\n        }\n\n        ll ret = 0;\n\n        PQ rests;\n\n        for(auto &&pq : costs_pq) {\n\n            ret += pq.top();\n\n            pq.pop();\n\n            add_edges--;\n\n            while(pq.size()) {\n\n                rests.push(pq.top());\n\n                pq.pop();\n\n            }\n\n        }\n\n        while(add_edges--) {\n\n            ret += rests.top();\n\n            rests.pop();\n\n        }\n\n        return ret;\n\n    }\n\n};\n\n\n\nint main() {\n\n    ll N;\n\n    cin >> N;\n\n    auto ans = Solver(N).solve();\n\n    if(ans == -1) cout << \"Impossible\";\n\n    else cout << ans;\n\n    cout << endl;\n\n    return 0;\n\n}\n"
    },
    {
        "id": "89",
        "source_code": "#include <iostream>\n\n#include <vector>\n\n#include <algorithm>\n\n#define llint long long\n\n\n\nusing namespace std;\n\n\n\nllint parent[100005];\n\nllint N, M;\n\nllint a[100005];\n\nvector<llint> cmp[100005];\n\n\n\nvoid init(){\n\n\tfor(llint i = 0; i < N; i++) parent[i] = i;\n\n}\n\n\n\nllint root(llint i)\n\n{\n\n\tif(parent[i] == i) return i;\n\n\treturn parent[i] = root(parent[i]);\n\n}\n\n\n\nvoid unite(llint i, llint j)\n\n{\n\n\tllint root_i = root(i), root_j = root(j);\n\n\tif(root_i == root_j) return;\n\n\tparent[root_i] = root_j;\n\n}\n\n\n\nbool same(llint i, llint j)\n\n{\n\n\treturn root(i) == root(j);\n\n}\n\n\n\nint main(void)\n\n{\n\n\tcin >> N >> M;\n\n\tfor(llint i = 0; i < N; i++) cin >> a[i];\n\n\tinit();\n\n\t\n\n\tllint x, y;\n\n\tfor(llint i = 0; i < M; i++){\n\n\t\tcin >> x >> y;\n\n\t\tunite(x, y);\n\n\t}\n\n\t\n\n\tfor(llint i = 0; i < N; i++) root(i);\n\n\tfor(llint i = 0; i < N; i++){\n\n\t\tcmp[parent[i]].push_back(a[i]);\n\n\t}\n\n\t\n\n\tllint cnt = 0, ccnt = 0;\n\n\tfor(llint i = 0; i < N; i++){\n\n\t\tif(cmp[i].size() == 1) cnt++;\n\n\t\tif(cmp[i].size() > 0) ccnt++;\n\n\t}\n\n\t\n\n\tif(ccnt == 1){\n\n\t\tcout << 0 << endl;\n\n\t\treturn 0;\n\n\t}\n\n\tif(2*(N-M-1) > N){\n\n\t\tcout << \"Impossible\" << endl;\n\n\t\treturn 0;\n\n\t}\n\n\t\n\n\tllint sum = 0;\n\n\tfor(llint i = 0; i < N; i++){\n\n\t\tif(cmp[i].size() > 0){\n\n\t\t\tsort(cmp[i].begin(), cmp[i].end());\n\n\t\t\tsum += cmp[i][0];\n\n\t\t}\n\n\t}\n\n\t\n\n\tvector<llint> vec;\n\n\tfor(llint i = 0; i < N; i++){\n\n\t\tif(cmp[i].size() > 1){\n\n\t\t\tfor(llint j = 1; j < cmp[i].size(); j++) vec.push_back(cmp[i][j]);\n\n\t\t}\n\n\t}\n\n\tsort(vec.begin(), vec.end());\n\n\t\n\n\tfor(llint i = 0; i < 2*(N-M-1)-(N-M); i++) sum += vec[i];\n\n\tcout << sum << endl;\n\n\t\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <utility>\n\n#include <map>\n\n#define llint long long\n\n#define inf 1e18\n\n\n\nusing namespace std;\n\ntypedef pair<llint, llint> P;\n\n\n\nstruct UnionFind{\n\n\tint size;\n\n\tvector<int> parent;\n\n\t\n\n\tUnionFind(){}\n\n\tUnionFind(int size){\n\n\t\tthis->size = size;\n\n\t\tparent.resize(size+1);\n\n\t\tinit();\n\n\t}\n\n\tvoid init(){\n\n\t\tfor(int i = 0; i <= size; i++) parent[i] = i;\n\n\t}\n\n\tint root(int i){\n\n\t\tif(parent[i] == i) return i;\n\n\t\treturn parent[i] = root(parent[i]);\n\n\t}\n\n\tbool same(int i, int j){\n\n\t\treturn root(i) == root(j);\n\n\t}\n\n\tvoid unite(int i, int j){\n\n\t\tint root_i = root(i), root_j = root(j);\n\n\t\tif(root_i == root_j) return;\n\n\t\tparent[root_i] = root_j;\n\n\t}\n\n};\n\n\n\nllint n, m;\n\nllint a[100005];\n\nUnionFind uf(100005);\n\nmap<llint, vector<llint> > mp;\n\nvector<llint> avec;\n\n\n\nint main(void)\n\n{\n\n\tios::sync_with_stdio(0);\n\n\tcin.tie(0);\n\n\t\n\n\tcin >> n >> m;\n\n\tfor(int i = 1; i <= n; i++) cin >> a[i];\n\n\tllint u, v;\n\n\tfor(int i = 1; i <= m; i++){\n\n\t\tcin >> u >> v;\n\n\t\tu++, v++;\n\n\t\tuf.unite(u, v);\n\n\t}\n\n\t\n\n\tif(2*(n-m-1) > n){\n\n\t\tcout << \"Impossible\" << endl;\n\n\t\treturn 0;\n\n\t}\n\n\t\n\n\tllint ans = 0;\n\n\tfor(int i = 1; i <= n; i++){\n\n\t\tmp[uf.root(i)].push_back(a[i]);\n\n\t}\n\n\tif(mp.size() == 1){\n\n\t\tcout << 0 << endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor(auto it = mp.begin(); it != mp.end(); it++){\n\n\t\tvector<llint> &vec = it->second;\n\n\t\tsort(vec.begin(), vec.end());\n\n\t\tans += vec[0];\n\n\t\tfor(int i = 1; i < vec.size(); i++) avec.push_back(vec[i]);\n\n\t}\n\n\tsort(avec.begin(), avec.end());\n\n\t\n\n\tfor(int i = 0; i < (n-m-2); i++) ans += avec[i];\n\n\tcout << ans << endl;\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "90",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n    }\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n"
    },
    {
        "id": "91",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n\n//"
    },
    {
        "id": "92",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define SZ(x) ((int)x.size())\n\n\n\nconst int N = 100005;\n\n\n\nint n, m;\n\nint a[N];\n\nint fa[N];\n\n\n\nvector<int> val[N];\n\n\n\nint getfa(int x) {\n\n\treturn fa[x] == x ? x : fa[x] = getfa(fa[x]);\n\n}\n\n\n\nvoid merge(int x, int y) {\n\n\tx = getfa(x);\n\n\ty = getfa(y);\n\n\tif(SZ(val[x]) < SZ(val[y])) {\n\n\t\tswap(x, y);\n\n\t}\n\n\tfor(auto v: val[y]) {\n\n\t\tval[x].push_back(v);\n\n\t}\n\n\tval[y].clear();\n\n\tfa[y] = x;\n\n}\n\n\n\nvoid input()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\n\n\t\tval[i].push_back(a[i]);\n\n\t\tfa[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++) {\n\n\t\tint x, y;\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++, y++;\n\n\t\tmerge(x, y);\n\n\t}\n\n}\n\n\n\nvoid solve()\n\n{\n\n\tlong long ans = 0;\n\n\n\n\tint cnt = (n - 1 - m) * 2;\n\n\n\n\tif(cnt == 0) {\n\n\t\tputs(\"0\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tvector<int> vec;\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tif(fa[i] == i) {\n\n\t\t\tsort(val[i].begin(), val[i].end());\n\n\t\t\tans += val[i][0];\n\n\t\t\tcnt--;\n\n\t\t\tfor(int j = 1; j < SZ(val[i]); j++) {\n\n\t\t\t\tvec.push_back(val[i][j]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tif(SZ(vec) < cnt) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tsort(vec.begin(), vec.end());\n\n\tfor(int i = 0; i < cnt; i++) {\n\n\t\tans += vec[i];\n\n\t}\n\n\tcout << ans << endl;\n\n}\n\n\n\nint main()\n\n{\n\n\tinput();\n\n\tsolve();\n\n\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "93",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n\n//",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define SZ(x) ((int)x.size())\n\n\n\nconst int N = 100005;\n\n\n\nint n, m;\n\nint a[N];\n\nint fa[N];\n\n\n\nvector<int> val[N];\n\n\n\nint getfa(int x) {\n\n\treturn fa[x] == x ? x : fa[x] = getfa(fa[x]);\n\n}\n\n\n\nvoid merge(int x, int y) {\n\n\tx = getfa(x);\n\n\ty = getfa(y);\n\n\tif(SZ(val[x]) < SZ(val[y])) {\n\n\t\tswap(x, y);\n\n\t}\n\n\tfor(auto v: val[y]) {\n\n\t\tval[x].push_back(v);\n\n\t}\n\n\tval[y].clear();\n\n\tfa[y] = x;\n\n}\n\n\n\nvoid input()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\n\n\t\tval[i].push_back(a[i]);\n\n\t\tfa[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++) {\n\n\t\tint x, y;\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++, y++;\n\n\t\tmerge(x, y);\n\n\t}\n\n}\n\n\n\nvoid solve()\n\n{\n\n\tlong long ans = 0;\n\n\n\n\tint cnt = (n - 1 - m) * 2;\n\n\n\n\tif(cnt == 0) {\n\n\t\tputs(\"0\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tvector<int> vec;\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tif(fa[i] == i) {\n\n\t\t\tsort(val[i].begin(), val[i].end());\n\n\t\t\tans += val[i][0];\n\n\t\t\tcnt--;\n\n\t\t\tfor(int j = 1; j < SZ(val[i]); j++) {\n\n\t\t\t\tvec.push_back(val[i][j]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tif(SZ(vec) < cnt) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tsort(vec.begin(), vec.end());\n\n\tfor(int i = 0; i < cnt; i++) {\n\n\t\tans += vec[i];\n\n\t}\n\n\tcout << ans << endl;\n\n}\n\n\n\nint main()\n\n{\n\n\tinput();\n\n\tsolve();\n\n\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "94",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <algorithm>\n\n\n\nconst int maxn = 1e5 + 20;\n\n\n\nint n, m, A[maxn], F[maxn];\n\nstd::pair<int,int> M[maxn];\n\nbool used[maxn];\n\n\n\nint find(int x)\n\n{\n\n\treturn F[x] == x ? x : (F[x] = find(F[x]));\n\n}\n\ntemplate<class TAT>void checkmin(TAT &x,const TAT &y)\n\n{\n\n\tif(y < x) x = y;\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 0; i < n; i++) scanf(\"%d\", &A[i]);\n\n\t\n\n\tfor(int i = 0; i < n; i++) F[i] = i;\n\n\t\n\n\tfor(int i = 0, x, y; i < m; i++)\n\n\t{\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tF[find(x)] = find(y);\n\n\t}\n\n\t\n\n\tfor(int i = 0; i < n; i++)\n\n\t\tM[i] = std::make_pair(A[i], i);\n\n\t\n\n\tfor(int i = 0; i < n; i++)\n\n\t\tcheckmin(M[find(i)], M[i]);\n\n\t\n\n\tlong long ans = 0;\n\n\tint cnt = 0;\n\n\t\n\n\tfor(int i = 0; i < n; i++)\n\n\t\tif(find(i) == i)\n\n\t\t{\n\n\t\t\tans += M[i].first, cnt++;\n\n\t\t\tused[M[i].second] = true;\n\n\t\t}\n\n\n\n\tif(cnt == 1)\n\n\t{\n\n\t\tprintf(\"0\\n\");\n\n\t}\n\n\telse if(n < (cnt - 1) * 2)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tfor(int i = 0; i < n; i++)\n\n\t\t\tM[i] = std::make_pair(A[i], i);\n\n\t\tstd::sort(M, M + n);\n\n\t\t\n\n\t\tint rem = (cnt - 1) * 2 - cnt;\n\n\t\t\n\n\t\tfor(int i = 0; i < n && rem; i++)\n\n\t\t{\n\n\t\t\tif(used[M[i].second]) continue;\n\n\t\t\tans += M[i].first, rem--;\n\n\t\t}\n\n\t\t\n\n\t\tprintf(\"%lld\\n\", ans);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "95",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n    }\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <algorithm>\n\n\n\nconst int maxn = 1e5 + 20;\n\n\n\nint n, m, A[maxn], F[maxn];\n\nstd::pair<int,int> M[maxn];\n\nbool used[maxn];\n\n\n\nint find(int x)\n\n{\n\n\treturn F[x] == x ? x : (F[x] = find(F[x]));\n\n}\n\ntemplate<class TAT>void checkmin(TAT &x,const TAT &y)\n\n{\n\n\tif(y < x) x = y;\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 0; i < n; i++) scanf(\"%d\", &A[i]);\n\n\t\n\n\tfor(int i = 0; i < n; i++) F[i] = i;\n\n\t\n\n\tfor(int i = 0, x, y; i < m; i++)\n\n\t{\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tF[find(x)] = find(y);\n\n\t}\n\n\t\n\n\tfor(int i = 0; i < n; i++)\n\n\t\tM[i] = std::make_pair(A[i], i);\n\n\t\n\n\tfor(int i = 0; i < n; i++)\n\n\t\tcheckmin(M[find(i)], M[i]);\n\n\t\n\n\tlong long ans = 0;\n\n\tint cnt = 0;\n\n\t\n\n\tfor(int i = 0; i < n; i++)\n\n\t\tif(find(i) == i)\n\n\t\t{\n\n\t\t\tans += M[i].first, cnt++;\n\n\t\t\tused[M[i].second] = true;\n\n\t\t}\n\n\n\n\tif(cnt == 1)\n\n\t{\n\n\t\tprintf(\"0\\n\");\n\n\t}\n\n\telse if(n < (cnt - 1) * 2)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tfor(int i = 0; i < n; i++)\n\n\t\t\tM[i] = std::make_pair(A[i], i);\n\n\t\tstd::sort(M, M + n);\n\n\t\t\n\n\t\tint rem = (cnt - 1) * 2 - cnt;\n\n\t\t\n\n\t\tfor(int i = 0; i < n && rem; i++)\n\n\t\t{\n\n\t\t\tif(used[M[i].second]) continue;\n\n\t\t\tans += M[i].first, rem--;\n\n\t\t}\n\n\t\t\n\n\t\tprintf(\"%lld\\n\", ans);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "96",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n\n//",
        "optimized_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <algorithm>\n\n\n\nconst int maxn = 1e5 + 20;\n\n\n\nint n, m, A[maxn], F[maxn];\n\nstd::pair<int,int> M[maxn];\n\nbool used[maxn];\n\n\n\nint find(int x)\n\n{\n\n\treturn F[x] == x ? x : (F[x] = find(F[x]));\n\n}\n\ntemplate<class TAT>void checkmin(TAT &x,const TAT &y)\n\n{\n\n\tif(y < x) x = y;\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 0; i < n; i++) scanf(\"%d\", &A[i]);\n\n\t\n\n\tfor(int i = 0; i < n; i++) F[i] = i;\n\n\t\n\n\tfor(int i = 0, x, y; i < m; i++)\n\n\t{\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tF[find(x)] = find(y);\n\n\t}\n\n\t\n\n\tfor(int i = 0; i < n; i++)\n\n\t\tM[i] = std::make_pair(A[i], i);\n\n\t\n\n\tfor(int i = 0; i < n; i++)\n\n\t\tcheckmin(M[find(i)], M[i]);\n\n\t\n\n\tlong long ans = 0;\n\n\tint cnt = 0;\n\n\t\n\n\tfor(int i = 0; i < n; i++)\n\n\t\tif(find(i) == i)\n\n\t\t{\n\n\t\t\tans += M[i].first, cnt++;\n\n\t\t\tused[M[i].second] = true;\n\n\t\t}\n\n\n\n\tif(cnt == 1)\n\n\t{\n\n\t\tprintf(\"0\\n\");\n\n\t}\n\n\telse if(n < (cnt - 1) * 2)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tfor(int i = 0; i < n; i++)\n\n\t\t\tM[i] = std::make_pair(A[i], i);\n\n\t\tstd::sort(M, M + n);\n\n\t\t\n\n\t\tint rem = (cnt - 1) * 2 - cnt;\n\n\t\t\n\n\t\tfor(int i = 0; i < n && rem; i++)\n\n\t\t{\n\n\t\t\tif(used[M[i].second]) continue;\n\n\t\t\tans += M[i].first, rem--;\n\n\t\t}\n\n\t\t\n\n\t\tprintf(\"%lld\\n\", ans);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "97",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define SZ(x) ((int)x.size())\n\n\n\nconst int N = 100005;\n\n\n\nint n, m;\n\nint a[N];\n\nint fa[N];\n\n\n\nvector<int> val[N];\n\n\n\nint getfa(int x) {\n\n\treturn fa[x] == x ? x : fa[x] = getfa(fa[x]);\n\n}\n\n\n\nvoid merge(int x, int y) {\n\n\tx = getfa(x);\n\n\ty = getfa(y);\n\n\tif(SZ(val[x]) < SZ(val[y])) {\n\n\t\tswap(x, y);\n\n\t}\n\n\tfor(auto v: val[y]) {\n\n\t\tval[x].push_back(v);\n\n\t}\n\n\tval[y].clear();\n\n\tfa[y] = x;\n\n}\n\n\n\nvoid input()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\n\n\t\tval[i].push_back(a[i]);\n\n\t\tfa[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++) {\n\n\t\tint x, y;\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++, y++;\n\n\t\tmerge(x, y);\n\n\t}\n\n}\n\n\n\nvoid solve()\n\n{\n\n\tlong long ans = 0;\n\n\n\n\tint cnt = (n - 1 - m) * 2;\n\n\n\n\tif(cnt == 0) {\n\n\t\tputs(\"0\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tvector<int> vec;\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tif(fa[i] == i) {\n\n\t\t\tsort(val[i].begin(), val[i].end());\n\n\t\t\tans += val[i][0];\n\n\t\t\tcnt--;\n\n\t\t\tfor(int j = 1; j < SZ(val[i]); j++) {\n\n\t\t\t\tvec.push_back(val[i][j]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tif(SZ(vec) < cnt) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tsort(vec.begin(), vec.end());\n\n\tfor(int i = 0; i < cnt; i++) {\n\n\t\tans += vec[i];\n\n\t}\n\n\tcout << ans << endl;\n\n}\n\n\n\nint main()\n\n{\n\n\tinput();\n\n\tsolve();\n\n\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <algorithm>\n\n\n\nconst int maxn = 1e5 + 20;\n\n\n\nint n, m, A[maxn], F[maxn];\n\nstd::pair<int,int> M[maxn];\n\nbool used[maxn];\n\n\n\nint find(int x)\n\n{\n\n\treturn F[x] == x ? x : (F[x] = find(F[x]));\n\n}\n\ntemplate<class TAT>void checkmin(TAT &x,const TAT &y)\n\n{\n\n\tif(y < x) x = y;\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 0; i < n; i++) scanf(\"%d\", &A[i]);\n\n\t\n\n\tfor(int i = 0; i < n; i++) F[i] = i;\n\n\t\n\n\tfor(int i = 0, x, y; i < m; i++)\n\n\t{\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tF[find(x)] = find(y);\n\n\t}\n\n\t\n\n\tfor(int i = 0; i < n; i++)\n\n\t\tM[i] = std::make_pair(A[i], i);\n\n\t\n\n\tfor(int i = 0; i < n; i++)\n\n\t\tcheckmin(M[find(i)], M[i]);\n\n\t\n\n\tlong long ans = 0;\n\n\tint cnt = 0;\n\n\t\n\n\tfor(int i = 0; i < n; i++)\n\n\t\tif(find(i) == i)\n\n\t\t{\n\n\t\t\tans += M[i].first, cnt++;\n\n\t\t\tused[M[i].second] = true;\n\n\t\t}\n\n\n\n\tif(cnt == 1)\n\n\t{\n\n\t\tprintf(\"0\\n\");\n\n\t}\n\n\telse if(n < (cnt - 1) * 2)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tfor(int i = 0; i < n; i++)\n\n\t\t\tM[i] = std::make_pair(A[i], i);\n\n\t\tstd::sort(M, M + n);\n\n\t\t\n\n\t\tint rem = (cnt - 1) * 2 - cnt;\n\n\t\t\n\n\t\tfor(int i = 0; i < n && rem; i++)\n\n\t\t{\n\n\t\t\tif(used[M[i].second]) continue;\n\n\t\t\tans += M[i].first, rem--;\n\n\t\t}\n\n\t\t\n\n\t\tprintf(\"%lld\\n\", ans);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "98",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\n#include<cstring>\n\n#define MN 200005\n\nusing namespace std;\n\ntypedef long long ll;\n\nll ans;\n\nbool used[MN];\n\nint n,m,fa[MN],id[MN],a[MN],sz[MN];\n\nint getf(int x){return x==fa[x]?x:fa[x]=getf(fa[x]);}\n\nbool cmp(int x,int y){return a[x]<a[y];}\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);int tt=(n-1-m)*2;int x,y;\n\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",&a[i]),fa[i]=id[i]=i;sort(id+1,id+n+1,cmp);\n\n\tfor(int i=1;i<=m;i++)scanf(\"%d%d\",&x,&y),fa[getf(++x)]=getf(++y);\n\n\t\n\n\tfor(int i=1;i<=n&&tt;i++)if(!used[id[i]]){\n\n\t\tif(sz[getf(id[i])])continue;\n\n\t\tsz[getf(id[i])]++,used[id[i]]=1,--tt,ans+=a[id[i]];\n\n\t}\n\n\tfor(int i=1;i<=n&&tt;i++)if(!used[id[i]]){\n\n\t\tif(sz[getf(id[i])]+1>n-1-m)continue;\n\n\t\tsz[getf(id[i])]++,--tt,ans+=a[id[i]];\n\n\t}if(tt)puts(\"Impossible\");else printf(\"%lld\\n\",ans);\n\n}\n"
    },
    {
        "id": "99",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n    }\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\n#include<cstring>\n\n#define MN 200005\n\nusing namespace std;\n\ntypedef long long ll;\n\nll ans;\n\nbool used[MN];\n\nint n,m,fa[MN],id[MN],a[MN],sz[MN];\n\nint getf(int x){return x==fa[x]?x:fa[x]=getf(fa[x]);}\n\nbool cmp(int x,int y){return a[x]<a[y];}\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);int tt=(n-1-m)*2;int x,y;\n\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",&a[i]),fa[i]=id[i]=i;sort(id+1,id+n+1,cmp);\n\n\tfor(int i=1;i<=m;i++)scanf(\"%d%d\",&x,&y),fa[getf(++x)]=getf(++y);\n\n\t\n\n\tfor(int i=1;i<=n&&tt;i++)if(!used[id[i]]){\n\n\t\tif(sz[getf(id[i])])continue;\n\n\t\tsz[getf(id[i])]++,used[id[i]]=1,--tt,ans+=a[id[i]];\n\n\t}\n\n\tfor(int i=1;i<=n&&tt;i++)if(!used[id[i]]){\n\n\t\tif(sz[getf(id[i])]+1>n-1-m)continue;\n\n\t\tsz[getf(id[i])]++,--tt,ans+=a[id[i]];\n\n\t}if(tt)puts(\"Impossible\");else printf(\"%lld\\n\",ans);\n\n}\n"
    },
    {
        "id": "100",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n\n//",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\n#include<cstring>\n\n#define MN 200005\n\nusing namespace std;\n\ntypedef long long ll;\n\nll ans;\n\nbool used[MN];\n\nint n,m,fa[MN],id[MN],a[MN],sz[MN];\n\nint getf(int x){return x==fa[x]?x:fa[x]=getf(fa[x]);}\n\nbool cmp(int x,int y){return a[x]<a[y];}\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);int tt=(n-1-m)*2;int x,y;\n\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",&a[i]),fa[i]=id[i]=i;sort(id+1,id+n+1,cmp);\n\n\tfor(int i=1;i<=m;i++)scanf(\"%d%d\",&x,&y),fa[getf(++x)]=getf(++y);\n\n\t\n\n\tfor(int i=1;i<=n&&tt;i++)if(!used[id[i]]){\n\n\t\tif(sz[getf(id[i])])continue;\n\n\t\tsz[getf(id[i])]++,used[id[i]]=1,--tt,ans+=a[id[i]];\n\n\t}\n\n\tfor(int i=1;i<=n&&tt;i++)if(!used[id[i]]){\n\n\t\tif(sz[getf(id[i])]+1>n-1-m)continue;\n\n\t\tsz[getf(id[i])]++,--tt,ans+=a[id[i]];\n\n\t}if(tt)puts(\"Impossible\");else printf(\"%lld\\n\",ans);\n\n}\n"
    },
    {
        "id": "101",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define SZ(x) ((int)x.size())\n\n\n\nconst int N = 100005;\n\n\n\nint n, m;\n\nint a[N];\n\nint fa[N];\n\n\n\nvector<int> val[N];\n\n\n\nint getfa(int x) {\n\n\treturn fa[x] == x ? x : fa[x] = getfa(fa[x]);\n\n}\n\n\n\nvoid merge(int x, int y) {\n\n\tx = getfa(x);\n\n\ty = getfa(y);\n\n\tif(SZ(val[x]) < SZ(val[y])) {\n\n\t\tswap(x, y);\n\n\t}\n\n\tfor(auto v: val[y]) {\n\n\t\tval[x].push_back(v);\n\n\t}\n\n\tval[y].clear();\n\n\tfa[y] = x;\n\n}\n\n\n\nvoid input()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\n\n\t\tval[i].push_back(a[i]);\n\n\t\tfa[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++) {\n\n\t\tint x, y;\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++, y++;\n\n\t\tmerge(x, y);\n\n\t}\n\n}\n\n\n\nvoid solve()\n\n{\n\n\tlong long ans = 0;\n\n\n\n\tint cnt = (n - 1 - m) * 2;\n\n\n\n\tif(cnt == 0) {\n\n\t\tputs(\"0\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tvector<int> vec;\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tif(fa[i] == i) {\n\n\t\t\tsort(val[i].begin(), val[i].end());\n\n\t\t\tans += val[i][0];\n\n\t\t\tcnt--;\n\n\t\t\tfor(int j = 1; j < SZ(val[i]); j++) {\n\n\t\t\t\tvec.push_back(val[i][j]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tif(SZ(vec) < cnt) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tsort(vec.begin(), vec.end());\n\n\tfor(int i = 0; i < cnt; i++) {\n\n\t\tans += vec[i];\n\n\t}\n\n\tcout << ans << endl;\n\n}\n\n\n\nint main()\n\n{\n\n\tinput();\n\n\tsolve();\n\n\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\n#include<cstring>\n\n#define MN 200005\n\nusing namespace std;\n\ntypedef long long ll;\n\nll ans;\n\nbool used[MN];\n\nint n,m,fa[MN],id[MN],a[MN],sz[MN];\n\nint getf(int x){return x==fa[x]?x:fa[x]=getf(fa[x]);}\n\nbool cmp(int x,int y){return a[x]<a[y];}\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);int tt=(n-1-m)*2;int x,y;\n\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",&a[i]),fa[i]=id[i]=i;sort(id+1,id+n+1,cmp);\n\n\tfor(int i=1;i<=m;i++)scanf(\"%d%d\",&x,&y),fa[getf(++x)]=getf(++y);\n\n\t\n\n\tfor(int i=1;i<=n&&tt;i++)if(!used[id[i]]){\n\n\t\tif(sz[getf(id[i])])continue;\n\n\t\tsz[getf(id[i])]++,used[id[i]]=1,--tt,ans+=a[id[i]];\n\n\t}\n\n\tfor(int i=1;i<=n&&tt;i++)if(!used[id[i]]){\n\n\t\tif(sz[getf(id[i])]+1>n-1-m)continue;\n\n\t\tsz[getf(id[i])]++,--tt,ans+=a[id[i]];\n\n\t}if(tt)puts(\"Impossible\");else printf(\"%lld\\n\",ans);\n\n}\n"
    },
    {
        "id": "102",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cctype>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<vector>\n\nusing std::vector;\n\n#define max(a,b) (a>b?a:b)\n\n#define min(a,b) (a<b?a:b)\n\n#define reg register\n\ntypedef long long ll;\n\ninline int read(){\n\n    reg int x=0,f=1;reg char ch=getchar();\n\n    for(;!isdigit(ch);f=ch=='-'?-1:1,ch=getchar());\n\n    for(;isdigit(ch);x=x*10+(ch^48),ch=getchar());\n\n    return x*f;\n\n}\n\nconst int MN=1e5+5;\n\nint n,m;\n\nclass UFset{\n\n\tpublic:\n\n\t\tint par[MN];\n\n\t\tinline int find(int x){return x==par[x]?x:par[x]=find(par[x]);}\n\n\t\tinline void init(int x){for(reg int i=0;i<x;i++)par[i]=i;}\n\n\t\tinline void unite(int x,int y){x=find(x);y=find(y);par[y]=x;}\n\n\t\tinline bool isfa(int x){return find(x)==x;}\n\n}S;\n\nint v[MN],cnt,id[MN],a[MN];\n\nvector<int>pts[MN];\n\nint main(){\n\n\tn=read();m=read();S.init(n);if(n==m+1)return 0*puts(\"0\");\n\n\tfor(reg int i=0;i<n;i++)v[i]=read();\n\n\tfor(reg int i=1;i<=m;i++)S.unite(read(),read());\n\n\tfor(reg int i=0;i<n;i++)if(S.isfa(i))id[i]=++cnt,pts[cnt].push_back(v[i]);\n\n\tfor(reg int i=0;i<n;i++)if(!S.isfa(i))pts[id[S.find(i)]].push_back(v[i]);\n\n\tif(n<((cnt-1)<<1))return 0*puts(\"Impossible\");\n\n\tfor(reg int i=1;i<=cnt;i++)std::sort(pts[i].begin(),pts[i].end());\n\n\treg ll ans=0;reg int tot=0;\n\n\tfor(reg int i=1;i<=cnt;i++)ans+=pts[i][0];\n\n\tfor(reg int i=1;i<=cnt;i++)for(reg int j=1;j<pts[i].size();j++)a[++tot]=pts[i][j];\n\n\tstd::sort(a+1,a+1+tot);\n\n\tfor(reg int i=1;i<=cnt-2;i++)ans+=a[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n    return 0;\n\n}"
    },
    {
        "id": "103",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n\n//",
        "optimized_code": "#include<cstdio>\n\n#include<cctype>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<vector>\n\nusing std::vector;\n\n#define max(a,b) (a>b?a:b)\n\n#define min(a,b) (a<b?a:b)\n\n#define reg register\n\ntypedef long long ll;\n\ninline int read(){\n\n    reg int x=0,f=1;reg char ch=getchar();\n\n    for(;!isdigit(ch);f=ch=='-'?-1:1,ch=getchar());\n\n    for(;isdigit(ch);x=x*10+(ch^48),ch=getchar());\n\n    return x*f;\n\n}\n\nconst int MN=1e5+5;\n\nint n,m;\n\nclass UFset{\n\n\tpublic:\n\n\t\tint par[MN];\n\n\t\tinline int find(int x){return x==par[x]?x:par[x]=find(par[x]);}\n\n\t\tinline void init(int x){for(reg int i=0;i<x;i++)par[i]=i;}\n\n\t\tinline void unite(int x,int y){x=find(x);y=find(y);par[y]=x;}\n\n\t\tinline bool isfa(int x){return find(x)==x;}\n\n}S;\n\nint v[MN],cnt,id[MN],a[MN];\n\nvector<int>pts[MN];\n\nint main(){\n\n\tn=read();m=read();S.init(n);if(n==m+1)return 0*puts(\"0\");\n\n\tfor(reg int i=0;i<n;i++)v[i]=read();\n\n\tfor(reg int i=1;i<=m;i++)S.unite(read(),read());\n\n\tfor(reg int i=0;i<n;i++)if(S.isfa(i))id[i]=++cnt,pts[cnt].push_back(v[i]);\n\n\tfor(reg int i=0;i<n;i++)if(!S.isfa(i))pts[id[S.find(i)]].push_back(v[i]);\n\n\tif(n<((cnt-1)<<1))return 0*puts(\"Impossible\");\n\n\tfor(reg int i=1;i<=cnt;i++)std::sort(pts[i].begin(),pts[i].end());\n\n\treg ll ans=0;reg int tot=0;\n\n\tfor(reg int i=1;i<=cnt;i++)ans+=pts[i][0];\n\n\tfor(reg int i=1;i<=cnt;i++)for(reg int j=1;j<pts[i].size();j++)a[++tot]=pts[i][j];\n\n\tstd::sort(a+1,a+1+tot);\n\n\tfor(reg int i=1;i<=cnt-2;i++)ans+=a[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n    return 0;\n\n}"
    },
    {
        "id": "104",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\nint n,m;\n\nint a[100001];\n\nint fa[100001];\n\nint us[100001],val[100001],num[100001],re[100001],p,cnt;\n\nint gf(int x){return fa[x]==x?x:(fa[x]=gf(fa[x]));}\n\nlong long ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);\n\n\tfor(int i=1;i<=n;i++) fa[i]=i;\n\n\tfor(int i=1,x,y;i<=m;i++) scanf(\"%d%d\",&x,&y),x++,y++,fa[gf(y)]=gf(x);\n\n\tfor(int i=1;i<=n;i++) if(fa[i]==i) cnt++;\n\n\tif(n<cnt*2-2) return !puts(\"Impossible\");\n\n\tif(cnt==1) return !puts(\"0\");\n\n\tfor(int i=1;i<=n;i++) val[i]=2147483647;\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tint x=gf(i);\n\n\t\tif(a[i]<val[x]) val[x]=a[i],num[x]=i;\n\n\t}\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tif(val[i]<2147483647) ans+=1ll*val[i];\n\n\t\tif(num[i]) us[num[i]]=1;\n\n\t}\n\n\tfor(int i=1;i<=n;i++) if(!us[i]) re[++p]=a[i];\n\n\tstd::sort(re+1,re+p+1);\n\n\tfor(int i=1;i<=cnt-2;i++) ans+=1ll*re[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "105",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n    }\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\nint n,m;\n\nint a[100001];\n\nint fa[100001];\n\nint us[100001],val[100001],num[100001],re[100001],p,cnt;\n\nint gf(int x){return fa[x]==x?x:(fa[x]=gf(fa[x]));}\n\nlong long ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);\n\n\tfor(int i=1;i<=n;i++) fa[i]=i;\n\n\tfor(int i=1,x,y;i<=m;i++) scanf(\"%d%d\",&x,&y),x++,y++,fa[gf(y)]=gf(x);\n\n\tfor(int i=1;i<=n;i++) if(fa[i]==i) cnt++;\n\n\tif(n<cnt*2-2) return !puts(\"Impossible\");\n\n\tif(cnt==1) return !puts(\"0\");\n\n\tfor(int i=1;i<=n;i++) val[i]=2147483647;\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tint x=gf(i);\n\n\t\tif(a[i]<val[x]) val[x]=a[i],num[x]=i;\n\n\t}\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tif(val[i]<2147483647) ans+=1ll*val[i];\n\n\t\tif(num[i]) us[num[i]]=1;\n\n\t}\n\n\tfor(int i=1;i<=n;i++) if(!us[i]) re[++p]=a[i];\n\n\tstd::sort(re+1,re+p+1);\n\n\tfor(int i=1;i<=cnt-2;i++) ans+=1ll*re[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "106",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n\n//",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\nint n,m;\n\nint a[100001];\n\nint fa[100001];\n\nint us[100001],val[100001],num[100001],re[100001],p,cnt;\n\nint gf(int x){return fa[x]==x?x:(fa[x]=gf(fa[x]));}\n\nlong long ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);\n\n\tfor(int i=1;i<=n;i++) fa[i]=i;\n\n\tfor(int i=1,x,y;i<=m;i++) scanf(\"%d%d\",&x,&y),x++,y++,fa[gf(y)]=gf(x);\n\n\tfor(int i=1;i<=n;i++) if(fa[i]==i) cnt++;\n\n\tif(n<cnt*2-2) return !puts(\"Impossible\");\n\n\tif(cnt==1) return !puts(\"0\");\n\n\tfor(int i=1;i<=n;i++) val[i]=2147483647;\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tint x=gf(i);\n\n\t\tif(a[i]<val[x]) val[x]=a[i],num[x]=i;\n\n\t}\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tif(val[i]<2147483647) ans+=1ll*val[i];\n\n\t\tif(num[i]) us[num[i]]=1;\n\n\t}\n\n\tfor(int i=1;i<=n;i++) if(!us[i]) re[++p]=a[i];\n\n\tstd::sort(re+1,re+p+1);\n\n\tfor(int i=1;i<=cnt-2;i++) ans+=1ll*re[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "107",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define SZ(x) ((int)x.size())\n\n\n\nconst int N = 100005;\n\n\n\nint n, m;\n\nint a[N];\n\nint fa[N];\n\n\n\nvector<int> val[N];\n\n\n\nint getfa(int x) {\n\n\treturn fa[x] == x ? x : fa[x] = getfa(fa[x]);\n\n}\n\n\n\nvoid merge(int x, int y) {\n\n\tx = getfa(x);\n\n\ty = getfa(y);\n\n\tif(SZ(val[x]) < SZ(val[y])) {\n\n\t\tswap(x, y);\n\n\t}\n\n\tfor(auto v: val[y]) {\n\n\t\tval[x].push_back(v);\n\n\t}\n\n\tval[y].clear();\n\n\tfa[y] = x;\n\n}\n\n\n\nvoid input()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\n\n\t\tval[i].push_back(a[i]);\n\n\t\tfa[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++) {\n\n\t\tint x, y;\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++, y++;\n\n\t\tmerge(x, y);\n\n\t}\n\n}\n\n\n\nvoid solve()\n\n{\n\n\tlong long ans = 0;\n\n\n\n\tint cnt = (n - 1 - m) * 2;\n\n\n\n\tif(cnt == 0) {\n\n\t\tputs(\"0\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tvector<int> vec;\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tif(fa[i] == i) {\n\n\t\t\tsort(val[i].begin(), val[i].end());\n\n\t\t\tans += val[i][0];\n\n\t\t\tcnt--;\n\n\t\t\tfor(int j = 1; j < SZ(val[i]); j++) {\n\n\t\t\t\tvec.push_back(val[i][j]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tif(SZ(vec) < cnt) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tsort(vec.begin(), vec.end());\n\n\tfor(int i = 0; i < cnt; i++) {\n\n\t\tans += vec[i];\n\n\t}\n\n\tcout << ans << endl;\n\n}\n\n\n\nint main()\n\n{\n\n\tinput();\n\n\tsolve();\n\n\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\nint n,m;\n\nint a[100001];\n\nint fa[100001];\n\nint us[100001],val[100001],num[100001],re[100001],p,cnt;\n\nint gf(int x){return fa[x]==x?x:(fa[x]=gf(fa[x]));}\n\nlong long ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);\n\n\tfor(int i=1;i<=n;i++) fa[i]=i;\n\n\tfor(int i=1,x,y;i<=m;i++) scanf(\"%d%d\",&x,&y),x++,y++,fa[gf(y)]=gf(x);\n\n\tfor(int i=1;i<=n;i++) if(fa[i]==i) cnt++;\n\n\tif(n<cnt*2-2) return !puts(\"Impossible\");\n\n\tif(cnt==1) return !puts(\"0\");\n\n\tfor(int i=1;i<=n;i++) val[i]=2147483647;\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tint x=gf(i);\n\n\t\tif(a[i]<val[x]) val[x]=a[i],num[x]=i;\n\n\t}\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tif(val[i]<2147483647) ans+=1ll*val[i];\n\n\t\tif(num[i]) us[num[i]]=1;\n\n\t}\n\n\tfor(int i=1;i<=n;i++) if(!us[i]) re[++p]=a[i];\n\n\tstd::sort(re+1,re+p+1);\n\n\tfor(int i=1;i<=cnt-2;i++) ans+=1ll*re[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "108",
        "source_code": "#include<cstdio>\n\n#include<cctype>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<vector>\n\nusing std::vector;\n\n#define max(a,b) (a>b?a:b)\n\n#define min(a,b) (a<b?a:b)\n\n#define reg register\n\ntypedef long long ll;\n\ninline int read(){\n\n    reg int x=0,f=1;reg char ch=getchar();\n\n    for(;!isdigit(ch);f=ch=='-'?-1:1,ch=getchar());\n\n    for(;isdigit(ch);x=x*10+(ch^48),ch=getchar());\n\n    return x*f;\n\n}\n\nconst int MN=1e5+5;\n\nint n,m;\n\nclass UFset{\n\n\tpublic:\n\n\t\tint par[MN];\n\n\t\tinline int find(int x){return x==par[x]?x:par[x]=find(par[x]);}\n\n\t\tinline void init(int x){for(reg int i=0;i<x;i++)par[i]=i;}\n\n\t\tinline void unite(int x,int y){x=find(x);y=find(y);par[y]=x;}\n\n\t\tinline bool isfa(int x){return find(x)==x;}\n\n}S;\n\nint v[MN],cnt,id[MN],a[MN];\n\nvector<int>pts[MN];\n\nint main(){\n\n\tn=read();m=read();S.init(n);if(n==m+1)return 0*puts(\"0\");\n\n\tfor(reg int i=0;i<n;i++)v[i]=read();\n\n\tfor(reg int i=1;i<=m;i++)S.unite(read(),read());\n\n\tfor(reg int i=0;i<n;i++)if(S.isfa(i))id[i]=++cnt,pts[cnt].push_back(v[i]);\n\n\tfor(reg int i=0;i<n;i++)if(!S.isfa(i))pts[id[S.find(i)]].push_back(v[i]);\n\n\tif(n<((cnt-1)<<1))return 0*puts(\"Impossible\");\n\n\tfor(reg int i=1;i<=cnt;i++)std::sort(pts[i].begin(),pts[i].end());\n\n\treg ll ans=0;reg int tot=0;\n\n\tfor(reg int i=1;i<=cnt;i++)ans+=pts[i][0];\n\n\tfor(reg int i=1;i<=cnt;i++)for(reg int j=1;j<pts[i].size();j++)a[++tot]=pts[i][j];\n\n\tstd::sort(a+1,a+1+tot);\n\n\tfor(reg int i=1;i<=cnt-2;i++)ans+=a[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\nint n,m;\n\nint a[100001];\n\nint fa[100001];\n\nint us[100001],val[100001],num[100001],re[100001],p,cnt;\n\nint gf(int x){return fa[x]==x?x:(fa[x]=gf(fa[x]));}\n\nlong long ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);\n\n\tfor(int i=1;i<=n;i++) fa[i]=i;\n\n\tfor(int i=1,x,y;i<=m;i++) scanf(\"%d%d\",&x,&y),x++,y++,fa[gf(y)]=gf(x);\n\n\tfor(int i=1;i<=n;i++) if(fa[i]==i) cnt++;\n\n\tif(n<cnt*2-2) return !puts(\"Impossible\");\n\n\tif(cnt==1) return !puts(\"0\");\n\n\tfor(int i=1;i<=n;i++) val[i]=2147483647;\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tint x=gf(i);\n\n\t\tif(a[i]<val[x]) val[x]=a[i],num[x]=i;\n\n\t}\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tif(val[i]<2147483647) ans+=1ll*val[i];\n\n\t\tif(num[i]) us[num[i]]=1;\n\n\t}\n\n\tfor(int i=1;i<=n;i++) if(!us[i]) re[++p]=a[i];\n\n\tstd::sort(re+1,re+p+1);\n\n\tfor(int i=1;i<=cnt-2;i++) ans+=1ll*re[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "109",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\n#define F(i,a,b) for(int i=(a);i<=(b);++i)\n\nusing namespace std;\n\ntypedef long long ll;\n\n\n\nint n,m;\n\nint a[100001],b[100001],t;\n\nint fa[100001];\n\nint ff(int x){return fa[x]?fa[x]=ff(fa[x]):x;}\n\nll Sum;\n\n\n\nint main(){\n\n\tint x,y;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tif(m==n-1) return puts(\"0\"),0;\n\n\tF(i,1,n) scanf(\"%d\",a+i), Sum+=a[i];\n\n\tF(i,1,m){\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tx=ff(x+1); y=ff(y+1);\n\n\t\tSum-=max(a[x],a[y]);\n\n\t\tb[++t]=max(a[x],a[y]);\n\n\t\tif(a[x]>a[y]) fa[x]=y;\n\n\t\telse fa[y]=x;\n\n\t}\n\n\tif(t<n-m-2) return puts(\"Impossible\"),0;\n\n\tsort(b+1,b+t+1);\n\n\tF(i,1,n-m-2) Sum+=b[i];\n\n\tprintf(\"%lld\",Sum);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "110",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n    }\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\n#define F(i,a,b) for(int i=(a);i<=(b);++i)\n\nusing namespace std;\n\ntypedef long long ll;\n\n\n\nint n,m;\n\nint a[100001],b[100001],t;\n\nint fa[100001];\n\nint ff(int x){return fa[x]?fa[x]=ff(fa[x]):x;}\n\nll Sum;\n\n\n\nint main(){\n\n\tint x,y;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tif(m==n-1) return puts(\"0\"),0;\n\n\tF(i,1,n) scanf(\"%d\",a+i), Sum+=a[i];\n\n\tF(i,1,m){\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tx=ff(x+1); y=ff(y+1);\n\n\t\tSum-=max(a[x],a[y]);\n\n\t\tb[++t]=max(a[x],a[y]);\n\n\t\tif(a[x]>a[y]) fa[x]=y;\n\n\t\telse fa[y]=x;\n\n\t}\n\n\tif(t<n-m-2) return puts(\"Impossible\"),0;\n\n\tsort(b+1,b+t+1);\n\n\tF(i,1,n-m-2) Sum+=b[i];\n\n\tprintf(\"%lld\",Sum);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "111",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n\n//",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\n#define F(i,a,b) for(int i=(a);i<=(b);++i)\n\nusing namespace std;\n\ntypedef long long ll;\n\n\n\nint n,m;\n\nint a[100001],b[100001],t;\n\nint fa[100001];\n\nint ff(int x){return fa[x]?fa[x]=ff(fa[x]):x;}\n\nll Sum;\n\n\n\nint main(){\n\n\tint x,y;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tif(m==n-1) return puts(\"0\"),0;\n\n\tF(i,1,n) scanf(\"%d\",a+i), Sum+=a[i];\n\n\tF(i,1,m){\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tx=ff(x+1); y=ff(y+1);\n\n\t\tSum-=max(a[x],a[y]);\n\n\t\tb[++t]=max(a[x],a[y]);\n\n\t\tif(a[x]>a[y]) fa[x]=y;\n\n\t\telse fa[y]=x;\n\n\t}\n\n\tif(t<n-m-2) return puts(\"Impossible\"),0;\n\n\tsort(b+1,b+t+1);\n\n\tF(i,1,n-m-2) Sum+=b[i];\n\n\tprintf(\"%lld\",Sum);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "112",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define SZ(x) ((int)x.size())\n\n\n\nconst int N = 100005;\n\n\n\nint n, m;\n\nint a[N];\n\nint fa[N];\n\n\n\nvector<int> val[N];\n\n\n\nint getfa(int x) {\n\n\treturn fa[x] == x ? x : fa[x] = getfa(fa[x]);\n\n}\n\n\n\nvoid merge(int x, int y) {\n\n\tx = getfa(x);\n\n\ty = getfa(y);\n\n\tif(SZ(val[x]) < SZ(val[y])) {\n\n\t\tswap(x, y);\n\n\t}\n\n\tfor(auto v: val[y]) {\n\n\t\tval[x].push_back(v);\n\n\t}\n\n\tval[y].clear();\n\n\tfa[y] = x;\n\n}\n\n\n\nvoid input()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\n\n\t\tval[i].push_back(a[i]);\n\n\t\tfa[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++) {\n\n\t\tint x, y;\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++, y++;\n\n\t\tmerge(x, y);\n\n\t}\n\n}\n\n\n\nvoid solve()\n\n{\n\n\tlong long ans = 0;\n\n\n\n\tint cnt = (n - 1 - m) * 2;\n\n\n\n\tif(cnt == 0) {\n\n\t\tputs(\"0\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tvector<int> vec;\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tif(fa[i] == i) {\n\n\t\t\tsort(val[i].begin(), val[i].end());\n\n\t\t\tans += val[i][0];\n\n\t\t\tcnt--;\n\n\t\t\tfor(int j = 1; j < SZ(val[i]); j++) {\n\n\t\t\t\tvec.push_back(val[i][j]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tif(SZ(vec) < cnt) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tsort(vec.begin(), vec.end());\n\n\tfor(int i = 0; i < cnt; i++) {\n\n\t\tans += vec[i];\n\n\t}\n\n\tcout << ans << endl;\n\n}\n\n\n\nint main()\n\n{\n\n\tinput();\n\n\tsolve();\n\n\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\n#define F(i,a,b) for(int i=(a);i<=(b);++i)\n\nusing namespace std;\n\ntypedef long long ll;\n\n\n\nint n,m;\n\nint a[100001],b[100001],t;\n\nint fa[100001];\n\nint ff(int x){return fa[x]?fa[x]=ff(fa[x]):x;}\n\nll Sum;\n\n\n\nint main(){\n\n\tint x,y;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tif(m==n-1) return puts(\"0\"),0;\n\n\tF(i,1,n) scanf(\"%d\",a+i), Sum+=a[i];\n\n\tF(i,1,m){\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tx=ff(x+1); y=ff(y+1);\n\n\t\tSum-=max(a[x],a[y]);\n\n\t\tb[++t]=max(a[x],a[y]);\n\n\t\tif(a[x]>a[y]) fa[x]=y;\n\n\t\telse fa[y]=x;\n\n\t}\n\n\tif(t<n-m-2) return puts(\"Impossible\"),0;\n\n\tsort(b+1,b+t+1);\n\n\tF(i,1,n-m-2) Sum+=b[i];\n\n\tprintf(\"%lld\",Sum);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "113",
        "source_code": "#include<cstdio>\n\n#include<cctype>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<vector>\n\nusing std::vector;\n\n#define max(a,b) (a>b?a:b)\n\n#define min(a,b) (a<b?a:b)\n\n#define reg register\n\ntypedef long long ll;\n\ninline int read(){\n\n    reg int x=0,f=1;reg char ch=getchar();\n\n    for(;!isdigit(ch);f=ch=='-'?-1:1,ch=getchar());\n\n    for(;isdigit(ch);x=x*10+(ch^48),ch=getchar());\n\n    return x*f;\n\n}\n\nconst int MN=1e5+5;\n\nint n,m;\n\nclass UFset{\n\n\tpublic:\n\n\t\tint par[MN];\n\n\t\tinline int find(int x){return x==par[x]?x:par[x]=find(par[x]);}\n\n\t\tinline void init(int x){for(reg int i=0;i<x;i++)par[i]=i;}\n\n\t\tinline void unite(int x,int y){x=find(x);y=find(y);par[y]=x;}\n\n\t\tinline bool isfa(int x){return find(x)==x;}\n\n}S;\n\nint v[MN],cnt,id[MN],a[MN];\n\nvector<int>pts[MN];\n\nint main(){\n\n\tn=read();m=read();S.init(n);if(n==m+1)return 0*puts(\"0\");\n\n\tfor(reg int i=0;i<n;i++)v[i]=read();\n\n\tfor(reg int i=1;i<=m;i++)S.unite(read(),read());\n\n\tfor(reg int i=0;i<n;i++)if(S.isfa(i))id[i]=++cnt,pts[cnt].push_back(v[i]);\n\n\tfor(reg int i=0;i<n;i++)if(!S.isfa(i))pts[id[S.find(i)]].push_back(v[i]);\n\n\tif(n<((cnt-1)<<1))return 0*puts(\"Impossible\");\n\n\tfor(reg int i=1;i<=cnt;i++)std::sort(pts[i].begin(),pts[i].end());\n\n\treg ll ans=0;reg int tot=0;\n\n\tfor(reg int i=1;i<=cnt;i++)ans+=pts[i][0];\n\n\tfor(reg int i=1;i<=cnt;i++)for(reg int j=1;j<pts[i].size();j++)a[++tot]=pts[i][j];\n\n\tstd::sort(a+1,a+1+tot);\n\n\tfor(reg int i=1;i<=cnt-2;i++)ans+=a[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\n#define F(i,a,b) for(int i=(a);i<=(b);++i)\n\nusing namespace std;\n\ntypedef long long ll;\n\n\n\nint n,m;\n\nint a[100001],b[100001],t;\n\nint fa[100001];\n\nint ff(int x){return fa[x]?fa[x]=ff(fa[x]):x;}\n\nll Sum;\n\n\n\nint main(){\n\n\tint x,y;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tif(m==n-1) return puts(\"0\"),0;\n\n\tF(i,1,n) scanf(\"%d\",a+i), Sum+=a[i];\n\n\tF(i,1,m){\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tx=ff(x+1); y=ff(y+1);\n\n\t\tSum-=max(a[x],a[y]);\n\n\t\tb[++t]=max(a[x],a[y]);\n\n\t\tif(a[x]>a[y]) fa[x]=y;\n\n\t\telse fa[y]=x;\n\n\t}\n\n\tif(t<n-m-2) return puts(\"Impossible\"),0;\n\n\tsort(b+1,b+t+1);\n\n\tF(i,1,n-m-2) Sum+=b[i];\n\n\tprintf(\"%lld\",Sum);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "114",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define mp(x,y) make_pair(x,y) \n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\ntypedef pair<ll,int> pr;\n\n//priority_queue<pr,vector<pr>,greater<pr> >q;\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],res;\n\nint d[MN],fa[MN],rk[MN],num[MN],h[MN],ch[2][MN];\n\nint n,m,x,y,cnt,tot,fx,fy,rt,ct;\n\nbool vis[MN];\n\nll mn[MN];bool tmp[MN];\n\ninline int gf(int x){return fa[x]?fa[x]=gf(fa[x]):x;}\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\ninline int merge(int x,int y){\n\n    if (!x) return y;if (!y) return x;\n\n    if (a[x]>a[y]||(a[x]==a[y]&&x>y)) swap(x,y);\n\n    ch[1][x]=merge(ch[1][x],y);fa[ch[1][x]]=x;\n\n    if (d[ch[0][x]]<d[ch[1][x]]) swap(ch[0][x],ch[1][x]);\n\n    d[x]=d[ch[1][x]]+1;return x;\n\n}\n\ninline int pop(int x){\n\n    a[x]=-1;fa[x]=-1;fa[ch[0][x]]=fa[ch[1][x]]=0;\n\n    return merge(ch[0][x],ch[1][x]);\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);\n\n\t\trk[tot]=i;dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\t/*\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (rk[num[i]]==i) continue;\n\n\t\tfx=gf(i),fy=gf(rk[num[i]]);merge(fx,fy);\n\n\t}\n\n\tfor (int i=1;i<=tot;++i){\n\n\t\tfx=gf(rk[i]);q.push(mp(a[fx],fx));\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tpr x=q.top();q.pop();\n\n\t\tif (q.empty()) break;pr y=q.top();q.pop();\n\n\t\tres+=1ll*x.first+y.first;++ct;\n\n\t\tfx=gf(x.second),fy=gf(y.second);printf(\"%d %d\\n\",fx,fy);\n\n\t\tfx=pop(fx);fy=pop(fy);rt=merge(fx,fy);\n\n\t\tif (rt) q.push(mp(a[rt],rt));\n\n\t}*/\n\n//\tif (ct+m!=n-1) printf(\"Impossible\");\n\n//\telse \n\n//\tprintf(\"%lld\",res);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "115",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n    }\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define mp(x,y) make_pair(x,y) \n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\ntypedef pair<ll,int> pr;\n\n//priority_queue<pr,vector<pr>,greater<pr> >q;\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],res;\n\nint d[MN],fa[MN],rk[MN],num[MN],h[MN],ch[2][MN];\n\nint n,m,x,y,cnt,tot,fx,fy,rt,ct;\n\nbool vis[MN];\n\nll mn[MN];bool tmp[MN];\n\ninline int gf(int x){return fa[x]?fa[x]=gf(fa[x]):x;}\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\ninline int merge(int x,int y){\n\n    if (!x) return y;if (!y) return x;\n\n    if (a[x]>a[y]||(a[x]==a[y]&&x>y)) swap(x,y);\n\n    ch[1][x]=merge(ch[1][x],y);fa[ch[1][x]]=x;\n\n    if (d[ch[0][x]]<d[ch[1][x]]) swap(ch[0][x],ch[1][x]);\n\n    d[x]=d[ch[1][x]]+1;return x;\n\n}\n\ninline int pop(int x){\n\n    a[x]=-1;fa[x]=-1;fa[ch[0][x]]=fa[ch[1][x]]=0;\n\n    return merge(ch[0][x],ch[1][x]);\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);\n\n\t\trk[tot]=i;dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\t/*\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (rk[num[i]]==i) continue;\n\n\t\tfx=gf(i),fy=gf(rk[num[i]]);merge(fx,fy);\n\n\t}\n\n\tfor (int i=1;i<=tot;++i){\n\n\t\tfx=gf(rk[i]);q.push(mp(a[fx],fx));\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tpr x=q.top();q.pop();\n\n\t\tif (q.empty()) break;pr y=q.top();q.pop();\n\n\t\tres+=1ll*x.first+y.first;++ct;\n\n\t\tfx=gf(x.second),fy=gf(y.second);printf(\"%d %d\\n\",fx,fy);\n\n\t\tfx=pop(fx);fy=pop(fy);rt=merge(fx,fy);\n\n\t\tif (rt) q.push(mp(a[rt],rt));\n\n\t}*/\n\n//\tif (ct+m!=n-1) printf(\"Impossible\");\n\n//\telse \n\n//\tprintf(\"%lld\",res);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "116",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n\n//",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define mp(x,y) make_pair(x,y) \n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\ntypedef pair<ll,int> pr;\n\n//priority_queue<pr,vector<pr>,greater<pr> >q;\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],res;\n\nint d[MN],fa[MN],rk[MN],num[MN],h[MN],ch[2][MN];\n\nint n,m,x,y,cnt,tot,fx,fy,rt,ct;\n\nbool vis[MN];\n\nll mn[MN];bool tmp[MN];\n\ninline int gf(int x){return fa[x]?fa[x]=gf(fa[x]):x;}\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\ninline int merge(int x,int y){\n\n    if (!x) return y;if (!y) return x;\n\n    if (a[x]>a[y]||(a[x]==a[y]&&x>y)) swap(x,y);\n\n    ch[1][x]=merge(ch[1][x],y);fa[ch[1][x]]=x;\n\n    if (d[ch[0][x]]<d[ch[1][x]]) swap(ch[0][x],ch[1][x]);\n\n    d[x]=d[ch[1][x]]+1;return x;\n\n}\n\ninline int pop(int x){\n\n    a[x]=-1;fa[x]=-1;fa[ch[0][x]]=fa[ch[1][x]]=0;\n\n    return merge(ch[0][x],ch[1][x]);\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);\n\n\t\trk[tot]=i;dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\t/*\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (rk[num[i]]==i) continue;\n\n\t\tfx=gf(i),fy=gf(rk[num[i]]);merge(fx,fy);\n\n\t}\n\n\tfor (int i=1;i<=tot;++i){\n\n\t\tfx=gf(rk[i]);q.push(mp(a[fx],fx));\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tpr x=q.top();q.pop();\n\n\t\tif (q.empty()) break;pr y=q.top();q.pop();\n\n\t\tres+=1ll*x.first+y.first;++ct;\n\n\t\tfx=gf(x.second),fy=gf(y.second);printf(\"%d %d\\n\",fx,fy);\n\n\t\tfx=pop(fx);fy=pop(fy);rt=merge(fx,fy);\n\n\t\tif (rt) q.push(mp(a[rt],rt));\n\n\t}*/\n\n//\tif (ct+m!=n-1) printf(\"Impossible\");\n\n//\telse \n\n//\tprintf(\"%lld\",res);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "117",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define SZ(x) ((int)x.size())\n\n\n\nconst int N = 100005;\n\n\n\nint n, m;\n\nint a[N];\n\nint fa[N];\n\n\n\nvector<int> val[N];\n\n\n\nint getfa(int x) {\n\n\treturn fa[x] == x ? x : fa[x] = getfa(fa[x]);\n\n}\n\n\n\nvoid merge(int x, int y) {\n\n\tx = getfa(x);\n\n\ty = getfa(y);\n\n\tif(SZ(val[x]) < SZ(val[y])) {\n\n\t\tswap(x, y);\n\n\t}\n\n\tfor(auto v: val[y]) {\n\n\t\tval[x].push_back(v);\n\n\t}\n\n\tval[y].clear();\n\n\tfa[y] = x;\n\n}\n\n\n\nvoid input()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\n\n\t\tval[i].push_back(a[i]);\n\n\t\tfa[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++) {\n\n\t\tint x, y;\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++, y++;\n\n\t\tmerge(x, y);\n\n\t}\n\n}\n\n\n\nvoid solve()\n\n{\n\n\tlong long ans = 0;\n\n\n\n\tint cnt = (n - 1 - m) * 2;\n\n\n\n\tif(cnt == 0) {\n\n\t\tputs(\"0\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tvector<int> vec;\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tif(fa[i] == i) {\n\n\t\t\tsort(val[i].begin(), val[i].end());\n\n\t\t\tans += val[i][0];\n\n\t\t\tcnt--;\n\n\t\t\tfor(int j = 1; j < SZ(val[i]); j++) {\n\n\t\t\t\tvec.push_back(val[i][j]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tif(SZ(vec) < cnt) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tsort(vec.begin(), vec.end());\n\n\tfor(int i = 0; i < cnt; i++) {\n\n\t\tans += vec[i];\n\n\t}\n\n\tcout << ans << endl;\n\n}\n\n\n\nint main()\n\n{\n\n\tinput();\n\n\tsolve();\n\n\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define mp(x,y) make_pair(x,y) \n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\ntypedef pair<ll,int> pr;\n\n//priority_queue<pr,vector<pr>,greater<pr> >q;\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],res;\n\nint d[MN],fa[MN],rk[MN],num[MN],h[MN],ch[2][MN];\n\nint n,m,x,y,cnt,tot,fx,fy,rt,ct;\n\nbool vis[MN];\n\nll mn[MN];bool tmp[MN];\n\ninline int gf(int x){return fa[x]?fa[x]=gf(fa[x]):x;}\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\ninline int merge(int x,int y){\n\n    if (!x) return y;if (!y) return x;\n\n    if (a[x]>a[y]||(a[x]==a[y]&&x>y)) swap(x,y);\n\n    ch[1][x]=merge(ch[1][x],y);fa[ch[1][x]]=x;\n\n    if (d[ch[0][x]]<d[ch[1][x]]) swap(ch[0][x],ch[1][x]);\n\n    d[x]=d[ch[1][x]]+1;return x;\n\n}\n\ninline int pop(int x){\n\n    a[x]=-1;fa[x]=-1;fa[ch[0][x]]=fa[ch[1][x]]=0;\n\n    return merge(ch[0][x],ch[1][x]);\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);\n\n\t\trk[tot]=i;dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\t/*\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (rk[num[i]]==i) continue;\n\n\t\tfx=gf(i),fy=gf(rk[num[i]]);merge(fx,fy);\n\n\t}\n\n\tfor (int i=1;i<=tot;++i){\n\n\t\tfx=gf(rk[i]);q.push(mp(a[fx],fx));\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tpr x=q.top();q.pop();\n\n\t\tif (q.empty()) break;pr y=q.top();q.pop();\n\n\t\tres+=1ll*x.first+y.first;++ct;\n\n\t\tfx=gf(x.second),fy=gf(y.second);printf(\"%d %d\\n\",fx,fy);\n\n\t\tfx=pop(fx);fy=pop(fy);rt=merge(fx,fy);\n\n\t\tif (rt) q.push(mp(a[rt],rt));\n\n\t}*/\n\n//\tif (ct+m!=n-1) printf(\"Impossible\");\n\n//\telse \n\n//\tprintf(\"%lld\",res);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "118",
        "source_code": "#include<cstdio>\n\n#include<cctype>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<vector>\n\nusing std::vector;\n\n#define max(a,b) (a>b?a:b)\n\n#define min(a,b) (a<b?a:b)\n\n#define reg register\n\ntypedef long long ll;\n\ninline int read(){\n\n    reg int x=0,f=1;reg char ch=getchar();\n\n    for(;!isdigit(ch);f=ch=='-'?-1:1,ch=getchar());\n\n    for(;isdigit(ch);x=x*10+(ch^48),ch=getchar());\n\n    return x*f;\n\n}\n\nconst int MN=1e5+5;\n\nint n,m;\n\nclass UFset{\n\n\tpublic:\n\n\t\tint par[MN];\n\n\t\tinline int find(int x){return x==par[x]?x:par[x]=find(par[x]);}\n\n\t\tinline void init(int x){for(reg int i=0;i<x;i++)par[i]=i;}\n\n\t\tinline void unite(int x,int y){x=find(x);y=find(y);par[y]=x;}\n\n\t\tinline bool isfa(int x){return find(x)==x;}\n\n}S;\n\nint v[MN],cnt,id[MN],a[MN];\n\nvector<int>pts[MN];\n\nint main(){\n\n\tn=read();m=read();S.init(n);if(n==m+1)return 0*puts(\"0\");\n\n\tfor(reg int i=0;i<n;i++)v[i]=read();\n\n\tfor(reg int i=1;i<=m;i++)S.unite(read(),read());\n\n\tfor(reg int i=0;i<n;i++)if(S.isfa(i))id[i]=++cnt,pts[cnt].push_back(v[i]);\n\n\tfor(reg int i=0;i<n;i++)if(!S.isfa(i))pts[id[S.find(i)]].push_back(v[i]);\n\n\tif(n<((cnt-1)<<1))return 0*puts(\"Impossible\");\n\n\tfor(reg int i=1;i<=cnt;i++)std::sort(pts[i].begin(),pts[i].end());\n\n\treg ll ans=0;reg int tot=0;\n\n\tfor(reg int i=1;i<=cnt;i++)ans+=pts[i][0];\n\n\tfor(reg int i=1;i<=cnt;i++)for(reg int j=1;j<pts[i].size();j++)a[++tot]=pts[i][j];\n\n\tstd::sort(a+1,a+1+tot);\n\n\tfor(reg int i=1;i<=cnt-2;i++)ans+=a[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define mp(x,y) make_pair(x,y) \n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\ntypedef pair<ll,int> pr;\n\n//priority_queue<pr,vector<pr>,greater<pr> >q;\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],res;\n\nint d[MN],fa[MN],rk[MN],num[MN],h[MN],ch[2][MN];\n\nint n,m,x,y,cnt,tot,fx,fy,rt,ct;\n\nbool vis[MN];\n\nll mn[MN];bool tmp[MN];\n\ninline int gf(int x){return fa[x]?fa[x]=gf(fa[x]):x;}\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\ninline int merge(int x,int y){\n\n    if (!x) return y;if (!y) return x;\n\n    if (a[x]>a[y]||(a[x]==a[y]&&x>y)) swap(x,y);\n\n    ch[1][x]=merge(ch[1][x],y);fa[ch[1][x]]=x;\n\n    if (d[ch[0][x]]<d[ch[1][x]]) swap(ch[0][x],ch[1][x]);\n\n    d[x]=d[ch[1][x]]+1;return x;\n\n}\n\ninline int pop(int x){\n\n    a[x]=-1;fa[x]=-1;fa[ch[0][x]]=fa[ch[1][x]]=0;\n\n    return merge(ch[0][x],ch[1][x]);\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);\n\n\t\trk[tot]=i;dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\t/*\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (rk[num[i]]==i) continue;\n\n\t\tfx=gf(i),fy=gf(rk[num[i]]);merge(fx,fy);\n\n\t}\n\n\tfor (int i=1;i<=tot;++i){\n\n\t\tfx=gf(rk[i]);q.push(mp(a[fx],fx));\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tpr x=q.top();q.pop();\n\n\t\tif (q.empty()) break;pr y=q.top();q.pop();\n\n\t\tres+=1ll*x.first+y.first;++ct;\n\n\t\tfx=gf(x.second),fy=gf(y.second);printf(\"%d %d\\n\",fx,fy);\n\n\t\tfx=pop(fx);fy=pop(fy);rt=merge(fx,fy);\n\n\t\tif (rt) q.push(mp(a[rt],rt));\n\n\t}*/\n\n//\tif (ct+m!=n-1) printf(\"Impossible\");\n\n//\telse \n\n//\tprintf(\"%lld\",res);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "119",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],mn[MN],res;\n\nint num[MN],h[MN];\n\nint n,m,x,y,cnt,tot,ct;\n\nbool vis[MN],tmp[MN];\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "120",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n    }\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],mn[MN],res;\n\nint num[MN],h[MN];\n\nint n,m,x,y,cnt,tot,ct;\n\nbool vis[MN],tmp[MN];\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "121",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n\n//",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],mn[MN],res;\n\nint num[MN],h[MN];\n\nint n,m,x,y,cnt,tot,ct;\n\nbool vis[MN],tmp[MN];\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "122",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define SZ(x) ((int)x.size())\n\n\n\nconst int N = 100005;\n\n\n\nint n, m;\n\nint a[N];\n\nint fa[N];\n\n\n\nvector<int> val[N];\n\n\n\nint getfa(int x) {\n\n\treturn fa[x] == x ? x : fa[x] = getfa(fa[x]);\n\n}\n\n\n\nvoid merge(int x, int y) {\n\n\tx = getfa(x);\n\n\ty = getfa(y);\n\n\tif(SZ(val[x]) < SZ(val[y])) {\n\n\t\tswap(x, y);\n\n\t}\n\n\tfor(auto v: val[y]) {\n\n\t\tval[x].push_back(v);\n\n\t}\n\n\tval[y].clear();\n\n\tfa[y] = x;\n\n}\n\n\n\nvoid input()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\n\n\t\tval[i].push_back(a[i]);\n\n\t\tfa[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++) {\n\n\t\tint x, y;\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++, y++;\n\n\t\tmerge(x, y);\n\n\t}\n\n}\n\n\n\nvoid solve()\n\n{\n\n\tlong long ans = 0;\n\n\n\n\tint cnt = (n - 1 - m) * 2;\n\n\n\n\tif(cnt == 0) {\n\n\t\tputs(\"0\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tvector<int> vec;\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tif(fa[i] == i) {\n\n\t\t\tsort(val[i].begin(), val[i].end());\n\n\t\t\tans += val[i][0];\n\n\t\t\tcnt--;\n\n\t\t\tfor(int j = 1; j < SZ(val[i]); j++) {\n\n\t\t\t\tvec.push_back(val[i][j]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tif(SZ(vec) < cnt) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tsort(vec.begin(), vec.end());\n\n\tfor(int i = 0; i < cnt; i++) {\n\n\t\tans += vec[i];\n\n\t}\n\n\tcout << ans << endl;\n\n}\n\n\n\nint main()\n\n{\n\n\tinput();\n\n\tsolve();\n\n\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],mn[MN],res;\n\nint num[MN],h[MN];\n\nint n,m,x,y,cnt,tot,ct;\n\nbool vis[MN],tmp[MN];\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "123",
        "source_code": "#include<cstdio>\n\n#include<cctype>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<vector>\n\nusing std::vector;\n\n#define max(a,b) (a>b?a:b)\n\n#define min(a,b) (a<b?a:b)\n\n#define reg register\n\ntypedef long long ll;\n\ninline int read(){\n\n    reg int x=0,f=1;reg char ch=getchar();\n\n    for(;!isdigit(ch);f=ch=='-'?-1:1,ch=getchar());\n\n    for(;isdigit(ch);x=x*10+(ch^48),ch=getchar());\n\n    return x*f;\n\n}\n\nconst int MN=1e5+5;\n\nint n,m;\n\nclass UFset{\n\n\tpublic:\n\n\t\tint par[MN];\n\n\t\tinline int find(int x){return x==par[x]?x:par[x]=find(par[x]);}\n\n\t\tinline void init(int x){for(reg int i=0;i<x;i++)par[i]=i;}\n\n\t\tinline void unite(int x,int y){x=find(x);y=find(y);par[y]=x;}\n\n\t\tinline bool isfa(int x){return find(x)==x;}\n\n}S;\n\nint v[MN],cnt,id[MN],a[MN];\n\nvector<int>pts[MN];\n\nint main(){\n\n\tn=read();m=read();S.init(n);if(n==m+1)return 0*puts(\"0\");\n\n\tfor(reg int i=0;i<n;i++)v[i]=read();\n\n\tfor(reg int i=1;i<=m;i++)S.unite(read(),read());\n\n\tfor(reg int i=0;i<n;i++)if(S.isfa(i))id[i]=++cnt,pts[cnt].push_back(v[i]);\n\n\tfor(reg int i=0;i<n;i++)if(!S.isfa(i))pts[id[S.find(i)]].push_back(v[i]);\n\n\tif(n<((cnt-1)<<1))return 0*puts(\"Impossible\");\n\n\tfor(reg int i=1;i<=cnt;i++)std::sort(pts[i].begin(),pts[i].end());\n\n\treg ll ans=0;reg int tot=0;\n\n\tfor(reg int i=1;i<=cnt;i++)ans+=pts[i][0];\n\n\tfor(reg int i=1;i<=cnt;i++)for(reg int j=1;j<pts[i].size();j++)a[++tot]=pts[i][j];\n\n\tstd::sort(a+1,a+1+tot);\n\n\tfor(reg int i=1;i<=cnt-2;i++)ans+=a[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],mn[MN],res;\n\nint num[MN],h[MN];\n\nint n,m,x,y,cnt,tot,ct;\n\nbool vis[MN],tmp[MN];\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "124",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\n#define rep(i,a,b) for (int i=(a); i<=(b); i++)\n\n#define per(i,a,b) for (int i=(a); i>=(b); i--)\n\nusing namespace std;\n\n\n\nconst int maxn = 100005;\n\nint a[maxn], vis[maxn], n, m, x, y, mn, cur;\n\npriority_queue<int, vector<int>, greater<int> > Q;\n\nvector<int> e[maxn];\n\nlong long ans;\n\n\n\nvoid dfs(int u) {\n\n\tint sz = e[u].size();\n\n\tif (a[u] < mn) mn = a[u], cur = u;\n\n\tvis[u] = 1;\n\n\tif (!sz) return;\n\n\trep (i, 0, sz - 1)\n\n\t\tif (!vis[e[u][i]]) dfs(e[u][i]);\n\n}\n\n\n\nint main() {\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tif (n < 2 * (n - m - 1)) \n\n\t\treturn puts(\"Impossible\"), 0;\n\n\tif (n - 1 == m)\n\n\t\treturn puts(\"0\"), 0;\n\n\trep (i, 1, n) scanf(\"%d\", &a[i]);\n\n\trep (i, 1, m) {\n\n\t\tscanf(\"%d%d\", &x, &y); x++; y++;\n\n\t\te[x].push_back(y); e[y].push_back(x);\n\n\t}\n\n\trep (i, 1, n)\n\n\t\tif (!vis[i]) {\n\n\t\t\tmn = 2e9;\n\n\t\t\tdfs(i);\n\n\t\t\tans += mn;\n\n\t\t\ta[cur] = 0;\n\n\t\t}\n\n\trep (i, 1, n)\n\n\t\tif (a[i]) Q.push(a[i]);\n\n\tm = 2 * (n - m - 1) - (n - m);\n\n\twhile (m-- > 0) {\n\n\t\tans += Q.top();\n\n\t\tQ.pop();\n\n\t}\n\n\tcout << ans << endl;\n\n\treturn 0;\n\n}"
    },
    {
        "id": "125",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n\n//",
        "optimized_code": "#include<bits/stdc++.h>\n\n#define rep(i,a,b) for (int i=(a); i<=(b); i++)\n\n#define per(i,a,b) for (int i=(a); i>=(b); i--)\n\nusing namespace std;\n\n\n\nconst int maxn = 100005;\n\nint a[maxn], vis[maxn], n, m, x, y, mn, cur;\n\npriority_queue<int, vector<int>, greater<int> > Q;\n\nvector<int> e[maxn];\n\nlong long ans;\n\n\n\nvoid dfs(int u) {\n\n\tint sz = e[u].size();\n\n\tif (a[u] < mn) mn = a[u], cur = u;\n\n\tvis[u] = 1;\n\n\tif (!sz) return;\n\n\trep (i, 0, sz - 1)\n\n\t\tif (!vis[e[u][i]]) dfs(e[u][i]);\n\n}\n\n\n\nint main() {\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tif (n < 2 * (n - m - 1)) \n\n\t\treturn puts(\"Impossible\"), 0;\n\n\tif (n - 1 == m)\n\n\t\treturn puts(\"0\"), 0;\n\n\trep (i, 1, n) scanf(\"%d\", &a[i]);\n\n\trep (i, 1, m) {\n\n\t\tscanf(\"%d%d\", &x, &y); x++; y++;\n\n\t\te[x].push_back(y); e[y].push_back(x);\n\n\t}\n\n\trep (i, 1, n)\n\n\t\tif (!vis[i]) {\n\n\t\t\tmn = 2e9;\n\n\t\t\tdfs(i);\n\n\t\t\tans += mn;\n\n\t\t\ta[cur] = 0;\n\n\t\t}\n\n\trep (i, 1, n)\n\n\t\tif (a[i]) Q.push(a[i]);\n\n\tm = 2 * (n - m - 1) - (n - m);\n\n\twhile (m-- > 0) {\n\n\t\tans += Q.top();\n\n\t\tQ.pop();\n\n\t}\n\n\tcout << ans << endl;\n\n\treturn 0;\n\n}"
    },
    {
        "id": "126",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\nusing namespace std;\n\n#define llg long long\n\n#define maxn 200010\n\n#define yyj(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout);\n\n\n\ninline llg getint()\n\n{\n\n    llg w=0,q=0; char c=getchar();\n\n    while((c<'0' || c>'9') && c!='-') c=getchar();\n\n    if (c=='-')  q=1, c=getchar(); while (c>='0' && c<='9') w=w*10+c-'0', c=getchar();\n\n    return q ? -w : w;\n\n}\n\n\n\nstruct node{llg val,fa;} a[maxn];\n\n\n\nbool cmp(const node &a,const node&b){return a.val<b.val;}\n\n\n\nllg n,m,fa[maxn],ans,c[maxn],needb,xian[maxn],chuxian[maxn],bj[maxn];\n\n\n\nllg find(llg x) {if (fa[x]!=x) fa[x]=find(fa[x]); return fa[x];}\n\n\n\nint main()\n\n{\n\n\tcin>>n>>m;\n\n\tfor (llg i=1;i<=n;i++) c[i]=getint(),fa[i]=i;\n\n\tfor (llg i=1;i<=m;i++)\n\n\t{\n\n\t\tllg x=getint(),y=getint();\n\n\t\tx++,y++;\n\n\t\tif (find(x)!=find(y)) fa[find(x)]=find(y);\n\n\t}\n\n\tfor (llg i=1;i<=n;i++) a[i].val=c[i],a[i].fa=find(i);\n\n\tsort(a+1,a+n+1,cmp);\n\n\tneedb=n-1-m;\n\n\tllg cs=0;\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t\tif (!chuxian[a[i].fa])\n\n\t\t{\n\n\t\t\tcs++;\n\n\t\t\tbj[i]=1;\n\n\t\t\tchuxian[a[i].fa]=1;\n\n\t\t\tans+=a[i].val;\n\n\t\t}\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t{\n\n\t\tif (xian[a[i].fa]<needb && !bj[i])\n\n\t\t{\n\n\t\t\txian[a[i].fa]++;\n\n\t\t\tans+=a[i].val;\n\n\t\t\tcs++;\n\n\t\t}\n\n\t}\n\n\tif (cs<needb*2) puts(\"Impossible\"); else \n\n\tcout<<ans;\n\n\treturn 0;\n\n} \n"
    },
    {
        "id": "127",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n    }\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\nusing namespace std;\n\n#define llg long long\n\n#define maxn 200010\n\n#define yyj(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout);\n\n\n\ninline llg getint()\n\n{\n\n    llg w=0,q=0; char c=getchar();\n\n    while((c<'0' || c>'9') && c!='-') c=getchar();\n\n    if (c=='-')  q=1, c=getchar(); while (c>='0' && c<='9') w=w*10+c-'0', c=getchar();\n\n    return q ? -w : w;\n\n}\n\n\n\nstruct node{llg val,fa;} a[maxn];\n\n\n\nbool cmp(const node &a,const node&b){return a.val<b.val;}\n\n\n\nllg n,m,fa[maxn],ans,c[maxn],needb,xian[maxn],chuxian[maxn],bj[maxn];\n\n\n\nllg find(llg x) {if (fa[x]!=x) fa[x]=find(fa[x]); return fa[x];}\n\n\n\nint main()\n\n{\n\n\tcin>>n>>m;\n\n\tfor (llg i=1;i<=n;i++) c[i]=getint(),fa[i]=i;\n\n\tfor (llg i=1;i<=m;i++)\n\n\t{\n\n\t\tllg x=getint(),y=getint();\n\n\t\tx++,y++;\n\n\t\tif (find(x)!=find(y)) fa[find(x)]=find(y);\n\n\t}\n\n\tfor (llg i=1;i<=n;i++) a[i].val=c[i],a[i].fa=find(i);\n\n\tsort(a+1,a+n+1,cmp);\n\n\tneedb=n-1-m;\n\n\tllg cs=0;\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t\tif (!chuxian[a[i].fa])\n\n\t\t{\n\n\t\t\tcs++;\n\n\t\t\tbj[i]=1;\n\n\t\t\tchuxian[a[i].fa]=1;\n\n\t\t\tans+=a[i].val;\n\n\t\t}\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t{\n\n\t\tif (xian[a[i].fa]<needb && !bj[i])\n\n\t\t{\n\n\t\t\txian[a[i].fa]++;\n\n\t\t\tans+=a[i].val;\n\n\t\t\tcs++;\n\n\t\t}\n\n\t}\n\n\tif (cs<needb*2) puts(\"Impossible\"); else \n\n\tcout<<ans;\n\n\treturn 0;\n\n} \n"
    },
    {
        "id": "128",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n\n//",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\nusing namespace std;\n\n#define llg long long\n\n#define maxn 200010\n\n#define yyj(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout);\n\n\n\ninline llg getint()\n\n{\n\n    llg w=0,q=0; char c=getchar();\n\n    while((c<'0' || c>'9') && c!='-') c=getchar();\n\n    if (c=='-')  q=1, c=getchar(); while (c>='0' && c<='9') w=w*10+c-'0', c=getchar();\n\n    return q ? -w : w;\n\n}\n\n\n\nstruct node{llg val,fa;} a[maxn];\n\n\n\nbool cmp(const node &a,const node&b){return a.val<b.val;}\n\n\n\nllg n,m,fa[maxn],ans,c[maxn],needb,xian[maxn],chuxian[maxn],bj[maxn];\n\n\n\nllg find(llg x) {if (fa[x]!=x) fa[x]=find(fa[x]); return fa[x];}\n\n\n\nint main()\n\n{\n\n\tcin>>n>>m;\n\n\tfor (llg i=1;i<=n;i++) c[i]=getint(),fa[i]=i;\n\n\tfor (llg i=1;i<=m;i++)\n\n\t{\n\n\t\tllg x=getint(),y=getint();\n\n\t\tx++,y++;\n\n\t\tif (find(x)!=find(y)) fa[find(x)]=find(y);\n\n\t}\n\n\tfor (llg i=1;i<=n;i++) a[i].val=c[i],a[i].fa=find(i);\n\n\tsort(a+1,a+n+1,cmp);\n\n\tneedb=n-1-m;\n\n\tllg cs=0;\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t\tif (!chuxian[a[i].fa])\n\n\t\t{\n\n\t\t\tcs++;\n\n\t\t\tbj[i]=1;\n\n\t\t\tchuxian[a[i].fa]=1;\n\n\t\t\tans+=a[i].val;\n\n\t\t}\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t{\n\n\t\tif (xian[a[i].fa]<needb && !bj[i])\n\n\t\t{\n\n\t\t\txian[a[i].fa]++;\n\n\t\t\tans+=a[i].val;\n\n\t\t\tcs++;\n\n\t\t}\n\n\t}\n\n\tif (cs<needb*2) puts(\"Impossible\"); else \n\n\tcout<<ans;\n\n\treturn 0;\n\n} \n"
    },
    {
        "id": "129",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define SZ(x) ((int)x.size())\n\n\n\nconst int N = 100005;\n\n\n\nint n, m;\n\nint a[N];\n\nint fa[N];\n\n\n\nvector<int> val[N];\n\n\n\nint getfa(int x) {\n\n\treturn fa[x] == x ? x : fa[x] = getfa(fa[x]);\n\n}\n\n\n\nvoid merge(int x, int y) {\n\n\tx = getfa(x);\n\n\ty = getfa(y);\n\n\tif(SZ(val[x]) < SZ(val[y])) {\n\n\t\tswap(x, y);\n\n\t}\n\n\tfor(auto v: val[y]) {\n\n\t\tval[x].push_back(v);\n\n\t}\n\n\tval[y].clear();\n\n\tfa[y] = x;\n\n}\n\n\n\nvoid input()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\n\n\t\tval[i].push_back(a[i]);\n\n\t\tfa[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++) {\n\n\t\tint x, y;\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++, y++;\n\n\t\tmerge(x, y);\n\n\t}\n\n}\n\n\n\nvoid solve()\n\n{\n\n\tlong long ans = 0;\n\n\n\n\tint cnt = (n - 1 - m) * 2;\n\n\n\n\tif(cnt == 0) {\n\n\t\tputs(\"0\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tvector<int> vec;\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tif(fa[i] == i) {\n\n\t\t\tsort(val[i].begin(), val[i].end());\n\n\t\t\tans += val[i][0];\n\n\t\t\tcnt--;\n\n\t\t\tfor(int j = 1; j < SZ(val[i]); j++) {\n\n\t\t\t\tvec.push_back(val[i][j]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tif(SZ(vec) < cnt) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tsort(vec.begin(), vec.end());\n\n\tfor(int i = 0; i < cnt; i++) {\n\n\t\tans += vec[i];\n\n\t}\n\n\tcout << ans << endl;\n\n}\n\n\n\nint main()\n\n{\n\n\tinput();\n\n\tsolve();\n\n\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\nusing namespace std;\n\n#define llg long long\n\n#define maxn 200010\n\n#define yyj(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout);\n\n\n\ninline llg getint()\n\n{\n\n    llg w=0,q=0; char c=getchar();\n\n    while((c<'0' || c>'9') && c!='-') c=getchar();\n\n    if (c=='-')  q=1, c=getchar(); while (c>='0' && c<='9') w=w*10+c-'0', c=getchar();\n\n    return q ? -w : w;\n\n}\n\n\n\nstruct node{llg val,fa;} a[maxn];\n\n\n\nbool cmp(const node &a,const node&b){return a.val<b.val;}\n\n\n\nllg n,m,fa[maxn],ans,c[maxn],needb,xian[maxn],chuxian[maxn],bj[maxn];\n\n\n\nllg find(llg x) {if (fa[x]!=x) fa[x]=find(fa[x]); return fa[x];}\n\n\n\nint main()\n\n{\n\n\tcin>>n>>m;\n\n\tfor (llg i=1;i<=n;i++) c[i]=getint(),fa[i]=i;\n\n\tfor (llg i=1;i<=m;i++)\n\n\t{\n\n\t\tllg x=getint(),y=getint();\n\n\t\tx++,y++;\n\n\t\tif (find(x)!=find(y)) fa[find(x)]=find(y);\n\n\t}\n\n\tfor (llg i=1;i<=n;i++) a[i].val=c[i],a[i].fa=find(i);\n\n\tsort(a+1,a+n+1,cmp);\n\n\tneedb=n-1-m;\n\n\tllg cs=0;\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t\tif (!chuxian[a[i].fa])\n\n\t\t{\n\n\t\t\tcs++;\n\n\t\t\tbj[i]=1;\n\n\t\t\tchuxian[a[i].fa]=1;\n\n\t\t\tans+=a[i].val;\n\n\t\t}\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t{\n\n\t\tif (xian[a[i].fa]<needb && !bj[i])\n\n\t\t{\n\n\t\t\txian[a[i].fa]++;\n\n\t\t\tans+=a[i].val;\n\n\t\t\tcs++;\n\n\t\t}\n\n\t}\n\n\tif (cs<needb*2) puts(\"Impossible\"); else \n\n\tcout<<ans;\n\n\treturn 0;\n\n} \n"
    },
    {
        "id": "130",
        "source_code": "#include<cstdio>\n\n#include<cctype>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<vector>\n\nusing std::vector;\n\n#define max(a,b) (a>b?a:b)\n\n#define min(a,b) (a<b?a:b)\n\n#define reg register\n\ntypedef long long ll;\n\ninline int read(){\n\n    reg int x=0,f=1;reg char ch=getchar();\n\n    for(;!isdigit(ch);f=ch=='-'?-1:1,ch=getchar());\n\n    for(;isdigit(ch);x=x*10+(ch^48),ch=getchar());\n\n    return x*f;\n\n}\n\nconst int MN=1e5+5;\n\nint n,m;\n\nclass UFset{\n\n\tpublic:\n\n\t\tint par[MN];\n\n\t\tinline int find(int x){return x==par[x]?x:par[x]=find(par[x]);}\n\n\t\tinline void init(int x){for(reg int i=0;i<x;i++)par[i]=i;}\n\n\t\tinline void unite(int x,int y){x=find(x);y=find(y);par[y]=x;}\n\n\t\tinline bool isfa(int x){return find(x)==x;}\n\n}S;\n\nint v[MN],cnt,id[MN],a[MN];\n\nvector<int>pts[MN];\n\nint main(){\n\n\tn=read();m=read();S.init(n);if(n==m+1)return 0*puts(\"0\");\n\n\tfor(reg int i=0;i<n;i++)v[i]=read();\n\n\tfor(reg int i=1;i<=m;i++)S.unite(read(),read());\n\n\tfor(reg int i=0;i<n;i++)if(S.isfa(i))id[i]=++cnt,pts[cnt].push_back(v[i]);\n\n\tfor(reg int i=0;i<n;i++)if(!S.isfa(i))pts[id[S.find(i)]].push_back(v[i]);\n\n\tif(n<((cnt-1)<<1))return 0*puts(\"Impossible\");\n\n\tfor(reg int i=1;i<=cnt;i++)std::sort(pts[i].begin(),pts[i].end());\n\n\treg ll ans=0;reg int tot=0;\n\n\tfor(reg int i=1;i<=cnt;i++)ans+=pts[i][0];\n\n\tfor(reg int i=1;i<=cnt;i++)for(reg int j=1;j<pts[i].size();j++)a[++tot]=pts[i][j];\n\n\tstd::sort(a+1,a+1+tot);\n\n\tfor(reg int i=1;i<=cnt-2;i++)ans+=a[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n    return 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\nusing namespace std;\n\n#define llg long long\n\n#define maxn 200010\n\n#define yyj(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout);\n\n\n\ninline llg getint()\n\n{\n\n    llg w=0,q=0; char c=getchar();\n\n    while((c<'0' || c>'9') && c!='-') c=getchar();\n\n    if (c=='-')  q=1, c=getchar(); while (c>='0' && c<='9') w=w*10+c-'0', c=getchar();\n\n    return q ? -w : w;\n\n}\n\n\n\nstruct node{llg val,fa;} a[maxn];\n\n\n\nbool cmp(const node &a,const node&b){return a.val<b.val;}\n\n\n\nllg n,m,fa[maxn],ans,c[maxn],needb,xian[maxn],chuxian[maxn],bj[maxn];\n\n\n\nllg find(llg x) {if (fa[x]!=x) fa[x]=find(fa[x]); return fa[x];}\n\n\n\nint main()\n\n{\n\n\tcin>>n>>m;\n\n\tfor (llg i=1;i<=n;i++) c[i]=getint(),fa[i]=i;\n\n\tfor (llg i=1;i<=m;i++)\n\n\t{\n\n\t\tllg x=getint(),y=getint();\n\n\t\tx++,y++;\n\n\t\tif (find(x)!=find(y)) fa[find(x)]=find(y);\n\n\t}\n\n\tfor (llg i=1;i<=n;i++) a[i].val=c[i],a[i].fa=find(i);\n\n\tsort(a+1,a+n+1,cmp);\n\n\tneedb=n-1-m;\n\n\tllg cs=0;\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t\tif (!chuxian[a[i].fa])\n\n\t\t{\n\n\t\t\tcs++;\n\n\t\t\tbj[i]=1;\n\n\t\t\tchuxian[a[i].fa]=1;\n\n\t\t\tans+=a[i].val;\n\n\t\t}\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t{\n\n\t\tif (xian[a[i].fa]<needb && !bj[i])\n\n\t\t{\n\n\t\t\txian[a[i].fa]++;\n\n\t\t\tans+=a[i].val;\n\n\t\t\tcs++;\n\n\t\t}\n\n\t}\n\n\tif (cs<needb*2) puts(\"Impossible\"); else \n\n\tcout<<ans;\n\n\treturn 0;\n\n} \n"
    },
    {
        "id": "131",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define mp(x,y) make_pair(x,y) \n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\ntypedef pair<ll,int> pr;\n\n//priority_queue<pr,vector<pr>,greater<pr> >q;\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],res;\n\nint d[MN],fa[MN],rk[MN],num[MN],h[MN],ch[2][MN];\n\nint n,m,x,y,cnt,tot,fx,fy,rt,ct;\n\nbool vis[MN];\n\nll mn[MN];bool tmp[MN];\n\ninline int gf(int x){return fa[x]?fa[x]=gf(fa[x]):x;}\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\ninline int merge(int x,int y){\n\n    if (!x) return y;if (!y) return x;\n\n    if (a[x]>a[y]||(a[x]==a[y]&&x>y)) swap(x,y);\n\n    ch[1][x]=merge(ch[1][x],y);fa[ch[1][x]]=x;\n\n    if (d[ch[0][x]]<d[ch[1][x]]) swap(ch[0][x],ch[1][x]);\n\n    d[x]=d[ch[1][x]]+1;return x;\n\n}\n\ninline int pop(int x){\n\n    a[x]=-1;fa[x]=-1;fa[ch[0][x]]=fa[ch[1][x]]=0;\n\n    return merge(ch[0][x],ch[1][x]);\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);\n\n\t\trk[tot]=i;dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\t/*\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (rk[num[i]]==i) continue;\n\n\t\tfx=gf(i),fy=gf(rk[num[i]]);merge(fx,fy);\n\n\t}\n\n\tfor (int i=1;i<=tot;++i){\n\n\t\tfx=gf(rk[i]);q.push(mp(a[fx],fx));\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tpr x=q.top();q.pop();\n\n\t\tif (q.empty()) break;pr y=q.top();q.pop();\n\n\t\tres+=1ll*x.first+y.first;++ct;\n\n\t\tfx=gf(x.second),fy=gf(y.second);printf(\"%d %d\\n\",fx,fy);\n\n\t\tfx=pop(fx);fy=pop(fy);rt=merge(fx,fy);\n\n\t\tif (rt) q.push(mp(a[rt],rt));\n\n\t}*/\n\n//\tif (ct+m!=n-1) printf(\"Impossible\");\n\n//\telse \n\n//\tprintf(\"%lld\",res);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\nusing namespace std;\n\n#define llg long long\n\n#define maxn 200010\n\n#define yyj(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout);\n\n\n\ninline llg getint()\n\n{\n\n    llg w=0,q=0; char c=getchar();\n\n    while((c<'0' || c>'9') && c!='-') c=getchar();\n\n    if (c=='-')  q=1, c=getchar(); while (c>='0' && c<='9') w=w*10+c-'0', c=getchar();\n\n    return q ? -w : w;\n\n}\n\n\n\nstruct node{llg val,fa;} a[maxn];\n\n\n\nbool cmp(const node &a,const node&b){return a.val<b.val;}\n\n\n\nllg n,m,fa[maxn],ans,c[maxn],needb,xian[maxn],chuxian[maxn],bj[maxn];\n\n\n\nllg find(llg x) {if (fa[x]!=x) fa[x]=find(fa[x]); return fa[x];}\n\n\n\nint main()\n\n{\n\n\tcin>>n>>m;\n\n\tfor (llg i=1;i<=n;i++) c[i]=getint(),fa[i]=i;\n\n\tfor (llg i=1;i<=m;i++)\n\n\t{\n\n\t\tllg x=getint(),y=getint();\n\n\t\tx++,y++;\n\n\t\tif (find(x)!=find(y)) fa[find(x)]=find(y);\n\n\t}\n\n\tfor (llg i=1;i<=n;i++) a[i].val=c[i],a[i].fa=find(i);\n\n\tsort(a+1,a+n+1,cmp);\n\n\tneedb=n-1-m;\n\n\tllg cs=0;\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t\tif (!chuxian[a[i].fa])\n\n\t\t{\n\n\t\t\tcs++;\n\n\t\t\tbj[i]=1;\n\n\t\t\tchuxian[a[i].fa]=1;\n\n\t\t\tans+=a[i].val;\n\n\t\t}\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t{\n\n\t\tif (xian[a[i].fa]<needb && !bj[i])\n\n\t\t{\n\n\t\t\txian[a[i].fa]++;\n\n\t\t\tans+=a[i].val;\n\n\t\t\tcs++;\n\n\t\t}\n\n\t}\n\n\tif (cs<needb*2) puts(\"Impossible\"); else \n\n\tcout<<ans;\n\n\treturn 0;\n\n} \n"
    },
    {
        "id": "132",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],mn[MN],res;\n\nint num[MN],h[MN];\n\nint n,m,x,y,cnt,tot,ct;\n\nbool vis[MN],tmp[MN];\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\nusing namespace std;\n\n#define llg long long\n\n#define maxn 200010\n\n#define yyj(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout);\n\n\n\ninline llg getint()\n\n{\n\n    llg w=0,q=0; char c=getchar();\n\n    while((c<'0' || c>'9') && c!='-') c=getchar();\n\n    if (c=='-')  q=1, c=getchar(); while (c>='0' && c<='9') w=w*10+c-'0', c=getchar();\n\n    return q ? -w : w;\n\n}\n\n\n\nstruct node{llg val,fa;} a[maxn];\n\n\n\nbool cmp(const node &a,const node&b){return a.val<b.val;}\n\n\n\nllg n,m,fa[maxn],ans,c[maxn],needb,xian[maxn],chuxian[maxn],bj[maxn];\n\n\n\nllg find(llg x) {if (fa[x]!=x) fa[x]=find(fa[x]); return fa[x];}\n\n\n\nint main()\n\n{\n\n\tcin>>n>>m;\n\n\tfor (llg i=1;i<=n;i++) c[i]=getint(),fa[i]=i;\n\n\tfor (llg i=1;i<=m;i++)\n\n\t{\n\n\t\tllg x=getint(),y=getint();\n\n\t\tx++,y++;\n\n\t\tif (find(x)!=find(y)) fa[find(x)]=find(y);\n\n\t}\n\n\tfor (llg i=1;i<=n;i++) a[i].val=c[i],a[i].fa=find(i);\n\n\tsort(a+1,a+n+1,cmp);\n\n\tneedb=n-1-m;\n\n\tllg cs=0;\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t\tif (!chuxian[a[i].fa])\n\n\t\t{\n\n\t\t\tcs++;\n\n\t\t\tbj[i]=1;\n\n\t\t\tchuxian[a[i].fa]=1;\n\n\t\t\tans+=a[i].val;\n\n\t\t}\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t{\n\n\t\tif (xian[a[i].fa]<needb && !bj[i])\n\n\t\t{\n\n\t\t\txian[a[i].fa]++;\n\n\t\t\tans+=a[i].val;\n\n\t\t\tcs++;\n\n\t\t}\n\n\t}\n\n\tif (cs<needb*2) puts(\"Impossible\"); else \n\n\tcout<<ans;\n\n\treturn 0;\n\n} \n"
    },
    {
        "id": "133",
        "source_code": "#include<bits/stdc++.h>\n\n#define rep(i,a,b) for (int i=(a); i<=(b); i++)\n\n#define per(i,a,b) for (int i=(a); i>=(b); i--)\n\nusing namespace std;\n\n\n\nconst int maxn = 100005;\n\nint a[maxn], vis[maxn], n, m, x, y, mn, cur;\n\npriority_queue<int, vector<int>, greater<int> > Q;\n\nvector<int> e[maxn];\n\nlong long ans;\n\n\n\nvoid dfs(int u) {\n\n\tint sz = e[u].size();\n\n\tif (a[u] < mn) mn = a[u], cur = u;\n\n\tvis[u] = 1;\n\n\tif (!sz) return;\n\n\trep (i, 0, sz - 1)\n\n\t\tif (!vis[e[u][i]]) dfs(e[u][i]);\n\n}\n\n\n\nint main() {\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tif (n < 2 * (n - m - 1)) \n\n\t\treturn puts(\"Impossible\"), 0;\n\n\tif (n - 1 == m)\n\n\t\treturn puts(\"0\"), 0;\n\n\trep (i, 1, n) scanf(\"%d\", &a[i]);\n\n\trep (i, 1, m) {\n\n\t\tscanf(\"%d%d\", &x, &y); x++; y++;\n\n\t\te[x].push_back(y); e[y].push_back(x);\n\n\t}\n\n\trep (i, 1, n)\n\n\t\tif (!vis[i]) {\n\n\t\t\tmn = 2e9;\n\n\t\t\tdfs(i);\n\n\t\t\tans += mn;\n\n\t\t\ta[cur] = 0;\n\n\t\t}\n\n\trep (i, 1, n)\n\n\t\tif (a[i]) Q.push(a[i]);\n\n\tm = 2 * (n - m - 1) - (n - m);\n\n\twhile (m-- > 0) {\n\n\t\tans += Q.top();\n\n\t\tQ.pop();\n\n\t}\n\n\tcout << ans << endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\nusing namespace std;\n\n#define llg long long\n\n#define maxn 200010\n\n#define yyj(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout);\n\n\n\ninline llg getint()\n\n{\n\n    llg w=0,q=0; char c=getchar();\n\n    while((c<'0' || c>'9') && c!='-') c=getchar();\n\n    if (c=='-')  q=1, c=getchar(); while (c>='0' && c<='9') w=w*10+c-'0', c=getchar();\n\n    return q ? -w : w;\n\n}\n\n\n\nstruct node{llg val,fa;} a[maxn];\n\n\n\nbool cmp(const node &a,const node&b){return a.val<b.val;}\n\n\n\nllg n,m,fa[maxn],ans,c[maxn],needb,xian[maxn],chuxian[maxn],bj[maxn];\n\n\n\nllg find(llg x) {if (fa[x]!=x) fa[x]=find(fa[x]); return fa[x];}\n\n\n\nint main()\n\n{\n\n\tcin>>n>>m;\n\n\tfor (llg i=1;i<=n;i++) c[i]=getint(),fa[i]=i;\n\n\tfor (llg i=1;i<=m;i++)\n\n\t{\n\n\t\tllg x=getint(),y=getint();\n\n\t\tx++,y++;\n\n\t\tif (find(x)!=find(y)) fa[find(x)]=find(y);\n\n\t}\n\n\tfor (llg i=1;i<=n;i++) a[i].val=c[i],a[i].fa=find(i);\n\n\tsort(a+1,a+n+1,cmp);\n\n\tneedb=n-1-m;\n\n\tllg cs=0;\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t\tif (!chuxian[a[i].fa])\n\n\t\t{\n\n\t\t\tcs++;\n\n\t\t\tbj[i]=1;\n\n\t\t\tchuxian[a[i].fa]=1;\n\n\t\t\tans+=a[i].val;\n\n\t\t}\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t{\n\n\t\tif (xian[a[i].fa]<needb && !bj[i])\n\n\t\t{\n\n\t\t\txian[a[i].fa]++;\n\n\t\t\tans+=a[i].val;\n\n\t\t\tcs++;\n\n\t\t}\n\n\t}\n\n\tif (cs<needb*2) puts(\"Impossible\"); else \n\n\tcout<<ans;\n\n\treturn 0;\n\n} \n"
    },
    {
        "id": "134",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100005;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n//    multiset<int>::iterator it;\n\n//    for(it = s.begin(); it != s.end(); it++)\n\n//    {\n\n//        printf(\"%d \", *it);\n\n//    }\n\n//    printf(\"\\n\");\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n//        printf(\"%d %d %d\\n\", i, Find(i), mi[fa[i]]);\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            multiset<int>::iterator it = s.find(mi[fa[i]]);\n\n            s.erase(it);\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "135",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n    }\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100005;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n//    multiset<int>::iterator it;\n\n//    for(it = s.begin(); it != s.end(); it++)\n\n//    {\n\n//        printf(\"%d \", *it);\n\n//    }\n\n//    printf(\"\\n\");\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n//        printf(\"%d %d %d\\n\", i, Find(i), mi[fa[i]]);\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            multiset<int>::iterator it = s.find(mi[fa[i]]);\n\n            s.erase(it);\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "136",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n\n//",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100005;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n//    multiset<int>::iterator it;\n\n//    for(it = s.begin(); it != s.end(); it++)\n\n//    {\n\n//        printf(\"%d \", *it);\n\n//    }\n\n//    printf(\"\\n\");\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n//        printf(\"%d %d %d\\n\", i, Find(i), mi[fa[i]]);\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            multiset<int>::iterator it = s.find(mi[fa[i]]);\n\n            s.erase(it);\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "137",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define SZ(x) ((int)x.size())\n\n\n\nconst int N = 100005;\n\n\n\nint n, m;\n\nint a[N];\n\nint fa[N];\n\n\n\nvector<int> val[N];\n\n\n\nint getfa(int x) {\n\n\treturn fa[x] == x ? x : fa[x] = getfa(fa[x]);\n\n}\n\n\n\nvoid merge(int x, int y) {\n\n\tx = getfa(x);\n\n\ty = getfa(y);\n\n\tif(SZ(val[x]) < SZ(val[y])) {\n\n\t\tswap(x, y);\n\n\t}\n\n\tfor(auto v: val[y]) {\n\n\t\tval[x].push_back(v);\n\n\t}\n\n\tval[y].clear();\n\n\tfa[y] = x;\n\n}\n\n\n\nvoid input()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\n\n\t\tval[i].push_back(a[i]);\n\n\t\tfa[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++) {\n\n\t\tint x, y;\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++, y++;\n\n\t\tmerge(x, y);\n\n\t}\n\n}\n\n\n\nvoid solve()\n\n{\n\n\tlong long ans = 0;\n\n\n\n\tint cnt = (n - 1 - m) * 2;\n\n\n\n\tif(cnt == 0) {\n\n\t\tputs(\"0\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tvector<int> vec;\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tif(fa[i] == i) {\n\n\t\t\tsort(val[i].begin(), val[i].end());\n\n\t\t\tans += val[i][0];\n\n\t\t\tcnt--;\n\n\t\t\tfor(int j = 1; j < SZ(val[i]); j++) {\n\n\t\t\t\tvec.push_back(val[i][j]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tif(SZ(vec) < cnt) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tsort(vec.begin(), vec.end());\n\n\tfor(int i = 0; i < cnt; i++) {\n\n\t\tans += vec[i];\n\n\t}\n\n\tcout << ans << endl;\n\n}\n\n\n\nint main()\n\n{\n\n\tinput();\n\n\tsolve();\n\n\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100005;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n//    multiset<int>::iterator it;\n\n//    for(it = s.begin(); it != s.end(); it++)\n\n//    {\n\n//        printf(\"%d \", *it);\n\n//    }\n\n//    printf(\"\\n\");\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n//        printf(\"%d %d %d\\n\", i, Find(i), mi[fa[i]]);\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            multiset<int>::iterator it = s.find(mi[fa[i]]);\n\n            s.erase(it);\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "138",
        "source_code": "#include<cstdio>\n\n#include<cctype>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<vector>\n\nusing std::vector;\n\n#define max(a,b) (a>b?a:b)\n\n#define min(a,b) (a<b?a:b)\n\n#define reg register\n\ntypedef long long ll;\n\ninline int read(){\n\n    reg int x=0,f=1;reg char ch=getchar();\n\n    for(;!isdigit(ch);f=ch=='-'?-1:1,ch=getchar());\n\n    for(;isdigit(ch);x=x*10+(ch^48),ch=getchar());\n\n    return x*f;\n\n}\n\nconst int MN=1e5+5;\n\nint n,m;\n\nclass UFset{\n\n\tpublic:\n\n\t\tint par[MN];\n\n\t\tinline int find(int x){return x==par[x]?x:par[x]=find(par[x]);}\n\n\t\tinline void init(int x){for(reg int i=0;i<x;i++)par[i]=i;}\n\n\t\tinline void unite(int x,int y){x=find(x);y=find(y);par[y]=x;}\n\n\t\tinline bool isfa(int x){return find(x)==x;}\n\n}S;\n\nint v[MN],cnt,id[MN],a[MN];\n\nvector<int>pts[MN];\n\nint main(){\n\n\tn=read();m=read();S.init(n);if(n==m+1)return 0*puts(\"0\");\n\n\tfor(reg int i=0;i<n;i++)v[i]=read();\n\n\tfor(reg int i=1;i<=m;i++)S.unite(read(),read());\n\n\tfor(reg int i=0;i<n;i++)if(S.isfa(i))id[i]=++cnt,pts[cnt].push_back(v[i]);\n\n\tfor(reg int i=0;i<n;i++)if(!S.isfa(i))pts[id[S.find(i)]].push_back(v[i]);\n\n\tif(n<((cnt-1)<<1))return 0*puts(\"Impossible\");\n\n\tfor(reg int i=1;i<=cnt;i++)std::sort(pts[i].begin(),pts[i].end());\n\n\treg ll ans=0;reg int tot=0;\n\n\tfor(reg int i=1;i<=cnt;i++)ans+=pts[i][0];\n\n\tfor(reg int i=1;i<=cnt;i++)for(reg int j=1;j<pts[i].size();j++)a[++tot]=pts[i][j];\n\n\tstd::sort(a+1,a+1+tot);\n\n\tfor(reg int i=1;i<=cnt-2;i++)ans+=a[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n    return 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100005;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n//    multiset<int>::iterator it;\n\n//    for(it = s.begin(); it != s.end(); it++)\n\n//    {\n\n//        printf(\"%d \", *it);\n\n//    }\n\n//    printf(\"\\n\");\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n//        printf(\"%d %d %d\\n\", i, Find(i), mi[fa[i]]);\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            multiset<int>::iterator it = s.find(mi[fa[i]]);\n\n            s.erase(it);\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "139",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define mp(x,y) make_pair(x,y) \n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\ntypedef pair<ll,int> pr;\n\n//priority_queue<pr,vector<pr>,greater<pr> >q;\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],res;\n\nint d[MN],fa[MN],rk[MN],num[MN],h[MN],ch[2][MN];\n\nint n,m,x,y,cnt,tot,fx,fy,rt,ct;\n\nbool vis[MN];\n\nll mn[MN];bool tmp[MN];\n\ninline int gf(int x){return fa[x]?fa[x]=gf(fa[x]):x;}\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\ninline int merge(int x,int y){\n\n    if (!x) return y;if (!y) return x;\n\n    if (a[x]>a[y]||(a[x]==a[y]&&x>y)) swap(x,y);\n\n    ch[1][x]=merge(ch[1][x],y);fa[ch[1][x]]=x;\n\n    if (d[ch[0][x]]<d[ch[1][x]]) swap(ch[0][x],ch[1][x]);\n\n    d[x]=d[ch[1][x]]+1;return x;\n\n}\n\ninline int pop(int x){\n\n    a[x]=-1;fa[x]=-1;fa[ch[0][x]]=fa[ch[1][x]]=0;\n\n    return merge(ch[0][x],ch[1][x]);\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);\n\n\t\trk[tot]=i;dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\t/*\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (rk[num[i]]==i) continue;\n\n\t\tfx=gf(i),fy=gf(rk[num[i]]);merge(fx,fy);\n\n\t}\n\n\tfor (int i=1;i<=tot;++i){\n\n\t\tfx=gf(rk[i]);q.push(mp(a[fx],fx));\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tpr x=q.top();q.pop();\n\n\t\tif (q.empty()) break;pr y=q.top();q.pop();\n\n\t\tres+=1ll*x.first+y.first;++ct;\n\n\t\tfx=gf(x.second),fy=gf(y.second);printf(\"%d %d\\n\",fx,fy);\n\n\t\tfx=pop(fx);fy=pop(fy);rt=merge(fx,fy);\n\n\t\tif (rt) q.push(mp(a[rt],rt));\n\n\t}*/\n\n//\tif (ct+m!=n-1) printf(\"Impossible\");\n\n//\telse \n\n//\tprintf(\"%lld\",res);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100005;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n//    multiset<int>::iterator it;\n\n//    for(it = s.begin(); it != s.end(); it++)\n\n//    {\n\n//        printf(\"%d \", *it);\n\n//    }\n\n//    printf(\"\\n\");\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n//        printf(\"%d %d %d\\n\", i, Find(i), mi[fa[i]]);\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            multiset<int>::iterator it = s.find(mi[fa[i]]);\n\n            s.erase(it);\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "140",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],mn[MN],res;\n\nint num[MN],h[MN];\n\nint n,m,x,y,cnt,tot,ct;\n\nbool vis[MN],tmp[MN];\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100005;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n//    multiset<int>::iterator it;\n\n//    for(it = s.begin(); it != s.end(); it++)\n\n//    {\n\n//        printf(\"%d \", *it);\n\n//    }\n\n//    printf(\"\\n\");\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n//        printf(\"%d %d %d\\n\", i, Find(i), mi[fa[i]]);\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            multiset<int>::iterator it = s.find(mi[fa[i]]);\n\n            s.erase(it);\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "141",
        "source_code": "#include<bits/stdc++.h>\n\n#define rep(i,a,b) for (int i=(a); i<=(b); i++)\n\n#define per(i,a,b) for (int i=(a); i>=(b); i--)\n\nusing namespace std;\n\n\n\nconst int maxn = 100005;\n\nint a[maxn], vis[maxn], n, m, x, y, mn, cur;\n\npriority_queue<int, vector<int>, greater<int> > Q;\n\nvector<int> e[maxn];\n\nlong long ans;\n\n\n\nvoid dfs(int u) {\n\n\tint sz = e[u].size();\n\n\tif (a[u] < mn) mn = a[u], cur = u;\n\n\tvis[u] = 1;\n\n\tif (!sz) return;\n\n\trep (i, 0, sz - 1)\n\n\t\tif (!vis[e[u][i]]) dfs(e[u][i]);\n\n}\n\n\n\nint main() {\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tif (n < 2 * (n - m - 1)) \n\n\t\treturn puts(\"Impossible\"), 0;\n\n\tif (n - 1 == m)\n\n\t\treturn puts(\"0\"), 0;\n\n\trep (i, 1, n) scanf(\"%d\", &a[i]);\n\n\trep (i, 1, m) {\n\n\t\tscanf(\"%d%d\", &x, &y); x++; y++;\n\n\t\te[x].push_back(y); e[y].push_back(x);\n\n\t}\n\n\trep (i, 1, n)\n\n\t\tif (!vis[i]) {\n\n\t\t\tmn = 2e9;\n\n\t\t\tdfs(i);\n\n\t\t\tans += mn;\n\n\t\t\ta[cur] = 0;\n\n\t\t}\n\n\trep (i, 1, n)\n\n\t\tif (a[i]) Q.push(a[i]);\n\n\tm = 2 * (n - m - 1) - (n - m);\n\n\twhile (m-- > 0) {\n\n\t\tans += Q.top();\n\n\t\tQ.pop();\n\n\t}\n\n\tcout << ans << endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100005;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n//    multiset<int>::iterator it;\n\n//    for(it = s.begin(); it != s.end(); it++)\n\n//    {\n\n//        printf(\"%d \", *it);\n\n//    }\n\n//    printf(\"\\n\");\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n//        printf(\"%d %d %d\\n\", i, Find(i), mi[fa[i]]);\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            multiset<int>::iterator it = s.find(mi[fa[i]]);\n\n            s.erase(it);\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "142",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define ll long long\n\n#define sd(x) scanf(\"%d\", &(x))\n\n#define pii pair<int, int>\n\n#define F first\n\n#define S second\n\n#define all(c) ((c).begin()), ((c).end())\n\n#define sz(x) ((int)(x).size())\n\n#define ld long double\n\n\n\ntemplate<class T,class U>\n\nostream& operator<<(ostream& os,const pair<T,U>& p){\n\n\tos<<\"(\"<<p.first<<\", \"<<p.second<<\")\";\n\n\treturn os;\n\n}\n\n\n\ntemplate<class T>\n\nostream& operator <<(ostream& os,const vector<T>& v){\n\n\tos<<\"{\";\n\n\tfor(int i = 0;i < (int)v.size(); i++){\n\n\t\tif(i)os<<\", \";\n\n\t\tos<<v[i];\n\n\t}\n\n\tos<<\"}\";\n\n\treturn os;\n\n}\n\n\n\n#ifdef LOCAL\n\n#define cerr cout\n\n#else\n\n#endif\n\n\n\n#define TRACE\n\n\n\n#ifdef TRACE\n\n#define trace(...) __f(#__VA_ARGS__, __VA_ARGS__)\n\ntemplate <typename Arg1>\n\nvoid __f(const char* name, Arg1&& arg1){\n\n\tcerr << name << \" : \" << arg1 << std::endl;\n\n}\n\ntemplate <typename Arg1, typename... Args>\n\nvoid __f(const char* names, Arg1&& arg1, Args&&... args){\n\n\tconst char* comma = strchr(names + 1, ',');cerr.write(names, comma - names) << \" : \" << arg1<<\" | \";__f(comma+1, args...);\n\n}\n\n#else\n\n#define trace(...)\n\n#endif\n\n\n\nstruct dsu{\n\n    int n;\n\n    vector<int> par;\n\n    vector<vector<int>> comp;\n\n    int num;\n\n    dsu(int n) : n(n), par(n), comp(n), num(n){\n\n        iota(par.begin(), par.end(), 0);\n\n    }\n\n    int root(int x){\n\n        return x == par[x] ? x : (par[x] = root(par[x]));\n\n    }\n\n    bool merge(int x, int y){\n\n        x = root(x); y = root(y);\n\n        if(x == y) return 0;\n\n        par[x] = y;\n\n        num--;\n\n        return 1;\n\n    }\n\n    void get(){\n\n        for(int i = 0; i < n; i++) comp[root(i)].push_back(i);\n\n    }\n\n};\n\n\n\n\n\nint a[100005];\n\nint main(){\n\n    int n, m; sd(n); sd(m);\n\n    for(int i = 0; i < n; i++) sd(a[i]);\n\n    dsu D(n);\n\n    for(int i = 0; i < m; i++){\n\n        int u, v;\n\n        sd(u); sd(v);\n\n        D.merge(u, v);\n\n    }\n\n    if(D.num == 1){\n\n        printf(\"0\\n\");\n\n        return 0;\n\n    }\n\n    D.get();\n\n    vector<int> rem;\n\n    ll ans = 0;\n\n    int num = 0;\n\n    for(int i = 0; i < n; i++) if(!D.comp[i].empty()){\n\n        vector<int> V = D.comp[i];\n\n        sort(all(V), [&](int i, int j){\n\n            return a[i] < a[j];\n\n        });\n\n        ans += a[V[0]];\n\n        for(int j = 1; j < sz(V); j++) rem.push_back(a[V[j]]);\n\n    }\n\n    if(sz(rem) < D.num - 2){\n\n        printf(\"Impossible\\n\");\n\n        return 0;\n\n    }\n\n    sort(all(rem));\n\n    for(int i = 0; i < D.num - 2; i++) ans += rem[i];\n\n    printf(\"%lld\\n\", ans);\n\n}"
    },
    {
        "id": "143",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n    }\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define ll long long\n\n#define sd(x) scanf(\"%d\", &(x))\n\n#define pii pair<int, int>\n\n#define F first\n\n#define S second\n\n#define all(c) ((c).begin()), ((c).end())\n\n#define sz(x) ((int)(x).size())\n\n#define ld long double\n\n\n\ntemplate<class T,class U>\n\nostream& operator<<(ostream& os,const pair<T,U>& p){\n\n\tos<<\"(\"<<p.first<<\", \"<<p.second<<\")\";\n\n\treturn os;\n\n}\n\n\n\ntemplate<class T>\n\nostream& operator <<(ostream& os,const vector<T>& v){\n\n\tos<<\"{\";\n\n\tfor(int i = 0;i < (int)v.size(); i++){\n\n\t\tif(i)os<<\", \";\n\n\t\tos<<v[i];\n\n\t}\n\n\tos<<\"}\";\n\n\treturn os;\n\n}\n\n\n\n#ifdef LOCAL\n\n#define cerr cout\n\n#else\n\n#endif\n\n\n\n#define TRACE\n\n\n\n#ifdef TRACE\n\n#define trace(...) __f(#__VA_ARGS__, __VA_ARGS__)\n\ntemplate <typename Arg1>\n\nvoid __f(const char* name, Arg1&& arg1){\n\n\tcerr << name << \" : \" << arg1 << std::endl;\n\n}\n\ntemplate <typename Arg1, typename... Args>\n\nvoid __f(const char* names, Arg1&& arg1, Args&&... args){\n\n\tconst char* comma = strchr(names + 1, ',');cerr.write(names, comma - names) << \" : \" << arg1<<\" | \";__f(comma+1, args...);\n\n}\n\n#else\n\n#define trace(...)\n\n#endif\n\n\n\nstruct dsu{\n\n    int n;\n\n    vector<int> par;\n\n    vector<vector<int>> comp;\n\n    int num;\n\n    dsu(int n) : n(n), par(n), comp(n), num(n){\n\n        iota(par.begin(), par.end(), 0);\n\n    }\n\n    int root(int x){\n\n        return x == par[x] ? x : (par[x] = root(par[x]));\n\n    }\n\n    bool merge(int x, int y){\n\n        x = root(x); y = root(y);\n\n        if(x == y) return 0;\n\n        par[x] = y;\n\n        num--;\n\n        return 1;\n\n    }\n\n    void get(){\n\n        for(int i = 0; i < n; i++) comp[root(i)].push_back(i);\n\n    }\n\n};\n\n\n\n\n\nint a[100005];\n\nint main(){\n\n    int n, m; sd(n); sd(m);\n\n    for(int i = 0; i < n; i++) sd(a[i]);\n\n    dsu D(n);\n\n    for(int i = 0; i < m; i++){\n\n        int u, v;\n\n        sd(u); sd(v);\n\n        D.merge(u, v);\n\n    }\n\n    if(D.num == 1){\n\n        printf(\"0\\n\");\n\n        return 0;\n\n    }\n\n    D.get();\n\n    vector<int> rem;\n\n    ll ans = 0;\n\n    int num = 0;\n\n    for(int i = 0; i < n; i++) if(!D.comp[i].empty()){\n\n        vector<int> V = D.comp[i];\n\n        sort(all(V), [&](int i, int j){\n\n            return a[i] < a[j];\n\n        });\n\n        ans += a[V[0]];\n\n        for(int j = 1; j < sz(V); j++) rem.push_back(a[V[j]]);\n\n    }\n\n    if(sz(rem) < D.num - 2){\n\n        printf(\"Impossible\\n\");\n\n        return 0;\n\n    }\n\n    sort(all(rem));\n\n    for(int i = 0; i < D.num - 2; i++) ans += rem[i];\n\n    printf(\"%lld\\n\", ans);\n\n}"
    },
    {
        "id": "144",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n\n//",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define ll long long\n\n#define sd(x) scanf(\"%d\", &(x))\n\n#define pii pair<int, int>\n\n#define F first\n\n#define S second\n\n#define all(c) ((c).begin()), ((c).end())\n\n#define sz(x) ((int)(x).size())\n\n#define ld long double\n\n\n\ntemplate<class T,class U>\n\nostream& operator<<(ostream& os,const pair<T,U>& p){\n\n\tos<<\"(\"<<p.first<<\", \"<<p.second<<\")\";\n\n\treturn os;\n\n}\n\n\n\ntemplate<class T>\n\nostream& operator <<(ostream& os,const vector<T>& v){\n\n\tos<<\"{\";\n\n\tfor(int i = 0;i < (int)v.size(); i++){\n\n\t\tif(i)os<<\", \";\n\n\t\tos<<v[i];\n\n\t}\n\n\tos<<\"}\";\n\n\treturn os;\n\n}\n\n\n\n#ifdef LOCAL\n\n#define cerr cout\n\n#else\n\n#endif\n\n\n\n#define TRACE\n\n\n\n#ifdef TRACE\n\n#define trace(...) __f(#__VA_ARGS__, __VA_ARGS__)\n\ntemplate <typename Arg1>\n\nvoid __f(const char* name, Arg1&& arg1){\n\n\tcerr << name << \" : \" << arg1 << std::endl;\n\n}\n\ntemplate <typename Arg1, typename... Args>\n\nvoid __f(const char* names, Arg1&& arg1, Args&&... args){\n\n\tconst char* comma = strchr(names + 1, ',');cerr.write(names, comma - names) << \" : \" << arg1<<\" | \";__f(comma+1, args...);\n\n}\n\n#else\n\n#define trace(...)\n\n#endif\n\n\n\nstruct dsu{\n\n    int n;\n\n    vector<int> par;\n\n    vector<vector<int>> comp;\n\n    int num;\n\n    dsu(int n) : n(n), par(n), comp(n), num(n){\n\n        iota(par.begin(), par.end(), 0);\n\n    }\n\n    int root(int x){\n\n        return x == par[x] ? x : (par[x] = root(par[x]));\n\n    }\n\n    bool merge(int x, int y){\n\n        x = root(x); y = root(y);\n\n        if(x == y) return 0;\n\n        par[x] = y;\n\n        num--;\n\n        return 1;\n\n    }\n\n    void get(){\n\n        for(int i = 0; i < n; i++) comp[root(i)].push_back(i);\n\n    }\n\n};\n\n\n\n\n\nint a[100005];\n\nint main(){\n\n    int n, m; sd(n); sd(m);\n\n    for(int i = 0; i < n; i++) sd(a[i]);\n\n    dsu D(n);\n\n    for(int i = 0; i < m; i++){\n\n        int u, v;\n\n        sd(u); sd(v);\n\n        D.merge(u, v);\n\n    }\n\n    if(D.num == 1){\n\n        printf(\"0\\n\");\n\n        return 0;\n\n    }\n\n    D.get();\n\n    vector<int> rem;\n\n    ll ans = 0;\n\n    int num = 0;\n\n    for(int i = 0; i < n; i++) if(!D.comp[i].empty()){\n\n        vector<int> V = D.comp[i];\n\n        sort(all(V), [&](int i, int j){\n\n            return a[i] < a[j];\n\n        });\n\n        ans += a[V[0]];\n\n        for(int j = 1; j < sz(V); j++) rem.push_back(a[V[j]]);\n\n    }\n\n    if(sz(rem) < D.num - 2){\n\n        printf(\"Impossible\\n\");\n\n        return 0;\n\n    }\n\n    sort(all(rem));\n\n    for(int i = 0; i < D.num - 2; i++) ans += rem[i];\n\n    printf(\"%lld\\n\", ans);\n\n}"
    },
    {
        "id": "145",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define SZ(x) ((int)x.size())\n\n\n\nconst int N = 100005;\n\n\n\nint n, m;\n\nint a[N];\n\nint fa[N];\n\n\n\nvector<int> val[N];\n\n\n\nint getfa(int x) {\n\n\treturn fa[x] == x ? x : fa[x] = getfa(fa[x]);\n\n}\n\n\n\nvoid merge(int x, int y) {\n\n\tx = getfa(x);\n\n\ty = getfa(y);\n\n\tif(SZ(val[x]) < SZ(val[y])) {\n\n\t\tswap(x, y);\n\n\t}\n\n\tfor(auto v: val[y]) {\n\n\t\tval[x].push_back(v);\n\n\t}\n\n\tval[y].clear();\n\n\tfa[y] = x;\n\n}\n\n\n\nvoid input()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\n\n\t\tval[i].push_back(a[i]);\n\n\t\tfa[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++) {\n\n\t\tint x, y;\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++, y++;\n\n\t\tmerge(x, y);\n\n\t}\n\n}\n\n\n\nvoid solve()\n\n{\n\n\tlong long ans = 0;\n\n\n\n\tint cnt = (n - 1 - m) * 2;\n\n\n\n\tif(cnt == 0) {\n\n\t\tputs(\"0\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tvector<int> vec;\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tif(fa[i] == i) {\n\n\t\t\tsort(val[i].begin(), val[i].end());\n\n\t\t\tans += val[i][0];\n\n\t\t\tcnt--;\n\n\t\t\tfor(int j = 1; j < SZ(val[i]); j++) {\n\n\t\t\t\tvec.push_back(val[i][j]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tif(SZ(vec) < cnt) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tsort(vec.begin(), vec.end());\n\n\tfor(int i = 0; i < cnt; i++) {\n\n\t\tans += vec[i];\n\n\t}\n\n\tcout << ans << endl;\n\n}\n\n\n\nint main()\n\n{\n\n\tinput();\n\n\tsolve();\n\n\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define ll long long\n\n#define sd(x) scanf(\"%d\", &(x))\n\n#define pii pair<int, int>\n\n#define F first\n\n#define S second\n\n#define all(c) ((c).begin()), ((c).end())\n\n#define sz(x) ((int)(x).size())\n\n#define ld long double\n\n\n\ntemplate<class T,class U>\n\nostream& operator<<(ostream& os,const pair<T,U>& p){\n\n\tos<<\"(\"<<p.first<<\", \"<<p.second<<\")\";\n\n\treturn os;\n\n}\n\n\n\ntemplate<class T>\n\nostream& operator <<(ostream& os,const vector<T>& v){\n\n\tos<<\"{\";\n\n\tfor(int i = 0;i < (int)v.size(); i++){\n\n\t\tif(i)os<<\", \";\n\n\t\tos<<v[i];\n\n\t}\n\n\tos<<\"}\";\n\n\treturn os;\n\n}\n\n\n\n#ifdef LOCAL\n\n#define cerr cout\n\n#else\n\n#endif\n\n\n\n#define TRACE\n\n\n\n#ifdef TRACE\n\n#define trace(...) __f(#__VA_ARGS__, __VA_ARGS__)\n\ntemplate <typename Arg1>\n\nvoid __f(const char* name, Arg1&& arg1){\n\n\tcerr << name << \" : \" << arg1 << std::endl;\n\n}\n\ntemplate <typename Arg1, typename... Args>\n\nvoid __f(const char* names, Arg1&& arg1, Args&&... args){\n\n\tconst char* comma = strchr(names + 1, ',');cerr.write(names, comma - names) << \" : \" << arg1<<\" | \";__f(comma+1, args...);\n\n}\n\n#else\n\n#define trace(...)\n\n#endif\n\n\n\nstruct dsu{\n\n    int n;\n\n    vector<int> par;\n\n    vector<vector<int>> comp;\n\n    int num;\n\n    dsu(int n) : n(n), par(n), comp(n), num(n){\n\n        iota(par.begin(), par.end(), 0);\n\n    }\n\n    int root(int x){\n\n        return x == par[x] ? x : (par[x] = root(par[x]));\n\n    }\n\n    bool merge(int x, int y){\n\n        x = root(x); y = root(y);\n\n        if(x == y) return 0;\n\n        par[x] = y;\n\n        num--;\n\n        return 1;\n\n    }\n\n    void get(){\n\n        for(int i = 0; i < n; i++) comp[root(i)].push_back(i);\n\n    }\n\n};\n\n\n\n\n\nint a[100005];\n\nint main(){\n\n    int n, m; sd(n); sd(m);\n\n    for(int i = 0; i < n; i++) sd(a[i]);\n\n    dsu D(n);\n\n    for(int i = 0; i < m; i++){\n\n        int u, v;\n\n        sd(u); sd(v);\n\n        D.merge(u, v);\n\n    }\n\n    if(D.num == 1){\n\n        printf(\"0\\n\");\n\n        return 0;\n\n    }\n\n    D.get();\n\n    vector<int> rem;\n\n    ll ans = 0;\n\n    int num = 0;\n\n    for(int i = 0; i < n; i++) if(!D.comp[i].empty()){\n\n        vector<int> V = D.comp[i];\n\n        sort(all(V), [&](int i, int j){\n\n            return a[i] < a[j];\n\n        });\n\n        ans += a[V[0]];\n\n        for(int j = 1; j < sz(V); j++) rem.push_back(a[V[j]]);\n\n    }\n\n    if(sz(rem) < D.num - 2){\n\n        printf(\"Impossible\\n\");\n\n        return 0;\n\n    }\n\n    sort(all(rem));\n\n    for(int i = 0; i < D.num - 2; i++) ans += rem[i];\n\n    printf(\"%lld\\n\", ans);\n\n}"
    },
    {
        "id": "146",
        "source_code": "#include<cstdio>\n\n#include<cctype>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<vector>\n\nusing std::vector;\n\n#define max(a,b) (a>b?a:b)\n\n#define min(a,b) (a<b?a:b)\n\n#define reg register\n\ntypedef long long ll;\n\ninline int read(){\n\n    reg int x=0,f=1;reg char ch=getchar();\n\n    for(;!isdigit(ch);f=ch=='-'?-1:1,ch=getchar());\n\n    for(;isdigit(ch);x=x*10+(ch^48),ch=getchar());\n\n    return x*f;\n\n}\n\nconst int MN=1e5+5;\n\nint n,m;\n\nclass UFset{\n\n\tpublic:\n\n\t\tint par[MN];\n\n\t\tinline int find(int x){return x==par[x]?x:par[x]=find(par[x]);}\n\n\t\tinline void init(int x){for(reg int i=0;i<x;i++)par[i]=i;}\n\n\t\tinline void unite(int x,int y){x=find(x);y=find(y);par[y]=x;}\n\n\t\tinline bool isfa(int x){return find(x)==x;}\n\n}S;\n\nint v[MN],cnt,id[MN],a[MN];\n\nvector<int>pts[MN];\n\nint main(){\n\n\tn=read();m=read();S.init(n);if(n==m+1)return 0*puts(\"0\");\n\n\tfor(reg int i=0;i<n;i++)v[i]=read();\n\n\tfor(reg int i=1;i<=m;i++)S.unite(read(),read());\n\n\tfor(reg int i=0;i<n;i++)if(S.isfa(i))id[i]=++cnt,pts[cnt].push_back(v[i]);\n\n\tfor(reg int i=0;i<n;i++)if(!S.isfa(i))pts[id[S.find(i)]].push_back(v[i]);\n\n\tif(n<((cnt-1)<<1))return 0*puts(\"Impossible\");\n\n\tfor(reg int i=1;i<=cnt;i++)std::sort(pts[i].begin(),pts[i].end());\n\n\treg ll ans=0;reg int tot=0;\n\n\tfor(reg int i=1;i<=cnt;i++)ans+=pts[i][0];\n\n\tfor(reg int i=1;i<=cnt;i++)for(reg int j=1;j<pts[i].size();j++)a[++tot]=pts[i][j];\n\n\tstd::sort(a+1,a+1+tot);\n\n\tfor(reg int i=1;i<=cnt-2;i++)ans+=a[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n    return 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define ll long long\n\n#define sd(x) scanf(\"%d\", &(x))\n\n#define pii pair<int, int>\n\n#define F first\n\n#define S second\n\n#define all(c) ((c).begin()), ((c).end())\n\n#define sz(x) ((int)(x).size())\n\n#define ld long double\n\n\n\ntemplate<class T,class U>\n\nostream& operator<<(ostream& os,const pair<T,U>& p){\n\n\tos<<\"(\"<<p.first<<\", \"<<p.second<<\")\";\n\n\treturn os;\n\n}\n\n\n\ntemplate<class T>\n\nostream& operator <<(ostream& os,const vector<T>& v){\n\n\tos<<\"{\";\n\n\tfor(int i = 0;i < (int)v.size(); i++){\n\n\t\tif(i)os<<\", \";\n\n\t\tos<<v[i];\n\n\t}\n\n\tos<<\"}\";\n\n\treturn os;\n\n}\n\n\n\n#ifdef LOCAL\n\n#define cerr cout\n\n#else\n\n#endif\n\n\n\n#define TRACE\n\n\n\n#ifdef TRACE\n\n#define trace(...) __f(#__VA_ARGS__, __VA_ARGS__)\n\ntemplate <typename Arg1>\n\nvoid __f(const char* name, Arg1&& arg1){\n\n\tcerr << name << \" : \" << arg1 << std::endl;\n\n}\n\ntemplate <typename Arg1, typename... Args>\n\nvoid __f(const char* names, Arg1&& arg1, Args&&... args){\n\n\tconst char* comma = strchr(names + 1, ',');cerr.write(names, comma - names) << \" : \" << arg1<<\" | \";__f(comma+1, args...);\n\n}\n\n#else\n\n#define trace(...)\n\n#endif\n\n\n\nstruct dsu{\n\n    int n;\n\n    vector<int> par;\n\n    vector<vector<int>> comp;\n\n    int num;\n\n    dsu(int n) : n(n), par(n), comp(n), num(n){\n\n        iota(par.begin(), par.end(), 0);\n\n    }\n\n    int root(int x){\n\n        return x == par[x] ? x : (par[x] = root(par[x]));\n\n    }\n\n    bool merge(int x, int y){\n\n        x = root(x); y = root(y);\n\n        if(x == y) return 0;\n\n        par[x] = y;\n\n        num--;\n\n        return 1;\n\n    }\n\n    void get(){\n\n        for(int i = 0; i < n; i++) comp[root(i)].push_back(i);\n\n    }\n\n};\n\n\n\n\n\nint a[100005];\n\nint main(){\n\n    int n, m; sd(n); sd(m);\n\n    for(int i = 0; i < n; i++) sd(a[i]);\n\n    dsu D(n);\n\n    for(int i = 0; i < m; i++){\n\n        int u, v;\n\n        sd(u); sd(v);\n\n        D.merge(u, v);\n\n    }\n\n    if(D.num == 1){\n\n        printf(\"0\\n\");\n\n        return 0;\n\n    }\n\n    D.get();\n\n    vector<int> rem;\n\n    ll ans = 0;\n\n    int num = 0;\n\n    for(int i = 0; i < n; i++) if(!D.comp[i].empty()){\n\n        vector<int> V = D.comp[i];\n\n        sort(all(V), [&](int i, int j){\n\n            return a[i] < a[j];\n\n        });\n\n        ans += a[V[0]];\n\n        for(int j = 1; j < sz(V); j++) rem.push_back(a[V[j]]);\n\n    }\n\n    if(sz(rem) < D.num - 2){\n\n        printf(\"Impossible\\n\");\n\n        return 0;\n\n    }\n\n    sort(all(rem));\n\n    for(int i = 0; i < D.num - 2; i++) ans += rem[i];\n\n    printf(\"%lld\\n\", ans);\n\n}"
    },
    {
        "id": "147",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define mp(x,y) make_pair(x,y) \n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\ntypedef pair<ll,int> pr;\n\n//priority_queue<pr,vector<pr>,greater<pr> >q;\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],res;\n\nint d[MN],fa[MN],rk[MN],num[MN],h[MN],ch[2][MN];\n\nint n,m,x,y,cnt,tot,fx,fy,rt,ct;\n\nbool vis[MN];\n\nll mn[MN];bool tmp[MN];\n\ninline int gf(int x){return fa[x]?fa[x]=gf(fa[x]):x;}\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\ninline int merge(int x,int y){\n\n    if (!x) return y;if (!y) return x;\n\n    if (a[x]>a[y]||(a[x]==a[y]&&x>y)) swap(x,y);\n\n    ch[1][x]=merge(ch[1][x],y);fa[ch[1][x]]=x;\n\n    if (d[ch[0][x]]<d[ch[1][x]]) swap(ch[0][x],ch[1][x]);\n\n    d[x]=d[ch[1][x]]+1;return x;\n\n}\n\ninline int pop(int x){\n\n    a[x]=-1;fa[x]=-1;fa[ch[0][x]]=fa[ch[1][x]]=0;\n\n    return merge(ch[0][x],ch[1][x]);\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);\n\n\t\trk[tot]=i;dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\t/*\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (rk[num[i]]==i) continue;\n\n\t\tfx=gf(i),fy=gf(rk[num[i]]);merge(fx,fy);\n\n\t}\n\n\tfor (int i=1;i<=tot;++i){\n\n\t\tfx=gf(rk[i]);q.push(mp(a[fx],fx));\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tpr x=q.top();q.pop();\n\n\t\tif (q.empty()) break;pr y=q.top();q.pop();\n\n\t\tres+=1ll*x.first+y.first;++ct;\n\n\t\tfx=gf(x.second),fy=gf(y.second);printf(\"%d %d\\n\",fx,fy);\n\n\t\tfx=pop(fx);fy=pop(fy);rt=merge(fx,fy);\n\n\t\tif (rt) q.push(mp(a[rt],rt));\n\n\t}*/\n\n//\tif (ct+m!=n-1) printf(\"Impossible\");\n\n//\telse \n\n//\tprintf(\"%lld\",res);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define ll long long\n\n#define sd(x) scanf(\"%d\", &(x))\n\n#define pii pair<int, int>\n\n#define F first\n\n#define S second\n\n#define all(c) ((c).begin()), ((c).end())\n\n#define sz(x) ((int)(x).size())\n\n#define ld long double\n\n\n\ntemplate<class T,class U>\n\nostream& operator<<(ostream& os,const pair<T,U>& p){\n\n\tos<<\"(\"<<p.first<<\", \"<<p.second<<\")\";\n\n\treturn os;\n\n}\n\n\n\ntemplate<class T>\n\nostream& operator <<(ostream& os,const vector<T>& v){\n\n\tos<<\"{\";\n\n\tfor(int i = 0;i < (int)v.size(); i++){\n\n\t\tif(i)os<<\", \";\n\n\t\tos<<v[i];\n\n\t}\n\n\tos<<\"}\";\n\n\treturn os;\n\n}\n\n\n\n#ifdef LOCAL\n\n#define cerr cout\n\n#else\n\n#endif\n\n\n\n#define TRACE\n\n\n\n#ifdef TRACE\n\n#define trace(...) __f(#__VA_ARGS__, __VA_ARGS__)\n\ntemplate <typename Arg1>\n\nvoid __f(const char* name, Arg1&& arg1){\n\n\tcerr << name << \" : \" << arg1 << std::endl;\n\n}\n\ntemplate <typename Arg1, typename... Args>\n\nvoid __f(const char* names, Arg1&& arg1, Args&&... args){\n\n\tconst char* comma = strchr(names + 1, ',');cerr.write(names, comma - names) << \" : \" << arg1<<\" | \";__f(comma+1, args...);\n\n}\n\n#else\n\n#define trace(...)\n\n#endif\n\n\n\nstruct dsu{\n\n    int n;\n\n    vector<int> par;\n\n    vector<vector<int>> comp;\n\n    int num;\n\n    dsu(int n) : n(n), par(n), comp(n), num(n){\n\n        iota(par.begin(), par.end(), 0);\n\n    }\n\n    int root(int x){\n\n        return x == par[x] ? x : (par[x] = root(par[x]));\n\n    }\n\n    bool merge(int x, int y){\n\n        x = root(x); y = root(y);\n\n        if(x == y) return 0;\n\n        par[x] = y;\n\n        num--;\n\n        return 1;\n\n    }\n\n    void get(){\n\n        for(int i = 0; i < n; i++) comp[root(i)].push_back(i);\n\n    }\n\n};\n\n\n\n\n\nint a[100005];\n\nint main(){\n\n    int n, m; sd(n); sd(m);\n\n    for(int i = 0; i < n; i++) sd(a[i]);\n\n    dsu D(n);\n\n    for(int i = 0; i < m; i++){\n\n        int u, v;\n\n        sd(u); sd(v);\n\n        D.merge(u, v);\n\n    }\n\n    if(D.num == 1){\n\n        printf(\"0\\n\");\n\n        return 0;\n\n    }\n\n    D.get();\n\n    vector<int> rem;\n\n    ll ans = 0;\n\n    int num = 0;\n\n    for(int i = 0; i < n; i++) if(!D.comp[i].empty()){\n\n        vector<int> V = D.comp[i];\n\n        sort(all(V), [&](int i, int j){\n\n            return a[i] < a[j];\n\n        });\n\n        ans += a[V[0]];\n\n        for(int j = 1; j < sz(V); j++) rem.push_back(a[V[j]]);\n\n    }\n\n    if(sz(rem) < D.num - 2){\n\n        printf(\"Impossible\\n\");\n\n        return 0;\n\n    }\n\n    sort(all(rem));\n\n    for(int i = 0; i < D.num - 2; i++) ans += rem[i];\n\n    printf(\"%lld\\n\", ans);\n\n}"
    },
    {
        "id": "148",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],mn[MN],res;\n\nint num[MN],h[MN];\n\nint n,m,x,y,cnt,tot,ct;\n\nbool vis[MN],tmp[MN];\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define ll long long\n\n#define sd(x) scanf(\"%d\", &(x))\n\n#define pii pair<int, int>\n\n#define F first\n\n#define S second\n\n#define all(c) ((c).begin()), ((c).end())\n\n#define sz(x) ((int)(x).size())\n\n#define ld long double\n\n\n\ntemplate<class T,class U>\n\nostream& operator<<(ostream& os,const pair<T,U>& p){\n\n\tos<<\"(\"<<p.first<<\", \"<<p.second<<\")\";\n\n\treturn os;\n\n}\n\n\n\ntemplate<class T>\n\nostream& operator <<(ostream& os,const vector<T>& v){\n\n\tos<<\"{\";\n\n\tfor(int i = 0;i < (int)v.size(); i++){\n\n\t\tif(i)os<<\", \";\n\n\t\tos<<v[i];\n\n\t}\n\n\tos<<\"}\";\n\n\treturn os;\n\n}\n\n\n\n#ifdef LOCAL\n\n#define cerr cout\n\n#else\n\n#endif\n\n\n\n#define TRACE\n\n\n\n#ifdef TRACE\n\n#define trace(...) __f(#__VA_ARGS__, __VA_ARGS__)\n\ntemplate <typename Arg1>\n\nvoid __f(const char* name, Arg1&& arg1){\n\n\tcerr << name << \" : \" << arg1 << std::endl;\n\n}\n\ntemplate <typename Arg1, typename... Args>\n\nvoid __f(const char* names, Arg1&& arg1, Args&&... args){\n\n\tconst char* comma = strchr(names + 1, ',');cerr.write(names, comma - names) << \" : \" << arg1<<\" | \";__f(comma+1, args...);\n\n}\n\n#else\n\n#define trace(...)\n\n#endif\n\n\n\nstruct dsu{\n\n    int n;\n\n    vector<int> par;\n\n    vector<vector<int>> comp;\n\n    int num;\n\n    dsu(int n) : n(n), par(n), comp(n), num(n){\n\n        iota(par.begin(), par.end(), 0);\n\n    }\n\n    int root(int x){\n\n        return x == par[x] ? x : (par[x] = root(par[x]));\n\n    }\n\n    bool merge(int x, int y){\n\n        x = root(x); y = root(y);\n\n        if(x == y) return 0;\n\n        par[x] = y;\n\n        num--;\n\n        return 1;\n\n    }\n\n    void get(){\n\n        for(int i = 0; i < n; i++) comp[root(i)].push_back(i);\n\n    }\n\n};\n\n\n\n\n\nint a[100005];\n\nint main(){\n\n    int n, m; sd(n); sd(m);\n\n    for(int i = 0; i < n; i++) sd(a[i]);\n\n    dsu D(n);\n\n    for(int i = 0; i < m; i++){\n\n        int u, v;\n\n        sd(u); sd(v);\n\n        D.merge(u, v);\n\n    }\n\n    if(D.num == 1){\n\n        printf(\"0\\n\");\n\n        return 0;\n\n    }\n\n    D.get();\n\n    vector<int> rem;\n\n    ll ans = 0;\n\n    int num = 0;\n\n    for(int i = 0; i < n; i++) if(!D.comp[i].empty()){\n\n        vector<int> V = D.comp[i];\n\n        sort(all(V), [&](int i, int j){\n\n            return a[i] < a[j];\n\n        });\n\n        ans += a[V[0]];\n\n        for(int j = 1; j < sz(V); j++) rem.push_back(a[V[j]]);\n\n    }\n\n    if(sz(rem) < D.num - 2){\n\n        printf(\"Impossible\\n\");\n\n        return 0;\n\n    }\n\n    sort(all(rem));\n\n    for(int i = 0; i < D.num - 2; i++) ans += rem[i];\n\n    printf(\"%lld\\n\", ans);\n\n}"
    },
    {
        "id": "149",
        "source_code": "#include<bits/stdc++.h>\n\n#define rep(i,a,b) for (int i=(a); i<=(b); i++)\n\n#define per(i,a,b) for (int i=(a); i>=(b); i--)\n\nusing namespace std;\n\n\n\nconst int maxn = 100005;\n\nint a[maxn], vis[maxn], n, m, x, y, mn, cur;\n\npriority_queue<int, vector<int>, greater<int> > Q;\n\nvector<int> e[maxn];\n\nlong long ans;\n\n\n\nvoid dfs(int u) {\n\n\tint sz = e[u].size();\n\n\tif (a[u] < mn) mn = a[u], cur = u;\n\n\tvis[u] = 1;\n\n\tif (!sz) return;\n\n\trep (i, 0, sz - 1)\n\n\t\tif (!vis[e[u][i]]) dfs(e[u][i]);\n\n}\n\n\n\nint main() {\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tif (n < 2 * (n - m - 1)) \n\n\t\treturn puts(\"Impossible\"), 0;\n\n\tif (n - 1 == m)\n\n\t\treturn puts(\"0\"), 0;\n\n\trep (i, 1, n) scanf(\"%d\", &a[i]);\n\n\trep (i, 1, m) {\n\n\t\tscanf(\"%d%d\", &x, &y); x++; y++;\n\n\t\te[x].push_back(y); e[y].push_back(x);\n\n\t}\n\n\trep (i, 1, n)\n\n\t\tif (!vis[i]) {\n\n\t\t\tmn = 2e9;\n\n\t\t\tdfs(i);\n\n\t\t\tans += mn;\n\n\t\t\ta[cur] = 0;\n\n\t\t}\n\n\trep (i, 1, n)\n\n\t\tif (a[i]) Q.push(a[i]);\n\n\tm = 2 * (n - m - 1) - (n - m);\n\n\twhile (m-- > 0) {\n\n\t\tans += Q.top();\n\n\t\tQ.pop();\n\n\t}\n\n\tcout << ans << endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define ll long long\n\n#define sd(x) scanf(\"%d\", &(x))\n\n#define pii pair<int, int>\n\n#define F first\n\n#define S second\n\n#define all(c) ((c).begin()), ((c).end())\n\n#define sz(x) ((int)(x).size())\n\n#define ld long double\n\n\n\ntemplate<class T,class U>\n\nostream& operator<<(ostream& os,const pair<T,U>& p){\n\n\tos<<\"(\"<<p.first<<\", \"<<p.second<<\")\";\n\n\treturn os;\n\n}\n\n\n\ntemplate<class T>\n\nostream& operator <<(ostream& os,const vector<T>& v){\n\n\tos<<\"{\";\n\n\tfor(int i = 0;i < (int)v.size(); i++){\n\n\t\tif(i)os<<\", \";\n\n\t\tos<<v[i];\n\n\t}\n\n\tos<<\"}\";\n\n\treturn os;\n\n}\n\n\n\n#ifdef LOCAL\n\n#define cerr cout\n\n#else\n\n#endif\n\n\n\n#define TRACE\n\n\n\n#ifdef TRACE\n\n#define trace(...) __f(#__VA_ARGS__, __VA_ARGS__)\n\ntemplate <typename Arg1>\n\nvoid __f(const char* name, Arg1&& arg1){\n\n\tcerr << name << \" : \" << arg1 << std::endl;\n\n}\n\ntemplate <typename Arg1, typename... Args>\n\nvoid __f(const char* names, Arg1&& arg1, Args&&... args){\n\n\tconst char* comma = strchr(names + 1, ',');cerr.write(names, comma - names) << \" : \" << arg1<<\" | \";__f(comma+1, args...);\n\n}\n\n#else\n\n#define trace(...)\n\n#endif\n\n\n\nstruct dsu{\n\n    int n;\n\n    vector<int> par;\n\n    vector<vector<int>> comp;\n\n    int num;\n\n    dsu(int n) : n(n), par(n), comp(n), num(n){\n\n        iota(par.begin(), par.end(), 0);\n\n    }\n\n    int root(int x){\n\n        return x == par[x] ? x : (par[x] = root(par[x]));\n\n    }\n\n    bool merge(int x, int y){\n\n        x = root(x); y = root(y);\n\n        if(x == y) return 0;\n\n        par[x] = y;\n\n        num--;\n\n        return 1;\n\n    }\n\n    void get(){\n\n        for(int i = 0; i < n; i++) comp[root(i)].push_back(i);\n\n    }\n\n};\n\n\n\n\n\nint a[100005];\n\nint main(){\n\n    int n, m; sd(n); sd(m);\n\n    for(int i = 0; i < n; i++) sd(a[i]);\n\n    dsu D(n);\n\n    for(int i = 0; i < m; i++){\n\n        int u, v;\n\n        sd(u); sd(v);\n\n        D.merge(u, v);\n\n    }\n\n    if(D.num == 1){\n\n        printf(\"0\\n\");\n\n        return 0;\n\n    }\n\n    D.get();\n\n    vector<int> rem;\n\n    ll ans = 0;\n\n    int num = 0;\n\n    for(int i = 0; i < n; i++) if(!D.comp[i].empty()){\n\n        vector<int> V = D.comp[i];\n\n        sort(all(V), [&](int i, int j){\n\n            return a[i] < a[j];\n\n        });\n\n        ans += a[V[0]];\n\n        for(int j = 1; j < sz(V); j++) rem.push_back(a[V[j]]);\n\n    }\n\n    if(sz(rem) < D.num - 2){\n\n        printf(\"Impossible\\n\");\n\n        return 0;\n\n    }\n\n    sort(all(rem));\n\n    for(int i = 0; i < D.num - 2; i++) ans += rem[i];\n\n    printf(\"%lld\\n\", ans);\n\n}"
    },
    {
        "id": "150",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntypedef long long LL;\n\n\n\nconst int MAXN = 1e5 + 5;\n\n\n\nint n, m, w[MAXN];\n\n\n\nstd::multiset<int> st[MAXN];\n\nstd::set<std::pair<int, int> > spec;\n\n\n\nint fa[MAXN], part;\n\n\n\nint Find(int x) {\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid merge(int u, int v) {\n\n    if (Find(u) == Find(v)) return;\n\n    if (st[fa[u]].size() > st[fa[v]].size()) std::swap(u, v);\n\n    --part;\n\n    for (int i: st[fa[u]]) {\n\n        st[fa[v]].insert(i);\n\n    }\n\n    st[fa[u]].clear();\n\n    if (!st[fa[v]].empty()) spec.insert(std::make_pair(st[fa[v]].size(), fa[v]));\n\n    fa[fa[u]] = fa[v];\n\n}\n\n\n\nint main() {\n\n    scanf(\"%d%d\", &n, &m); part = n;\n\n    for (int i = 0; i < n; ++i) {\n\n        fa[i] = i;\n\n        scanf(\"%d\", w + i);\n\n        st[i].insert(w[i]);\n\n        spec.insert(std::make_pair(1, i));\n\n    }\n\n    \n\n    for (int i = 1; i <= m; ++i) {\n\n        static int u, v;\n\n        \n\n        scanf(\"%d%d\", &u, &v);\n\n        spec.erase(spec.find(std::make_pair(st[Find(u)].size(), Find(u))));\n\n        spec.erase(spec.find(std::make_pair(st[Find(v)].size(), Find(v))));\n\n        merge(u, v);\n\n    }\n\n    \n\n    LL ans = 0;\n\n    \n\n    while (part > 1) {\n\n        if (spec.size() < 2) {\n\n            puts(\"Impossible\");\n\n            return 0;\n\n        }\n\n        auto x = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        auto y = *--spec.end();\n\n        spec.erase(--spec.end());\n\n        \n\n        int u = x.second, v = y.second;\n\n        ans += *st[Find(u)].begin() + *st[Find(v)].begin();\n\n        \n\n        st[Find(u)].erase(st[Find(u)].begin());\n\n        st[Find(v)].erase(st[Find(v)].begin());\n\n        \n\n        merge(u, v);\n\n    }\n\n    \n\n    printf(\"%lld\\n\", ans);\n\n    \n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint p[100100];\n\nll ans;\n\nint n, m;\n\npair<ll, int> a[100100];\n\nbool group_used[100100];\n\nbool used[100100];\n\nint root(int x) { return x == p[x] ? x : p[x] = root(p[x]); }\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor (int i = 1; i <= n; i++)\n\n\t{\n\n\t\tll cost;\n\n\t\tscanf(\"%lld\", &cost);\n\n\t\ta[i] = make_pair(cost, i);\n\n\t}\n\n\tfor (int i = 1; i <= n; i++) p[i] = i;\n\n\tfor (int i = 1; i <= m; i++)\n\n\t{\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++; v++;\n\n\t\tp[root(u)] = root(v);\n\n\t}\n\n\tint g = 0;\n\n\tfor (int i = 1; i <= n; i++) if (p[i] == i) g++;\n\n\t// need to group g supernodes into a tree. need to have:\n\n\t//   sum of degree = 2(g-1) <= number of nodes = n\n\n\tif (2 * (g - 1) > n)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\t// select smallest cost from each group first\n\n\t// then select smallest from rest\n\n\tsort(&a[1], &a[n + 1]);\n\n\tint dsum = 0;\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tint r = root(x);\n\n\t\tif (group_used[r] || used[x]) continue;\n\n\t\tgroup_used[r] = used[x] = true;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tif (used[x]) continue;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "151",
        "source_code": "#include <algorithm>\n\n#include <iostream>\n\n#include <cstdlib>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\n\n\nint n, m;\n\nint fa[MAXN+5];\n\nint val[MAXN+5];\n\nvector <int> blk[MAXN+5];\n\nvector <int> ansEdge;\n\nlong long int ans;\n\n\n\nint SetFind(int x)\n\n{\n\n    if(fa[x] != x)\n\n        return fa[x] = SetFind(fa[x]);\n\n    return fa[x];\n\n}\n\n\n\nvoid SetInit(int n)\n\n{\n\n    for(int i = 1; i <= n; i++)\n\n        fa[i] = i;\n\n}\n\n\n\nint main()\n\n{\n\n    int blkcnt;\n\n\n\n    cin >> n >> m ;\n\n    SetInit(n);\n\n    blkcnt = n;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        cin >> val[i] ;\n\n        //blk[i].push_back(val[i]);\n\n    }\n\n\n\n\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        cin >> u >> v;\n\n        u++, v++;\n\n        if(SetFind(u) != SetFind(v))\n\n            fa[SetFind(u)] = SetFind(v), blkcnt--;\n\n    }\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        blk[SetFind(i)].push_back(val[i]);\n\n/*\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        if(!blk[i].empty())\n\n            cout << blk[i].size() << endl ;\n\n    }\n\n*/\n\n    if(blkcnt <= 1)\n\n    {\n\n        cout << 0 << endl ;\n\n        return 0;\n\n    }\n\n\n\n    blkcnt -= 2;\n\n\n\n    for(int i = 1; i <= n; i++)\n\n        if(!blk[i].empty())\n\n        {\n\n            sort(blk[i].begin(), blk[i].end());\n\n            ans += blk[i][0];\n\n            for(int k = 1; k < blk[i].size(); k++)\n\n                ansEdge.push_back(blk[i][k]);\n\n        }\n\n\n\n    if(ansEdge.size() < blkcnt)\n\n    {\n\n        cout << \"Impossible\" << endl;\n\n        return 0;\n\n    }\n\n\n\n    sort(ansEdge.begin(), ansEdge.end());\n\n\n\n    for(int i = 0; i < blkcnt; i++)\n\n        ans += ansEdge[i] ;\n\n\n\n    cout << ans << endl ;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint p[100100];\n\nll ans;\n\nint n, m;\n\npair<ll, int> a[100100];\n\nbool group_used[100100];\n\nbool used[100100];\n\nint root(int x) { return x == p[x] ? x : p[x] = root(p[x]); }\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor (int i = 1; i <= n; i++)\n\n\t{\n\n\t\tll cost;\n\n\t\tscanf(\"%lld\", &cost);\n\n\t\ta[i] = make_pair(cost, i);\n\n\t}\n\n\tfor (int i = 1; i <= n; i++) p[i] = i;\n\n\tfor (int i = 1; i <= m; i++)\n\n\t{\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++; v++;\n\n\t\tp[root(u)] = root(v);\n\n\t}\n\n\tint g = 0;\n\n\tfor (int i = 1; i <= n; i++) if (p[i] == i) g++;\n\n\t// need to group g supernodes into a tree. need to have:\n\n\t//   sum of degree = 2(g-1) <= number of nodes = n\n\n\tif (2 * (g - 1) > n)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\t// select smallest cost from each group first\n\n\t// then select smallest from rest\n\n\tsort(&a[1], &a[n + 1]);\n\n\tint dsum = 0;\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tint r = root(x);\n\n\t\tif (group_used[r] || used[x]) continue;\n\n\t\tgroup_used[r] = used[x] = true;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tif (used[x]) continue;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "152",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n\n//",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint p[100100];\n\nll ans;\n\nint n, m;\n\npair<ll, int> a[100100];\n\nbool group_used[100100];\n\nbool used[100100];\n\nint root(int x) { return x == p[x] ? x : p[x] = root(p[x]); }\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor (int i = 1; i <= n; i++)\n\n\t{\n\n\t\tll cost;\n\n\t\tscanf(\"%lld\", &cost);\n\n\t\ta[i] = make_pair(cost, i);\n\n\t}\n\n\tfor (int i = 1; i <= n; i++) p[i] = i;\n\n\tfor (int i = 1; i <= m; i++)\n\n\t{\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++; v++;\n\n\t\tp[root(u)] = root(v);\n\n\t}\n\n\tint g = 0;\n\n\tfor (int i = 1; i <= n; i++) if (p[i] == i) g++;\n\n\t// need to group g supernodes into a tree. need to have:\n\n\t//   sum of degree = 2(g-1) <= number of nodes = n\n\n\tif (2 * (g - 1) > n)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\t// select smallest cost from each group first\n\n\t// then select smallest from rest\n\n\tsort(&a[1], &a[n + 1]);\n\n\tint dsum = 0;\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tint r = root(x);\n\n\t\tif (group_used[r] || used[x]) continue;\n\n\t\tgroup_used[r] = used[x] = true;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tif (used[x]) continue;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "153",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define SZ(x) ((int)x.size())\n\n\n\nconst int N = 100005;\n\n\n\nint n, m;\n\nint a[N];\n\nint fa[N];\n\n\n\nvector<int> val[N];\n\n\n\nint getfa(int x) {\n\n\treturn fa[x] == x ? x : fa[x] = getfa(fa[x]);\n\n}\n\n\n\nvoid merge(int x, int y) {\n\n\tx = getfa(x);\n\n\ty = getfa(y);\n\n\tif(SZ(val[x]) < SZ(val[y])) {\n\n\t\tswap(x, y);\n\n\t}\n\n\tfor(auto v: val[y]) {\n\n\t\tval[x].push_back(v);\n\n\t}\n\n\tval[y].clear();\n\n\tfa[y] = x;\n\n}\n\n\n\nvoid input()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\n\n\t\tval[i].push_back(a[i]);\n\n\t\tfa[i] = i;\n\n\t}\n\n\tfor(int i = 1; i <= m; i++) {\n\n\t\tint x, y;\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++, y++;\n\n\t\tmerge(x, y);\n\n\t}\n\n}\n\n\n\nvoid solve()\n\n{\n\n\tlong long ans = 0;\n\n\n\n\tint cnt = (n - 1 - m) * 2;\n\n\n\n\tif(cnt == 0) {\n\n\t\tputs(\"0\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tvector<int> vec;\n\n\tfor(int i = 1; i <= n; i++) {\n\n\t\tif(fa[i] == i) {\n\n\t\t\tsort(val[i].begin(), val[i].end());\n\n\t\t\tans += val[i][0];\n\n\t\t\tcnt--;\n\n\t\t\tfor(int j = 1; j < SZ(val[i]); j++) {\n\n\t\t\t\tvec.push_back(val[i][j]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tif(SZ(vec) < cnt) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn;\n\n\t}\n\n\n\n\tsort(vec.begin(), vec.end());\n\n\tfor(int i = 0; i < cnt; i++) {\n\n\t\tans += vec[i];\n\n\t}\n\n\tcout << ans << endl;\n\n}\n\n\n\nint main()\n\n{\n\n\tinput();\n\n\tsolve();\n\n\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint p[100100];\n\nll ans;\n\nint n, m;\n\npair<ll, int> a[100100];\n\nbool group_used[100100];\n\nbool used[100100];\n\nint root(int x) { return x == p[x] ? x : p[x] = root(p[x]); }\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor (int i = 1; i <= n; i++)\n\n\t{\n\n\t\tll cost;\n\n\t\tscanf(\"%lld\", &cost);\n\n\t\ta[i] = make_pair(cost, i);\n\n\t}\n\n\tfor (int i = 1; i <= n; i++) p[i] = i;\n\n\tfor (int i = 1; i <= m; i++)\n\n\t{\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++; v++;\n\n\t\tp[root(u)] = root(v);\n\n\t}\n\n\tint g = 0;\n\n\tfor (int i = 1; i <= n; i++) if (p[i] == i) g++;\n\n\t// need to group g supernodes into a tree. need to have:\n\n\t//   sum of degree = 2(g-1) <= number of nodes = n\n\n\tif (2 * (g - 1) > n)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\t// select smallest cost from each group first\n\n\t// then select smallest from rest\n\n\tsort(&a[1], &a[n + 1]);\n\n\tint dsum = 0;\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tint r = root(x);\n\n\t\tif (group_used[r] || used[x]) continue;\n\n\t\tgroup_used[r] = used[x] = true;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tif (used[x]) continue;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "154",
        "source_code": "#include<cstdio>\n\n#include<cctype>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<vector>\n\nusing std::vector;\n\n#define max(a,b) (a>b?a:b)\n\n#define min(a,b) (a<b?a:b)\n\n#define reg register\n\ntypedef long long ll;\n\ninline int read(){\n\n    reg int x=0,f=1;reg char ch=getchar();\n\n    for(;!isdigit(ch);f=ch=='-'?-1:1,ch=getchar());\n\n    for(;isdigit(ch);x=x*10+(ch^48),ch=getchar());\n\n    return x*f;\n\n}\n\nconst int MN=1e5+5;\n\nint n,m;\n\nclass UFset{\n\n\tpublic:\n\n\t\tint par[MN];\n\n\t\tinline int find(int x){return x==par[x]?x:par[x]=find(par[x]);}\n\n\t\tinline void init(int x){for(reg int i=0;i<x;i++)par[i]=i;}\n\n\t\tinline void unite(int x,int y){x=find(x);y=find(y);par[y]=x;}\n\n\t\tinline bool isfa(int x){return find(x)==x;}\n\n}S;\n\nint v[MN],cnt,id[MN],a[MN];\n\nvector<int>pts[MN];\n\nint main(){\n\n\tn=read();m=read();S.init(n);if(n==m+1)return 0*puts(\"0\");\n\n\tfor(reg int i=0;i<n;i++)v[i]=read();\n\n\tfor(reg int i=1;i<=m;i++)S.unite(read(),read());\n\n\tfor(reg int i=0;i<n;i++)if(S.isfa(i))id[i]=++cnt,pts[cnt].push_back(v[i]);\n\n\tfor(reg int i=0;i<n;i++)if(!S.isfa(i))pts[id[S.find(i)]].push_back(v[i]);\n\n\tif(n<((cnt-1)<<1))return 0*puts(\"Impossible\");\n\n\tfor(reg int i=1;i<=cnt;i++)std::sort(pts[i].begin(),pts[i].end());\n\n\treg ll ans=0;reg int tot=0;\n\n\tfor(reg int i=1;i<=cnt;i++)ans+=pts[i][0];\n\n\tfor(reg int i=1;i<=cnt;i++)for(reg int j=1;j<pts[i].size();j++)a[++tot]=pts[i][j];\n\n\tstd::sort(a+1,a+1+tot);\n\n\tfor(reg int i=1;i<=cnt-2;i++)ans+=a[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint p[100100];\n\nll ans;\n\nint n, m;\n\npair<ll, int> a[100100];\n\nbool group_used[100100];\n\nbool used[100100];\n\nint root(int x) { return x == p[x] ? x : p[x] = root(p[x]); }\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor (int i = 1; i <= n; i++)\n\n\t{\n\n\t\tll cost;\n\n\t\tscanf(\"%lld\", &cost);\n\n\t\ta[i] = make_pair(cost, i);\n\n\t}\n\n\tfor (int i = 1; i <= n; i++) p[i] = i;\n\n\tfor (int i = 1; i <= m; i++)\n\n\t{\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++; v++;\n\n\t\tp[root(u)] = root(v);\n\n\t}\n\n\tint g = 0;\n\n\tfor (int i = 1; i <= n; i++) if (p[i] == i) g++;\n\n\t// need to group g supernodes into a tree. need to have:\n\n\t//   sum of degree = 2(g-1) <= number of nodes = n\n\n\tif (2 * (g - 1) > n)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\t// select smallest cost from each group first\n\n\t// then select smallest from rest\n\n\tsort(&a[1], &a[n + 1]);\n\n\tint dsum = 0;\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tint r = root(x);\n\n\t\tif (group_used[r] || used[x]) continue;\n\n\t\tgroup_used[r] = used[x] = true;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tif (used[x]) continue;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "155",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define mp(x,y) make_pair(x,y) \n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\ntypedef pair<ll,int> pr;\n\n//priority_queue<pr,vector<pr>,greater<pr> >q;\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],res;\n\nint d[MN],fa[MN],rk[MN],num[MN],h[MN],ch[2][MN];\n\nint n,m,x,y,cnt,tot,fx,fy,rt,ct;\n\nbool vis[MN];\n\nll mn[MN];bool tmp[MN];\n\ninline int gf(int x){return fa[x]?fa[x]=gf(fa[x]):x;}\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\ninline int merge(int x,int y){\n\n    if (!x) return y;if (!y) return x;\n\n    if (a[x]>a[y]||(a[x]==a[y]&&x>y)) swap(x,y);\n\n    ch[1][x]=merge(ch[1][x],y);fa[ch[1][x]]=x;\n\n    if (d[ch[0][x]]<d[ch[1][x]]) swap(ch[0][x],ch[1][x]);\n\n    d[x]=d[ch[1][x]]+1;return x;\n\n}\n\ninline int pop(int x){\n\n    a[x]=-1;fa[x]=-1;fa[ch[0][x]]=fa[ch[1][x]]=0;\n\n    return merge(ch[0][x],ch[1][x]);\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);\n\n\t\trk[tot]=i;dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\t/*\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (rk[num[i]]==i) continue;\n\n\t\tfx=gf(i),fy=gf(rk[num[i]]);merge(fx,fy);\n\n\t}\n\n\tfor (int i=1;i<=tot;++i){\n\n\t\tfx=gf(rk[i]);q.push(mp(a[fx],fx));\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tpr x=q.top();q.pop();\n\n\t\tif (q.empty()) break;pr y=q.top();q.pop();\n\n\t\tres+=1ll*x.first+y.first;++ct;\n\n\t\tfx=gf(x.second),fy=gf(y.second);printf(\"%d %d\\n\",fx,fy);\n\n\t\tfx=pop(fx);fy=pop(fy);rt=merge(fx,fy);\n\n\t\tif (rt) q.push(mp(a[rt],rt));\n\n\t}*/\n\n//\tif (ct+m!=n-1) printf(\"Impossible\");\n\n//\telse \n\n//\tprintf(\"%lld\",res);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint p[100100];\n\nll ans;\n\nint n, m;\n\npair<ll, int> a[100100];\n\nbool group_used[100100];\n\nbool used[100100];\n\nint root(int x) { return x == p[x] ? x : p[x] = root(p[x]); }\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor (int i = 1; i <= n; i++)\n\n\t{\n\n\t\tll cost;\n\n\t\tscanf(\"%lld\", &cost);\n\n\t\ta[i] = make_pair(cost, i);\n\n\t}\n\n\tfor (int i = 1; i <= n; i++) p[i] = i;\n\n\tfor (int i = 1; i <= m; i++)\n\n\t{\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++; v++;\n\n\t\tp[root(u)] = root(v);\n\n\t}\n\n\tint g = 0;\n\n\tfor (int i = 1; i <= n; i++) if (p[i] == i) g++;\n\n\t// need to group g supernodes into a tree. need to have:\n\n\t//   sum of degree = 2(g-1) <= number of nodes = n\n\n\tif (2 * (g - 1) > n)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\t// select smallest cost from each group first\n\n\t// then select smallest from rest\n\n\tsort(&a[1], &a[n + 1]);\n\n\tint dsum = 0;\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tint r = root(x);\n\n\t\tif (group_used[r] || used[x]) continue;\n\n\t\tgroup_used[r] = used[x] = true;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tif (used[x]) continue;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "156",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<queue>\n\n#define ll long long\n\n#define MN 200005\n\nusing namespace std;\n\ninline ll in(){\n\n    ll x=0;bool f=0;char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\npriority_queue<ll,vector<ll>,greater<ll> >q;\n\nstruct edge{\n\n\tint to,nxt;\n\n}e[MN<<1];\n\nll a[MN],mn[MN],res;\n\nint num[MN],h[MN];\n\nint n,m,x,y,cnt,tot,ct;\n\nbool vis[MN],tmp[MN];\n\ninline void ins(int x,int y){\n\n\te[++cnt].to=y;e[cnt].nxt=h[x];h[x]=cnt;\n\n}\n\ninline void dfs(int u){\n\n\tmn[tot]=min(mn[tot],a[u]);\n\n\tfor (int i=h[u];i;i=e[i].nxt){\n\n\t\tint v=e[i].to;\n\n\t\tif (vis[v]) continue;\n\n\t\tvis[v]=1;num[v]=tot;dfs(v);\n\n\t}\n\n}\n\nint main()\n\n{\n\n\tn=in();m=in();\n\n\tmemset(mn,0x3f,sizeof(mn));\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=m;++i){\n\n\t\tx=in()+1;y=in()+1;\n\n\t\tins(x,y);ins(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;++i)\n\n\tif (!vis[i]){\n\n\t\tvis[i]=1;num[i]=(++tot);dfs(i);\n\n\t}\n\n\tif (tot==1) {printf(\"0\");return 0;}\n\n\tfor (int i=1;i<=tot;++i) res+=1ll*mn[i];\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (!tmp[num[i]]&&a[i]==mn[num[i]]) {tmp[num[i]]=1;continue;}\n\n\t\telse q.push(a[i]);\n\n\t}\n\n\twhile (!q.empty()){\n\n\t\tif (ct==tot-2) break;\n\n\t\tll x=q.top();q.pop();++ct;res+=1ll*x;\n\n\t} \n\n\tif (ct==tot-2) printf(\"%lld\",res);else printf(\"Impossible\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint p[100100];\n\nll ans;\n\nint n, m;\n\npair<ll, int> a[100100];\n\nbool group_used[100100];\n\nbool used[100100];\n\nint root(int x) { return x == p[x] ? x : p[x] = root(p[x]); }\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor (int i = 1; i <= n; i++)\n\n\t{\n\n\t\tll cost;\n\n\t\tscanf(\"%lld\", &cost);\n\n\t\ta[i] = make_pair(cost, i);\n\n\t}\n\n\tfor (int i = 1; i <= n; i++) p[i] = i;\n\n\tfor (int i = 1; i <= m; i++)\n\n\t{\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++; v++;\n\n\t\tp[root(u)] = root(v);\n\n\t}\n\n\tint g = 0;\n\n\tfor (int i = 1; i <= n; i++) if (p[i] == i) g++;\n\n\t// need to group g supernodes into a tree. need to have:\n\n\t//   sum of degree = 2(g-1) <= number of nodes = n\n\n\tif (2 * (g - 1) > n)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\t// select smallest cost from each group first\n\n\t// then select smallest from rest\n\n\tsort(&a[1], &a[n + 1]);\n\n\tint dsum = 0;\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tint r = root(x);\n\n\t\tif (group_used[r] || used[x]) continue;\n\n\t\tgroup_used[r] = used[x] = true;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tif (used[x]) continue;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "157",
        "source_code": "#include<bits/stdc++.h>\n\n#define rep(i,a,b) for (int i=(a); i<=(b); i++)\n\n#define per(i,a,b) for (int i=(a); i>=(b); i--)\n\nusing namespace std;\n\n\n\nconst int maxn = 100005;\n\nint a[maxn], vis[maxn], n, m, x, y, mn, cur;\n\npriority_queue<int, vector<int>, greater<int> > Q;\n\nvector<int> e[maxn];\n\nlong long ans;\n\n\n\nvoid dfs(int u) {\n\n\tint sz = e[u].size();\n\n\tif (a[u] < mn) mn = a[u], cur = u;\n\n\tvis[u] = 1;\n\n\tif (!sz) return;\n\n\trep (i, 0, sz - 1)\n\n\t\tif (!vis[e[u][i]]) dfs(e[u][i]);\n\n}\n\n\n\nint main() {\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tif (n < 2 * (n - m - 1)) \n\n\t\treturn puts(\"Impossible\"), 0;\n\n\tif (n - 1 == m)\n\n\t\treturn puts(\"0\"), 0;\n\n\trep (i, 1, n) scanf(\"%d\", &a[i]);\n\n\trep (i, 1, m) {\n\n\t\tscanf(\"%d%d\", &x, &y); x++; y++;\n\n\t\te[x].push_back(y); e[y].push_back(x);\n\n\t}\n\n\trep (i, 1, n)\n\n\t\tif (!vis[i]) {\n\n\t\t\tmn = 2e9;\n\n\t\t\tdfs(i);\n\n\t\t\tans += mn;\n\n\t\t\ta[cur] = 0;\n\n\t\t}\n\n\trep (i, 1, n)\n\n\t\tif (a[i]) Q.push(a[i]);\n\n\tm = 2 * (n - m - 1) - (n - m);\n\n\twhile (m-- > 0) {\n\n\t\tans += Q.top();\n\n\t\tQ.pop();\n\n\t}\n\n\tcout << ans << endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint p[100100];\n\nll ans;\n\nint n, m;\n\npair<ll, int> a[100100];\n\nbool group_used[100100];\n\nbool used[100100];\n\nint root(int x) { return x == p[x] ? x : p[x] = root(p[x]); }\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor (int i = 1; i <= n; i++)\n\n\t{\n\n\t\tll cost;\n\n\t\tscanf(\"%lld\", &cost);\n\n\t\ta[i] = make_pair(cost, i);\n\n\t}\n\n\tfor (int i = 1; i <= n; i++) p[i] = i;\n\n\tfor (int i = 1; i <= m; i++)\n\n\t{\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++; v++;\n\n\t\tp[root(u)] = root(v);\n\n\t}\n\n\tint g = 0;\n\n\tfor (int i = 1; i <= n; i++) if (p[i] == i) g++;\n\n\t// need to group g supernodes into a tree. need to have:\n\n\t//   sum of degree = 2(g-1) <= number of nodes = n\n\n\tif (2 * (g - 1) > n)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\t// select smallest cost from each group first\n\n\t// then select smallest from rest\n\n\tsort(&a[1], &a[n + 1]);\n\n\tint dsum = 0;\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tint r = root(x);\n\n\t\tif (group_used[r] || used[x]) continue;\n\n\t\tgroup_used[r] = used[x] = true;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tif (used[x]) continue;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "158",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\nusing namespace std;\n\n#define llg long long\n\n#define maxn 200010\n\n#define yyj(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout);\n\n\n\ninline llg getint()\n\n{\n\n    llg w=0,q=0; char c=getchar();\n\n    while((c<'0' || c>'9') && c!='-') c=getchar();\n\n    if (c=='-')  q=1, c=getchar(); while (c>='0' && c<='9') w=w*10+c-'0', c=getchar();\n\n    return q ? -w : w;\n\n}\n\n\n\nstruct node{llg val,fa;} a[maxn];\n\n\n\nbool cmp(const node &a,const node&b){return a.val<b.val;}\n\n\n\nllg n,m,fa[maxn],ans,c[maxn],needb,xian[maxn],chuxian[maxn],bj[maxn];\n\n\n\nllg find(llg x) {if (fa[x]!=x) fa[x]=find(fa[x]); return fa[x];}\n\n\n\nint main()\n\n{\n\n\tcin>>n>>m;\n\n\tfor (llg i=1;i<=n;i++) c[i]=getint(),fa[i]=i;\n\n\tfor (llg i=1;i<=m;i++)\n\n\t{\n\n\t\tllg x=getint(),y=getint();\n\n\t\tx++,y++;\n\n\t\tif (find(x)!=find(y)) fa[find(x)]=find(y);\n\n\t}\n\n\tfor (llg i=1;i<=n;i++) a[i].val=c[i],a[i].fa=find(i);\n\n\tsort(a+1,a+n+1,cmp);\n\n\tneedb=n-1-m;\n\n\tllg cs=0;\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t\tif (!chuxian[a[i].fa])\n\n\t\t{\n\n\t\t\tcs++;\n\n\t\t\tbj[i]=1;\n\n\t\t\tchuxian[a[i].fa]=1;\n\n\t\t\tans+=a[i].val;\n\n\t\t}\n\n\tfor (llg i=1;i<=n && cs<needb*2;i++)\n\n\t{\n\n\t\tif (xian[a[i].fa]<needb && !bj[i])\n\n\t\t{\n\n\t\t\txian[a[i].fa]++;\n\n\t\t\tans+=a[i].val;\n\n\t\t\tcs++;\n\n\t\t}\n\n\t}\n\n\tif (cs<needb*2) puts(\"Impossible\"); else \n\n\tcout<<ans;\n\n\treturn 0;\n\n} \n",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint p[100100];\n\nll ans;\n\nint n, m;\n\npair<ll, int> a[100100];\n\nbool group_used[100100];\n\nbool used[100100];\n\nint root(int x) { return x == p[x] ? x : p[x] = root(p[x]); }\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor (int i = 1; i <= n; i++)\n\n\t{\n\n\t\tll cost;\n\n\t\tscanf(\"%lld\", &cost);\n\n\t\ta[i] = make_pair(cost, i);\n\n\t}\n\n\tfor (int i = 1; i <= n; i++) p[i] = i;\n\n\tfor (int i = 1; i <= m; i++)\n\n\t{\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++; v++;\n\n\t\tp[root(u)] = root(v);\n\n\t}\n\n\tint g = 0;\n\n\tfor (int i = 1; i <= n; i++) if (p[i] == i) g++;\n\n\t// need to group g supernodes into a tree. need to have:\n\n\t//   sum of degree = 2(g-1) <= number of nodes = n\n\n\tif (2 * (g - 1) > n)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\t// select smallest cost from each group first\n\n\t// then select smallest from rest\n\n\tsort(&a[1], &a[n + 1]);\n\n\tint dsum = 0;\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tint r = root(x);\n\n\t\tif (group_used[r] || used[x]) continue;\n\n\t\tgroup_used[r] = used[x] = true;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tif (used[x]) continue;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "159",
        "source_code": "#include <bits/stdc++.h>\n\n\n\n\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int maxn = 100005;\n\nint a[maxn], fa[maxn], mi[maxn], id[maxn], vis[maxn];\n\nint n, m;\n\n\n\nvoid Init()\n\n{\n\n    for(int i = 0; i <= n; i++)\n\n    {\n\n        fa[i] = i;\n\n        mi[i] = a[i];\n\n        id[i] = i;\n\n    }\n\n}\n\n\n\nint Find(int x)\n\n{\n\n    return fa[x] == x ? x : fa[x] = Find(fa[x]);\n\n}\n\n\n\nvoid Merge(int x, int y)\n\n{\n\n    int fx = Find(x), fy = Find(y);\n\n    fa[fx] = fy;\n\n    if(mi[fy] > mi[fx])\n\n    {\n\n        mi[fy] = mi[fx];\n\n        id[fy] = id[fx];\n\n    }\n\n}\n\n\n\nint main()\n\n{\n\n    scanf(\"%d%d\", &n, &m);\n\n    multiset<int> s;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n        scanf(\"%d\", &a[i]);\n\n        s.insert(a[i]);\n\n    }\n\n    Init();\n\n//    multiset<int>::iterator it;\n\n//    for(it = s.begin(); it != s.end(); it++)\n\n//    {\n\n//        printf(\"%d \", *it);\n\n//    }\n\n//    printf(\"\\n\");\n\n    for(int i = 1; i <= m; i++)\n\n    {\n\n        int u, v;\n\n        scanf(\"%d%d\", &u, &v);\n\n        Merge(u + 1, v + 1);\n\n    }\n\n    int num = 0;\n\n    LL ans = 0;\n\n    for(int i = 1; i <= n; i++)\n\n    {\n\n//        printf(\"%d %d %d\\n\", i, Find(i), mi[fa[i]]);\n\n        if(Find(i) == i)\n\n        {\n\n            num++;\n\n            ans += mi[fa[i]];\n\n            multiset<int>::iterator it = s.find(mi[fa[i]]);\n\n            s.erase(it);\n\n        }\n\n    }\n\n    if(n < 2 * num - 2)\n\n        printf(\"Impossible\\n\");\n\n    else if(num == 1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        int cnt = 0;\n\n        multiset<int>::iterator it;\n\n        for(it = s.begin(); it != s.end() && cnt < num - 2; it++)\n\n        {\n\n            cnt++;\n\n            ans += *it;\n\n        }\n\n        printf(\"%lld\\n\", ans);\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint p[100100];\n\nll ans;\n\nint n, m;\n\npair<ll, int> a[100100];\n\nbool group_used[100100];\n\nbool used[100100];\n\nint root(int x) { return x == p[x] ? x : p[x] = root(p[x]); }\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor (int i = 1; i <= n; i++)\n\n\t{\n\n\t\tll cost;\n\n\t\tscanf(\"%lld\", &cost);\n\n\t\ta[i] = make_pair(cost, i);\n\n\t}\n\n\tfor (int i = 1; i <= n; i++) p[i] = i;\n\n\tfor (int i = 1; i <= m; i++)\n\n\t{\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++; v++;\n\n\t\tp[root(u)] = root(v);\n\n\t}\n\n\tint g = 0;\n\n\tfor (int i = 1; i <= n; i++) if (p[i] == i) g++;\n\n\t// need to group g supernodes into a tree. need to have:\n\n\t//   sum of degree = 2(g-1) <= number of nodes = n\n\n\tif (2 * (g - 1) > n)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\t// select smallest cost from each group first\n\n\t// then select smallest from rest\n\n\tsort(&a[1], &a[n + 1]);\n\n\tint dsum = 0;\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tint r = root(x);\n\n\t\tif (group_used[r] || used[x]) continue;\n\n\t\tgroup_used[r] = used[x] = true;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tif (used[x]) continue;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "160",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define ll long long\n\n#define sd(x) scanf(\"%d\", &(x))\n\n#define pii pair<int, int>\n\n#define F first\n\n#define S second\n\n#define all(c) ((c).begin()), ((c).end())\n\n#define sz(x) ((int)(x).size())\n\n#define ld long double\n\n\n\ntemplate<class T,class U>\n\nostream& operator<<(ostream& os,const pair<T,U>& p){\n\n\tos<<\"(\"<<p.first<<\", \"<<p.second<<\")\";\n\n\treturn os;\n\n}\n\n\n\ntemplate<class T>\n\nostream& operator <<(ostream& os,const vector<T>& v){\n\n\tos<<\"{\";\n\n\tfor(int i = 0;i < (int)v.size(); i++){\n\n\t\tif(i)os<<\", \";\n\n\t\tos<<v[i];\n\n\t}\n\n\tos<<\"}\";\n\n\treturn os;\n\n}\n\n\n\n#ifdef LOCAL\n\n#define cerr cout\n\n#else\n\n#endif\n\n\n\n#define TRACE\n\n\n\n#ifdef TRACE\n\n#define trace(...) __f(#__VA_ARGS__, __VA_ARGS__)\n\ntemplate <typename Arg1>\n\nvoid __f(const char* name, Arg1&& arg1){\n\n\tcerr << name << \" : \" << arg1 << std::endl;\n\n}\n\ntemplate <typename Arg1, typename... Args>\n\nvoid __f(const char* names, Arg1&& arg1, Args&&... args){\n\n\tconst char* comma = strchr(names + 1, ',');cerr.write(names, comma - names) << \" : \" << arg1<<\" | \";__f(comma+1, args...);\n\n}\n\n#else\n\n#define trace(...)\n\n#endif\n\n\n\nstruct dsu{\n\n    int n;\n\n    vector<int> par;\n\n    vector<vector<int>> comp;\n\n    int num;\n\n    dsu(int n) : n(n), par(n), comp(n), num(n){\n\n        iota(par.begin(), par.end(), 0);\n\n    }\n\n    int root(int x){\n\n        return x == par[x] ? x : (par[x] = root(par[x]));\n\n    }\n\n    bool merge(int x, int y){\n\n        x = root(x); y = root(y);\n\n        if(x == y) return 0;\n\n        par[x] = y;\n\n        num--;\n\n        return 1;\n\n    }\n\n    void get(){\n\n        for(int i = 0; i < n; i++) comp[root(i)].push_back(i);\n\n    }\n\n};\n\n\n\n\n\nint a[100005];\n\nint main(){\n\n    int n, m; sd(n); sd(m);\n\n    for(int i = 0; i < n; i++) sd(a[i]);\n\n    dsu D(n);\n\n    for(int i = 0; i < m; i++){\n\n        int u, v;\n\n        sd(u); sd(v);\n\n        D.merge(u, v);\n\n    }\n\n    if(D.num == 1){\n\n        printf(\"0\\n\");\n\n        return 0;\n\n    }\n\n    D.get();\n\n    vector<int> rem;\n\n    ll ans = 0;\n\n    int num = 0;\n\n    for(int i = 0; i < n; i++) if(!D.comp[i].empty()){\n\n        vector<int> V = D.comp[i];\n\n        sort(all(V), [&](int i, int j){\n\n            return a[i] < a[j];\n\n        });\n\n        ans += a[V[0]];\n\n        for(int j = 1; j < sz(V); j++) rem.push_back(a[V[j]]);\n\n    }\n\n    if(sz(rem) < D.num - 2){\n\n        printf(\"Impossible\\n\");\n\n        return 0;\n\n    }\n\n    sort(all(rem));\n\n    for(int i = 0; i < D.num - 2; i++) ans += rem[i];\n\n    printf(\"%lld\\n\", ans);\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint p[100100];\n\nll ans;\n\nint n, m;\n\npair<ll, int> a[100100];\n\nbool group_used[100100];\n\nbool used[100100];\n\nint root(int x) { return x == p[x] ? x : p[x] = root(p[x]); }\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor (int i = 1; i <= n; i++)\n\n\t{\n\n\t\tll cost;\n\n\t\tscanf(\"%lld\", &cost);\n\n\t\ta[i] = make_pair(cost, i);\n\n\t}\n\n\tfor (int i = 1; i <= n; i++) p[i] = i;\n\n\tfor (int i = 1; i <= m; i++)\n\n\t{\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tu++; v++;\n\n\t\tp[root(u)] = root(v);\n\n\t}\n\n\tint g = 0;\n\n\tfor (int i = 1; i <= n; i++) if (p[i] == i) g++;\n\n\t// need to group g supernodes into a tree. need to have:\n\n\t//   sum of degree = 2(g-1) <= number of nodes = n\n\n\tif (2 * (g - 1) > n)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\t// select smallest cost from each group first\n\n\t// then select smallest from rest\n\n\tsort(&a[1], &a[n + 1]);\n\n\tint dsum = 0;\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tint r = root(x);\n\n\t\tif (group_used[r] || used[x]) continue;\n\n\t\tgroup_used[r] = used[x] = true;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tfor (int i = 1; i <= n && dsum < 2 * (g - 1); i++)\n\n\t{\n\n\t\tint x = a[i].second;\n\n\t\tif (used[x]) continue;\n\n\t\tans += a[i].first;\n\n\t\tdsum++;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "162",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <array>\n\n#include <cstdint>\n\n#include <climits>\n\n#include <functional>\n\n#include <map>\n\n#include <math.h>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <stdlib.h>\n\n#include <string>\n\n#include <time.h>\n\n#include <utility>\n\n#include <vector>\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\n\n\n\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n\n\nint main(void) {\n\n\tstd::ios::sync_with_stdio(false);\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n#define SIZ 100001\n\n\tstd::priority_queue<uint32, std::vector<uint32>, std::greater<uint32>> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tstd::cin >> x >> y;\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].top());\n\n\t\t\tQ[U.find(i)].pop();\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0,s=0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].pop());\n\n\t\t\t++s;\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (s + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "163",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <array>\n\n#include <cstdint>\n\n#include <climits>\n\n#include <functional>\n\n#include <map>\n\n#include <math.h>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <stdlib.h>\n\n#include <string>\n\n#include <time.h>\n\n#include <utility>\n\n#include <vector>\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\n\n\n\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n\n\nint main(void) {\n\n\tstd::ios::sync_with_stdio(false);\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n#define SIZ 100001\n\n\tstd::priority_queue<uint32, std::vector<uint32>, std::greater<uint32>> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tstd::cin >> x >> y;\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].top());\n\n\t\t\tQ[U.find(i)].pop();\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\n/*\n\n \n\ntemplate<typename T, bool P = false>\n\nclass PairingHeap;\n\n \n\nPairingHeap\u306f\u878d\u5408\u53ef\u80fd\u306a\u30d2\u30fc\u30d7(\u512a\u5148\u5ea6\u4ed8\u304d\u30ad\u30e5\u30fc)\u3067\u3059\n\n\u7a7a\u9593\u8a08\u7b97\u91cf O(N)\n\n \n\n \n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\n\n-typename T\n\noperator< \u306b\u3088\u3063\u3066\u5927\u5c0f\u304c\u5b9a\u7fa9\u3055\u308c\u305f\u69cb\u9020\u4f53\n\n\u8981\u7d20\u306e\u578b\u306b\u306a\u308a\u307e\u3059\n\n \n\n-bool P\n\ntrue \u3092\u4e0e\u3048\u308b\u3068\u6700\u5927\u30d2\u30fc\u30d7\u306b\u306a\u308a\u307e\u3059\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f false \u3067\u6700\u5c0f\u30d2\u30fc\u30d7\u3067\u3059\n\n \n\n \n\n\u30e1\u30f3\u30d0\u95a2\u6570\n\n-(constructor) ()\n\n\u7a7a\u306e\u30d2\u30fc\u30d7\u3092\u69cb\u7bc9\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-top (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-pop (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u3092\u524a\u9664\u3057\u3001\u305d\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf \u511f\u5374 O(logN)\n\n \n\n-push (T data)->node_t *\n\ndata \u3092\u8981\u7d20\u3068\u3057\u3066\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\n\u8ffd\u52a0\u3055\u308c\u305f\u8981\u7d20\u3078\u306e\u30dd\u30a4\u30f3\u30bf\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-empty ()->bool\n\n\u30d2\u30fc\u30d7\u304c\u7a7a\u304b\u3069\u3046\u304b\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-size ()->uint32\n\n\u8981\u7d20\u6570\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-meld (ParingHeap<T, P> &other)\n\nother \u306e\u6301\u3064\u8981\u7d20\u5168\u3066\u3092\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\nother\u306f\u7a7a\u306b\u306a\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-decrease (node_t *x, T data)\n\nx \u306e\u30ad\u30fc\u306e\u5024\u3092 data \u306b\u5909\u66f4\u3057\u307e\u3059\n\ndata \u306f\u5909\u66f4\u524d\u306e\u5024\u4ee5\u4e0b(P=true \u306a\u3089\u3070\u4ee5\u4e0a)\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n \n\n\u30e1\u30f3\u30d0\u578b\n\n-node_t\n\n\u8981\u7d20\u3092\u683c\u7d0d\u3057\u3066\u3044\u308b\u30ce\u30fc\u30c9\u306e\u578b\n\npush \u306e\u8fd4\u308a\u5024\u3068\u3057\u3066\u4e0e\u3048\u3089\u308c\u3001decrease \u306e\u969b\u306b\u4f7f\u7528\u3059\u308b\n\n \n\n \n\n\u203bN:\u8981\u7d20\u6570\n\n\u203bT \u306e\u6bd4\u8f03\u306b\u639b\u304b\u308b\u6642\u9593\u8a08\u7b97\u91cf\u3092 O(1) \u3068\u4eee\u5b9a\n\n \n\n*/\n\n \n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n \n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n \n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tnode_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t * x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tif (!x->per) {\n\n\t\t\tx->data = data;\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\tP.meld(Q[U.find(i)]);\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "164",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <array>\n\n#include <cstdint>\n\n#include <climits>\n\n#include <functional>\n\n#include <map>\n\n#include <math.h>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <stdlib.h>\n\n#include <string>\n\n#include <time.h>\n\n#include <utility>\n\n#include <vector>\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\n\n\n\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n\n\nint main(void) {\n\n\tstd::ios::sync_with_stdio(false);\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n#define SIZ 100001\n\n\tstd::priority_queue<uint32, std::vector<uint32>, std::greater<uint32>> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tstd::cin >> x >> y;\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].top());\n\n\t\t\tQ[U.find(i)].pop();\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n#include<iostream>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n\tstd::vector<uint32> roots()const {\n\n\t\tstd::vector<uint32> ret;\n\n\t\tfor (uint32 i = 0;i < tree.size();++i) {\n\n\t\t\tif (tree[i] < 0)ret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t}\n\n\tbool empty() const { return !root; }\n\n\tstd::uint_fast32_t size() const { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n\n\nint main(void)\n\n{\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<uint32>> Q(n);\n\n\tUnionFindTree T(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tuint32 a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tuint32 x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tuint32 xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x)) {\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tstd::vector<uint32> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tputs(\"0\");return 0;\n\n\t}\n\n\tuint64 cost = 0;\n\n\tPairingHeap<uint32> P;\n\n\tfor (const uint32 i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tputs(\"Impossible\");return 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < R.size();++i) {\n\n\t\tcost += P.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "165",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0,s=0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].pop());\n\n\t\t\t++s;\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (s + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n#include<iostream>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n\tstd::vector<uint32> roots()const {\n\n\t\tstd::vector<uint32> ret;\n\n\t\tfor (uint32 i = 0;i < tree.size();++i) {\n\n\t\t\tif (tree[i] < 0)ret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t}\n\n\tbool empty() const { return !root; }\n\n\tstd::uint_fast32_t size() const { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n\n\nint main(void)\n\n{\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<uint32>> Q(n);\n\n\tUnionFindTree T(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tuint32 a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tuint32 x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tuint32 xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x)) {\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tstd::vector<uint32> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tputs(\"0\");return 0;\n\n\t}\n\n\tuint64 cost = 0;\n\n\tPairingHeap<uint32> P;\n\n\tfor (const uint32 i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tputs(\"Impossible\");return 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < R.size();++i) {\n\n\t\tcost += P.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "166",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\n/*\n\n \n\ntemplate<typename T, bool P = false>\n\nclass PairingHeap;\n\n \n\nPairingHeap\u306f\u878d\u5408\u53ef\u80fd\u306a\u30d2\u30fc\u30d7(\u512a\u5148\u5ea6\u4ed8\u304d\u30ad\u30e5\u30fc)\u3067\u3059\n\n\u7a7a\u9593\u8a08\u7b97\u91cf O(N)\n\n \n\n \n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\n\n-typename T\n\noperator< \u306b\u3088\u3063\u3066\u5927\u5c0f\u304c\u5b9a\u7fa9\u3055\u308c\u305f\u69cb\u9020\u4f53\n\n\u8981\u7d20\u306e\u578b\u306b\u306a\u308a\u307e\u3059\n\n \n\n-bool P\n\ntrue \u3092\u4e0e\u3048\u308b\u3068\u6700\u5927\u30d2\u30fc\u30d7\u306b\u306a\u308a\u307e\u3059\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f false \u3067\u6700\u5c0f\u30d2\u30fc\u30d7\u3067\u3059\n\n \n\n \n\n\u30e1\u30f3\u30d0\u95a2\u6570\n\n-(constructor) ()\n\n\u7a7a\u306e\u30d2\u30fc\u30d7\u3092\u69cb\u7bc9\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-top (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-pop (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u3092\u524a\u9664\u3057\u3001\u305d\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf \u511f\u5374 O(logN)\n\n \n\n-push (T data)->node_t *\n\ndata \u3092\u8981\u7d20\u3068\u3057\u3066\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\n\u8ffd\u52a0\u3055\u308c\u305f\u8981\u7d20\u3078\u306e\u30dd\u30a4\u30f3\u30bf\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-empty ()->bool\n\n\u30d2\u30fc\u30d7\u304c\u7a7a\u304b\u3069\u3046\u304b\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-size ()->uint32\n\n\u8981\u7d20\u6570\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-meld (ParingHeap<T, P> &other)\n\nother \u306e\u6301\u3064\u8981\u7d20\u5168\u3066\u3092\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\nother\u306f\u7a7a\u306b\u306a\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-decrease (node_t *x, T data)\n\nx \u306e\u30ad\u30fc\u306e\u5024\u3092 data \u306b\u5909\u66f4\u3057\u307e\u3059\n\ndata \u306f\u5909\u66f4\u524d\u306e\u5024\u4ee5\u4e0b(P=true \u306a\u3089\u3070\u4ee5\u4e0a)\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n \n\n\u30e1\u30f3\u30d0\u578b\n\n-node_t\n\n\u8981\u7d20\u3092\u683c\u7d0d\u3057\u3066\u3044\u308b\u30ce\u30fc\u30c9\u306e\u578b\n\npush \u306e\u8fd4\u308a\u5024\u3068\u3057\u3066\u4e0e\u3048\u3089\u308c\u3001decrease \u306e\u969b\u306b\u4f7f\u7528\u3059\u308b\n\n \n\n \n\n\u203bN:\u8981\u7d20\u6570\n\n\u203bT \u306e\u6bd4\u8f03\u306b\u639b\u304b\u308b\u6642\u9593\u8a08\u7b97\u91cf\u3092 O(1) \u3068\u4eee\u5b9a\n\n \n\n*/\n\n \n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n \n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n \n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tnode_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t * x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tif (!x->per) {\n\n\t\t\tx->data = data;\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\tP.meld(Q[U.find(i)]);\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n#include<iostream>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n\tstd::vector<uint32> roots()const {\n\n\t\tstd::vector<uint32> ret;\n\n\t\tfor (uint32 i = 0;i < tree.size();++i) {\n\n\t\t\tif (tree[i] < 0)ret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t}\n\n\tbool empty() const { return !root; }\n\n\tstd::uint_fast32_t size() const { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n\n\nint main(void)\n\n{\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<uint32>> Q(n);\n\n\tUnionFindTree T(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tuint32 a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tuint32 x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tuint32 xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x)) {\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tstd::vector<uint32> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tputs(\"0\");return 0;\n\n\t}\n\n\tuint64 cost = 0;\n\n\tPairingHeap<uint32> P;\n\n\tfor (const uint32 i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tputs(\"Impossible\");return 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < R.size();++i) {\n\n\t\tcost += P.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "167",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <array>\n\n#include <cstdint>\n\n#include <climits>\n\n#include <functional>\n\n#include <map>\n\n#include <math.h>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <stdlib.h>\n\n#include <string>\n\n#include <time.h>\n\n#include <utility>\n\n#include <vector>\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\n\n\n\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n\n\nint main(void) {\n\n\tstd::ios::sync_with_stdio(false);\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n#define SIZ 100001\n\n\tstd::priority_queue<uint32, std::vector<uint32>, std::greater<uint32>> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tstd::cin >> x >> y;\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].top());\n\n\t\t\tQ[U.find(i)].pop();\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n  using int32 = std::int_fast32_t;\n\n  using uint32 = std::uint_fast32_t;\n\n  std::vector<int32> tree;\n\n\n\npublic:\n\n  UnionFindTree(uint32 size) : tree(size, -1) {}\n\n  uint32 find(const uint32 x) {\n\n    if (tree[x] < 0)\n\n      return x;\n\n    return tree[x] = (int32)find((uint32)tree[x]);\n\n  }\n\n  bool unite(uint32 x, uint32 y) {\n\n    x = find(x);\n\n    y = find(y);\n\n    if (x == y)\n\n      return false;\n\n    if (tree[x] > tree[y])\n\n      std::swap(x, y);\n\n    tree[x] += tree[y];\n\n    tree[y] = (int32)x;\n\n    return true;\n\n  }\n\n  uint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n  bool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n  std::vector<uint32> roots() const {\n\n    std::vector<uint32> ret;\n\n    for (uint32 i = 0; i < tree.size(); ++i) {\n\n      if (tree[i] < 0)\n\n        ret.push_back(i);\n\n    }\n\n    return ret;\n\n  }\n\n};\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n  static constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n  struct node_t {\n\n    T data;\n\n    node_t *left, *right;\n\n  };\n\n  node_t *root;\n\n  std::uint_fast32_t size_;\n\n  static node_t *merge(node_t *x, node_t *y) {\n\n    if (P ^ (x->data < y->data))\n\n      std::swap(x, y);\n\n    x->right = y->left;\n\n    y->left = x;\n\n    return y;\n\n  }\n\n\n\npublic:\n\n  PairingHeap() : root(nullptr), size_(0) {}\n\n  const T &top() const {\n\n    assert(root);\n\n    return root->data;\n\n  }\n\n  const T &pop() {\n\n    assert(root);\n\n    --size_;\n\n    const T &ret = root->data;\n\n    node_t *n = nullptr, *x = root->left, *y;\n\n    while (x) {\n\n      y = x;\n\n      if (x->right) {\n\n        x = x->right->right;\n\n        y = merge(y, y->right);\n\n      } else {\n\n        x = nullptr;\n\n      }\n\n      y->right = n;\n\n      n = y;\n\n    }\n\n    if (!n) {\n\n      root = nullptr;\n\n      return ret;\n\n    }\n\n    root = n;\n\n    n = n->right;\n\n    while (n) {\n\n      x = n;\n\n      n = n->right;\n\n      root = merge(root, x);\n\n    }\n\n    return ret;\n\n  }\n\n  void push(const T &data) {\n\n    static node_t *pool = nullptr;\n\n    static std::uint_fast64_t it = ALLOCSIZE;\n\n    if (it == ALLOCSIZE) {\n\n      pool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n      it = 0;\n\n    }\n\n    node_t *top = &pool[it++];\n\n    top->data = data;\n\n    top->left = nullptr;\n\n    root = root ? merge(root, top) : top;\n\n    ++size_;\n\n  }\n\n  bool empty() const { return !root; }\n\n  std::uint_fast32_t size() const { return size_; }\n\n  void meld(PairingHeap<T, P> &other) {\n\n    size_ += other.size_;\n\n    other.size_ = 0;\n\n    if (other.root) {\n\n      root = root ? merge(root, other.root) : other.root;\n\n      other.root = nullptr;\n\n    }\n\n  }\n\n};\n\n\n\nint main(void) {\n\n  uint32 n, m;\n\n  std::cin >> n >> m;\n\n  std::vector<PairingHeap<uint32>> Q(n);\n\n  UnionFindTree T(n);\n\n  for (uint32 i = 0; i < n; ++i) {\n\n    uint32 a;\n\n    std::cin >> a;\n\n    Q[i].push(a);\n\n  }\n\n  for (uint32 i = 0; i < m; ++i) {\n\n    uint32 x, y;\n\n    std::cin >> x >> y;\n\n    uint32 xr = T.find(x), yr = T.find(y);\n\n    if (T.unite(x, y)) {\n\n      if (xr == T.find(x))\n\n        Q[xr].meld(Q[yr]);\n\n      else\n\n        Q[yr].meld(Q[xr]);\n\n    }\n\n  }\n\n  std::vector<uint32> R = T.roots();\n\n  if (R.size() == 1) {\n\n    puts(\"0\");\n\n    return 0;\n\n  }\n\n  uint64 cost = 0;\n\n  PairingHeap<uint32> P;\n\n  for (const uint32 i : R) {\n\n    cost += Q[i].pop();\n\n    P.meld(Q[i]);\n\n  }\n\n  if (P.size() + 2 < R.size()) {\n\n    puts(\"Impossible\");\n\n    return 0;\n\n  }\n\n  for (uint32 i = 2; i < R.size(); ++i)\n\n    cost += P.pop();\n\n  std::cout << cost << \"\\n\";\n\n  return 0;\n\n}"
    },
    {
        "id": "168",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0,s=0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].pop());\n\n\t\t\t++s;\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (s + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n  using int32 = std::int_fast32_t;\n\n  using uint32 = std::uint_fast32_t;\n\n  std::vector<int32> tree;\n\n\n\npublic:\n\n  UnionFindTree(uint32 size) : tree(size, -1) {}\n\n  uint32 find(const uint32 x) {\n\n    if (tree[x] < 0)\n\n      return x;\n\n    return tree[x] = (int32)find((uint32)tree[x]);\n\n  }\n\n  bool unite(uint32 x, uint32 y) {\n\n    x = find(x);\n\n    y = find(y);\n\n    if (x == y)\n\n      return false;\n\n    if (tree[x] > tree[y])\n\n      std::swap(x, y);\n\n    tree[x] += tree[y];\n\n    tree[y] = (int32)x;\n\n    return true;\n\n  }\n\n  uint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n  bool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n  std::vector<uint32> roots() const {\n\n    std::vector<uint32> ret;\n\n    for (uint32 i = 0; i < tree.size(); ++i) {\n\n      if (tree[i] < 0)\n\n        ret.push_back(i);\n\n    }\n\n    return ret;\n\n  }\n\n};\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n  static constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n  struct node_t {\n\n    T data;\n\n    node_t *left, *right;\n\n  };\n\n  node_t *root;\n\n  std::uint_fast32_t size_;\n\n  static node_t *merge(node_t *x, node_t *y) {\n\n    if (P ^ (x->data < y->data))\n\n      std::swap(x, y);\n\n    x->right = y->left;\n\n    y->left = x;\n\n    return y;\n\n  }\n\n\n\npublic:\n\n  PairingHeap() : root(nullptr), size_(0) {}\n\n  const T &top() const {\n\n    assert(root);\n\n    return root->data;\n\n  }\n\n  const T &pop() {\n\n    assert(root);\n\n    --size_;\n\n    const T &ret = root->data;\n\n    node_t *n = nullptr, *x = root->left, *y;\n\n    while (x) {\n\n      y = x;\n\n      if (x->right) {\n\n        x = x->right->right;\n\n        y = merge(y, y->right);\n\n      } else {\n\n        x = nullptr;\n\n      }\n\n      y->right = n;\n\n      n = y;\n\n    }\n\n    if (!n) {\n\n      root = nullptr;\n\n      return ret;\n\n    }\n\n    root = n;\n\n    n = n->right;\n\n    while (n) {\n\n      x = n;\n\n      n = n->right;\n\n      root = merge(root, x);\n\n    }\n\n    return ret;\n\n  }\n\n  void push(const T &data) {\n\n    static node_t *pool = nullptr;\n\n    static std::uint_fast64_t it = ALLOCSIZE;\n\n    if (it == ALLOCSIZE) {\n\n      pool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n      it = 0;\n\n    }\n\n    node_t *top = &pool[it++];\n\n    top->data = data;\n\n    top->left = nullptr;\n\n    root = root ? merge(root, top) : top;\n\n    ++size_;\n\n  }\n\n  bool empty() const { return !root; }\n\n  std::uint_fast32_t size() const { return size_; }\n\n  void meld(PairingHeap<T, P> &other) {\n\n    size_ += other.size_;\n\n    other.size_ = 0;\n\n    if (other.root) {\n\n      root = root ? merge(root, other.root) : other.root;\n\n      other.root = nullptr;\n\n    }\n\n  }\n\n};\n\n\n\nint main(void) {\n\n  uint32 n, m;\n\n  std::cin >> n >> m;\n\n  std::vector<PairingHeap<uint32>> Q(n);\n\n  UnionFindTree T(n);\n\n  for (uint32 i = 0; i < n; ++i) {\n\n    uint32 a;\n\n    std::cin >> a;\n\n    Q[i].push(a);\n\n  }\n\n  for (uint32 i = 0; i < m; ++i) {\n\n    uint32 x, y;\n\n    std::cin >> x >> y;\n\n    uint32 xr = T.find(x), yr = T.find(y);\n\n    if (T.unite(x, y)) {\n\n      if (xr == T.find(x))\n\n        Q[xr].meld(Q[yr]);\n\n      else\n\n        Q[yr].meld(Q[xr]);\n\n    }\n\n  }\n\n  std::vector<uint32> R = T.roots();\n\n  if (R.size() == 1) {\n\n    puts(\"0\");\n\n    return 0;\n\n  }\n\n  uint64 cost = 0;\n\n  PairingHeap<uint32> P;\n\n  for (const uint32 i : R) {\n\n    cost += Q[i].pop();\n\n    P.meld(Q[i]);\n\n  }\n\n  if (P.size() + 2 < R.size()) {\n\n    puts(\"Impossible\");\n\n    return 0;\n\n  }\n\n  for (uint32 i = 2; i < R.size(); ++i)\n\n    cost += P.pop();\n\n  std::cout << cost << \"\\n\";\n\n  return 0;\n\n}"
    },
    {
        "id": "169",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\n/*\n\n \n\ntemplate<typename T, bool P = false>\n\nclass PairingHeap;\n\n \n\nPairingHeap\u306f\u878d\u5408\u53ef\u80fd\u306a\u30d2\u30fc\u30d7(\u512a\u5148\u5ea6\u4ed8\u304d\u30ad\u30e5\u30fc)\u3067\u3059\n\n\u7a7a\u9593\u8a08\u7b97\u91cf O(N)\n\n \n\n \n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\n\n-typename T\n\noperator< \u306b\u3088\u3063\u3066\u5927\u5c0f\u304c\u5b9a\u7fa9\u3055\u308c\u305f\u69cb\u9020\u4f53\n\n\u8981\u7d20\u306e\u578b\u306b\u306a\u308a\u307e\u3059\n\n \n\n-bool P\n\ntrue \u3092\u4e0e\u3048\u308b\u3068\u6700\u5927\u30d2\u30fc\u30d7\u306b\u306a\u308a\u307e\u3059\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f false \u3067\u6700\u5c0f\u30d2\u30fc\u30d7\u3067\u3059\n\n \n\n \n\n\u30e1\u30f3\u30d0\u95a2\u6570\n\n-(constructor) ()\n\n\u7a7a\u306e\u30d2\u30fc\u30d7\u3092\u69cb\u7bc9\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-top (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-pop (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u3092\u524a\u9664\u3057\u3001\u305d\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf \u511f\u5374 O(logN)\n\n \n\n-push (T data)->node_t *\n\ndata \u3092\u8981\u7d20\u3068\u3057\u3066\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\n\u8ffd\u52a0\u3055\u308c\u305f\u8981\u7d20\u3078\u306e\u30dd\u30a4\u30f3\u30bf\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-empty ()->bool\n\n\u30d2\u30fc\u30d7\u304c\u7a7a\u304b\u3069\u3046\u304b\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-size ()->uint32\n\n\u8981\u7d20\u6570\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-meld (ParingHeap<T, P> &other)\n\nother \u306e\u6301\u3064\u8981\u7d20\u5168\u3066\u3092\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\nother\u306f\u7a7a\u306b\u306a\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-decrease (node_t *x, T data)\n\nx \u306e\u30ad\u30fc\u306e\u5024\u3092 data \u306b\u5909\u66f4\u3057\u307e\u3059\n\ndata \u306f\u5909\u66f4\u524d\u306e\u5024\u4ee5\u4e0b(P=true \u306a\u3089\u3070\u4ee5\u4e0a)\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n \n\n\u30e1\u30f3\u30d0\u578b\n\n-node_t\n\n\u8981\u7d20\u3092\u683c\u7d0d\u3057\u3066\u3044\u308b\u30ce\u30fc\u30c9\u306e\u578b\n\npush \u306e\u8fd4\u308a\u5024\u3068\u3057\u3066\u4e0e\u3048\u3089\u308c\u3001decrease \u306e\u969b\u306b\u4f7f\u7528\u3059\u308b\n\n \n\n \n\n\u203bN:\u8981\u7d20\u6570\n\n\u203bT \u306e\u6bd4\u8f03\u306b\u639b\u304b\u308b\u6642\u9593\u8a08\u7b97\u91cf\u3092 O(1) \u3068\u4eee\u5b9a\n\n \n\n*/\n\n \n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n \n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n \n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tnode_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t * x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tif (!x->per) {\n\n\t\t\tx->data = data;\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\tP.meld(Q[U.find(i)]);\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n  using int32 = std::int_fast32_t;\n\n  using uint32 = std::uint_fast32_t;\n\n  std::vector<int32> tree;\n\n\n\npublic:\n\n  UnionFindTree(uint32 size) : tree(size, -1) {}\n\n  uint32 find(const uint32 x) {\n\n    if (tree[x] < 0)\n\n      return x;\n\n    return tree[x] = (int32)find((uint32)tree[x]);\n\n  }\n\n  bool unite(uint32 x, uint32 y) {\n\n    x = find(x);\n\n    y = find(y);\n\n    if (x == y)\n\n      return false;\n\n    if (tree[x] > tree[y])\n\n      std::swap(x, y);\n\n    tree[x] += tree[y];\n\n    tree[y] = (int32)x;\n\n    return true;\n\n  }\n\n  uint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n  bool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n  std::vector<uint32> roots() const {\n\n    std::vector<uint32> ret;\n\n    for (uint32 i = 0; i < tree.size(); ++i) {\n\n      if (tree[i] < 0)\n\n        ret.push_back(i);\n\n    }\n\n    return ret;\n\n  }\n\n};\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n  static constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n  struct node_t {\n\n    T data;\n\n    node_t *left, *right;\n\n  };\n\n  node_t *root;\n\n  std::uint_fast32_t size_;\n\n  static node_t *merge(node_t *x, node_t *y) {\n\n    if (P ^ (x->data < y->data))\n\n      std::swap(x, y);\n\n    x->right = y->left;\n\n    y->left = x;\n\n    return y;\n\n  }\n\n\n\npublic:\n\n  PairingHeap() : root(nullptr), size_(0) {}\n\n  const T &top() const {\n\n    assert(root);\n\n    return root->data;\n\n  }\n\n  const T &pop() {\n\n    assert(root);\n\n    --size_;\n\n    const T &ret = root->data;\n\n    node_t *n = nullptr, *x = root->left, *y;\n\n    while (x) {\n\n      y = x;\n\n      if (x->right) {\n\n        x = x->right->right;\n\n        y = merge(y, y->right);\n\n      } else {\n\n        x = nullptr;\n\n      }\n\n      y->right = n;\n\n      n = y;\n\n    }\n\n    if (!n) {\n\n      root = nullptr;\n\n      return ret;\n\n    }\n\n    root = n;\n\n    n = n->right;\n\n    while (n) {\n\n      x = n;\n\n      n = n->right;\n\n      root = merge(root, x);\n\n    }\n\n    return ret;\n\n  }\n\n  void push(const T &data) {\n\n    static node_t *pool = nullptr;\n\n    static std::uint_fast64_t it = ALLOCSIZE;\n\n    if (it == ALLOCSIZE) {\n\n      pool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n      it = 0;\n\n    }\n\n    node_t *top = &pool[it++];\n\n    top->data = data;\n\n    top->left = nullptr;\n\n    root = root ? merge(root, top) : top;\n\n    ++size_;\n\n  }\n\n  bool empty() const { return !root; }\n\n  std::uint_fast32_t size() const { return size_; }\n\n  void meld(PairingHeap<T, P> &other) {\n\n    size_ += other.size_;\n\n    other.size_ = 0;\n\n    if (other.root) {\n\n      root = root ? merge(root, other.root) : other.root;\n\n      other.root = nullptr;\n\n    }\n\n  }\n\n};\n\n\n\nint main(void) {\n\n  uint32 n, m;\n\n  std::cin >> n >> m;\n\n  std::vector<PairingHeap<uint32>> Q(n);\n\n  UnionFindTree T(n);\n\n  for (uint32 i = 0; i < n; ++i) {\n\n    uint32 a;\n\n    std::cin >> a;\n\n    Q[i].push(a);\n\n  }\n\n  for (uint32 i = 0; i < m; ++i) {\n\n    uint32 x, y;\n\n    std::cin >> x >> y;\n\n    uint32 xr = T.find(x), yr = T.find(y);\n\n    if (T.unite(x, y)) {\n\n      if (xr == T.find(x))\n\n        Q[xr].meld(Q[yr]);\n\n      else\n\n        Q[yr].meld(Q[xr]);\n\n    }\n\n  }\n\n  std::vector<uint32> R = T.roots();\n\n  if (R.size() == 1) {\n\n    puts(\"0\");\n\n    return 0;\n\n  }\n\n  uint64 cost = 0;\n\n  PairingHeap<uint32> P;\n\n  for (const uint32 i : R) {\n\n    cost += Q[i].pop();\n\n    P.meld(Q[i]);\n\n  }\n\n  if (P.size() + 2 < R.size()) {\n\n    puts(\"Impossible\");\n\n    return 0;\n\n  }\n\n  for (uint32 i = 2; i < R.size(); ++i)\n\n    cost += P.pop();\n\n  std::cout << cost << \"\\n\";\n\n  return 0;\n\n}"
    },
    {
        "id": "170",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <array>\n\n#include <cstdint>\n\n#include <climits>\n\n#include <functional>\n\n#include <map>\n\n#include <math.h>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <stdlib.h>\n\n#include <string>\n\n#include <time.h>\n\n#include <utility>\n\n#include <vector>\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\n\n\n\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n\n\nint main(void) {\n\n\tstd::ios::sync_with_stdio(false);\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n#define SIZ 100001\n\n\tstd::priority_queue<uint32, std::vector<uint32>, std::greater<uint32>> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tstd::cin >> x >> y;\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].top());\n\n\t\t\tQ[U.find(i)].pop();\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n\tstd::vector<uint32> roots() const {\n\n\t\tstd::vector<uint32> ret;\n\n\t\tfor (uint32 i = 0; i < tree.size(); ++i) {\n\n\t\t\tif (tree[i] < 0)\n\n\t\t\t\tret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n\n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tconst node_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t *const x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tif (!x->per) {\n\n\t\t\tx->data = data;\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n\n\nint main(void) {\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<uint32>> Q(n);\n\n\tUnionFindTree T(n);\n\n\tfor (uint32 i = 0; i < n; ++i) {\n\n\t\tuint32 a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (uint32 i = 0; i < m; ++i) {\n\n\t\tuint32 x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tuint32 xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x))\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\telse\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t}\n\n\t}\n\n\tstd::vector<uint32> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tuint64 cost = 0;\n\n\tPairingHeap<uint32> P;\n\n\tfor (const uint32 i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2; i < R.size(); ++i)\n\n\t\tcost += P.pop();\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}"
    },
    {
        "id": "171",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0,s=0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].pop());\n\n\t\t\t++s;\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (s + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n\tstd::vector<uint32> roots() const {\n\n\t\tstd::vector<uint32> ret;\n\n\t\tfor (uint32 i = 0; i < tree.size(); ++i) {\n\n\t\t\tif (tree[i] < 0)\n\n\t\t\t\tret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n\n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tconst node_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t *const x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tif (!x->per) {\n\n\t\t\tx->data = data;\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n\n\nint main(void) {\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<uint32>> Q(n);\n\n\tUnionFindTree T(n);\n\n\tfor (uint32 i = 0; i < n; ++i) {\n\n\t\tuint32 a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (uint32 i = 0; i < m; ++i) {\n\n\t\tuint32 x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tuint32 xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x))\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\telse\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t}\n\n\t}\n\n\tstd::vector<uint32> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tuint64 cost = 0;\n\n\tPairingHeap<uint32> P;\n\n\tfor (const uint32 i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2; i < R.size(); ++i)\n\n\t\tcost += P.pop();\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}"
    },
    {
        "id": "172",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\n/*\n\n \n\ntemplate<typename T, bool P = false>\n\nclass PairingHeap;\n\n \n\nPairingHeap\u306f\u878d\u5408\u53ef\u80fd\u306a\u30d2\u30fc\u30d7(\u512a\u5148\u5ea6\u4ed8\u304d\u30ad\u30e5\u30fc)\u3067\u3059\n\n\u7a7a\u9593\u8a08\u7b97\u91cf O(N)\n\n \n\n \n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\n\n-typename T\n\noperator< \u306b\u3088\u3063\u3066\u5927\u5c0f\u304c\u5b9a\u7fa9\u3055\u308c\u305f\u69cb\u9020\u4f53\n\n\u8981\u7d20\u306e\u578b\u306b\u306a\u308a\u307e\u3059\n\n \n\n-bool P\n\ntrue \u3092\u4e0e\u3048\u308b\u3068\u6700\u5927\u30d2\u30fc\u30d7\u306b\u306a\u308a\u307e\u3059\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f false \u3067\u6700\u5c0f\u30d2\u30fc\u30d7\u3067\u3059\n\n \n\n \n\n\u30e1\u30f3\u30d0\u95a2\u6570\n\n-(constructor) ()\n\n\u7a7a\u306e\u30d2\u30fc\u30d7\u3092\u69cb\u7bc9\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-top (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-pop (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u3092\u524a\u9664\u3057\u3001\u305d\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf \u511f\u5374 O(logN)\n\n \n\n-push (T data)->node_t *\n\ndata \u3092\u8981\u7d20\u3068\u3057\u3066\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\n\u8ffd\u52a0\u3055\u308c\u305f\u8981\u7d20\u3078\u306e\u30dd\u30a4\u30f3\u30bf\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-empty ()->bool\n\n\u30d2\u30fc\u30d7\u304c\u7a7a\u304b\u3069\u3046\u304b\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-size ()->uint32\n\n\u8981\u7d20\u6570\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-meld (ParingHeap<T, P> &other)\n\nother \u306e\u6301\u3064\u8981\u7d20\u5168\u3066\u3092\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\nother\u306f\u7a7a\u306b\u306a\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-decrease (node_t *x, T data)\n\nx \u306e\u30ad\u30fc\u306e\u5024\u3092 data \u306b\u5909\u66f4\u3057\u307e\u3059\n\ndata \u306f\u5909\u66f4\u524d\u306e\u5024\u4ee5\u4e0b(P=true \u306a\u3089\u3070\u4ee5\u4e0a)\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n \n\n\u30e1\u30f3\u30d0\u578b\n\n-node_t\n\n\u8981\u7d20\u3092\u683c\u7d0d\u3057\u3066\u3044\u308b\u30ce\u30fc\u30c9\u306e\u578b\n\npush \u306e\u8fd4\u308a\u5024\u3068\u3057\u3066\u4e0e\u3048\u3089\u308c\u3001decrease \u306e\u969b\u306b\u4f7f\u7528\u3059\u308b\n\n \n\n \n\n\u203bN:\u8981\u7d20\u6570\n\n\u203bT \u306e\u6bd4\u8f03\u306b\u639b\u304b\u308b\u6642\u9593\u8a08\u7b97\u91cf\u3092 O(1) \u3068\u4eee\u5b9a\n\n \n\n*/\n\n \n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n \n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n \n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tnode_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t * x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tif (!x->per) {\n\n\t\t\tx->data = data;\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\tP.meld(Q[U.find(i)]);\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n\tstd::vector<uint32> roots() const {\n\n\t\tstd::vector<uint32> ret;\n\n\t\tfor (uint32 i = 0; i < tree.size(); ++i) {\n\n\t\t\tif (tree[i] < 0)\n\n\t\t\t\tret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n\n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tconst node_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t *const x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tif (!x->per) {\n\n\t\t\tx->data = data;\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n\n\nint main(void) {\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<uint32>> Q(n);\n\n\tUnionFindTree T(n);\n\n\tfor (uint32 i = 0; i < n; ++i) {\n\n\t\tuint32 a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (uint32 i = 0; i < m; ++i) {\n\n\t\tuint32 x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tuint32 xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x))\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\telse\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t}\n\n\t}\n\n\tstd::vector<uint32> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tuint64 cost = 0;\n\n\tPairingHeap<uint32> P;\n\n\tfor (const uint32 i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2; i < R.size(); ++i)\n\n\t\tcost += P.pop();\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}"
    },
    {
        "id": "173",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <array>\n\n#include <cstdint>\n\n#include <climits>\n\n#include <functional>\n\n#include <map>\n\n#include <math.h>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <stdlib.h>\n\n#include <string>\n\n#include <time.h>\n\n#include <utility>\n\n#include <vector>\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\n\n\n\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n\n\nint main(void) {\n\n\tstd::ios::sync_with_stdio(false);\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n#define SIZ 100001\n\n\tstd::priority_queue<uint32, std::vector<uint32>, std::greater<uint32>> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tstd::cin >> x >> y;\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].top());\n\n\t\t\tQ[U.find(i)].pop();\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n\tstd::vector<uint32> roots() const {\n\n\t\tstd::vector<uint32> ret;\n\n\t\tfor (uint32 i = 0; i < tree.size(); ++i) {\n\n\t\t\tif (tree[i] < 0)\n\n\t\t\t\tret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t}\n\n\tbool empty() const { return !root; }\n\n\tstd::uint_fast32_t size() const { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n\n\nint main(void) {\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<uint32>> Q(n);\n\n\tUnionFindTree T(n);\n\n\tfor (uint32 i = 0; i < n; ++i) {\n\n\t\tuint32 a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (uint32 i = 0; i < m; ++i) {\n\n\t\tuint32 x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tuint32 xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x))\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\telse\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t}\n\n\t}\n\n\tstd::vector<uint32> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tuint64 cost = 0;\n\n\tPairingHeap<uint32> P;\n\n\tfor (const uint32 i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2; i < R.size(); ++i)\n\n\t\tcost += P.pop();\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}"
    },
    {
        "id": "174",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0,s=0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].pop());\n\n\t\t\t++s;\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (s + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n\tstd::vector<uint32> roots() const {\n\n\t\tstd::vector<uint32> ret;\n\n\t\tfor (uint32 i = 0; i < tree.size(); ++i) {\n\n\t\t\tif (tree[i] < 0)\n\n\t\t\t\tret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t}\n\n\tbool empty() const { return !root; }\n\n\tstd::uint_fast32_t size() const { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n\n\nint main(void) {\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<uint32>> Q(n);\n\n\tUnionFindTree T(n);\n\n\tfor (uint32 i = 0; i < n; ++i) {\n\n\t\tuint32 a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (uint32 i = 0; i < m; ++i) {\n\n\t\tuint32 x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tuint32 xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x))\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\telse\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t}\n\n\t}\n\n\tstd::vector<uint32> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tuint64 cost = 0;\n\n\tPairingHeap<uint32> P;\n\n\tfor (const uint32 i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2; i < R.size(); ++i)\n\n\t\tcost += P.pop();\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}"
    },
    {
        "id": "175",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\n/*\n\n \n\ntemplate<typename T, bool P = false>\n\nclass PairingHeap;\n\n \n\nPairingHeap\u306f\u878d\u5408\u53ef\u80fd\u306a\u30d2\u30fc\u30d7(\u512a\u5148\u5ea6\u4ed8\u304d\u30ad\u30e5\u30fc)\u3067\u3059\n\n\u7a7a\u9593\u8a08\u7b97\u91cf O(N)\n\n \n\n \n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\n\n-typename T\n\noperator< \u306b\u3088\u3063\u3066\u5927\u5c0f\u304c\u5b9a\u7fa9\u3055\u308c\u305f\u69cb\u9020\u4f53\n\n\u8981\u7d20\u306e\u578b\u306b\u306a\u308a\u307e\u3059\n\n \n\n-bool P\n\ntrue \u3092\u4e0e\u3048\u308b\u3068\u6700\u5927\u30d2\u30fc\u30d7\u306b\u306a\u308a\u307e\u3059\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f false \u3067\u6700\u5c0f\u30d2\u30fc\u30d7\u3067\u3059\n\n \n\n \n\n\u30e1\u30f3\u30d0\u95a2\u6570\n\n-(constructor) ()\n\n\u7a7a\u306e\u30d2\u30fc\u30d7\u3092\u69cb\u7bc9\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-top (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-pop (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u3092\u524a\u9664\u3057\u3001\u305d\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf \u511f\u5374 O(logN)\n\n \n\n-push (T data)->node_t *\n\ndata \u3092\u8981\u7d20\u3068\u3057\u3066\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\n\u8ffd\u52a0\u3055\u308c\u305f\u8981\u7d20\u3078\u306e\u30dd\u30a4\u30f3\u30bf\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-empty ()->bool\n\n\u30d2\u30fc\u30d7\u304c\u7a7a\u304b\u3069\u3046\u304b\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-size ()->uint32\n\n\u8981\u7d20\u6570\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-meld (ParingHeap<T, P> &other)\n\nother \u306e\u6301\u3064\u8981\u7d20\u5168\u3066\u3092\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\nother\u306f\u7a7a\u306b\u306a\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-decrease (node_t *x, T data)\n\nx \u306e\u30ad\u30fc\u306e\u5024\u3092 data \u306b\u5909\u66f4\u3057\u307e\u3059\n\ndata \u306f\u5909\u66f4\u524d\u306e\u5024\u4ee5\u4e0b(P=true \u306a\u3089\u3070\u4ee5\u4e0a)\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n \n\n\u30e1\u30f3\u30d0\u578b\n\n-node_t\n\n\u8981\u7d20\u3092\u683c\u7d0d\u3057\u3066\u3044\u308b\u30ce\u30fc\u30c9\u306e\u578b\n\npush \u306e\u8fd4\u308a\u5024\u3068\u3057\u3066\u4e0e\u3048\u3089\u308c\u3001decrease \u306e\u969b\u306b\u4f7f\u7528\u3059\u308b\n\n \n\n \n\n\u203bN:\u8981\u7d20\u6570\n\n\u203bT \u306e\u6bd4\u8f03\u306b\u639b\u304b\u308b\u6642\u9593\u8a08\u7b97\u91cf\u3092 O(1) \u3068\u4eee\u5b9a\n\n \n\n*/\n\n \n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n \n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n \n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tnode_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t * x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tif (!x->per) {\n\n\t\t\tx->data = data;\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\tP.meld(Q[U.find(i)]);\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n\tstd::vector<uint32> roots() const {\n\n\t\tstd::vector<uint32> ret;\n\n\t\tfor (uint32 i = 0; i < tree.size(); ++i) {\n\n\t\t\tif (tree[i] < 0)\n\n\t\t\t\tret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t}\n\n\tbool empty() const { return !root; }\n\n\tstd::uint_fast32_t size() const { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n\n\nint main(void) {\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<uint32>> Q(n);\n\n\tUnionFindTree T(n);\n\n\tfor (uint32 i = 0; i < n; ++i) {\n\n\t\tuint32 a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (uint32 i = 0; i < m; ++i) {\n\n\t\tuint32 x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tuint32 xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x))\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\telse\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t}\n\n\t}\n\n\tstd::vector<uint32> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tuint64 cost = 0;\n\n\tPairingHeap<uint32> P;\n\n\tfor (const uint32 i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2; i < R.size(); ++i)\n\n\t\tcost += P.pop();\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}"
    },
    {
        "id": "176",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <array>\n\n#include <cstdint>\n\n#include <climits>\n\n#include <functional>\n\n#include <map>\n\n#include <math.h>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <stdlib.h>\n\n#include <string>\n\n#include <time.h>\n\n#include <utility>\n\n#include <vector>\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\n\n\n\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n\n\nint main(void) {\n\n\tstd::ios::sync_with_stdio(false);\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n#define SIZ 100001\n\n\tstd::priority_queue<uint32, std::vector<uint32>, std::greater<uint32>> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tstd::cin >> x >> y;\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].top());\n\n\t\t\tQ[U.find(i)].pop();\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n\tstd::vector<uint32> roots() const {\n\n\t\tstd::vector<uint32> ret;\n\n\t\tfor (uint32 i = 0; i < tree.size(); ++i) {\n\n\t\t\tif (tree[i] < 0)\n\n\t\t\t\tret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n\n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tnode_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t *const x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tx->data = data;\n\n\t\tif (!x->per)\n\n\t\t\treturn;\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n\n\nint main(void) {\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<uint32>> Q(n);\n\n\tUnionFindTree T(n);\n\n\tfor (uint32 i = 0; i < n; ++i) {\n\n\t\tuint32 a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (uint32 i = 0; i < m; ++i) {\n\n\t\tuint32 x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tuint32 xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x))\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\telse\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t}\n\n\t}\n\n\tstd::vector<uint32> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tuint64 cost = 0;\n\n\tPairingHeap<uint32> P;\n\n\tfor (const uint32 i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2; i < R.size(); ++i)\n\n\t\tcost += P.pop();\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}"
    },
    {
        "id": "177",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0,s=0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].pop());\n\n\t\t\t++s;\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (s + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n\tstd::vector<uint32> roots() const {\n\n\t\tstd::vector<uint32> ret;\n\n\t\tfor (uint32 i = 0; i < tree.size(); ++i) {\n\n\t\t\tif (tree[i] < 0)\n\n\t\t\t\tret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n\n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tnode_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t *const x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tx->data = data;\n\n\t\tif (!x->per)\n\n\t\t\treturn;\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n\n\nint main(void) {\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<uint32>> Q(n);\n\n\tUnionFindTree T(n);\n\n\tfor (uint32 i = 0; i < n; ++i) {\n\n\t\tuint32 a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (uint32 i = 0; i < m; ++i) {\n\n\t\tuint32 x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tuint32 xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x))\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\telse\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t}\n\n\t}\n\n\tstd::vector<uint32> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tuint64 cost = 0;\n\n\tPairingHeap<uint32> P;\n\n\tfor (const uint32 i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2; i < R.size(); ++i)\n\n\t\tcost += P.pop();\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}"
    },
    {
        "id": "178",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\n/*\n\n \n\ntemplate<typename T, bool P = false>\n\nclass PairingHeap;\n\n \n\nPairingHeap\u306f\u878d\u5408\u53ef\u80fd\u306a\u30d2\u30fc\u30d7(\u512a\u5148\u5ea6\u4ed8\u304d\u30ad\u30e5\u30fc)\u3067\u3059\n\n\u7a7a\u9593\u8a08\u7b97\u91cf O(N)\n\n \n\n \n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\n\n-typename T\n\noperator< \u306b\u3088\u3063\u3066\u5927\u5c0f\u304c\u5b9a\u7fa9\u3055\u308c\u305f\u69cb\u9020\u4f53\n\n\u8981\u7d20\u306e\u578b\u306b\u306a\u308a\u307e\u3059\n\n \n\n-bool P\n\ntrue \u3092\u4e0e\u3048\u308b\u3068\u6700\u5927\u30d2\u30fc\u30d7\u306b\u306a\u308a\u307e\u3059\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f false \u3067\u6700\u5c0f\u30d2\u30fc\u30d7\u3067\u3059\n\n \n\n \n\n\u30e1\u30f3\u30d0\u95a2\u6570\n\n-(constructor) ()\n\n\u7a7a\u306e\u30d2\u30fc\u30d7\u3092\u69cb\u7bc9\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-top (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-pop (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u3092\u524a\u9664\u3057\u3001\u305d\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf \u511f\u5374 O(logN)\n\n \n\n-push (T data)->node_t *\n\ndata \u3092\u8981\u7d20\u3068\u3057\u3066\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\n\u8ffd\u52a0\u3055\u308c\u305f\u8981\u7d20\u3078\u306e\u30dd\u30a4\u30f3\u30bf\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-empty ()->bool\n\n\u30d2\u30fc\u30d7\u304c\u7a7a\u304b\u3069\u3046\u304b\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-size ()->uint32\n\n\u8981\u7d20\u6570\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-meld (ParingHeap<T, P> &other)\n\nother \u306e\u6301\u3064\u8981\u7d20\u5168\u3066\u3092\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\nother\u306f\u7a7a\u306b\u306a\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-decrease (node_t *x, T data)\n\nx \u306e\u30ad\u30fc\u306e\u5024\u3092 data \u306b\u5909\u66f4\u3057\u307e\u3059\n\ndata \u306f\u5909\u66f4\u524d\u306e\u5024\u4ee5\u4e0b(P=true \u306a\u3089\u3070\u4ee5\u4e0a)\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n \n\n\u30e1\u30f3\u30d0\u578b\n\n-node_t\n\n\u8981\u7d20\u3092\u683c\u7d0d\u3057\u3066\u3044\u308b\u30ce\u30fc\u30c9\u306e\u578b\n\npush \u306e\u8fd4\u308a\u5024\u3068\u3057\u3066\u4e0e\u3048\u3089\u308c\u3001decrease \u306e\u969b\u306b\u4f7f\u7528\u3059\u308b\n\n \n\n \n\n\u203bN:\u8981\u7d20\u6570\n\n\u203bT \u306e\u6bd4\u8f03\u306b\u639b\u304b\u308b\u6642\u9593\u8a08\u7b97\u91cf\u3092 O(1) \u3068\u4eee\u5b9a\n\n \n\n*/\n\n \n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n \n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n \n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tnode_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t * x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tif (!x->per) {\n\n\t\t\tx->data = data;\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\tP.meld(Q[U.find(i)]);\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\n\n\nstatic constexpr double PI = 3.1415926535897932;\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n\tstd::vector<uint32> roots() const {\n\n\t\tstd::vector<uint32> ret;\n\n\t\tfor (uint32 i = 0; i < tree.size(); ++i) {\n\n\t\t\tif (tree[i] < 0)\n\n\t\t\t\tret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n\n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tnode_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t *const x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tx->data = data;\n\n\t\tif (!x->per)\n\n\t\t\treturn;\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n\n\nint main(void) {\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<uint32>> Q(n);\n\n\tUnionFindTree T(n);\n\n\tfor (uint32 i = 0; i < n; ++i) {\n\n\t\tuint32 a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (uint32 i = 0; i < m; ++i) {\n\n\t\tuint32 x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tuint32 xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x))\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\telse\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t}\n\n\t}\n\n\tstd::vector<uint32> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tuint64 cost = 0;\n\n\tPairingHeap<uint32> P;\n\n\tfor (const uint32 i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2; i < R.size(); ++i)\n\n\t\tcost += P.pop();\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}"
    },
    {
        "id": "179",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <array>\n\n#include <cstdint>\n\n#include <climits>\n\n#include <functional>\n\n#include <map>\n\n#include <math.h>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <stdlib.h>\n\n#include <string>\n\n#include <time.h>\n\n#include <utility>\n\n#include <vector>\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\n\n\n\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n\n\nint main(void) {\n\n\tstd::ios::sync_with_stdio(false);\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n#define SIZ 100001\n\n\tstd::priority_queue<uint32, std::vector<uint32>, std::greater<uint32>> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tstd::cin >> x >> y;\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].top());\n\n\t\t\tQ[U.find(i)].pop();\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <utility>\n\n#include <vector>\n\n\n\nclass UnionFind {\n\n\n\npublic:\n\n\tusing size_type = std::uint_fast32_t;\n\n\n\nprivate:\n\n\tstd::vector<std::pair<bool, size_type>> tree;\n\n\n\npublic:\n\n\tUnionFind(const size_type size) : tree(size, std::make_pair(1, 1)) {}\n\n\tsize_type find(const size_type x) {\n\n\t\tassert(x < tree.size());\n\n\t\tif (tree[x].first)\n\n\t\t\treturn x;\n\n\t\treturn tree[x].second = find(tree[x].second);\n\n\t}\n\n\tbool unite(size_type x, size_type y) {\n\n\t\tassert(x < tree.size());\n\n\t\tassert(y < tree.size());\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x].second < tree[y].second)\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x].second += tree[y].second;\n\n\t\ttree[y] = std::make_pair(0, x);\n\n\t\treturn true;\n\n\t}\n\n\tbool same(const size_type x, const size_type y) {\n\n\t\tassert(x < tree.size());\n\n\t\tassert(y < tree.size());\n\n\t\treturn find(x) == find(y);\n\n\t}\n\n\tsize_type size(const size_type x) {\n\n\t\tassert(x < tree.size());\n\n\t\treturn tree[find(x)].second;\n\n\t}\n\n\tstd::vector<size_type> roots() const {\n\n\t\tstd::vector<size_type> ret;\n\n\t\tfor (size_type i = 0; i < tree.size(); ++i) {\n\n\t\t\tif (tree[i].first)\n\n\t\t\t\tret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\n#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <functional>\n\n#include <utility>\n\n\n\ntemplate <typename T, class Compare = std::greater<T>> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\n\npublic:\n\n\tusing value_type = T;\n\n\tusing reference = value_type &;\n\n\tusing const_reference = const value_type &;\n\n\tusing size_type = std::uint_fast32_t;\n\n\n\nprivate:\n\n\tstruct node_t {\n\n\t\tvalue_type data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tsize_type size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tstatic const Compare comp=Compare();\n\n\t\tif (comp(y->data, x->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst_reference top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst_reference pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst_reference ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse\n\n\t\t\t\tx = nullptr;\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const_reference data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t}\n\n\tbool empty() const { return !root; }\n\n\tsize_type size() const { return size_; }\n\n\tvoid meld(PairingHeap<T, Compare> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n\n\n\n\n#include<iostream>\n\n#include<vector>\n\nint main(void) {\n\n\tint n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<int>> Q(n);\n\n\tUnionFind T(n);\n\n\tfor (int i = 0; i < n; ++i) {\n\n\t\tint a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (int i = 0; i < m; ++i) {\n\n\t\tint x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tint xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x))\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\telse\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t}\n\n\t}\n\n\tstd::vector<UnionFind::size_type> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tstd::cout << \"0\" << std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tlong long cost = 0;\n\n\tPairingHeap<int> P;\n\n\tfor (const auto i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tstd::cout << \"Impossible\" << std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int i = 2; i < R.size(); ++i)\n\n\t\tcost += P.pop();\n\n\tstd::cout << cost << std::endl;\n\n\treturn 0;\n\n}"
    },
    {
        "id": "180",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0,s=0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].pop());\n\n\t\t\t++s;\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (s + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <utility>\n\n#include <vector>\n\n\n\nclass UnionFind {\n\n\n\npublic:\n\n\tusing size_type = std::uint_fast32_t;\n\n\n\nprivate:\n\n\tstd::vector<std::pair<bool, size_type>> tree;\n\n\n\npublic:\n\n\tUnionFind(const size_type size) : tree(size, std::make_pair(1, 1)) {}\n\n\tsize_type find(const size_type x) {\n\n\t\tassert(x < tree.size());\n\n\t\tif (tree[x].first)\n\n\t\t\treturn x;\n\n\t\treturn tree[x].second = find(tree[x].second);\n\n\t}\n\n\tbool unite(size_type x, size_type y) {\n\n\t\tassert(x < tree.size());\n\n\t\tassert(y < tree.size());\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x].second < tree[y].second)\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x].second += tree[y].second;\n\n\t\ttree[y] = std::make_pair(0, x);\n\n\t\treturn true;\n\n\t}\n\n\tbool same(const size_type x, const size_type y) {\n\n\t\tassert(x < tree.size());\n\n\t\tassert(y < tree.size());\n\n\t\treturn find(x) == find(y);\n\n\t}\n\n\tsize_type size(const size_type x) {\n\n\t\tassert(x < tree.size());\n\n\t\treturn tree[find(x)].second;\n\n\t}\n\n\tstd::vector<size_type> roots() const {\n\n\t\tstd::vector<size_type> ret;\n\n\t\tfor (size_type i = 0; i < tree.size(); ++i) {\n\n\t\t\tif (tree[i].first)\n\n\t\t\t\tret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\n#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <functional>\n\n#include <utility>\n\n\n\ntemplate <typename T, class Compare = std::greater<T>> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\n\npublic:\n\n\tusing value_type = T;\n\n\tusing reference = value_type &;\n\n\tusing const_reference = const value_type &;\n\n\tusing size_type = std::uint_fast32_t;\n\n\n\nprivate:\n\n\tstruct node_t {\n\n\t\tvalue_type data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tsize_type size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tstatic const Compare comp=Compare();\n\n\t\tif (comp(y->data, x->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst_reference top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst_reference pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst_reference ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse\n\n\t\t\t\tx = nullptr;\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const_reference data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t}\n\n\tbool empty() const { return !root; }\n\n\tsize_type size() const { return size_; }\n\n\tvoid meld(PairingHeap<T, Compare> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n\n\n\n\n#include<iostream>\n\n#include<vector>\n\nint main(void) {\n\n\tint n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<int>> Q(n);\n\n\tUnionFind T(n);\n\n\tfor (int i = 0; i < n; ++i) {\n\n\t\tint a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (int i = 0; i < m; ++i) {\n\n\t\tint x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tint xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x))\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\telse\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t}\n\n\t}\n\n\tstd::vector<UnionFind::size_type> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tstd::cout << \"0\" << std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tlong long cost = 0;\n\n\tPairingHeap<int> P;\n\n\tfor (const auto i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tstd::cout << \"Impossible\" << std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int i = 2; i < R.size(); ++i)\n\n\t\tcost += P.pop();\n\n\tstd::cout << cost << std::endl;\n\n\treturn 0;\n\n}"
    },
    {
        "id": "181",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\n/*\n\n \n\ntemplate<typename T, bool P = false>\n\nclass PairingHeap;\n\n \n\nPairingHeap\u306f\u878d\u5408\u53ef\u80fd\u306a\u30d2\u30fc\u30d7(\u512a\u5148\u5ea6\u4ed8\u304d\u30ad\u30e5\u30fc)\u3067\u3059\n\n\u7a7a\u9593\u8a08\u7b97\u91cf O(N)\n\n \n\n \n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\n\n-typename T\n\noperator< \u306b\u3088\u3063\u3066\u5927\u5c0f\u304c\u5b9a\u7fa9\u3055\u308c\u305f\u69cb\u9020\u4f53\n\n\u8981\u7d20\u306e\u578b\u306b\u306a\u308a\u307e\u3059\n\n \n\n-bool P\n\ntrue \u3092\u4e0e\u3048\u308b\u3068\u6700\u5927\u30d2\u30fc\u30d7\u306b\u306a\u308a\u307e\u3059\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f false \u3067\u6700\u5c0f\u30d2\u30fc\u30d7\u3067\u3059\n\n \n\n \n\n\u30e1\u30f3\u30d0\u95a2\u6570\n\n-(constructor) ()\n\n\u7a7a\u306e\u30d2\u30fc\u30d7\u3092\u69cb\u7bc9\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-top (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-pop (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u3092\u524a\u9664\u3057\u3001\u305d\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf \u511f\u5374 O(logN)\n\n \n\n-push (T data)->node_t *\n\ndata \u3092\u8981\u7d20\u3068\u3057\u3066\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\n\u8ffd\u52a0\u3055\u308c\u305f\u8981\u7d20\u3078\u306e\u30dd\u30a4\u30f3\u30bf\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-empty ()->bool\n\n\u30d2\u30fc\u30d7\u304c\u7a7a\u304b\u3069\u3046\u304b\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-size ()->uint32\n\n\u8981\u7d20\u6570\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-meld (ParingHeap<T, P> &other)\n\nother \u306e\u6301\u3064\u8981\u7d20\u5168\u3066\u3092\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\nother\u306f\u7a7a\u306b\u306a\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-decrease (node_t *x, T data)\n\nx \u306e\u30ad\u30fc\u306e\u5024\u3092 data \u306b\u5909\u66f4\u3057\u307e\u3059\n\ndata \u306f\u5909\u66f4\u524d\u306e\u5024\u4ee5\u4e0b(P=true \u306a\u3089\u3070\u4ee5\u4e0a)\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n \n\n\u30e1\u30f3\u30d0\u578b\n\n-node_t\n\n\u8981\u7d20\u3092\u683c\u7d0d\u3057\u3066\u3044\u308b\u30ce\u30fc\u30c9\u306e\u578b\n\npush \u306e\u8fd4\u308a\u5024\u3068\u3057\u3066\u4e0e\u3048\u3089\u308c\u3001decrease \u306e\u969b\u306b\u4f7f\u7528\u3059\u308b\n\n \n\n \n\n\u203bN:\u8981\u7d20\u6570\n\n\u203bT \u306e\u6bd4\u8f03\u306b\u639b\u304b\u308b\u6642\u9593\u8a08\u7b97\u91cf\u3092 O(1) \u3068\u4eee\u5b9a\n\n \n\n*/\n\n \n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n \n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n \n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tnode_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t * x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tif (!x->per) {\n\n\t\t\tx->data = data;\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\tP.meld(Q[U.find(i)]);\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <utility>\n\n#include <vector>\n\n\n\nclass UnionFind {\n\n\n\npublic:\n\n\tusing size_type = std::uint_fast32_t;\n\n\n\nprivate:\n\n\tstd::vector<std::pair<bool, size_type>> tree;\n\n\n\npublic:\n\n\tUnionFind(const size_type size) : tree(size, std::make_pair(1, 1)) {}\n\n\tsize_type find(const size_type x) {\n\n\t\tassert(x < tree.size());\n\n\t\tif (tree[x].first)\n\n\t\t\treturn x;\n\n\t\treturn tree[x].second = find(tree[x].second);\n\n\t}\n\n\tbool unite(size_type x, size_type y) {\n\n\t\tassert(x < tree.size());\n\n\t\tassert(y < tree.size());\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x].second < tree[y].second)\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x].second += tree[y].second;\n\n\t\ttree[y] = std::make_pair(0, x);\n\n\t\treturn true;\n\n\t}\n\n\tbool same(const size_type x, const size_type y) {\n\n\t\tassert(x < tree.size());\n\n\t\tassert(y < tree.size());\n\n\t\treturn find(x) == find(y);\n\n\t}\n\n\tsize_type size(const size_type x) {\n\n\t\tassert(x < tree.size());\n\n\t\treturn tree[find(x)].second;\n\n\t}\n\n\tstd::vector<size_type> roots() const {\n\n\t\tstd::vector<size_type> ret;\n\n\t\tfor (size_type i = 0; i < tree.size(); ++i) {\n\n\t\t\tif (tree[i].first)\n\n\t\t\t\tret.push_back(i);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n};\n\n\n\n#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <functional>\n\n#include <utility>\n\n\n\ntemplate <typename T, class Compare = std::greater<T>> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\n\npublic:\n\n\tusing value_type = T;\n\n\tusing reference = value_type &;\n\n\tusing const_reference = const value_type &;\n\n\tusing size_type = std::uint_fast32_t;\n\n\n\nprivate:\n\n\tstruct node_t {\n\n\t\tvalue_type data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tsize_type size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tstatic const Compare comp=Compare();\n\n\t\tif (comp(y->data, x->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n\n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst_reference top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst_reference pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst_reference ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse\n\n\t\t\t\tx = nullptr;\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const_reference data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t}\n\n\tbool empty() const { return !root; }\n\n\tsize_type size() const { return size_; }\n\n\tvoid meld(PairingHeap<T, Compare> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n\n\n\n\n#include<iostream>\n\n#include<vector>\n\nint main(void) {\n\n\tint n, m;\n\n\tstd::cin >> n >> m;\n\n\tstd::vector<PairingHeap<int>> Q(n);\n\n\tUnionFind T(n);\n\n\tfor (int i = 0; i < n; ++i) {\n\n\t\tint a;\n\n\t\tstd::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (int i = 0; i < m; ++i) {\n\n\t\tint x, y;\n\n\t\tstd::cin >> x >> y;\n\n\t\tint xr = T.find(x), yr = T.find(y);\n\n\t\tif (T.unite(x, y)) {\n\n\t\t\tif (xr == T.find(x))\n\n\t\t\t\tQ[xr].meld(Q[yr]);\n\n\t\t\telse\n\n\t\t\t\tQ[yr].meld(Q[xr]);\n\n\t\t}\n\n\t}\n\n\tstd::vector<UnionFind::size_type> R = T.roots();\n\n\tif (R.size() == 1) {\n\n\t\tstd::cout << \"0\" << std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tlong long cost = 0;\n\n\tPairingHeap<int> P;\n\n\tfor (const auto i : R) {\n\n\t\tcost += Q[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\tstd::cout << \"Impossible\" << std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int i = 2; i < R.size(); ++i)\n\n\t\tcost += P.pop();\n\n\tstd::cout << cost << std::endl;\n\n\treturn 0;\n\n}"
    },
    {
        "id": "182",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <array>\n\n#include <cstdint>\n\n#include <climits>\n\n#include <functional>\n\n#include <map>\n\n#include <math.h>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <stdlib.h>\n\n#include <string>\n\n#include <time.h>\n\n#include <utility>\n\n#include <vector>\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\n\n\n\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n\n\nint main(void) {\n\n\tstd::ios::sync_with_stdio(false);\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n#define SIZ 100001\n\n\tstd::priority_queue<uint32, std::vector<uint32>, std::greater<uint32>> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tstd::cin >> x >> y;\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].top());\n\n\t\t\tQ[U.find(i)].pop();\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cassert>\n\n#include <cstddef>\n\n#include <numeric>\n\n#include <utility>\n\n#include <vector>\n\n\n\nclass UnionFind {\n\n\n\npublic:\n\n\tusing size_type = std::size_t;\n\n\tusing container_type = std::vector<size_type>;\n\n\n\nprotected:\n\n\tcontainer_type p, s;\n\n\n\npublic:\n\n\tUnionFind() : p(), s() {}\n\n\texplicit UnionFind(const size_type size)\n\n\t\t: p(size), s(size, static_cast<size_type>(1)) {\n\n\t\tstd::iota(p.begin(), p.end(), static_cast<size_type>(0));\n\n\t}\n\n\n\n\tsize_type size() const { return p.size(); }\n\n\tbool empty() const { return p.empty(); }\n\n\n\n\tsize_type find(size_type x) {\n\n\t\tassert(x < size());\n\n\t\twhile (p[x] != x)\n\n\t\t\tx = p[x] = p[p[x]];\n\n\t\treturn x;\n\n\t}\n\n\tbool same(const size_type x, const size_type y) {\n\n\t\tassert(x < size());\n\n\t\tassert(y < size());\n\n\t\treturn find(x) == find(y);\n\n\t}\n\n\tsize_type size(const size_type x) {\n\n\t\tassert(x < size());\n\n\t\treturn s[find(x)];\n\n\t}\n\n\n\n\t::std::pair<size_type,size_type> unite(size_type x, size_type y) {\n\n\t\tassert(x < size());\n\n\t\tassert(y < size());\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x != y) {\n\n\t\t\tif (s[x] < s[y])\n\n\t\t\t\tstd::swap(x, y);\n\n\t\t\ts[x] += s[y];\n\n\t\t\tp[y] = x;\n\n\t\t}\n\n\t\treturn { x,y };\n\n\t}\n\n};\n\n\n\n#include <cassert>\n\n#include <cstddef>\n\n#include <functional>\n\n#include <memory>\n\n#include <type_traits>\n\n#include <utility>\n\n\n\ntemplate <class T, class Compare = ::std::less_equal<T>> class pairing_heap {\n\n\n\npublic:\n\n\tusing value_type = T;\n\n\tusing const_reference = const value_type &;\n\n\tusing size_type = ::std::size_t;\n\n\tusing value_compare = Compare;\n\n\n\nprivate:\n\n\tstruct node_type {\n\n\t\tvalue_type value;\n\n\t\t::std::unique_ptr<node_type> left, right;\n\n\t\ttemplate <class... Args>\n\n\t\tnode_type(Args &&... args)\n\n\t\t\t: value(::std::forward<Args>(args)...), left(), right() {}\n\n\t};\n\n\tusing pointer = ::std::unique_ptr<node_type>;\n\n\tpointer root;\n\n\tvalue_compare comp;\n\n\tsize_type s;\n\n\tpointer merge(pointer x, pointer y) {\n\n\t\tif (!x)\n\n\t\t\treturn ::std::move(y);\n\n\t\tif (!y)\n\n\t\t\treturn ::std::move(x);\n\n\t\tif (!comp(x->value, y->value))\n\n\t\t\tx.swap(y);\n\n\t\ty->right = ::std::move(x->left);\n\n\t\tx->left = ::std::move(y);\n\n\t\treturn ::std::move(x);\n\n\t}\n\n\tpointer mergelist(pointer curr) {\n\n\t\tpointer head, temp, next;\n\n\t\twhile (curr) {\n\n\t\t\tnext = ::std::move(curr->right);\n\n\t\t\tif (next) {\n\n\t\t\t\ttemp = ::std::move(next->right);\n\n\t\t\t\tcurr = merge(::std::move(curr), ::std::move(next));\n\n\t\t\t}\n\n\t\t\tcurr->right = ::std::move(head);\n\n\t\t\thead = ::std::move(curr);\n\n\t\t\tcurr = ::std::move(temp);\n\n\t\t}\n\n\t\twhile (head) {\n\n\t\t\tnext = ::std::move(head->right);\n\n\t\t\tcurr = merge(::std::move(curr), ::std::move(head));\n\n\t\t\thead = ::std::move(next);\n\n\t\t}\n\n\t\treturn ::std::move(curr);\n\n\t}\n\n\n\npublic:\n\n\tpairing_heap() : root(), comp(), s(0) {}\n\n\texplicit pairing_heap(const value_compare &x) : root(), comp(x), s(0) {}\n\n\n\n\tbool empty() const noexcept { return !root; }\n\n\tsize_type size() const noexcept { return s; }\n\n\n\n\tconst_reference top() const noexcept {\n\n\t\tassert(!empty());\n\n\t\treturn root->value;\n\n\t}\n\n\n\n\tvoid push(const value_type &x) {\n\n\t\troot = merge(::std::move(root), ::std::make_unique<node_type>(x));\n\n\t\t++s;\n\n\t}\n\n\tvoid push(value_type &&x) {\n\n\t\troot = merge(::std::move(root), ::std::make_unique<node_type>(::std::move(x)));\n\n\t\t++s;\n\n\t}\n\n\ttemplate <class... Args> void emplace(Args &&... args) {\n\n\t\troot = merge(::std::move(root),\n\n\t\t\t::std::make_unique<node_type>(::std::forward<Args>(args)...));\n\n\t\t++s;\n\n\t}\n\n\n\n\tvoid pop() {\n\n\t\tassert(!empty());\n\n\t\troot = mergelist(::std::move(root->left));\n\n\t\t--s;\n\n\t}\n\n\n\n\tvoid meld(pairing_heap &x) {\n\n\t\ts += x.s;\n\n\t\tx.s = 0;\n\n\t\troot = merge(::std::move(root), ::std::move(x.root));\n\n\t}\n\n\tpairing_heap &operator+=(pairing_heap &x) {\n\n\t\tmeld(x);\n\n\t\treturn *this;\n\n\t}\n\n};\n\n\n\n\n\n#include<iostream>\n\n#include<tuple>\n\n#include<vector>\n\nint main(void) {\n\n\tint n, m;\n\n\t::std::cin >> n >> m;\n\n\t::std::vector<pairing_heap<int>> Q(n);\n\n\tUnionFind T(n);\n\n\tfor (int i = 0; i < n; ++i) {\n\n\t\tint a;\n\n\t\t::std::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (int i = 0; i < m; ++i) {\n\n\t\tint x, y;\n\n\t\t::std::cin >> x >> y;\n\n\t\tint r, c;\n\n\t\t::std::tie(r, c) = T.unite(x, y);\n\n\t\tQ[r].meld(Q[c]);\n\n\t}\n\n\t::std::vector<UnionFind::size_type> R;\n\n\tfor (int i = 0;i < n;++i)\n\n\t\tif (T.find(i) == i)\n\n\t\t\tR.emplace_back(i);\n\n\tif (R.size() == 1) {\n\n\t\t::std::cout << \"0\" << ::std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tlong long cost = 0;\n\n\tpairing_heap<int> P;\n\n\tfor (const auto i : R) {\n\n\t\tcost += Q[i].top();\n\n\t\tQ[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\t::std::cout << \"Impossible\" << ::std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int i = 2; i < R.size(); ++i)\n\n\t\tcost += P.top(), P.pop();\n\n\t::std::cout << cost << ::std::endl;\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "183",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0,s=0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].pop());\n\n\t\t\t++s;\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (s + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cassert>\n\n#include <cstddef>\n\n#include <numeric>\n\n#include <utility>\n\n#include <vector>\n\n\n\nclass UnionFind {\n\n\n\npublic:\n\n\tusing size_type = std::size_t;\n\n\tusing container_type = std::vector<size_type>;\n\n\n\nprotected:\n\n\tcontainer_type p, s;\n\n\n\npublic:\n\n\tUnionFind() : p(), s() {}\n\n\texplicit UnionFind(const size_type size)\n\n\t\t: p(size), s(size, static_cast<size_type>(1)) {\n\n\t\tstd::iota(p.begin(), p.end(), static_cast<size_type>(0));\n\n\t}\n\n\n\n\tsize_type size() const { return p.size(); }\n\n\tbool empty() const { return p.empty(); }\n\n\n\n\tsize_type find(size_type x) {\n\n\t\tassert(x < size());\n\n\t\twhile (p[x] != x)\n\n\t\t\tx = p[x] = p[p[x]];\n\n\t\treturn x;\n\n\t}\n\n\tbool same(const size_type x, const size_type y) {\n\n\t\tassert(x < size());\n\n\t\tassert(y < size());\n\n\t\treturn find(x) == find(y);\n\n\t}\n\n\tsize_type size(const size_type x) {\n\n\t\tassert(x < size());\n\n\t\treturn s[find(x)];\n\n\t}\n\n\n\n\t::std::pair<size_type,size_type> unite(size_type x, size_type y) {\n\n\t\tassert(x < size());\n\n\t\tassert(y < size());\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x != y) {\n\n\t\t\tif (s[x] < s[y])\n\n\t\t\t\tstd::swap(x, y);\n\n\t\t\ts[x] += s[y];\n\n\t\t\tp[y] = x;\n\n\t\t}\n\n\t\treturn { x,y };\n\n\t}\n\n};\n\n\n\n#include <cassert>\n\n#include <cstddef>\n\n#include <functional>\n\n#include <memory>\n\n#include <type_traits>\n\n#include <utility>\n\n\n\ntemplate <class T, class Compare = ::std::less_equal<T>> class pairing_heap {\n\n\n\npublic:\n\n\tusing value_type = T;\n\n\tusing const_reference = const value_type &;\n\n\tusing size_type = ::std::size_t;\n\n\tusing value_compare = Compare;\n\n\n\nprivate:\n\n\tstruct node_type {\n\n\t\tvalue_type value;\n\n\t\t::std::unique_ptr<node_type> left, right;\n\n\t\ttemplate <class... Args>\n\n\t\tnode_type(Args &&... args)\n\n\t\t\t: value(::std::forward<Args>(args)...), left(), right() {}\n\n\t};\n\n\tusing pointer = ::std::unique_ptr<node_type>;\n\n\tpointer root;\n\n\tvalue_compare comp;\n\n\tsize_type s;\n\n\tpointer merge(pointer x, pointer y) {\n\n\t\tif (!x)\n\n\t\t\treturn ::std::move(y);\n\n\t\tif (!y)\n\n\t\t\treturn ::std::move(x);\n\n\t\tif (!comp(x->value, y->value))\n\n\t\t\tx.swap(y);\n\n\t\ty->right = ::std::move(x->left);\n\n\t\tx->left = ::std::move(y);\n\n\t\treturn ::std::move(x);\n\n\t}\n\n\tpointer mergelist(pointer curr) {\n\n\t\tpointer head, temp, next;\n\n\t\twhile (curr) {\n\n\t\t\tnext = ::std::move(curr->right);\n\n\t\t\tif (next) {\n\n\t\t\t\ttemp = ::std::move(next->right);\n\n\t\t\t\tcurr = merge(::std::move(curr), ::std::move(next));\n\n\t\t\t}\n\n\t\t\tcurr->right = ::std::move(head);\n\n\t\t\thead = ::std::move(curr);\n\n\t\t\tcurr = ::std::move(temp);\n\n\t\t}\n\n\t\twhile (head) {\n\n\t\t\tnext = ::std::move(head->right);\n\n\t\t\tcurr = merge(::std::move(curr), ::std::move(head));\n\n\t\t\thead = ::std::move(next);\n\n\t\t}\n\n\t\treturn ::std::move(curr);\n\n\t}\n\n\n\npublic:\n\n\tpairing_heap() : root(), comp(), s(0) {}\n\n\texplicit pairing_heap(const value_compare &x) : root(), comp(x), s(0) {}\n\n\n\n\tbool empty() const noexcept { return !root; }\n\n\tsize_type size() const noexcept { return s; }\n\n\n\n\tconst_reference top() const noexcept {\n\n\t\tassert(!empty());\n\n\t\treturn root->value;\n\n\t}\n\n\n\n\tvoid push(const value_type &x) {\n\n\t\troot = merge(::std::move(root), ::std::make_unique<node_type>(x));\n\n\t\t++s;\n\n\t}\n\n\tvoid push(value_type &&x) {\n\n\t\troot = merge(::std::move(root), ::std::make_unique<node_type>(::std::move(x)));\n\n\t\t++s;\n\n\t}\n\n\ttemplate <class... Args> void emplace(Args &&... args) {\n\n\t\troot = merge(::std::move(root),\n\n\t\t\t::std::make_unique<node_type>(::std::forward<Args>(args)...));\n\n\t\t++s;\n\n\t}\n\n\n\n\tvoid pop() {\n\n\t\tassert(!empty());\n\n\t\troot = mergelist(::std::move(root->left));\n\n\t\t--s;\n\n\t}\n\n\n\n\tvoid meld(pairing_heap &x) {\n\n\t\ts += x.s;\n\n\t\tx.s = 0;\n\n\t\troot = merge(::std::move(root), ::std::move(x.root));\n\n\t}\n\n\tpairing_heap &operator+=(pairing_heap &x) {\n\n\t\tmeld(x);\n\n\t\treturn *this;\n\n\t}\n\n};\n\n\n\n\n\n#include<iostream>\n\n#include<tuple>\n\n#include<vector>\n\nint main(void) {\n\n\tint n, m;\n\n\t::std::cin >> n >> m;\n\n\t::std::vector<pairing_heap<int>> Q(n);\n\n\tUnionFind T(n);\n\n\tfor (int i = 0; i < n; ++i) {\n\n\t\tint a;\n\n\t\t::std::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (int i = 0; i < m; ++i) {\n\n\t\tint x, y;\n\n\t\t::std::cin >> x >> y;\n\n\t\tint r, c;\n\n\t\t::std::tie(r, c) = T.unite(x, y);\n\n\t\tQ[r].meld(Q[c]);\n\n\t}\n\n\t::std::vector<UnionFind::size_type> R;\n\n\tfor (int i = 0;i < n;++i)\n\n\t\tif (T.find(i) == i)\n\n\t\t\tR.emplace_back(i);\n\n\tif (R.size() == 1) {\n\n\t\t::std::cout << \"0\" << ::std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tlong long cost = 0;\n\n\tpairing_heap<int> P;\n\n\tfor (const auto i : R) {\n\n\t\tcost += Q[i].top();\n\n\t\tQ[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\t::std::cout << \"Impossible\" << ::std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int i = 2; i < R.size(); ++i)\n\n\t\tcost += P.top(), P.pop();\n\n\t::std::cout << cost << ::std::endl;\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "184",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\n/*\n\n \n\ntemplate<typename T, bool P = false>\n\nclass PairingHeap;\n\n \n\nPairingHeap\u306f\u878d\u5408\u53ef\u80fd\u306a\u30d2\u30fc\u30d7(\u512a\u5148\u5ea6\u4ed8\u304d\u30ad\u30e5\u30fc)\u3067\u3059\n\n\u7a7a\u9593\u8a08\u7b97\u91cf O(N)\n\n \n\n \n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\n\n-typename T\n\noperator< \u306b\u3088\u3063\u3066\u5927\u5c0f\u304c\u5b9a\u7fa9\u3055\u308c\u305f\u69cb\u9020\u4f53\n\n\u8981\u7d20\u306e\u578b\u306b\u306a\u308a\u307e\u3059\n\n \n\n-bool P\n\ntrue \u3092\u4e0e\u3048\u308b\u3068\u6700\u5927\u30d2\u30fc\u30d7\u306b\u306a\u308a\u307e\u3059\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f false \u3067\u6700\u5c0f\u30d2\u30fc\u30d7\u3067\u3059\n\n \n\n \n\n\u30e1\u30f3\u30d0\u95a2\u6570\n\n-(constructor) ()\n\n\u7a7a\u306e\u30d2\u30fc\u30d7\u3092\u69cb\u7bc9\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-top (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-pop (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u3092\u524a\u9664\u3057\u3001\u305d\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf \u511f\u5374 O(logN)\n\n \n\n-push (T data)->node_t *\n\ndata \u3092\u8981\u7d20\u3068\u3057\u3066\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\n\u8ffd\u52a0\u3055\u308c\u305f\u8981\u7d20\u3078\u306e\u30dd\u30a4\u30f3\u30bf\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-empty ()->bool\n\n\u30d2\u30fc\u30d7\u304c\u7a7a\u304b\u3069\u3046\u304b\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-size ()->uint32\n\n\u8981\u7d20\u6570\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-meld (ParingHeap<T, P> &other)\n\nother \u306e\u6301\u3064\u8981\u7d20\u5168\u3066\u3092\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\nother\u306f\u7a7a\u306b\u306a\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-decrease (node_t *x, T data)\n\nx \u306e\u30ad\u30fc\u306e\u5024\u3092 data \u306b\u5909\u66f4\u3057\u307e\u3059\n\ndata \u306f\u5909\u66f4\u524d\u306e\u5024\u4ee5\u4e0b(P=true \u306a\u3089\u3070\u4ee5\u4e0a)\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n \n\n\u30e1\u30f3\u30d0\u578b\n\n-node_t\n\n\u8981\u7d20\u3092\u683c\u7d0d\u3057\u3066\u3044\u308b\u30ce\u30fc\u30c9\u306e\u578b\n\npush \u306e\u8fd4\u308a\u5024\u3068\u3057\u3066\u4e0e\u3048\u3089\u308c\u3001decrease \u306e\u969b\u306b\u4f7f\u7528\u3059\u308b\n\n \n\n \n\n\u203bN:\u8981\u7d20\u6570\n\n\u203bT \u306e\u6bd4\u8f03\u306b\u639b\u304b\u308b\u6642\u9593\u8a08\u7b97\u91cf\u3092 O(1) \u3068\u4eee\u5b9a\n\n \n\n*/\n\n \n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n \n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n \n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tnode_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t * x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tif (!x->per) {\n\n\t\t\tx->data = data;\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\tP.meld(Q[U.find(i)]);\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cassert>\n\n#include <cstddef>\n\n#include <numeric>\n\n#include <utility>\n\n#include <vector>\n\n\n\nclass UnionFind {\n\n\n\npublic:\n\n\tusing size_type = std::size_t;\n\n\tusing container_type = std::vector<size_type>;\n\n\n\nprotected:\n\n\tcontainer_type p, s;\n\n\n\npublic:\n\n\tUnionFind() : p(), s() {}\n\n\texplicit UnionFind(const size_type size)\n\n\t\t: p(size), s(size, static_cast<size_type>(1)) {\n\n\t\tstd::iota(p.begin(), p.end(), static_cast<size_type>(0));\n\n\t}\n\n\n\n\tsize_type size() const { return p.size(); }\n\n\tbool empty() const { return p.empty(); }\n\n\n\n\tsize_type find(size_type x) {\n\n\t\tassert(x < size());\n\n\t\twhile (p[x] != x)\n\n\t\t\tx = p[x] = p[p[x]];\n\n\t\treturn x;\n\n\t}\n\n\tbool same(const size_type x, const size_type y) {\n\n\t\tassert(x < size());\n\n\t\tassert(y < size());\n\n\t\treturn find(x) == find(y);\n\n\t}\n\n\tsize_type size(const size_type x) {\n\n\t\tassert(x < size());\n\n\t\treturn s[find(x)];\n\n\t}\n\n\n\n\t::std::pair<size_type,size_type> unite(size_type x, size_type y) {\n\n\t\tassert(x < size());\n\n\t\tassert(y < size());\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x != y) {\n\n\t\t\tif (s[x] < s[y])\n\n\t\t\t\tstd::swap(x, y);\n\n\t\t\ts[x] += s[y];\n\n\t\t\tp[y] = x;\n\n\t\t}\n\n\t\treturn { x,y };\n\n\t}\n\n};\n\n\n\n#include <cassert>\n\n#include <cstddef>\n\n#include <functional>\n\n#include <memory>\n\n#include <type_traits>\n\n#include <utility>\n\n\n\ntemplate <class T, class Compare = ::std::less_equal<T>> class pairing_heap {\n\n\n\npublic:\n\n\tusing value_type = T;\n\n\tusing const_reference = const value_type &;\n\n\tusing size_type = ::std::size_t;\n\n\tusing value_compare = Compare;\n\n\n\nprivate:\n\n\tstruct node_type {\n\n\t\tvalue_type value;\n\n\t\t::std::unique_ptr<node_type> left, right;\n\n\t\ttemplate <class... Args>\n\n\t\tnode_type(Args &&... args)\n\n\t\t\t: value(::std::forward<Args>(args)...), left(), right() {}\n\n\t};\n\n\tusing pointer = ::std::unique_ptr<node_type>;\n\n\tpointer root;\n\n\tvalue_compare comp;\n\n\tsize_type s;\n\n\tpointer merge(pointer x, pointer y) {\n\n\t\tif (!x)\n\n\t\t\treturn ::std::move(y);\n\n\t\tif (!y)\n\n\t\t\treturn ::std::move(x);\n\n\t\tif (!comp(x->value, y->value))\n\n\t\t\tx.swap(y);\n\n\t\ty->right = ::std::move(x->left);\n\n\t\tx->left = ::std::move(y);\n\n\t\treturn ::std::move(x);\n\n\t}\n\n\tpointer mergelist(pointer curr) {\n\n\t\tpointer head, temp, next;\n\n\t\twhile (curr) {\n\n\t\t\tnext = ::std::move(curr->right);\n\n\t\t\tif (next) {\n\n\t\t\t\ttemp = ::std::move(next->right);\n\n\t\t\t\tcurr = merge(::std::move(curr), ::std::move(next));\n\n\t\t\t}\n\n\t\t\tcurr->right = ::std::move(head);\n\n\t\t\thead = ::std::move(curr);\n\n\t\t\tcurr = ::std::move(temp);\n\n\t\t}\n\n\t\twhile (head) {\n\n\t\t\tnext = ::std::move(head->right);\n\n\t\t\tcurr = merge(::std::move(curr), ::std::move(head));\n\n\t\t\thead = ::std::move(next);\n\n\t\t}\n\n\t\treturn ::std::move(curr);\n\n\t}\n\n\n\npublic:\n\n\tpairing_heap() : root(), comp(), s(0) {}\n\n\texplicit pairing_heap(const value_compare &x) : root(), comp(x), s(0) {}\n\n\n\n\tbool empty() const noexcept { return !root; }\n\n\tsize_type size() const noexcept { return s; }\n\n\n\n\tconst_reference top() const noexcept {\n\n\t\tassert(!empty());\n\n\t\treturn root->value;\n\n\t}\n\n\n\n\tvoid push(const value_type &x) {\n\n\t\troot = merge(::std::move(root), ::std::make_unique<node_type>(x));\n\n\t\t++s;\n\n\t}\n\n\tvoid push(value_type &&x) {\n\n\t\troot = merge(::std::move(root), ::std::make_unique<node_type>(::std::move(x)));\n\n\t\t++s;\n\n\t}\n\n\ttemplate <class... Args> void emplace(Args &&... args) {\n\n\t\troot = merge(::std::move(root),\n\n\t\t\t::std::make_unique<node_type>(::std::forward<Args>(args)...));\n\n\t\t++s;\n\n\t}\n\n\n\n\tvoid pop() {\n\n\t\tassert(!empty());\n\n\t\troot = mergelist(::std::move(root->left));\n\n\t\t--s;\n\n\t}\n\n\n\n\tvoid meld(pairing_heap &x) {\n\n\t\ts += x.s;\n\n\t\tx.s = 0;\n\n\t\troot = merge(::std::move(root), ::std::move(x.root));\n\n\t}\n\n\tpairing_heap &operator+=(pairing_heap &x) {\n\n\t\tmeld(x);\n\n\t\treturn *this;\n\n\t}\n\n};\n\n\n\n\n\n#include<iostream>\n\n#include<tuple>\n\n#include<vector>\n\nint main(void) {\n\n\tint n, m;\n\n\t::std::cin >> n >> m;\n\n\t::std::vector<pairing_heap<int>> Q(n);\n\n\tUnionFind T(n);\n\n\tfor (int i = 0; i < n; ++i) {\n\n\t\tint a;\n\n\t\t::std::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (int i = 0; i < m; ++i) {\n\n\t\tint x, y;\n\n\t\t::std::cin >> x >> y;\n\n\t\tint r, c;\n\n\t\t::std::tie(r, c) = T.unite(x, y);\n\n\t\tQ[r].meld(Q[c]);\n\n\t}\n\n\t::std::vector<UnionFind::size_type> R;\n\n\tfor (int i = 0;i < n;++i)\n\n\t\tif (T.find(i) == i)\n\n\t\t\tR.emplace_back(i);\n\n\tif (R.size() == 1) {\n\n\t\t::std::cout << \"0\" << ::std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tlong long cost = 0;\n\n\tpairing_heap<int> P;\n\n\tfor (const auto i : R) {\n\n\t\tcost += Q[i].top();\n\n\t\tQ[i].pop();\n\n\t\tP.meld(Q[i]);\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\t::std::cout << \"Impossible\" << ::std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int i = 2; i < R.size(); ++i)\n\n\t\tcost += P.top(), P.pop();\n\n\t::std::cout << cost << ::std::endl;\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "185",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <array>\n\n#include <cstdint>\n\n#include <climits>\n\n#include <functional>\n\n#include <map>\n\n#include <math.h>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <stdlib.h>\n\n#include <string>\n\n#include <time.h>\n\n#include <utility>\n\n#include <vector>\n\n\n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\n\n\n\n\n\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n\n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n\n\nint main(void) {\n\n\tstd::ios::sync_with_stdio(false);\n\n\tuint32 n, m;\n\n\tstd::cin >> n >> m;\n\n#define SIZ 100001\n\n\tstd::priority_queue<uint32, std::vector<uint32>, std::greater<uint32>> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tstd::cin >> x >> y;\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].top());\n\n\t\t\tQ[U.find(i)].pop();\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tstd::cout << \"0\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tstd::cout << \"Impossible\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tstd::cout << cost << \"\\n\";\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cassert>\n\n#include <cstddef>\n\n#include <utility>\n\n\n\ntemplate <template <class> class Container> class union_find {\n\nprotected:\n\n\tclass node_type;\n\n\n\npublic:\n\n\tusing container_type = Container<node_type>;\n\n\tusing size_type = typename container_type::size_type;\n\n\n\nprotected:\n\n\tclass node_type {\n\n\tpublic:\n\n\t\ttypename union_find::size_type parent, size;\n\n\t};\n\n\tcontainer_type c;\n\n\n\npublic:\n\n\tunion_find() : c() {}\n\n\texplicit union_find(const size_type size) : c(size, { 0, 1 }) {\n\n\t\tfor (size_type i = 0; i < size; ++i)\n\n\t\t\tc[i].parent = i;\n\n\t}\n\n\n\n\tbool empty() const { return c.empty(); }\n\n\tsize_type size() const { return c.size(); }\n\n\n\n\tsize_type find(size_type x) {\n\n\t\tassert(x < size());\n\n\t\twhile (c[x].parent != x)\n\n\t\t\tx = c[x].parent = c[c[x].parent].parent;\n\n\t\treturn x;\n\n\t}\n\n\tbool same(const size_type x, const size_type y) {\n\n\t\tassert(x < size());\n\n\t\tassert(y < size());\n\n\t\treturn find(x) == find(y);\n\n\t}\n\n\tsize_type size(const size_type x) {\n\n\t\tassert(x < size());\n\n\t\treturn c[find(x)].size;\n\n\t}\n\n\n\n\t::std::pair<size_type, size_type> unite(size_type x, size_type y) {\n\n\t\tassert(x < size());\n\n\t\tassert(y < size());\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x != y) {\n\n\t\t\tif (c[x].size < c[y].size)\n\n\t\t\t\t::std::swap(x, y);\n\n\t\t\tc[x].size += c[y].size;\n\n\t\t\tc[y].parent = x;\n\n\t\t}\n\n\t\treturn { x, y };\n\n\t}\n\n};\n\n\n\n#include <cassert>\n\n#include <cstddef>\n\n#include <memory>\n\n#include <utility>\n\n\n\ntemplate <class TotallyOrderedSet> class pairing_heap {\n\n\n\npublic:\n\n\tusing value_structure = TotallyOrderedSet;\n\n\tusing value_type = typename value_structure::value_type;\n\n\tusing const_reference = const value_type &;\n\n\tusing size_type = ::std::size_t;\n\n\n\nprivate:\n\n\tclass node_type {\n\n\tpublic:\n\n\t\tvalue_type value;\n\n\t\t::std::pair<::std::unique_ptr<node_type>, ::std::unique_ptr<node_type>>\n\n\t\t\tchild;\n\n\t\ttemplate <class... Args>\n\n\t\tnode_type(Args &&... args)\n\n\t\t\t: value(::std::forward<Args>(args)...), child() {}\n\n\t};\n\n\tusing pointer = ::std::unique_ptr<node_type>;\n\n\tpointer root;\n\n\tsize_type s;\n\n\tstatic pointer merge(pointer x, pointer y) {\n\n\t\tif (!x)\n\n\t\t\treturn y;\n\n\t\tif (!y)\n\n\t\t\treturn x;\n\n\t\tif (!value_structure::operation(x->value, y->value))\n\n\t\t\tx.swap(y);\n\n\t\ty->child.second = ::std::move(x->child.first);\n\n\t\tx->child.first = ::std::move(y);\n\n\t\treturn x;\n\n\t}\n\n\tstatic pointer mergelist(pointer curr) {\n\n\t\tpointer head, temp, next;\n\n\t\twhile (curr) {\n\n\t\t\tnext = ::std::move(curr->child.second);\n\n\t\t\tif (next) {\n\n\t\t\t\ttemp = ::std::move(next->child.second);\n\n\t\t\t\tcurr = merge(::std::move(curr), ::std::move(next));\n\n\t\t\t}\n\n\t\t\tcurr->child.second = ::std::move(head);\n\n\t\t\thead = ::std::move(curr);\n\n\t\t\tcurr = ::std::move(temp);\n\n\t\t}\n\n\t\tif (head) {\n\n\t\t\tcurr = ::std::move(head);\n\n\t\t\thead = ::std::move(curr->child.second);\n\n\t\t}\n\n\t\twhile (head) {\n\n\t\t\tnext = ::std::move(head->child.second);\n\n\t\t\tcurr = merge(::std::move(curr), ::std::move(head));\n\n\t\t\thead = ::std::move(next);\n\n\t\t}\n\n\t\treturn curr;\n\n\t}\n\n\n\npublic:\n\n\tpairing_heap() noexcept : root(), s(0) {}\n\n\n\n\tbool empty() const noexcept { return !root; }\n\n\tsize_type size() const noexcept { return s; }\n\n\n\n\tconst_reference top() const noexcept {\n\n\t\tassert(!empty());\n\n\t\treturn root->value;\n\n\t}\n\n\n\n\tvoid push(const value_type &x) {\n\n\t\troot = merge(::std::move(root), ::std::make_unique<node_type>(x));\n\n\t\t++s;\n\n\t}\n\n\tvoid push(value_type &&x) {\n\n\t\troot =\n\n\t\t\tmerge(::std::move(root), ::std::make_unique<node_type>(::std::move(x)));\n\n\t\t++s;\n\n\t}\n\n\ttemplate <class... Args> void emplace(Args &&... args) {\n\n\t\troot = merge(::std::move(root),\n\n\t\t\t::std::make_unique<node_type>(::std::forward<Args>(args)...));\n\n\t\t++s;\n\n\t}\n\n\n\n\tvoid pop() {\n\n\t\tassert(!empty());\n\n\t\troot = mergelist(::std::move(root->child.first));\n\n\t\t--s;\n\n\t}\n\n\n\n\tvoid meld(pairing_heap &other) {\n\n\t\ts += other.s;\n\n\t\tother.s = 0;\n\n\t\troot = merge(::std::move(root), ::std::move(other.root));\n\n\t}\n\n\tpairing_heap &operator+=(pairing_heap &other) {\n\n\t\tmeld(other);\n\n\t\treturn *this;\n\n\t}\n\n};\n\n\n\ntemplate <class T> class forward_order_set {\n\npublic:\n\n\tusing value_type = T;\n\n\tstatic bool operation(const value_type &x, const value_type &y) {\n\n\t\treturn x <= y;\n\n\t}\n\n};\n\n\n\n\n\n#include<iostream>\n\n#include<tuple>\n\n#include<vector>\n\n\n\ntemplate<class T>\n\nusing vec = ::std::vector<T>;\n\n\n\nint main(void) {\n\n\tint n, m;\n\n\t::std::cin >> n >> m;\n\n\t::std::vector<pairing_heap<forward_order_set<int>>> Q(n);\n\n\tunion_find<vec> T(n);\n\n\tfor (int i = 0; i < n; ++i) {\n\n\t\tint a;\n\n\t\t::std::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (int i = 0; i < m; ++i) {\n\n\t\tint x, y;\n\n\t\t::std::cin >> x >> y;\n\n\t\t::std::tie(x, y) = T.unite(x, y);\n\n\t\tif (x != y)\n\n\t\t\tQ[x].meld(Q[y]);\n\n\t}\n\n\t::std::vector<union_find<vec>::size_type> R;\n\n\tfor (int i = 0;i < n;++i)\n\n\t\tif (T.find(i) == i)\n\n\t\t\tR.push_back(i);\n\n\tif (R.size() == 1) {\n\n\t\t::std::cout << \"0\" << ::std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tlong long cost = 0;\n\n\tpairing_heap<forward_order_set<int>> P;\n\n\tfor (const auto i : R) {\n\n\t\tcost += Q[i].top();\n\n\t\tQ[i].pop();\n\n\t\tP += Q[i];\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\t::std::cout << \"Impossible\" << ::std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int i = 2; i < R.size(); ++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\t::std::cout << cost << ::std::endl;\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "186",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right;\n\n\t};\n\n\tnode_t *root;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tx->right = y->left;\n\n\t\ty->left = x;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\treturn ret;\n\n\t}\n\n\tvoid push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0,s=0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].pop();\n\n\t\twhile (!Q[U.find(i)].empty()) {\n\n\t\t\tP.push(Q[U.find(i)].pop());\n\n\t\t\t++s;\n\n\t\t}\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (s + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cassert>\n\n#include <cstddef>\n\n#include <utility>\n\n\n\ntemplate <template <class> class Container> class union_find {\n\nprotected:\n\n\tclass node_type;\n\n\n\npublic:\n\n\tusing container_type = Container<node_type>;\n\n\tusing size_type = typename container_type::size_type;\n\n\n\nprotected:\n\n\tclass node_type {\n\n\tpublic:\n\n\t\ttypename union_find::size_type parent, size;\n\n\t};\n\n\tcontainer_type c;\n\n\n\npublic:\n\n\tunion_find() : c() {}\n\n\texplicit union_find(const size_type size) : c(size, { 0, 1 }) {\n\n\t\tfor (size_type i = 0; i < size; ++i)\n\n\t\t\tc[i].parent = i;\n\n\t}\n\n\n\n\tbool empty() const { return c.empty(); }\n\n\tsize_type size() const { return c.size(); }\n\n\n\n\tsize_type find(size_type x) {\n\n\t\tassert(x < size());\n\n\t\twhile (c[x].parent != x)\n\n\t\t\tx = c[x].parent = c[c[x].parent].parent;\n\n\t\treturn x;\n\n\t}\n\n\tbool same(const size_type x, const size_type y) {\n\n\t\tassert(x < size());\n\n\t\tassert(y < size());\n\n\t\treturn find(x) == find(y);\n\n\t}\n\n\tsize_type size(const size_type x) {\n\n\t\tassert(x < size());\n\n\t\treturn c[find(x)].size;\n\n\t}\n\n\n\n\t::std::pair<size_type, size_type> unite(size_type x, size_type y) {\n\n\t\tassert(x < size());\n\n\t\tassert(y < size());\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x != y) {\n\n\t\t\tif (c[x].size < c[y].size)\n\n\t\t\t\t::std::swap(x, y);\n\n\t\t\tc[x].size += c[y].size;\n\n\t\t\tc[y].parent = x;\n\n\t\t}\n\n\t\treturn { x, y };\n\n\t}\n\n};\n\n\n\n#include <cassert>\n\n#include <cstddef>\n\n#include <memory>\n\n#include <utility>\n\n\n\ntemplate <class TotallyOrderedSet> class pairing_heap {\n\n\n\npublic:\n\n\tusing value_structure = TotallyOrderedSet;\n\n\tusing value_type = typename value_structure::value_type;\n\n\tusing const_reference = const value_type &;\n\n\tusing size_type = ::std::size_t;\n\n\n\nprivate:\n\n\tclass node_type {\n\n\tpublic:\n\n\t\tvalue_type value;\n\n\t\t::std::pair<::std::unique_ptr<node_type>, ::std::unique_ptr<node_type>>\n\n\t\t\tchild;\n\n\t\ttemplate <class... Args>\n\n\t\tnode_type(Args &&... args)\n\n\t\t\t: value(::std::forward<Args>(args)...), child() {}\n\n\t};\n\n\tusing pointer = ::std::unique_ptr<node_type>;\n\n\tpointer root;\n\n\tsize_type s;\n\n\tstatic pointer merge(pointer x, pointer y) {\n\n\t\tif (!x)\n\n\t\t\treturn y;\n\n\t\tif (!y)\n\n\t\t\treturn x;\n\n\t\tif (!value_structure::operation(x->value, y->value))\n\n\t\t\tx.swap(y);\n\n\t\ty->child.second = ::std::move(x->child.first);\n\n\t\tx->child.first = ::std::move(y);\n\n\t\treturn x;\n\n\t}\n\n\tstatic pointer mergelist(pointer curr) {\n\n\t\tpointer head, temp, next;\n\n\t\twhile (curr) {\n\n\t\t\tnext = ::std::move(curr->child.second);\n\n\t\t\tif (next) {\n\n\t\t\t\ttemp = ::std::move(next->child.second);\n\n\t\t\t\tcurr = merge(::std::move(curr), ::std::move(next));\n\n\t\t\t}\n\n\t\t\tcurr->child.second = ::std::move(head);\n\n\t\t\thead = ::std::move(curr);\n\n\t\t\tcurr = ::std::move(temp);\n\n\t\t}\n\n\t\tif (head) {\n\n\t\t\tcurr = ::std::move(head);\n\n\t\t\thead = ::std::move(curr->child.second);\n\n\t\t}\n\n\t\twhile (head) {\n\n\t\t\tnext = ::std::move(head->child.second);\n\n\t\t\tcurr = merge(::std::move(curr), ::std::move(head));\n\n\t\t\thead = ::std::move(next);\n\n\t\t}\n\n\t\treturn curr;\n\n\t}\n\n\n\npublic:\n\n\tpairing_heap() noexcept : root(), s(0) {}\n\n\n\n\tbool empty() const noexcept { return !root; }\n\n\tsize_type size() const noexcept { return s; }\n\n\n\n\tconst_reference top() const noexcept {\n\n\t\tassert(!empty());\n\n\t\treturn root->value;\n\n\t}\n\n\n\n\tvoid push(const value_type &x) {\n\n\t\troot = merge(::std::move(root), ::std::make_unique<node_type>(x));\n\n\t\t++s;\n\n\t}\n\n\tvoid push(value_type &&x) {\n\n\t\troot =\n\n\t\t\tmerge(::std::move(root), ::std::make_unique<node_type>(::std::move(x)));\n\n\t\t++s;\n\n\t}\n\n\ttemplate <class... Args> void emplace(Args &&... args) {\n\n\t\troot = merge(::std::move(root),\n\n\t\t\t::std::make_unique<node_type>(::std::forward<Args>(args)...));\n\n\t\t++s;\n\n\t}\n\n\n\n\tvoid pop() {\n\n\t\tassert(!empty());\n\n\t\troot = mergelist(::std::move(root->child.first));\n\n\t\t--s;\n\n\t}\n\n\n\n\tvoid meld(pairing_heap &other) {\n\n\t\ts += other.s;\n\n\t\tother.s = 0;\n\n\t\troot = merge(::std::move(root), ::std::move(other.root));\n\n\t}\n\n\tpairing_heap &operator+=(pairing_heap &other) {\n\n\t\tmeld(other);\n\n\t\treturn *this;\n\n\t}\n\n};\n\n\n\ntemplate <class T> class forward_order_set {\n\npublic:\n\n\tusing value_type = T;\n\n\tstatic bool operation(const value_type &x, const value_type &y) {\n\n\t\treturn x <= y;\n\n\t}\n\n};\n\n\n\n\n\n#include<iostream>\n\n#include<tuple>\n\n#include<vector>\n\n\n\ntemplate<class T>\n\nusing vec = ::std::vector<T>;\n\n\n\nint main(void) {\n\n\tint n, m;\n\n\t::std::cin >> n >> m;\n\n\t::std::vector<pairing_heap<forward_order_set<int>>> Q(n);\n\n\tunion_find<vec> T(n);\n\n\tfor (int i = 0; i < n; ++i) {\n\n\t\tint a;\n\n\t\t::std::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (int i = 0; i < m; ++i) {\n\n\t\tint x, y;\n\n\t\t::std::cin >> x >> y;\n\n\t\t::std::tie(x, y) = T.unite(x, y);\n\n\t\tif (x != y)\n\n\t\t\tQ[x].meld(Q[y]);\n\n\t}\n\n\t::std::vector<union_find<vec>::size_type> R;\n\n\tfor (int i = 0;i < n;++i)\n\n\t\tif (T.find(i) == i)\n\n\t\t\tR.push_back(i);\n\n\tif (R.size() == 1) {\n\n\t\t::std::cout << \"0\" << ::std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tlong long cost = 0;\n\n\tpairing_heap<forward_order_set<int>> P;\n\n\tfor (const auto i : R) {\n\n\t\tcost += Q[i].top();\n\n\t\tQ[i].pop();\n\n\t\tP += Q[i];\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\t::std::cout << \"Impossible\" << ::std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int i = 2; i < R.size(); ++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\t::std::cout << cost << ::std::endl;\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "187",
        "source_code": "#include <cassert>\n\n#include <cstdint>\n\n#include <cstdlib>\n\n#include <utility>\n\n/*\n\n \n\ntemplate<typename T, bool P = false>\n\nclass PairingHeap;\n\n \n\nPairingHeap\u306f\u878d\u5408\u53ef\u80fd\u306a\u30d2\u30fc\u30d7(\u512a\u5148\u5ea6\u4ed8\u304d\u30ad\u30e5\u30fc)\u3067\u3059\n\n\u7a7a\u9593\u8a08\u7b97\u91cf O(N)\n\n \n\n \n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\n\n-typename T\n\noperator< \u306b\u3088\u3063\u3066\u5927\u5c0f\u304c\u5b9a\u7fa9\u3055\u308c\u305f\u69cb\u9020\u4f53\n\n\u8981\u7d20\u306e\u578b\u306b\u306a\u308a\u307e\u3059\n\n \n\n-bool P\n\ntrue \u3092\u4e0e\u3048\u308b\u3068\u6700\u5927\u30d2\u30fc\u30d7\u306b\u306a\u308a\u307e\u3059\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f false \u3067\u6700\u5c0f\u30d2\u30fc\u30d7\u3067\u3059\n\n \n\n \n\n\u30e1\u30f3\u30d0\u95a2\u6570\n\n-(constructor) ()\n\n\u7a7a\u306e\u30d2\u30fc\u30d7\u3092\u69cb\u7bc9\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-top (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-pop (void)->const T &\n\n\u5148\u982d\u306e\u8981\u7d20\u3092\u524a\u9664\u3057\u3001\u305d\u306econst\u53c2\u7167\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf \u511f\u5374 O(logN)\n\n \n\n-push (T data)->node_t *\n\ndata \u3092\u8981\u7d20\u3068\u3057\u3066\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\n\u8ffd\u52a0\u3055\u308c\u305f\u8981\u7d20\u3078\u306e\u30dd\u30a4\u30f3\u30bf\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-empty ()->bool\n\n\u30d2\u30fc\u30d7\u304c\u7a7a\u304b\u3069\u3046\u304b\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-size ()->uint32\n\n\u8981\u7d20\u6570\u3092\u8fd4\u3057\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-meld (ParingHeap<T, P> &other)\n\nother \u306e\u6301\u3064\u8981\u7d20\u5168\u3066\u3092\u30d2\u30fc\u30d7\u306b\u8ffd\u52a0\u3057\u307e\u3059\n\nother\u306f\u7a7a\u306b\u306a\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n-decrease (node_t *x, T data)\n\nx \u306e\u30ad\u30fc\u306e\u5024\u3092 data \u306b\u5909\u66f4\u3057\u307e\u3059\n\ndata \u306f\u5909\u66f4\u524d\u306e\u5024\u4ee5\u4e0b(P=true \u306a\u3089\u3070\u4ee5\u4e0a)\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\n\n\u6642\u9593\u8a08\u7b97\u91cf O(1)\n\n \n\n \n\n\u30e1\u30f3\u30d0\u578b\n\n-node_t\n\n\u8981\u7d20\u3092\u683c\u7d0d\u3057\u3066\u3044\u308b\u30ce\u30fc\u30c9\u306e\u578b\n\npush \u306e\u8fd4\u308a\u5024\u3068\u3057\u3066\u4e0e\u3048\u3089\u308c\u3001decrease \u306e\u969b\u306b\u4f7f\u7528\u3059\u308b\n\n \n\n \n\n\u203bN:\u8981\u7d20\u6570\n\n\u203bT \u306e\u6bd4\u8f03\u306b\u639b\u304b\u308b\u6642\u9593\u8a08\u7b97\u91cf\u3092 O(1) \u3068\u4eee\u5b9a\n\n \n\n*/\n\n \n\ntemplate <typename T, bool P = false> class PairingHeap {\n\n\tstatic constexpr std::uint_fast64_t ALLOCSIZE = (std::uint_fast64_t)1 << 10;\n\n \n\npublic:\n\n\tstruct node_t {\n\n\t\tT data;\n\n\t\tnode_t *left, *right, *per;\n\n\t};\n\n \n\nprivate:\n\n\tnode_t *root;\n\n\tstd::uint_fast32_t size_;\n\n\tstatic node_t *merge(node_t *x, node_t *y) {\n\n\t\tif (P ^ (x->data < y->data))\n\n\t\t\tstd::swap(x, y);\n\n\t\tif (x->right = y->left)\n\n\t\t\ty->left->per = x;\n\n\t\ty->left = x;\n\n\t\tx->per = y;\n\n\t\treturn y;\n\n\t}\n\n \n\npublic:\n\n\tPairingHeap() : root(nullptr), size_(0) {}\n\n\tconst T &top() const {\n\n\t\tassert(root);\n\n\t\treturn root->data;\n\n\t}\n\n\tconst T &pop() {\n\n\t\tassert(root);\n\n\t\t--size_;\n\n\t\tconst T &ret = root->data;\n\n\t\tnode_t *n = nullptr, *x = root->left, *y;\n\n\t\twhile (x) {\n\n\t\t\ty = x;\n\n\t\t\tif (x->right) {\n\n\t\t\t\tx = x->right->right;\n\n\t\t\t\ty = merge(y, y->right);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tx = nullptr;\n\n\t\t\t}\n\n\t\t\ty->right = n;\n\n\t\t\tn = y;\n\n\t\t}\n\n\t\tif (!n) {\n\n\t\t\troot = nullptr;\n\n\t\t\treturn ret;\n\n\t\t}\n\n\t\troot = n;\n\n\t\tn = n->right;\n\n\t\twhile (n) {\n\n\t\t\tx = n;\n\n\t\t\tn = n->right;\n\n\t\t\troot = merge(root, x);\n\n\t\t}\n\n\t\troot->per = nullptr;\n\n\t\troot->right = nullptr;\n\n\t\treturn ret;\n\n\t}\n\n\tnode_t *push(const T &data) {\n\n\t\tstatic node_t *pool = nullptr;\n\n\t\tstatic std::uint_fast64_t it = ALLOCSIZE;\n\n\t\tif (it == ALLOCSIZE) {\n\n\t\t\tpool = (node_t *)malloc(ALLOCSIZE * sizeof(node_t));\n\n\t\t\tit = 0;\n\n\t\t}\n\n\t\tnode_t *top = &pool[it++];\n\n\t\ttop->data = data;\n\n\t\ttop->left = top->right = top->per = nullptr;\n\n\t\troot = root ? merge(root, top) : top;\n\n\t\t++size_;\n\n\t\treturn top;\n\n\t}\n\n\tbool empty() { return !root; }\n\n\tstd::uint_fast32_t size() { return size_; }\n\n\tvoid meld(PairingHeap<T, P> &other) {\n\n\t\tsize_ += other.size_;\n\n\t\tother.size_ = 0;\n\n\t\tif (other.root) {\n\n\t\t\troot = root ? merge(root, other.root) : other.root;\n\n\t\t\tother.root = nullptr;\n\n\t\t}\n\n\t}\n\n\tvoid decrease(node_t * x, const T &data) {\n\n\t\tassert(x);\n\n\t\tassert(!(P ^ (x->data < data)));\n\n\t\tif (!x->per) {\n\n\t\t\tx->data = data;\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif (x->right)\n\n\t\t\tx->right->per = x->per;\n\n\t\tif (x->per->right != x)\n\n\t\t\tx->per->left = x->right;\n\n\t\telse\n\n\t\t\tx->per->right = x->right;\n\n\t\tx->per = nullptr;\n\n\t\tx->right = nullptr;\n\n\t\troot = merge(root, x);\n\n\t}\n\n};\n\n//#define NDEBUG\n\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <algorithm>\n\n#include <array>\n\n#include <cassert>\n\n#include <climits>\n\n#include <cmath>\n\n#include <cstdint>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <ctime>\n\n#include <functional>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <stack>\n\n#include <string>\n\n#include <type_traits>\n\n#include <utility>\n\n#include <vector>\n\nstatic constexpr double PI = 3.1415926535897932;\n\n \n\nusing int32 = std::int_fast32_t;\n\nusing int64 = std::int_fast64_t;\n\nusing uint32 = std::uint_fast32_t;\n\nusing uint64 = std::uint_fast64_t;\n\nusing intl32 = std::int_least32_t;\n\nusing intl64 = std::int_least64_t;\n\nusing uintl32 = std::uint_least32_t;\n\nusing uintl64 = std::uint_least64_t;\n\n \n\nnamespace n91 {\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, std::string>::value>::type {\n\n\t\td = std::string();\n\n\t\tint c = 0;\n\n\t\twhile (c < 'a' || 'z' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('a' <= c && c <= 'z') {\n\n\t\t\td.push_back(c);\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_same<T, double>::value>::type {\n\n\t\tscanf(\"%lf\", &d);\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value ==\n\n\t\tstd::is_same<T, std::string>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\twhile (c < '0' || '9' < c)\n\n\t\t\tc = fgetc(stdin);\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t}\n\n\ttemplate <typename T>\n\n\tauto scan(T &d) ->\n\n\t\ttypename std::enable_if<std::is_signed<T>::value !=\n\n\t\tstd::is_same<T, double>::value>::type {\n\n\t\td = 0;\n\n\t\tint c = 0;\n\n\t\tbool f = 0;\n\n\t\twhile (c < '0' || '9' < c) {\n\n\t\t\tif (c == '-')\n\n\t\t\t\tf = 1;\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\twhile ('0' <= c && c <= '9') {\n\n\t\t\td = d * 10 + c - '0';\n\n\t\t\tc = fgetc(stdin);\n\n\t\t}\n\n\t\tif (f)\n\n\t\t\td = -d;\n\n\t}\n\n} // namespace n91\n\nclass UnionFindTree {\n\n\tusing int32 = std::int_fast32_t;\n\n\tusing uint32 = std::uint_fast32_t;\n\n\tstd::vector<int32> tree;\n\n \n\npublic:\n\n\tUnionFindTree(uint32 size) : tree(size, -1) {}\n\n\tuint32 find(const uint32 x) {\n\n\t\tif (tree[x] < 0)\n\n\t\t\treturn x;\n\n\t\treturn tree[x] = (int32)find((uint32)tree[x]);\n\n\t}\n\n\tbool unite(uint32 x, uint32 y) {\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x == y)\n\n\t\t\treturn false;\n\n\t\tif (tree[x] > tree[y])\n\n\t\t\tstd::swap(x, y);\n\n\t\ttree[x] += tree[y];\n\n\t\ttree[y] = (int32)x;\n\n\t\treturn true;\n\n\t}\n\n\tuint32 size(const uint32 x) { return (uint32)(-tree[find(x)]); }\n\n\tbool same(const uint32 x, const uint32 y) { return find(x) == find(y); }\n\n};\n\n \n\nint main(void) {\n\n\tuint32 n, m;\n\n\tn91::scan(n);n91::scan(m);\n\n#define SIZ 100001\n\n\tPairingHeap<uint32> Q[SIZ], P;\n\n\tstd::vector<uint32> r(n, 0), c(n);\n\n\tUnionFindTree U(n);\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tn91::scan(c[i]);\n\n\t}\n\n\tuint32 x, y;\n\n\tfor (uint32 i = 0;i < m;++i) {\n\n\t\tn91::scan(x);n91::scan(y);\n\n\t\tU.unite(x, y);\n\n\t}\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tQ[U.find(i)].push(c[i]);\n\n\t}\n\n\tuint64 cost = 0, node = 0;\n\n\tfor (uint32 i = 0;i < n;++i) {\n\n\t\tif (r[U.find(i)]) continue;\n\n\t\tr[U.find(i)] = 1;\n\n\t\t++node;\n\n\t\tcost += Q[U.find(i)].top();\n\n\t\tQ[U.find(i)].pop();\n\n\t\tP.meld(Q[U.find(i)]);\n\n\t}\n\n\tif (node == 1) {\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (P.size() + 2 < node) {\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (uint32 i = 2;i < node;++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\tprintf(\"%lu\\n\", cost);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cassert>\n\n#include <cstddef>\n\n#include <utility>\n\n\n\ntemplate <template <class> class Container> class union_find {\n\nprotected:\n\n\tclass node_type;\n\n\n\npublic:\n\n\tusing container_type = Container<node_type>;\n\n\tusing size_type = typename container_type::size_type;\n\n\n\nprotected:\n\n\tclass node_type {\n\n\tpublic:\n\n\t\ttypename union_find::size_type parent, size;\n\n\t};\n\n\tcontainer_type c;\n\n\n\npublic:\n\n\tunion_find() : c() {}\n\n\texplicit union_find(const size_type size) : c(size, { 0, 1 }) {\n\n\t\tfor (size_type i = 0; i < size; ++i)\n\n\t\t\tc[i].parent = i;\n\n\t}\n\n\n\n\tbool empty() const { return c.empty(); }\n\n\tsize_type size() const { return c.size(); }\n\n\n\n\tsize_type find(size_type x) {\n\n\t\tassert(x < size());\n\n\t\twhile (c[x].parent != x)\n\n\t\t\tx = c[x].parent = c[c[x].parent].parent;\n\n\t\treturn x;\n\n\t}\n\n\tbool same(const size_type x, const size_type y) {\n\n\t\tassert(x < size());\n\n\t\tassert(y < size());\n\n\t\treturn find(x) == find(y);\n\n\t}\n\n\tsize_type size(const size_type x) {\n\n\t\tassert(x < size());\n\n\t\treturn c[find(x)].size;\n\n\t}\n\n\n\n\t::std::pair<size_type, size_type> unite(size_type x, size_type y) {\n\n\t\tassert(x < size());\n\n\t\tassert(y < size());\n\n\t\tx = find(x);\n\n\t\ty = find(y);\n\n\t\tif (x != y) {\n\n\t\t\tif (c[x].size < c[y].size)\n\n\t\t\t\t::std::swap(x, y);\n\n\t\t\tc[x].size += c[y].size;\n\n\t\t\tc[y].parent = x;\n\n\t\t}\n\n\t\treturn { x, y };\n\n\t}\n\n};\n\n\n\n#include <cassert>\n\n#include <cstddef>\n\n#include <memory>\n\n#include <utility>\n\n\n\ntemplate <class TotallyOrderedSet> class pairing_heap {\n\n\n\npublic:\n\n\tusing value_structure = TotallyOrderedSet;\n\n\tusing value_type = typename value_structure::value_type;\n\n\tusing const_reference = const value_type &;\n\n\tusing size_type = ::std::size_t;\n\n\n\nprivate:\n\n\tclass node_type {\n\n\tpublic:\n\n\t\tvalue_type value;\n\n\t\t::std::pair<::std::unique_ptr<node_type>, ::std::unique_ptr<node_type>>\n\n\t\t\tchild;\n\n\t\ttemplate <class... Args>\n\n\t\tnode_type(Args &&... args)\n\n\t\t\t: value(::std::forward<Args>(args)...), child() {}\n\n\t};\n\n\tusing pointer = ::std::unique_ptr<node_type>;\n\n\tpointer root;\n\n\tsize_type s;\n\n\tstatic pointer merge(pointer x, pointer y) {\n\n\t\tif (!x)\n\n\t\t\treturn y;\n\n\t\tif (!y)\n\n\t\t\treturn x;\n\n\t\tif (!value_structure::operation(x->value, y->value))\n\n\t\t\tx.swap(y);\n\n\t\ty->child.second = ::std::move(x->child.first);\n\n\t\tx->child.first = ::std::move(y);\n\n\t\treturn x;\n\n\t}\n\n\tstatic pointer mergelist(pointer curr) {\n\n\t\tpointer head, temp, next;\n\n\t\twhile (curr) {\n\n\t\t\tnext = ::std::move(curr->child.second);\n\n\t\t\tif (next) {\n\n\t\t\t\ttemp = ::std::move(next->child.second);\n\n\t\t\t\tcurr = merge(::std::move(curr), ::std::move(next));\n\n\t\t\t}\n\n\t\t\tcurr->child.second = ::std::move(head);\n\n\t\t\thead = ::std::move(curr);\n\n\t\t\tcurr = ::std::move(temp);\n\n\t\t}\n\n\t\tif (head) {\n\n\t\t\tcurr = ::std::move(head);\n\n\t\t\thead = ::std::move(curr->child.second);\n\n\t\t}\n\n\t\twhile (head) {\n\n\t\t\tnext = ::std::move(head->child.second);\n\n\t\t\tcurr = merge(::std::move(curr), ::std::move(head));\n\n\t\t\thead = ::std::move(next);\n\n\t\t}\n\n\t\treturn curr;\n\n\t}\n\n\n\npublic:\n\n\tpairing_heap() noexcept : root(), s(0) {}\n\n\n\n\tbool empty() const noexcept { return !root; }\n\n\tsize_type size() const noexcept { return s; }\n\n\n\n\tconst_reference top() const noexcept {\n\n\t\tassert(!empty());\n\n\t\treturn root->value;\n\n\t}\n\n\n\n\tvoid push(const value_type &x) {\n\n\t\troot = merge(::std::move(root), ::std::make_unique<node_type>(x));\n\n\t\t++s;\n\n\t}\n\n\tvoid push(value_type &&x) {\n\n\t\troot =\n\n\t\t\tmerge(::std::move(root), ::std::make_unique<node_type>(::std::move(x)));\n\n\t\t++s;\n\n\t}\n\n\ttemplate <class... Args> void emplace(Args &&... args) {\n\n\t\troot = merge(::std::move(root),\n\n\t\t\t::std::make_unique<node_type>(::std::forward<Args>(args)...));\n\n\t\t++s;\n\n\t}\n\n\n\n\tvoid pop() {\n\n\t\tassert(!empty());\n\n\t\troot = mergelist(::std::move(root->child.first));\n\n\t\t--s;\n\n\t}\n\n\n\n\tvoid meld(pairing_heap &other) {\n\n\t\ts += other.s;\n\n\t\tother.s = 0;\n\n\t\troot = merge(::std::move(root), ::std::move(other.root));\n\n\t}\n\n\tpairing_heap &operator+=(pairing_heap &other) {\n\n\t\tmeld(other);\n\n\t\treturn *this;\n\n\t}\n\n};\n\n\n\ntemplate <class T> class forward_order_set {\n\npublic:\n\n\tusing value_type = T;\n\n\tstatic bool operation(const value_type &x, const value_type &y) {\n\n\t\treturn x <= y;\n\n\t}\n\n};\n\n\n\n\n\n#include<iostream>\n\n#include<tuple>\n\n#include<vector>\n\n\n\ntemplate<class T>\n\nusing vec = ::std::vector<T>;\n\n\n\nint main(void) {\n\n\tint n, m;\n\n\t::std::cin >> n >> m;\n\n\t::std::vector<pairing_heap<forward_order_set<int>>> Q(n);\n\n\tunion_find<vec> T(n);\n\n\tfor (int i = 0; i < n; ++i) {\n\n\t\tint a;\n\n\t\t::std::cin >> a;\n\n\t\tQ[i].push(a);\n\n\t}\n\n\tfor (int i = 0; i < m; ++i) {\n\n\t\tint x, y;\n\n\t\t::std::cin >> x >> y;\n\n\t\t::std::tie(x, y) = T.unite(x, y);\n\n\t\tif (x != y)\n\n\t\t\tQ[x].meld(Q[y]);\n\n\t}\n\n\t::std::vector<union_find<vec>::size_type> R;\n\n\tfor (int i = 0;i < n;++i)\n\n\t\tif (T.find(i) == i)\n\n\t\t\tR.push_back(i);\n\n\tif (R.size() == 1) {\n\n\t\t::std::cout << \"0\" << ::std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tlong long cost = 0;\n\n\tpairing_heap<forward_order_set<int>> P;\n\n\tfor (const auto i : R) {\n\n\t\tcost += Q[i].top();\n\n\t\tQ[i].pop();\n\n\t\tP += Q[i];\n\n\t}\n\n\tif (P.size() + 2 < R.size()) {\n\n\t\t::std::cout << \"Impossible\" << ::std::endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int i = 2; i < R.size(); ++i) {\n\n\t\tcost += P.top();\n\n\t\tP.pop();\n\n\t}\n\n\t::std::cout << cost << ::std::endl;\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "188",
        "source_code": "//\u5de6\u624b\u62c8\u7740\u82b1\uff0c\u53f3\u624b\u821e\u7740\u5251 \n\n#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<cstring>\n\n#include<map>\n\n#include<vector>\n\n#include<queue>\n\n#define ll long long\n\n#define pi pair<int,int>\n\n#define mp(a,b) make_pair(a,b)\n\nusing namespace std;\n\nconst int N=100005;priority_queue\n\n<pi,vector<pi>,greater<pi> >q[N];\n\nint val[N],fa[N],rk[N],n,m,k;vector<pi>v;\n\nvoid take(){\n\n\tfor(int i=0;i<=n;i++)\n\n\tfa[i]=i,rk[i]=0;\n\n} int get(int x){\n\n\treturn fa[x]==x?x:fa[x]=get(fa[x]);\n\n} void merge(int x,int y){\n\n\tx=get(x);y=get(y);\n\n\tif(x==y) return ;\n\n\tif(rk[x]<rk[y]) fa[x]=y;\n\n\telse{\n\n\t\tfa[y]=x;if(rk[x]==rk[y]) rk[x]++;\n\n\t}\n\n} int main(){\n\n\tll ans=0;scanf(\"%d%d\",&n,&m);take();\n\n\tfor(int i=0;i<n;i++) scanf(\"%d\",&val[i]);\n\n\tfor(int i=0,x,y;i<m;i++){\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tint fx=get(x),fy=get(y);\n\n\t\tif(fx!=fy) merge(fx,fy);\n\n\t} for(int i=0;i<n;i++)\n\n\tq[get(i)].push(mp(val[i],i));\n\n\tfor(int i=0;i<n;i++)\n\n\tif(!q[i].empty()) v.push_back(q[i].top()),\n\n\tval[q[i].top().second]=2e9,\n\n\tans+=q[i].top().first;\n\n\tif(v.size()==1) puts(\"0\");\n\n\telse if(n<(v.size()-1)*2)\n\n\tputs(\"Impossible\");else{\n\n\t\tsort(val,val+n);\n\n\t\tn=(v.size()-1)*2-v.size();\n\n\t\tfor(int i=0;i<n;i++) ans+=val[i];\n\n\t\tcout<<ans<<endl; \n\n\t} return 0;\n\n}",
        "optimized_code": "#pragma GCC optimize(2)\n\n#include<bits/stdc++.h>\n\n#define N 100005\n\n#define int long long\n\nusing namespace std;\n\n\n\n#define v1 first\n\n#define v2 second\n\n#define pb push_back\n\n#define mid ((l+r)>>1)\n\n#define vec vector<int>\n\n#define pr pair<int,int>\n\n#define tp tuple<int,int,int>\n\n#define sz(x) ((int) x.size())\n\n#define all(x) x.begin(),x.end()\n\n#define mem(a,x) memset(a,x,sizeof a)\n\n#define For(x) for(int y,i=head[x];(y=e[i].to);i=e[i].nxt)\n\n\n\ninline bool rd(int &X)\n\n{\n\n    X=0;int w=0;char ch=0;\n\n    while(!isdigit(ch))w|=ch=='-',ch=getchar();\n\n    while( isdigit(ch))X=(X<<3)+(X<<1)+(ch^48),ch=getchar();\n\n    X=w?-X:X; return 1;\n\n}\n\n\n\nvec now;\n\nint n,m,tot,ans;\n\nint a[N],vis[N],u[N];\n\nint head[N],cnt,mn[N];\n\nstruct nd{int nxt,to;}e[N<<1];\n\n#define For(x) for(int y,i=head[x];(y=e[i].to);i=e[i].nxt)\n\n\n\nvoid add(int x,int y){\n\n    e[++cnt]=(nd){head[x],y};head[x]=cnt;\n\n    e[++cnt]=(nd){head[y],x};head[y]=cnt;\n\n}\n\nvoid dfs(int x){\n\n    if(a[x]<a[mn[tot]]) mn[tot]=x;\n\n    For(x) if(!vis[y])\n\n        vis[y]=1,dfs(y);\n\n}\n\nsigned main()\n\n{\n\n    rd(n);rd(m); a[0]=2e9;\n\n\n\n    for(int i=1;i<=n;i++) rd(a[i]);\n\n    for(int x,y,i=1;i<=m;i++)\n\n        rd(x),rd(y),add(x+1,y+1);\n\n    for(int i=1;i<=n;i++)\n\n        if(!vis[i]) ++tot,dfs(i);\n\n    if(tot==1) return cout<<0,0;\n\n    if(n<2*(tot-1)) return cout<<\"Impossible\",0;\n\n    for(int i=1;i<=tot;i++)\n\n        u[mn[i]]=1,ans+=a[mn[i]];\n\n    for(int i=1;i<=n;i++)\n\n        if(!u[i]) now.pb(a[i]);\n\n    sort(all(now));\n\n    for(int i=1;i<=2*(tot-1)-tot;i++)\n\n        ans+=now[i-1];\n\n    cout<<ans;\n\n}\n"
    },
    {
        "id": "189",
        "source_code": "#include<cstdio>\n\n#include<set>\n\n#include<algorithm>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\nstruct node{\n\n\tint num, key, vis;\n\n};\n\nnode a[MAXN + 5];\n\nbool operator < (node a, node b) {\n\n\treturn a.key < b.key;\n\n}\n\nset<node>Set[MAXN + 5];\n\nint fa[MAXN + 5];\n\nint Find(int x) {\n\n\tif( fa[x] == x ) return x;\n\n\treturn fa[x] = Find(fa[x]);\n\n}\n\nint main() {\n\n\tint N, M, cnt = 0;\n\n\tscanf(\"%d%d\", &N, &M);\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tscanf(\"%d\", &a[i].key);\n\n\t\ta[i].num = fa[i] = i;\n\n\t}\n\n\tint ned = ((N-1) - M) * 2;\n\n\tif( ned > N ) {\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i=1;i<=M;i++) {\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tfa[Find(u)] = Find(v);\n\n\t}\n\n\tfor(int i=0;i<N;i++)\n\n\t\tSet[Find(i)].insert(a[i]);\n\n\tlong long ans = 0;\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tif( Find(i) == i ) {\n\n\t\t\tif( cnt == ned ) continue;\n\n\t\t\tans += Set[i].begin()->key;\n\n\t\t\ta[(*Set[i].begin()).num].vis = true;\n\n\t\t\tcnt++;\n\n\t\t}\n\n\t}\n\n\tsort(a, a+N);\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tif( cnt == ned ) break;\n\n\t\tif( a[i].vis ) continue;\n\n\t\tcnt++;\n\n\t\tans += a[i].key;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<vector>\n\n#include<algorithm>\n\nusing namespace std;\n\n\n\nint a[100001],f[100001];\n\nint ff(int u){\n\n\treturn f[u]==u?u:f[u]=ff(f[u]);\n\n}\n\nvector<int>g[100001];\n\nint c[100001];\n\nint main(){\n\n\tint n,m;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tscanf(\"%d\",&a[i]),\n\n\t\tf[i]=i;\n\n\tfor(int i=1;i<=m;i++){\n\n\t\tint u,v;\n\n\t\tscanf(\"%d%d\",&u,&v);\n\n\t\tu++;v++;\n\n\t\tf[ff(u)]=ff(v);\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tg[ff(i)].push_back(a[i]);\n\n\tlong long ans=0;\n\n\tint z=0;\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tif(i==ff(i)){\n\n\t\t\tz++;\n\n\t\t\tsort(g[i].begin(),g[i].end());\n\n\t\t\tans+=g[i][0];\n\n\t\t\tfor(int j=1;j<g[i].size();j++)\n\n\t\t\t\tc[++c[0]]=g[i][j];\n\n\t\t}\n\n\tif(z==1){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(c[0]<z-2){\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tsort(c+1,c+c[0]+1);\n\n\tfor(int i=1;i<=z-2;i++)\n\n\t\tans+=c[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n}\n"
    },
    {
        "id": "190",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\nconst int maxn=100010;\n\nmultiset<int> S[maxn];\n\nset<pair<int,int> > S2;\n\nstruct Edge\n\n{\n\n\tint v,next;\n\n}\te[maxn<<1];\n\nint g[maxn],tot;\n\nvoid addedge(int x,int y)\n\n{\n\n\ttot++;\n\n\te[tot].v=y;\n\n\te[tot].next=g[x];\n\n\tg[x]=tot;\n\n}\n\nint n,m;\n\nbool vis[maxn];\n\nint a[maxn];\n\n\n\nvoid dfs(int t,int ha)\n\n{\n\n\tS[ha].insert(a[t]);\n\n\tvis[t]=true;\n\n\tfor (int i=g[t];i;i=e[i].next)\n\n\tif (!vis[e[i].v])\n\n\t\tdfs(e[i].v,ha);\n\n}\n\nint Union(pair<int,int> x,pair<int,int> y)\n\n{\n\n\tmultiset<int>::iterator it=S[x.second].lower_bound(x.first);\n\n\tS[x.second].erase(it);\n\n\tit=S[y.second].lower_bound(y.first);\n\n\tS[y.second].erase(it);\n\n\tint l=x.second,r=y.second;\n\n\tif (S[l].size()>S[r].size())\tswap(l,r);\n\n\tfor (auto i:S[l])\n\n\t\tS[r].insert(i);\n\n\tS[l].clear();\n\n\treturn r;\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int i=1;i<=n;i++)\tscanf(\"%d\",&a[i]);\n\n\tfor (int i=1;i<=m;i++)\n\n\t{\n\n\t\tint x,y;\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tx++;y++;\n\n\t\taddedge(x,y);\n\n\t\taddedge(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;i++)\n\n\tif (!vis[i])\n\n\t\tdfs(i,i);\n\n\tfor (int i=1;i<=n;i++)\n\n\t\tif (!S[i].empty())\n\n\t\t\tS2.insert(make_pair(S[i].size(),i));\n\n\tll ans=0;\n\n\tfor (int i=1;i<=n-1-m;i++)\n\n\t{\n\n\t\tif (S2.empty())\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tpair<int,int> tmp1=*--S2.end();\n\n\t\tS2.erase(--S2.end());\n\n\t\tif (S2.empty())\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tpair<int,int> tmp2=*--S2.end();\n\n\t\tS2.erase(--S2.end());\n\n\t\ttmp1.first=*S[tmp1.second].begin();\n\n\t\ttmp2.first=*S[tmp2.second].begin();\n\n\t\tans+=tmp1.first+tmp2.first;\n\n\t\tint q=Union(tmp1,tmp2);\n\n\t\tif (!S[q].empty())\tS2.insert(make_pair(S[q].size(),q));\n\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<vector>\n\n#include<algorithm>\n\nusing namespace std;\n\n\n\nint a[100001],f[100001];\n\nint ff(int u){\n\n\treturn f[u]==u?u:f[u]=ff(f[u]);\n\n}\n\nvector<int>g[100001];\n\nint c[100001];\n\nint main(){\n\n\tint n,m;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tscanf(\"%d\",&a[i]),\n\n\t\tf[i]=i;\n\n\tfor(int i=1;i<=m;i++){\n\n\t\tint u,v;\n\n\t\tscanf(\"%d%d\",&u,&v);\n\n\t\tu++;v++;\n\n\t\tf[ff(u)]=ff(v);\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tg[ff(i)].push_back(a[i]);\n\n\tlong long ans=0;\n\n\tint z=0;\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tif(i==ff(i)){\n\n\t\t\tz++;\n\n\t\t\tsort(g[i].begin(),g[i].end());\n\n\t\t\tans+=g[i][0];\n\n\t\t\tfor(int j=1;j<g[i].size();j++)\n\n\t\t\t\tc[++c[0]]=g[i][j];\n\n\t\t}\n\n\tif(z==1){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(c[0]<z-2){\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tsort(c+1,c+c[0]+1);\n\n\tfor(int i=1;i<=z-2;i++)\n\n\t\tans+=c[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n}\n"
    },
    {
        "id": "191",
        "source_code": "#include<cstdio>\n\n#include<set>\n\n#include<algorithm>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\nstruct node{\n\n\tint num, key, vis;\n\n};\n\nnode a[MAXN + 5];\n\nbool operator < (node a, node b) {\n\n\treturn a.key < b.key;\n\n}\n\nset<node>Set[MAXN + 5];\n\nint fa[MAXN + 5];\n\nint Find(int x) {\n\n\tif( fa[x] == x ) return x;\n\n\treturn fa[x] = Find(fa[x]);\n\n}\n\nint main() {\n\n\tint N, M, cnt = 0;\n\n\tscanf(\"%d%d\", &N, &M);\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tscanf(\"%d\", &a[i].key);\n\n\t\ta[i].num = fa[i] = i;\n\n\t}\n\n\tint ned = ((N-1) - M) * 2;\n\n\tif( ned > N ) {\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i=1;i<=M;i++) {\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tfa[Find(u)] = Find(v);\n\n\t}\n\n\tfor(int i=0;i<N;i++)\n\n\t\tSet[Find(i)].insert(a[i]);\n\n\tlong long ans = 0;\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tif( Find(i) == i ) {\n\n\t\t\tif( cnt == ned ) continue;\n\n\t\t\tans += Set[i].begin()->key;\n\n\t\t\ta[(*Set[i].begin()).num].vis = true;\n\n\t\t\tcnt++;\n\n\t\t}\n\n\t}\n\n\tsort(a, a+N);\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tif( cnt == ned ) break;\n\n\t\tif( a[i].vis ) continue;\n\n\t\tcnt++;\n\n\t\tans += a[i].key;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n}",
        "optimized_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n"
    },
    {
        "id": "192",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\nconst int maxn=100010;\n\nmultiset<int> S[maxn];\n\nset<pair<int,int> > S2;\n\nstruct Edge\n\n{\n\n\tint v,next;\n\n}\te[maxn<<1];\n\nint g[maxn],tot;\n\nvoid addedge(int x,int y)\n\n{\n\n\ttot++;\n\n\te[tot].v=y;\n\n\te[tot].next=g[x];\n\n\tg[x]=tot;\n\n}\n\nint n,m;\n\nbool vis[maxn];\n\nint a[maxn];\n\n\n\nvoid dfs(int t,int ha)\n\n{\n\n\tS[ha].insert(a[t]);\n\n\tvis[t]=true;\n\n\tfor (int i=g[t];i;i=e[i].next)\n\n\tif (!vis[e[i].v])\n\n\t\tdfs(e[i].v,ha);\n\n}\n\nint Union(pair<int,int> x,pair<int,int> y)\n\n{\n\n\tmultiset<int>::iterator it=S[x.second].lower_bound(x.first);\n\n\tS[x.second].erase(it);\n\n\tit=S[y.second].lower_bound(y.first);\n\n\tS[y.second].erase(it);\n\n\tint l=x.second,r=y.second;\n\n\tif (S[l].size()>S[r].size())\tswap(l,r);\n\n\tfor (auto i:S[l])\n\n\t\tS[r].insert(i);\n\n\tS[l].clear();\n\n\treturn r;\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int i=1;i<=n;i++)\tscanf(\"%d\",&a[i]);\n\n\tfor (int i=1;i<=m;i++)\n\n\t{\n\n\t\tint x,y;\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tx++;y++;\n\n\t\taddedge(x,y);\n\n\t\taddedge(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;i++)\n\n\tif (!vis[i])\n\n\t\tdfs(i,i);\n\n\tfor (int i=1;i<=n;i++)\n\n\t\tif (!S[i].empty())\n\n\t\t\tS2.insert(make_pair(S[i].size(),i));\n\n\tll ans=0;\n\n\tfor (int i=1;i<=n-1-m;i++)\n\n\t{\n\n\t\tif (S2.empty())\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tpair<int,int> tmp1=*--S2.end();\n\n\t\tS2.erase(--S2.end());\n\n\t\tif (S2.empty())\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tpair<int,int> tmp2=*--S2.end();\n\n\t\tS2.erase(--S2.end());\n\n\t\ttmp1.first=*S[tmp1.second].begin();\n\n\t\ttmp2.first=*S[tmp2.second].begin();\n\n\t\tans+=tmp1.first+tmp2.first;\n\n\t\tint q=Union(tmp1,tmp2);\n\n\t\tif (!S[q].empty())\tS2.insert(make_pair(S[q].size(),q));\n\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n"
    },
    {
        "id": "193",
        "source_code": "#include<cstdio>\n\n#include<set>\n\n#include<algorithm>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\nstruct node{\n\n\tint num, key, vis;\n\n};\n\nnode a[MAXN + 5];\n\nbool operator < (node a, node b) {\n\n\treturn a.key < b.key;\n\n}\n\nset<node>Set[MAXN + 5];\n\nint fa[MAXN + 5];\n\nint Find(int x) {\n\n\tif( fa[x] == x ) return x;\n\n\treturn fa[x] = Find(fa[x]);\n\n}\n\nint main() {\n\n\tint N, M, cnt = 0;\n\n\tscanf(\"%d%d\", &N, &M);\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tscanf(\"%d\", &a[i].key);\n\n\t\ta[i].num = fa[i] = i;\n\n\t}\n\n\tint ned = ((N-1) - M) * 2;\n\n\tif( ned > N ) {\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i=1;i<=M;i++) {\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tfa[Find(u)] = Find(v);\n\n\t}\n\n\tfor(int i=0;i<N;i++)\n\n\t\tSet[Find(i)].insert(a[i]);\n\n\tlong long ans = 0;\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tif( Find(i) == i ) {\n\n\t\t\tif( cnt == ned ) continue;\n\n\t\t\tans += Set[i].begin()->key;\n\n\t\t\ta[(*Set[i].begin()).num].vis = true;\n\n\t\t\tcnt++;\n\n\t\t}\n\n\t}\n\n\tsort(a, a+N);\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tif( cnt == ned ) break;\n\n\t\tif( a[i].vis ) continue;\n\n\t\tcnt++;\n\n\t\tans += a[i].key;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn = 1e5+100;\n\ntypedef long long LL;\n\nint val[maxn],First[maxn],cnt,N,M;\n\nint tot,pre[maxn];\n\nLL ans = 0;\n\nstruct node{\n\n    int to,Next;\n\n}Tree[maxn*2];\n\nvoid init(){\n\n    memset(First,-1,sizeof(First));\n\n    cnt = 0;\n\n}\n\nvoid addedge(int from,int to){\n\n    Tree[cnt].to = to;\n\n    Tree[cnt].Next = First[from];\n\n    First[from] = cnt++;\n\n}\n\npriority_queue<int,vector<int>,greater<int> > Q[maxn];\n\nvoid dfs(int u,int fa){\n\n    pre[u] = 1;\n\n    Q[tot].push(val[u]);\n\n    for(int i = First[u];i!=-1;i=Tree[i].Next){\n\n        int to = Tree[i].to;\n\n        if(to==fa)continue;\n\n        dfs(to,u);\n\n    }\n\n}\n\nvector<int> ac,bc;\n\nint main(){\n\n    init();\n\n    scanf(\"%d%d\",&N,&M);\n\n    for(int i = 0;i<=N-1;i++)scanf(\"%d\",&val[i]);\n\n    for(int i = 0;i<M;i++){\n\n        int a,b;\n\n        scanf(\"%d%d\",&a,&b);\n\n        addedge(a,b);\n\n        addedge(b,a);\n\n    }\n\n    for(int i = 0;i<=N-1;i++){\n\n        if(!pre[i]){\n\n            tot++;\n\n            dfs(i,-1);\n\n            ac.push_back(tot);\n\n        }\n\n    }\n\n    if(tot==1){\n\n        printf(\"%d\\n\",0);\n\n        return 0;\n\n    }\n\n    bool flag = 0;\n\n    priority_queue<int,vector<int>,greater<int> >QQ;\n\n    for(int i = 1;i<=tot;i++){\n\n       ans+=Q[i].top();\n\n       Q[i].pop();\n\n       while(!Q[i].empty()){\n\n        QQ.push(Q[i].top());\n\n        Q[i].pop();\n\n       }\n\n    }\n\n    int my =tot-2;\n\n    if(QQ.size()<my){\n\n        printf(\"Impossible\\n\");\n\n        return 0;\n\n    }\n\n    for(int i = 0;i<my;i++){\n\n        ans+=QQ.top();\n\n        QQ.pop();\n\n    }\n\n    printf(\"%lld\\n\",ans);\n\n    return 0;\n\n}\n\n/*\n\n7 4\n\n1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000\n\n0 1\n\n1 2\n\n3 4\n\n5 6\n\n6 3\n\n1 1 1 3 7 8\n\n0 4\n\n1 5\n\n2 3\n\n*/\n"
    },
    {
        "id": "194",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\nconst int maxn=100010;\n\nmultiset<int> S[maxn];\n\nset<pair<int,int> > S2;\n\nstruct Edge\n\n{\n\n\tint v,next;\n\n}\te[maxn<<1];\n\nint g[maxn],tot;\n\nvoid addedge(int x,int y)\n\n{\n\n\ttot++;\n\n\te[tot].v=y;\n\n\te[tot].next=g[x];\n\n\tg[x]=tot;\n\n}\n\nint n,m;\n\nbool vis[maxn];\n\nint a[maxn];\n\n\n\nvoid dfs(int t,int ha)\n\n{\n\n\tS[ha].insert(a[t]);\n\n\tvis[t]=true;\n\n\tfor (int i=g[t];i;i=e[i].next)\n\n\tif (!vis[e[i].v])\n\n\t\tdfs(e[i].v,ha);\n\n}\n\nint Union(pair<int,int> x,pair<int,int> y)\n\n{\n\n\tmultiset<int>::iterator it=S[x.second].lower_bound(x.first);\n\n\tS[x.second].erase(it);\n\n\tit=S[y.second].lower_bound(y.first);\n\n\tS[y.second].erase(it);\n\n\tint l=x.second,r=y.second;\n\n\tif (S[l].size()>S[r].size())\tswap(l,r);\n\n\tfor (auto i:S[l])\n\n\t\tS[r].insert(i);\n\n\tS[l].clear();\n\n\treturn r;\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int i=1;i<=n;i++)\tscanf(\"%d\",&a[i]);\n\n\tfor (int i=1;i<=m;i++)\n\n\t{\n\n\t\tint x,y;\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tx++;y++;\n\n\t\taddedge(x,y);\n\n\t\taddedge(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;i++)\n\n\tif (!vis[i])\n\n\t\tdfs(i,i);\n\n\tfor (int i=1;i<=n;i++)\n\n\t\tif (!S[i].empty())\n\n\t\t\tS2.insert(make_pair(S[i].size(),i));\n\n\tll ans=0;\n\n\tfor (int i=1;i<=n-1-m;i++)\n\n\t{\n\n\t\tif (S2.empty())\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tpair<int,int> tmp1=*--S2.end();\n\n\t\tS2.erase(--S2.end());\n\n\t\tif (S2.empty())\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tpair<int,int> tmp2=*--S2.end();\n\n\t\tS2.erase(--S2.end());\n\n\t\ttmp1.first=*S[tmp1.second].begin();\n\n\t\ttmp2.first=*S[tmp2.second].begin();\n\n\t\tans+=tmp1.first+tmp2.first;\n\n\t\tint q=Union(tmp1,tmp2);\n\n\t\tif (!S[q].empty())\tS2.insert(make_pair(S[q].size(),q));\n\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn = 1e5+100;\n\ntypedef long long LL;\n\nint val[maxn],First[maxn],cnt,N,M;\n\nint tot,pre[maxn];\n\nLL ans = 0;\n\nstruct node{\n\n    int to,Next;\n\n}Tree[maxn*2];\n\nvoid init(){\n\n    memset(First,-1,sizeof(First));\n\n    cnt = 0;\n\n}\n\nvoid addedge(int from,int to){\n\n    Tree[cnt].to = to;\n\n    Tree[cnt].Next = First[from];\n\n    First[from] = cnt++;\n\n}\n\npriority_queue<int,vector<int>,greater<int> > Q[maxn];\n\nvoid dfs(int u,int fa){\n\n    pre[u] = 1;\n\n    Q[tot].push(val[u]);\n\n    for(int i = First[u];i!=-1;i=Tree[i].Next){\n\n        int to = Tree[i].to;\n\n        if(to==fa)continue;\n\n        dfs(to,u);\n\n    }\n\n}\n\nvector<int> ac,bc;\n\nint main(){\n\n    init();\n\n    scanf(\"%d%d\",&N,&M);\n\n    for(int i = 0;i<=N-1;i++)scanf(\"%d\",&val[i]);\n\n    for(int i = 0;i<M;i++){\n\n        int a,b;\n\n        scanf(\"%d%d\",&a,&b);\n\n        addedge(a,b);\n\n        addedge(b,a);\n\n    }\n\n    for(int i = 0;i<=N-1;i++){\n\n        if(!pre[i]){\n\n            tot++;\n\n            dfs(i,-1);\n\n            ac.push_back(tot);\n\n        }\n\n    }\n\n    if(tot==1){\n\n        printf(\"%d\\n\",0);\n\n        return 0;\n\n    }\n\n    bool flag = 0;\n\n    priority_queue<int,vector<int>,greater<int> >QQ;\n\n    for(int i = 1;i<=tot;i++){\n\n       ans+=Q[i].top();\n\n       Q[i].pop();\n\n       while(!Q[i].empty()){\n\n        QQ.push(Q[i].top());\n\n        Q[i].pop();\n\n       }\n\n    }\n\n    int my =tot-2;\n\n    if(QQ.size()<my){\n\n        printf(\"Impossible\\n\");\n\n        return 0;\n\n    }\n\n    for(int i = 0;i<my;i++){\n\n        ans+=QQ.top();\n\n        QQ.pop();\n\n    }\n\n    printf(\"%lld\\n\",ans);\n\n    return 0;\n\n}\n\n/*\n\n7 4\n\n1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000\n\n0 1\n\n1 2\n\n3 4\n\n5 6\n\n6 3\n\n1 1 1 3 7 8\n\n0 4\n\n1 5\n\n2 3\n\n*/\n"
    },
    {
        "id": "195",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<cmath>\n\n#include<vector>\n\n#define SF scanf\n\n#define PF printf\n\n#define MAXN 100010\n\nusing namespace std;\n\nint n,m,sum;\n\nvector<int> a[MAXN];\n\nbool vis[MAXN],used[MAXN];\n\nint val[MAXN],b[MAXN];\n\nlong long ans;\n\nint dfs(int x){\n\n    vis[x]=1;\n\n    int idx=x;\n\n    for(int i=0;i<a[x].size();i++)\n\n        if(vis[a[x][i]]==0){\n\n            int id=dfs(a[x][i]);\n\n            if(val[id]<val[idx])\n\n                idx=id;\n\n        }\n\n    return idx;\n\n}\n\nint main(){\n\n    SF(\"%d%d\",&n,&m);\n\n    int u,v;\n\n    for(int i=0;i<n;i++)\n\n        SF(\"%d\",&val[i]);\n\n    for(int i=0;i<m;i++){\n\n        SF(\"%d%d\",&u,&v);\n\n        a[u].push_back(v);\n\n        a[v].push_back(u);\n\n    }\n\n    for(int i=0;i<n;i++)\n\n        if(vis[i]==0){\n\n            int maxid=dfs(i);\n\n            used[maxid]=1;\n\n            sum++;\n\n        }\n\n    int cnt=2*sum-2,tot=0;\n\n    if(sum==1){\n\n        PF(\"0\");\n\n        return 0;\n\n    }\n\n    for(int i=0;i<n;i++)\n\n        if(used[i]==1)\n\n            ans+=val[i];\n\n    cnt-=sum;\n\n    for(int i=0;i<n;i++)\n\n        if(used[i]==0)\n\n            b[++tot]=val[i];\n\n    if(cnt>tot){\n\n        PF(\"Impossible\");\n\n        return 0;\n\n    }\n\n    sort(b+1,b+1+tot);\n\n    for(int i=1;i<=cnt;i++)\n\n        ans+=b[i];\n\n    PF(\"%lld\\n\",ans);\n\n}\n",
        "optimized_code": "#include <iostream>\n\n#include<cstdio>\n\n#include<set>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\n#include<cmath>\n\n#include<cstdlib>\n\n#include<algorithm>\n\n#include<string>\n\n#include<cstring>\n\n\n\nusing namespace std;\n\n\n\nint a[100005],fa[100005],vis[100005],mi[100005];\n\npriority_queue<pair<int,int>, vector<pair<int,int> >, greater<pair<int,int> > >q;\n\n\n\nint _find(int x)\n\n{\n\n    return fa[x]==x?x:fa[x]=_find(fa[x]);\n\n}\n\n\n\nvoid _merge(int x,int y)\n\n{\n\n    int fx=_find(x),fy=_find(y);\n\n    if(fx!=fy)\n\n    {\n\n        fa[fx]=fy;\n\n    }\n\n}\n\nint main()\n\n{\n\n\tint n,m;\n\n\tscanf(\"%d %d\",&n,&m);\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t    scanf(\"%d\",&a[i]);\n\n\t    fa[i]=i;\n\n\t    mi[i]=1e9+9;\n\n\t}\n\n\tint x,y;\n\n\tfor(int i=0;i<m;i++)\n\n    {\n\n        scanf(\"%d %d\",&x,&y);\n\n        _merge(x,y);\n\n    }\n\n\tfor(int i=0;i<n;i++)\n\n        _find(i);\n\n    pair<int,int>tt;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t    mi[fa[i]]=min(a[i],mi[fa[i]]);\n\n\n\n\t    tt.first=a[i];\n\n\t    tt.second=fa[i];\n\n\t    q.push(tt);\n\n\t}\n\n\tsort(fa,fa+n);\n\n\tint cnt=unique(fa,fa+n)-fa;\n\n\tif(cnt==1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        long long ans=0;\n\n        for(int i=0;i<cnt;i++)\n\n            ans+=mi[fa[i]];\n\n        while(!q.empty())\n\n        {\n\n            if(cnt==2)\n\n                break;\n\n            pair<int,int>tmp;\n\n            tmp=q.top();\n\n            q.pop();\n\n            if(vis[tmp.second]==0)\n\n            {\n\n                vis[tmp.second]=1;\n\n                continue;\n\n            }\n\n            ans+=tmp.first;\n\n            cnt--;\n\n        }\n\n        if(cnt==2)\n\n            printf(\"%lld\\n\",ans);\n\n        else\n\n            printf(\"Impossible\\n\");\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "196",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n, m;\n\nint a[100005];\n\nstruct Union_Find_Set {\n\n\tint fa[100005];\n\n\tvoid Init() {\n\n\t\tfor (int i = 1; i <= n; i++) {\n\n\t\t\tfa[i] = i;\n\n\t\t}\n\n\t}\n\n\tint Find(int x) {\n\n\t\tif (fa[x] != x) fa[x] = Find(fa[x]);\n\n\t\treturn fa[x];\n\n\t}\n\n\tvoid Union(int x, int y) {\n\n\t\tfa[Find(x)] = Find(y);\n\n\t}\n\n}ufs;\n\nvector<int>vec[100005], v;\n\nint main() {\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor (int i = 1; i <= n; i++) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\t}\n\n\tint rem = (n - 1 - m) * 2;\n\n\tif (n < rem) {\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (rem == 0) {\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tufs.Init();\n\n\tfor (int x, y, i = 1; i <= m; i++) {\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++;\n\n\t\ty++;\n\n\t\tufs.Union(x, y);\n\n\t}\n\n\tfor (int i = 1; i <= n; i++) {\n\n\t\tvec[ufs.Find(i)].push_back(a[i]);\n\n\t}\n\n\tlong long ans = 0;\n\n\tfor (int i = 1; i <= n; i++) {\n\n\t\tif (ufs.Find(i) == i) {\n\n\t\t\tsort(vec[i].begin(), vec[i].end());\n\n\t\t\tans += vec[i][0];\n\n\t\t\trem--;\n\n\t\t\tfor (int j = 1; j < int(vec[i].size()); j++) {\n\n\t\t\t\tv.push_back(vec[i][j]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsort(v.begin(), v.end());\n\n\tfor (int i = 0; i < rem; i++) {\n\n\t\tans += v[i];\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include<cstdio>\n\n#include<set>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\n#include<cmath>\n\n#include<cstdlib>\n\n#include<algorithm>\n\n#include<string>\n\n#include<cstring>\n\n\n\nusing namespace std;\n\n\n\nint a[100005],fa[100005],vis[100005],mi[100005];\n\npriority_queue<pair<int,int>, vector<pair<int,int> >, greater<pair<int,int> > >q;\n\n\n\nint _find(int x)\n\n{\n\n    return fa[x]==x?x:fa[x]=_find(fa[x]);\n\n}\n\n\n\nvoid _merge(int x,int y)\n\n{\n\n    int fx=_find(x),fy=_find(y);\n\n    if(fx!=fy)\n\n    {\n\n        fa[fx]=fy;\n\n    }\n\n}\n\nint main()\n\n{\n\n\tint n,m;\n\n\tscanf(\"%d %d\",&n,&m);\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t    scanf(\"%d\",&a[i]);\n\n\t    fa[i]=i;\n\n\t    mi[i]=1e9+9;\n\n\t}\n\n\tint x,y;\n\n\tfor(int i=0;i<m;i++)\n\n    {\n\n        scanf(\"%d %d\",&x,&y);\n\n        _merge(x,y);\n\n    }\n\n\tfor(int i=0;i<n;i++)\n\n        _find(i);\n\n    pair<int,int>tt;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t    mi[fa[i]]=min(a[i],mi[fa[i]]);\n\n\n\n\t    tt.first=a[i];\n\n\t    tt.second=fa[i];\n\n\t    q.push(tt);\n\n\t}\n\n\tsort(fa,fa+n);\n\n\tint cnt=unique(fa,fa+n)-fa;\n\n\tif(cnt==1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        long long ans=0;\n\n        for(int i=0;i<cnt;i++)\n\n            ans+=mi[fa[i]];\n\n        while(!q.empty())\n\n        {\n\n            if(cnt==2)\n\n                break;\n\n            pair<int,int>tmp;\n\n            tmp=q.top();\n\n            q.pop();\n\n            if(vis[tmp.second]==0)\n\n            {\n\n                vis[tmp.second]=1;\n\n                continue;\n\n            }\n\n            ans+=tmp.first;\n\n            cnt--;\n\n        }\n\n        if(cnt==2)\n\n            printf(\"%lld\\n\",ans);\n\n        else\n\n            printf(\"Impossible\\n\");\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "197",
        "source_code": "#include<cstdio>\n\n#include<set>\n\n#include<algorithm>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\nstruct node{\n\n\tint num, key, vis;\n\n};\n\nnode a[MAXN + 5];\n\nbool operator < (node a, node b) {\n\n\treturn a.key < b.key;\n\n}\n\nset<node>Set[MAXN + 5];\n\nint fa[MAXN + 5];\n\nint Find(int x) {\n\n\tif( fa[x] == x ) return x;\n\n\treturn fa[x] = Find(fa[x]);\n\n}\n\nint main() {\n\n\tint N, M, cnt = 0;\n\n\tscanf(\"%d%d\", &N, &M);\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tscanf(\"%d\", &a[i].key);\n\n\t\ta[i].num = fa[i] = i;\n\n\t}\n\n\tint ned = ((N-1) - M) * 2;\n\n\tif( ned > N ) {\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i=1;i<=M;i++) {\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tfa[Find(u)] = Find(v);\n\n\t}\n\n\tfor(int i=0;i<N;i++)\n\n\t\tSet[Find(i)].insert(a[i]);\n\n\tlong long ans = 0;\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tif( Find(i) == i ) {\n\n\t\t\tif( cnt == ned ) continue;\n\n\t\t\tans += Set[i].begin()->key;\n\n\t\t\ta[(*Set[i].begin()).num].vis = true;\n\n\t\t\tcnt++;\n\n\t\t}\n\n\t}\n\n\tsort(a, a+N);\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tif( cnt == ned ) break;\n\n\t\tif( a[i].vis ) continue;\n\n\t\tcnt++;\n\n\t\tans += a[i].key;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n}",
        "optimized_code": "#include <iostream>\n\n#include<cstdio>\n\n#include<set>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\n#include<cmath>\n\n#include<cstdlib>\n\n#include<algorithm>\n\n#include<string>\n\n#include<cstring>\n\n\n\nusing namespace std;\n\n\n\nint a[100005],fa[100005],vis[100005],mi[100005];\n\npriority_queue<pair<int,int>, vector<pair<int,int> >, greater<pair<int,int> > >q;\n\n\n\nint _find(int x)\n\n{\n\n    return fa[x]==x?x:fa[x]=_find(fa[x]);\n\n}\n\n\n\nvoid _merge(int x,int y)\n\n{\n\n    int fx=_find(x),fy=_find(y);\n\n    if(fx!=fy)\n\n    {\n\n        fa[fx]=fy;\n\n    }\n\n}\n\nint main()\n\n{\n\n\tint n,m;\n\n\tscanf(\"%d %d\",&n,&m);\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t    scanf(\"%d\",&a[i]);\n\n\t    fa[i]=i;\n\n\t    mi[i]=1e9+9;\n\n\t}\n\n\tint x,y;\n\n\tfor(int i=0;i<m;i++)\n\n    {\n\n        scanf(\"%d %d\",&x,&y);\n\n        _merge(x,y);\n\n    }\n\n\tfor(int i=0;i<n;i++)\n\n        _find(i);\n\n    pair<int,int>tt;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t    mi[fa[i]]=min(a[i],mi[fa[i]]);\n\n\n\n\t    tt.first=a[i];\n\n\t    tt.second=fa[i];\n\n\t    q.push(tt);\n\n\t}\n\n\tsort(fa,fa+n);\n\n\tint cnt=unique(fa,fa+n)-fa;\n\n\tif(cnt==1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        long long ans=0;\n\n        for(int i=0;i<cnt;i++)\n\n            ans+=mi[fa[i]];\n\n        while(!q.empty())\n\n        {\n\n            if(cnt==2)\n\n                break;\n\n            pair<int,int>tmp;\n\n            tmp=q.top();\n\n            q.pop();\n\n            if(vis[tmp.second]==0)\n\n            {\n\n                vis[tmp.second]=1;\n\n                continue;\n\n            }\n\n            ans+=tmp.first;\n\n            cnt--;\n\n        }\n\n        if(cnt==2)\n\n            printf(\"%lld\\n\",ans);\n\n        else\n\n            printf(\"Impossible\\n\");\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "198",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\nconst int maxn=100010;\n\nmultiset<int> S[maxn];\n\nset<pair<int,int> > S2;\n\nstruct Edge\n\n{\n\n\tint v,next;\n\n}\te[maxn<<1];\n\nint g[maxn],tot;\n\nvoid addedge(int x,int y)\n\n{\n\n\ttot++;\n\n\te[tot].v=y;\n\n\te[tot].next=g[x];\n\n\tg[x]=tot;\n\n}\n\nint n,m;\n\nbool vis[maxn];\n\nint a[maxn];\n\n\n\nvoid dfs(int t,int ha)\n\n{\n\n\tS[ha].insert(a[t]);\n\n\tvis[t]=true;\n\n\tfor (int i=g[t];i;i=e[i].next)\n\n\tif (!vis[e[i].v])\n\n\t\tdfs(e[i].v,ha);\n\n}\n\nint Union(pair<int,int> x,pair<int,int> y)\n\n{\n\n\tmultiset<int>::iterator it=S[x.second].lower_bound(x.first);\n\n\tS[x.second].erase(it);\n\n\tit=S[y.second].lower_bound(y.first);\n\n\tS[y.second].erase(it);\n\n\tint l=x.second,r=y.second;\n\n\tif (S[l].size()>S[r].size())\tswap(l,r);\n\n\tfor (auto i:S[l])\n\n\t\tS[r].insert(i);\n\n\tS[l].clear();\n\n\treturn r;\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int i=1;i<=n;i++)\tscanf(\"%d\",&a[i]);\n\n\tfor (int i=1;i<=m;i++)\n\n\t{\n\n\t\tint x,y;\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tx++;y++;\n\n\t\taddedge(x,y);\n\n\t\taddedge(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;i++)\n\n\tif (!vis[i])\n\n\t\tdfs(i,i);\n\n\tfor (int i=1;i<=n;i++)\n\n\t\tif (!S[i].empty())\n\n\t\t\tS2.insert(make_pair(S[i].size(),i));\n\n\tll ans=0;\n\n\tfor (int i=1;i<=n-1-m;i++)\n\n\t{\n\n\t\tif (S2.empty())\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tpair<int,int> tmp1=*--S2.end();\n\n\t\tS2.erase(--S2.end());\n\n\t\tif (S2.empty())\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tpair<int,int> tmp2=*--S2.end();\n\n\t\tS2.erase(--S2.end());\n\n\t\ttmp1.first=*S[tmp1.second].begin();\n\n\t\ttmp2.first=*S[tmp2.second].begin();\n\n\t\tans+=tmp1.first+tmp2.first;\n\n\t\tint q=Union(tmp1,tmp2);\n\n\t\tif (!S[q].empty())\tS2.insert(make_pair(S[q].size(),q));\n\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include<cstdio>\n\n#include<set>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\n#include<cmath>\n\n#include<cstdlib>\n\n#include<algorithm>\n\n#include<string>\n\n#include<cstring>\n\n\n\nusing namespace std;\n\n\n\nint a[100005],fa[100005],vis[100005],mi[100005];\n\npriority_queue<pair<int,int>, vector<pair<int,int> >, greater<pair<int,int> > >q;\n\n\n\nint _find(int x)\n\n{\n\n    return fa[x]==x?x:fa[x]=_find(fa[x]);\n\n}\n\n\n\nvoid _merge(int x,int y)\n\n{\n\n    int fx=_find(x),fy=_find(y);\n\n    if(fx!=fy)\n\n    {\n\n        fa[fx]=fy;\n\n    }\n\n}\n\nint main()\n\n{\n\n\tint n,m;\n\n\tscanf(\"%d %d\",&n,&m);\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t    scanf(\"%d\",&a[i]);\n\n\t    fa[i]=i;\n\n\t    mi[i]=1e9+9;\n\n\t}\n\n\tint x,y;\n\n\tfor(int i=0;i<m;i++)\n\n    {\n\n        scanf(\"%d %d\",&x,&y);\n\n        _merge(x,y);\n\n    }\n\n\tfor(int i=0;i<n;i++)\n\n        _find(i);\n\n    pair<int,int>tt;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t    mi[fa[i]]=min(a[i],mi[fa[i]]);\n\n\n\n\t    tt.first=a[i];\n\n\t    tt.second=fa[i];\n\n\t    q.push(tt);\n\n\t}\n\n\tsort(fa,fa+n);\n\n\tint cnt=unique(fa,fa+n)-fa;\n\n\tif(cnt==1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        long long ans=0;\n\n        for(int i=0;i<cnt;i++)\n\n            ans+=mi[fa[i]];\n\n        while(!q.empty())\n\n        {\n\n            if(cnt==2)\n\n                break;\n\n            pair<int,int>tmp;\n\n            tmp=q.top();\n\n            q.pop();\n\n            if(vis[tmp.second]==0)\n\n            {\n\n                vis[tmp.second]=1;\n\n                continue;\n\n            }\n\n            ans+=tmp.first;\n\n            cnt--;\n\n        }\n\n        if(cnt==2)\n\n            printf(\"%lld\\n\",ans);\n\n        else\n\n            printf(\"Impossible\\n\");\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "199",
        "source_code": "#include<cstdio>\n\n#include<vector>\n\n#include<algorithm>\n\nusing namespace std;\n\n\n\nint a[100001],f[100001];\n\nint ff(int u){\n\n\treturn f[u]==u?u:f[u]=ff(f[u]);\n\n}\n\nvector<int>g[100001];\n\nint c[100001];\n\nint main(){\n\n\tint n,m;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tscanf(\"%d\",&a[i]),\n\n\t\tf[i]=i;\n\n\tfor(int i=1;i<=m;i++){\n\n\t\tint u,v;\n\n\t\tscanf(\"%d%d\",&u,&v);\n\n\t\tu++;v++;\n\n\t\tf[ff(u)]=ff(v);\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tg[ff(i)].push_back(a[i]);\n\n\tlong long ans=0;\n\n\tint z=0;\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tif(i==ff(i)){\n\n\t\t\tz++;\n\n\t\t\tsort(g[i].begin(),g[i].end());\n\n\t\t\tans+=g[i][0];\n\n\t\t\tfor(int j=1;j<g[i].size();j++)\n\n\t\t\t\tc[++c[0]]=g[i][j];\n\n\t\t}\n\n\tif(z==1){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(c[0]<z-2){\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tsort(c+1,c+c[0]+1);\n\n\tfor(int i=1;i<=z-2;i++)\n\n\t\tans+=c[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n}\n",
        "optimized_code": "#include <iostream>\n\n#include<cstdio>\n\n#include<set>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\n#include<cmath>\n\n#include<cstdlib>\n\n#include<algorithm>\n\n#include<string>\n\n#include<cstring>\n\n\n\nusing namespace std;\n\n\n\nint a[100005],fa[100005],vis[100005],mi[100005];\n\npriority_queue<pair<int,int>, vector<pair<int,int> >, greater<pair<int,int> > >q;\n\n\n\nint _find(int x)\n\n{\n\n    return fa[x]==x?x:fa[x]=_find(fa[x]);\n\n}\n\n\n\nvoid _merge(int x,int y)\n\n{\n\n    int fx=_find(x),fy=_find(y);\n\n    if(fx!=fy)\n\n    {\n\n        fa[fx]=fy;\n\n    }\n\n}\n\nint main()\n\n{\n\n\tint n,m;\n\n\tscanf(\"%d %d\",&n,&m);\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t    scanf(\"%d\",&a[i]);\n\n\t    fa[i]=i;\n\n\t    mi[i]=1e9+9;\n\n\t}\n\n\tint x,y;\n\n\tfor(int i=0;i<m;i++)\n\n    {\n\n        scanf(\"%d %d\",&x,&y);\n\n        _merge(x,y);\n\n    }\n\n\tfor(int i=0;i<n;i++)\n\n        _find(i);\n\n    pair<int,int>tt;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t    mi[fa[i]]=min(a[i],mi[fa[i]]);\n\n\n\n\t    tt.first=a[i];\n\n\t    tt.second=fa[i];\n\n\t    q.push(tt);\n\n\t}\n\n\tsort(fa,fa+n);\n\n\tint cnt=unique(fa,fa+n)-fa;\n\n\tif(cnt==1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        long long ans=0;\n\n        for(int i=0;i<cnt;i++)\n\n            ans+=mi[fa[i]];\n\n        while(!q.empty())\n\n        {\n\n            if(cnt==2)\n\n                break;\n\n            pair<int,int>tmp;\n\n            tmp=q.top();\n\n            q.pop();\n\n            if(vis[tmp.second]==0)\n\n            {\n\n                vis[tmp.second]=1;\n\n                continue;\n\n            }\n\n            ans+=tmp.first;\n\n            cnt--;\n\n        }\n\n        if(cnt==2)\n\n            printf(\"%lld\\n\",ans);\n\n        else\n\n            printf(\"Impossible\\n\");\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "200",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n",
        "optimized_code": "#include <iostream>\n\n#include<cstdio>\n\n#include<set>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\n#include<cmath>\n\n#include<cstdlib>\n\n#include<algorithm>\n\n#include<string>\n\n#include<cstring>\n\n\n\nusing namespace std;\n\n\n\nint a[100005],fa[100005],vis[100005],mi[100005];\n\npriority_queue<pair<int,int>, vector<pair<int,int> >, greater<pair<int,int> > >q;\n\n\n\nint _find(int x)\n\n{\n\n    return fa[x]==x?x:fa[x]=_find(fa[x]);\n\n}\n\n\n\nvoid _merge(int x,int y)\n\n{\n\n    int fx=_find(x),fy=_find(y);\n\n    if(fx!=fy)\n\n    {\n\n        fa[fx]=fy;\n\n    }\n\n}\n\nint main()\n\n{\n\n\tint n,m;\n\n\tscanf(\"%d %d\",&n,&m);\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t    scanf(\"%d\",&a[i]);\n\n\t    fa[i]=i;\n\n\t    mi[i]=1e9+9;\n\n\t}\n\n\tint x,y;\n\n\tfor(int i=0;i<m;i++)\n\n    {\n\n        scanf(\"%d %d\",&x,&y);\n\n        _merge(x,y);\n\n    }\n\n\tfor(int i=0;i<n;i++)\n\n        _find(i);\n\n    pair<int,int>tt;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t    mi[fa[i]]=min(a[i],mi[fa[i]]);\n\n\n\n\t    tt.first=a[i];\n\n\t    tt.second=fa[i];\n\n\t    q.push(tt);\n\n\t}\n\n\tsort(fa,fa+n);\n\n\tint cnt=unique(fa,fa+n)-fa;\n\n\tif(cnt==1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        long long ans=0;\n\n        for(int i=0;i<cnt;i++)\n\n            ans+=mi[fa[i]];\n\n        while(!q.empty())\n\n        {\n\n            if(cnt==2)\n\n                break;\n\n            pair<int,int>tmp;\n\n            tmp=q.top();\n\n            q.pop();\n\n            if(vis[tmp.second]==0)\n\n            {\n\n                vis[tmp.second]=1;\n\n                continue;\n\n            }\n\n            ans+=tmp.first;\n\n            cnt--;\n\n        }\n\n        if(cnt==2)\n\n            printf(\"%lld\\n\",ans);\n\n        else\n\n            printf(\"Impossible\\n\");\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "201",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn = 1e5+100;\n\ntypedef long long LL;\n\nint val[maxn],First[maxn],cnt,N,M;\n\nint tot,pre[maxn];\n\nLL ans = 0;\n\nstruct node{\n\n    int to,Next;\n\n}Tree[maxn*2];\n\nvoid init(){\n\n    memset(First,-1,sizeof(First));\n\n    cnt = 0;\n\n}\n\nvoid addedge(int from,int to){\n\n    Tree[cnt].to = to;\n\n    Tree[cnt].Next = First[from];\n\n    First[from] = cnt++;\n\n}\n\npriority_queue<int,vector<int>,greater<int> > Q[maxn];\n\nvoid dfs(int u,int fa){\n\n    pre[u] = 1;\n\n    Q[tot].push(val[u]);\n\n    for(int i = First[u];i!=-1;i=Tree[i].Next){\n\n        int to = Tree[i].to;\n\n        if(to==fa)continue;\n\n        dfs(to,u);\n\n    }\n\n}\n\nvector<int> ac,bc;\n\nint main(){\n\n    init();\n\n    scanf(\"%d%d\",&N,&M);\n\n    for(int i = 0;i<=N-1;i++)scanf(\"%d\",&val[i]);\n\n    for(int i = 0;i<M;i++){\n\n        int a,b;\n\n        scanf(\"%d%d\",&a,&b);\n\n        addedge(a,b);\n\n        addedge(b,a);\n\n    }\n\n    for(int i = 0;i<=N-1;i++){\n\n        if(!pre[i]){\n\n            tot++;\n\n            dfs(i,-1);\n\n            ac.push_back(tot);\n\n        }\n\n    }\n\n    if(tot==1){\n\n        printf(\"%d\\n\",0);\n\n        return 0;\n\n    }\n\n    bool flag = 0;\n\n    priority_queue<int,vector<int>,greater<int> >QQ;\n\n    for(int i = 1;i<=tot;i++){\n\n       ans+=Q[i].top();\n\n       Q[i].pop();\n\n       while(!Q[i].empty()){\n\n        QQ.push(Q[i].top());\n\n        Q[i].pop();\n\n       }\n\n    }\n\n    int my =tot-2;\n\n    if(QQ.size()<my){\n\n        printf(\"Impossible\\n\");\n\n        return 0;\n\n    }\n\n    for(int i = 0;i<my;i++){\n\n        ans+=QQ.top();\n\n        QQ.pop();\n\n    }\n\n    printf(\"%lld\\n\",ans);\n\n    return 0;\n\n}\n\n/*\n\n7 4\n\n1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000\n\n0 1\n\n1 2\n\n3 4\n\n5 6\n\n6 3\n\n1 1 1 3 7 8\n\n0 4\n\n1 5\n\n2 3\n\n*/\n",
        "optimized_code": "#include <iostream>\n\n#include<cstdio>\n\n#include<set>\n\n#include<queue>\n\n#include<vector>\n\n#include<map>\n\n#include<cmath>\n\n#include<cstdlib>\n\n#include<algorithm>\n\n#include<string>\n\n#include<cstring>\n\n\n\nusing namespace std;\n\n\n\nint a[100005],fa[100005],vis[100005],mi[100005];\n\npriority_queue<pair<int,int>, vector<pair<int,int> >, greater<pair<int,int> > >q;\n\n\n\nint _find(int x)\n\n{\n\n    return fa[x]==x?x:fa[x]=_find(fa[x]);\n\n}\n\n\n\nvoid _merge(int x,int y)\n\n{\n\n    int fx=_find(x),fy=_find(y);\n\n    if(fx!=fy)\n\n    {\n\n        fa[fx]=fy;\n\n    }\n\n}\n\nint main()\n\n{\n\n\tint n,m;\n\n\tscanf(\"%d %d\",&n,&m);\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t    scanf(\"%d\",&a[i]);\n\n\t    fa[i]=i;\n\n\t    mi[i]=1e9+9;\n\n\t}\n\n\tint x,y;\n\n\tfor(int i=0;i<m;i++)\n\n    {\n\n        scanf(\"%d %d\",&x,&y);\n\n        _merge(x,y);\n\n    }\n\n\tfor(int i=0;i<n;i++)\n\n        _find(i);\n\n    pair<int,int>tt;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t    mi[fa[i]]=min(a[i],mi[fa[i]]);\n\n\n\n\t    tt.first=a[i];\n\n\t    tt.second=fa[i];\n\n\t    q.push(tt);\n\n\t}\n\n\tsort(fa,fa+n);\n\n\tint cnt=unique(fa,fa+n)-fa;\n\n\tif(cnt==1)\n\n        printf(\"0\\n\");\n\n    else\n\n    {\n\n        long long ans=0;\n\n        for(int i=0;i<cnt;i++)\n\n            ans+=mi[fa[i]];\n\n        while(!q.empty())\n\n        {\n\n            if(cnt==2)\n\n                break;\n\n            pair<int,int>tmp;\n\n            tmp=q.top();\n\n            q.pop();\n\n            if(vis[tmp.second]==0)\n\n            {\n\n                vis[tmp.second]=1;\n\n                continue;\n\n            }\n\n            ans+=tmp.first;\n\n            cnt--;\n\n        }\n\n        if(cnt==2)\n\n            printf(\"%lld\\n\",ans);\n\n        else\n\n            printf(\"Impossible\\n\");\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "202",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<cmath>\n\n#include<vector>\n\n#define SF scanf\n\n#define PF printf\n\n#define MAXN 100010\n\nusing namespace std;\n\nint n,m,sum;\n\nvector<int> a[MAXN];\n\nbool vis[MAXN],used[MAXN];\n\nint val[MAXN],b[MAXN];\n\nlong long ans;\n\nint dfs(int x){\n\n    vis[x]=1;\n\n    int idx=x;\n\n    for(int i=0;i<a[x].size();i++)\n\n        if(vis[a[x][i]]==0){\n\n            int id=dfs(a[x][i]);\n\n            if(val[id]<val[idx])\n\n                idx=id;\n\n        }\n\n    return idx;\n\n}\n\nint main(){\n\n    SF(\"%d%d\",&n,&m);\n\n    int u,v;\n\n    for(int i=0;i<n;i++)\n\n        SF(\"%d\",&val[i]);\n\n    for(int i=0;i<m;i++){\n\n        SF(\"%d%d\",&u,&v);\n\n        a[u].push_back(v);\n\n        a[v].push_back(u);\n\n    }\n\n    for(int i=0;i<n;i++)\n\n        if(vis[i]==0){\n\n            int maxid=dfs(i);\n\n            used[maxid]=1;\n\n            sum++;\n\n        }\n\n    int cnt=2*sum-2,tot=0;\n\n    if(sum==1){\n\n        PF(\"0\");\n\n        return 0;\n\n    }\n\n    for(int i=0;i<n;i++)\n\n        if(used[i]==1)\n\n            ans+=val[i];\n\n    cnt-=sum;\n\n    for(int i=0;i<n;i++)\n\n        if(used[i]==0)\n\n            b[++tot]=val[i];\n\n    if(cnt>tot){\n\n        PF(\"Impossible\");\n\n        return 0;\n\n    }\n\n    sort(b+1,b+1+tot);\n\n    for(int i=1;i<=cnt;i++)\n\n        ans+=b[i];\n\n    PF(\"%lld\\n\",ans);\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nclass dsu {\n\n  public:\n\n  vector<int> p;\n\n  int n;\n\n\n\n  dsu(int _n) : n(_n) {\n\n    p.resize(n);\n\n    iota(p.begin(), p.end(), 0);\n\n  }\n\n\n\n  inline int get(int x) {\n\n    return (x == p[x] ? x : (p[x] = get(p[x])));\n\n  }\n\n\n\n  inline bool unite(int x, int y) {\n\n    x = get(x);\n\n    y = get(y);\n\n    if (x != y) {\n\n      p[x] = y;\n\n      return true;\n\n    }\n\n    return false;\n\n  }\n\n};\n\n\n\nint main() {\n\n  int n, m;\n\n  scanf(\"%d %d\", &n, &m);\n\n  vector<int> a(n);\n\n  for (int i = 0; i < n; i++) {\n\n    scanf(\"%d\", &a[i]);\n\n  }\n\n  dsu d(n);\n\n  for (int i = 0; i < m; i++) {\n\n    int x, y;\n\n    scanf(\"%d %d\", &x, &y);\n\n    d.unite(x, y);\n\n  }\n\n  vector< vector<int> > comp(n);\n\n  for (int i = 0; i < n; i++) {\n\n    comp[d.get(i)].push_back(a[i]);\n\n  }\n\n  int cnt = 0;\n\n  for (int i = 0; i < n; i++) {\n\n    if (!comp[i].empty()) {\n\n      cnt++;\n\n    }\n\n  }\n\n  if (cnt == 1) {\n\n    puts(\"0\");\n\n    return 0;\n\n  }\n\n  int choose = 2 * cnt - 2;\n\n  long long ans = 0;\n\n  vector<int> other;\n\n  for (int i = 0; i < n; i++) {\n\n    if (!comp[i].empty()) {\n\n      sort(comp[i].begin(), comp[i].end());\n\n      ans += comp[i][0];\n\n      choose--;\n\n      for (int j = 1; j < (int) comp[i].size(); j++) {\n\n        other.push_back(comp[i][j]);\n\n      }\n\n    }\n\n  }\n\n  if (choose > (int) other.size()) {\n\n    puts(\"Impossible\");\n\n    return 0;\n\n  }\n\n  sort(other.begin(), other.end());\n\n  for (int i = 0; i < choose; i++) {\n\n    ans += other[i];\n\n  }\n\n  cout << ans << endl;\n\n  return 0;\n\n}"
    },
    {
        "id": "203",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n, m;\n\nint a[100005];\n\nstruct Union_Find_Set {\n\n\tint fa[100005];\n\n\tvoid Init() {\n\n\t\tfor (int i = 1; i <= n; i++) {\n\n\t\t\tfa[i] = i;\n\n\t\t}\n\n\t}\n\n\tint Find(int x) {\n\n\t\tif (fa[x] != x) fa[x] = Find(fa[x]);\n\n\t\treturn fa[x];\n\n\t}\n\n\tvoid Union(int x, int y) {\n\n\t\tfa[Find(x)] = Find(y);\n\n\t}\n\n}ufs;\n\nvector<int>vec[100005], v;\n\nint main() {\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tfor (int i = 1; i <= n; i++) {\n\n\t\tscanf(\"%d\", &a[i]);\n\n\t}\n\n\tint rem = (n - 1 - m) * 2;\n\n\tif (n < rem) {\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tif (rem == 0) {\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tufs.Init();\n\n\tfor (int x, y, i = 1; i <= m; i++) {\n\n\t\tscanf(\"%d%d\", &x, &y);\n\n\t\tx++;\n\n\t\ty++;\n\n\t\tufs.Union(x, y);\n\n\t}\n\n\tfor (int i = 1; i <= n; i++) {\n\n\t\tvec[ufs.Find(i)].push_back(a[i]);\n\n\t}\n\n\tlong long ans = 0;\n\n\tfor (int i = 1; i <= n; i++) {\n\n\t\tif (ufs.Find(i) == i) {\n\n\t\t\tsort(vec[i].begin(), vec[i].end());\n\n\t\t\tans += vec[i][0];\n\n\t\t\trem--;\n\n\t\t\tfor (int j = 1; j < int(vec[i].size()); j++) {\n\n\t\t\t\tv.push_back(vec[i][j]);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsort(v.begin(), v.end());\n\n\tfor (int i = 0; i < rem; i++) {\n\n\t\tans += v[i];\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nclass dsu {\n\n  public:\n\n  vector<int> p;\n\n  int n;\n\n\n\n  dsu(int _n) : n(_n) {\n\n    p.resize(n);\n\n    iota(p.begin(), p.end(), 0);\n\n  }\n\n\n\n  inline int get(int x) {\n\n    return (x == p[x] ? x : (p[x] = get(p[x])));\n\n  }\n\n\n\n  inline bool unite(int x, int y) {\n\n    x = get(x);\n\n    y = get(y);\n\n    if (x != y) {\n\n      p[x] = y;\n\n      return true;\n\n    }\n\n    return false;\n\n  }\n\n};\n\n\n\nint main() {\n\n  int n, m;\n\n  scanf(\"%d %d\", &n, &m);\n\n  vector<int> a(n);\n\n  for (int i = 0; i < n; i++) {\n\n    scanf(\"%d\", &a[i]);\n\n  }\n\n  dsu d(n);\n\n  for (int i = 0; i < m; i++) {\n\n    int x, y;\n\n    scanf(\"%d %d\", &x, &y);\n\n    d.unite(x, y);\n\n  }\n\n  vector< vector<int> > comp(n);\n\n  for (int i = 0; i < n; i++) {\n\n    comp[d.get(i)].push_back(a[i]);\n\n  }\n\n  int cnt = 0;\n\n  for (int i = 0; i < n; i++) {\n\n    if (!comp[i].empty()) {\n\n      cnt++;\n\n    }\n\n  }\n\n  if (cnt == 1) {\n\n    puts(\"0\");\n\n    return 0;\n\n  }\n\n  int choose = 2 * cnt - 2;\n\n  long long ans = 0;\n\n  vector<int> other;\n\n  for (int i = 0; i < n; i++) {\n\n    if (!comp[i].empty()) {\n\n      sort(comp[i].begin(), comp[i].end());\n\n      ans += comp[i][0];\n\n      choose--;\n\n      for (int j = 1; j < (int) comp[i].size(); j++) {\n\n        other.push_back(comp[i][j]);\n\n      }\n\n    }\n\n  }\n\n  if (choose > (int) other.size()) {\n\n    puts(\"Impossible\");\n\n    return 0;\n\n  }\n\n  sort(other.begin(), other.end());\n\n  for (int i = 0; i < choose; i++) {\n\n    ans += other[i];\n\n  }\n\n  cout << ans << endl;\n\n  return 0;\n\n}"
    },
    {
        "id": "204",
        "source_code": "#include<cstdio>\n\n#include<set>\n\n#include<algorithm>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\nstruct node{\n\n\tint num, key, vis;\n\n};\n\nnode a[MAXN + 5];\n\nbool operator < (node a, node b) {\n\n\treturn a.key < b.key;\n\n}\n\nset<node>Set[MAXN + 5];\n\nint fa[MAXN + 5];\n\nint Find(int x) {\n\n\tif( fa[x] == x ) return x;\n\n\treturn fa[x] = Find(fa[x]);\n\n}\n\nint main() {\n\n\tint N, M, cnt = 0;\n\n\tscanf(\"%d%d\", &N, &M);\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tscanf(\"%d\", &a[i].key);\n\n\t\ta[i].num = fa[i] = i;\n\n\t}\n\n\tint ned = ((N-1) - M) * 2;\n\n\tif( ned > N ) {\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i=1;i<=M;i++) {\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tfa[Find(u)] = Find(v);\n\n\t}\n\n\tfor(int i=0;i<N;i++)\n\n\t\tSet[Find(i)].insert(a[i]);\n\n\tlong long ans = 0;\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tif( Find(i) == i ) {\n\n\t\t\tif( cnt == ned ) continue;\n\n\t\t\tans += Set[i].begin()->key;\n\n\t\t\ta[(*Set[i].begin()).num].vis = true;\n\n\t\t\tcnt++;\n\n\t\t}\n\n\t}\n\n\tsort(a, a+N);\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tif( cnt == ned ) break;\n\n\t\tif( a[i].vis ) continue;\n\n\t\tcnt++;\n\n\t\tans += a[i].key;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nclass dsu {\n\n  public:\n\n  vector<int> p;\n\n  int n;\n\n\n\n  dsu(int _n) : n(_n) {\n\n    p.resize(n);\n\n    iota(p.begin(), p.end(), 0);\n\n  }\n\n\n\n  inline int get(int x) {\n\n    return (x == p[x] ? x : (p[x] = get(p[x])));\n\n  }\n\n\n\n  inline bool unite(int x, int y) {\n\n    x = get(x);\n\n    y = get(y);\n\n    if (x != y) {\n\n      p[x] = y;\n\n      return true;\n\n    }\n\n    return false;\n\n  }\n\n};\n\n\n\nint main() {\n\n  int n, m;\n\n  scanf(\"%d %d\", &n, &m);\n\n  vector<int> a(n);\n\n  for (int i = 0; i < n; i++) {\n\n    scanf(\"%d\", &a[i]);\n\n  }\n\n  dsu d(n);\n\n  for (int i = 0; i < m; i++) {\n\n    int x, y;\n\n    scanf(\"%d %d\", &x, &y);\n\n    d.unite(x, y);\n\n  }\n\n  vector< vector<int> > comp(n);\n\n  for (int i = 0; i < n; i++) {\n\n    comp[d.get(i)].push_back(a[i]);\n\n  }\n\n  int cnt = 0;\n\n  for (int i = 0; i < n; i++) {\n\n    if (!comp[i].empty()) {\n\n      cnt++;\n\n    }\n\n  }\n\n  if (cnt == 1) {\n\n    puts(\"0\");\n\n    return 0;\n\n  }\n\n  int choose = 2 * cnt - 2;\n\n  long long ans = 0;\n\n  vector<int> other;\n\n  for (int i = 0; i < n; i++) {\n\n    if (!comp[i].empty()) {\n\n      sort(comp[i].begin(), comp[i].end());\n\n      ans += comp[i][0];\n\n      choose--;\n\n      for (int j = 1; j < (int) comp[i].size(); j++) {\n\n        other.push_back(comp[i][j]);\n\n      }\n\n    }\n\n  }\n\n  if (choose > (int) other.size()) {\n\n    puts(\"Impossible\");\n\n    return 0;\n\n  }\n\n  sort(other.begin(), other.end());\n\n  for (int i = 0; i < choose; i++) {\n\n    ans += other[i];\n\n  }\n\n  cout << ans << endl;\n\n  return 0;\n\n}"
    },
    {
        "id": "205",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\nconst int maxn=100010;\n\nmultiset<int> S[maxn];\n\nset<pair<int,int> > S2;\n\nstruct Edge\n\n{\n\n\tint v,next;\n\n}\te[maxn<<1];\n\nint g[maxn],tot;\n\nvoid addedge(int x,int y)\n\n{\n\n\ttot++;\n\n\te[tot].v=y;\n\n\te[tot].next=g[x];\n\n\tg[x]=tot;\n\n}\n\nint n,m;\n\nbool vis[maxn];\n\nint a[maxn];\n\n\n\nvoid dfs(int t,int ha)\n\n{\n\n\tS[ha].insert(a[t]);\n\n\tvis[t]=true;\n\n\tfor (int i=g[t];i;i=e[i].next)\n\n\tif (!vis[e[i].v])\n\n\t\tdfs(e[i].v,ha);\n\n}\n\nint Union(pair<int,int> x,pair<int,int> y)\n\n{\n\n\tmultiset<int>::iterator it=S[x.second].lower_bound(x.first);\n\n\tS[x.second].erase(it);\n\n\tit=S[y.second].lower_bound(y.first);\n\n\tS[y.second].erase(it);\n\n\tint l=x.second,r=y.second;\n\n\tif (S[l].size()>S[r].size())\tswap(l,r);\n\n\tfor (auto i:S[l])\n\n\t\tS[r].insert(i);\n\n\tS[l].clear();\n\n\treturn r;\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int i=1;i<=n;i++)\tscanf(\"%d\",&a[i]);\n\n\tfor (int i=1;i<=m;i++)\n\n\t{\n\n\t\tint x,y;\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tx++;y++;\n\n\t\taddedge(x,y);\n\n\t\taddedge(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;i++)\n\n\tif (!vis[i])\n\n\t\tdfs(i,i);\n\n\tfor (int i=1;i<=n;i++)\n\n\t\tif (!S[i].empty())\n\n\t\t\tS2.insert(make_pair(S[i].size(),i));\n\n\tll ans=0;\n\n\tfor (int i=1;i<=n-1-m;i++)\n\n\t{\n\n\t\tif (S2.empty())\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tpair<int,int> tmp1=*--S2.end();\n\n\t\tS2.erase(--S2.end());\n\n\t\tif (S2.empty())\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tpair<int,int> tmp2=*--S2.end();\n\n\t\tS2.erase(--S2.end());\n\n\t\ttmp1.first=*S[tmp1.second].begin();\n\n\t\ttmp2.first=*S[tmp2.second].begin();\n\n\t\tans+=tmp1.first+tmp2.first;\n\n\t\tint q=Union(tmp1,tmp2);\n\n\t\tif (!S[q].empty())\tS2.insert(make_pair(S[q].size(),q));\n\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nclass dsu {\n\n  public:\n\n  vector<int> p;\n\n  int n;\n\n\n\n  dsu(int _n) : n(_n) {\n\n    p.resize(n);\n\n    iota(p.begin(), p.end(), 0);\n\n  }\n\n\n\n  inline int get(int x) {\n\n    return (x == p[x] ? x : (p[x] = get(p[x])));\n\n  }\n\n\n\n  inline bool unite(int x, int y) {\n\n    x = get(x);\n\n    y = get(y);\n\n    if (x != y) {\n\n      p[x] = y;\n\n      return true;\n\n    }\n\n    return false;\n\n  }\n\n};\n\n\n\nint main() {\n\n  int n, m;\n\n  scanf(\"%d %d\", &n, &m);\n\n  vector<int> a(n);\n\n  for (int i = 0; i < n; i++) {\n\n    scanf(\"%d\", &a[i]);\n\n  }\n\n  dsu d(n);\n\n  for (int i = 0; i < m; i++) {\n\n    int x, y;\n\n    scanf(\"%d %d\", &x, &y);\n\n    d.unite(x, y);\n\n  }\n\n  vector< vector<int> > comp(n);\n\n  for (int i = 0; i < n; i++) {\n\n    comp[d.get(i)].push_back(a[i]);\n\n  }\n\n  int cnt = 0;\n\n  for (int i = 0; i < n; i++) {\n\n    if (!comp[i].empty()) {\n\n      cnt++;\n\n    }\n\n  }\n\n  if (cnt == 1) {\n\n    puts(\"0\");\n\n    return 0;\n\n  }\n\n  int choose = 2 * cnt - 2;\n\n  long long ans = 0;\n\n  vector<int> other;\n\n  for (int i = 0; i < n; i++) {\n\n    if (!comp[i].empty()) {\n\n      sort(comp[i].begin(), comp[i].end());\n\n      ans += comp[i][0];\n\n      choose--;\n\n      for (int j = 1; j < (int) comp[i].size(); j++) {\n\n        other.push_back(comp[i][j]);\n\n      }\n\n    }\n\n  }\n\n  if (choose > (int) other.size()) {\n\n    puts(\"Impossible\");\n\n    return 0;\n\n  }\n\n  sort(other.begin(), other.end());\n\n  for (int i = 0; i < choose; i++) {\n\n    ans += other[i];\n\n  }\n\n  cout << ans << endl;\n\n  return 0;\n\n}"
    },
    {
        "id": "206",
        "source_code": "#include<cstdio>\n\n#include<vector>\n\n#include<algorithm>\n\nusing namespace std;\n\n\n\nint a[100001],f[100001];\n\nint ff(int u){\n\n\treturn f[u]==u?u:f[u]=ff(f[u]);\n\n}\n\nvector<int>g[100001];\n\nint c[100001];\n\nint main(){\n\n\tint n,m;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tscanf(\"%d\",&a[i]),\n\n\t\tf[i]=i;\n\n\tfor(int i=1;i<=m;i++){\n\n\t\tint u,v;\n\n\t\tscanf(\"%d%d\",&u,&v);\n\n\t\tu++;v++;\n\n\t\tf[ff(u)]=ff(v);\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tg[ff(i)].push_back(a[i]);\n\n\tlong long ans=0;\n\n\tint z=0;\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tif(i==ff(i)){\n\n\t\t\tz++;\n\n\t\t\tsort(g[i].begin(),g[i].end());\n\n\t\t\tans+=g[i][0];\n\n\t\t\tfor(int j=1;j<g[i].size();j++)\n\n\t\t\t\tc[++c[0]]=g[i][j];\n\n\t\t}\n\n\tif(z==1){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(c[0]<z-2){\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tsort(c+1,c+c[0]+1);\n\n\tfor(int i=1;i<=z-2;i++)\n\n\t\tans+=c[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nclass dsu {\n\n  public:\n\n  vector<int> p;\n\n  int n;\n\n\n\n  dsu(int _n) : n(_n) {\n\n    p.resize(n);\n\n    iota(p.begin(), p.end(), 0);\n\n  }\n\n\n\n  inline int get(int x) {\n\n    return (x == p[x] ? x : (p[x] = get(p[x])));\n\n  }\n\n\n\n  inline bool unite(int x, int y) {\n\n    x = get(x);\n\n    y = get(y);\n\n    if (x != y) {\n\n      p[x] = y;\n\n      return true;\n\n    }\n\n    return false;\n\n  }\n\n};\n\n\n\nint main() {\n\n  int n, m;\n\n  scanf(\"%d %d\", &n, &m);\n\n  vector<int> a(n);\n\n  for (int i = 0; i < n; i++) {\n\n    scanf(\"%d\", &a[i]);\n\n  }\n\n  dsu d(n);\n\n  for (int i = 0; i < m; i++) {\n\n    int x, y;\n\n    scanf(\"%d %d\", &x, &y);\n\n    d.unite(x, y);\n\n  }\n\n  vector< vector<int> > comp(n);\n\n  for (int i = 0; i < n; i++) {\n\n    comp[d.get(i)].push_back(a[i]);\n\n  }\n\n  int cnt = 0;\n\n  for (int i = 0; i < n; i++) {\n\n    if (!comp[i].empty()) {\n\n      cnt++;\n\n    }\n\n  }\n\n  if (cnt == 1) {\n\n    puts(\"0\");\n\n    return 0;\n\n  }\n\n  int choose = 2 * cnt - 2;\n\n  long long ans = 0;\n\n  vector<int> other;\n\n  for (int i = 0; i < n; i++) {\n\n    if (!comp[i].empty()) {\n\n      sort(comp[i].begin(), comp[i].end());\n\n      ans += comp[i][0];\n\n      choose--;\n\n      for (int j = 1; j < (int) comp[i].size(); j++) {\n\n        other.push_back(comp[i][j]);\n\n      }\n\n    }\n\n  }\n\n  if (choose > (int) other.size()) {\n\n    puts(\"Impossible\");\n\n    return 0;\n\n  }\n\n  sort(other.begin(), other.end());\n\n  for (int i = 0; i < choose; i++) {\n\n    ans += other[i];\n\n  }\n\n  cout << ans << endl;\n\n  return 0;\n\n}"
    },
    {
        "id": "207",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<queue>\n\nusing namespace std;\n\ntypedef long long LL;\n\nint n,m;\n\nLL a[100000+10];\n\nint par[100000+10];\n\npriority_queue<LL> mini[100000+10];\n\n\n\nint fpar(int x){\n\n\tif (par[x]==-1)return x;\n\n\tpar[x]=fpar(par[x]);\n\n\treturn par[x];\n\n}\n\npriority_queue <LL > pq1;\n\nLL ans=0;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int f1=0;f1<n;f1++)scanf(\"%lld\",&a[f1]);\n\n\tfor (int f1=0;f1<n;f1++){par[f1]=-1;}\n\n\tfor (int f1=0;f1<m;f1++){\n\n\t\tint i,j;\n\n\t\tscanf(\"%d%d\",&i,&j);\n\n\t\ti=fpar(i);\n\n\t\tj=fpar(j);\n\n\t\tpar[j]=i;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tint j=fpar(f1);\n\n\t\tmini[j].push(-a[f1]);\n\n\t}\n\n\tif (n==1+m){\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int f1=0;f1<n;f1++){\n\n\t\tif (par[f1]==-1){\n\n\t\t\tans-=mini[f1].top();\n\n\t\t\tmini[f1].pop();\n\n\t\t\twhile (!mini[f1].empty()){\n\n\t\t\t\tpq1.push(mini[f1].top());\n\n\t\t\t\tmini[f1].pop();\n\n\t\t\t}\t\n\n\t\t}\n\n\t}\n\n\t\n\n\tif (int(pq1.size())>=n-m-2){\n\n\t\tfor (int f1=1;f1<=n-m-2;f1++){\n\n\t\t\tans-=pq1.top();\n\n\t\t\tpq1.pop();\n\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t} else printf(\"Impossible\\n\");\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nclass dsu {\n\n  public:\n\n  vector<int> p;\n\n  int n;\n\n\n\n  dsu(int _n) : n(_n) {\n\n    p.resize(n);\n\n    iota(p.begin(), p.end(), 0);\n\n  }\n\n\n\n  inline int get(int x) {\n\n    return (x == p[x] ? x : (p[x] = get(p[x])));\n\n  }\n\n\n\n  inline bool unite(int x, int y) {\n\n    x = get(x);\n\n    y = get(y);\n\n    if (x != y) {\n\n      p[x] = y;\n\n      return true;\n\n    }\n\n    return false;\n\n  }\n\n};\n\n\n\nint main() {\n\n  int n, m;\n\n  scanf(\"%d %d\", &n, &m);\n\n  vector<int> a(n);\n\n  for (int i = 0; i < n; i++) {\n\n    scanf(\"%d\", &a[i]);\n\n  }\n\n  dsu d(n);\n\n  for (int i = 0; i < m; i++) {\n\n    int x, y;\n\n    scanf(\"%d %d\", &x, &y);\n\n    d.unite(x, y);\n\n  }\n\n  vector< vector<int> > comp(n);\n\n  for (int i = 0; i < n; i++) {\n\n    comp[d.get(i)].push_back(a[i]);\n\n  }\n\n  int cnt = 0;\n\n  for (int i = 0; i < n; i++) {\n\n    if (!comp[i].empty()) {\n\n      cnt++;\n\n    }\n\n  }\n\n  if (cnt == 1) {\n\n    puts(\"0\");\n\n    return 0;\n\n  }\n\n  int choose = 2 * cnt - 2;\n\n  long long ans = 0;\n\n  vector<int> other;\n\n  for (int i = 0; i < n; i++) {\n\n    if (!comp[i].empty()) {\n\n      sort(comp[i].begin(), comp[i].end());\n\n      ans += comp[i][0];\n\n      choose--;\n\n      for (int j = 1; j < (int) comp[i].size(); j++) {\n\n        other.push_back(comp[i][j]);\n\n      }\n\n    }\n\n  }\n\n  if (choose > (int) other.size()) {\n\n    puts(\"Impossible\");\n\n    return 0;\n\n  }\n\n  sort(other.begin(), other.end());\n\n  for (int i = 0; i < choose; i++) {\n\n    ans += other[i];\n\n  }\n\n  cout << ans << endl;\n\n  return 0;\n\n}"
    },
    {
        "id": "208",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn = 1e5+100;\n\ntypedef long long LL;\n\nint val[maxn],First[maxn],cnt,N,M;\n\nint tot,pre[maxn];\n\nLL ans = 0;\n\nstruct node{\n\n    int to,Next;\n\n}Tree[maxn*2];\n\nvoid init(){\n\n    memset(First,-1,sizeof(First));\n\n    cnt = 0;\n\n}\n\nvoid addedge(int from,int to){\n\n    Tree[cnt].to = to;\n\n    Tree[cnt].Next = First[from];\n\n    First[from] = cnt++;\n\n}\n\npriority_queue<int,vector<int>,greater<int> > Q[maxn];\n\nvoid dfs(int u,int fa){\n\n    pre[u] = 1;\n\n    Q[tot].push(val[u]);\n\n    for(int i = First[u];i!=-1;i=Tree[i].Next){\n\n        int to = Tree[i].to;\n\n        if(to==fa)continue;\n\n        dfs(to,u);\n\n    }\n\n}\n\nvector<int> ac,bc;\n\nint main(){\n\n    init();\n\n    scanf(\"%d%d\",&N,&M);\n\n    for(int i = 0;i<=N-1;i++)scanf(\"%d\",&val[i]);\n\n    for(int i = 0;i<M;i++){\n\n        int a,b;\n\n        scanf(\"%d%d\",&a,&b);\n\n        addedge(a,b);\n\n        addedge(b,a);\n\n    }\n\n    for(int i = 0;i<=N-1;i++){\n\n        if(!pre[i]){\n\n            tot++;\n\n            dfs(i,-1);\n\n            ac.push_back(tot);\n\n        }\n\n    }\n\n    if(tot==1){\n\n        printf(\"%d\\n\",0);\n\n        return 0;\n\n    }\n\n    bool flag = 0;\n\n    priority_queue<int,vector<int>,greater<int> >QQ;\n\n    for(int i = 1;i<=tot;i++){\n\n       ans+=Q[i].top();\n\n       Q[i].pop();\n\n       while(!Q[i].empty()){\n\n        QQ.push(Q[i].top());\n\n        Q[i].pop();\n\n       }\n\n    }\n\n    int my =tot-2;\n\n    if(QQ.size()<my){\n\n        printf(\"Impossible\\n\");\n\n        return 0;\n\n    }\n\n    for(int i = 0;i<my;i++){\n\n        ans+=QQ.top();\n\n        QQ.pop();\n\n    }\n\n    printf(\"%lld\\n\",ans);\n\n    return 0;\n\n}\n\n/*\n\n7 4\n\n1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000\n\n0 1\n\n1 2\n\n3 4\n\n5 6\n\n6 3\n\n1 1 1 3 7 8\n\n0 4\n\n1 5\n\n2 3\n\n*/\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nclass dsu {\n\n  public:\n\n  vector<int> p;\n\n  int n;\n\n\n\n  dsu(int _n) : n(_n) {\n\n    p.resize(n);\n\n    iota(p.begin(), p.end(), 0);\n\n  }\n\n\n\n  inline int get(int x) {\n\n    return (x == p[x] ? x : (p[x] = get(p[x])));\n\n  }\n\n\n\n  inline bool unite(int x, int y) {\n\n    x = get(x);\n\n    y = get(y);\n\n    if (x != y) {\n\n      p[x] = y;\n\n      return true;\n\n    }\n\n    return false;\n\n  }\n\n};\n\n\n\nint main() {\n\n  int n, m;\n\n  scanf(\"%d %d\", &n, &m);\n\n  vector<int> a(n);\n\n  for (int i = 0; i < n; i++) {\n\n    scanf(\"%d\", &a[i]);\n\n  }\n\n  dsu d(n);\n\n  for (int i = 0; i < m; i++) {\n\n    int x, y;\n\n    scanf(\"%d %d\", &x, &y);\n\n    d.unite(x, y);\n\n  }\n\n  vector< vector<int> > comp(n);\n\n  for (int i = 0; i < n; i++) {\n\n    comp[d.get(i)].push_back(a[i]);\n\n  }\n\n  int cnt = 0;\n\n  for (int i = 0; i < n; i++) {\n\n    if (!comp[i].empty()) {\n\n      cnt++;\n\n    }\n\n  }\n\n  if (cnt == 1) {\n\n    puts(\"0\");\n\n    return 0;\n\n  }\n\n  int choose = 2 * cnt - 2;\n\n  long long ans = 0;\n\n  vector<int> other;\n\n  for (int i = 0; i < n; i++) {\n\n    if (!comp[i].empty()) {\n\n      sort(comp[i].begin(), comp[i].end());\n\n      ans += comp[i][0];\n\n      choose--;\n\n      for (int j = 1; j < (int) comp[i].size(); j++) {\n\n        other.push_back(comp[i][j]);\n\n      }\n\n    }\n\n  }\n\n  if (choose > (int) other.size()) {\n\n    puts(\"Impossible\");\n\n    return 0;\n\n  }\n\n  sort(other.begin(), other.end());\n\n  for (int i = 0; i < choose; i++) {\n\n    ans += other[i];\n\n  }\n\n  cout << ans << endl;\n\n  return 0;\n\n}"
    },
    {
        "id": "209",
        "source_code": "#include<cstdio>\n\n#include<set>\n\n#include<algorithm>\n\nusing namespace std;\n\nconst int MAXN = 100000;\n\nstruct node{\n\n\tint num, key, vis;\n\n};\n\nnode a[MAXN + 5];\n\nbool operator < (node a, node b) {\n\n\treturn a.key < b.key;\n\n}\n\nset<node>Set[MAXN + 5];\n\nint fa[MAXN + 5];\n\nint Find(int x) {\n\n\tif( fa[x] == x ) return x;\n\n\treturn fa[x] = Find(fa[x]);\n\n}\n\nint main() {\n\n\tint N, M, cnt = 0;\n\n\tscanf(\"%d%d\", &N, &M);\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tscanf(\"%d\", &a[i].key);\n\n\t\ta[i].num = fa[i] = i;\n\n\t}\n\n\tint ned = ((N-1) - M) * 2;\n\n\tif( ned > N ) {\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i=1;i<=M;i++) {\n\n\t\tint u, v;\n\n\t\tscanf(\"%d%d\", &u, &v);\n\n\t\tfa[Find(u)] = Find(v);\n\n\t}\n\n\tfor(int i=0;i<N;i++)\n\n\t\tSet[Find(i)].insert(a[i]);\n\n\tlong long ans = 0;\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tif( Find(i) == i ) {\n\n\t\t\tif( cnt == ned ) continue;\n\n\t\t\tans += Set[i].begin()->key;\n\n\t\t\ta[(*Set[i].begin()).num].vis = true;\n\n\t\t\tcnt++;\n\n\t\t}\n\n\t}\n\n\tsort(a, a+N);\n\n\tfor(int i=0;i<N;i++) {\n\n\t\tif( cnt == ned ) break;\n\n\t\tif( a[i].vis ) continue;\n\n\t\tcnt++;\n\n\t\tans += a[i].key;\n\n\t}\n\n\tprintf(\"%lld\\n\", ans);\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<cstring>\n\n#include<queue>\n\n#define MX 100005\n\nusing namespace std;\n\ntypedef pair<int,int> PA;\n\ninline int read()\n\n{\n\n\tint x=0,f=1;char c=getchar();\n\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\n\twhile(c>='0'&&c<='9')x=x*10+c-'0',c=getchar();\n\n\treturn x*f;\n\n}\n\nint n,m;\n\nint a[MX],fa[MX],bl[MX],vis[MX];\n\npriority_queue<PA> que[MX];\n\npriority_queue<int> q;\n\nint zbb(int k){return fa[k]==k?k:fa[k]=zbb(fa[k]);}\n\nint main(){\n\n\t//freopen(\"a.in\",\"r\",stdin);\n\n\tn=read();m=read();\n\n\tfor(int i=0;i<n;i++)\n\n\t\ta[i]=read();\n\n\t\n\n\tfor(int i=0;i<n;i++) fa[i]=i;\n\n\t\n\n\tint x,y,r1,r2;\n\n\tfor(int i=1;i<=m;i++)\n\n\t{\n\n\t\tx=read();y=read();\n\n\t\tr1=zbb(x);r2=zbb(y);\n\n\t\tif(r1!=r2)\n\n\t\t\tfa[r2]=r1;\n\n\t}\n\n\t\n\n\tint cnt=0;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t\tr1=zbb(i);\n\n\t\tif(!vis[r1])\n\n\t\t{\n\n\t\t\tvis[r1]=1;\n\n\t\t\tcnt++;\n\n\t\t\tbl[r1]=cnt;\n\n\t\t}\n\n\t\tque[bl[r1]].push(make_pair(-a[i],i));\n\n\t}\n\n\t\n\n\tif(cnt==1)\n\n\t{\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(n<cnt*2-2)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\t\n\n\tlong long ans=0;\n\n\tfor(int i=1;i<=cnt;i++)\n\n\t{\n\n\t\tans-=que[i].top().first;\n\n\t\tque[i].pop();\n\n\t}\n\n\t\n\n\tfor(int i=1;i<=cnt;i++)\n\n\t\twhile(!que[i].empty())\n\n\t\t{\n\n\t\t\tq.push(que[i].top().first);\n\n\t\t\tque[i].pop();\n\n\t\t}\n\n\t\n\n\tfor(int i=1;i<=cnt-2;i++)\n\n\t{\n\n\t\tans-=q.top();q.pop();\n\n\t}\n\n\t\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}"
    },
    {
        "id": "210",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\nconst int maxn=100010;\n\nmultiset<int> S[maxn];\n\nset<pair<int,int> > S2;\n\nstruct Edge\n\n{\n\n\tint v,next;\n\n}\te[maxn<<1];\n\nint g[maxn],tot;\n\nvoid addedge(int x,int y)\n\n{\n\n\ttot++;\n\n\te[tot].v=y;\n\n\te[tot].next=g[x];\n\n\tg[x]=tot;\n\n}\n\nint n,m;\n\nbool vis[maxn];\n\nint a[maxn];\n\n\n\nvoid dfs(int t,int ha)\n\n{\n\n\tS[ha].insert(a[t]);\n\n\tvis[t]=true;\n\n\tfor (int i=g[t];i;i=e[i].next)\n\n\tif (!vis[e[i].v])\n\n\t\tdfs(e[i].v,ha);\n\n}\n\nint Union(pair<int,int> x,pair<int,int> y)\n\n{\n\n\tmultiset<int>::iterator it=S[x.second].lower_bound(x.first);\n\n\tS[x.second].erase(it);\n\n\tit=S[y.second].lower_bound(y.first);\n\n\tS[y.second].erase(it);\n\n\tint l=x.second,r=y.second;\n\n\tif (S[l].size()>S[r].size())\tswap(l,r);\n\n\tfor (auto i:S[l])\n\n\t\tS[r].insert(i);\n\n\tS[l].clear();\n\n\treturn r;\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor (int i=1;i<=n;i++)\tscanf(\"%d\",&a[i]);\n\n\tfor (int i=1;i<=m;i++)\n\n\t{\n\n\t\tint x,y;\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tx++;y++;\n\n\t\taddedge(x,y);\n\n\t\taddedge(y,x);\n\n\t}\n\n\tfor (int i=1;i<=n;i++)\n\n\tif (!vis[i])\n\n\t\tdfs(i,i);\n\n\tfor (int i=1;i<=n;i++)\n\n\t\tif (!S[i].empty())\n\n\t\t\tS2.insert(make_pair(S[i].size(),i));\n\n\tll ans=0;\n\n\tfor (int i=1;i<=n-1-m;i++)\n\n\t{\n\n\t\tif (S2.empty())\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tpair<int,int> tmp1=*--S2.end();\n\n\t\tS2.erase(--S2.end());\n\n\t\tif (S2.empty())\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tpair<int,int> tmp2=*--S2.end();\n\n\t\tS2.erase(--S2.end());\n\n\t\ttmp1.first=*S[tmp1.second].begin();\n\n\t\ttmp2.first=*S[tmp2.second].begin();\n\n\t\tans+=tmp1.first+tmp2.first;\n\n\t\tint q=Union(tmp1,tmp2);\n\n\t\tif (!S[q].empty())\tS2.insert(make_pair(S[q].size(),q));\n\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<cstring>\n\n#include<queue>\n\n#define MX 100005\n\nusing namespace std;\n\ntypedef pair<int,int> PA;\n\ninline int read()\n\n{\n\n\tint x=0,f=1;char c=getchar();\n\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\n\twhile(c>='0'&&c<='9')x=x*10+c-'0',c=getchar();\n\n\treturn x*f;\n\n}\n\nint n,m;\n\nint a[MX],fa[MX],bl[MX],vis[MX];\n\npriority_queue<PA> que[MX];\n\npriority_queue<int> q;\n\nint zbb(int k){return fa[k]==k?k:fa[k]=zbb(fa[k]);}\n\nint main(){\n\n\t//freopen(\"a.in\",\"r\",stdin);\n\n\tn=read();m=read();\n\n\tfor(int i=0;i<n;i++)\n\n\t\ta[i]=read();\n\n\t\n\n\tfor(int i=0;i<n;i++) fa[i]=i;\n\n\t\n\n\tint x,y,r1,r2;\n\n\tfor(int i=1;i<=m;i++)\n\n\t{\n\n\t\tx=read();y=read();\n\n\t\tr1=zbb(x);r2=zbb(y);\n\n\t\tif(r1!=r2)\n\n\t\t\tfa[r2]=r1;\n\n\t}\n\n\t\n\n\tint cnt=0;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t\tr1=zbb(i);\n\n\t\tif(!vis[r1])\n\n\t\t{\n\n\t\t\tvis[r1]=1;\n\n\t\t\tcnt++;\n\n\t\t\tbl[r1]=cnt;\n\n\t\t}\n\n\t\tque[bl[r1]].push(make_pair(-a[i],i));\n\n\t}\n\n\t\n\n\tif(cnt==1)\n\n\t{\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(n<cnt*2-2)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\t\n\n\tlong long ans=0;\n\n\tfor(int i=1;i<=cnt;i++)\n\n\t{\n\n\t\tans-=que[i].top().first;\n\n\t\tque[i].pop();\n\n\t}\n\n\t\n\n\tfor(int i=1;i<=cnt;i++)\n\n\t\twhile(!que[i].empty())\n\n\t\t{\n\n\t\t\tq.push(que[i].top().first);\n\n\t\t\tque[i].pop();\n\n\t\t}\n\n\t\n\n\tfor(int i=1;i<=cnt-2;i++)\n\n\t{\n\n\t\tans-=q.top();q.pop();\n\n\t}\n\n\t\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}"
    },
    {
        "id": "211",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn = 1e5+100;\n\ntypedef long long LL;\n\nint val[maxn],First[maxn],cnt,N,M;\n\nint tot,pre[maxn];\n\nLL ans = 0;\n\nstruct node{\n\n    int to,Next;\n\n}Tree[maxn*2];\n\nvoid init(){\n\n    memset(First,-1,sizeof(First));\n\n    cnt = 0;\n\n}\n\nvoid addedge(int from,int to){\n\n    Tree[cnt].to = to;\n\n    Tree[cnt].Next = First[from];\n\n    First[from] = cnt++;\n\n}\n\npriority_queue<int,vector<int>,greater<int> > Q[maxn];\n\nvoid dfs(int u,int fa){\n\n    pre[u] = 1;\n\n    Q[tot].push(val[u]);\n\n    for(int i = First[u];i!=-1;i=Tree[i].Next){\n\n        int to = Tree[i].to;\n\n        if(to==fa)continue;\n\n        dfs(to,u);\n\n    }\n\n}\n\nvector<int> ac,bc;\n\nint main(){\n\n    init();\n\n    scanf(\"%d%d\",&N,&M);\n\n    for(int i = 0;i<=N-1;i++)scanf(\"%d\",&val[i]);\n\n    for(int i = 0;i<M;i++){\n\n        int a,b;\n\n        scanf(\"%d%d\",&a,&b);\n\n        addedge(a,b);\n\n        addedge(b,a);\n\n    }\n\n    for(int i = 0;i<=N-1;i++){\n\n        if(!pre[i]){\n\n            tot++;\n\n            dfs(i,-1);\n\n            ac.push_back(tot);\n\n        }\n\n    }\n\n    if(tot==1){\n\n        printf(\"%d\\n\",0);\n\n        return 0;\n\n    }\n\n    bool flag = 0;\n\n    priority_queue<int,vector<int>,greater<int> >QQ;\n\n    for(int i = 1;i<=tot;i++){\n\n       ans+=Q[i].top();\n\n       Q[i].pop();\n\n       while(!Q[i].empty()){\n\n        QQ.push(Q[i].top());\n\n        Q[i].pop();\n\n       }\n\n    }\n\n    int my =tot-2;\n\n    if(QQ.size()<my){\n\n        printf(\"Impossible\\n\");\n\n        return 0;\n\n    }\n\n    for(int i = 0;i<my;i++){\n\n        ans+=QQ.top();\n\n        QQ.pop();\n\n    }\n\n    printf(\"%lld\\n\",ans);\n\n    return 0;\n\n}\n\n/*\n\n7 4\n\n1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000\n\n0 1\n\n1 2\n\n3 4\n\n5 6\n\n6 3\n\n1 1 1 3 7 8\n\n0 4\n\n1 5\n\n2 3\n\n*/\n",
        "optimized_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<cstring>\n\n#include<queue>\n\n#define MX 100005\n\nusing namespace std;\n\ntypedef pair<int,int> PA;\n\ninline int read()\n\n{\n\n\tint x=0,f=1;char c=getchar();\n\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\n\twhile(c>='0'&&c<='9')x=x*10+c-'0',c=getchar();\n\n\treturn x*f;\n\n}\n\nint n,m;\n\nint a[MX],fa[MX],bl[MX],vis[MX];\n\npriority_queue<PA> que[MX];\n\npriority_queue<int> q;\n\nint zbb(int k){return fa[k]==k?k:fa[k]=zbb(fa[k]);}\n\nint main(){\n\n\t//freopen(\"a.in\",\"r\",stdin);\n\n\tn=read();m=read();\n\n\tfor(int i=0;i<n;i++)\n\n\t\ta[i]=read();\n\n\t\n\n\tfor(int i=0;i<n;i++) fa[i]=i;\n\n\t\n\n\tint x,y,r1,r2;\n\n\tfor(int i=1;i<=m;i++)\n\n\t{\n\n\t\tx=read();y=read();\n\n\t\tr1=zbb(x);r2=zbb(y);\n\n\t\tif(r1!=r2)\n\n\t\t\tfa[r2]=r1;\n\n\t}\n\n\t\n\n\tint cnt=0;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t\tr1=zbb(i);\n\n\t\tif(!vis[r1])\n\n\t\t{\n\n\t\t\tvis[r1]=1;\n\n\t\t\tcnt++;\n\n\t\t\tbl[r1]=cnt;\n\n\t\t}\n\n\t\tque[bl[r1]].push(make_pair(-a[i],i));\n\n\t}\n\n\t\n\n\tif(cnt==1)\n\n\t{\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(n<cnt*2-2)\n\n\t{\n\n\t\tprintf(\"Impossible\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\t\n\n\tlong long ans=0;\n\n\tfor(int i=1;i<=cnt;i++)\n\n\t{\n\n\t\tans-=que[i].top().first;\n\n\t\tque[i].pop();\n\n\t}\n\n\t\n\n\tfor(int i=1;i<=cnt;i++)\n\n\t\twhile(!que[i].empty())\n\n\t\t{\n\n\t\t\tq.push(que[i].top().first);\n\n\t\t\tque[i].pop();\n\n\t\t}\n\n\t\n\n\tfor(int i=1;i<=cnt-2;i++)\n\n\t{\n\n\t\tans-=q.top();q.pop();\n\n\t}\n\n\t\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}"
    },
    {
        "id": "212",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nconst int N = 1e5 + 7;\n\n\n\nlong long a[N];\n\nvector <int> ad[N];\n\nint n, m;\n\nint cnt;\n\nbool mrk[N];\n\nset < pair<long long, int> > s[N];\n\nset < pair<long long, int> > can;\n\nvoid dfs(int v) {\n\n\tmrk[v] = 1;\n\n\ts[cnt].insert({a[v], v});\n\n\tfor (auto u: ad[v]) {\n\n\t\tif (!mrk[u])\n\n\t\t\tdfs(u);\n\n\t}\n\n}\n\n\n\nint main() {\t\n\n\tcin >> n >> m;\n\n\tfor (int i = 1; i <= n; i++)\n\n\t\tcin >> a[i];\t\n\n\tfor (int i = 1; i <= m; i++) {\n\n\t\tint x, y;\n\n\t\tcin >> x >> y;\n\n\t\tx++, y++;\n\n\t\tad[x].push_back(y);\n\n\t\tad[y].push_back(x);\n\n\t}\n\n\tfor (int i = 1; i <= n; i++) {\n\n\t\tif (!mrk[i]) {\n\n\t\t\tcnt++;\n\n\t\t\tdfs(i);\n\n\t\t}\n\n\t}\n\n\tif (cnt == 1) {\n\n\t\tcout << 0;\n\n\t\treturn 0;\n\n\t}\n\n\tlong long res = 0;\n\n\tfor (int i = 1; i <= cnt; i++) {\n\n\t\tres += s[i].begin()->first;\n\n\t\ts[i].erase(s[i].begin());\n\n\t\twhile(s[i].size()) {\n\n\t\t\tcan.insert({s[i].begin()->first, s[i].begin()->second});\n\n\t\t\ts[i].erase(s[i].begin());\n\n\t\t}\n\n\t}\n\n\tint tt = 2 * (cnt - 1) - cnt;\n\n\tif ((tt + cnt) % 2)\n\n\t\ttt++;\n\n\tif (can.size() < tt) {\n\n\t\tcout << \"Impossible\";\n\n\t\treturn 0;\n\n\t}\t\n\n\tfor (int i = 1; i <= tt; i++) {\n\n\t\tres += can.begin()->first;\n\n\t\tcan.erase(can.begin());\n\n\t}\n\n\tcout << res;\n\n\t}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\n\n\nconst int N = 1e5 + 10;\n\nint a[N], mark[N];\n\nvector<int> adj[N], v[N];\n\n\n\nvoid dfs(int root, int col) {\n\n    mark[root] = col;\n\n    for (int i = 0; i < adj[root].size(); i++) {\n\n        int u = adj[root][i];\n\n        if (!mark[u])\n\n            dfs(u, col);\n\n    }\n\n}\n\n\n\nint main() {\n\n    ios_base::sync_with_stdio(false), cin.tie(0), cout.tie(0);\n\n    int n, m, x, y;\n\n    cin >> n >> m;\n\n    for (int i = 0; i < n; i++)\n\n        cin >> a[i];\n\n    for (int i = 0; i < m; i++) {\n\n        cin >> x >> y;\n\n        adj[x].push_back(y);\n\n        adj[y].push_back(x);\n\n    }\n\n    int cnt = 0;\n\n    for (int i = 0; i < n; i++)\n\n        if (!mark[i]) {\n\n            cnt++;\n\n            dfs(i, cnt);\n\n        }\n\n    if (n < 2 * cnt - 2) {\n\n        cout << \"Impossible\\n\";\n\n        return 0;\n\n    }\n\n    for (int i = 0; i < n; i++) {\n\n        v[mark[i]].push_back(a[i]);\n\n    }\n\n    for (int i = 1; i <= cnt; i++)\n\n        sort(v[i].begin(), v[i].end());\n\n    ll ans = 0;\n\n    if (cnt > 1) {\n\n        vector<int> u;\n\n        for (int i = 1; i <= cnt; i++) {\n\n            ans += v[i][0];\n\n            for (int j = 1; j < v[i].size(); j++)\n\n                u.push_back(v[i][j]);\n\n        }\n\n        sort(u.begin(), u.end());\n\n        for (int i = 0; i < cnt - 2; i++)\n\n            ans += u[i];\n\n    }\n\n    cout << ans << \"\\n\";\n\n    return 0;\n\n}\n"
    },
    {
        "id": "213",
        "source_code": "//IOI 2021\n\n\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define pb push_back\n\n#define ff first\n\n#define ss second\n\ntypedef long long ll;\n\ntypedef pair<int, int> pii;\n\n\n\nconst int MAXSU = 1000 * 1000 + 17;\n\n\n\nstruct DSU {\n\n\tint par[MAXSU];\n\n\tDSU () {\n\n\t\tmemset(par, -1, sizeof(par));\n\n\t}\n\n\tint find_root(int x) {\n\n\t\treturn (par[x] == -1? x: par[x] = find_root(par[x]));\n\n\t}\n\n\tbool set_union(int x, int y) {\n\n\t\tint p1 = find_root(x), p2 = find_root(y);\n\n\t\treturn (p1 == p2? false: (par[p1] = p2) | 1);\n\n\t}\n\n};\n\n\n\nconst int MAXN = 100 * 1000 + 17;\n\n\n\nint n, m, a[MAXN], cnt;\n\nll ans;\n\nmultiset<int> cmp[MAXN];\n\nvector<int> t;\n\nDSU gr;\n\n\n\nint main() {\n\n\tios_base::sync_with_stdio(false), cin.tie(0), cout.tie(0);\n\n\tcin >> n >> m;\n\n\tfor (int i = 1; i <= n; i++)\n\n\t\tcin >> a[i];\n\n\tfor (int i = 1; i <= m; i++) {\n\n\t\tint v, u;\n\n\t\tcin >> v >> u;\n\n\t\tv++;\n\n\t\tu++;\n\n\t\tgr.set_union(v, u);\n\n\t}\n\n\tif (m == n - 1)\n\n\t\treturn cout << 0 << endl, 0;\n\n\n\n\tfor (int i = 1; i <= n; i++)\n\n\t\tcmp[gr.find_root(i)].insert(a[i]);\n\n\tfor (int i = 1; i <= n; i++) {\n\n\t\tif (cmp[i].size())\n\n\t\t\tcnt++;\n\n\t\telse\n\n\t\t\tcontinue;\n\n\t\tans += (*cmp[i].begin());\n\n\t\tcmp[i].erase(cmp[i].begin());\n\n\t\tfor (auto j : cmp[i])\n\n\t\t\tt.pb(j);\n\n\t}\n\n\tif ((int)t.size() < cnt - 2)\n\n\t\treturn cout << \"Impossible\" << endl, 0;\n\n\n\n\tsort(t.begin(), t.end());\n\n\tfor (int i = 0; i < cnt - 2; i++)\n\n\t\tans += t[i];\n\n\tcout << ans << endl;\n\n\treturn 0;\n\n\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\n\n\nconst int N = 1e5 + 10;\n\nint a[N], mark[N];\n\nvector<int> adj[N], v[N];\n\n\n\nvoid dfs(int root, int col) {\n\n    mark[root] = col;\n\n    for (int i = 0; i < adj[root].size(); i++) {\n\n        int u = adj[root][i];\n\n        if (!mark[u])\n\n            dfs(u, col);\n\n    }\n\n}\n\n\n\nint main() {\n\n    ios_base::sync_with_stdio(false), cin.tie(0), cout.tie(0);\n\n    int n, m, x, y;\n\n    cin >> n >> m;\n\n    for (int i = 0; i < n; i++)\n\n        cin >> a[i];\n\n    for (int i = 0; i < m; i++) {\n\n        cin >> x >> y;\n\n        adj[x].push_back(y);\n\n        adj[y].push_back(x);\n\n    }\n\n    int cnt = 0;\n\n    for (int i = 0; i < n; i++)\n\n        if (!mark[i]) {\n\n            cnt++;\n\n            dfs(i, cnt);\n\n        }\n\n    if (n < 2 * cnt - 2) {\n\n        cout << \"Impossible\\n\";\n\n        return 0;\n\n    }\n\n    for (int i = 0; i < n; i++) {\n\n        v[mark[i]].push_back(a[i]);\n\n    }\n\n    for (int i = 1; i <= cnt; i++)\n\n        sort(v[i].begin(), v[i].end());\n\n    ll ans = 0;\n\n    if (cnt > 1) {\n\n        vector<int> u;\n\n        for (int i = 1; i <= cnt; i++) {\n\n            ans += v[i][0];\n\n            for (int j = 1; j < v[i].size(); j++)\n\n                u.push_back(v[i][j]);\n\n        }\n\n        sort(u.begin(), u.end());\n\n        for (int i = 0; i < cnt - 2; i++)\n\n            ans += u[i];\n\n    }\n\n    cout << ans << \"\\n\";\n\n    return 0;\n\n}\n"
    },
    {
        "id": "214",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nvector <long long> l,q[100005];\n\nlong long n,m,x,y,ans,tot,w[100005],f[100005],cnt[100005];\n\nlong long find(long long x)\n\n{\n\n\treturn f[x]==x?f[x]:f[x]=find(f[x]);\n\n}\n\nint main()\n\n{\n\n\tcin>>n>>m;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tf[i]=i;\n\n\t\tcin>>w[i];\n\n\t}\n\n\tfor(int i=1;i<=m;i++)\n\n\t{\n\n\t\tcin>>x>>y;\n\n\t\tf[find(x+1)]=f[find(x+1)]==find(y+1)?f[find(x+1)]:f[find(x+1)]=find(y+1);\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tq[(cnt[find(i)]=cnt[find(i)]?cnt[find(i)]:++tot)].push_back(w[i]);\n\n\t}\n\n\tif(tot==1)\n\n\t{\n\n\t\tcout<<0<<endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i=1;i<=tot;i++)\n\n\t{\n\n\t\tsort(q[i].begin(),q[i].end());\n\n\t\tans+=q[i][0];\n\n\t\tfor(int j=1;j<q[i].size();j++)\n\n\t\t{\n\n\t\t\tl.push_back(q[i][j]);\n\n\t\t}\n\n\t}\n\n\tsort(l.begin(),l.end());\n\n\tif(l.size()<tot-2)\n\n\t{\n\n\t\tcout<<\"Impossible\"<<endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i=0;i<tot-2;i++)\n\n\t{\n\n\t\tans+=l[i];\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<bits/stdc++.h>\n\n#define ri register int\n\nusing namespace std;\n\nint n,m,a[100005],f[100005],b[100005],t,c;\n\nlong long ans;\n\ninline int read()\n\n{\n\n\tchar ch=getchar();int x=0,f=1;while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\n\twhile(ch>='0'&&ch<='9')x=(x<<1)+(x<<3)+(ch^48),ch=getchar();return x*f;\n\n}\n\ninline int gf(ri x){return f[x]==x?x:f[x]=gf(f[x]);}\n\nint main()\n\n{\n\n\tn=read();m=read();for(ri i=1;i<=n;++i)a[i]=read(),f[i]=i;\n\n\tfor(ri i=1,x,y;i<=m;++i)\n\n\tx=gf(read()+1),y=gf(read()+1),b[++t]=max(a[x],a[y]),a[x]=min(a[x],a[y]),f[y]=x;\n\n\tfor(ri i=1;i<=n;++i)if(f[i]==i)ans+=a[i],c++;if(c==1){puts(\"0\");return 0;}\n\n\tif(2*(c-1)>n){puts(\"Impossible\");return 0;}sort(b+1,b+1+t);\n\n\t//for(ri i=1;i<=t;++i)cout<<b[i]<<\" \";\n\n\tfor(ri i=1;i<=c-2;++i)ans+=b[i];printf(\"%lld\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "215",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn=1e5+5;\n\nint n,m;\n\nint fa[maxn];\n\nint find(int x){return (fa[x]==x ? x : fa[x]=find(fa[x]));}\n\nint a[maxn];\n\nvector<int>val[maxn];\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tscanf(\"%d\",&a[i]);\n\n\t\tfa[i]=i;\n\n\t}\n\n\twhile(m--){\n\n\t\tint u,v;\n\n\t\tscanf(\"%d%d\",&u,&v);\n\n\t\tu++;v++;\n\n\t\tfa[find(u)]=find(v);\n\n\t}\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tval[find(i)].push_back(a[i]);\n\n\t}\n\n\tint cnt=0;\n\n\tint pt=0,one=0;\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tsort(val[i].begin(),val[i].end());\n\n\t\tcnt+=(val[i].size()>0);\n\n\t\tif(val[i].size()>1)\n\n\t\t\tpt+=val[i].size()-1;\n\n\t\tif(val[i].size()==1)\n\n\t\t\tone++;\n\n\t}\n\n\tif(cnt==1){\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(one>pt){\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\n\n\tint sel=2*(cnt-1)-cnt;\n\n\tvector<int>num;\n\n\tlong long ans=0;\n\n\n\n\tfor(int i=1;i<=n;i++)if(val[i].size()){\n\n\t\tans+=val[i][0];\n\n\t\tfor(int j=1;j<val[i].size();j++){\n\n\t\t\tnum.push_back(val[i][j]);\n\n\t\t}\n\n\t}\n\n\tsort(num.begin(),num.end());\n\n\tif(num.size()<sel){\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i=0;i<sel;i++){\n\n\t\tans+=num[i];\n\n\t}\n\n\n\n\tcout<<ans<<endl;\n\n\n\n\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\n#define MAXN 100000\n\n#define INF 0x3FFFFFFF\n\nusing namespace std;\n\nstruct node\n\n{\n\n\tint to;\n\n\tnode *next;\n\n}edge[MAXN*2+5];\n\nnode *ncnt=&edge[0],*Adj[MAXN+5];\n\nstruct point\n\n{\n\n\tint val;\n\n\tbool vis;\n\n}poi[MAXN+5];\n\nint minval=INF,minid,N,M;\n\nbool visit[MAXN+5];\n\nbool cmp(point a,point b)\n\n{\n\n\treturn a.val<b.val;\n\n}\n\nvoid AddEdge(int u,int v)\n\n{\n\n\tnode *p=++ncnt;\n\n\tp->to=v;\n\n\tp->next=Adj[u];\n\n\tAdj[u]=p;\n\n\t\n\n\tnode *q=++ncnt;\n\n\tq->to=u;\n\n\tq->next=Adj[v];\n\n\tAdj[v]=q;\n\n}\n\nvoid dfs(int u)\n\n{\n\n\tint v;\n\n\tvisit[u]=true;\n\n\tif(poi[u].val<minval)\n\n\t\tminval=poi[u].val,minid=u;\n\n\tfor(node *p=Adj[u];p!=NULL;p=p->next)\n\n\t{\n\n\t\tv=p->to;\n\n\t\tif(visit[v]==false)\n\n\t\t\tdfs(v);\n\n\t}\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d %d\",&N,&M);\n\n\tfor(int i=0;i<N;i++)\n\n\t\tscanf(\"%d\",&poi[i].val),poi[i].vis=false;\n\n\tint x,y;\n\n\tfor(int i=1;i<=M;i++)\n\n\t{\n\n\t\tscanf(\"%d %d\",&x,&y);\n\n\t\tAddEdge(x,y);\n\n\t}\n\n\tint cnt=0;\n\n\tlong long ret=0LL;\n\n\tfor(int i=0;i<N;i++)\n\n\t\tif(visit[i]==false)\n\n\t\t{\n\n\t\t\tminval=INF;\n\n\t\t\tcnt++;\n\n\t\t\tdfs(i);\n\n\t\t\tpoi[minid].vis=true;\n\n\t\t\tret+=1LL*minval;\n\n\t\t}\n\n\tif(cnt<=1)\n\n\t{\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tcnt=cnt-2;\n\n\tsort(poi,poi+N,cmp);\n\n\tfor(int i=0;i<N;i++)\n\n\t{\n\n\t\tif(cnt<=0)\n\n\t\t\tbreak;\n\n\t\tif(poi[i].vis==false)\n\n\t\t\tret+=1LL*poi[i].val,cnt--;\n\n\t}\n\n\tif(cnt>0)\n\n\t\tprintf(\"Impossible\\n\");\n\n\telse\n\n\t\tprintf(\"%lld\\n\",ret);\n\n\treturn 0;\n\n}\n\n/*\n\n7 4\n\n1 2 3 4 5 6 7\n\n3 0\n\n4 0\n\n1 2\n\n5 6\n\n\n\n*/"
    },
    {
        "id": "216",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\nusing namespace std;\n\nconst long long MAXN=100005;\n\n\n\nnamespace DSU\n\n{\n\n\tlong long fa[MAXN];\n\n\tvoid Clear()\n\n\t{memset(fa,-1,sizeof fa);}\n\n\tlong long Root(long long x)\n\n\t{return fa[x]==-1?x:(fa[x]=Root(fa[x]));}\n\n\tvoid Union(long long x,long long y)\n\n\t{\n\n\t\tlong long r1=Root(x),r2=Root(y);\n\n\t\tif(r1!=r2)\n\n\t\t\tfa[r1]=r2;\n\n\t}\n\n}\n\n\n\nstruct Vertice\n\n{\n\n\tlong long val,id;\n\n\tVertice(){val=0x3F3F3F3F3F3F3F3FLL;}\n\n\tVertice(long long v,long long i){val=v;id=i;}\n\n\tbool operator < (const Vertice &t)const\n\n\t{return val<t.val;}\n\n};\n\n\n\nVertice V[MAXN],tr[MAXN];\n\nbool used[MAXN];\n\nbool mk[MAXN];\n\n\n\nint main()\n\n{\n\n\tlong long n,m;\n\n\tscanf(\"%lld%lld\",&n,&m);\n\n\tfor(long long i=0,a;i<n;i++)\n\n\t{\n\n\t\tscanf(\"%lld\",&a);\n\n\t\tV[i]=Vertice(a,i);\n\n\t}\n\n\tDSU::Clear();\n\n\tfor(long long i=0,u,v;i<m;i++)\n\n\t{\n\n\t\tscanf(\"%lld%lld\",&u,&v);\n\n\t\tDSU::Union(u,v);\n\n\t}\n\n\tint cc=0;\n\n\tfor(int i=0;i<n;i++)\n\n\t\tif(!mk[DSU::Root(i)])\n\n\t\t{\n\n\t\t\tmk[DSU::Root(i)]=true;\n\n\t\t\tcc++;\n\n\t\t}\n\n\tif(cc==1)\n\n\t{\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(2*cc-2>n)\n\n\t{\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(long long i=0;i<n;i++)\n\n\t{\n\n\t\tint r=DSU::Root(i);\n\n\t\ttr[r]=min(tr[r],V[i]);\n\n\t}\n\n\tlong long ans=0,cnt=2*cc-2;\n\n\tfor(long long i=0;i<n&&cnt;i++)\n\n\t{\n\n\t\tint r=DSU::Root(i);\n\n\t\tif(!used[tr[r].id])\n\n\t\t{\n\n\t\t\tans+=tr[r].val;\n\n\t\t\tused[tr[r].id]=true;\n\n\t\t\tcnt--;\n\n\t\t}\n\n\t}\n\n\tsort(V,V+n);\n\n\tfor(long long i=0;i<n&&cnt;i++)\n\n\t\tif(!used[V[i].id])\n\n\t\t{\n\n\t\t\tans+=V[i].val;\n\n\t\t\tcnt--;\n\n\t\t}\n\n\t\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn=100005;\n\nconst int inf=0x3f3f3f3f;\n\nint n,m,a[maxn],minid[maxn],mmin[maxn],id[maxn],cc;\n\nlong long res;\n\nvector<int> G[maxn];\n\nvoid dfs(int u,int c) {\n\n    id[u]=c;\n\n    if (a[u]<mmin[c]) {\n\n        mmin[c]=a[u];\n\n        minid[c]=u;\n\n    }\n\n    for (int i=0;i<(int)G[u].size();++i) {\n\n        int v=G[u][i];\n\n        if (id[v]) continue;\n\n        dfs(v,c);\n\n    }\n\n}\n\nint main()\n\n{\n\n    scanf(\"%d%d\",&n,&m);\n\n    for (int i=0;i<n;++i)\n\n        scanf(\"%d\",&a[i]),mmin[i]=inf;\n\n    while (m--) {\n\n        int u,v;\n\n        scanf(\"%d%d\",&u,&v);\n\n        G[u].push_back(v);\n\n        G[v].push_back(u);\n\n    }\n\n    for (int i=0;i<n;++i)\n\n        if (!id[i])\n\n            dfs(i,++cc);\n\n    if (cc==1) return 0*puts(\"0\");\n\n    int point=0;\n\n    for (int i=1;i<=cc;++i)\n\n        res+=a[minid[i]],a[minid[i]]=inf,++point;\n\n    sort(a,a+n);\n\n    for (int i=0;i<n;++i)\n\n        if (a[i]!=inf&&cc+cc-2>point)\n\n            ++point,res+=a[i];\n\n    if (cc+cc-2>point) return 0*puts(\"Impossible\");\n\n    return cout<<res<<endl,0;\n\n}\n"
    },
    {
        "id": "217",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn=1e5+5;\n\nint n,m;\n\nint fa[maxn];\n\nint find(int x){return (fa[x]==x ? x : fa[x]=find(fa[x]));}\n\nint a[maxn];\n\nvector<int>val[maxn];\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tscanf(\"%d\",&a[i]);\n\n\t\tfa[i]=i;\n\n\t}\n\n\twhile(m--){\n\n\t\tint u,v;\n\n\t\tscanf(\"%d%d\",&u,&v);\n\n\t\tu++;v++;\n\n\t\tfa[find(u)]=find(v);\n\n\t}\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tval[find(i)].push_back(a[i]);\n\n\t}\n\n\tint cnt=0;\n\n\tint pt=0,one=0;\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tsort(val[i].begin(),val[i].end());\n\n\t\tcnt+=(val[i].size()>0);\n\n\t\tif(val[i].size()>1)\n\n\t\t\tpt+=val[i].size()-1;\n\n\t\tif(val[i].size()==1)\n\n\t\t\tone++;\n\n\t}\n\n\tif(cnt==1){\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(one>pt){\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\n\n\tint sel=2*(cnt-1)-cnt;\n\n\tvector<int>num;\n\n\tlong long ans=0;\n\n\n\n\tfor(int i=1;i<=n;i++)if(val[i].size()){\n\n\t\tans+=val[i][0];\n\n\t\tfor(int j=1;j<val[i].size();j++){\n\n\t\t\tnum.push_back(val[i][j]);\n\n\t\t}\n\n\t}\n\n\tsort(num.begin(),num.end());\n\n\tif(num.size()<sel){\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i=0;i<sel;i++){\n\n\t\tans+=num[i];\n\n\t}\n\n\n\n\tcout<<ans<<endl;\n\n\n\n\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\n#define maxn 100005\n\n#define LL long long\n\nusing namespace std;\n\nint n,m,fa[maxn],use[maxn],cnt;\n\nLL ans;\n\nstruct node { int w;bool vis; } a[maxn];\n\nbool cmp(node p,node q) \n\n{\n\n\tif(p.vis) return false;\n\n\tif(q.vis) return true;\n\n\treturn p.w<q.w; \n\n}\n\nint find(int x)\n\n{\n\n\tif(fa[x]==x) return x;\n\n\treturn fa[x]=find(fa[x]);\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d\",&a[i].w);\n\n\t\tfa[i]=i;use[i]=i;\n\n\t\ta[i].vis=true;\n\n\t}\n\n\tfor(int i=1;i<=m;i++)\n\n\t{\n\n\t\tint u,v;\n\n\t\tscanf(\"%d%d\",&u,&v);\n\n\t\tu++,v++;\n\n\t\tint r1=find(u),r2=find(v);\n\n\t\tif(r1!=r2)\n\n\t\t{\n\n\t\t\tif(a[use[r2]].w<a[use[r1]].w)\n\n\t\t\t{\n\n\t\t\t\ta[use[r1]].vis=false;\n\n\t\t\t\tuse[r1]=use[r2];\n\n\t\t\t}\n\n\t\t\telse a[use[r2]].vis=false;\n\n\t\t\tfa[r2]=r1;\n\n\t\t}\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tif(find(i)==i) \n\n\t\t{\n\n\t\t\tans+=1ll*a[use[i]].w;\n\n\t\t\tcnt++;\n\n\t\t}\n\n\tif(cnt==1)\n\n\t{\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tsort(a+1,a+n+1,cmp);\n\n\tfor(int i=1;i<=cnt-2;i++)\n\n\t\tif(a[i].vis)\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\telse ans+=1ll*a[i].w;\n\n\tprintf(\"%lld\\n\",ans);\n\n}"
    },
    {
        "id": "218",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\nusing namespace std;\n\nconst long long MAXN=100005;\n\n\n\nnamespace DSU\n\n{\n\n\tlong long fa[MAXN];\n\n\tvoid Clear()\n\n\t{memset(fa,-1,sizeof fa);}\n\n\tlong long Root(long long x)\n\n\t{return fa[x]==-1?x:(fa[x]=Root(fa[x]));}\n\n\tvoid Union(long long x,long long y)\n\n\t{\n\n\t\tlong long r1=Root(x),r2=Root(y);\n\n\t\tif(r1!=r2)\n\n\t\t\tfa[r1]=r2;\n\n\t}\n\n}\n\n\n\nstruct Vertice\n\n{\n\n\tlong long val,id;\n\n\tVertice(){val=0x3F3F3F3F3F3F3F3FLL;}\n\n\tVertice(long long v,long long i){val=v;id=i;}\n\n\tbool operator < (const Vertice &t)const\n\n\t{return val<t.val;}\n\n};\n\n\n\nVertice V[MAXN],tr[MAXN];\n\nbool used[MAXN];\n\nbool mk[MAXN];\n\n\n\nint main()\n\n{\n\n\tlong long n,m;\n\n\tscanf(\"%lld%lld\",&n,&m);\n\n\tfor(long long i=0,a;i<n;i++)\n\n\t{\n\n\t\tscanf(\"%lld\",&a);\n\n\t\tV[i]=Vertice(a,i);\n\n\t}\n\n\tDSU::Clear();\n\n\tfor(long long i=0,u,v;i<m;i++)\n\n\t{\n\n\t\tscanf(\"%lld%lld\",&u,&v);\n\n\t\tDSU::Union(u,v);\n\n\t}\n\n\tint cc=0;\n\n\tfor(int i=0;i<n;i++)\n\n\t\tif(!mk[DSU::Root(i)])\n\n\t\t{\n\n\t\t\tmk[DSU::Root(i)]=true;\n\n\t\t\tcc++;\n\n\t\t}\n\n\tif(cc==1)\n\n\t{\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(2*cc-2>n)\n\n\t{\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(long long i=0;i<n;i++)\n\n\t{\n\n\t\tint r=DSU::Root(i);\n\n\t\ttr[r]=min(tr[r],V[i]);\n\n\t}\n\n\tlong long ans=0,cnt=2*cc-2;\n\n\tfor(long long i=0;i<n&&cnt;i++)\n\n\t{\n\n\t\tint r=DSU::Root(i);\n\n\t\tif(!used[tr[r].id])\n\n\t\t{\n\n\t\t\tans+=tr[r].val;\n\n\t\t\tused[tr[r].id]=true;\n\n\t\t\tcnt--;\n\n\t\t}\n\n\t}\n\n\tsort(V,V+n);\n\n\tfor(long long i=0;i<n&&cnt;i++)\n\n\t\tif(!used[V[i].id])\n\n\t\t{\n\n\t\t\tans+=V[i].val;\n\n\t\t\tcnt--;\n\n\t\t}\n\n\t\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\n#define maxn 100005\n\n#define LL long long\n\nusing namespace std;\n\nint n,m,fa[maxn],use[maxn],cnt;\n\nLL ans;\n\nstruct node { int w;bool vis; } a[maxn];\n\nbool cmp(node p,node q) \n\n{\n\n\tif(p.vis) return false;\n\n\tif(q.vis) return true;\n\n\treturn p.w<q.w; \n\n}\n\nint find(int x)\n\n{\n\n\tif(fa[x]==x) return x;\n\n\treturn fa[x]=find(fa[x]);\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d\",&a[i].w);\n\n\t\tfa[i]=i;use[i]=i;\n\n\t\ta[i].vis=true;\n\n\t}\n\n\tfor(int i=1;i<=m;i++)\n\n\t{\n\n\t\tint u,v;\n\n\t\tscanf(\"%d%d\",&u,&v);\n\n\t\tu++,v++;\n\n\t\tint r1=find(u),r2=find(v);\n\n\t\tif(r1!=r2)\n\n\t\t{\n\n\t\t\tif(a[use[r2]].w<a[use[r1]].w)\n\n\t\t\t{\n\n\t\t\t\ta[use[r1]].vis=false;\n\n\t\t\t\tuse[r1]=use[r2];\n\n\t\t\t}\n\n\t\t\telse a[use[r2]].vis=false;\n\n\t\t\tfa[r2]=r1;\n\n\t\t}\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tif(find(i)==i) \n\n\t\t{\n\n\t\t\tans+=1ll*a[use[i]].w;\n\n\t\t\tcnt++;\n\n\t\t}\n\n\tif(cnt==1)\n\n\t{\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tsort(a+1,a+n+1,cmp);\n\n\tfor(int i=1;i<=cnt-2;i++)\n\n\t\tif(a[i].vis)\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\telse ans+=1ll*a[i].w;\n\n\tprintf(\"%lld\\n\",ans);\n\n}"
    },
    {
        "id": "219",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn=100005;\n\nconst int inf=0x3f3f3f3f;\n\nint n,m,a[maxn],minid[maxn],mmin[maxn],id[maxn],cc;\n\nlong long res;\n\nvector<int> G[maxn];\n\nvoid dfs(int u,int c) {\n\n    id[u]=c;\n\n    if (a[u]<mmin[c]) {\n\n        mmin[c]=a[u];\n\n        minid[c]=u;\n\n    }\n\n    for (int i=0;i<(int)G[u].size();++i) {\n\n        int v=G[u][i];\n\n        if (id[v]) continue;\n\n        dfs(v,c);\n\n    }\n\n}\n\nint main()\n\n{\n\n    scanf(\"%d%d\",&n,&m);\n\n    for (int i=0;i<n;++i)\n\n        scanf(\"%d\",&a[i]),mmin[i]=inf;\n\n    while (m--) {\n\n        int u,v;\n\n        scanf(\"%d%d\",&u,&v);\n\n        G[u].push_back(v);\n\n        G[v].push_back(u);\n\n    }\n\n    for (int i=0;i<n;++i)\n\n        if (!id[i])\n\n            dfs(i,++cc);\n\n    if (cc==1) return 0*puts(\"0\");\n\n    int point=0;\n\n    for (int i=1;i<=cc;++i)\n\n        res+=a[minid[i]],a[minid[i]]=inf,++point;\n\n    sort(a,a+n);\n\n    for (int i=0;i<n;++i)\n\n        if (a[i]!=inf&&cc+cc-2>point)\n\n            ++point,res+=a[i];\n\n    if (cc+cc-2>point) return 0*puts(\"Impossible\");\n\n    return cout<<res<<endl,0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\n#define maxn 100005\n\n#define LL long long\n\nusing namespace std;\n\nint n,m,fa[maxn],use[maxn],cnt;\n\nLL ans;\n\nstruct node { int w;bool vis; } a[maxn];\n\nbool cmp(node p,node q) \n\n{\n\n\tif(p.vis) return false;\n\n\tif(q.vis) return true;\n\n\treturn p.w<q.w; \n\n}\n\nint find(int x)\n\n{\n\n\tif(fa[x]==x) return x;\n\n\treturn fa[x]=find(fa[x]);\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d\",&a[i].w);\n\n\t\tfa[i]=i;use[i]=i;\n\n\t\ta[i].vis=true;\n\n\t}\n\n\tfor(int i=1;i<=m;i++)\n\n\t{\n\n\t\tint u,v;\n\n\t\tscanf(\"%d%d\",&u,&v);\n\n\t\tu++,v++;\n\n\t\tint r1=find(u),r2=find(v);\n\n\t\tif(r1!=r2)\n\n\t\t{\n\n\t\t\tif(a[use[r2]].w<a[use[r1]].w)\n\n\t\t\t{\n\n\t\t\t\ta[use[r1]].vis=false;\n\n\t\t\t\tuse[r1]=use[r2];\n\n\t\t\t}\n\n\t\t\telse a[use[r2]].vis=false;\n\n\t\t\tfa[r2]=r1;\n\n\t\t}\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tif(find(i)==i) \n\n\t\t{\n\n\t\t\tans+=1ll*a[use[i]].w;\n\n\t\t\tcnt++;\n\n\t\t}\n\n\tif(cnt==1)\n\n\t{\n\n\t\tprintf(\"0\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tsort(a+1,a+n+1,cmp);\n\n\tfor(int i=1;i<=cnt-2;i++)\n\n\t\tif(a[i].vis)\n\n\t\t{\n\n\t\t\tprintf(\"Impossible\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\telse ans+=1ll*a[i].w;\n\n\tprintf(\"%lld\\n\",ans);\n\n}"
    },
    {
        "id": "220",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn=1e5+5;\n\nint n,m;\n\nint fa[maxn];\n\nint find(int x){return (fa[x]==x ? x : fa[x]=find(fa[x]));}\n\nint a[maxn];\n\nvector<int>val[maxn];\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tscanf(\"%d\",&a[i]);\n\n\t\tfa[i]=i;\n\n\t}\n\n\twhile(m--){\n\n\t\tint u,v;\n\n\t\tscanf(\"%d%d\",&u,&v);\n\n\t\tu++;v++;\n\n\t\tfa[find(u)]=find(v);\n\n\t}\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tval[find(i)].push_back(a[i]);\n\n\t}\n\n\tint cnt=0;\n\n\tint pt=0,one=0;\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tsort(val[i].begin(),val[i].end());\n\n\t\tcnt+=(val[i].size()>0);\n\n\t\tif(val[i].size()>1)\n\n\t\t\tpt+=val[i].size()-1;\n\n\t\tif(val[i].size()==1)\n\n\t\t\tone++;\n\n\t}\n\n\tif(cnt==1){\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(one>pt){\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\n\n\tint sel=2*(cnt-1)-cnt;\n\n\tvector<int>num;\n\n\tlong long ans=0;\n\n\n\n\tfor(int i=1;i<=n;i++)if(val[i].size()){\n\n\t\tans+=val[i][0];\n\n\t\tfor(int j=1;j<val[i].size();j++){\n\n\t\t\tnum.push_back(val[i][j]);\n\n\t\t}\n\n\t}\n\n\tsort(num.begin(),num.end());\n\n\tif(num.size()<sel){\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(int i=0;i<sel;i++){\n\n\t\tans+=num[i];\n\n\t}\n\n\n\n\tcout<<ans<<endl;\n\n\n\n\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,m,fa[100005],a[100005],b[100005],t,x,y;\n\nlong long s;\n\ninline int read(){\n\n    int x=0,f=1;char ch=getchar();\n\n    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\n    while(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\n    return x*f;\n\n}\n\nint find(int r){return fa[r]?fa[r]=find(fa[r]):r;}\n\nint main(){\n\n\tn=read(),m=read();\n\n\tif(m==n-1) return 0*puts(\"0\");\n\n\tfor(int i=1;i<=n;++i) a[i]=read(),s+=a[i];\n\n\tfor(int i=1;i<=m;++i){\n\n\t\tx=read(),y=read();\n\n\t\tx=find(x+1),y=find(y+1);\n\n\t\ts-=max(a[x],a[y]);\n\n\t\tb[++t]=max(a[x],a[y]);\n\n\t\tif(a[x]>a[y]) fa[x]=y;else fa[y]=x;\n\n\t}\n\n\tif(t<n-m-2) return 0*puts(\"Impossible\");\n\n\tsort(b+1,b+t+1);\n\n\tfor(int i=1;i<=n-m-2;++i) s+=b[i];\n\n\tprintf(\"%lld\",s);\n\n}"
    },
    {
        "id": "221",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\nusing namespace std;\n\nconst long long MAXN=100005;\n\n\n\nnamespace DSU\n\n{\n\n\tlong long fa[MAXN];\n\n\tvoid Clear()\n\n\t{memset(fa,-1,sizeof fa);}\n\n\tlong long Root(long long x)\n\n\t{return fa[x]==-1?x:(fa[x]=Root(fa[x]));}\n\n\tvoid Union(long long x,long long y)\n\n\t{\n\n\t\tlong long r1=Root(x),r2=Root(y);\n\n\t\tif(r1!=r2)\n\n\t\t\tfa[r1]=r2;\n\n\t}\n\n}\n\n\n\nstruct Vertice\n\n{\n\n\tlong long val,id;\n\n\tVertice(){val=0x3F3F3F3F3F3F3F3FLL;}\n\n\tVertice(long long v,long long i){val=v;id=i;}\n\n\tbool operator < (const Vertice &t)const\n\n\t{return val<t.val;}\n\n};\n\n\n\nVertice V[MAXN],tr[MAXN];\n\nbool used[MAXN];\n\nbool mk[MAXN];\n\n\n\nint main()\n\n{\n\n\tlong long n,m;\n\n\tscanf(\"%lld%lld\",&n,&m);\n\n\tfor(long long i=0,a;i<n;i++)\n\n\t{\n\n\t\tscanf(\"%lld\",&a);\n\n\t\tV[i]=Vertice(a,i);\n\n\t}\n\n\tDSU::Clear();\n\n\tfor(long long i=0,u,v;i<m;i++)\n\n\t{\n\n\t\tscanf(\"%lld%lld\",&u,&v);\n\n\t\tDSU::Union(u,v);\n\n\t}\n\n\tint cc=0;\n\n\tfor(int i=0;i<n;i++)\n\n\t\tif(!mk[DSU::Root(i)])\n\n\t\t{\n\n\t\t\tmk[DSU::Root(i)]=true;\n\n\t\t\tcc++;\n\n\t\t}\n\n\tif(cc==1)\n\n\t{\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(2*cc-2>n)\n\n\t{\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(long long i=0;i<n;i++)\n\n\t{\n\n\t\tint r=DSU::Root(i);\n\n\t\ttr[r]=min(tr[r],V[i]);\n\n\t}\n\n\tlong long ans=0,cnt=2*cc-2;\n\n\tfor(long long i=0;i<n&&cnt;i++)\n\n\t{\n\n\t\tint r=DSU::Root(i);\n\n\t\tif(!used[tr[r].id])\n\n\t\t{\n\n\t\t\tans+=tr[r].val;\n\n\t\t\tused[tr[r].id]=true;\n\n\t\t\tcnt--;\n\n\t\t}\n\n\t}\n\n\tsort(V,V+n);\n\n\tfor(long long i=0;i<n&&cnt;i++)\n\n\t\tif(!used[V[i].id])\n\n\t\t{\n\n\t\t\tans+=V[i].val;\n\n\t\t\tcnt--;\n\n\t\t}\n\n\t\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,m,fa[100005],a[100005],b[100005],t,x,y;\n\nlong long s;\n\ninline int read(){\n\n    int x=0,f=1;char ch=getchar();\n\n    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\n    while(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\n    return x*f;\n\n}\n\nint find(int r){return fa[r]?fa[r]=find(fa[r]):r;}\n\nint main(){\n\n\tn=read(),m=read();\n\n\tif(m==n-1) return 0*puts(\"0\");\n\n\tfor(int i=1;i<=n;++i) a[i]=read(),s+=a[i];\n\n\tfor(int i=1;i<=m;++i){\n\n\t\tx=read(),y=read();\n\n\t\tx=find(x+1),y=find(y+1);\n\n\t\ts-=max(a[x],a[y]);\n\n\t\tb[++t]=max(a[x],a[y]);\n\n\t\tif(a[x]>a[y]) fa[x]=y;else fa[y]=x;\n\n\t}\n\n\tif(t<n-m-2) return 0*puts(\"Impossible\");\n\n\tsort(b+1,b+t+1);\n\n\tfor(int i=1;i<=n-m-2;++i) s+=b[i];\n\n\tprintf(\"%lld\",s);\n\n}"
    },
    {
        "id": "222",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn=100005;\n\nconst int inf=0x3f3f3f3f;\n\nint n,m,a[maxn],minid[maxn],mmin[maxn],id[maxn],cc;\n\nlong long res;\n\nvector<int> G[maxn];\n\nvoid dfs(int u,int c) {\n\n    id[u]=c;\n\n    if (a[u]<mmin[c]) {\n\n        mmin[c]=a[u];\n\n        minid[c]=u;\n\n    }\n\n    for (int i=0;i<(int)G[u].size();++i) {\n\n        int v=G[u][i];\n\n        if (id[v]) continue;\n\n        dfs(v,c);\n\n    }\n\n}\n\nint main()\n\n{\n\n    scanf(\"%d%d\",&n,&m);\n\n    for (int i=0;i<n;++i)\n\n        scanf(\"%d\",&a[i]),mmin[i]=inf;\n\n    while (m--) {\n\n        int u,v;\n\n        scanf(\"%d%d\",&u,&v);\n\n        G[u].push_back(v);\n\n        G[v].push_back(u);\n\n    }\n\n    for (int i=0;i<n;++i)\n\n        if (!id[i])\n\n            dfs(i,++cc);\n\n    if (cc==1) return 0*puts(\"0\");\n\n    int point=0;\n\n    for (int i=1;i<=cc;++i)\n\n        res+=a[minid[i]],a[minid[i]]=inf,++point;\n\n    sort(a,a+n);\n\n    for (int i=0;i<n;++i)\n\n        if (a[i]!=inf&&cc+cc-2>point)\n\n            ++point,res+=a[i];\n\n    if (cc+cc-2>point) return 0*puts(\"Impossible\");\n\n    return cout<<res<<endl,0;\n\n}\n",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,m,fa[100005],a[100005],b[100005],t,x,y;\n\nlong long s;\n\ninline int read(){\n\n    int x=0,f=1;char ch=getchar();\n\n    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\n    while(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\n    return x*f;\n\n}\n\nint find(int r){return fa[r]?fa[r]=find(fa[r]):r;}\n\nint main(){\n\n\tn=read(),m=read();\n\n\tif(m==n-1) return 0*puts(\"0\");\n\n\tfor(int i=1;i<=n;++i) a[i]=read(),s+=a[i];\n\n\tfor(int i=1;i<=m;++i){\n\n\t\tx=read(),y=read();\n\n\t\tx=find(x+1),y=find(y+1);\n\n\t\ts-=max(a[x],a[y]);\n\n\t\tb[++t]=max(a[x],a[y]);\n\n\t\tif(a[x]>a[y]) fa[x]=y;else fa[y]=x;\n\n\t}\n\n\tif(t<n-m-2) return 0*puts(\"Impossible\");\n\n\tsort(b+1,b+t+1);\n\n\tfor(int i=1;i<=n-m-2;++i) s+=b[i];\n\n\tprintf(\"%lld\",s);\n\n}"
    },
    {
        "id": "223",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\nusing namespace std;\n\nconst long long MAXN=100005;\n\n\n\nnamespace DSU\n\n{\n\n\tlong long fa[MAXN];\n\n\tvoid Clear()\n\n\t{memset(fa,-1,sizeof fa);}\n\n\tlong long Root(long long x)\n\n\t{return fa[x]==-1?x:(fa[x]=Root(fa[x]));}\n\n\tvoid Union(long long x,long long y)\n\n\t{\n\n\t\tlong long r1=Root(x),r2=Root(y);\n\n\t\tif(r1!=r2)\n\n\t\t\tfa[r1]=r2;\n\n\t}\n\n}\n\n\n\nstruct Vertice\n\n{\n\n\tlong long val,id;\n\n\tVertice(){val=0x3F3F3F3F3F3F3F3FLL;}\n\n\tVertice(long long v,long long i){val=v;id=i;}\n\n\tbool operator < (const Vertice &t)const\n\n\t{return val<t.val;}\n\n};\n\n\n\nVertice V[MAXN],tr[MAXN];\n\nbool used[MAXN];\n\nbool mk[MAXN];\n\n\n\nint main()\n\n{\n\n\tlong long n,m;\n\n\tscanf(\"%lld%lld\",&n,&m);\n\n\tfor(long long i=0,a;i<n;i++)\n\n\t{\n\n\t\tscanf(\"%lld\",&a);\n\n\t\tV[i]=Vertice(a,i);\n\n\t}\n\n\tDSU::Clear();\n\n\tfor(long long i=0,u,v;i<m;i++)\n\n\t{\n\n\t\tscanf(\"%lld%lld\",&u,&v);\n\n\t\tDSU::Union(u,v);\n\n\t}\n\n\tint cc=0;\n\n\tfor(int i=0;i<n;i++)\n\n\t\tif(!mk[DSU::Root(i)])\n\n\t\t{\n\n\t\t\tmk[DSU::Root(i)]=true;\n\n\t\t\tcc++;\n\n\t\t}\n\n\tif(cc==1)\n\n\t{\n\n\t\tputs(\"0\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(2*cc-2>n)\n\n\t{\n\n\t\tputs(\"Impossible\");\n\n\t\treturn 0;\n\n\t}\n\n\tfor(long long i=0;i<n;i++)\n\n\t{\n\n\t\tint r=DSU::Root(i);\n\n\t\ttr[r]=min(tr[r],V[i]);\n\n\t}\n\n\tlong long ans=0,cnt=2*cc-2;\n\n\tfor(long long i=0;i<n&&cnt;i++)\n\n\t{\n\n\t\tint r=DSU::Root(i);\n\n\t\tif(!used[tr[r].id])\n\n\t\t{\n\n\t\t\tans+=tr[r].val;\n\n\t\t\tused[tr[r].id]=true;\n\n\t\t\tcnt--;\n\n\t\t}\n\n\t}\n\n\tsort(V,V+n);\n\n\tfor(long long i=0;i<n&&cnt;i++)\n\n\t\tif(!used[V[i].id])\n\n\t\t{\n\n\t\t\tans+=V[i].val;\n\n\t\t\tcnt--;\n\n\t\t}\n\n\t\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nconst int MAXN = 1e5 + 10;\n\n\n\nbool vis[MAXN];\n\nint n, m, k;\n\nint u, v;\n\nint a[MAXN];\n\nlong long ans;\n\nvector<int> adj[MAXN];\n\nvector<int> ret;\n\nvector<vector<int>> b;\n\n \n\nvoid dfs(int x, vector<int>& k) {\n\n\tk.push_back(a[x]);\n\n\tvis[x] = true;\n\n\tfor (int u: adj[x]) \n\n\t\tif (!vis[u]) \n\n\t\t\tdfs(u, k);\n\n}\n\n \n\nint main() {\n\n\tios_base::sync_with_stdio(false), cin.tie(0), cout.tie(0);\n\n\t///////////////////////////////////////////////////////////\n\n\tcin >> n >> m;\n\n\tfor (int i = 1; i <= n; i++)\n\n\t\tcin >> a[i];\n\n\tfor (int i = 1; i <= m; i++) {\n\n\t\tcin >> u >> v;\n\n\t\tu++;\n\n\t\tv++;\n\n\t\tadj[u].push_back(v);\n\n\t\tadj[v].push_back(u);\n\n\t}\n\n\t/////////////////////////////////////////////////////////////\n\n\tfor (int i = 1; i <= n; i++) {\n\n\t\tif (!vis[i]) {\n\n\t\t\tdfs(i, ret);\n\n\t\t\tb.push_back(ret);\n\n\t\t\tret.clear();\n\n\t\t}\n\n\t}\n\n\tk = b.size();\n\n \n\n\tif (n < 2 * k - 2)\n\n\t\treturn cout << \"Impossible\" << '\\n', 0;\n\n\n\n\tif (k == 1)\n\n\t\treturn cout << 0 << '\\n', 0;\n\n\t\t\n\n\tvector<int> res;\n\n\tfor (auto v: b) {\n\n\t\tsort(v.rbegin(), v.rend());\n\n\t\tans += v.back();\n\n\t\tv.pop_back();\n\n\t\tcopy(v.begin(), v.end(), back_inserter(res));\n\n\t}\n\n\t\n\n\tsort(res.begin(), res.end());\n\n\tans = accumulate(res.begin(), res.begin() + k - 2, ans);\n\n\tcout << ans << '\\n';\n\n\treturn 0;\n\n}"
    },
    {
        "id": "224",
        "source_code": "#include <iostream>\n\n#include <vector>\n\n#include <algorithm>\n\nusing namespace std;\n\n\n\nconst int N = 100 * 1000 + 5;\n\nint nparts = 0;\n\n\n\nint a[N];\n\nvector <int> adj[N];\n\nint part[N];\n\nvector <int> vec[N];\n\nvector <int> rm;\n\n\n\nvoid dfs(int v) {\n\n\tfor (auto u : adj[v]) {\n\n\t\tif (!part[u]) {\n\n\t\t\tpart[u] = part[v];\n\n\t\t\tdfs(u);\n\n\t\t}\n\n\t}\n\n}\n\nint main() {\n\n\tlong long ans = 0;\n\n\tint n, m;\n\n\tcin >> n >> m;\n\n\tfor (int i = 0; i < n; i++) {\n\n\t\tcin >> a[i];\n\n\t}\n\n\tfor (int i = 0; i < m; i++) {\n\n\t\tint u, v;\n\n\t\tcin >> u >> v;\n\n\t\tadj[u].push_back(v);\n\n\t\tadj[v].push_back(u);\n\n\t}\n\n\tif (m == n - 1) {\n\n\t\tcout << 0 << endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor (int i = 0; i < n; i++) {\n\n\t\tif (!part[i]) {\n\n\t\t\tnparts++;\n\n\t\t\tpart[i] = nparts;\n\n\t\t\tdfs(i);\n\n\t\t}\n\n\t}\n\n\tfor (int i = 0; i < n; i++) {\n\n\t\tvec[part[i]].push_back(a[i]);\n\n\t}\n\n\tfor (int i = 1; i <= nparts; i++) {\n\n\t\tsort(vec[i].begin(), vec[i].end());\n\n\t\tans += vec[i][0];\n\n\t\tfor (int j = 1; j < vec[i].size(); j++) {\n\n\t\t\trm.push_back(vec[i][j]);\n\n\t\t}\n\n\t}\n\n\tsort(rm.begin(), rm.end());\n\n//\tcout << nparts << endl;\n\n\tif (2 * (nparts - 1) > n) {\n\n\t\tcout << \"Impossible\" << endl;\n\n\t}\n\n\telse {\n\n\t\tfor (int i = 0; i < nparts - 2; i++) {\n\n\t\t\tans += rm[i];\n\n\t\t}\n\n\t\tcout << ans << endl;\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nconst int MAXN = 1e5 + 10;\n\n\n\nbool vis[MAXN];\n\nint n, m, k;\n\nint u, v;\n\nint a[MAXN];\n\nlong long ans;\n\nvector<int> adj[MAXN];\n\nvector<int> ret;\n\nvector<vector<int>> b;\n\n \n\nvoid dfs(int x, vector<int>& k) {\n\n\tk.push_back(a[x]);\n\n\tvis[x] = true;\n\n\tfor (int u: adj[x]) \n\n\t\tif (!vis[u]) \n\n\t\t\tdfs(u, k);\n\n}\n\n \n\nint main() {\n\n\tios_base::sync_with_stdio(false), cin.tie(0), cout.tie(0);\n\n\t///////////////////////////////////////////////////////////\n\n\tcin >> n >> m;\n\n\tfor (int i = 1; i <= n; i++)\n\n\t\tcin >> a[i];\n\n\tfor (int i = 1; i <= m; i++) {\n\n\t\tcin >> u >> v;\n\n\t\tu++;\n\n\t\tv++;\n\n\t\tadj[u].push_back(v);\n\n\t\tadj[v].push_back(u);\n\n\t}\n\n\t/////////////////////////////////////////////////////////////\n\n\tfor (int i = 1; i <= n; i++) {\n\n\t\tif (!vis[i]) {\n\n\t\t\tdfs(i, ret);\n\n\t\t\tb.push_back(ret);\n\n\t\t\tret.clear();\n\n\t\t}\n\n\t}\n\n\tk = b.size();\n\n \n\n\tif (n < 2 * k - 2)\n\n\t\treturn cout << \"Impossible\" << '\\n', 0;\n\n\n\n\tif (k == 1)\n\n\t\treturn cout << 0 << '\\n', 0;\n\n\t\t\n\n\tvector<int> res;\n\n\tfor (auto v: b) {\n\n\t\tsort(v.rbegin(), v.rend());\n\n\t\tans += v.back();\n\n\t\tv.pop_back();\n\n\t\tcopy(v.begin(), v.end(), back_inserter(res));\n\n\t}\n\n\t\n\n\tsort(res.begin(), res.end());\n\n\tans = accumulate(res.begin(), res.begin() + k - 2, ans);\n\n\tcout << ans << '\\n';\n\n\treturn 0;\n\n}"
    },
    {
        "id": "225",
        "source_code": "//#include<bits/stdc++.h>\n\n#include<iostream>\n\n#include<vector>\n\n#include<algorithm>\n\n#include<cmath>\n\n#include<set>\n\n#include<queue>\n\n#include<deque>\n\n#include<map>\n\n#include<stack>\n\n#include<bitset>\n\n#include<list>\n\n#include<cassert>\n\n#include<numeric>\n\n#include<iomanip>\n\n\n\nusing namespace std;\n\n \n\nconst long long N = 1e5 + 5;\n\n\n\nlong long cnt = 0;\n\nlong long ans = 0;\n\nlong long n, m; \n\nlong long a[N];\n\nvector <long long> graph[N];\n\nvector <long long> other;\n\nvector <long long> component[N];\n\nlong long comp[N];\n\nbool mark[N];\n\n \n\nvoid dfs(long long v, long long cnt) \n\n{\n\n\tcomp[v] = cnt;\n\n\tmark[v] = true;\n\n\tfor (long long i = 0; i < graph[v].size(); i++)\n\n\t{\n\n\t\tlong long u = graph[v][i];\n\n\t\tif (!mark[u])\n\n\t\t{\n\n\t\t\tdfs(u, cnt);\n\n\t\t}\n\n\t}\n\n}\n\n\n\nint main() \n\n{\n\n\tcin >> n >> m;\n\n\tfor (long long i = 0; i < n; i++) \n\n\t{\n\n\t\tcin >> a[i];\n\n\t}\n\n\tfor (long long i = 0; i < m; i++) \n\n\t{\n\n\t\tlong long u, v;\n\n\t\tcin >> u >> v;\n\n\t\tgraph[u].push_back(v);\n\n\t\tgraph[v].push_back(u);\n\n\t}\n\n\tif (m == n - 1) \n\n\t{\n\n\t\tcout << 0 << endl;\n\n\t\texit(0);\n\n\t}\n\n\tfor (long long i = 0; i < n; i++) \n\n\t{\n\n\t\tif (!mark[i]) \n\n\t\t{\n\n\t\t\tcnt++;\n\n\t\t\tdfs(i, cnt);\n\n\t\t}\n\n\t}\n\n\tfor (long long i = 0; i < n; i++) \n\n\t{\n\n\t\tcomponent[comp[i]].push_back(a[i]);\n\n\t}\n\n\tfor (long long i = 1; i <= cnt; i++)\n\n\t{\n\n\t\tsort(component[i].begin(), component[i].end());\n\n\t}\n\n\tfor (long long i = 1; i <= cnt; i++) \n\n\t{\n\n\t\tans += component[i][0];\n\n\t\tfor (long long j = 1; j < component[i].size(); j++) \n\n\t\t{\n\n\t\t\tother.push_back(component[i][j]);\n\n\t\t}\n\n\t}\n\n\tsort(other.begin(), other.end());\n\n\tif (2 * (cnt - 1) > n) \n\n\t{\n\n\t\tcout << \"Impossible\" << endl;\n\n\t\texit(0);\n\n\t}\n\n\tfor (long long i = 0; i < cnt - 2; i++) \n\n\t{\n\n\t\tans += other[i];\n\n\t}\n\n\tcout << ans << endl;\n\n}\n\n\t\n\n            \n\n\n\n\n\n \n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nconst int MAXN = 1e5 + 10;\n\n\n\nbool vis[MAXN];\n\nint n, m, k;\n\nint u, v;\n\nint a[MAXN];\n\nlong long ans;\n\nvector<int> adj[MAXN];\n\nvector<int> ret;\n\nvector<vector<int>> b;\n\n \n\nvoid dfs(int x, vector<int>& k) {\n\n\tk.push_back(a[x]);\n\n\tvis[x] = true;\n\n\tfor (int u: adj[x]) \n\n\t\tif (!vis[u]) \n\n\t\t\tdfs(u, k);\n\n}\n\n \n\nint main() {\n\n\tios_base::sync_with_stdio(false), cin.tie(0), cout.tie(0);\n\n\t///////////////////////////////////////////////////////////\n\n\tcin >> n >> m;\n\n\tfor (int i = 1; i <= n; i++)\n\n\t\tcin >> a[i];\n\n\tfor (int i = 1; i <= m; i++) {\n\n\t\tcin >> u >> v;\n\n\t\tu++;\n\n\t\tv++;\n\n\t\tadj[u].push_back(v);\n\n\t\tadj[v].push_back(u);\n\n\t}\n\n\t/////////////////////////////////////////////////////////////\n\n\tfor (int i = 1; i <= n; i++) {\n\n\t\tif (!vis[i]) {\n\n\t\t\tdfs(i, ret);\n\n\t\t\tb.push_back(ret);\n\n\t\t\tret.clear();\n\n\t\t}\n\n\t}\n\n\tk = b.size();\n\n \n\n\tif (n < 2 * k - 2)\n\n\t\treturn cout << \"Impossible\" << '\\n', 0;\n\n\n\n\tif (k == 1)\n\n\t\treturn cout << 0 << '\\n', 0;\n\n\t\t\n\n\tvector<int> res;\n\n\tfor (auto v: b) {\n\n\t\tsort(v.rbegin(), v.rend());\n\n\t\tans += v.back();\n\n\t\tv.pop_back();\n\n\t\tcopy(v.begin(), v.end(), back_inserter(res));\n\n\t}\n\n\t\n\n\tsort(res.begin(), res.end());\n\n\tans = accumulate(res.begin(), res.begin() + k - 2, ans);\n\n\tcout << ans << '\\n';\n\n\treturn 0;\n\n}"
    },
    {
        "id": "226",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#define fs first\n\n#define sc second\n\nusing namespace std;\n\nconst int maxn = 1e5+10;\n\nusing pii = pair<int,int>;\n\n\n\nint N;\n\nint main(){\n\n    cin>>N;\n\n    cout<<(N+2-1)/2<<endl;\n\n\n\n\n\n    return 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n{\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\t\n\n\t\n\n\tif(N%2==0)\n\n\t{\n\n\t\tprintf(\"%d\", N/2);\n\n\t}\t\n\n\telse if(N%2!=0)\n\n\t{\n\n\t\tprintf(\"%d\", N/2 + 1);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "228",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#define fs first\n\n#define sc second\n\nusing namespace std;\n\nconst int maxn = 1e5+10;\n\nusing pii = pair<int,int>;\n\n\n\nint N;\n\nint main(){\n\n    cin>>N;\n\n    cout<<(N+2-1)/2<<endl;\n\n\n\n\n\n    return 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\tint pages;\n\n\tscanf(\"%d\", &pages);\n\n\t(pages % 2 == 0) ? printf(\"%d\", pages / 2) : printf(\"%d\", pages / 2 + 1);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "230",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#define fs first\n\n#define sc second\n\nusing namespace std;\n\nconst int maxn = 1e5+10;\n\nusing pii = pair<int,int>;\n\n\n\nint N;\n\nint main(){\n\n    cin>>N;\n\n    cout<<(N+2-1)/2<<endl;\n\n\n\n\n\n    return 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n \n\nint main()\n\n{\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\t\n\n\t\n\n\tif(N%2==0)\n\n\t{\n\n\t\tprintf(\"%d\", N/2);\n\n\t}\t\n\n\tif(N%2!=0)\n\n\t{\n\n\t\tprintf(\"%d\", N/2 + 1);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "232",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#define fs first\n\n#define sc second\n\nusing namespace std;\n\nconst int maxn = 1e5+10;\n\nusing pii = pair<int,int>;\n\n\n\nint N;\n\nint main(){\n\n    cin>>N;\n\n    cout<<(N+2-1)/2<<endl;\n\n\n\n\n\n    return 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n    int a;\n\n    scanf(\"%d\", &a);\n\n    int b =(a%2==0) ? (a/2) : ((a/2)+1);\n\n    printf(\"%d\\n\", b);\n\n    \n\n    return 0;\n\n}"
    },
    {
        "id": "234",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#define fs first\n\n#define sc second\n\nusing namespace std;\n\nconst int maxn = 1e5+10;\n\nusing pii = pair<int,int>;\n\n\n\nint N;\n\nint main(){\n\n    cin>>N;\n\n    cout<<(N+2-1)/2<<endl;\n\n\n\n\n\n    return 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint N;\n\n\tint X;\n\n\tscanf(\"%d\",&N);\n\n\tX= N/2;\n\n\tif(N%2==0)\n\n\t{\n\n\t\tprintf(\"%d\",X);\n\n\t}\n\n\telse if(N%2!=0)\n\n\t{\n\n\t\tprintf(\"%d\",++X);\n\n\t}\n\n\t\n\n\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "236",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#define fs first\n\n#define sc second\n\nusing namespace std;\n\nconst int maxn = 1e5+10;\n\nusing pii = pair<int,int>;\n\n\n\nint N;\n\nint main(){\n\n    cin>>N;\n\n    cout<<(N+2-1)/2<<endl;\n\n\n\n\n\n    return 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main (){\n\n\t\n\n\tint n,i;\n\n\t\n\n\tscanf(\"%d\",&n);\n\n\t\n\n\tif(n%2==0){\n\n\t\tprintf(\"%d\\n\",n/2);\n\n\t}else{\n\n\t\tprintf(\"%d\\n\",(n/2)+1);\n\n\t}\n\nreturn 0;\n\n}\n"
    },
    {
        "id": "238",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#define fs first\n\n#define sc second\n\nusing namespace std;\n\nconst int maxn = 1e5+10;\n\nusing pii = pair<int,int>;\n\n\n\nint N;\n\nint main(){\n\n    cin>>N;\n\n    cout<<(N+2-1)/2<<endl;\n\n\n\n\n\n    return 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint A;\n\n\tint B = 2; \n\n\tscanf(\"%d\", &A);\n\n\t\n\n\tif(A % B == 0) {\n\n\tprintf(\"%d\\n\", A/B);\n\n\t}\n\n\t\n\n\telse\n\n\tprintf(\"%d\\n\", (A/B)+1);\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "240",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    int n; cin>> n;\n\n    cout<< (n + 1) / 2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\tint a;\n\n\tscanf(\"%d\", &a);\n\n\t(a%2 == 0)? printf(\"%d\", a/2) : printf(\"%d\", a/2 + 1);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "241",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std ;\n\n\n\nint main(){\n\n\tlong long a;\n\n\tcin>>a;\n\n\tcout<<(a+1)/2<<endl;\n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\tint a;\n\n\tscanf(\"%d\", &a);\n\n\t(a%2 == 0)? printf(\"%d\", a/2) : printf(\"%d\", a/2 + 1);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "242",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t   n/=2;\n\n\telse\n\n\t   n=n/2+1;\n\n\tcout<<n<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\tint a;\n\n\tscanf(\"%d\", &a);\n\n\t(a%2 == 0)? printf(\"%d\", a/2) : printf(\"%d\", a/2 + 1);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "243",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tcin>>n;\n\n\tint m=(n+1)/2;\n\n\tcout<<m<<endl;\n\n    return 0; \n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\tint a;\n\n\tscanf(\"%d\", &a);\n\n\t(a%2 == 0)? printf(\"%d\", a/2) : printf(\"%d\", a/2 + 1);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "244",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define ll long long\n\nconst int N = 300005;\n\n\n\nint n;\n\n\n\nint main()\n\n{\n\n\n\ncin >> n ;\n\ncout << n/2 + n%2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\tint a;\n\n\tscanf(\"%d\", &a);\n\n\t(a%2 == 0)? printf(\"%d\", a/2) : printf(\"%d\", a/2 + 1);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "245",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    int n; cin>> n;\n\n    cout<< (n + 1) / 2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n\n\n{\n\n\tint n;\n\n\tscanf(\"%d\", &n);\n\n\t\n\n\tif(n % 2 == 0)\n\n\t{\n\n\t\tprintf(\"%d\", n/2);\n\n\t}\n\n\telse if(n % 2 != 0)\n\n\t{\n\n\t\tprintf(\"%d\", n/2 +1);\n\n\t}\n\n\t return 0;\n\n\n\n}"
    },
    {
        "id": "246",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std ;\n\n\n\nint main(){\n\n\tlong long a;\n\n\tcin>>a;\n\n\tcout<<(a+1)/2<<endl;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n\n\n{\n\n\tint n;\n\n\tscanf(\"%d\", &n);\n\n\t\n\n\tif(n % 2 == 0)\n\n\t{\n\n\t\tprintf(\"%d\", n/2);\n\n\t}\n\n\telse if(n % 2 != 0)\n\n\t{\n\n\t\tprintf(\"%d\", n/2 +1);\n\n\t}\n\n\t return 0;\n\n\n\n}"
    },
    {
        "id": "247",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t   n/=2;\n\n\telse\n\n\t   n=n/2+1;\n\n\tcout<<n<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n\n\n{\n\n\tint n;\n\n\tscanf(\"%d\", &n);\n\n\t\n\n\tif(n % 2 == 0)\n\n\t{\n\n\t\tprintf(\"%d\", n/2);\n\n\t}\n\n\telse if(n % 2 != 0)\n\n\t{\n\n\t\tprintf(\"%d\", n/2 +1);\n\n\t}\n\n\t return 0;\n\n\n\n}"
    },
    {
        "id": "248",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tcin>>n;\n\n\tint m=(n+1)/2;\n\n\tcout<<m<<endl;\n\n    return 0; \n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n\n\n{\n\n\tint n;\n\n\tscanf(\"%d\", &n);\n\n\t\n\n\tif(n % 2 == 0)\n\n\t{\n\n\t\tprintf(\"%d\", n/2);\n\n\t}\n\n\telse if(n % 2 != 0)\n\n\t{\n\n\t\tprintf(\"%d\", n/2 +1);\n\n\t}\n\n\t return 0;\n\n\n\n}"
    },
    {
        "id": "249",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define ll long long\n\nconst int N = 300005;\n\n\n\nint n;\n\n\n\nint main()\n\n{\n\n\n\ncin >> n ;\n\ncout << n/2 + n%2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n\n\n{\n\n\tint n;\n\n\tscanf(\"%d\", &n);\n\n\t\n\n\tif(n % 2 == 0)\n\n\t{\n\n\t\tprintf(\"%d\", n/2);\n\n\t}\n\n\telse if(n % 2 != 0)\n\n\t{\n\n\t\tprintf(\"%d\", n/2 +1);\n\n\t}\n\n\t return 0;\n\n\n\n}"
    },
    {
        "id": "250",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    int n; cin>> n;\n\n    cout<< (n + 1) / 2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n int N;\n\n scanf(\"%d\", &N);\n\n \n\n if(N%2==0){\n\n  printf(\"%d\", N/2);\n\n }else{\n\n  printf(\"%d\",N/2+1);\n\n }\n\n return 0;\n\n}"
    },
    {
        "id": "251",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std ;\n\n\n\nint main(){\n\n\tlong long a;\n\n\tcin>>a;\n\n\tcout<<(a+1)/2<<endl;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n int N;\n\n scanf(\"%d\", &N);\n\n \n\n if(N%2==0){\n\n  printf(\"%d\", N/2);\n\n }else{\n\n  printf(\"%d\",N/2+1);\n\n }\n\n return 0;\n\n}"
    },
    {
        "id": "252",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t   n/=2;\n\n\telse\n\n\t   n=n/2+1;\n\n\tcout<<n<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n int N;\n\n scanf(\"%d\", &N);\n\n \n\n if(N%2==0){\n\n  printf(\"%d\", N/2);\n\n }else{\n\n  printf(\"%d\",N/2+1);\n\n }\n\n return 0;\n\n}"
    },
    {
        "id": "253",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tcin>>n;\n\n\tint m=(n+1)/2;\n\n\tcout<<m<<endl;\n\n    return 0; \n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n int N;\n\n scanf(\"%d\", &N);\n\n \n\n if(N%2==0){\n\n  printf(\"%d\", N/2);\n\n }else{\n\n  printf(\"%d\",N/2+1);\n\n }\n\n return 0;\n\n}"
    },
    {
        "id": "254",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define ll long long\n\nconst int N = 300005;\n\n\n\nint n;\n\n\n\nint main()\n\n{\n\n\n\ncin >> n ;\n\ncout << n/2 + n%2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n int N;\n\n scanf(\"%d\", &N);\n\n \n\n if(N%2==0){\n\n  printf(\"%d\", N/2);\n\n }else{\n\n  printf(\"%d\",N/2+1);\n\n }\n\n return 0;\n\n}"
    },
    {
        "id": "255",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    int n; cin>> n;\n\n    cout<< (n + 1) / 2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint N;\n\n\tint x=2;\n\n\t\tscanf(\"%d\",&N);\n\n\t\t\tif(N%x==0){\n\n\t\t\t\tprintf(\"%d\\n\",N/2);\n\n\t\t\t}\n\n\t        else{\n\n\t        \tprintf(\"%d\\n\",(N/2)+1);\n\n\t\t\t}\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "256",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std ;\n\n\n\nint main(){\n\n\tlong long a;\n\n\tcin>>a;\n\n\tcout<<(a+1)/2<<endl;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint N;\n\n\tint x=2;\n\n\t\tscanf(\"%d\",&N);\n\n\t\t\tif(N%x==0){\n\n\t\t\t\tprintf(\"%d\\n\",N/2);\n\n\t\t\t}\n\n\t        else{\n\n\t        \tprintf(\"%d\\n\",(N/2)+1);\n\n\t\t\t}\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "257",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t   n/=2;\n\n\telse\n\n\t   n=n/2+1;\n\n\tcout<<n<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint N;\n\n\tint x=2;\n\n\t\tscanf(\"%d\",&N);\n\n\t\t\tif(N%x==0){\n\n\t\t\t\tprintf(\"%d\\n\",N/2);\n\n\t\t\t}\n\n\t        else{\n\n\t        \tprintf(\"%d\\n\",(N/2)+1);\n\n\t\t\t}\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "258",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tcin>>n;\n\n\tint m=(n+1)/2;\n\n\tcout<<m<<endl;\n\n    return 0; \n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint N;\n\n\tint x=2;\n\n\t\tscanf(\"%d\",&N);\n\n\t\t\tif(N%x==0){\n\n\t\t\t\tprintf(\"%d\\n\",N/2);\n\n\t\t\t}\n\n\t        else{\n\n\t        \tprintf(\"%d\\n\",(N/2)+1);\n\n\t\t\t}\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "259",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define ll long long\n\nconst int N = 300005;\n\n\n\nint n;\n\n\n\nint main()\n\n{\n\n\n\ncin >> n ;\n\ncout << n/2 + n%2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint N;\n\n\tint x=2;\n\n\t\tscanf(\"%d\",&N);\n\n\t\t\tif(N%x==0){\n\n\t\t\t\tprintf(\"%d\\n\",N/2);\n\n\t\t\t}\n\n\t        else{\n\n\t        \tprintf(\"%d\\n\",(N/2)+1);\n\n\t\t\t}\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "260",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    int n; cin>> n;\n\n    cout<< (n + 1) / 2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n\n\n{\n\n\tint N;\n\n\tscanf(\"%d\",&N);\n\n\tint sheet = (N % 2 ==0)? (N / 2) : (N / 2 + 1);\n\n\tprintf(\"%d\\n\", sheet);\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "261",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std ;\n\n\n\nint main(){\n\n\tlong long a;\n\n\tcin>>a;\n\n\tcout<<(a+1)/2<<endl;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n\n\n{\n\n\tint N;\n\n\tscanf(\"%d\",&N);\n\n\tint sheet = (N % 2 ==0)? (N / 2) : (N / 2 + 1);\n\n\tprintf(\"%d\\n\", sheet);\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "262",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t   n/=2;\n\n\telse\n\n\t   n=n/2+1;\n\n\tcout<<n<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n\n\n{\n\n\tint N;\n\n\tscanf(\"%d\",&N);\n\n\tint sheet = (N % 2 ==0)? (N / 2) : (N / 2 + 1);\n\n\tprintf(\"%d\\n\", sheet);\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "263",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tcin>>n;\n\n\tint m=(n+1)/2;\n\n\tcout<<m<<endl;\n\n    return 0; \n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n\n\n{\n\n\tint N;\n\n\tscanf(\"%d\",&N);\n\n\tint sheet = (N % 2 ==0)? (N / 2) : (N / 2 + 1);\n\n\tprintf(\"%d\\n\", sheet);\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "264",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define ll long long\n\nconst int N = 300005;\n\n\n\nint n;\n\n\n\nint main()\n\n{\n\n\n\ncin >> n ;\n\ncout << n/2 + n%2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n\n\n{\n\n\tint N;\n\n\tscanf(\"%d\",&N);\n\n\tint sheet = (N % 2 ==0)? (N / 2) : (N / 2 + 1);\n\n\tprintf(\"%d\\n\", sheet);\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "265",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    int n; cin>> n;\n\n    cout<< (n + 1) / 2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\", &n);\n\n\tif (n%2==1){\n\n\t\tprintf(\"%d\", n/2+1);\n\n\t}\n\n\telse if(n%2==0){\n\n\t\tprintf(\"%d\", n/2);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "266",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std ;\n\n\n\nint main(){\n\n\tlong long a;\n\n\tcin>>a;\n\n\tcout<<(a+1)/2<<endl;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\", &n);\n\n\tif (n%2==1){\n\n\t\tprintf(\"%d\", n/2+1);\n\n\t}\n\n\telse if(n%2==0){\n\n\t\tprintf(\"%d\", n/2);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "267",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t   n/=2;\n\n\telse\n\n\t   n=n/2+1;\n\n\tcout<<n<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\", &n);\n\n\tif (n%2==1){\n\n\t\tprintf(\"%d\", n/2+1);\n\n\t}\n\n\telse if(n%2==0){\n\n\t\tprintf(\"%d\", n/2);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "268",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tcin>>n;\n\n\tint m=(n+1)/2;\n\n\tcout<<m<<endl;\n\n    return 0; \n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\", &n);\n\n\tif (n%2==1){\n\n\t\tprintf(\"%d\", n/2+1);\n\n\t}\n\n\telse if(n%2==0){\n\n\t\tprintf(\"%d\", n/2);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "269",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define ll long long\n\nconst int N = 300005;\n\n\n\nint n;\n\n\n\nint main()\n\n{\n\n\n\ncin >> n ;\n\ncout << n/2 + n%2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\", &n);\n\n\tif (n%2==1){\n\n\t\tprintf(\"%d\", n/2+1);\n\n\t}\n\n\telse if(n%2==0){\n\n\t\tprintf(\"%d\", n/2);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "270",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    int n; cin>> n;\n\n    cout<< (n + 1) / 2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint N; \n\n\tint O; \n\n\tint Z;\n\n\tscanf(\"%d\",&N);\n\n\tif(N%2!=0){\n\n\t\tprintf(\"%d\",N/2+1);\n\n\t}\n\n\telse if(N%2==0)\n\n\t\tprintf(\"%d\",N/2);\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "271",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std ;\n\n\n\nint main(){\n\n\tlong long a;\n\n\tcin>>a;\n\n\tcout<<(a+1)/2<<endl;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint N; \n\n\tint O; \n\n\tint Z;\n\n\tscanf(\"%d\",&N);\n\n\tif(N%2!=0){\n\n\t\tprintf(\"%d\",N/2+1);\n\n\t}\n\n\telse if(N%2==0)\n\n\t\tprintf(\"%d\",N/2);\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "272",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t   n/=2;\n\n\telse\n\n\t   n=n/2+1;\n\n\tcout<<n<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint N; \n\n\tint O; \n\n\tint Z;\n\n\tscanf(\"%d\",&N);\n\n\tif(N%2!=0){\n\n\t\tprintf(\"%d\",N/2+1);\n\n\t}\n\n\telse if(N%2==0)\n\n\t\tprintf(\"%d\",N/2);\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "273",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tcin>>n;\n\n\tint m=(n+1)/2;\n\n\tcout<<m<<endl;\n\n    return 0; \n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint N; \n\n\tint O; \n\n\tint Z;\n\n\tscanf(\"%d\",&N);\n\n\tif(N%2!=0){\n\n\t\tprintf(\"%d\",N/2+1);\n\n\t}\n\n\telse if(N%2==0)\n\n\t\tprintf(\"%d\",N/2);\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "274",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define ll long long\n\nconst int N = 300005;\n\n\n\nint n;\n\n\n\nint main()\n\n{\n\n\n\ncin >> n ;\n\ncout << n/2 + n%2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint N; \n\n\tint O; \n\n\tint Z;\n\n\tscanf(\"%d\",&N);\n\n\tif(N%2!=0){\n\n\t\tprintf(\"%d\",N/2+1);\n\n\t}\n\n\telse if(N%2==0)\n\n\t\tprintf(\"%d\",N/2);\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "275",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    int n; cin>> n;\n\n    cout<< (n + 1) / 2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\tint N,i;\n\n\tscanf(\"%d\",&N);\n\n\tfor(i=1;i<N;i++){\n\n\t\tN--;\n\n\t}\n\n\tprintf(\"%d\",N);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "276",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std ;\n\n\n\nint main(){\n\n\tlong long a;\n\n\tcin>>a;\n\n\tcout<<(a+1)/2<<endl;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\tint N,i;\n\n\tscanf(\"%d\",&N);\n\n\tfor(i=1;i<N;i++){\n\n\t\tN--;\n\n\t}\n\n\tprintf(\"%d\",N);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "277",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t   n/=2;\n\n\telse\n\n\t   n=n/2+1;\n\n\tcout<<n<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\tint N,i;\n\n\tscanf(\"%d\",&N);\n\n\tfor(i=1;i<N;i++){\n\n\t\tN--;\n\n\t}\n\n\tprintf(\"%d\",N);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "278",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tcin>>n;\n\n\tint m=(n+1)/2;\n\n\tcout<<m<<endl;\n\n    return 0; \n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\tint N,i;\n\n\tscanf(\"%d\",&N);\n\n\tfor(i=1;i<N;i++){\n\n\t\tN--;\n\n\t}\n\n\tprintf(\"%d\",N);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "279",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define ll long long\n\nconst int N = 300005;\n\n\n\nint n;\n\n\n\nint main()\n\n{\n\n\n\ncin >> n ;\n\ncout << n/2 + n%2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\tint N,i;\n\n\tscanf(\"%d\",&N);\n\n\tfor(i=1;i<N;i++){\n\n\t\tN--;\n\n\t}\n\n\tprintf(\"%d\",N);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "280",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    int n; cin>> n;\n\n    cout<< (n + 1) / 2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main ()\n\n{\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\t\n\n\t(N%2 == 0) ? printf(\"%d\", (N/2)) : printf(\"%d\", (N/2)+1);\n\n\t\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "281",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std ;\n\n\n\nint main(){\n\n\tlong long a;\n\n\tcin>>a;\n\n\tcout<<(a+1)/2<<endl;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main ()\n\n{\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\t\n\n\t(N%2 == 0) ? printf(\"%d\", (N/2)) : printf(\"%d\", (N/2)+1);\n\n\t\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "282",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t   n/=2;\n\n\telse\n\n\t   n=n/2+1;\n\n\tcout<<n<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main ()\n\n{\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\t\n\n\t(N%2 == 0) ? printf(\"%d\", (N/2)) : printf(\"%d\", (N/2)+1);\n\n\t\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "283",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tcin>>n;\n\n\tint m=(n+1)/2;\n\n\tcout<<m<<endl;\n\n    return 0; \n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main ()\n\n{\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\t\n\n\t(N%2 == 0) ? printf(\"%d\", (N/2)) : printf(\"%d\", (N/2)+1);\n\n\t\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "284",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define ll long long\n\nconst int N = 300005;\n\n\n\nint n;\n\n\n\nint main()\n\n{\n\n\n\ncin >> n ;\n\ncout << n/2 + n%2;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main ()\n\n{\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\t\n\n\t(N%2 == 0) ? printf(\"%d\", (N/2)) : printf(\"%d\", (N/2)+1);\n\n\t\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "285",
        "source_code": "#include <iostream>\n\n using namespace std;\n\nint main ()\n\n{\n\nint num ,re;\n\ncin >>num;\n\nif ( num%2==0)\n\n{\n\nre =num/2;\n\n}\n\nelse {\n\n\tre =num/2;\n\n\tre+=1;\n\n}\n\n\n\ncout <<re ;\n\nsystem(\"pause\");\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\nint main()\n\n{\n\n\tint N,a;\n\n\tscanf(\"%d\",&N);\n\n\ta=N/2+1;\n\n\tif(N%2==0)\n\n\t{\n\n\t\tprintf(\"%d\",N/2);\n\n\t}\n\n\telse\n\n\t{\n\n\t\tprintf(\"%d\",a);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "286",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    ios_base::sync_with_stdio(false);\n\n    cin.tie(NULL);\n\n    int t;\n\n    cin >> t;\n\n    cout << (t + 1) / 2 << endl;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\nint main()\n\n{\n\n\tint N,a;\n\n\tscanf(\"%d\",&N);\n\n\ta=N/2+1;\n\n\tif(N%2==0)\n\n\t{\n\n\t\tprintf(\"%d\",N/2);\n\n\t}\n\n\telse\n\n\t{\n\n\t\tprintf(\"%d\",a);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "287",
        "source_code": "#include <iostream>\n\n using namespace std;\n\nint main ()\n\n{\n\nint num ,re;\n\ncin >>num;\n\nif ( num%2==0)\n\n{\n\nre =num/2;\n\n}\n\nelse {\n\n\tre =num/2;\n\n\tre+=1;\n\n}\n\n\n\ncout <<re ;\n\nsystem(\"pause\");\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\nint main ()\n\n{\n\n\tint n;\n\n\tscanf(\"%d\", &n);\n\n\t(n%2==0) ? (printf(\"%d\", n/2)) : (printf(\"%d\", (n/2)+1));\n\n}"
    },
    {
        "id": "288",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    ios_base::sync_with_stdio(false);\n\n    cin.tie(NULL);\n\n    int t;\n\n    cin >> t;\n\n    cout << (t + 1) / 2 << endl;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\nint main ()\n\n{\n\n\tint n;\n\n\tscanf(\"%d\", &n);\n\n\t(n%2==0) ? (printf(\"%d\", n/2)) : (printf(\"%d\", (n/2)+1));\n\n}"
    },
    {
        "id": "289",
        "source_code": "#include <iostream>\n\n using namespace std;\n\nint main ()\n\n{\n\nint num ,re;\n\ncin >>num;\n\nif ( num%2==0)\n\n{\n\nre =num/2;\n\n}\n\nelse {\n\n\tre =num/2;\n\n\tre+=1;\n\n}\n\n\n\ncout <<re ;\n\nsystem(\"pause\");\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main (){\n\n\t\n\n\tint n,z;\n\n\tscanf (\"%d\", &n);\n\n\t( n%2 != 0 ) ? printf (\"%d\\n\", n/2 +1) : printf (\"%d\\n\", n/2);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "290",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    ios_base::sync_with_stdio(false);\n\n    cin.tie(NULL);\n\n    int t;\n\n    cin >> t;\n\n    cout << (t + 1) / 2 << endl;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main (){\n\n\t\n\n\tint n,z;\n\n\tscanf (\"%d\", &n);\n\n\t( n%2 != 0 ) ? printf (\"%d\\n\", n/2 +1) : printf (\"%d\\n\", n/2);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "291",
        "source_code": "#include <iostream>\n\n using namespace std;\n\nint main ()\n\n{\n\nint num ,re;\n\ncin >>num;\n\nif ( num%2==0)\n\n{\n\nre =num/2;\n\n}\n\nelse {\n\n\tre =num/2;\n\n\tre+=1;\n\n}\n\n\n\ncout <<re ;\n\nsystem(\"pause\");\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint a;\n\n\tscanf(\"%d\",&a);\n\nif(a%2==0){\n\n\tprintf(\"%d\",a/2);\n\n}\n\nelse{\n\n\tprintf(\"%d\",a/2+1);\n\n}\n\nreturn 0;\n\n}"
    },
    {
        "id": "292",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    ios_base::sync_with_stdio(false);\n\n    cin.tie(NULL);\n\n    int t;\n\n    cin >> t;\n\n    cout << (t + 1) / 2 << endl;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint a;\n\n\tscanf(\"%d\",&a);\n\nif(a%2==0){\n\n\tprintf(\"%d\",a/2);\n\n}\n\nelse{\n\n\tprintf(\"%d\",a/2+1);\n\n}\n\nreturn 0;\n\n}"
    },
    {
        "id": "293",
        "source_code": "#include <iostream>\n\n using namespace std;\n\nint main ()\n\n{\n\nint num ,re;\n\ncin >>num;\n\nif ( num%2==0)\n\n{\n\nre =num/2;\n\n}\n\nelse {\n\n\tre =num/2;\n\n\tre+=1;\n\n}\n\n\n\ncout <<re ;\n\nsystem(\"pause\");\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\tint a,b;\n\n\t\n\n\tscanf(\"%d\", &a);\n\n\tb = a/2;\n\n\t\n\n\tif(a%2==1){\n\n\t\tprintf(\"%d\", b+1);\n\n\t}else{\n\n\t\tprintf(\"%d\", b);\n\n\t}\n\n\t\n\n}"
    },
    {
        "id": "294",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    ios_base::sync_with_stdio(false);\n\n    cin.tie(NULL);\n\n    int t;\n\n    cin >> t;\n\n    cout << (t + 1) / 2 << endl;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\tint a,b;\n\n\t\n\n\tscanf(\"%d\", &a);\n\n\tb = a/2;\n\n\t\n\n\tif(a%2==1){\n\n\t\tprintf(\"%d\", b+1);\n\n\t}else{\n\n\t\tprintf(\"%d\", b);\n\n\t}\n\n\t\n\n}"
    },
    {
        "id": "295",
        "source_code": "#include <iostream>\n\n using namespace std;\n\nint main ()\n\n{\n\nint num ,re;\n\ncin >>num;\n\nif ( num%2==0)\n\n{\n\nre =num/2;\n\n}\n\nelse {\n\n\tre =num/2;\n\n\tre+=1;\n\n}\n\n\n\ncout <<re ;\n\nsystem(\"pause\");\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint N;\n\n\tscanf(\"%d\",&N);\n\n\tint x;\n\n\tx = N + 1;\n\n\t\n\n\tif(N%2 == 0){\n\n\t\tprintf(\"%d\",N / 2);\n\n\t}\n\n\telse{\n\n\t\tprintf(\"%d\",x / 2);\n\n\t}\n\n\t\n\n\t\n\n\t\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "296",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    ios_base::sync_with_stdio(false);\n\n    cin.tie(NULL);\n\n    int t;\n\n    cin >> t;\n\n    cout << (t + 1) / 2 << endl;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint N;\n\n\tscanf(\"%d\",&N);\n\n\tint x;\n\n\tx = N + 1;\n\n\t\n\n\tif(N%2 == 0){\n\n\t\tprintf(\"%d\",N / 2);\n\n\t}\n\n\telse{\n\n\t\tprintf(\"%d\",x / 2);\n\n\t}\n\n\t\n\n\t\n\n\t\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "297",
        "source_code": "#include <iostream>\n\n using namespace std;\n\nint main ()\n\n{\n\nint num ,re;\n\ncin >>num;\n\nif ( num%2==0)\n\n{\n\nre =num/2;\n\n}\n\nelse {\n\n\tre =num/2;\n\n\tre+=1;\n\n}\n\n\n\ncout <<re ;\n\nsystem(\"pause\");\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint N;\n\n\tint O;\n\n\tint Z;\n\n\tscanf(\"%d\", &N);\n\n\tif(N%2!=0){\n\n\t\tprintf(\"%d\",N/2+1);\n\n\t}\n\n\telse if(N%2==0){\n\n\t\tprintf(\"%d\",N/2);\n\n\t}\n\nreturn 0;\n\n}"
    },
    {
        "id": "298",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    ios_base::sync_with_stdio(false);\n\n    cin.tie(NULL);\n\n    int t;\n\n    cin >> t;\n\n    cout << (t + 1) / 2 << endl;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint N;\n\n\tint O;\n\n\tint Z;\n\n\tscanf(\"%d\", &N);\n\n\tif(N%2!=0){\n\n\t\tprintf(\"%d\",N/2+1);\n\n\t}\n\n\telse if(N%2==0){\n\n\t\tprintf(\"%d\",N/2);\n\n\t}\n\nreturn 0;\n\n}"
    },
    {
        "id": "299",
        "source_code": "#include <iostream>\n\n using namespace std;\n\nint main ()\n\n{\n\nint num ,re;\n\ncin >>num;\n\nif ( num%2==0)\n\n{\n\nre =num/2;\n\n}\n\nelse {\n\n\tre =num/2;\n\n\tre+=1;\n\n}\n\n\n\ncout <<re ;\n\nsystem(\"pause\");\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main() {\n\n  int N;\n\n  scanf(\"%d\", &N);\n\n  for(int i=1; i<=100; i++){ \n\n    N=N-2;\n\n    if(N<=0){\n\n      printf(\"%d\", i);\n\n      break;\n\n    }else{\n\n    }\n\n\n\n  }\n\n  return 0;\n\n}"
    },
    {
        "id": "300",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    ios_base::sync_with_stdio(false);\n\n    cin.tie(NULL);\n\n    int t;\n\n    cin >> t;\n\n    cout << (t + 1) / 2 << endl;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main() {\n\n  int N;\n\n  scanf(\"%d\", &N);\n\n  for(int i=1; i<=100; i++){ \n\n    N=N-2;\n\n    if(N<=0){\n\n      printf(\"%d\", i);\n\n      break;\n\n    }else{\n\n    }\n\n\n\n  }\n\n  return 0;\n\n}"
    },
    {
        "id": "301",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    while(cin>>n)\n\n        cout<<n/2+n%2<<endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n{\n\n\tint N;\n\n\tscanf (\"%d\", &N);\n\n\t\n\n\t(N%2 == 0) ? printf (\"%d\", N/2) : printf (\"%d\", N/2 + 1);\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "302",
        "source_code": "#include <iostream>\n\n\n\nint main()\n\n{\n\n\tint n;\n\n\tstd::cin >> n;\n\n\tif (n % 2 != 0)\n\n\t\t++n;\n\n\tstd::cout << n / 2 << '\\n';\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n{\n\n\tint N;\n\n\tscanf (\"%d\", &N);\n\n\t\n\n\t(N%2 == 0) ? printf (\"%d\", N/2) : printf (\"%d\", N/2 + 1);\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "303",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t cout<<n/2<<endl;\n\n\telse\n\n\t cout<<(n/2+1)<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n{\n\n\tint N;\n\n\tscanf (\"%d\", &N);\n\n\t\n\n\t(N%2 == 0) ? printf (\"%d\", N/2) : printf (\"%d\", N/2 + 1);\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "304",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    while(cin>>n)\n\n        cout<<n/2+n%2<<endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint A;\n\n\tscanf(\"%d\", &A);\n\n\tint sheet = (A % 2 == 0) ? (A/2) : (A/2) + 1;\n\n\tprintf(\"%d\\n\", sheet);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "305",
        "source_code": "#include <iostream>\n\n\n\nint main()\n\n{\n\n\tint n;\n\n\tstd::cin >> n;\n\n\tif (n % 2 != 0)\n\n\t\t++n;\n\n\tstd::cout << n / 2 << '\\n';\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint A;\n\n\tscanf(\"%d\", &A);\n\n\tint sheet = (A % 2 == 0) ? (A/2) : (A/2) + 1;\n\n\tprintf(\"%d\\n\", sheet);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "306",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t cout<<n/2<<endl;\n\n\telse\n\n\t cout<<(n/2+1)<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint A;\n\n\tscanf(\"%d\", &A);\n\n\tint sheet = (A % 2 == 0) ? (A/2) : (A/2) + 1;\n\n\tprintf(\"%d\\n\", sheet);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "307",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    while(cin>>n)\n\n        cout<<n/2+n%2<<endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\t\n\n\tif(N%2==0){\n\n\t\tprintf(\"%d\", N/2);\n\n\t}\n\n\telse{\n\n\t\tprintf(\"%d\", N/2+1);\n\n\t}\n\n\t\n\n\t\n\n\t\n\n\t\n\n\treturn 0;\n\n\t\n\n}"
    },
    {
        "id": "308",
        "source_code": "#include <iostream>\n\n\n\nint main()\n\n{\n\n\tint n;\n\n\tstd::cin >> n;\n\n\tif (n % 2 != 0)\n\n\t\t++n;\n\n\tstd::cout << n / 2 << '\\n';\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\t\n\n\tif(N%2==0){\n\n\t\tprintf(\"%d\", N/2);\n\n\t}\n\n\telse{\n\n\t\tprintf(\"%d\", N/2+1);\n\n\t}\n\n\t\n\n\t\n\n\t\n\n\t\n\n\treturn 0;\n\n\t\n\n}"
    },
    {
        "id": "309",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t cout<<n/2<<endl;\n\n\telse\n\n\t cout<<(n/2+1)<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\t\n\n\tif(N%2==0){\n\n\t\tprintf(\"%d\", N/2);\n\n\t}\n\n\telse{\n\n\t\tprintf(\"%d\", N/2+1);\n\n\t}\n\n\t\n\n\t\n\n\t\n\n\t\n\n\treturn 0;\n\n\t\n\n}"
    },
    {
        "id": "310",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    while(cin>>n)\n\n        cout<<n/2+n%2<<endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main (){\n\n\t\n\n\tint n,z;\n\n\tscanf (\"%d\", &n);\n\n\tif (n%2 != 0){\n\n\t\tprintf (\"%d\\n\", n/2 + 1);\n\n\t}\n\n\telse {\n\n\t\tprintf (\"%d\\n\", n/2);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "311",
        "source_code": "#include <iostream>\n\n\n\nint main()\n\n{\n\n\tint n;\n\n\tstd::cin >> n;\n\n\tif (n % 2 != 0)\n\n\t\t++n;\n\n\tstd::cout << n / 2 << '\\n';\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main (){\n\n\t\n\n\tint n,z;\n\n\tscanf (\"%d\", &n);\n\n\tif (n%2 != 0){\n\n\t\tprintf (\"%d\\n\", n/2 + 1);\n\n\t}\n\n\telse {\n\n\t\tprintf (\"%d\\n\", n/2);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "312",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t cout<<n/2<<endl;\n\n\telse\n\n\t cout<<(n/2+1)<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main (){\n\n\t\n\n\tint n,z;\n\n\tscanf (\"%d\", &n);\n\n\tif (n%2 != 0){\n\n\t\tprintf (\"%d\\n\", n/2 + 1);\n\n\t}\n\n\telse {\n\n\t\tprintf (\"%d\\n\", n/2);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "313",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    while(cin>>n)\n\n        cout<<n/2+n%2<<endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\t int a;\n\n\t  \n\n\tscanf(\"%d\",&a);\n\n\t\n\n\t  if(a % 2 == 0){\n\n\t\t\t\n\n\t\ta /=2;  \t\n\n\t\t\tprintf(\"%d\",a);   \t\n\n\t  } \n\n\t  else{\n\n\t  \t\n\n\t  \ta /=2;\n\n\t  \t\tprintf(\"%d\",a+1);\n\n\t  }\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "314",
        "source_code": "#include <iostream>\n\n\n\nint main()\n\n{\n\n\tint n;\n\n\tstd::cin >> n;\n\n\tif (n % 2 != 0)\n\n\t\t++n;\n\n\tstd::cout << n / 2 << '\\n';\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\t int a;\n\n\t  \n\n\tscanf(\"%d\",&a);\n\n\t\n\n\t  if(a % 2 == 0){\n\n\t\t\t\n\n\t\ta /=2;  \t\n\n\t\t\tprintf(\"%d\",a);   \t\n\n\t  } \n\n\t  else{\n\n\t  \t\n\n\t  \ta /=2;\n\n\t  \t\tprintf(\"%d\",a+1);\n\n\t  }\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "315",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t cout<<n/2<<endl;\n\n\telse\n\n\t cout<<(n/2+1)<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\t int a;\n\n\t  \n\n\tscanf(\"%d\",&a);\n\n\t\n\n\t  if(a % 2 == 0){\n\n\t\t\t\n\n\t\ta /=2;  \t\n\n\t\t\tprintf(\"%d\",a);   \t\n\n\t  } \n\n\t  else{\n\n\t  \t\n\n\t  \ta /=2;\n\n\t  \t\tprintf(\"%d\",a+1);\n\n\t  }\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "316",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    while(cin>>n)\n\n        cout<<n/2+n%2<<endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint N;\n\n  int hasil;\n\n\tscanf(\"%d\", &N);\n\n\n\n\tif(N%2!=0){\n\n    hasil=N/2;\n\n\t\tprintf(\"%d\", hasil+1);\n\n\t}\n\n  else{\n\n    hasil=N/2;\n\n    printf(\"%d\", hasil);\n\n  }\n\n\treturn 0;\n\n}"
    },
    {
        "id": "317",
        "source_code": "#include <iostream>\n\n\n\nint main()\n\n{\n\n\tint n;\n\n\tstd::cin >> n;\n\n\tif (n % 2 != 0)\n\n\t\t++n;\n\n\tstd::cout << n / 2 << '\\n';\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint N;\n\n  int hasil;\n\n\tscanf(\"%d\", &N);\n\n\n\n\tif(N%2!=0){\n\n    hasil=N/2;\n\n\t\tprintf(\"%d\", hasil+1);\n\n\t}\n\n  else{\n\n    hasil=N/2;\n\n    printf(\"%d\", hasil);\n\n  }\n\n\treturn 0;\n\n}"
    },
    {
        "id": "318",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tif(n%2==0)\n\n\t cout<<n/2<<endl;\n\n\telse\n\n\t cout<<(n/2+1)<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint N;\n\n  int hasil;\n\n\tscanf(\"%d\", &N);\n\n\n\n\tif(N%2!=0){\n\n    hasil=N/2;\n\n\t\tprintf(\"%d\", hasil+1);\n\n\t}\n\n  else{\n\n    hasil=N/2;\n\n    printf(\"%d\", hasil);\n\n  }\n\n\treturn 0;\n\n}"
    },
    {
        "id": "319",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n/*\n\n#define mod 7\n\ntypedef long long ll;\n\n\n\nll fact[1000006], inv[1000006];\n\n\n\nll fp(ll base, ll exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    ll ans = fp(base, exp / 2);\n\n    ans = (ans * ans) % mod;\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base % mod)) % mod;\n\n    return ans;\n\n}\n\n\n\nvoid calcFacAndInv(ll n)\n\n{\n\n    fact[0] = inv[0] = 1;\n\n    for (ll i = 1; i <= n; i++)\n\n    {\n\n        fact[i] = (i * fact[i - 1]) % mod;\n\n        inv[i] = fp(fact[i], mod - 2);\n\n    }\n\n}\n\n\n\nll ncr(ll n, ll r)\n\n{\n\n    return ((fact[n] * inv[r]) % mod * inv[n - r]) % mod;\n\n}\n\n\n\nll npr(ll n, ll r)\n\n{\n\n    return (fact[n] * inv[n - r]) % mod;\n\n}\n\n\n\nint main()\n\n{\n\n    calcFacAndInv(100000);\n\n     cout<<inv[3];\n\n    return 0;\n\n}\n\n*/\n\n\n\n\n\n// GCD\n\n\n\nint gcd(long long a,long long b)\n\n{\n\n    if (b==0)\n\n        return a;\n\n    return gcd (b,a%b);\n\n}\n\n//fast power\n\n/*\n\n#define mod 1000000007\n\nlong long fp(long long  base, long long exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    long long  ans = fp(base, exp / 2);\n\n    ans = (ans * ans);\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base )) ;\n\n    return ans;\n\n}\n\n*/\n\n//prime factoriation\n\n/*\n\nset<int >s;\n\nbool prime factorization (int x)\n\n{\n\n    for (int j=2; j*j<=x; ++j)\n\n    {\n\n        while (x%j==0)\n\n        {\n\n            s.insert(j);\n\n            x/=j;\n\n        }\n\n    }\n\n    if (x>1)\n\n    {\n\n        s.insert(x);\n\n    }\n\n    if (s.size()==2)\n\n        return true ;\n\n    else\n\n        return false ;\n\n}\n\n\n\n#define ll long long\n\nint a,b,q,p,n;\n\nint countDivisorss(int x,int y)\n\n{\n\n    ll cnt = 0;\n\n    for (int i = min(x,y); i <= sqrt(n); i++)\n\n    {\n\n        if (x % i == 0&&y%i==0)\n\n        {\n\n            if (x / i == i||y / i == i)\n\n                cnt++;\n\n\n\n            else\n\n                cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\nint countDivisors(int x)\n\n{\n\n    ll cnt = 0;\n\n    int tmp=n;\n\n    if (n-x>10000000)  tmp=sqrt(n);\n\n    for (int i = x; i <= tmp; i++)\n\n    {\n\n        if (x % i == 0)\n\n        {\n\n         if (x/i==i)\n\n            cnt++;\n\n         else\n\n            cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\n*/\n\n\n\n/*\n\n        int s =n/2,e=n-1;\n\n        while (s<=e&&e<=n-1)\n\n        {\n\n            int mid =s+e/2;\n\n\n\n            if (arr[mid]==arr[n/2])\n\n            {\n\n                s=mid;\n\n                num +=mid -s;\n\n            }\n\n            else\n\n                e=mid-1;\n\n        }\n\n        */\n\n\n\n\n\n\n\n\n\nconst int N = 1e5 + 5;\n\n\n\nvector<int> adj[N];\n\nbool visited[N];\n\nint nodesNum;\n\nvoid dfs(int node)\n\n{\n\n   if (visited[node])\n\n       return;\n\n   visited[node] = true;\n\n   for (int child: adj[node])\n\n       dfs(child);\n\n}\n\n\n\nint main()\n\n{\n\n   int n;\n\n   cin>>n;\n\n   if (n%2==0)\n\n    cout<<n/2;\n\n   else \n\n    cout<<n/2+1;\n\n   return 0;\n\n}\n\n\n\n\n",
        "optimized_code": "#include <iostream>\n\n#define ll long long\n\nusing namespace std;\n\n\n\nint main()\n\n{ ll n;\n\ncin>>n;\n\nif(n%2==0)\n\n    cout << n/2;\n\nelse\n\n    cout << (n/2)+1 << endl;\n\n    return 0;\n\n}\n"
    },
    {
        "id": "320",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n/*\n\n#define mod 7\n\ntypedef long long ll;\n\n\n\nll fact[1000006], inv[1000006];\n\n\n\nll fp(ll base, ll exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    ll ans = fp(base, exp / 2);\n\n    ans = (ans * ans) % mod;\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base % mod)) % mod;\n\n    return ans;\n\n}\n\n\n\nvoid calcFacAndInv(ll n)\n\n{\n\n    fact[0] = inv[0] = 1;\n\n    for (ll i = 1; i <= n; i++)\n\n    {\n\n        fact[i] = (i * fact[i - 1]) % mod;\n\n        inv[i] = fp(fact[i], mod - 2);\n\n    }\n\n}\n\n\n\nll ncr(ll n, ll r)\n\n{\n\n    return ((fact[n] * inv[r]) % mod * inv[n - r]) % mod;\n\n}\n\n\n\nll npr(ll n, ll r)\n\n{\n\n    return (fact[n] * inv[n - r]) % mod;\n\n}\n\n\n\nint main()\n\n{\n\n    calcFacAndInv(100000);\n\n     cout<<inv[3];\n\n    return 0;\n\n}\n\n*/\n\n\n\n\n\n// GCD\n\n\n\nint gcd(long long a,long long b)\n\n{\n\n    if (b==0)\n\n        return a;\n\n    return gcd (b,a%b);\n\n}\n\n//fast power\n\n/*\n\n#define mod 1000000007\n\nlong long fp(long long  base, long long exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    long long  ans = fp(base, exp / 2);\n\n    ans = (ans * ans);\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base )) ;\n\n    return ans;\n\n}\n\n*/\n\n//prime factoriation\n\n/*\n\nset<int >s;\n\nbool prime factorization (int x)\n\n{\n\n    for (int j=2; j*j<=x; ++j)\n\n    {\n\n        while (x%j==0)\n\n        {\n\n            s.insert(j);\n\n            x/=j;\n\n        }\n\n    }\n\n    if (x>1)\n\n    {\n\n        s.insert(x);\n\n    }\n\n    if (s.size()==2)\n\n        return true ;\n\n    else\n\n        return false ;\n\n}\n\n\n\n#define ll long long\n\nint a,b,q,p,n;\n\nint countDivisorss(int x,int y)\n\n{\n\n    ll cnt = 0;\n\n    for (int i = min(x,y); i <= sqrt(n); i++)\n\n    {\n\n        if (x % i == 0&&y%i==0)\n\n        {\n\n            if (x / i == i||y / i == i)\n\n                cnt++;\n\n\n\n            else\n\n                cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\nint countDivisors(int x)\n\n{\n\n    ll cnt = 0;\n\n    int tmp=n;\n\n    if (n-x>10000000)  tmp=sqrt(n);\n\n    for (int i = x; i <= tmp; i++)\n\n    {\n\n        if (x % i == 0)\n\n        {\n\n         if (x/i==i)\n\n            cnt++;\n\n         else\n\n            cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\n*/\n\n\n\n/*\n\n        int s =n/2,e=n-1;\n\n        while (s<=e&&e<=n-1)\n\n        {\n\n            int mid =s+e/2;\n\n\n\n            if (arr[mid]==arr[n/2])\n\n            {\n\n                s=mid;\n\n                num +=mid -s;\n\n            }\n\n            else\n\n                e=mid-1;\n\n        }\n\n        */\n\n\n\n\n\n\n\n\n\nconst int N = 1e5 + 5;\n\n\n\nvector<int> adj[N];\n\nbool visited[N];\n\nint nodesNum;\n\nvoid dfs(int node)\n\n{\n\n   if (visited[node])\n\n       return;\n\n   visited[node] = true;\n\n   for (int child: adj[node])\n\n       dfs(child);\n\n}\n\n\n\nint main()\n\n{\n\n   int n;\n\n   cin>>n;\n\n   if (n%2==0)\n\n    cout<<n/2;\n\n   else \n\n    cout<<n/2+1;\n\n   return 0;\n\n}\n\n\n\n\n",
        "optimized_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    cin>>n;\n\n    if(n%2==0){\n\n        cout<<n/2;\n\n    }\n\n    else{\n\n        cout<<n/2+1;\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "321",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n/*\n\n#define mod 7\n\ntypedef long long ll;\n\n\n\nll fact[1000006], inv[1000006];\n\n\n\nll fp(ll base, ll exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    ll ans = fp(base, exp / 2);\n\n    ans = (ans * ans) % mod;\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base % mod)) % mod;\n\n    return ans;\n\n}\n\n\n\nvoid calcFacAndInv(ll n)\n\n{\n\n    fact[0] = inv[0] = 1;\n\n    for (ll i = 1; i <= n; i++)\n\n    {\n\n        fact[i] = (i * fact[i - 1]) % mod;\n\n        inv[i] = fp(fact[i], mod - 2);\n\n    }\n\n}\n\n\n\nll ncr(ll n, ll r)\n\n{\n\n    return ((fact[n] * inv[r]) % mod * inv[n - r]) % mod;\n\n}\n\n\n\nll npr(ll n, ll r)\n\n{\n\n    return (fact[n] * inv[n - r]) % mod;\n\n}\n\n\n\nint main()\n\n{\n\n    calcFacAndInv(100000);\n\n     cout<<inv[3];\n\n    return 0;\n\n}\n\n*/\n\n\n\n\n\n// GCD\n\n\n\nint gcd(long long a,long long b)\n\n{\n\n    if (b==0)\n\n        return a;\n\n    return gcd (b,a%b);\n\n}\n\n//fast power\n\n/*\n\n#define mod 1000000007\n\nlong long fp(long long  base, long long exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    long long  ans = fp(base, exp / 2);\n\n    ans = (ans * ans);\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base )) ;\n\n    return ans;\n\n}\n\n*/\n\n//prime factoriation\n\n/*\n\nset<int >s;\n\nbool prime factorization (int x)\n\n{\n\n    for (int j=2; j*j<=x; ++j)\n\n    {\n\n        while (x%j==0)\n\n        {\n\n            s.insert(j);\n\n            x/=j;\n\n        }\n\n    }\n\n    if (x>1)\n\n    {\n\n        s.insert(x);\n\n    }\n\n    if (s.size()==2)\n\n        return true ;\n\n    else\n\n        return false ;\n\n}\n\n\n\n#define ll long long\n\nint a,b,q,p,n;\n\nint countDivisorss(int x,int y)\n\n{\n\n    ll cnt = 0;\n\n    for (int i = min(x,y); i <= sqrt(n); i++)\n\n    {\n\n        if (x % i == 0&&y%i==0)\n\n        {\n\n            if (x / i == i||y / i == i)\n\n                cnt++;\n\n\n\n            else\n\n                cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\nint countDivisors(int x)\n\n{\n\n    ll cnt = 0;\n\n    int tmp=n;\n\n    if (n-x>10000000)  tmp=sqrt(n);\n\n    for (int i = x; i <= tmp; i++)\n\n    {\n\n        if (x % i == 0)\n\n        {\n\n         if (x/i==i)\n\n            cnt++;\n\n         else\n\n            cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\n*/\n\n\n\n/*\n\n        int s =n/2,e=n-1;\n\n        while (s<=e&&e<=n-1)\n\n        {\n\n            int mid =s+e/2;\n\n\n\n            if (arr[mid]==arr[n/2])\n\n            {\n\n                s=mid;\n\n                num +=mid -s;\n\n            }\n\n            else\n\n                e=mid-1;\n\n        }\n\n        */\n\n\n\n\n\n\n\n\n\nconst int N = 1e5 + 5;\n\n\n\nvector<int> adj[N];\n\nbool visited[N];\n\nint nodesNum;\n\nvoid dfs(int node)\n\n{\n\n   if (visited[node])\n\n       return;\n\n   visited[node] = true;\n\n   for (int child: adj[node])\n\n       dfs(child);\n\n}\n\n\n\nint main()\n\n{\n\n   int n;\n\n   cin>>n;\n\n   if (n%2==0)\n\n    cout<<n/2;\n\n   else \n\n    cout<<n/2+1;\n\n   return 0;\n\n}\n\n\n\n\n",
        "optimized_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tcout<<(n+1)/2;\n\n}"
    },
    {
        "id": "322",
        "source_code": "#include <bits/stdc++.h>\n\n\n\n#define ll long long\n\n#define ld long double\n\n#define ull unsigned long long\n\n#define endl \"\\n\"\n\n#define MohamedMotaz ios::sync_with_stdio(0); cin.tie(0); ios_base::sync_with_stdio(0);\n\n\n\nusing namespace std;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nint main()\n\n{\n\n\tMohamedMotaz;\n\n\tll x;\n\n\tcin >> x;\n\n\tcout << ceil(x / 2.0);\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\nint main()\n\n{\n\n    int n;\n\n    scanf(\"%d\",&n);\n\n    printf(\"%d\\n\",(n+1)/2);\n\n    return 0;\n\n}"
    },
    {
        "id": "323",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;   \n\n\n\nint main()\n\n{\n\n    ll num;\n\n    cin>>num;\n\n    cout<<num/2 + num %2;\n\n    return 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\nint main()\n\n{\n\n    int n;\n\n    scanf(\"%d\",&n);\n\n    printf(\"%d\\n\",(n+1)/2);\n\n    return 0;\n\n}"
    },
    {
        "id": "324",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n/*\n\n#define mod 7\n\ntypedef long long ll;\n\n\n\nll fact[1000006], inv[1000006];\n\n\n\nll fp(ll base, ll exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    ll ans = fp(base, exp / 2);\n\n    ans = (ans * ans) % mod;\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base % mod)) % mod;\n\n    return ans;\n\n}\n\n\n\nvoid calcFacAndInv(ll n)\n\n{\n\n    fact[0] = inv[0] = 1;\n\n    for (ll i = 1; i <= n; i++)\n\n    {\n\n        fact[i] = (i * fact[i - 1]) % mod;\n\n        inv[i] = fp(fact[i], mod - 2);\n\n    }\n\n}\n\n\n\nll ncr(ll n, ll r)\n\n{\n\n    return ((fact[n] * inv[r]) % mod * inv[n - r]) % mod;\n\n}\n\n\n\nll npr(ll n, ll r)\n\n{\n\n    return (fact[n] * inv[n - r]) % mod;\n\n}\n\n\n\nint main()\n\n{\n\n    calcFacAndInv(100000);\n\n     cout<<inv[3];\n\n    return 0;\n\n}\n\n*/\n\n\n\n\n\n// GCD\n\n\n\nint gcd(long long a,long long b)\n\n{\n\n    if (b==0)\n\n        return a;\n\n    return gcd (b,a%b);\n\n}\n\n//fast power\n\n/*\n\n#define mod 1000000007\n\nlong long fp(long long  base, long long exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    long long  ans = fp(base, exp / 2);\n\n    ans = (ans * ans);\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base )) ;\n\n    return ans;\n\n}\n\n*/\n\n//prime factoriation\n\n/*\n\nset<int >s;\n\nbool prime factorization (int x)\n\n{\n\n    for (int j=2; j*j<=x; ++j)\n\n    {\n\n        while (x%j==0)\n\n        {\n\n            s.insert(j);\n\n            x/=j;\n\n        }\n\n    }\n\n    if (x>1)\n\n    {\n\n        s.insert(x);\n\n    }\n\n    if (s.size()==2)\n\n        return true ;\n\n    else\n\n        return false ;\n\n}\n\n\n\n#define ll long long\n\nint a,b,q,p,n;\n\nint countDivisorss(int x,int y)\n\n{\n\n    ll cnt = 0;\n\n    for (int i = min(x,y); i <= sqrt(n); i++)\n\n    {\n\n        if (x % i == 0&&y%i==0)\n\n        {\n\n            if (x / i == i||y / i == i)\n\n                cnt++;\n\n\n\n            else\n\n                cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\nint countDivisors(int x)\n\n{\n\n    ll cnt = 0;\n\n    int tmp=n;\n\n    if (n-x>10000000)  tmp=sqrt(n);\n\n    for (int i = x; i <= tmp; i++)\n\n    {\n\n        if (x % i == 0)\n\n        {\n\n         if (x/i==i)\n\n            cnt++;\n\n         else\n\n            cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\n*/\n\n\n\n/*\n\n        int s =n/2,e=n-1;\n\n        while (s<=e&&e<=n-1)\n\n        {\n\n            int mid =s+e/2;\n\n\n\n            if (arr[mid]==arr[n/2])\n\n            {\n\n                s=mid;\n\n                num +=mid -s;\n\n            }\n\n            else\n\n                e=mid-1;\n\n        }\n\n        */\n\n\n\n\n\n\n\n\n\nconst int N = 1e5 + 5;\n\n\n\nvector<int> adj[N];\n\nbool visited[N];\n\nint nodesNum;\n\nvoid dfs(int node)\n\n{\n\n   if (visited[node])\n\n       return;\n\n   visited[node] = true;\n\n   for (int child: adj[node])\n\n       dfs(child);\n\n}\n\n\n\nint main()\n\n{\n\n   int n;\n\n   cin>>n;\n\n   if (n%2==0)\n\n    cout<<n/2;\n\n   else \n\n    cout<<n/2+1;\n\n   return 0;\n\n}\n\n\n\n\n",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\nint main()\n\n{\n\n    int n;\n\n    scanf(\"%d\",&n);\n\n    printf(\"%d\\n\",(n+1)/2);\n\n    return 0;\n\n}"
    },
    {
        "id": "325",
        "source_code": "#include <iostream>\n\n#define ll long long\n\nusing namespace std;\n\n\n\nint main()\n\n{ ll n;\n\ncin>>n;\n\nif(n%2==0)\n\n    cout << n/2;\n\nelse\n\n    cout << (n/2)+1 << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\nint main()\n\n{\n\n    int n;\n\n    scanf(\"%d\",&n);\n\n    printf(\"%d\\n\",(n+1)/2);\n\n    return 0;\n\n}"
    },
    {
        "id": "326",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    cin>>n;\n\n    if(n%2==0){\n\n        cout<<n/2;\n\n    }\n\n    else{\n\n        cout<<n/2+1;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\nint main()\n\n{\n\n    int n;\n\n    scanf(\"%d\",&n);\n\n    printf(\"%d\\n\",(n+1)/2);\n\n    return 0;\n\n}"
    },
    {
        "id": "327",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tcout<<(n+1)/2;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\nint main()\n\n{\n\n    int n;\n\n    scanf(\"%d\",&n);\n\n    printf(\"%d\\n\",(n+1)/2);\n\n    return 0;\n\n}"
    },
    {
        "id": "328",
        "source_code": "#include <bits/stdc++.h>\n\n\n\n#define ll long long\n\n#define ld long double\n\n#define ull unsigned long long\n\n#define endl \"\\n\"\n\n#define MohamedMotaz ios::sync_with_stdio(0); cin.tie(0); ios_base::sync_with_stdio(0);\n\n\n\nusing namespace std;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nint main()\n\n{\n\n\tMohamedMotaz;\n\n\tll x;\n\n\tcin >> x;\n\n\tcout << ceil(x / 2.0);\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n  int n;\n\n  scanf(\"%d\", &n);\n\n  printf(\"%d\", (n - 1) / 2 + 1);\n\n  return 0;\n\n}"
    },
    {
        "id": "329",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;   \n\n\n\nint main()\n\n{\n\n    ll num;\n\n    cin>>num;\n\n    cout<<num/2 + num %2;\n\n    return 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n  int n;\n\n  scanf(\"%d\", &n);\n\n  printf(\"%d\", (n - 1) / 2 + 1);\n\n  return 0;\n\n}"
    },
    {
        "id": "330",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n/*\n\n#define mod 7\n\ntypedef long long ll;\n\n\n\nll fact[1000006], inv[1000006];\n\n\n\nll fp(ll base, ll exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    ll ans = fp(base, exp / 2);\n\n    ans = (ans * ans) % mod;\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base % mod)) % mod;\n\n    return ans;\n\n}\n\n\n\nvoid calcFacAndInv(ll n)\n\n{\n\n    fact[0] = inv[0] = 1;\n\n    for (ll i = 1; i <= n; i++)\n\n    {\n\n        fact[i] = (i * fact[i - 1]) % mod;\n\n        inv[i] = fp(fact[i], mod - 2);\n\n    }\n\n}\n\n\n\nll ncr(ll n, ll r)\n\n{\n\n    return ((fact[n] * inv[r]) % mod * inv[n - r]) % mod;\n\n}\n\n\n\nll npr(ll n, ll r)\n\n{\n\n    return (fact[n] * inv[n - r]) % mod;\n\n}\n\n\n\nint main()\n\n{\n\n    calcFacAndInv(100000);\n\n     cout<<inv[3];\n\n    return 0;\n\n}\n\n*/\n\n\n\n\n\n// GCD\n\n\n\nint gcd(long long a,long long b)\n\n{\n\n    if (b==0)\n\n        return a;\n\n    return gcd (b,a%b);\n\n}\n\n//fast power\n\n/*\n\n#define mod 1000000007\n\nlong long fp(long long  base, long long exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    long long  ans = fp(base, exp / 2);\n\n    ans = (ans * ans);\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base )) ;\n\n    return ans;\n\n}\n\n*/\n\n//prime factoriation\n\n/*\n\nset<int >s;\n\nbool prime factorization (int x)\n\n{\n\n    for (int j=2; j*j<=x; ++j)\n\n    {\n\n        while (x%j==0)\n\n        {\n\n            s.insert(j);\n\n            x/=j;\n\n        }\n\n    }\n\n    if (x>1)\n\n    {\n\n        s.insert(x);\n\n    }\n\n    if (s.size()==2)\n\n        return true ;\n\n    else\n\n        return false ;\n\n}\n\n\n\n#define ll long long\n\nint a,b,q,p,n;\n\nint countDivisorss(int x,int y)\n\n{\n\n    ll cnt = 0;\n\n    for (int i = min(x,y); i <= sqrt(n); i++)\n\n    {\n\n        if (x % i == 0&&y%i==0)\n\n        {\n\n            if (x / i == i||y / i == i)\n\n                cnt++;\n\n\n\n            else\n\n                cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\nint countDivisors(int x)\n\n{\n\n    ll cnt = 0;\n\n    int tmp=n;\n\n    if (n-x>10000000)  tmp=sqrt(n);\n\n    for (int i = x; i <= tmp; i++)\n\n    {\n\n        if (x % i == 0)\n\n        {\n\n         if (x/i==i)\n\n            cnt++;\n\n         else\n\n            cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\n*/\n\n\n\n/*\n\n        int s =n/2,e=n-1;\n\n        while (s<=e&&e<=n-1)\n\n        {\n\n            int mid =s+e/2;\n\n\n\n            if (arr[mid]==arr[n/2])\n\n            {\n\n                s=mid;\n\n                num +=mid -s;\n\n            }\n\n            else\n\n                e=mid-1;\n\n        }\n\n        */\n\n\n\n\n\n\n\n\n\nconst int N = 1e5 + 5;\n\n\n\nvector<int> adj[N];\n\nbool visited[N];\n\nint nodesNum;\n\nvoid dfs(int node)\n\n{\n\n   if (visited[node])\n\n       return;\n\n   visited[node] = true;\n\n   for (int child: adj[node])\n\n       dfs(child);\n\n}\n\n\n\nint main()\n\n{\n\n   int n;\n\n   cin>>n;\n\n   if (n%2==0)\n\n    cout<<n/2;\n\n   else \n\n    cout<<n/2+1;\n\n   return 0;\n\n}\n\n\n\n\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n  int n;\n\n  scanf(\"%d\", &n);\n\n  printf(\"%d\", (n - 1) / 2 + 1);\n\n  return 0;\n\n}"
    },
    {
        "id": "331",
        "source_code": "#include <iostream>\n\n#define ll long long\n\nusing namespace std;\n\n\n\nint main()\n\n{ ll n;\n\ncin>>n;\n\nif(n%2==0)\n\n    cout << n/2;\n\nelse\n\n    cout << (n/2)+1 << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n  int n;\n\n  scanf(\"%d\", &n);\n\n  printf(\"%d\", (n - 1) / 2 + 1);\n\n  return 0;\n\n}"
    },
    {
        "id": "332",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    cin>>n;\n\n    if(n%2==0){\n\n        cout<<n/2;\n\n    }\n\n    else{\n\n        cout<<n/2+1;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n  int n;\n\n  scanf(\"%d\", &n);\n\n  printf(\"%d\", (n - 1) / 2 + 1);\n\n  return 0;\n\n}"
    },
    {
        "id": "333",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tcout<<(n+1)/2;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n  int n;\n\n  scanf(\"%d\", &n);\n\n  printf(\"%d\", (n - 1) / 2 + 1);\n\n  return 0;\n\n}"
    },
    {
        "id": "334",
        "source_code": "#include <bits/stdc++.h>\n\n\n\n#define ll long long\n\n#define ld long double\n\n#define ull unsigned long long\n\n#define endl \"\\n\"\n\n#define MohamedMotaz ios::sync_with_stdio(0); cin.tie(0); ios_base::sync_with_stdio(0);\n\n\n\nusing namespace std;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nint main()\n\n{\n\n\tMohamedMotaz;\n\n\tll x;\n\n\tcin >> x;\n\n\tcout << ceil(x / 2.0);\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include<stdio.h>\n\n\tint main(){\n\n\t\tint N,hasil;\n\n\t\t\n\n\t\tscanf (\"%d\", &N);\n\n\t\t\n\n\t\tif (N % 2 == 0){\n\n\t\t\thasil = N/2;\n\n\t\t\tprintf(\"%d\",hasil);\n\n\t\t}else{\n\n\t\t\thasil = N/2+1;\n\n\t\t\tprintf (\"%d\",hasil);\n\n\t\t}\n\n\t\treturn 0;\n\n\t}\n"
    },
    {
        "id": "335",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;   \n\n\n\nint main()\n\n{\n\n    ll num;\n\n    cin>>num;\n\n    cout<<num/2 + num %2;\n\n    return 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\n\tint main(){\n\n\t\tint N,hasil;\n\n\t\t\n\n\t\tscanf (\"%d\", &N);\n\n\t\t\n\n\t\tif (N % 2 == 0){\n\n\t\t\thasil = N/2;\n\n\t\t\tprintf(\"%d\",hasil);\n\n\t\t}else{\n\n\t\t\thasil = N/2+1;\n\n\t\t\tprintf (\"%d\",hasil);\n\n\t\t}\n\n\t\treturn 0;\n\n\t}\n"
    },
    {
        "id": "336",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n/*\n\n#define mod 7\n\ntypedef long long ll;\n\n\n\nll fact[1000006], inv[1000006];\n\n\n\nll fp(ll base, ll exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    ll ans = fp(base, exp / 2);\n\n    ans = (ans * ans) % mod;\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base % mod)) % mod;\n\n    return ans;\n\n}\n\n\n\nvoid calcFacAndInv(ll n)\n\n{\n\n    fact[0] = inv[0] = 1;\n\n    for (ll i = 1; i <= n; i++)\n\n    {\n\n        fact[i] = (i * fact[i - 1]) % mod;\n\n        inv[i] = fp(fact[i], mod - 2);\n\n    }\n\n}\n\n\n\nll ncr(ll n, ll r)\n\n{\n\n    return ((fact[n] * inv[r]) % mod * inv[n - r]) % mod;\n\n}\n\n\n\nll npr(ll n, ll r)\n\n{\n\n    return (fact[n] * inv[n - r]) % mod;\n\n}\n\n\n\nint main()\n\n{\n\n    calcFacAndInv(100000);\n\n     cout<<inv[3];\n\n    return 0;\n\n}\n\n*/\n\n\n\n\n\n// GCD\n\n\n\nint gcd(long long a,long long b)\n\n{\n\n    if (b==0)\n\n        return a;\n\n    return gcd (b,a%b);\n\n}\n\n//fast power\n\n/*\n\n#define mod 1000000007\n\nlong long fp(long long  base, long long exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    long long  ans = fp(base, exp / 2);\n\n    ans = (ans * ans);\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base )) ;\n\n    return ans;\n\n}\n\n*/\n\n//prime factoriation\n\n/*\n\nset<int >s;\n\nbool prime factorization (int x)\n\n{\n\n    for (int j=2; j*j<=x; ++j)\n\n    {\n\n        while (x%j==0)\n\n        {\n\n            s.insert(j);\n\n            x/=j;\n\n        }\n\n    }\n\n    if (x>1)\n\n    {\n\n        s.insert(x);\n\n    }\n\n    if (s.size()==2)\n\n        return true ;\n\n    else\n\n        return false ;\n\n}\n\n\n\n#define ll long long\n\nint a,b,q,p,n;\n\nint countDivisorss(int x,int y)\n\n{\n\n    ll cnt = 0;\n\n    for (int i = min(x,y); i <= sqrt(n); i++)\n\n    {\n\n        if (x % i == 0&&y%i==0)\n\n        {\n\n            if (x / i == i||y / i == i)\n\n                cnt++;\n\n\n\n            else\n\n                cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\nint countDivisors(int x)\n\n{\n\n    ll cnt = 0;\n\n    int tmp=n;\n\n    if (n-x>10000000)  tmp=sqrt(n);\n\n    for (int i = x; i <= tmp; i++)\n\n    {\n\n        if (x % i == 0)\n\n        {\n\n         if (x/i==i)\n\n            cnt++;\n\n         else\n\n            cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\n*/\n\n\n\n/*\n\n        int s =n/2,e=n-1;\n\n        while (s<=e&&e<=n-1)\n\n        {\n\n            int mid =s+e/2;\n\n\n\n            if (arr[mid]==arr[n/2])\n\n            {\n\n                s=mid;\n\n                num +=mid -s;\n\n            }\n\n            else\n\n                e=mid-1;\n\n        }\n\n        */\n\n\n\n\n\n\n\n\n\nconst int N = 1e5 + 5;\n\n\n\nvector<int> adj[N];\n\nbool visited[N];\n\nint nodesNum;\n\nvoid dfs(int node)\n\n{\n\n   if (visited[node])\n\n       return;\n\n   visited[node] = true;\n\n   for (int child: adj[node])\n\n       dfs(child);\n\n}\n\n\n\nint main()\n\n{\n\n   int n;\n\n   cin>>n;\n\n   if (n%2==0)\n\n    cout<<n/2;\n\n   else \n\n    cout<<n/2+1;\n\n   return 0;\n\n}\n\n\n\n\n",
        "optimized_code": "#include<stdio.h>\n\n\tint main(){\n\n\t\tint N,hasil;\n\n\t\t\n\n\t\tscanf (\"%d\", &N);\n\n\t\t\n\n\t\tif (N % 2 == 0){\n\n\t\t\thasil = N/2;\n\n\t\t\tprintf(\"%d\",hasil);\n\n\t\t}else{\n\n\t\t\thasil = N/2+1;\n\n\t\t\tprintf (\"%d\",hasil);\n\n\t\t}\n\n\t\treturn 0;\n\n\t}\n"
    },
    {
        "id": "337",
        "source_code": "#include <iostream>\n\n#define ll long long\n\nusing namespace std;\n\n\n\nint main()\n\n{ ll n;\n\ncin>>n;\n\nif(n%2==0)\n\n    cout << n/2;\n\nelse\n\n    cout << (n/2)+1 << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\n\tint main(){\n\n\t\tint N,hasil;\n\n\t\t\n\n\t\tscanf (\"%d\", &N);\n\n\t\t\n\n\t\tif (N % 2 == 0){\n\n\t\t\thasil = N/2;\n\n\t\t\tprintf(\"%d\",hasil);\n\n\t\t}else{\n\n\t\t\thasil = N/2+1;\n\n\t\t\tprintf (\"%d\",hasil);\n\n\t\t}\n\n\t\treturn 0;\n\n\t}\n"
    },
    {
        "id": "338",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    cin>>n;\n\n    if(n%2==0){\n\n        cout<<n/2;\n\n    }\n\n    else{\n\n        cout<<n/2+1;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\n\tint main(){\n\n\t\tint N,hasil;\n\n\t\t\n\n\t\tscanf (\"%d\", &N);\n\n\t\t\n\n\t\tif (N % 2 == 0){\n\n\t\t\thasil = N/2;\n\n\t\t\tprintf(\"%d\",hasil);\n\n\t\t}else{\n\n\t\t\thasil = N/2+1;\n\n\t\t\tprintf (\"%d\",hasil);\n\n\t\t}\n\n\t\treturn 0;\n\n\t}\n"
    },
    {
        "id": "339",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tcout<<(n+1)/2;\n\n}",
        "optimized_code": "#include<stdio.h>\n\n\tint main(){\n\n\t\tint N,hasil;\n\n\t\t\n\n\t\tscanf (\"%d\", &N);\n\n\t\t\n\n\t\tif (N % 2 == 0){\n\n\t\t\thasil = N/2;\n\n\t\t\tprintf(\"%d\",hasil);\n\n\t\t}else{\n\n\t\t\thasil = N/2+1;\n\n\t\t\tprintf (\"%d\",hasil);\n\n\t\t}\n\n\t\treturn 0;\n\n\t}\n"
    },
    {
        "id": "340",
        "source_code": "#include <bits/stdc++.h>\n\n\n\n#define ll long long\n\n#define ld long double\n\n#define ull unsigned long long\n\n#define endl \"\\n\"\n\n#define MohamedMotaz ios::sync_with_stdio(0); cin.tie(0); ios_base::sync_with_stdio(0);\n\n\n\nusing namespace std;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nint main()\n\n{\n\n\tMohamedMotaz;\n\n\tll x;\n\n\tcin >> x;\n\n\tcout << ceil(x / 2.0);\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\t\n\n\tint N, pages;\n\n\tscanf(\"%d\", &N);\n\n\tint papers = (N % 2 == 0) ? (N / 2) : ((N / 2) + 1);\n\n\tprintf(\"%d\\n\", papers);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "341",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;   \n\n\n\nint main()\n\n{\n\n    ll num;\n\n    cin>>num;\n\n    cout<<num/2 + num %2;\n\n    return 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\t\n\n\tint N, pages;\n\n\tscanf(\"%d\", &N);\n\n\tint papers = (N % 2 == 0) ? (N / 2) : ((N / 2) + 1);\n\n\tprintf(\"%d\\n\", papers);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "342",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n/*\n\n#define mod 7\n\ntypedef long long ll;\n\n\n\nll fact[1000006], inv[1000006];\n\n\n\nll fp(ll base, ll exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    ll ans = fp(base, exp / 2);\n\n    ans = (ans * ans) % mod;\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base % mod)) % mod;\n\n    return ans;\n\n}\n\n\n\nvoid calcFacAndInv(ll n)\n\n{\n\n    fact[0] = inv[0] = 1;\n\n    for (ll i = 1; i <= n; i++)\n\n    {\n\n        fact[i] = (i * fact[i - 1]) % mod;\n\n        inv[i] = fp(fact[i], mod - 2);\n\n    }\n\n}\n\n\n\nll ncr(ll n, ll r)\n\n{\n\n    return ((fact[n] * inv[r]) % mod * inv[n - r]) % mod;\n\n}\n\n\n\nll npr(ll n, ll r)\n\n{\n\n    return (fact[n] * inv[n - r]) % mod;\n\n}\n\n\n\nint main()\n\n{\n\n    calcFacAndInv(100000);\n\n     cout<<inv[3];\n\n    return 0;\n\n}\n\n*/\n\n\n\n\n\n// GCD\n\n\n\nint gcd(long long a,long long b)\n\n{\n\n    if (b==0)\n\n        return a;\n\n    return gcd (b,a%b);\n\n}\n\n//fast power\n\n/*\n\n#define mod 1000000007\n\nlong long fp(long long  base, long long exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    long long  ans = fp(base, exp / 2);\n\n    ans = (ans * ans);\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base )) ;\n\n    return ans;\n\n}\n\n*/\n\n//prime factoriation\n\n/*\n\nset<int >s;\n\nbool prime factorization (int x)\n\n{\n\n    for (int j=2; j*j<=x; ++j)\n\n    {\n\n        while (x%j==0)\n\n        {\n\n            s.insert(j);\n\n            x/=j;\n\n        }\n\n    }\n\n    if (x>1)\n\n    {\n\n        s.insert(x);\n\n    }\n\n    if (s.size()==2)\n\n        return true ;\n\n    else\n\n        return false ;\n\n}\n\n\n\n#define ll long long\n\nint a,b,q,p,n;\n\nint countDivisorss(int x,int y)\n\n{\n\n    ll cnt = 0;\n\n    for (int i = min(x,y); i <= sqrt(n); i++)\n\n    {\n\n        if (x % i == 0&&y%i==0)\n\n        {\n\n            if (x / i == i||y / i == i)\n\n                cnt++;\n\n\n\n            else\n\n                cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\nint countDivisors(int x)\n\n{\n\n    ll cnt = 0;\n\n    int tmp=n;\n\n    if (n-x>10000000)  tmp=sqrt(n);\n\n    for (int i = x; i <= tmp; i++)\n\n    {\n\n        if (x % i == 0)\n\n        {\n\n         if (x/i==i)\n\n            cnt++;\n\n         else\n\n            cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\n*/\n\n\n\n/*\n\n        int s =n/2,e=n-1;\n\n        while (s<=e&&e<=n-1)\n\n        {\n\n            int mid =s+e/2;\n\n\n\n            if (arr[mid]==arr[n/2])\n\n            {\n\n                s=mid;\n\n                num +=mid -s;\n\n            }\n\n            else\n\n                e=mid-1;\n\n        }\n\n        */\n\n\n\n\n\n\n\n\n\nconst int N = 1e5 + 5;\n\n\n\nvector<int> adj[N];\n\nbool visited[N];\n\nint nodesNum;\n\nvoid dfs(int node)\n\n{\n\n   if (visited[node])\n\n       return;\n\n   visited[node] = true;\n\n   for (int child: adj[node])\n\n       dfs(child);\n\n}\n\n\n\nint main()\n\n{\n\n   int n;\n\n   cin>>n;\n\n   if (n%2==0)\n\n    cout<<n/2;\n\n   else \n\n    cout<<n/2+1;\n\n   return 0;\n\n}\n\n\n\n\n",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\t\n\n\tint N, pages;\n\n\tscanf(\"%d\", &N);\n\n\tint papers = (N % 2 == 0) ? (N / 2) : ((N / 2) + 1);\n\n\tprintf(\"%d\\n\", papers);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "343",
        "source_code": "#include <iostream>\n\n#define ll long long\n\nusing namespace std;\n\n\n\nint main()\n\n{ ll n;\n\ncin>>n;\n\nif(n%2==0)\n\n    cout << n/2;\n\nelse\n\n    cout << (n/2)+1 << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\t\n\n\tint N, pages;\n\n\tscanf(\"%d\", &N);\n\n\tint papers = (N % 2 == 0) ? (N / 2) : ((N / 2) + 1);\n\n\tprintf(\"%d\\n\", papers);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "344",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    cin>>n;\n\n    if(n%2==0){\n\n        cout<<n/2;\n\n    }\n\n    else{\n\n        cout<<n/2+1;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\t\n\n\tint N, pages;\n\n\tscanf(\"%d\", &N);\n\n\tint papers = (N % 2 == 0) ? (N / 2) : ((N / 2) + 1);\n\n\tprintf(\"%d\\n\", papers);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "345",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tcout<<(n+1)/2;\n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main(){\n\n\t\n\n\tint N, pages;\n\n\tscanf(\"%d\", &N);\n\n\tint papers = (N % 2 == 0) ? (N / 2) : ((N / 2) + 1);\n\n\tprintf(\"%d\\n\", papers);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "346",
        "source_code": "#include <bits/stdc++.h>\n\n\n\n#define ll long long\n\n#define ld long double\n\n#define ull unsigned long long\n\n#define endl \"\\n\"\n\n#define MohamedMotaz ios::sync_with_stdio(0); cin.tie(0); ios_base::sync_with_stdio(0);\n\n\n\nusing namespace std;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nint main()\n\n{\n\n\tMohamedMotaz;\n\n\tll x;\n\n\tcin >> x;\n\n\tcout << ceil(x / 2.0);\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint a, b;\n\n\tscanf(\"%d\", &a);\n\n\t\n\n\tb = a / 2;\n\n\t\n\n\tif(a % 2 == 1) {\n\n\t\tprintf(\"%d\", b + 1);\n\n\t} else {\n\n\t\tprintf(\"%d\", b);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "347",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;   \n\n\n\nint main()\n\n{\n\n    ll num;\n\n    cin>>num;\n\n    cout<<num/2 + num %2;\n\n    return 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint a, b;\n\n\tscanf(\"%d\", &a);\n\n\t\n\n\tb = a / 2;\n\n\t\n\n\tif(a % 2 == 1) {\n\n\t\tprintf(\"%d\", b + 1);\n\n\t} else {\n\n\t\tprintf(\"%d\", b);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "348",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n/*\n\n#define mod 7\n\ntypedef long long ll;\n\n\n\nll fact[1000006], inv[1000006];\n\n\n\nll fp(ll base, ll exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    ll ans = fp(base, exp / 2);\n\n    ans = (ans * ans) % mod;\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base % mod)) % mod;\n\n    return ans;\n\n}\n\n\n\nvoid calcFacAndInv(ll n)\n\n{\n\n    fact[0] = inv[0] = 1;\n\n    for (ll i = 1; i <= n; i++)\n\n    {\n\n        fact[i] = (i * fact[i - 1]) % mod;\n\n        inv[i] = fp(fact[i], mod - 2);\n\n    }\n\n}\n\n\n\nll ncr(ll n, ll r)\n\n{\n\n    return ((fact[n] * inv[r]) % mod * inv[n - r]) % mod;\n\n}\n\n\n\nll npr(ll n, ll r)\n\n{\n\n    return (fact[n] * inv[n - r]) % mod;\n\n}\n\n\n\nint main()\n\n{\n\n    calcFacAndInv(100000);\n\n     cout<<inv[3];\n\n    return 0;\n\n}\n\n*/\n\n\n\n\n\n// GCD\n\n\n\nint gcd(long long a,long long b)\n\n{\n\n    if (b==0)\n\n        return a;\n\n    return gcd (b,a%b);\n\n}\n\n//fast power\n\n/*\n\n#define mod 1000000007\n\nlong long fp(long long  base, long long exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    long long  ans = fp(base, exp / 2);\n\n    ans = (ans * ans);\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base )) ;\n\n    return ans;\n\n}\n\n*/\n\n//prime factoriation\n\n/*\n\nset<int >s;\n\nbool prime factorization (int x)\n\n{\n\n    for (int j=2; j*j<=x; ++j)\n\n    {\n\n        while (x%j==0)\n\n        {\n\n            s.insert(j);\n\n            x/=j;\n\n        }\n\n    }\n\n    if (x>1)\n\n    {\n\n        s.insert(x);\n\n    }\n\n    if (s.size()==2)\n\n        return true ;\n\n    else\n\n        return false ;\n\n}\n\n\n\n#define ll long long\n\nint a,b,q,p,n;\n\nint countDivisorss(int x,int y)\n\n{\n\n    ll cnt = 0;\n\n    for (int i = min(x,y); i <= sqrt(n); i++)\n\n    {\n\n        if (x % i == 0&&y%i==0)\n\n        {\n\n            if (x / i == i||y / i == i)\n\n                cnt++;\n\n\n\n            else\n\n                cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\nint countDivisors(int x)\n\n{\n\n    ll cnt = 0;\n\n    int tmp=n;\n\n    if (n-x>10000000)  tmp=sqrt(n);\n\n    for (int i = x; i <= tmp; i++)\n\n    {\n\n        if (x % i == 0)\n\n        {\n\n         if (x/i==i)\n\n            cnt++;\n\n         else\n\n            cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\n*/\n\n\n\n/*\n\n        int s =n/2,e=n-1;\n\n        while (s<=e&&e<=n-1)\n\n        {\n\n            int mid =s+e/2;\n\n\n\n            if (arr[mid]==arr[n/2])\n\n            {\n\n                s=mid;\n\n                num +=mid -s;\n\n            }\n\n            else\n\n                e=mid-1;\n\n        }\n\n        */\n\n\n\n\n\n\n\n\n\nconst int N = 1e5 + 5;\n\n\n\nvector<int> adj[N];\n\nbool visited[N];\n\nint nodesNum;\n\nvoid dfs(int node)\n\n{\n\n   if (visited[node])\n\n       return;\n\n   visited[node] = true;\n\n   for (int child: adj[node])\n\n       dfs(child);\n\n}\n\n\n\nint main()\n\n{\n\n   int n;\n\n   cin>>n;\n\n   if (n%2==0)\n\n    cout<<n/2;\n\n   else \n\n    cout<<n/2+1;\n\n   return 0;\n\n}\n\n\n\n\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint a, b;\n\n\tscanf(\"%d\", &a);\n\n\t\n\n\tb = a / 2;\n\n\t\n\n\tif(a % 2 == 1) {\n\n\t\tprintf(\"%d\", b + 1);\n\n\t} else {\n\n\t\tprintf(\"%d\", b);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "349",
        "source_code": "#include <iostream>\n\n#define ll long long\n\nusing namespace std;\n\n\n\nint main()\n\n{ ll n;\n\ncin>>n;\n\nif(n%2==0)\n\n    cout << n/2;\n\nelse\n\n    cout << (n/2)+1 << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint a, b;\n\n\tscanf(\"%d\", &a);\n\n\t\n\n\tb = a / 2;\n\n\t\n\n\tif(a % 2 == 1) {\n\n\t\tprintf(\"%d\", b + 1);\n\n\t} else {\n\n\t\tprintf(\"%d\", b);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "350",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    cin>>n;\n\n    if(n%2==0){\n\n        cout<<n/2;\n\n    }\n\n    else{\n\n        cout<<n/2+1;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint a, b;\n\n\tscanf(\"%d\", &a);\n\n\t\n\n\tb = a / 2;\n\n\t\n\n\tif(a % 2 == 1) {\n\n\t\tprintf(\"%d\", b + 1);\n\n\t} else {\n\n\t\tprintf(\"%d\", b);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "351",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tcout<<(n+1)/2;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint a, b;\n\n\tscanf(\"%d\", &a);\n\n\t\n\n\tb = a / 2;\n\n\t\n\n\tif(a % 2 == 1) {\n\n\t\tprintf(\"%d\", b + 1);\n\n\t} else {\n\n\t\tprintf(\"%d\", b);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "352",
        "source_code": "#include <bits/stdc++.h>\n\n\n\n#define ll long long\n\n#define ld long double\n\n#define ull unsigned long long\n\n#define endl \"\\n\"\n\n#define MohamedMotaz ios::sync_with_stdio(0); cin.tie(0); ios_base::sync_with_stdio(0);\n\n\n\nusing namespace std;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nint main()\n\n{\n\n\tMohamedMotaz;\n\n\tll x;\n\n\tcin >> x;\n\n\tcout << ceil(x / 2.0);\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include <stdio.h>\n\nint main()\n\n{\n\n\t\n\n\tint a;\n\n\tscanf(\"%d\", &a);\n\n\t\n\n\tif(a%2==0) {\n\n\t\tprintf(\"%d\",a/2);\n\n\t}\n\n\telse if(a%2 !=0) {\n\n\t\tprintf(\"%d\",(a/2)+1);\n\n\t}\n\n\t\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "353",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;   \n\n\n\nint main()\n\n{\n\n    ll num;\n\n    cin>>num;\n\n    cout<<num/2 + num %2;\n\n    return 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main()\n\n{\n\n\t\n\n\tint a;\n\n\tscanf(\"%d\", &a);\n\n\t\n\n\tif(a%2==0) {\n\n\t\tprintf(\"%d\",a/2);\n\n\t}\n\n\telse if(a%2 !=0) {\n\n\t\tprintf(\"%d\",(a/2)+1);\n\n\t}\n\n\t\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "354",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n/*\n\n#define mod 7\n\ntypedef long long ll;\n\n\n\nll fact[1000006], inv[1000006];\n\n\n\nll fp(ll base, ll exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    ll ans = fp(base, exp / 2);\n\n    ans = (ans * ans) % mod;\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base % mod)) % mod;\n\n    return ans;\n\n}\n\n\n\nvoid calcFacAndInv(ll n)\n\n{\n\n    fact[0] = inv[0] = 1;\n\n    for (ll i = 1; i <= n; i++)\n\n    {\n\n        fact[i] = (i * fact[i - 1]) % mod;\n\n        inv[i] = fp(fact[i], mod - 2);\n\n    }\n\n}\n\n\n\nll ncr(ll n, ll r)\n\n{\n\n    return ((fact[n] * inv[r]) % mod * inv[n - r]) % mod;\n\n}\n\n\n\nll npr(ll n, ll r)\n\n{\n\n    return (fact[n] * inv[n - r]) % mod;\n\n}\n\n\n\nint main()\n\n{\n\n    calcFacAndInv(100000);\n\n     cout<<inv[3];\n\n    return 0;\n\n}\n\n*/\n\n\n\n\n\n// GCD\n\n\n\nint gcd(long long a,long long b)\n\n{\n\n    if (b==0)\n\n        return a;\n\n    return gcd (b,a%b);\n\n}\n\n//fast power\n\n/*\n\n#define mod 1000000007\n\nlong long fp(long long  base, long long exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    long long  ans = fp(base, exp / 2);\n\n    ans = (ans * ans);\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base )) ;\n\n    return ans;\n\n}\n\n*/\n\n//prime factoriation\n\n/*\n\nset<int >s;\n\nbool prime factorization (int x)\n\n{\n\n    for (int j=2; j*j<=x; ++j)\n\n    {\n\n        while (x%j==0)\n\n        {\n\n            s.insert(j);\n\n            x/=j;\n\n        }\n\n    }\n\n    if (x>1)\n\n    {\n\n        s.insert(x);\n\n    }\n\n    if (s.size()==2)\n\n        return true ;\n\n    else\n\n        return false ;\n\n}\n\n\n\n#define ll long long\n\nint a,b,q,p,n;\n\nint countDivisorss(int x,int y)\n\n{\n\n    ll cnt = 0;\n\n    for (int i = min(x,y); i <= sqrt(n); i++)\n\n    {\n\n        if (x % i == 0&&y%i==0)\n\n        {\n\n            if (x / i == i||y / i == i)\n\n                cnt++;\n\n\n\n            else\n\n                cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\nint countDivisors(int x)\n\n{\n\n    ll cnt = 0;\n\n    int tmp=n;\n\n    if (n-x>10000000)  tmp=sqrt(n);\n\n    for (int i = x; i <= tmp; i++)\n\n    {\n\n        if (x % i == 0)\n\n        {\n\n         if (x/i==i)\n\n            cnt++;\n\n         else\n\n            cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\n*/\n\n\n\n/*\n\n        int s =n/2,e=n-1;\n\n        while (s<=e&&e<=n-1)\n\n        {\n\n            int mid =s+e/2;\n\n\n\n            if (arr[mid]==arr[n/2])\n\n            {\n\n                s=mid;\n\n                num +=mid -s;\n\n            }\n\n            else\n\n                e=mid-1;\n\n        }\n\n        */\n\n\n\n\n\n\n\n\n\nconst int N = 1e5 + 5;\n\n\n\nvector<int> adj[N];\n\nbool visited[N];\n\nint nodesNum;\n\nvoid dfs(int node)\n\n{\n\n   if (visited[node])\n\n       return;\n\n   visited[node] = true;\n\n   for (int child: adj[node])\n\n       dfs(child);\n\n}\n\n\n\nint main()\n\n{\n\n   int n;\n\n   cin>>n;\n\n   if (n%2==0)\n\n    cout<<n/2;\n\n   else \n\n    cout<<n/2+1;\n\n   return 0;\n\n}\n\n\n\n\n",
        "optimized_code": "#include <stdio.h>\n\nint main()\n\n{\n\n\t\n\n\tint a;\n\n\tscanf(\"%d\", &a);\n\n\t\n\n\tif(a%2==0) {\n\n\t\tprintf(\"%d\",a/2);\n\n\t}\n\n\telse if(a%2 !=0) {\n\n\t\tprintf(\"%d\",(a/2)+1);\n\n\t}\n\n\t\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "355",
        "source_code": "#include <iostream>\n\n#define ll long long\n\nusing namespace std;\n\n\n\nint main()\n\n{ ll n;\n\ncin>>n;\n\nif(n%2==0)\n\n    cout << n/2;\n\nelse\n\n    cout << (n/2)+1 << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\nint main()\n\n{\n\n\t\n\n\tint a;\n\n\tscanf(\"%d\", &a);\n\n\t\n\n\tif(a%2==0) {\n\n\t\tprintf(\"%d\",a/2);\n\n\t}\n\n\telse if(a%2 !=0) {\n\n\t\tprintf(\"%d\",(a/2)+1);\n\n\t}\n\n\t\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "356",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    cin>>n;\n\n    if(n%2==0){\n\n        cout<<n/2;\n\n    }\n\n    else{\n\n        cout<<n/2+1;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\nint main()\n\n{\n\n\t\n\n\tint a;\n\n\tscanf(\"%d\", &a);\n\n\t\n\n\tif(a%2==0) {\n\n\t\tprintf(\"%d\",a/2);\n\n\t}\n\n\telse if(a%2 !=0) {\n\n\t\tprintf(\"%d\",(a/2)+1);\n\n\t}\n\n\t\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "357",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tcout<<(n+1)/2;\n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main()\n\n{\n\n\t\n\n\tint a;\n\n\tscanf(\"%d\", &a);\n\n\t\n\n\tif(a%2==0) {\n\n\t\tprintf(\"%d\",a/2);\n\n\t}\n\n\telse if(a%2 !=0) {\n\n\t\tprintf(\"%d\",(a/2)+1);\n\n\t}\n\n\t\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "358",
        "source_code": "#include <bits/stdc++.h>\n\n\n\n#define ll long long\n\n#define ld long double\n\n#define ull unsigned long long\n\n#define endl \"\\n\"\n\n#define MohamedMotaz ios::sync_with_stdio(0); cin.tie(0); ios_base::sync_with_stdio(0);\n\n\n\nusing namespace std;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nint main()\n\n{\n\n\tMohamedMotaz;\n\n\tll x;\n\n\tcin >> x;\n\n\tcout << ceil(x / 2.0);\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main ()\n\n{\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\tif(N%2 == 0){\n\n\t\tprintf(\"%d\", N/2);\n\n\t}else{\n\n\t\tprintf(\"%d\", N/2+1);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "359",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;   \n\n\n\nint main()\n\n{\n\n    ll num;\n\n    cin>>num;\n\n    cout<<num/2 + num %2;\n\n    return 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main ()\n\n{\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\tif(N%2 == 0){\n\n\t\tprintf(\"%d\", N/2);\n\n\t}else{\n\n\t\tprintf(\"%d\", N/2+1);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "360",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n/*\n\n#define mod 7\n\ntypedef long long ll;\n\n\n\nll fact[1000006], inv[1000006];\n\n\n\nll fp(ll base, ll exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    ll ans = fp(base, exp / 2);\n\n    ans = (ans * ans) % mod;\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base % mod)) % mod;\n\n    return ans;\n\n}\n\n\n\nvoid calcFacAndInv(ll n)\n\n{\n\n    fact[0] = inv[0] = 1;\n\n    for (ll i = 1; i <= n; i++)\n\n    {\n\n        fact[i] = (i * fact[i - 1]) % mod;\n\n        inv[i] = fp(fact[i], mod - 2);\n\n    }\n\n}\n\n\n\nll ncr(ll n, ll r)\n\n{\n\n    return ((fact[n] * inv[r]) % mod * inv[n - r]) % mod;\n\n}\n\n\n\nll npr(ll n, ll r)\n\n{\n\n    return (fact[n] * inv[n - r]) % mod;\n\n}\n\n\n\nint main()\n\n{\n\n    calcFacAndInv(100000);\n\n     cout<<inv[3];\n\n    return 0;\n\n}\n\n*/\n\n\n\n\n\n// GCD\n\n\n\nint gcd(long long a,long long b)\n\n{\n\n    if (b==0)\n\n        return a;\n\n    return gcd (b,a%b);\n\n}\n\n//fast power\n\n/*\n\n#define mod 1000000007\n\nlong long fp(long long  base, long long exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    long long  ans = fp(base, exp / 2);\n\n    ans = (ans * ans);\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base )) ;\n\n    return ans;\n\n}\n\n*/\n\n//prime factoriation\n\n/*\n\nset<int >s;\n\nbool prime factorization (int x)\n\n{\n\n    for (int j=2; j*j<=x; ++j)\n\n    {\n\n        while (x%j==0)\n\n        {\n\n            s.insert(j);\n\n            x/=j;\n\n        }\n\n    }\n\n    if (x>1)\n\n    {\n\n        s.insert(x);\n\n    }\n\n    if (s.size()==2)\n\n        return true ;\n\n    else\n\n        return false ;\n\n}\n\n\n\n#define ll long long\n\nint a,b,q,p,n;\n\nint countDivisorss(int x,int y)\n\n{\n\n    ll cnt = 0;\n\n    for (int i = min(x,y); i <= sqrt(n); i++)\n\n    {\n\n        if (x % i == 0&&y%i==0)\n\n        {\n\n            if (x / i == i||y / i == i)\n\n                cnt++;\n\n\n\n            else\n\n                cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\nint countDivisors(int x)\n\n{\n\n    ll cnt = 0;\n\n    int tmp=n;\n\n    if (n-x>10000000)  tmp=sqrt(n);\n\n    for (int i = x; i <= tmp; i++)\n\n    {\n\n        if (x % i == 0)\n\n        {\n\n         if (x/i==i)\n\n            cnt++;\n\n         else\n\n            cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\n*/\n\n\n\n/*\n\n        int s =n/2,e=n-1;\n\n        while (s<=e&&e<=n-1)\n\n        {\n\n            int mid =s+e/2;\n\n\n\n            if (arr[mid]==arr[n/2])\n\n            {\n\n                s=mid;\n\n                num +=mid -s;\n\n            }\n\n            else\n\n                e=mid-1;\n\n        }\n\n        */\n\n\n\n\n\n\n\n\n\nconst int N = 1e5 + 5;\n\n\n\nvector<int> adj[N];\n\nbool visited[N];\n\nint nodesNum;\n\nvoid dfs(int node)\n\n{\n\n   if (visited[node])\n\n       return;\n\n   visited[node] = true;\n\n   for (int child: adj[node])\n\n       dfs(child);\n\n}\n\n\n\nint main()\n\n{\n\n   int n;\n\n   cin>>n;\n\n   if (n%2==0)\n\n    cout<<n/2;\n\n   else \n\n    cout<<n/2+1;\n\n   return 0;\n\n}\n\n\n\n\n",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main ()\n\n{\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\tif(N%2 == 0){\n\n\t\tprintf(\"%d\", N/2);\n\n\t}else{\n\n\t\tprintf(\"%d\", N/2+1);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "361",
        "source_code": "#include <iostream>\n\n#define ll long long\n\nusing namespace std;\n\n\n\nint main()\n\n{ ll n;\n\ncin>>n;\n\nif(n%2==0)\n\n    cout << n/2;\n\nelse\n\n    cout << (n/2)+1 << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main ()\n\n{\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\tif(N%2 == 0){\n\n\t\tprintf(\"%d\", N/2);\n\n\t}else{\n\n\t\tprintf(\"%d\", N/2+1);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "362",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    cin>>n;\n\n    if(n%2==0){\n\n        cout<<n/2;\n\n    }\n\n    else{\n\n        cout<<n/2+1;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main ()\n\n{\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\tif(N%2 == 0){\n\n\t\tprintf(\"%d\", N/2);\n\n\t}else{\n\n\t\tprintf(\"%d\", N/2+1);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "363",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tcout<<(n+1)/2;\n\n}",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main ()\n\n{\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\tif(N%2 == 0){\n\n\t\tprintf(\"%d\", N/2);\n\n\t}else{\n\n\t\tprintf(\"%d\", N/2+1);\n\n\t}\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "364",
        "source_code": "#include <bits/stdc++.h>\n\n\n\n#define ll long long\n\n#define ld long double\n\n#define ull unsigned long long\n\n#define endl \"\\n\"\n\n#define MohamedMotaz ios::sync_with_stdio(0); cin.tie(0); ios_base::sync_with_stdio(0);\n\n\n\nusing namespace std;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nint main()\n\n{\n\n\tMohamedMotaz;\n\n\tll x;\n\n\tcin >> x;\n\n\tcout << ceil(x / 2.0);\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint N;\n\n\t\n\n\tscanf(\"%d\",&N);\n\n\t\n\n\tif(N%2==0){\n\n\t\tprintf(\"%d\",N/2);\n\n\t}\n\n\telse{\n\n\t\tprintf(\"%d\",(N/2)+1);\n\n\t}\n\n}"
    },
    {
        "id": "365",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;   \n\n\n\nint main()\n\n{\n\n    ll num;\n\n    cin>>num;\n\n    cout<<num/2 + num %2;\n\n    return 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint N;\n\n\t\n\n\tscanf(\"%d\",&N);\n\n\t\n\n\tif(N%2==0){\n\n\t\tprintf(\"%d\",N/2);\n\n\t}\n\n\telse{\n\n\t\tprintf(\"%d\",(N/2)+1);\n\n\t}\n\n}"
    },
    {
        "id": "366",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n/*\n\n#define mod 7\n\ntypedef long long ll;\n\n\n\nll fact[1000006], inv[1000006];\n\n\n\nll fp(ll base, ll exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    ll ans = fp(base, exp / 2);\n\n    ans = (ans * ans) % mod;\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base % mod)) % mod;\n\n    return ans;\n\n}\n\n\n\nvoid calcFacAndInv(ll n)\n\n{\n\n    fact[0] = inv[0] = 1;\n\n    for (ll i = 1; i <= n; i++)\n\n    {\n\n        fact[i] = (i * fact[i - 1]) % mod;\n\n        inv[i] = fp(fact[i], mod - 2);\n\n    }\n\n}\n\n\n\nll ncr(ll n, ll r)\n\n{\n\n    return ((fact[n] * inv[r]) % mod * inv[n - r]) % mod;\n\n}\n\n\n\nll npr(ll n, ll r)\n\n{\n\n    return (fact[n] * inv[n - r]) % mod;\n\n}\n\n\n\nint main()\n\n{\n\n    calcFacAndInv(100000);\n\n     cout<<inv[3];\n\n    return 0;\n\n}\n\n*/\n\n\n\n\n\n// GCD\n\n\n\nint gcd(long long a,long long b)\n\n{\n\n    if (b==0)\n\n        return a;\n\n    return gcd (b,a%b);\n\n}\n\n//fast power\n\n/*\n\n#define mod 1000000007\n\nlong long fp(long long  base, long long exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    long long  ans = fp(base, exp / 2);\n\n    ans = (ans * ans);\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base )) ;\n\n    return ans;\n\n}\n\n*/\n\n//prime factoriation\n\n/*\n\nset<int >s;\n\nbool prime factorization (int x)\n\n{\n\n    for (int j=2; j*j<=x; ++j)\n\n    {\n\n        while (x%j==0)\n\n        {\n\n            s.insert(j);\n\n            x/=j;\n\n        }\n\n    }\n\n    if (x>1)\n\n    {\n\n        s.insert(x);\n\n    }\n\n    if (s.size()==2)\n\n        return true ;\n\n    else\n\n        return false ;\n\n}\n\n\n\n#define ll long long\n\nint a,b,q,p,n;\n\nint countDivisorss(int x,int y)\n\n{\n\n    ll cnt = 0;\n\n    for (int i = min(x,y); i <= sqrt(n); i++)\n\n    {\n\n        if (x % i == 0&&y%i==0)\n\n        {\n\n            if (x / i == i||y / i == i)\n\n                cnt++;\n\n\n\n            else\n\n                cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\nint countDivisors(int x)\n\n{\n\n    ll cnt = 0;\n\n    int tmp=n;\n\n    if (n-x>10000000)  tmp=sqrt(n);\n\n    for (int i = x; i <= tmp; i++)\n\n    {\n\n        if (x % i == 0)\n\n        {\n\n         if (x/i==i)\n\n            cnt++;\n\n         else\n\n            cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\n*/\n\n\n\n/*\n\n        int s =n/2,e=n-1;\n\n        while (s<=e&&e<=n-1)\n\n        {\n\n            int mid =s+e/2;\n\n\n\n            if (arr[mid]==arr[n/2])\n\n            {\n\n                s=mid;\n\n                num +=mid -s;\n\n            }\n\n            else\n\n                e=mid-1;\n\n        }\n\n        */\n\n\n\n\n\n\n\n\n\nconst int N = 1e5 + 5;\n\n\n\nvector<int> adj[N];\n\nbool visited[N];\n\nint nodesNum;\n\nvoid dfs(int node)\n\n{\n\n   if (visited[node])\n\n       return;\n\n   visited[node] = true;\n\n   for (int child: adj[node])\n\n       dfs(child);\n\n}\n\n\n\nint main()\n\n{\n\n   int n;\n\n   cin>>n;\n\n   if (n%2==0)\n\n    cout<<n/2;\n\n   else \n\n    cout<<n/2+1;\n\n   return 0;\n\n}\n\n\n\n\n",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint N;\n\n\t\n\n\tscanf(\"%d\",&N);\n\n\t\n\n\tif(N%2==0){\n\n\t\tprintf(\"%d\",N/2);\n\n\t}\n\n\telse{\n\n\t\tprintf(\"%d\",(N/2)+1);\n\n\t}\n\n}"
    },
    {
        "id": "367",
        "source_code": "#include <iostream>\n\n#define ll long long\n\nusing namespace std;\n\n\n\nint main()\n\n{ ll n;\n\ncin>>n;\n\nif(n%2==0)\n\n    cout << n/2;\n\nelse\n\n    cout << (n/2)+1 << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint N;\n\n\t\n\n\tscanf(\"%d\",&N);\n\n\t\n\n\tif(N%2==0){\n\n\t\tprintf(\"%d\",N/2);\n\n\t}\n\n\telse{\n\n\t\tprintf(\"%d\",(N/2)+1);\n\n\t}\n\n}"
    },
    {
        "id": "368",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    cin>>n;\n\n    if(n%2==0){\n\n        cout<<n/2;\n\n    }\n\n    else{\n\n        cout<<n/2+1;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint N;\n\n\t\n\n\tscanf(\"%d\",&N);\n\n\t\n\n\tif(N%2==0){\n\n\t\tprintf(\"%d\",N/2);\n\n\t}\n\n\telse{\n\n\t\tprintf(\"%d\",(N/2)+1);\n\n\t}\n\n}"
    },
    {
        "id": "369",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tcout<<(n+1)/2;\n\n}",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint N;\n\n\t\n\n\tscanf(\"%d\",&N);\n\n\t\n\n\tif(N%2==0){\n\n\t\tprintf(\"%d\",N/2);\n\n\t}\n\n\telse{\n\n\t\tprintf(\"%d\",(N/2)+1);\n\n\t}\n\n}"
    },
    {
        "id": "370",
        "source_code": "#include <bits/stdc++.h>\n\n\n\n#define ll long long\n\n#define ld long double\n\n#define ull unsigned long long\n\n#define endl \"\\n\"\n\n#define MohamedMotaz ios::sync_with_stdio(0); cin.tie(0); ios_base::sync_with_stdio(0);\n\n\n\nusing namespace std;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nint main()\n\n{\n\n\tMohamedMotaz;\n\n\tll x;\n\n\tcin >> x;\n\n\tcout << ceil(x / 2.0);\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint x;\n\n\tscanf(\"%d\", &x);\n\n\t\n\n\tif (x%2 == 0) {\n\n\t\tprintf(\"%d\", x/2);\n\n\t}\n\n\telse {\n\n\t\tprintf(\"%d\", (x/2) + 1);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "371",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;   \n\n\n\nint main()\n\n{\n\n    ll num;\n\n    cin>>num;\n\n    cout<<num/2 + num %2;\n\n    return 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint x;\n\n\tscanf(\"%d\", &x);\n\n\t\n\n\tif (x%2 == 0) {\n\n\t\tprintf(\"%d\", x/2);\n\n\t}\n\n\telse {\n\n\t\tprintf(\"%d\", (x/2) + 1);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "372",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n/*\n\n#define mod 7\n\ntypedef long long ll;\n\n\n\nll fact[1000006], inv[1000006];\n\n\n\nll fp(ll base, ll exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    ll ans = fp(base, exp / 2);\n\n    ans = (ans * ans) % mod;\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base % mod)) % mod;\n\n    return ans;\n\n}\n\n\n\nvoid calcFacAndInv(ll n)\n\n{\n\n    fact[0] = inv[0] = 1;\n\n    for (ll i = 1; i <= n; i++)\n\n    {\n\n        fact[i] = (i * fact[i - 1]) % mod;\n\n        inv[i] = fp(fact[i], mod - 2);\n\n    }\n\n}\n\n\n\nll ncr(ll n, ll r)\n\n{\n\n    return ((fact[n] * inv[r]) % mod * inv[n - r]) % mod;\n\n}\n\n\n\nll npr(ll n, ll r)\n\n{\n\n    return (fact[n] * inv[n - r]) % mod;\n\n}\n\n\n\nint main()\n\n{\n\n    calcFacAndInv(100000);\n\n     cout<<inv[3];\n\n    return 0;\n\n}\n\n*/\n\n\n\n\n\n// GCD\n\n\n\nint gcd(long long a,long long b)\n\n{\n\n    if (b==0)\n\n        return a;\n\n    return gcd (b,a%b);\n\n}\n\n//fast power\n\n/*\n\n#define mod 1000000007\n\nlong long fp(long long  base, long long exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    long long  ans = fp(base, exp / 2);\n\n    ans = (ans * ans);\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base )) ;\n\n    return ans;\n\n}\n\n*/\n\n//prime factoriation\n\n/*\n\nset<int >s;\n\nbool prime factorization (int x)\n\n{\n\n    for (int j=2; j*j<=x; ++j)\n\n    {\n\n        while (x%j==0)\n\n        {\n\n            s.insert(j);\n\n            x/=j;\n\n        }\n\n    }\n\n    if (x>1)\n\n    {\n\n        s.insert(x);\n\n    }\n\n    if (s.size()==2)\n\n        return true ;\n\n    else\n\n        return false ;\n\n}\n\n\n\n#define ll long long\n\nint a,b,q,p,n;\n\nint countDivisorss(int x,int y)\n\n{\n\n    ll cnt = 0;\n\n    for (int i = min(x,y); i <= sqrt(n); i++)\n\n    {\n\n        if (x % i == 0&&y%i==0)\n\n        {\n\n            if (x / i == i||y / i == i)\n\n                cnt++;\n\n\n\n            else\n\n                cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\nint countDivisors(int x)\n\n{\n\n    ll cnt = 0;\n\n    int tmp=n;\n\n    if (n-x>10000000)  tmp=sqrt(n);\n\n    for (int i = x; i <= tmp; i++)\n\n    {\n\n        if (x % i == 0)\n\n        {\n\n         if (x/i==i)\n\n            cnt++;\n\n         else\n\n            cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\n*/\n\n\n\n/*\n\n        int s =n/2,e=n-1;\n\n        while (s<=e&&e<=n-1)\n\n        {\n\n            int mid =s+e/2;\n\n\n\n            if (arr[mid]==arr[n/2])\n\n            {\n\n                s=mid;\n\n                num +=mid -s;\n\n            }\n\n            else\n\n                e=mid-1;\n\n        }\n\n        */\n\n\n\n\n\n\n\n\n\nconst int N = 1e5 + 5;\n\n\n\nvector<int> adj[N];\n\nbool visited[N];\n\nint nodesNum;\n\nvoid dfs(int node)\n\n{\n\n   if (visited[node])\n\n       return;\n\n   visited[node] = true;\n\n   for (int child: adj[node])\n\n       dfs(child);\n\n}\n\n\n\nint main()\n\n{\n\n   int n;\n\n   cin>>n;\n\n   if (n%2==0)\n\n    cout<<n/2;\n\n   else \n\n    cout<<n/2+1;\n\n   return 0;\n\n}\n\n\n\n\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint x;\n\n\tscanf(\"%d\", &x);\n\n\t\n\n\tif (x%2 == 0) {\n\n\t\tprintf(\"%d\", x/2);\n\n\t}\n\n\telse {\n\n\t\tprintf(\"%d\", (x/2) + 1);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "373",
        "source_code": "#include <iostream>\n\n#define ll long long\n\nusing namespace std;\n\n\n\nint main()\n\n{ ll n;\n\ncin>>n;\n\nif(n%2==0)\n\n    cout << n/2;\n\nelse\n\n    cout << (n/2)+1 << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint x;\n\n\tscanf(\"%d\", &x);\n\n\t\n\n\tif (x%2 == 0) {\n\n\t\tprintf(\"%d\", x/2);\n\n\t}\n\n\telse {\n\n\t\tprintf(\"%d\", (x/2) + 1);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "374",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    cin>>n;\n\n    if(n%2==0){\n\n        cout<<n/2;\n\n    }\n\n    else{\n\n        cout<<n/2+1;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint x;\n\n\tscanf(\"%d\", &x);\n\n\t\n\n\tif (x%2 == 0) {\n\n\t\tprintf(\"%d\", x/2);\n\n\t}\n\n\telse {\n\n\t\tprintf(\"%d\", (x/2) + 1);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "375",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tcout<<(n+1)/2;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint x;\n\n\tscanf(\"%d\", &x);\n\n\t\n\n\tif (x%2 == 0) {\n\n\t\tprintf(\"%d\", x/2);\n\n\t}\n\n\telse {\n\n\t\tprintf(\"%d\", (x/2) + 1);\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "376",
        "source_code": "#include <bits/stdc++.h>\n\n\n\n#define ll long long\n\n#define ld long double\n\n#define ull unsigned long long\n\n#define endl \"\\n\"\n\n#define MohamedMotaz ios::sync_with_stdio(0); cin.tie(0); ios_base::sync_with_stdio(0);\n\n\n\nusing namespace std;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nint main()\n\n{\n\n\tMohamedMotaz;\n\n\tll x;\n\n\tcin >> x;\n\n\tcout << ceil(x / 2.0);\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint x;\n\n\t\n\n\tscanf(\"%d\",&x);\n\n\tif(x%2==0){\n\n\t\tprintf(\"%d\",x/2);\n\n\t}\n\n\telse {\n\n\t\tprintf(\"%d\",(x/2)+1);\n\n\t}\n\n\t\n\n\t\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "377",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;   \n\n\n\nint main()\n\n{\n\n    ll num;\n\n    cin>>num;\n\n    cout<<num/2 + num %2;\n\n    return 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint x;\n\n\t\n\n\tscanf(\"%d\",&x);\n\n\tif(x%2==0){\n\n\t\tprintf(\"%d\",x/2);\n\n\t}\n\n\telse {\n\n\t\tprintf(\"%d\",(x/2)+1);\n\n\t}\n\n\t\n\n\t\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "378",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n/*\n\n#define mod 7\n\ntypedef long long ll;\n\n\n\nll fact[1000006], inv[1000006];\n\n\n\nll fp(ll base, ll exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    ll ans = fp(base, exp / 2);\n\n    ans = (ans * ans) % mod;\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base % mod)) % mod;\n\n    return ans;\n\n}\n\n\n\nvoid calcFacAndInv(ll n)\n\n{\n\n    fact[0] = inv[0] = 1;\n\n    for (ll i = 1; i <= n; i++)\n\n    {\n\n        fact[i] = (i * fact[i - 1]) % mod;\n\n        inv[i] = fp(fact[i], mod - 2);\n\n    }\n\n}\n\n\n\nll ncr(ll n, ll r)\n\n{\n\n    return ((fact[n] * inv[r]) % mod * inv[n - r]) % mod;\n\n}\n\n\n\nll npr(ll n, ll r)\n\n{\n\n    return (fact[n] * inv[n - r]) % mod;\n\n}\n\n\n\nint main()\n\n{\n\n    calcFacAndInv(100000);\n\n     cout<<inv[3];\n\n    return 0;\n\n}\n\n*/\n\n\n\n\n\n// GCD\n\n\n\nint gcd(long long a,long long b)\n\n{\n\n    if (b==0)\n\n        return a;\n\n    return gcd (b,a%b);\n\n}\n\n//fast power\n\n/*\n\n#define mod 1000000007\n\nlong long fp(long long  base, long long exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    long long  ans = fp(base, exp / 2);\n\n    ans = (ans * ans);\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base )) ;\n\n    return ans;\n\n}\n\n*/\n\n//prime factoriation\n\n/*\n\nset<int >s;\n\nbool prime factorization (int x)\n\n{\n\n    for (int j=2; j*j<=x; ++j)\n\n    {\n\n        while (x%j==0)\n\n        {\n\n            s.insert(j);\n\n            x/=j;\n\n        }\n\n    }\n\n    if (x>1)\n\n    {\n\n        s.insert(x);\n\n    }\n\n    if (s.size()==2)\n\n        return true ;\n\n    else\n\n        return false ;\n\n}\n\n\n\n#define ll long long\n\nint a,b,q,p,n;\n\nint countDivisorss(int x,int y)\n\n{\n\n    ll cnt = 0;\n\n    for (int i = min(x,y); i <= sqrt(n); i++)\n\n    {\n\n        if (x % i == 0&&y%i==0)\n\n        {\n\n            if (x / i == i||y / i == i)\n\n                cnt++;\n\n\n\n            else\n\n                cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\nint countDivisors(int x)\n\n{\n\n    ll cnt = 0;\n\n    int tmp=n;\n\n    if (n-x>10000000)  tmp=sqrt(n);\n\n    for (int i = x; i <= tmp; i++)\n\n    {\n\n        if (x % i == 0)\n\n        {\n\n         if (x/i==i)\n\n            cnt++;\n\n         else\n\n            cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\n*/\n\n\n\n/*\n\n        int s =n/2,e=n-1;\n\n        while (s<=e&&e<=n-1)\n\n        {\n\n            int mid =s+e/2;\n\n\n\n            if (arr[mid]==arr[n/2])\n\n            {\n\n                s=mid;\n\n                num +=mid -s;\n\n            }\n\n            else\n\n                e=mid-1;\n\n        }\n\n        */\n\n\n\n\n\n\n\n\n\nconst int N = 1e5 + 5;\n\n\n\nvector<int> adj[N];\n\nbool visited[N];\n\nint nodesNum;\n\nvoid dfs(int node)\n\n{\n\n   if (visited[node])\n\n       return;\n\n   visited[node] = true;\n\n   for (int child: adj[node])\n\n       dfs(child);\n\n}\n\n\n\nint main()\n\n{\n\n   int n;\n\n   cin>>n;\n\n   if (n%2==0)\n\n    cout<<n/2;\n\n   else \n\n    cout<<n/2+1;\n\n   return 0;\n\n}\n\n\n\n\n",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint x;\n\n\t\n\n\tscanf(\"%d\",&x);\n\n\tif(x%2==0){\n\n\t\tprintf(\"%d\",x/2);\n\n\t}\n\n\telse {\n\n\t\tprintf(\"%d\",(x/2)+1);\n\n\t}\n\n\t\n\n\t\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "379",
        "source_code": "#include <iostream>\n\n#define ll long long\n\nusing namespace std;\n\n\n\nint main()\n\n{ ll n;\n\ncin>>n;\n\nif(n%2==0)\n\n    cout << n/2;\n\nelse\n\n    cout << (n/2)+1 << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint x;\n\n\t\n\n\tscanf(\"%d\",&x);\n\n\tif(x%2==0){\n\n\t\tprintf(\"%d\",x/2);\n\n\t}\n\n\telse {\n\n\t\tprintf(\"%d\",(x/2)+1);\n\n\t}\n\n\t\n\n\t\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "380",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    cin>>n;\n\n    if(n%2==0){\n\n        cout<<n/2;\n\n    }\n\n    else{\n\n        cout<<n/2+1;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint x;\n\n\t\n\n\tscanf(\"%d\",&x);\n\n\tif(x%2==0){\n\n\t\tprintf(\"%d\",x/2);\n\n\t}\n\n\telse {\n\n\t\tprintf(\"%d\",(x/2)+1);\n\n\t}\n\n\t\n\n\t\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "381",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tcout<<(n+1)/2;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint x;\n\n\t\n\n\tscanf(\"%d\",&x);\n\n\tif(x%2==0){\n\n\t\tprintf(\"%d\",x/2);\n\n\t}\n\n\telse {\n\n\t\tprintf(\"%d\",(x/2)+1);\n\n\t}\n\n\t\n\n\t\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "382",
        "source_code": "#include <bits/stdc++.h>\n\n\n\n#define ll long long\n\n#define ld long double\n\n#define ull unsigned long long\n\n#define endl \"\\n\"\n\n#define MohamedMotaz ios::sync_with_stdio(0); cin.tie(0); ios_base::sync_with_stdio(0);\n\n\n\nusing namespace std;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nint main()\n\n{\n\n\tMohamedMotaz;\n\n\tll x;\n\n\tcin >> x;\n\n\tcout << ceil(x / 2.0);\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n{\n\n    int N;\n\n    scanf(\"%d\", &N);\n\n    \n\n    if(N%2==0){\n\n        printf(\"%d\", N/2);\n\n    }\n\n    else{\n\n        printf(\"%d\", N/2+1);\n\n    }\n\n    \n\n   \n\n    \n\n    return 0;\n\n}"
    },
    {
        "id": "383",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;   \n\n\n\nint main()\n\n{\n\n    ll num;\n\n    cin>>num;\n\n    cout<<num/2 + num %2;\n\n    return 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n{\n\n    int N;\n\n    scanf(\"%d\", &N);\n\n    \n\n    if(N%2==0){\n\n        printf(\"%d\", N/2);\n\n    }\n\n    else{\n\n        printf(\"%d\", N/2+1);\n\n    }\n\n    \n\n   \n\n    \n\n    return 0;\n\n}"
    },
    {
        "id": "384",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n/*\n\n#define mod 7\n\ntypedef long long ll;\n\n\n\nll fact[1000006], inv[1000006];\n\n\n\nll fp(ll base, ll exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    ll ans = fp(base, exp / 2);\n\n    ans = (ans * ans) % mod;\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base % mod)) % mod;\n\n    return ans;\n\n}\n\n\n\nvoid calcFacAndInv(ll n)\n\n{\n\n    fact[0] = inv[0] = 1;\n\n    for (ll i = 1; i <= n; i++)\n\n    {\n\n        fact[i] = (i * fact[i - 1]) % mod;\n\n        inv[i] = fp(fact[i], mod - 2);\n\n    }\n\n}\n\n\n\nll ncr(ll n, ll r)\n\n{\n\n    return ((fact[n] * inv[r]) % mod * inv[n - r]) % mod;\n\n}\n\n\n\nll npr(ll n, ll r)\n\n{\n\n    return (fact[n] * inv[n - r]) % mod;\n\n}\n\n\n\nint main()\n\n{\n\n    calcFacAndInv(100000);\n\n     cout<<inv[3];\n\n    return 0;\n\n}\n\n*/\n\n\n\n\n\n// GCD\n\n\n\nint gcd(long long a,long long b)\n\n{\n\n    if (b==0)\n\n        return a;\n\n    return gcd (b,a%b);\n\n}\n\n//fast power\n\n/*\n\n#define mod 1000000007\n\nlong long fp(long long  base, long long exp)\n\n{\n\n    if (exp == 0)\n\n        return 1;\n\n    long long  ans = fp(base, exp / 2);\n\n    ans = (ans * ans);\n\n    if (exp % 2 != 0)\n\n        ans = (ans * (base )) ;\n\n    return ans;\n\n}\n\n*/\n\n//prime factoriation\n\n/*\n\nset<int >s;\n\nbool prime factorization (int x)\n\n{\n\n    for (int j=2; j*j<=x; ++j)\n\n    {\n\n        while (x%j==0)\n\n        {\n\n            s.insert(j);\n\n            x/=j;\n\n        }\n\n    }\n\n    if (x>1)\n\n    {\n\n        s.insert(x);\n\n    }\n\n    if (s.size()==2)\n\n        return true ;\n\n    else\n\n        return false ;\n\n}\n\n\n\n#define ll long long\n\nint a,b,q,p,n;\n\nint countDivisorss(int x,int y)\n\n{\n\n    ll cnt = 0;\n\n    for (int i = min(x,y); i <= sqrt(n); i++)\n\n    {\n\n        if (x % i == 0&&y%i==0)\n\n        {\n\n            if (x / i == i||y / i == i)\n\n                cnt++;\n\n\n\n            else\n\n                cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\nint countDivisors(int x)\n\n{\n\n    ll cnt = 0;\n\n    int tmp=n;\n\n    if (n-x>10000000)  tmp=sqrt(n);\n\n    for (int i = x; i <= tmp; i++)\n\n    {\n\n        if (x % i == 0)\n\n        {\n\n         if (x/i==i)\n\n            cnt++;\n\n         else\n\n            cnt = cnt + 2;\n\n        }\n\n    }\n\n    return cnt;\n\n}\n\n*/\n\n\n\n/*\n\n        int s =n/2,e=n-1;\n\n        while (s<=e&&e<=n-1)\n\n        {\n\n            int mid =s+e/2;\n\n\n\n            if (arr[mid]==arr[n/2])\n\n            {\n\n                s=mid;\n\n                num +=mid -s;\n\n            }\n\n            else\n\n                e=mid-1;\n\n        }\n\n        */\n\n\n\n\n\n\n\n\n\nconst int N = 1e5 + 5;\n\n\n\nvector<int> adj[N];\n\nbool visited[N];\n\nint nodesNum;\n\nvoid dfs(int node)\n\n{\n\n   if (visited[node])\n\n       return;\n\n   visited[node] = true;\n\n   for (int child: adj[node])\n\n       dfs(child);\n\n}\n\n\n\nint main()\n\n{\n\n   int n;\n\n   cin>>n;\n\n   if (n%2==0)\n\n    cout<<n/2;\n\n   else \n\n    cout<<n/2+1;\n\n   return 0;\n\n}\n\n\n\n\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n{\n\n    int N;\n\n    scanf(\"%d\", &N);\n\n    \n\n    if(N%2==0){\n\n        printf(\"%d\", N/2);\n\n    }\n\n    else{\n\n        printf(\"%d\", N/2+1);\n\n    }\n\n    \n\n   \n\n    \n\n    return 0;\n\n}"
    },
    {
        "id": "385",
        "source_code": "#include <iostream>\n\n#define ll long long\n\nusing namespace std;\n\n\n\nint main()\n\n{ ll n;\n\ncin>>n;\n\nif(n%2==0)\n\n    cout << n/2;\n\nelse\n\n    cout << (n/2)+1 << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n{\n\n    int N;\n\n    scanf(\"%d\", &N);\n\n    \n\n    if(N%2==0){\n\n        printf(\"%d\", N/2);\n\n    }\n\n    else{\n\n        printf(\"%d\", N/2+1);\n\n    }\n\n    \n\n   \n\n    \n\n    return 0;\n\n}"
    },
    {
        "id": "386",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    cin>>n;\n\n    if(n%2==0){\n\n        cout<<n/2;\n\n    }\n\n    else{\n\n        cout<<n/2+1;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n{\n\n    int N;\n\n    scanf(\"%d\", &N);\n\n    \n\n    if(N%2==0){\n\n        printf(\"%d\", N/2);\n\n    }\n\n    else{\n\n        printf(\"%d\", N/2+1);\n\n    }\n\n    \n\n   \n\n    \n\n    return 0;\n\n}"
    },
    {
        "id": "387",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tcout<<(n+1)/2;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main()\n\n{\n\n    int N;\n\n    scanf(\"%d\", &N);\n\n    \n\n    if(N%2==0){\n\n        printf(\"%d\", N/2);\n\n    }\n\n    else{\n\n        printf(\"%d\", N/2+1);\n\n    }\n\n    \n\n   \n\n    \n\n    return 0;\n\n}"
    },
    {
        "id": "388",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\nint n;\n\nint saiki(int ima)\n\n{\n\n\tif(ima == n)\n\n\t\treturn 1;\n\n\tif(ima > n)\n\n\t\treturn 0;\n\n\n\n\tint res = 0;\n\n\tres += saiki(ima + 1) + saiki(ima + 2) + saiki(ima + 3);\n\n\treturn res;\n\n}\n\n\n\nint main() {\n\n\twhile (true){\n\n\t\tcin >> n;\n\n\t\tif (n == 0)\n\n\t\t\tbreak;\n\n\t\t\n\n\t\tint ans,a;\n\n\t\tans = saiki(0);\n\n\t\ta = ans;\n\n\t\tans /= 3650;\n\n\t\ta %= 3650;\n\n\t\tif( a == 0 )\n\n\t\t{\n\n\t\t\tcout << ans << endl;\n\n\t\t}\n\n\t\telse if( a != 0 )\n\n\t\t{\n\n\t\t\tans++;\n\n\t\t\tcout << ans << endl;\n\n\t\t\t\n\n\t\t}\n\n\t}\n\n}",
        "optimized_code": "#include <iostream>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n\tint n, cnt, y;\n\n\tint c[31];\n\n\n\n\tc[0] = 1;\n\n\tc[1] = 1;\n\n\tc[2] = 2;\n\n\tfor( int i=3; i<=30; i++ )\n\n\t\tc[i] = c[i-1] + c[i-2] + c[i-3];\n\n\n\n\twhile( cin >> n, n != 0 ){\n\n\t\ty = c[n]/(365*10);\n\n\t\ty += !( c[n]%(365*10) == 0 );\n\n\t\tcout << y << endl;\n\n\t}\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "389",
        "source_code": "#include <iostream>\n\n\n\nusing namespace std;\n\n\n\nlong long int kaidan (int n) {\n\n\tif (n == 0) {\n\n\t\treturn 1;\n\n\t} else {\n\n\t\tif (n >= 3) {\n\n\t\t\treturn kaidan(n-3)+kaidan(n-2)+kaidan(n-1);\n\n\t\t} else if (n > 1) {\n\n\t\t\treturn kaidan(n-2)+kaidan(n-1);\n\n\t\t} else {\n\n\t\t\treturn kaidan(n-1);\n\n\t\t}\n\n\t}\n\n}\n\n\n\n\n\nint main() {\n\n\tint n;\n\n\twhile (cin >> n) {\n\n\t\tif (n == 0) {\n\n\t\t\tbreak;\n\n\t\t}\n\n\t\tlong long int a = kaidan(n);\n\n\t\tlong long int b;\n\n\t\tb = a / 10;\n\n\t\tif (a % 10 != 0) {\n\n\t\t\tb++;\n\n\t\t}\n\n\t\ta = b / 365;\n\n\t\tif (b % 365 != 0) {\n\n\t\t\ta++;\n\n\t\t}\n\n\t\tcout << a << endl;\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <cmath>\n\n#include <vector>\n\n\n\nusing namespace std;\n\n\n\nint main() {\n\n\tint n;\n\n\twhile (cin >> n) {\n\n\t\tif (n == 0) {\n\n\t\t\tbreak;\n\n\t\t}\n\n\t\tvector<int> dp(31, 0);\n\n\t\tdp[0] = 1;\n\n\t\tdp[1] = 1;\n\n\t\tdp[2] = 2;\n\n\t\tfor (int j = 3; j <= n; j++) {\n\n\t\t\tdp[j] = dp[j-1]+dp[j-2]+dp[j-3];\n\n\t\t}\n\n\t\tint y = dp[n]/3650;\n\n\t\tif (dp[n] % 3650 > 0) {\n\n\t\t\ty++;\n\n\t\t}\n\n\t\tcout << y << endl;\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "390",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\n\n\nclass Answer\n\n{\n\npublic:\n\n\tAnswer(){day = 10; year = 365;}\n\n\t\n\n\tint N;\t//??\\???\n\n\tint day;\n\n\tint year;\n\n\tunsigned long long count(int cnt);\t//??\u00a8??\u00a2?\u00b4\u00a2(???)\n\n\tvoid set();\t//??\\???\n\n\tvoid OutPut();\t//???????????????\n\n\t\n\n\tbool empty();\t//???????????\u00b6?????????\n\n\tbool ans();\t//?\u00a7\u00a3???\n\n};\n\n\n\nunsigned long long Answer::count(int cnt)\n\n{\n\n\tif( cnt < 0)\n\n\t\treturn 0;\n\n\t\n\n\telse if(cnt == 0)\n\n\t\treturn 1;\n\n\t\n\n\treturn count(cnt - 1) + count(cnt - 2) + count(cnt - 3);\n\n}\n\n\n\nvoid Answer::OutPut()\n\n{\n\n\tif( N == 0 )\n\n\t\treturn;\n\n\tint ans_ = 1;\t//??????????????\u00b4???\n\n\tans_ += (count( N )) / (day * year);\t//??\\???\n\n\t\n\n\tcout << ans_ << endl;;\n\n}\n\n\n\nvoid Answer::set()\n\n{\n\n\tcin >> N;\n\n}\n\n\n\nbool Answer::empty()\n\n{\n\n\tif( N == 0 )return false;\n\n\telse return true;\n\n}\n\n\n\nbool Answer::ans()\n\n{\n\n\tset();\n\n\tOutPut();\n\n\treturn empty();\n\n}\n\n\n\nint main()\n\n{\n\n\tAnswer ans;\n\n\n\n\twhile( ans.ans() );\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\nusing namespace std;\n\n\n\n#define MEMO_MAX 100\n\ntypedef unsigned long long ULL;\n\n\n\nbool Flag_memo_g = true;\t//?????\u00a2??????????????????\n\n\n\nclass Answer\n\n{\n\npublic:\n\n\tAnswer()\n\n\t{\n\n\t\tday = 10; year = 365;\n\n\t\tfor(int i = 0; i < MEMO_MAX; i++)\n\n\t\t{\n\n\t\t\tmemo[i] = 0;\n\n\t\t\tFlag_memo[i] = false;\n\n\t\t}\n\n\t}\n\n\t\n\n\tint N;\t//??\\???\n\n\tint day;\n\n\tint year;\n\n\n\n\tULL memo[MEMO_MAX];\n\n\tbool Flag_memo[MEMO_MAX];\n\n\t\n\n\tULL count(int cnt);\t//??\u00a8??\u00a2?\u00b4\u00a2(??\u00b1???)\n\n\tULL count_memo(int cnt);\t//??\u00a8??\u00a2?\u00b4\u00a2(??\u00b1???)(?????\u00a2???ver.)\n\n\tvoid set();\t//??\\???\n\n\tvoid OutPut();\t//???????????????\n\n\t\n\n\tbool empty();\t//???????????\u00b6?????????\n\n\tbool ans();\t//?\u00a7\u00a3???\n\n};\n\n\n\nULL Answer::count(int cnt)\n\n{\n\n\tif( cnt < 0 )\n\n\t\treturn 0;\n\n\t\n\n\telse if( cnt == 0 )\n\n\t\treturn 1;\n\n\t\n\n\treturn count(cnt - 1) + count(cnt - 2) + count(cnt - 3);\n\n}\n\n\n\n\n\nULL Answer::count_memo(int cnt)\n\n{\n\n\tif( cnt < 0 )return 0;\n\n\telse if( cnt == 0 )return 1;\n\n\t\n\n\tif( !(Flag_memo[cnt]) )\n\n\t{\n\n\t\tmemo[cnt] = count_memo(cnt - 1) + count_memo(cnt - 2) + count_memo(cnt - 3);\n\n\t\tFlag_memo[cnt] = true;\n\n\t}\n\n\t\n\n\treturn memo[cnt];\n\n}\n\n\n\nvoid Answer::OutPut()\n\n{\n\n\tif( N == 0 )\n\n\t\treturn;\n\n\tint ans_ = 1;\t//??????????????\u00b4???\n\n\tif( Flag_memo_g )\n\n\t\tans_ += count_memo( N ) / (day * year);\n\n\t\n\n\telse if( !Flag_memo_g )\n\n\t\tans_ += (count( N )) / (day * year);\t//??\\???\n\n\t\n\n\tcout << ans_ << endl;\n\n}\n\n\n\nvoid Answer::set()\n\n{\n\n\tcin >> N;\n\n}\n\n\n\nbool Answer::empty()\n\n{\n\n\tif( N == 0 )return false;\n\n\telse return true;\n\n}\n\n\n\nbool Answer::ans()\n\n{\n\n\tset();\n\n\tOutPut();\n\n\treturn empty();\n\n}\n\n\n\nint main()\n\n{\n\n\tAnswer ans;\n\n\n\n\twhile( ans.ans() );\n\n\treturn 0;\n\n}"
    },
    {
        "id": "391",
        "source_code": "#include <iostream>\n\n#include <iomanip>\n\n#include <sstream>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <cmath>\n\n#include <climits>\n\n#include <string>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <set>\n\n#include <map>\n\n#include <algorithm>\n\n#include <functional>\n\n\n\nusing namespace std;\n\n\n\ntypedef vector<int> VI;\n\ntypedef vector<VI> VVI;\n\ntypedef vector<string> VS;\n\ntypedef pair<int,int> PII;\n\ntypedef long long ll;\n\ntypedef unsigned long long ull;\n\n\n\n#define REP( i, m, n ) for ( int i = (int)( m ); i < (int)( n ); i++ )\n\n#define UREP( i, m, n ) for ( unsigned int i = (unsigned int)( m ); i < (unsigned int)( n ); i++ )\n\n\n\n#define ITER( c ) __typeof( (c).begin() )\n\n#define IREP( c, it ) for ( ITER(c) it = c.begin(); it != c.end(); ++it )\n\n#define ALL( c ) (c).begin(), (c).end()\n\n#define RALL( c ) (c).rbegin(), (c).rend()\n\n\n\n#define PB( n ) push_back( n )\n\n#define MP( a, b ) make_pair( ( a ), ( b ) )\n\n#define EXIST( c, e ) ( (c).find( e ) != (c).end() )\n\n\n\n#define fst first\n\n#define snd second\n\n\n\n#define DUMP( x ) cerr << #x << \" = \" << ( x ) << endl\n\n#define DEBUG( x ) cerr << __FILE__ << \":\" << __LINE__ << \": \" << #x << \" = \" << ( x ) << endl\n\n\n\nVI memo;\n\n\n\nint solve( int n )\n\n{\n\n\tif ( n == 0 )\n\n\t{\n\n\t\treturn 1;\n\n\t}\n\n\telse if ( n < 0 )\n\n\t{\n\n\t\treturn 0;\n\n\t}\n\n\n\n\tif ( memo[n] != -1 )\n\n\t{\n\n\t\treturn memo[n];\n\n\t}\n\n\n\n\treturn solve( n - 1 ) + solve( n - 2 ) + solve( n - 3 );\n\n}\n\n\n\nint main()\n\n{\n\n\twhile ( true )\n\n\t{\n\n\t\tint n;\n\n\t\tcin >> n;\n\n\n\n\t\tif ( n == 0 )\n\n\t\t{\n\n\t\t\tbreak;\n\n\t\t}\n\n\n\n\t\tmemo.resize( n + 1 );\n\n\t\tfill( ALL( memo ), -1 );\n\n\n\n\t\tcout << solve( n ) / 3650 + 1 << endl;\n\n\t}\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <iomanip>\n\n#include <sstream>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <cmath>\n\n#include <climits>\n\n#include <string>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <set>\n\n#include <map>\n\n#include <algorithm>\n\n#include <functional>\n\n\n\nusing namespace std;\n\n\n\ntypedef vector<int> VI;\n\ntypedef vector<VI> VVI;\n\ntypedef vector<string> VS;\n\ntypedef pair<int,int> PII;\n\ntypedef long long ll;\n\ntypedef unsigned long long ull;\n\n\n\n#define REP( i, m, n ) for ( int i = (int)( m ); i < (int)( n ); i++ )\n\n#define UREP( i, m, n ) for ( unsigned int i = (unsigned int)( m ); i < (unsigned int)( n ); i++ )\n\n\n\n#define ITER( c ) __typeof( (c).begin() )\n\n#define IREP( c, it ) for ( ITER(c) it = c.begin(); it != c.end(); ++it )\n\n#define ALL( c ) (c).begin(), (c).end()\n\n#define RALL( c ) (c).rbegin(), (c).rend()\n\n\n\n#define PB( n ) push_back( n )\n\n#define MP( a, b ) make_pair( ( a ), ( b ) )\n\n#define EXIST( c, e ) ( (c).find( e ) != (c).end() )\n\n\n\n#define fst first\n\n#define snd second\n\n\n\n#define DUMP( x ) cerr << #x << \" = \" << ( x ) << endl\n\n#define DEBUG( x ) cerr << __FILE__ << \":\" << __LINE__ << \": \" << #x << \" = \" << ( x ) << endl\n\n\n\nVI memo;\n\n\n\nint solve( int n )\n\n{\n\n\tif ( n == 0 )\n\n\t{\n\n\t\treturn 1;\n\n\t}\n\n\telse if ( n < 0 )\n\n\t{\n\n\t\treturn 0;\n\n\t}\n\n\n\n\tif ( memo[n] != -1 )\n\n\t{\n\n\t\treturn memo[n];\n\n\t}\n\n\n\n\treturn memo[n] = solve( n - 1 ) + solve( n - 2 ) + solve( n - 3 );\n\n}\n\n\n\nint main()\n\n{\n\n\twhile ( true )\n\n\t{\n\n\t\tint n;\n\n\t\tcin >> n;\n\n\n\n\t\tif ( n == 0 )\n\n\t\t{\n\n\t\t\tbreak;\n\n\t\t}\n\n\n\n\t\tmemo.resize( n + 1 );\n\n\t\tfill( ALL( memo ), -1 );\n\n\n\n\t\tcout << solve( n ) / 3650 + 1 << endl;\n\n\t}\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "392",
        "source_code": "#include <iostream>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <cmath>\n\n#include <cstdio>\n\n#include <functional>\n\n#include <numeric>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <utility>\n\n#include <sstream>\n\n#include <complex>\n\n#include <fstream>\n\n#include <bitset>\n\n#include <time.h>\n\n#include <tuple>\n\n\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\ntypedef pair<ll, ll> P;\n\ntypedef vector<ll> V;\n\ntypedef complex<double> Point;\n\n\n\n#define PI acos(-1.0)\n\n#define EPS 1e-10\n\nconst ll INF = 1e12;\n\nconst ll MOD = 1e9 + 7;\n\n\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n\n#define rep(i,N) for(int i=0;i<(N);i++)\n\n#define ALL(s) (s).begin(),(s).end()\n\n#define EQ(a,b) (abs((a)-(b))<EPS)\n\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n\n#define fi first\n\n#define se second\n\n#define N_SIZE (1LL << 20)\n\n#define NIL -1\n\n\n\nll sq(ll num) { return num*num; }\n\nll mod_pow(ll x, ll n) {\n\n\tif (n == 0)return 1;\n\n\tif (n == 1)return x%MOD;\n\n\tll res = sq(mod_pow(x, n / 2));\n\n\tres %= MOD;\n\n\tif (n % 2 == 1) {\n\n\t\tres *= x;\n\n\t\tres %= MOD;\n\n\t}\n\n\treturn res;\n\n}\n\nll mod_add(ll a, ll b) { return (a + b) % MOD; }\n\nll mod_sub(ll a, ll b) { return (a - b + MOD) % MOD; }\n\nll mod_mul(ll a, ll b) { return a*b % MOD; }\n\n\n\nll n;\n\n\n\nll solve(int now) {\n\n\tif (now == 0)return 1;\n\n\tif (now < 0)return 0;\n\n\tll res = 0;\n\n\tres = solve(now - 1) + solve(now - 2) + solve(now - 3);\n\n\treturn res;\n\n}\n\n\n\nint main() {\n\n\twhile (cin >> n&&n) {\n\n\t\tcout << solve(n) / 3650 + 1 << endl;\n\n\t}\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <cmath>\n\n#include <cstdio>\n\n#include <functional>\n\n#include <numeric>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <utility>\n\n#include <sstream>\n\n#include <complex>\n\n#include <fstream>\n\n#include <bitset>\n\n#include <time.h>\n\n#include <tuple>\n\n\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\ntypedef pair<ll, ll> P;\n\ntypedef vector<ll> V;\n\ntypedef complex<double> Point;\n\n\n\n#define PI acos(-1.0)\n\n#define EPS 1e-10\n\nconst ll INF = 1e12;\n\nconst ll MOD = 1e9 + 7;\n\n\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n\n#define rep(i,N) for(int i=0;i<(N);i++)\n\n#define ALL(s) (s).begin(),(s).end()\n\n#define EQ(a,b) (abs((a)-(b))<EPS)\n\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n\n#define fi first\n\n#define se second\n\n#define N_SIZE (1LL << 20)\n\n#define NIL -1\n\n#define MAX_N 100100\n\n\n\nll sq(ll num) { return num*num; }\n\nll mod_pow(ll x, ll n) {\n\n\tif (n == 0)return 1;\n\n\tif (n == 1)return x%MOD;\n\n\tll res = sq(mod_pow(x, n / 2));\n\n\tres %= MOD;\n\n\tif (n % 2 == 1) {\n\n\t\tres *= x;\n\n\t\tres %= MOD;\n\n\t}\n\n\treturn res;\n\n}\n\nll mod_add(ll a, ll b) { return (a + b) % MOD; }\n\nll mod_sub(ll a, ll b) { return (a - b + MOD) % MOD; }\n\nll mod_mul(ll a, ll b) { return a*b % MOD; }\n\n\n\nll n;\n\nll memo[100];\n\n\n\nll solve(int now) {\n\n\tif (now == 0)return 1;\n\n\tif (now < 0)return 0;\n\n\tif (memo[now] != -1)return memo[now];\n\n\treturn memo[now] = solve(now - 1) + solve(now - 2) + solve(now - 3);\n\n}\n\n\n\nint main() {\n\n\tfill(memo, memo + 100, -1);\n\n\tsolve(30);\n\n\twhile (cin >> n&&n) {\n\n\t\tcout << memo[n] / 3650 + 1 << endl;\n\n\t}\n\n}"
    },
    {
        "id": "393",
        "source_code": "#include <iostream>\n\n#include <string>\n\n#include <algorithm>\n\n#include <stack>\n\n#include <queue>\n\nusing namespace std;\n\n\n\nint func(int kaidan,int now){\n\n\tint a=0,b=0,c=0;\n\n\t\n\n\tif(now==kaidan){\n\n\t\treturn 1;\n\n\t}else if(now>kaidan){\n\n\t\treturn 0;\n\n\t\t}else{\n\n\t\ta+=func(kaidan,now+1);\n\n\t\tb+=func(kaidan,now+2);\t\n\n\t\tc+=func(kaidan,now+3);\n\n\t\t}\n\n\t\n\n\treturn a+b+c;\n\n\t\n\n}\n\n\n\nint main(){\n\n\tint n,ans;\n\n\n\n\twhile(cin>>n){\n\n\t\tif(n==0)break;\n\n\t\tans=func(n,0);\n\n\t\tcout<<ans/10/365+1<<endl;\n\n\t\t\n\n\t\t\n\n\t\t\n\n\t}\n\n\t\n\n\t\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <iostream>\n\nusing namespace std;\n\n\n\nint memo[31];\n\n\n\nint main(){\n\n\tint n,ans;\n\n\t\n\n\tmemo[0]=1;\n\n\tmemo[1]=1;\n\n\tmemo[2]=2;\n\n\t\n\n\tfor(int i=3;i<31;i++){\n\n\t\tmemo[i]=memo[i-1]+memo[i-2]+memo[i-3];\n\n\t}\n\n\t\n\n\twhile(cin>>n){\n\n\t\tif(n==0)break;\n\n\t\tcout<<memo[n]/(365*10)+1<<endl;\n\n\t}\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "394",
        "source_code": "#include <iostream>\n\n\n\nint n;\n\nint cmb;\n\nint dp[30];\n\n\n\nint func(int now){\n\n  if(now > n)\n\n    return 0;\n\n  if(now == n){\n\n    dp[now] = 1;\n\n    return 1;\n\n  }\n\n\n\n\n\n  return func(now+1) + func(now+2) + func(now+3);\n\n}\n\n\n\nint main(void){\n\n  while(1){\n\n    int ans;\n\n    std::cin >> n;\n\n\n\n    for(int i=0; i < 30; i++){\n\n      dp[i] = -1;\n\n    }\n\n\n\n    if(n == 0){\n\n      return 0;\n\n    }\n\n\n\n    cmb = 0;\n\n    ans = func(0);\n\n\n\n    std::cout << ans / 10 / 365 + 1 << std::endl;\n\n  }\n\n}",
        "optimized_code": "#include <iostream>\n\n\n\nint n;\n\nint cmb;\n\nint dp[31];\n\n\n\n/*\n\nint func(int now){\n\n  if(now > n)\n\n    return 0;\n\n  if(now == n){\n\n    dp[now] = 1;\n\n    return 1;\n\n  }\n\n\n\n\n\n  return func(now+1) + func(now+2) + func(now+3);\n\n}\n\n*/\n\n\n\nint func(int now){\n\n  int a[3];\n\n  if(now < 0){\n\n    return 0;\n\n  }\n\n  if(now == 0){\n\n    return 0;\n\n  }\n\n  if(now == 1){\n\n    return 1;\n\n  }\n\n  if(now == 2){\n\n    return 2;\n\n  }\n\n  if(now == 3){\n\n    return 4;\n\n  }\n\n\n\n  for(int i=1; i <= 3; i++){\n\n    if(dp[now-i] != -1){\n\n      a[i-1] = dp[now-i];\n\n    }else{\n\n      a[i-1] = func(now-i);\n\n      dp[now-i] = a[i-1];\n\n    }\n\n  }\n\n\n\n  return a[0] + a[1] + a[2];\n\n\n\n}\n\n\n\nint main(void){\n\n  while(1){\n\n    int ans;\n\n    std::cin >> n;\n\n\n\n    for(int i=0; i < 31; i++){\n\n      dp[i] = -1;\n\n    }\n\n\n\n    if(n == 0){\n\n      return 0;\n\n    }\n\n\n\n    cmb = 0;\n\n    ans = func(n);\n\n\n\n    std::cout << ans / 10 / 365 + 1 << std::endl;\n\n  }\n\n}"
    },
    {
        "id": "395",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define int long long\n\n#define vvi vector<vector<int>>\n\n#define vec vector\n\n#define pq priority_queue\n\n#define all(v) (v).begin(), (v).end()\n\n#define uniqueV(x) sort(x.begin(), x.end()); x.erase(unique(x.begin(), x.end()), x.end());\n\n#define rep(i, n) for (int (i) = (0); (i) < (n); ++(i))\n\n#define repp(i, m, n) for (int (i) = (m); (i) < (n); ++(i))\n\n#define dbg(x) cerr << #x << \": \" << x << endl;\n\n#define dbg2(x, y) cerr<<\"(\"<<#x<<\", \"<<#y<<\") = \"<<\"(\"<<x<<\", \"<<y<<\")\"<<endl;\n\n#define dbg3(x, y, z) cerr<<\"(\"<<#x<<\", \"<<#y<<\", \"<<#z<<\") = \"<<\"(\"<<x<<\", \"<<y<<\", \"<<z<<\")\"<<endl;\n\n#define dbgB(value, size) cerr<<#value<<\": \"<<bitset<size>(value) << endl;\n\n#define line() cerr << \"---------------\" << endl;\n\n\n\nconst int dx[] = {1, -1, 0, 0};\n\nconst int dy[] = {0, 0, -1, 1};\n\nconst double PI = 3.14159265358979323846;\n\n\n\ntemplate<class T>bool chmax(T &a, const T &b) { if (a<b) { a = b; return 1; } return 0; }\n\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a = b; return 1; } return 0; }\n\n\n\ntemplate<typename T, typename U>\n\nvoid print1(T Array, U size) {\n\n  for (int i = 0; i < size; i++) {\n\n    cout << Array[i] << \" \";\n\n  }\n\n  cout << endl;\n\n}\n\n\n\ntemplate<typename T>\n\nvoid print(T Array, int height, int width) {\n\n  for (int i = 0; i < height; i++) {\n\n    for (int j = 0; j < width; j++) {\n\n      cout << \" \" << Array[i][j];\n\n    }\n\n    cout << endl;\n\n  }\n\n}\n\n\n\n// ------------------------------------------------------------------------------------------\n\n\n\nint n;\n\n\n\nint rec(int stage) {\n\n  if (stage == 0) {\n\n    return 1;\n\n  }\n\n\n\n  int ans = 0;\n\n\n\n  for (int i = 1; i <= 3; i++) {\n\n    if (stage - i < 0) continue;\n\n    ans += rec(stage - i);\n\n  }\n\n\n\n  return ans;\n\n}\n\n\n\nsigned main() {\n\n  while (1) {\n\n    cin >> n;\n\n    if (n == 0) break;\n\n    int t = (rec(n) + 3650 - 1) / 3650;\n\n    cout << t << endl;\n\n  }\n\n\n\n  return 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define int long long\n\n#define vvi vector<vector<int>>\n\n#define vec vector\n\n#define pq priority_queue\n\n#define all(v) (v).begin(), (v).end()\n\n#define uniqueV(x) sort(x.begin(), x.end()); x.erase(unique(x.begin(), x.end()), x.end());\n\n#define rep(i, n) for (int (i) = (0); (i) < (n); ++(i))\n\n#define repp(i, m, n) for (int (i) = (m); (i) < (n); ++(i))\n\n#define dbg(x) cerr << #x << \": \" << x << endl;\n\n#define dbg2(x, y) cerr<<\"(\"<<#x<<\", \"<<#y<<\") = \"<<\"(\"<<x<<\", \"<<y<<\")\"<<endl;\n\n#define dbg3(x, y, z) cerr<<\"(\"<<#x<<\", \"<<#y<<\", \"<<#z<<\") = \"<<\"(\"<<x<<\", \"<<y<<\", \"<<z<<\")\"<<endl;\n\n#define dbgB(value, size) cerr<<#value<<\": \"<<bitset<size>(value) << endl;\n\n#define line() cerr << \"---------------\" << endl;\n\n\n\nconst int dx[] = {1, -1, 0, 0};\n\nconst int dy[] = {0, 0, -1, 1};\n\nconst double PI = 3.14159265358979323846;\n\n\n\ntemplate<class T>bool chmax(T &a, const T &b) { if (a<b) { a = b; return 1; } return 0; }\n\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a = b; return 1; } return 0; }\n\n\n\ntemplate<typename T, typename U>\n\nvoid print1(T Array, U size) {\n\n  for (int i = 0; i < size; i++) {\n\n    cout << Array[i] << \" \";\n\n  }\n\n  cout << endl;\n\n}\n\n\n\ntemplate<typename T>\n\nvoid print(T Array, int height, int width) {\n\n  for (int i = 0; i < height; i++) {\n\n    for (int j = 0; j < width; j++) {\n\n      cout << \" \" << Array[i][j];\n\n    }\n\n    cout << endl;\n\n  }\n\n}\n\n\n\n// ------------------------------------------------------------------------------------------\n\n\n\nint n;\n\nint dp[55];\n\n\n\nint rec(int stage) {\n\n  if (stage == 0) {\n\n    return dp[stage] = 1;\n\n  }\n\n  \n\n  if (dp[stage] != -1) {\n\n    return dp[stage];\n\n  }\n\n\n\n  int ans = 0;\n\n\n\n  for (int i = 1; i <= 3; i++) {\n\n    if (stage - i < 0) continue;\n\n    ans += rec(stage - i);\n\n  }\n\n\n\n  return dp[stage] = ans;\n\n}\n\n\n\nsigned main() {\n\n  fill(dp, dp+33, -1);\n\n  rec(30);\n\n  while (1) {\n\n    cin >> n;\n\n    if (n == 0) break;\n\n    int t = (dp[n] + 3650 - 1) / 3650;\n\n    cout << t << endl;\n\n  }\n\n\n\n  return 0;\n\n}\n"
    },
    {
        "id": "396",
        "source_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<iostream>\n\n#include<algorithm>\n\nusing namespace std;\n\nint n,x,t=1;\n\nint main(){\n\n    cin>>n>>x;\n\n    if(x==1||x==2*n-1){\n\n        cout<<\"No\"<<endl;\n\n        return 0;\n\n    }\n\n    cout<<\"Yes\"<<endl;\n\n    for(int i=1;i<n-1;i++){\n\n        while(t==x||t==x-1||t==x+1) t++;\n\n        cout<<t++<<endl;\n\n    }\n\n    cout<<x-1<<endl<<x<<endl<<x+1<<endl;\n\n    for(int i=1;i<n-1;i++){\n\n        while(t==x||t==x-1||t==x+1) t++;\n\n        cout<<t++<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n\n\nint N,X;\n\n\n\nint main(){\n\n    scanf(\"%d%d\",&N,&X);\n\n    if(X==1||X==2*N-1)\n\n        return !puts(\"No\");\n\n    puts(\"Yes\");\n\n    if(N==2)\n\n        return !puts(\"1\\n2\\n3\");\n\n    if(X==2){\n\n        for(int i=1;i<=N-2;i++)\n\n            printf(\"%d\\n\",4+i);\n\n        printf(\"3\\n2\\n1\\n4\\n\");\n\n        for(int i=1;i<=N-3;i++)\n\n            printf(\"%d\\n\",N+2+i);\n\n        return 0;\n\n    }\n\n    int cnt=1;\n\n    for(int i=1;i<=N-2;i++){\n\n        if(cnt==X-2)\n\n            cnt=X+2;\n\n        printf(\"%d\\n\",cnt++);\n\n    }\n\n    printf(\"%d\\n%d\\n%d\\n%d\\n\",X-1,X,X+1,X-2);\n\n    for(int i=1;i<=N-3;i++){\n\n        if(cnt==X-2)\n\n            cnt=X+2;\n\n        printf(\"%d\\n\",cnt++);\n\n    }\n\n}\n"
    },
    {
        "id": "397",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef vector<int> VI;\n\ntypedef vector<VI> VVI;\n\ntypedef vector<ll> VL;\n\ntypedef vector<VL> VVL;\n\ntypedef pair<int, int> PII;\n\n\n\n#define FOR(i, a, n) for (int i = (int)a; i < (int)n; ++i)\n\n#define REP(i, n) FOR(i, 0, n)\n\n#define ALL(x) x.begin(), x.end()\n\n#define MOD 1000000007\n\n#define INF 1000000000\n\n#define PI 3.14159265359\n\n#define EPS 1e-12\n\n\n\nint main(){\n\n\n\n\tint n,x;\n\n\tcin >> n;\n\n\tcin >> x;\n\n\n\n\tif(x == 1 || x == 2 * n - 1){\n\n\t\tcout << \"No\" << endl;\n\n\t\treturn 0;\n\n\t}else{\n\n\t\tcout << \"Yes\" << endl;\n\n    int ans[200010] = {0};\n\n    bool used[200010] = {false};\n\n\n\n\t\tif(x > n){\n\n\t\t\tans[n+1] = x + 1; ans[n+2] = x - 2; ans[n] = x;\tans[n-1] = x - 1;\n\n\t\t\tused[x+1] = true; used[x-2] = true; used[x-1] = true; used[x] = true;\n\n\t\t}else{\n\n\t\t\tans[n+1] = x - 1; ans[n+2] = x + 2; ans[n] = x; ans[n-1] = x + 1;\n\n\t\t\tused[x-1] = 1; used[x+2] = 1; used[x+1] = 1; used[x] = true;\n\n\t\t}\n\n\n\n\t\tint cnt = 1;\n\n\t\tfor(int i = 1; i < 2 * n; i++){\n\n\t\t\tif(ans[i] == 0){\n\n\t\t\t\twhile(used[cnt]){\n\n\t\t\t\t\tcnt++;\n\n\t\t\t\t}\n\n\t\t\t\tans[i] = cnt;\n\n\t\t\t\tcnt++;\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\tfor(int i = 1; i < 2 * n; i++){\n\n\t\t\tcout << ans[i] << endl;\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef vector<int> VI;\n\ntypedef vector<VI> VVI;\n\ntypedef vector<ll> VL;\n\ntypedef vector<VL> VVL;\n\ntypedef pair<int, int> PII;\n\n\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n\n#define REP(i, n) FOR(i, 0, n)\n\n#define ALL(x) x.begin(), x.end()\n\n#define MOD 1000000007\n\n#define INF (1LL << 25) // 33554432\n\n#define PI 3.14159265359\n\n#define EPS 1e-12\n\n//#define int ll\n\n\n\nsigned main(void) {\n\n  int n, x;\n\n  cin >> n >> x;\n\n  if (x == 1 || x == 2 * n - 1) {\n\n    cout << \"No\" << endl;\n\n    return 0;\n\n  }\n\n  if(n == 2) {\n\n    cout << \"Yes\" << endl;\n\n    cout << 1 << endl << 2 << endl << 3 << endl;\n\n    return 0;\n\n  }\n\n\n\n  VI v, ans;\n\n  if (x == 2) {\n\n    REP(i, 2 * n - 1) {\n\n      if(i+1 != 1 && i+1 != 2 && i+1 != 3 && i+1 != 4) v.push_back(i + 1);\n\n    }\n\n    REP(i, n - 2) ans.push_back(v[i]);\n\n    ans.push_back(3);\n\n    ans.push_back(2);\n\n    ans.push_back(1);\n\n    ans.push_back(4);\n\n    FOR(i, n + 2, 2 * n - 1) ans.push_back(v[i-4]);\n\n  } else {\n\n    REP(i, 2 * n - 1) {\n\n      if(i+1 != x-2 && i+1 != x-1 && i+1 != x && i+1 != x+1) v.push_back(i + 1);\n\n    }\n\n    //for(int i=0; i<v.size(); ++i) cout << v[i] << \" \"; cout << endl;\n\n    REP(i, n - 2) ans.push_back(v[i]);\n\n    ans.push_back(x - 1);\n\n    ans.push_back(x);\n\n    ans.push_back(x + 1);\n\n    ans.push_back(x - 2);\n\n    FOR(i, n + 2, 2 * n - 1) ans.push_back(v[i-4]);\n\n  }\n\n\n\n  cout << \"Yes\" << endl;\n\n  //cout << ans.size() << endl;\n\n  for (int i : ans)\n\n    cout << i << endl;\n\n\n\n  return 0;\n\n}\n"
    },
    {
        "id": "398",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef vector<int> VI;\n\ntypedef vector<VI> VVI;\n\ntypedef vector<ll> VL;\n\ntypedef vector<VL> VVL;\n\ntypedef pair<int, int> PII;\n\n\n\n#define FOR(i, a, n) for (int i = (int)a; i < (int)n; ++i)\n\n#define REP(i, n) FOR(i, 0, n)\n\n#define ALL(x) x.begin(), x.end()\n\n#define MOD 1000000007\n\n#define INF 1000000000\n\n#define PI 3.14159265359\n\n#define EPS 1e-12\n\n\n\nint main(){\n\n\n\n\tint n,x;\n\n\tcin >> n;\n\n\tcin >> x;\n\n\n\n\tif(x == 1 || x == 2 * n - 1){\n\n\t\tcout << \"No\" << endl;\n\n\t\treturn 0;\n\n\t}else{\n\n\t\tcout << \"Yes\" << endl;\n\n    int ans[200010] = {0};\n\n    bool used[200010] = {false};\n\n\n\n\t\tif(x > n){\n\n\t\t\tans[n+1] = x + 1; ans[n+2] = x - 2; ans[n] = x;\tans[n-1] = x - 1;\n\n\t\t\tused[x+1] = true; used[x-2] = true; used[x-1] = true; used[x] = true;\n\n\t\t}else{\n\n\t\t\tans[n+1] = x - 1; ans[n+2] = x + 2; ans[n] = x; ans[n-1] = x + 1;\n\n\t\t\tused[x-1] = 1; used[x+2] = 1; used[x+1] = 1; used[x] = true;\n\n\t\t}\n\n\n\n\t\tint cnt = 1;\n\n\t\tfor(int i = 1; i < 2 * n; i++){\n\n\t\t\tif(ans[i] == 0){\n\n\t\t\t\twhile(used[cnt]){\n\n\t\t\t\t\tcnt++;\n\n\t\t\t\t}\n\n\t\t\t\tans[i] = cnt;\n\n\t\t\t\tcnt++;\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\tfor(int i = 1; i < 2 * n; i++){\n\n\t\t\tcout << ans[i] << endl;\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n\nusing PII = pair<ll, ll>;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n\n#define REP(i, n) FOR(i, 0, n)\n\n#define ALL(x) x.begin(), x.end()\n\ntemplate<typename T> void chmin(T &a, const T &b) { a = min(a, b); }\n\ntemplate<typename T> void chmax(T &a, const T &b) { a = max(a, b); }\n\nstruct FastIO {FastIO() { cin.tie(0); ios::sync_with_stdio(0); }}fastiofastio;\n\n#ifdef DEBUG\n\n#include \"../program_contest_library/memo/dump.hpp\"\n\n#else\n\n#define dump(...)\n\n#endif\n\nconst ll INF = 1LL<<60;\n\n\n\nint main(void) {\n\n    ll n, x;\n\n    cin >> n >> x;\n\n\n\n    // map<ll,vector<ll>> mp;\n\n    // vector<ll> ord(2*n-1);\n\n    // iota(ALL(ord), 1);\n\n    // do {\n\n    //     vector<ll> a(ord);\n\n    //     for(ll len=2*n-3; len>=1; len-=2) {\n\n    //         vector<ll> na(len);\n\n    //         auto get = [](ll p, ll q, ll r) { \n\n    //             ll mi = min({p, q, r}), ma = max({p, q, r});\n\n    //             if(p != mi && p != ma) return p;\n\n    //             if(q != mi && q != ma) return q;\n\n    //             return r;\n\n    //         };\n\n    //         REP(i, len) na[i] = get(a[i], a[i+1], a[i+2]);\n\n    //         a = move(na);\n\n    //     }\n\n    //     mp[a[0]] = ord;\n\n    // } while(next_permutation(ALL(ord)));\n\n\n\n    // dump(mp);\n\n\n\n    if(x == 1 || x == 2*n-1) {\n\n        cout << \"No\\n\";\n\n        return 0;\n\n    }\n\n\n\n    if(n == 2) {\n\n        cout << \"Yes\\n\";\n\n        cout << \"1\\n2\\n3\\n\";\n\n        return 0;\n\n    }\n\n\n\n    vector<ll> ans(2*n-1);\n\n    vector<bool> used(2*n-1);\n\n    if(x+2 <= 2*n-1) {\n\n        ans[n-2] = x+2;\n\n        ans[n-1] = x;\n\n        ans[n]   = 1;\n\n        ans[n+1] = x+1;\n\n        used[0] = used[x-1] = used[x] = used[x+1] = true;\n\n    } else {\n\n        ans[n-2] = x-2;\n\n        ans[n-1] = x;\n\n        ans[n]   = 2*n-1;\n\n        ans[n+1] = x-1;\n\n        used[x-3] = used[x-2] = used[x-1] = used[2*n-2] = true;\n\n    }\n\n\n\n    ll idx = 0;\n\n    REP(i, n-2) {\n\n        while(idx<2*n-1 && used[idx]) idx++;\n\n        ans[i] = idx+1;\n\n        used[idx] = true;\n\n    }\n\n    FOR(i, n+2, 2*n-1) {\n\n        while(idx<2*n-1 && used[idx]) idx++;\n\n        ans[i] = idx+1;\n\n        used[idx] = true;\n\n    }\n\n\n\n    cout << \"Yes\\n\";\n\n    REP(i, 2*n-1) cout << ans[i] << \"\\n\";\n\n\n\n    return 0;\n\n}"
    },
    {
        "id": "399",
        "source_code": "#include \"iostream\"\n\n#include \"climits\"\n\n#include \"list\"\n\n#include \"queue\"\n\n#include \"stack\"\n\n#include \"set\"\n\n#include \"functional\"\n\n#include \"algorithm\"\n\n#include \"math.h\"\n\n#include \"utility\"\n\n#include \"string\"\n\n#include \"map\"\n\n#include \"unordered_map\"\n\n#include \"iomanip\"\n\n#include \"random\"\n\n\n\nusing namespace std;\n\nconst long long int MOD = 1000000007;\n\n\n\nlong long int power(long long int x, long long int n, long long int M) {\n\n\tlong long int tmp = 1;\n\n\n\n\tif (n > 0) {\n\n\t\ttmp = power(x, n / 2, M);\n\n\t\tif (n % 2 == 0) tmp = (tmp*tmp) % M;\n\n\t\telse tmp = (((tmp*tmp) % M)*x) % M;\n\n\t}\n\n\treturn tmp;\n\n}\n\n\n\nlong long int N, M, K, Q, W, H, L, R;\n\nlong long int ans;\n\n\n\nusing namespace std;\n\n\n\n\n\nint main() {\n\n\tios::sync_with_stdio(false);\n\n\tcin >> N >> M;\n\n\tif (M == 1 || M == 2 * N - 1) {\n\n\t\tcout << \"No\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tcout << \"Yes\\n\";\n\n\tif (N == 2) {\n\n\t\tcout << \"1 2 3\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tint num[500000] = {};\n\n\tbool flag[500000] = {};\n\n\tflag[M] = true;\n\n\tflag[M - 1] = true;\n\n\tflag[M + 1] = true;\n\n\tnum[N] = M;\n\n\tnum[N - 1] = M - 1;\n\n\tnum[N + 1] = M + 1;\n\n\tif (M != 2 * N - 2) {\n\n\t\tnum[N - 2] = M + 2;\n\n\t\tflag[M + 2] = true;\n\n\t}\n\n\tif (M != 2) {\n\n\t\tnum[N + 2] = M - 2;\n\n\t\tflag[M-2] = true;\n\n\t}\n\n\tint box = 1;\n\n\tfor (int i = 1; i <= N * 2 - 1; i++) {\n\n\t\tif (num[i])continue;\n\n\t\twhile (flag[box])box++;\n\n\t\tnum[i] = box;\n\n\t\tflag[box] = true;\n\n\t}\n\n\tfor (int i = 1; i <= 2 * N - 1; i++) {\n\n\t\tcout << num[i] << endl;\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include \"iostream\"\n\n#include \"climits\"\n\n#include \"list\"\n\n#include \"queue\"\n\n#include \"stack\"\n\n#include \"set\"\n\n#include \"functional\"\n\n#include \"algorithm\"\n\n#include \"string\"\n\n#include \"map\"\n\n#include \"unordered_map\"\n\n#include \"unordered_set\"\n\n#include \"iomanip\"\n\n#include \"cmath\"\n\n#include \"random\"\n\n#include \"bitset\"\n\n#include \"cstdio\"\n\n#include \"numeric\"\n\n#include \"cassert\"\n\n\n\nusing namespace std;\n\n\n\nconst long long int MOD = 1000000007;\n\n//const int MOD = 998244353;\n\n\n\nlong long int N, M, K, H, W, L, R;\n\n//int N, M, K, H, W, L, R;\n\n\n\n\n\nint main() {\n\n\tios::sync_with_stdio(false);\n\n\tcin.tie(0);\n\n\n\n\tcin >> N >> K;\n\n\tif (K == 1 || K == N * 2 - 1) {\n\n\t\tcout << \"No\\n\";\n\n\t\treturn 0;\n\n\t}\n\n\tvector<int>ans(N * 2 - 1);\n\n\tvector<int>used(N * 2, 0);\n\n\tans[N] = K + 1;\n\n\tans[N - 1] = K;\n\n\tans[N - 2] = K - 1;\n\n\tused[K]++;\n\n\tused[K - 1]++;\n\n\tused[K + 1]++;\n\n\tif (K - 2) {\n\n\t\tans[N + 1] = K - 2;\n\n\t\tused[K - 2]++;\n\n\t}\n\n\tif (K + 2 <= N * 2 - 1) {\n\n\t\tans[N - 3] = K + 2;\n\n\t\tused[K + 2]++;\n\n\t}\n\n\tint index = 1;\n\n\tfor (auto &i : ans) {\n\n\t\tif (i)continue;\n\n\t\twhile (used[index])index++;\n\n\t\ti = index;\n\n\t\tused[index]++;\n\n\t}\n\n\tcout << \"Yes\\n\";\n\n\tfor (auto i : ans)cout << i << endl;\n\n\treturn 0;\n\n}"
    },
    {
        "id": "400",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\nint a[200005];\n\nint main(int argc, char** argv) {\n\n\tint n,m;\n\n\tcin >> n >> m;\n\n\tif(m==1||m==2*n-1)\n\n\t{\n\n\t\tputs(\"No\");\n\n\t\treturn 0;\n\n\t}\n\n\tputs(\"Yes\");\n\n\ta[n]=m;\n\n\ta[n-1]=m-1;\n\n\ta[n+1]=m+1;\n\n\tint now=0;\n\n\tfor(int i=1;i<n*2;i++)\n\n\t{\n\n\t\tif(i==n||i==n-1||i==n+1)\n\n\t\t\tcontinue;\n\n\t\t++now;\n\n\t\tif(now==m-1)\n\n\t\t\tnow=m+2;\n\n\t\ta[i]=now;\n\n\t}\n\n\tfor(int i=1;i<n*2;i++)\n\n\t\tcout << a[i] << endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n\n\nint N,X;\n\n\n\nint main(){\n\n    scanf(\"%d%d\",&N,&X);\n\n    if(X==1||X==2*N-1)\n\n        return !puts(\"No\");\n\n    puts(\"Yes\");\n\n    if(N==2)\n\n        return !puts(\"1\\n2\\n3\");\n\n    if(X==2){\n\n        for(int i=1;i<=N-2;i++)\n\n            printf(\"%d\\n\",4+i);\n\n        printf(\"3\\n2\\n1\\n4\\n\");\n\n        for(int i=1;i<=N-3;i++)\n\n            printf(\"%d\\n\",N+2+i);\n\n        return 0;\n\n    }\n\n    int cnt=1;\n\n    for(int i=1;i<=N-2;i++){\n\n        if(cnt==X-2)\n\n            cnt=X+2;\n\n        printf(\"%d\\n\",cnt++);\n\n    }\n\n    printf(\"%d\\n%d\\n%d\\n%d\\n\",X-1,X,X+1,X-2);\n\n    for(int i=1;i<=N-3;i++){\n\n        if(cnt==X-2)\n\n            cnt=X+2;\n\n        printf(\"%d\\n\",cnt++);\n\n    }\n\n}"
    },
    {
        "id": "401",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n\n\nint main()\n\n{\n\n  int N, x;\n\n\n\n  cin >> N >> x;\n\n\n\n\n\n  int bottom = 2 * N - 1;\n\n  deque< int > val;\n\n  bool used[500001] = {};\n\n\n\n  if(2 <= x && x + 2 <= bottom) {\n\n    val.push_back(x + 1);\n\n    used[x + 1] = true;\n\n    val.push_back(x);\n\n    used[x] = true;\n\n    val.push_back(x - 1);\n\n    used[x - 1] = true;\n\n    val.push_back(x + 2);\n\n    used[x + 2] = true;\n\n\n\n\n\n  } else if(1 <= x - 2 && x + 1 <= bottom) {\n\n    val.push_back(x - 1);\n\n    used[x - 1] = true;\n\n    val.push_back(x);\n\n    used[x] = true;\n\n    val.push_back(x + 1);\n\n    used[x + 1] = true;\n\n    val.push_back(x - 2);\n\n    used[x - 2] = true;\n\n  }\n\n\n\n\n\n  if(val.empty()) {\n\n    if(N == 2 && x == 2) {\n\n      cout << \"Yes\" << endl;\n\n      cout << \"1\" << endl;\n\n      cout << \"2\" << endl;\n\n      cout << \"3\" << endl;\n\n    } else {\n\n      cout << \"No\" << endl;\n\n    }\n\n  } else {\n\n    bool first = false;\n\n    int left = bottom / 2 - 1;\n\n    for(int i = 1; i <= bottom; i++) {\n\n      if(!used[i]) {\n\n        --left;\n\n        if(left >= 0) val.push_front(i);\n\n        else val.push_back(i);\n\n      }\n\n    }\n\n    \n\n    cout << \"Yes\" << endl;\n\n    for(int v : val) {\n\n      cout << v << endl;\n\n    }\n\n  }\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nusing int64 = long long;\n\n\n\nstruct INFTY {\n\n  const int64 infll = (1LL << 62) - 1;\n\n  const int inf = (1 << 30) - 1;\n\n\n\n  operator int64() { return infll; }\n\n\n\n  operator int() { return inf; }\n\n} inf;\n\n\n\nstruct IoSetup {\n\n  IoSetup() {\n\n    cin.tie(nullptr);\n\n    ios::sync_with_stdio(false);\n\n    cout << fixed << setprecision(10);\n\n    cerr << fixed << setprecision(10);\n\n  }\n\n} iosetup;\n\n\n\ntemplate< typename T >\n\nostream &operator<<(ostream &os, const vector< T > &v) {\n\n  for(int i = 0; i < (int) v.size(); i++) {\n\n    os << v[i] << (i + 1 != v.size() ? \" \" : \"\");\n\n  }\n\n  return os;\n\n}\n\n\n\ntemplate< typename T >\n\nistream &operator>>(istream &is, vector< T > &v) {\n\n  for(T &in : v) is >> in;\n\n  return is;\n\n}\n\n\n\ntemplate< typename T1, typename T2 >\n\ninline bool chmax(T1 &a, T2 b) { return a < b && (a = b, true); }\n\n\n\ntemplate< typename T1, typename T2 >\n\ninline bool chmin(T1 &a, T2 b) { return a > b && (a = b, true); }\n\n\n\ntemplate< typename T = int64 >\n\nvector< T > make_v(size_t a) {\n\n  return vector< T >(a);\n\n}\n\n\n\ntemplate< typename T, typename... Ts >\n\nauto make_v(size_t a, Ts... ts) {\n\n  return vector< decltype(make_v< T >(ts...)) >(a, make_v< T >(ts...));\n\n}\n\n\n\ntemplate< typename T, typename V >\n\ntypename enable_if< is_class< T >::value == 0 >::type fill_v(T &t, const V &v) {\n\n  t = v;\n\n}\n\n\n\ntemplate< typename T, typename V >\n\ntypename enable_if< is_class< T >::value != 0 >::type fill_v(T &t, const V &v) {\n\n  for(auto &e : t) fill_v(e, v);\n\n}\n\n\n\nint main() {\n\n  int N, K;\n\n  cin >> N >> K;\n\n  if(K == 1 || K == 2 * N - 1) {\n\n    cout << \"No\" << endl;\n\n    return 0;\n\n  }\n\n  cout << \"Yes\" << endl;\n\n  if(N == 2) {\n\n    cout << \"1 2 3\" << endl;\n\n    return 0;\n\n  }\n\n\n\n  vector< int > ans(2 * N - 1, -1);\n\n  if(K != 2) {\n\n    ans[N - 2] = K - 1;\n\n    ans[N - 1] = K;\n\n    ans[N] = K + 1;\n\n    ans[N + 1] = K - 2;\n\n  } else {\n\n    ans[N - 2] = K + 1;\n\n    ans[N - 1] = K;\n\n    ans[N] = K - 1;\n\n    ans[N + 1] = K + 2;\n\n  }\n\n\n\n  vector< int > used(2 * N);\n\n  for(auto &p : ans) if(~p) used[p] = true;\n\n  int now = 1;\n\n  for(auto &p : ans) {\n\n    if(~p) continue;\n\n    while(used[now]) ++now;\n\n    used[now] = true;\n\n    p = now;\n\n  }\n\n  for(auto &p : ans) cout << p << endl;\n\n}\n"
    },
    {
        "id": "402",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\nint a[200005];\n\nint main(int argc, char** argv) {\n\n\tint n,m;\n\n\tcin >> n >> m;\n\n\tif(m==1||m==2*n-1)\n\n\t{\n\n\t\tputs(\"No\");\n\n\t\treturn 0;\n\n\t}\n\n\tputs(\"Yes\");\n\n\ta[n]=m;\n\n\ta[n-1]=m-1;\n\n\ta[n+1]=m+1;\n\n\tint now=0;\n\n\tfor(int i=1;i<n*2;i++)\n\n\t{\n\n\t\tif(i==n||i==n-1||i==n+1)\n\n\t\t\tcontinue;\n\n\t\t++now;\n\n\t\tif(now==m-1)\n\n\t\t\tnow=m+2;\n\n\t\ta[i]=now;\n\n\t}\n\n\tfor(int i=1;i<n*2;i++)\n\n\t\tcout << a[i] << endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <algorithm>\n\n#include <cstdio>\n\nusing namespace std;\n\n\n\nint main() {\n\n\tint n, x; scanf(\"%d%d\", &n, &x);\n\n\tif(x == 1 || x == 2 * n - 1) return puts(\"No\"), 0;\n\n\tputs(\"Yes\"); int t = 1;\n\n\tfor(int i = 1; i < n - 1; i ++) {\n\n\t\twhile(abs(t - x) <= 1) t ++;\n\n\t\tprintf(\"%d\\n\", t ++);\n\n\t}\n\n\tprintf(\"%d\\n%d\\n%d\\n\", x - 1, x, x + 1);\n\n\tfor(int i = n + 2; i < 2 * n; i ++) {\n\n\t\twhile(abs(t - x) <= 1) t ++;\n\n\t\tprintf(\"%d\\n\", t ++);\n\n\t}\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "403",
        "source_code": "#include<bits/stdc++.h>\n\n#define rep(i,n)for(int i=0;i<n;i++)\n\n#define MOD 1000000007\n\n#define INF 0x3f3f3f3f\n\n#define INFL 0x3f3f3f3f3f3f3f3f\n\n#define EPS (1e-10)\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int, int>P;\n\n\n\nbool used[1000000];\n\nint main() {\n\n\t/*vector<int>v(7);\n\n\tiota(v.begin(), v.end(), 1);\n\n\tset<int>se;\n\n\tdo {\n\n\t\tvector<int>d1, d2 = v;\n\n\t\twhile (d2.size() > 1) {\n\n\t\t\trep(i, d2.size() - 2) {\n\n\t\t\t\tvector<int>e{ d2[i],d2[i + 1],d2[i + 2] };\n\n\t\t\t\tsort(e.begin(), e.end());\n\n\t\t\t\td1.push_back(e[1]);\n\n\t\t\t}\n\n\t\t\td2 = d1;\n\n\t\t\td1.clear();\n\n\t\t}\n\n\t\tif (d2[0] == 5) {\n\n\t\t\tfor (int j : v) {\n\n\t\t\t\tcout << j << ' ';\n\n\t\t\t}\n\n\t\t\tcout << endl;\n\n\t\t}\n\n\t\tse.insert(d2[0]);\n\n\t} while (next_permutation(v.begin(), v.end()));\n\n\tfor (int i : se) {\n\n\t\tcout << i << endl;\n\n\t}*/\n\n\tll n, x; scanf(\"%lld%lld\", &n, &x);\n\n\tll j = 2 * n - 1;\n\n\tif (x != 1 && x != j) {\n\n\t\tputs(\"Yes\");\n\n\t\tif (x + j / 2 <= j) {\n\n\t\t\tfor (ll i = x + j / 2; i >= x; i--) {\n\n\t\t\t\tprintf(\"%lld\\n\", i); used[i] = true;\n\n\t\t\t}\n\n\t\t\tfor (ll i = 1; i <= j; i++) {\n\n\t\t\t\tif (!used[i])printf(\"%lld\\n\", i);\n\n\t\t\t}\n\n\t\t}\n\n\t\telse {\n\n\t\t\tfor (ll i = x - j / 2; i <= x; i++) {\n\n\t\t\t\tprintf(\"%lld\\n\", i); used[i] = true;\n\n\t\t\t}\n\n\t\t\tfor (ll i = j; i >= 1; i--) {\n\n\t\t\t\tif (!used[i])printf(\"%lld\\n\", i);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\telse {\n\n\t\tputs(\"No\");\n\n\t}\n\n}",
        "optimized_code": "#include<stdio.h>\n\nusing namespace std;\n\n\n\nbool used[900000];\n\nint main() {\n\n\tint n, x; scanf(\"%d%d\", &n, &x);\n\n\tint j = 2 * n - 1;\n\n\tif (x != 1 && x != j) {\n\n\t\tputs(\"Yes\");\n\n\t\tif (x + j / 2 <= j) {\n\n\t\t\tfor (int i = x + j / 2; i >= x; i--) { printf(\"%d\\n\", i); used[i] = true; }\n\n\t\t\tfor (int i = 1; i <= j; i++) { if (!used[i])printf(\"%d\\n\", i); }\n\n\t\t}\n\n\t\telse {\n\n\t\t\tfor (int i = x - j / 2; i <= x; i++) { printf(\"%d\\n\", i); used[i] = true; }\n\n\t\t\tfor (int i = j; i >= 1; i--) { if (!used[i])printf(\"%d\\n\", i); }\n\n\t\t}\n\n\t}\n\n\telse puts(\"No\");\n\n}"
    },
    {
        "id": "415",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\n#define REP(i,n) for(int i=0,_n=(int)(n);i<_n;++i)\n\n#define ALL(v) (v).begin(),(v).end()\n\n#define CLR(t,v) memset(t,(v),sizeof(t))\n\ntemplate<class T1,class T2>ostream& operator<<(ostream& os,const pair<T1,T2>&a){return os<<\"(\"<<a.first<<\",\"<<a.second<< \")\";}\n\ntemplate<class T>void pv(T a,T b){for(T i=a;i!=b;++i)cout<<(*i)<<\" \";cout<<endl;}\n\ntemplate<class T>void chmin(T&a,const T&b){if(a>b)a=b;}\n\ntemplate<class T>void chmax(T&a,const T&b){if(a<b)a=b;}\n\n\n\nint nextInt() { int x; scanf(\"%d\", &x); return x;}\n\nll nextLong() { ll x; scanf(\"%lld\", &x); return x;}\n\n\n\nconst int MAX_N = 212345;\n\nconst int MAX_A = 212345;\n\nint A[MAX_N * 2];\n\nint nxt[MAX_N * 2];\n\nint inc[MAX_N * 2];\n\nint last[MAX_A];\n\nll vis[MAX_N * 2];\n\nbool isin[MAX_A];\n\n\n\nint main2() {\n\n  int N = nextInt();\n\n  ll K = nextLong();\n\n  REP(i, N) A[i] = nextInt();\n\n  REP(i, N) A[i + N] = A[i];\n\n\n\n  CLR(last, -1);\n\n  CLR(inc, 0);\n\n\n\n  REP(i, 2 * N) {\n\n    if (last[A[i]] >= 0) {\n\n      nxt[ last[A[i]] ] = (i + 1) % N;\n\n      inc[ last[A[i]] ] = (i + 1) / N;\n\n    }\n\n    last[A[i]] = i;\n\n  }\n\n  // pv(A, A+N);\n\n  // pv(nxt, nxt + N);\n\n  // pv(inc, inc + N);\n\n\n\n  CLR(vis, -1);\n\n  ll k = 0;\n\n  int pos = 0;\n\n  while (vis[pos] == -1) {\n\n    vis[pos] = k;\n\n    k += inc[pos];\n\n    pos = nxt[pos];\n\n  }\n\n\n\n  ll L = k - vis[pos];\n\n  // cout << \"L=\" << L << endl;\n\n  // cout << \"k=\" << k << endl;\n\n  if (K - k >= 2) {\n\n    k += (K - k - 1) / L * L;\n\n  } else {\n\n    k = 0;\n\n    pos = 0;\n\n  }\n\n  // cout << \"k=\" << k << endl;\n\n\n\n  while (k < K - 1) {\n\n    k += inc[pos];\n\n    pos = nxt[pos];\n\n  }\n\n\n\n  CLR(isin, 0);\n\n  vector<int> stack;\n\n\n\n  // cout << \"k=\" << k << endl;\n\n  // cout << \"pos=\" << pos << endl;\n\n  for (; k < K && pos < N; pos++) {\n\n    const int v = A[pos];\n\n    if (isin[v]) {\n\n      while (isin[v]) {\n\n        isin[stack.back()] = false;\n\n        stack.pop_back();\n\n      }\n\n    } else {\n\n      stack.push_back(v);\n\n      isin[v] = true;\n\n    }\n\n  }\n\n\n\n  REP(i, stack.size()) {\n\n    if (i > 0) cout << \" \";\n\n    cout << stack[i];\n\n  }\n\n  cout << endl;\n\n  return 0;\n\n}\n\n\n\nint main() {\n\n\n\n#ifdef LOCAL\n\n  for (;!cin.eof();cin>>ws)\n\n#endif\n\n    main2();\n\n  return 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\n#define REP(i,n) for(int i=0,_n=(int)(n);i<_n;++i)\n\n#define ALL(v) (v).begin(),(v).end()\n\n#define CLR(t,v) memset(t,(v),sizeof(t))\n\ntemplate<class T1,class T2>ostream& operator<<(ostream& os,const pair<T1,T2>&a){return os<<\"(\"<<a.first<<\",\"<<a.second<< \")\";}\n\ntemplate<class T>void pv(T a,T b){for(T i=a;i!=b;++i)cout<<(*i)<<\" \";cout<<endl;}\n\ntemplate<class T>void chmin(T&a,const T&b){if(a>b)a=b;}\n\ntemplate<class T>void chmax(T&a,const T&b){if(a<b)a=b;}\n\n\n\n\n\nint nextInt() { int x; scanf(\"%d\", &x); return x;}\n\nll nextLong() { ll x; scanf(\"%lld\", &x); return x;}\n\n\n\nint main2() {\n\n  int N = nextInt();\n\n  ll K = nextLong();\n\n  vector<int> A(N);\n\n  REP(i, N) A[i] = nextInt();\n\n\n\n  ll P = N * K;\n\n\n\n  const int L = 40;\n\n  vector<ll> nxt[L];\n\n  REP(i, L) nxt[i] = vector<ll>(N);\n\n\n\n  map<int, int> last;\n\n  for (int i = 2*N-1; i >= 0; i--) {\n\n    if (i < N) {\n\n      nxt[0][i] = last[A[i]] - i + 1;\n\n    }\n\n    last[A[i%N]] = i;\n\n  }\n\n\n\n  for (int l = 1; l < L; l++) {\n\n    REP(i, N) {\n\n      nxt[l][i] = nxt[l-1][ (i + nxt[l-1][i]) % N ] + nxt[l-1][i];\n\n    }\n\n  }\n\n\n\n  ll pos = 0;\n\n  for (;;) {\n\n    int l = L-1;\n\n    while (l >= 0 && nxt[l][pos % N] + pos > P) l--;\n\n    if (l == -1) break;\n\n    pos += nxt[l][pos % N];\n\n  }\n\n\n\n  vector<int> stack;\n\n  set<int> in;\n\n  for (; pos < P; pos++) {\n\n    if (in.count(A[pos % N])) {\n\n      do {\n\n        in.erase(stack.back());\n\n        stack.pop_back();\n\n      } while (in.count(A[pos % N]));\n\n    } else {\n\n      stack.push_back(A[pos % N]);\n\n      in.insert(A[pos % N]);\n\n    }\n\n  }\n\n  pv(ALL(stack));\n\n\n\n  return 0;\n\n}\n\n\n\nint main() {\n\n\n\n#ifdef LOCAL\n\n  for (;!cin.eof();cin>>ws)\n\n#endif\n\n    main2();\n\n  return 0;\n\n}"
    },
    {
        "id": "416",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define rep(i, a, b) for (int i = (a); i <= (b); i++)\n\n#define pb push_back\n\n#define fi first\n\n#define se second\n\ntypedef long long ll;\n\nconst int N = 2e5 + 100;\n\n\n\ninline ll rd() {\n\n  ll s = 0, w = 1; char c = getchar();\n\n  while (c < '0' || c > '9') { if (c == '-') w = -1; c = getchar(); }\n\n  while (c >= '0' && c <= '9') s = s * 10 + c - '0', c = getchar();\n\n  return s * w;\n\n}\n\n\n\nll n, k, a[N], fst[N], tot, pos;\n\npair <ll, ll> p[N];\n\nvector <ll> r[N], ans;\n\n\n\ninline void calc() {\n\n  rep(i, 1, N - 100) {\n\n    if (!r[i].size()) continue ; int len = r[i].size();\n\n    rep(j, 0, len - 1) {\n\n      if (j != len - 1)\n\n        p[r[i][j]].fi = (r[i][j + 1] + 1) % n,\n\n        p[r[i][j]].se = r[i][j + 1] + 1 - r[i][j];\n\n      else\n\n        p[r[i][j]].fi = (r[i][0] + 1) % n,\n\n        p[r[i][j]].se = n - r[i][j] + r[i][0] + 1;\n\n    }\n\n  }\n\n}\n\n\n\nint main() {\n\n  n = rd(), k = rd(); memset(fst, -1, sizeof(fst));\n\n  rep(i, 0, n - 1) r[a[i] = rd()].pb(i);\n\n  calc(); tot = pos = 0; ll s = n * k - 1;\n\n  while (tot + p[pos].se <= s) {\n\n    if (fst[pos] != -1) {\n\n      ll K = tot - fst[pos], h = (n * k - fst[pos]) % K;\n\n      if (h == 1ll) { puts(\"\"); return 0; }\n\n      h = (!h ? K - 1 : h - 1);\n\n      s =  fst[pos] + h, tot = fst[pos];\n\n      break ;\n\n    }\n\n    else fst[pos] = tot;\n\n    tot += p[pos].se, pos = p[pos].fi;\n\n  }\n\n  if (s == tot + p[pos].se - 1) { puts(\"\"); return 0; }\n\n  while (tot <= s) {\n\n    while (tot + p[pos].se <= s) tot += p[pos].se, pos = p[pos].fi;\n\n    if (tot + p[pos].se - 1 == s) break ;\n\n    ans.pb(a[pos]), (++pos) %= n, tot++;\n\n  }\n\n  int len = ans.size(); if (!len) puts(\"\");\n\n  else {\n\n    rep(i, 0, len - 1) printf(\"%lld \", ans[i]);\n\n    puts(\"\");\n\n  }\n\n  return 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nconst int MAXN = 200005;\n\n\n\nint N, A[MAXN], nxt[MAXN], prv[MAXN], vis[MAXN];\n\nlong long K;\n\n\n\nint main(){\t\n\n\tscanf(\"%d %lld\", &N, &K);\n\n\tfor(int i = 0; i < N; i++)\n\n\t\tscanf(\"%d\", &A[i]);\n\n\t\n\n\tmemset(prv, -1, sizeof prv);\n\n\tfor(int i = 0; i < 2 * N; i++){\n\n\t\tif(prv[A[i % N]] != -1){\n\n\t\t\tnxt[prv[A[i % N]]] = i % N;\n\n\t\t}\n\n\t\tprv[A[i % N]] = i % N;\n\n\t}\n\n\t/*\n\n\tfor(int i = 0; i < N; i++)\n\n\t\tcout << nxt[i] << ' ';\n\n\tcout << endl;*/\n\n\t\n\n\tvector <int> ans;\n\n\tmemset(vis, -1, sizeof vis);\n\n\t\n\n\tint j = 0, k = 0;\n\n\twhile(k < K){\n\n\t\tif(nxt[j] > j){\n\n\t\t\tj = nxt[j] + 1;\n\n\t\t\tif(j >= N){\n\n\t\t\t\tj -= N;\n\n\t\t\t\tk++;\n\n\t\t\t}\n\n\t\t}else{\n\n\t\t\tif(k + 1 < K){\n\n\t\t\t\tj = nxt[j] + 1;\n\n\t\t\t\tk++;\n\n\t\t\t\t\n\n\t\t\t\tif(j >= N){\n\n\t\t\t\t\tj -= N;\n\n\t\t\t\t\tk++;\n\n\t\t\t\t}\n\n\t\t\t}else{\n\n\t\t\t\tans.push_back(A[j]);\n\n\t\t\t\t\n\n\t\t\t\tj = j + 1;\n\n\t\t\t\tif(j >= N)break;\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tif(vis[j] != -1){\n\n\t\t\tint d = k - vis[j];\n\n\t\t\tK = k + (K - k) % d;\n\n\t\t}\n\n\t\tvis[j] = k;\n\n\t}\n\n\t\n\n\tfor(int i = 0; i < (int)ans.size(); i++){\n\n\t\tif(i > 0)printf(\" \");\n\n\t\tprintf(\"%d\", ans[i]);\n\n\t}\n\n\tprintf(\"\\n\");\n\n\t\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "418",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define rep(i, a, b) for (int i = (a); i <= (b); i++)\n\n#define pb push_back\n\n#define fi first\n\n#define se second\n\ntypedef long long ll;\n\nconst int N = 2e5 + 100;\n\n\n\ninline ll rd() {\n\n  ll s = 0, w = 1; char c = getchar();\n\n  while (c < '0' || c > '9') { if (c == '-') w = -1; c = getchar(); }\n\n  while (c >= '0' && c <= '9') s = s * 10 + c - '0', c = getchar();\n\n  return s * w;\n\n}\n\n\n\nll n, k, a[N], fst[N], tot, pos;\n\npair <ll, ll> p[N];\n\nvector <ll> r[N], ans;\n\n\n\ninline void calc() {\n\n  rep(i, 1, N - 100) {\n\n    if (!r[i].size()) continue ; int len = r[i].size();\n\n    rep(j, 0, len - 1) {\n\n      if (j != len - 1)\n\n        p[r[i][j]].fi = (r[i][j + 1] + 1) % n,\n\n        p[r[i][j]].se = r[i][j + 1] + 1 - r[i][j];\n\n      else\n\n        p[r[i][j]].fi = (r[i][0] + 1) % n,\n\n        p[r[i][j]].se = n - r[i][j] + r[i][0] + 1;\n\n    }\n\n  }\n\n}\n\n\n\nint main() {\n\n  n = rd(), k = rd(); memset(fst, -1, sizeof(fst));\n\n  rep(i, 0, n - 1) r[a[i] = rd()].pb(i);\n\n  calc(); tot = pos = 0; ll s = n * k - 1;\n\n  while (tot + p[pos].se <= s) {\n\n    if (fst[pos] != -1) {\n\n      ll K = tot - fst[pos], h = (n * k - fst[pos]) % K;\n\n      if (h == 1ll) { puts(\"\"); return 0; }\n\n      h = (!h ? K - 1 : h - 1);\n\n      s =  fst[pos] + h, tot = fst[pos];\n\n      break ;\n\n    }\n\n    else fst[pos] = tot;\n\n    tot += p[pos].se, pos = p[pos].fi;\n\n  }\n\n  if (s == tot + p[pos].se - 1) { puts(\"\"); return 0; }\n\n  while (tot <= s) {\n\n    while (tot + p[pos].se <= s) tot += p[pos].se, pos = p[pos].fi;\n\n    if (tot + p[pos].se - 1 == s) break ;\n\n    ans.pb(a[pos]), (++pos) %= n, tot++;\n\n  }\n\n  int len = ans.size(); if (!len) puts(\"\");\n\n  else {\n\n    rep(i, 0, len - 1) printf(\"%lld \", ans[i]);\n\n    puts(\"\");\n\n  }\n\n  return 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn = 2e5 + 7;\n\nlong long n, k, d;\n\nint a[maxn], lst[maxn], to[maxn], zz[maxn], t, hs[maxn];\n\n\n\nint main() {\n\n\tscanf(\"%lld%lld\", &n, &k);\n\n\tfor (int i = 1; i <= n; ++i) scanf(\"%d\", &a[i]);\n\n\tfor (int i = n; i; --i) lst[a[i]] = i;\n\n\tfor (int i = n; i; --i) {\n\n\t\tto[i] = lst[a[i]];\n\n\t\tlst[a[i]] = i;\n\n\t}\n\n\tint pos = 1;\n\n\tdo {\n\n\t\tif(to[pos] <= pos) ++d;\n\n\t\tif(to[pos] == n) ++d;\n\n\t\tpos = to[pos] % n + 1;\n\n\t}while(pos != 1);\n\n\tk %= d;\n\n\tif(k == 0) return 0;\n\n\tpos = 1;\n\n\twhile(1) {\n\n\t\tif(to[pos] <= pos) {\n\n\t\t\tif(k > 1) --k;\n\n\t\t\telse break;\n\n\t\t}\n\n\t\tpos = to[pos] % n + 1;\n\n\t}\n\n\tfor (int i = pos; i <= n; ++i) {\n\n\t\tif(hs[a[i]]) {\n\n\t\t\t//cerr << a[i] << endl;\n\n\t\t\twhile(zz[t] != a[i]) \n\n\t\t\t\ths[zz[t--]] = 0;\n\n\t\t\ths[zz[t--]] = 0;\n\n\t\t}\n\n\t\telse {\n\n\t\t\ths[a[i]] = 1;\n\n\t\t\tzz[++t] = a[i];\n\n\t\t}\n\n\t}\n\n\tfor (int i = 1; i <= t; ++i) printf(\"%d \", zz[i]);\n\n\tprintf(\"\\n\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "419",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nconst int MAXN = 200005;\n\n\n\nint N, A[MAXN], nxt[MAXN], prv[MAXN], vis[MAXN];\n\nlong long K;\n\n\n\nint main(){\t\n\n\tscanf(\"%d %lld\", &N, &K);\n\n\tfor(int i = 0; i < N; i++)\n\n\t\tscanf(\"%d\", &A[i]);\n\n\t\n\n\tmemset(prv, -1, sizeof prv);\n\n\tfor(int i = 0; i < 2 * N; i++){\n\n\t\tif(prv[A[i % N]] != -1){\n\n\t\t\tnxt[prv[A[i % N]]] = i % N;\n\n\t\t}\n\n\t\tprv[A[i % N]] = i % N;\n\n\t}\n\n\t/*\n\n\tfor(int i = 0; i < N; i++)\n\n\t\tcout << nxt[i] << ' ';\n\n\tcout << endl;*/\n\n\t\n\n\tvector <int> ans;\n\n\tmemset(vis, -1, sizeof vis);\n\n\t\n\n\tint j = 0, k = 0;\n\n\twhile(k < K){\n\n\t\tif(nxt[j] > j){\n\n\t\t\tj = nxt[j] + 1;\n\n\t\t\tif(j >= N){\n\n\t\t\t\tj -= N;\n\n\t\t\t\tk++;\n\n\t\t\t}\n\n\t\t}else{\n\n\t\t\tif(k + 1 < K){\n\n\t\t\t\tj = nxt[j] + 1;\n\n\t\t\t\tk++;\n\n\t\t\t\t\n\n\t\t\t\tif(j >= N){\n\n\t\t\t\t\tj -= N;\n\n\t\t\t\t\tk++;\n\n\t\t\t\t}\n\n\t\t\t}else{\n\n\t\t\t\tans.push_back(A[j]);\n\n\t\t\t\t\n\n\t\t\t\tj = j + 1;\n\n\t\t\t\tif(j >= N)break;\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tif(vis[j] != -1){\n\n\t\t\tint d = k - vis[j];\n\n\t\t\tK = k + (K - k) % d;\n\n\t\t}\n\n\t\tvis[j] = k;\n\n\t}\n\n\t\n\n\tfor(int i = 0; i < (int)ans.size(); i++){\n\n\t\tif(i > 0)printf(\" \");\n\n\t\tprintf(\"%d\", ans[i]);\n\n\t}\n\n\tprintf(\"\\n\");\n\n\t\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn = 2e5 + 7;\n\nlong long n, k, d;\n\nint a[maxn], lst[maxn], to[maxn], zz[maxn], t, hs[maxn];\n\n\n\nint main() {\n\n\tscanf(\"%lld%lld\", &n, &k);\n\n\tfor (int i = 1; i <= n; ++i) scanf(\"%d\", &a[i]);\n\n\tfor (int i = n; i; --i) lst[a[i]] = i;\n\n\tfor (int i = n; i; --i) {\n\n\t\tto[i] = lst[a[i]];\n\n\t\tlst[a[i]] = i;\n\n\t}\n\n\tint pos = 1;\n\n\tdo {\n\n\t\tif(to[pos] <= pos) ++d;\n\n\t\tif(to[pos] == n) ++d;\n\n\t\tpos = to[pos] % n + 1;\n\n\t}while(pos != 1);\n\n\tk %= d;\n\n\tif(k == 0) return 0;\n\n\tpos = 1;\n\n\twhile(1) {\n\n\t\tif(to[pos] <= pos) {\n\n\t\t\tif(k > 1) --k;\n\n\t\t\telse break;\n\n\t\t}\n\n\t\tpos = to[pos] % n + 1;\n\n\t}\n\n\tfor (int i = pos; i <= n; ++i) {\n\n\t\tif(hs[a[i]]) {\n\n\t\t\t//cerr << a[i] << endl;\n\n\t\t\twhile(zz[t] != a[i]) \n\n\t\t\t\ths[zz[t--]] = 0;\n\n\t\t\ths[zz[t--]] = 0;\n\n\t\t}\n\n\t\telse {\n\n\t\t\ths[a[i]] = 1;\n\n\t\t\tzz[++t] = a[i];\n\n\t\t}\n\n\t}\n\n\tfor (int i = 1; i <= t; ++i) printf(\"%d \", zz[i]);\n\n\tprintf(\"\\n\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "421",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\n#define rep(i, a, b) for (int i = (a); i <= (b); i++)\n\n#define pb push_back\n\n#define fi first\n\n#define se second\n\ntypedef long long ll;\n\nconst int N = 2e5 + 100;\n\n\n\ninline ll rd() {\n\n  ll s = 0, w = 1; char c = getchar();\n\n  while (c < '0' || c > '9') { if (c == '-') w = -1; c = getchar(); }\n\n  while (c >= '0' && c <= '9') s = s * 10 + c - '0', c = getchar();\n\n  return s * w;\n\n}\n\n\n\nll n, k, a[N], fst[N], tot, pos;\n\npair <ll, ll> p[N];\n\nvector <ll> r[N], ans;\n\n\n\ninline void calc() {\n\n  rep(i, 1, N - 100) {\n\n    if (!r[i].size()) continue ; int len = r[i].size();\n\n    rep(j, 0, len - 1) {\n\n      if (j != len - 1)\n\n        p[r[i][j]].fi = (r[i][j + 1] + 1) % n,\n\n        p[r[i][j]].se = r[i][j + 1] + 1 - r[i][j];\n\n      else\n\n        p[r[i][j]].fi = (r[i][0] + 1) % n,\n\n        p[r[i][j]].se = n - r[i][j] + r[i][0] + 1;\n\n    }\n\n  }\n\n}\n\n\n\nint main() {\n\n  n = rd(), k = rd(); memset(fst, -1, sizeof(fst));\n\n  rep(i, 0, n - 1) r[a[i] = rd()].pb(i);\n\n  calc(); tot = pos = 0; ll s = n * k - 1;\n\n  while (tot + p[pos].se <= s) {\n\n    if (fst[pos] != -1) {\n\n      ll K = tot - fst[pos], h = (n * k - fst[pos]) % K;\n\n      if (h == 1ll) { puts(\"\"); return 0; }\n\n      h = (!h ? K - 1 : h - 1);\n\n      s =  fst[pos] + h, tot = fst[pos];\n\n      break ;\n\n    }\n\n    else fst[pos] = tot;\n\n    tot += p[pos].se, pos = p[pos].fi;\n\n  }\n\n  if (s == tot + p[pos].se - 1) { puts(\"\"); return 0; }\n\n  while (tot <= s) {\n\n    while (tot + p[pos].se <= s) tot += p[pos].se, pos = p[pos].fi;\n\n    if (tot + p[pos].se - 1 == s) break ;\n\n    ans.pb(a[pos]), (++pos) %= n, tot++;\n\n  }\n\n  int len = ans.size(); if (!len) puts(\"\");\n\n  else {\n\n    rep(i, 0, len - 1) printf(\"%lld \", ans[i]);\n\n    puts(\"\");\n\n  }\n\n  return 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h> \n\n#define FOR(i,a,b) for(register int i=(a);i<(b);++i)\n\n#define ROF(i,a,b) for(register int i=(a);i>=(b);--i)\n\n#define pi pair<int,int>\n\n#define mk(a,b) make_pair(a,b)\n\n#define mygc(c) (c)=getchar()\n\n#define mypc(c) putchar(c)\n\n#define fi first\n\n#define se second\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef double db;\n\ntypedef unsigned int ui;\n\ntypedef unsigned long long ul; \n\nconst int maxn = 200005;\n\nconst int maxm = 50005;\n\nconst int inf = 2147483647;\n\ntypedef long long ll;\n\nconst double eps = 1e-9;\n\nconst long long INF = 9223372036854775807ll;\n\nll qpow(ll a,ll b,ll c){ll ans=1;while(b){if(b&1)ans=ans*a%c;a=a*a%c;b>>=1;}return ans;}\n\ninline void rd(int *x){int k,m=0;*x=0;for(;;){mygc(k);if(k=='-'){m=1;break;}if('0'<=k&&k<='9'){*x=k-'0';break;}}for(;;){mygc(k);if(k<'0'||k>'9')break;*x=(*x)*10+k-'0';}if(m)(*x)=-(*x);}\n\ninline void rd(unsigned int *x){int k,m=0;*x=0;for(;;){mygc(k);if(k=='-'){m=1;break;}if('0'<=k&&k<='9'){*x=k-'0';break;}}for(;;){mygc(k);if(k<'0'||k>'9')break;*x=(*x)*10+k-'0';}if(m)(*x)=-(*x);}\n\ninline void rd(ll *x){int k,m=0;*x=0;for(;;){mygc(k);if(k=='-'){m=1;break;}if('0'<=k&&k<='9'){*x=k-'0';break;}}for(;;){mygc(k);if(k<'0'||k>'9')break;*x=(*x)*10+k-'0';}if(m)(*x)=-(*x);}\n\ninline void rd(unsigned long long *x){int k,m=0;*x=0;for(;;){mygc(k);if(k=='-'){m=1;break;}if('0'<=k&&k<='9'){*x=k-'0';break;}}for(;;){mygc(k);if(k<'0'||k>'9')break;*x=(*x)*10+k-'0';}if(m)(*x)=-(*x);}\n\ninline void rd(db *x){scanf(\"%lf\",x);}\n\ninline int rd(char c[]){scanf(\"%s\",c);return strlen(c);}\n\ninline void rd(int a[],int n){FOR(i,0,n)rd(&a[i]);}\n\ninline void rd(ll a[],int n){FOR(i,0,n)rd(&a[i]);}\n\ntemplate <class T, class S> inline void rd(T *x, S *y){rd(x);rd(y);}\n\ntemplate <class T, class S, class U> inline void rd(T *x, S *y, U *z){rd(x);rd(y);rd(z);}\n\ntemplate <class T, class S, class U, class V> inline void rd(T *x, S *y, U *z, V *w){rd(x);rd(y);rd(z);rd(w);}\n\ntemplate <class T, class S, class U, class V, class H> inline void rd(T *x, S *y, U *z, V *w,H *h){rd(x);rd(y);rd(z);rd(w);rd(h);}\n\ntemplate <class T, class S, class U, class V, class H, class J> inline void rd(T *x, S *y, U *z, V *w,H *h,J *j){rd(x);rd(y);rd(z);rd(w);rd(h);rd(j);}\n\ninline void wr(int x){if(x < 10) putchar('0' + x); else wr(x / 10), wr(x % 10);}\n\ninline void wr(unsigned int x){if(x < 10) putchar('0' + x); else wr(x / 10), wr(x % 10);}\n\ninline void wr(unsigned long long x){if(x < 10) putchar('0' + x); else wr(x / 10), wr(x % 10);}\n\ninline void wr(int x, char c){int s=0,m=0;char f[10];if(x<0)m=1,x=-x;while(x)f[s++]=x%10,x/=10;if(!s)f[s++]=0;if(m)mypc('-');while(s--)mypc(f[s]+'0');mypc(c);}\n\ninline void wr(unsigned int x, char c){int s=0,m=0;char f[10];if(x<0)m=1,x=-x;while(x)f[s++]=x%10,x/=10;if(!s)f[s++]=0;if(m)mypc('-');while(s--)mypc(f[s]+'0');mypc(c);}\n\ninline void wr(ll x, char c){int s=0,m=0;char f[20];if(x<0)m=1,x=-x;while(x)f[s++]=x%10,x/=10;if(!s)f[s++]=0;if(m)mypc('-');while(s--)mypc(f[s]+'0');mypc(c);}\n\ninline void wr(unsigned long long x, char c){int s=0,m=0;char f[20];if(x<0)m=1,x=-x;while(x)f[s++]=x%10,x/=10;if(!s)f[s++]=0;if(m)mypc('-');while(s--)mypc(f[s]+'0');mypc(c);}\n\ninline void wr(db x, char c){printf(\"%.15f\",x);mypc(c);}\n\ninline void wr(const char c[]){int i;for(i=0;c[i]!='\\0';i++)mypc(c[i]);}\n\ninline void wr(const char x[], char c){int i;for(i=0;x[i]!='\\0';i++)mypc(x[i]);mypc(c);}\n\ntemplate<class T> inline void wrn(T x){wr(x,'\\n');}\n\ntemplate<class T, class S> inline void wrn(T x, S y){wr(x,' ');wr(y,'\\n');}\n\ntemplate<class T, class S, class U> inline void wrn(T x, S y, U z){wr(x,' ');wr(y,' ');wr(z,'\\n');}\n\ntemplate<class T, class S, class U, class H> inline void wrn(T x, S y, U z,H h){wr(x,' ');wr(y,' ');wr(z,' ');wr(h,'\\n');}\n\ntemplate<class T, class S, class U, class H, class J> inline void wrn(T x, S y, U z, H h, J j){wr(x,' ');wr(y,' ');wr(z,' ');wr(h,' ');wr(j,'\\n');}\n\ntemplate<class T, class S, class U, class H, class J,class K> inline void wrn(T x, S y, U z, H h, J j, K k){wr(x,' ');wr(y,' ');wr(z,' ');wr(h,' ');wr(j,' ');wr(k,'\\n');}\n\ntemplate<class T> inline void wra(T x[], int n){int i;if(!n){mypc('\\n');return;}FOR(i,0,n-1)wr(x[i],' ');wr(x[n-1],'\\n');}\n\n\n\nint a[maxn],pos[maxn],nxt[maxn],pre[maxn],c[maxn*10],fir[maxn];\n\nvector<int>g;\n\n\n\nint main(){\n\n\tint n;ll k;\n\n\trd(&n,&k);\n\n\tif(n==1){\n\n\t\tint u;\n\n\t\trd(&u);\n\n\t\tif(k%2==0)printf(\"\\n\");\n\n\t\telse printf(\"%d\\n\",u);\n\n\t\treturn 0;\n\n\t}\n\n\tmemset(pos,-1,sizeof(pos));\n\n\tmemset(nxt,-1,sizeof(nxt));\n\n\tmemset(fir,-1,sizeof(fir));\n\n\tFOR(i,0,n){\n\n\t\trd(&a[i]);\n\n\t\tif(fir[a[i]]==-1)fir[a[i]]=i;\n\n\t\tif(pos[a[i]]!=-1)nxt[pos[a[i]]]=i;\n\n\t\tpos[a[i]]=i;\n\n\t}\n\n\tint i=0,t=0;\n\n\tif(nxt[i]==-1)i++,c[t++]=(int)g.size(),g.push_back(1);\n\n\telse {\n\n\t\ti=(nxt[i]+1)%n;\n\n\t\tif(!i)c[t++]=(int)g.size();\n\n\t\tg.push_back(i);\n\n\t}\n\n\twhile(i){\n\n\t\tif(nxt[i]==-1){\n\n\t\t\ti=(fir[a[i]]+1)%n;\n\n\t\t\tc[t++]=(int)g.size();\n\n\t\t\tif(!i)c[t++]=(int)g.size();\n\n\t\t\tg.push_back(i);\n\n\t\t}else {\n\n\t\t\ti=(nxt[i]+1)%n;\n\n\t\t\tif(!i)c[t++]=(int)g.size();\n\n\t\t\tg.push_back(i);\n\n\t\t}\n\n\t}\n\n//\twrn(t);\n\n//\tFOR(i,0,g.size())printf(\"%d \",g[i]);\n\n//\tprintf(\"\\n\");\n\n//\tFOR(i,0,t)printf(\"%d \",c[i]);\n\n//\tprintf(\"\\n\"); \n\n\tk%=t;\n\n\tif(k==0){\n\n\t\tprintf(\"\\n\");\n\n\t}else if(k==1){\n\n\t\ti = 0;\n\n\t\twhile(i<n){\n\n\t\t\tif(nxt[i]==-1){\n\n\t\t\t\tprintf(\"%d \",a[i]);\n\n\t\t\t\ti++;\n\n\t\t\t}else i=nxt[i]+1;\n\n\t\t}\n\n\t\tprintf(\"\\n\");\n\n\t}else{\n\n\t\ti=g[c[k-2]]%n;\n\n\t\twhile(i<n){\n\n\t\t\tif(nxt[i]==-1){\n\n\t\t\t\tprintf(\"%d \",a[i]);\n\n\t\t\t\ti++;\n\n\t\t\t}else i=nxt[i]+1;\n\n\t\t}\n\n\t\tprintf(\"\\n\");\n\n\t}\n\n\t\n\n}\n\n\n"
    },
    {
        "id": "423",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\n#define rep(i, n) for(int i = 0; i < (n); i++)\n\n#define rep1(i, n) for(int i = 1; i <= (n); i++)\n\n#define co(x) cout << (x) << \"\\n\"\n\n#define cosp(x) cout << (x) << \" \"\n\n#define ce(x) cerr << (x) << \"\\n\"\n\n#define cesp(x) cerr << (x) << \" \"\n\n#define pb push_back\n\n#define mp make_pair\n\n#define Would\n\n#define you\n\n#define please\n\n\n\n\n\nint main() {\n\n\tcin.tie(0);\n\n\tios::sync_with_stdio(false);\n\n\n\n\n\n\tll N, K;\n\n\tcin >> N >> K;\n\n\n\n\tint A[200001];\n\n\trep1(i, N) cin >> A[i];\n\n\n\n\tint c[200001] = {};\n\n\tint B[200001] = {};\n\n\tfor (int i = N; i >= 1; i--) {\n\n\t\tif (c[A[i]] == 0) {\n\n\t\t\tc[A[i]] = i;\n\n\t\t}\n\n\t\telse {\n\n\t\t\tB[i] = c[A[i]];\n\n\t\t\tc[A[i]] = i;\n\n\t\t}\n\n\t}\n\n\n\n\tint C[200002] = {};\n\n\tfor (int i = N; i >= 1; i--) {\n\n\t\tif (B[i] == 0) {\n\n\t\t\tC[i] = A[i];\n\n\t\t}\n\n\t\telse {\n\n\t\t\tC[i] = C[B[i] + 1];\n\n\t\t}\n\n\t}\n\n\trep(i, N + 1) ce(C[i]);\n\n\n\n\tce(\"\");\n\n\n\n\tint D[200001] = {};\n\n\trep(i, 200001) D[i] = -1;\n\n\trep1(i, N) {\n\n\t\tif (D[A[i]] == -1) {\n\n\t\t\tif (i + 1 <= N + 1) D[A[i]] = C[i + 1];\n\n\t\t}\n\n\t}\n\n\tD[0] = C[1];\n\n\n\n\trep(i, N + 1) ce(D[i]);\n\n\n\n\tint vis[200001] = {};\n\n\n\n\tint num = 0;\n\n\tint k = 0;\n\n\tvector<int> ans;\n\n\twhile (vis[k] == 0) {\n\n\t\tvis[k] = 1;\n\n\t\tk = D[k];\n\n\t\tans.pb(k);\n\n\t\tnum++;\n\n\t}\n\n\tce(\"\");\n\n\tce(num);\n\n\n\n\tint num2 = 0;\n\n\tint vis2[200001] = {};\n\n\twhile (vis2[k] == 0) {\n\n\t\tvis2[k] = 1;\n\n\t\tk = D[k];\n\n\t\tnum2++;\n\n\t}\n\n\tce(num2);\n\n\n\n\tif (K >= 2) {\n\n\t\tK -= 2;\n\n\t\tif (K >= num) {\n\n\t\t\tK = (K - num + num2) % num2 + num - num2;\n\n\t\t}\n\n\n\n\n\n\t\tint tmp = 0;\n\n\t\trep1(i, N) {\n\n\t\t\tif (A[i] == ans[K]) {\n\n\t\t\t\ttmp = i;\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tvector<int> kotae;\n\n\t\tfor (int i = tmp + 1; i <= N; i++) {\n\n\t\t\tif (B[i] == 0) kotae.pb(A[i]);\n\n\t\t\telse i = B[i];\n\n\t\t}\n\n\n\n\t\trep(i, kotae.size()) cosp(kotae[i]);\n\n\n\n\t}\n\n\telse {\n\n\n\n\t\tvector<int> kotae;\n\n\t\tint tmp = 0;\n\n\t\tfor (int i = tmp + 1; i <= N; i++) {\n\n\t\t\tif (B[i] == 0) kotae.pb(A[i]);\n\n\t\t\telse i = B[i];\n\n\t\t}\n\n\n\n\t\trep(i, kotae.size()) cosp(kotae[i]);\n\n\t}\n\n\n\n\n\n\n\n\tWould you please return 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\n#define rep(i, n) for(int i = 0; i < (n); i++)\n\n#define rep1(i, n) for(int i = 1; i <= (n); i++)\n\n#define co(x) cout << (x) << \"\\n\"\n\n#define cosp(x) cout << (x) << \" \"\n\n#define ce(x) cerr << (x) << \"\\n\"\n\n#define cesp(x) cerr << (x) << \" \"\n\n#define pb push_back\n\n#define mp make_pair\n\n#define Would\n\n#define you\n\n#define please\n\n\n\n\n\nint main() {\n\n\tcin.tie(0);\n\n\tios::sync_with_stdio(false);\n\n\n\n\n\n\tll N, K;\n\n\tcin >> N >> K;\n\n\n\n\tint A[200001];\n\n\trep1(i, N) cin >> A[i];\n\n\n\n\tint c[200001] = {};\n\n\tint B[200001] = {};\n\n\tfor (int i = N; i >= 1; i--) {\n\n\t\tif (c[A[i]] == 0) {\n\n\t\t\tc[A[i]] = i;\n\n\t\t}\n\n\t\telse {\n\n\t\t\tB[i] = c[A[i]];\n\n\t\t\tc[A[i]] = i;\n\n\t\t}\n\n\t}\n\n\n\n\tint C[200002] = {};\n\n\tfor (int i = N; i >= 1; i--) {\n\n\t\tif (B[i] == 0) {\n\n\t\t\tC[i] = A[i];\n\n\t\t}\n\n\t\telse {\n\n\t\t\tC[i] = C[B[i] + 1];\n\n\t\t}\n\n\t}\n\n\n\n\tint D[200001] = {};\n\n\trep(i, 200001) D[i] = -1;\n\n\trep1(i, N) {\n\n\t\tif (D[A[i]] == -1) {\n\n\t\t\tif (i + 1 <= N + 1) D[A[i]] = C[i + 1];\n\n\t\t}\n\n\t}\n\n\tD[0] = C[1];\n\n\n\n\tint vis[200001] = {};\n\n\n\n\tint num = 0;\n\n\tint k = 0;\n\n\tvector<int> ans;\n\n\twhile (vis[k] == 0) {\n\n\t\tvis[k] = num + 1;\n\n\t\tk = D[k];\n\n\t\tans.pb(k);\n\n\t\tnum++;\n\n\t}\n\n\n\n\tint num2 = vis[k] - 1;\n\n\n\n\n\n\tint tmp = 0;\n\n\tif (K >= 2) {\n\n\t\tK -= 2;\n\n\t\tif (K >= num) {\n\n\t\t\tK = (K - num2) % (num - num2) + num2;\n\n\t\t}\n\n\t\trep1(i, N) {\n\n\t\t\tif (A[i] == ans[K]) {\n\n\t\t\t\ttmp = i;\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tfor (int i = tmp + 1; i <= N; i++) {\n\n\t\tif (B[i] == 0) cosp(A[i]);\n\n\t\telse i = B[i];\n\n\t}\n\n\n\n\tWould you please return 0;\n\n}"
    },
    {
        "id": "425",
        "source_code": "#include <iostream>\n\n#include <vector>\n\nusing namespace std;\n\ntypedef long long ll;\n\n\n\nint a[200005];\n\nvector<int> v[200005];\n\nint l[200005];\n\nint re[200005];\n\nint cnt[200005];\n\nint c[200005];\n\n\n\nint main()\n\n{\n\n    ll n, k;\n\n    cin >> n >> k;\n\n    for(int i = 0; i < n; i++){\n\n        cin >> a[i];\n\n        cnt[a[i]]++;\n\n        re[i] = cnt[a[i]];\n\n        v[a[i]].push_back(i);\n\n    }\n\n    for(int i = 0; i < n; i++){\n\n        l[a[i]] = v[a[i]].size();\n\n    }\n\n    int now = 0;\n\n    int i;\n\n    for(i = 0; ; i++){\n\n        while(l[a[now]] != re[now]){\n\n            now = v[a[now]][re[now]] + 1;\n\n            if(now == n){\n\n                break;\n\n            }\n\n        }\n\n        c[i] = now;\n\n//        cout << i << \" \" << c[i] << endl;\n\n        if(l[a[now]] == 1 && now == n - 1){\n\n            i++;\n\n            c[i] = n;\n\n            break;\n\n        }\n\n        if(now == n) break;\n\n        now = (v[a[now]][0] + 1) % n;\n\n    }\n\n    int cir = i + 1;\n\n//    cout << cir << endl;\n\n    int p = (k + cir - 1) % cir;\n\n    for(int i = c[p]; i < n; i++){\n\n        while(l[a[i]] != re[i]){\n\n            i = v[a[i]][re[i]] + 1;\n\n            if(i == n){\n\n                break;\n\n            }\n\n        }\n\n        if(i >= n) break;\n\n        cout << a[i] << \" \";\n\n    }\n\n    cout << endl;\n\n}",
        "optimized_code": "#include <algorithm>\n\n#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;\n\n\n\nint main()\n\n{\n\n    ll n, k;\n\n    cin >> n >> k;\n\n    int a[200005], r[200005], b[200005];\n\n    for(int i = 0; i < n; i++) r[i] = -1;\n\n    for(int i = 0; i <= 200000; i++) b[i] = -1;\n\n    for(int i = 0; i < n; i++){\n\n        cin >> a[i];\n\n        if(b[a[i]] != -1){\n\n            r[b[a[i]]] = i;\n\n        }\n\n        b[a[i]] = i;\n\n    }\n\n    for(int i = 0; i < n; i++){\n\n        if(r[b[a[i]]] == -1) r[b[a[i]]] = i;\n\n        b[a[i]] = i;\n\n    }\n\n    int u = 0;\n\n    ll s = 0;\n\n    for(int i = 0; i < n; i++){\n\n        if(r[u] == u) s += n + 1;\n\n        else s += (r[u] + n - u) % n + 1;\n\n        u = (r[u] + 1) % n;\n\n        if(u == 0) break;\n\n    }\n\n    k = k * n % s;\n\n    for(int i = 0; i < n; i++){\n\n        ll c;\n\n        if(r[u] == u) c = n + 1;\n\n        else c = (r[u] + n - u) % n + 1;\n\n        if(k >= c){\n\n            k -= c;\n\n            u = (r[u] + 1) % n;\n\n        }\n\n        else{\n\n            int ans[200005];\n\n            int l = 0;\n\n            while(k){\n\n                ll c;\n\n                if(r[u] == u) c = n + 1;\n\n                else c = (r[u] + n - u) % n + 1;\n\n                if(k >= c){\n\n                    k -= c;\n\n                    u = (r[u] + 1) % n;\n\n                }\n\n                else{\n\n                    k--;\n\n                    ans[l] = a[u];\n\n                    u = (u + 1) % n;\n\n                    l++;\n\n                }\n\n            }\n\n            for(int j = 0; j < l; j++) cout << ans[j] << \" \";\n\n            cout << endl;\n\n            return 0;\n\n        }\n\n    }\n\n}\n"
    },
    {
        "id": "426",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\n#define For(i,n,k) for(ll i=(n);i<(k);i++)\n\n#define ALL(a)  (a).begin(),(a).end()\n\nll n,k,ans=0;\n\nvector<ll> loop(ll s,vector<ll> a){\n\n    vector<ll> cnt(200002,0),S;\n\n    if(s>0){\n\n        S.push_back(s);\n\n        cnt[s]++;\n\n    }\n\n    For(i,0,n){\n\n        if(cnt[a[i]]==0){\n\n            S.push_back(a[i]);\n\n            cnt[a[i]]++;\n\n        }\n\n        else{\n\n            while(cnt[a[i]]>0){\n\n                cnt[S[S.size()-1]]--;\n\n                S.pop_back();\n\n            }\n\n        }\n\n    }\n\n    return S;\n\n}\n\nvoid Main(){\n\n    cin>>n;\n\n    cin>>k;\n\n    vector<ll> a(n);\n\n    vector<vector<ll>> b(200002);\n\n    For(i,0,n) {\n\n        cin>>a[i];\n\n        b[a[i]].push_back(i);\n\n    }\n\n    ll init=0;\n\n    ll place,num;\n\n    map<ll,ll> mp;//\u521d\u671f\u5024\u3068\u7d50\u679c\n\n    while(true){\n\n        ll now=init;\n\n        if(now==0)place=0;\n\n        else place=b[now][0]+1;\n\n        here:;\n\n        if(place==n){\n\n            mp[init]=0;\n\n            break;\n\n        }\n\n        num=a[place];\n\n        auto itr=upper_bound(ALL(b[num]),place);\n\n        if(b[num].end()-itr==0){\n\n            mp[init]=num;\n\n            init=num;\n\n        }\n\n        else{\n\n            place=*itr+1;\n\n            now=a[place];\n\n            goto here;\n\n        }\n\n    }\n\n    ll cnt=0;\n\n    init=0;\n\n    vector<ll> lp;\n\n    lp.push_back(init);\n\n    while(true){\n\n        cnt++;\n\n        init=mp[init];\n\n        if(init==0) break;\n\n        lp.push_back(init);\n\n    }\n\n    init=lp[(k-1)%cnt];\n\n    vector<ll> S;\n\n\n\n    S=loop(init,a);\n\n    /*\u611a\u76f4\u306b\u3084\u3063\u3066\u3082\u9593\u306b\u5408\u308f\u306a\u3044\n\n    For(i,0,k){\n\n        S=loop(init,a);\n\n        if(S.size()>0) init=S[0];\n\n        else init=0;\n\n    }\n\n    \u305d\u308c\u306f\u305d\u3046\u306a\u3093\u3060\u3088\u306a*/\n\n\n\n    For(i,0,S.size()) cout<<S[i]<<\" \";\n\n    cout<<endl;\n\n}\n\nint main(){\n\n    Main();\n\n    return 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\n#define For(i,n,k) for(ll i=(n);i<(k);i++)\n\n#define ALL(a)  (a).begin(),(a).end()\n\nll n,k,ans=0;\n\nvector<ll> loop(ll s,vector<ll> a){\n\n    vector<bool> cnt(200002,false);\n\n    vector<ll> S;\n\n    if(s>0){\n\n        S.push_back(s);\n\n        cnt[s]=1;\n\n    }\n\n    For(i,0,n){\n\n        if(!cnt[a[i]]){\n\n            S.push_back(a[i]);\n\n            cnt[a[i]]=1;\n\n        }\n\n        else{\n\n            while(cnt[a[i]]){\n\n                cnt[S[S.size()-1]]=0;\n\n                S.pop_back();\n\n            }\n\n        }\n\n    }\n\n    return S;\n\n}\n\nvoid Main(){\n\n    cin>>n;\n\n    cin>>k;\n\n    vector<ll> a(n);\n\n    vector<vector<ll>> b(200002);\n\n    For(i,0,n){\n\n        cin>>a[i];\n\n        b[a[i]].push_back(i);\n\n    }\n\n    ll init=0,cnt=0;\n\n    ll place,num;\n\n    vector<ll> lp;\n\n    while(true){\n\n        cnt++;\n\n        lp.push_back(init);\n\n        ll now=init;\n\n        if(now==0)place=0;\n\n        else place=b[now][0]+1;\n\n        here:;\n\n        if(place==n)break;\n\n        num=a[place];\n\n        auto itr=upper_bound(ALL(b[num]),place);\n\n        if(b[num].end()-itr==0)init=num;\n\n        else{\n\n            place=*itr+1;\n\n            now=a[place];\n\n            goto here;\n\n        }\n\n    }\n\n    init=lp[(k-1)%cnt];\n\n    vector<ll> S;\n\n    S=loop(init,a);\n\n    /*\u611a\u76f4\u306b\u3084\u3063\u3066\u3082\u9593\u306b\u5408\u308f\u306a\u3044\n\n    For(i,0,k){\n\n        S=loop(init,a);\n\n        if(S.size()>0) init=S[0];\n\n        else init=0;\n\n    }\n\n    \u305d\u308c\u306f\u305d\u3046\u306a\u3093\u3060\u3088\u306a*/\n\n    For(i,0,S.size()) cout<<S[i]<<\" \";\n\n    cout<<endl;\n\n}\n\nint main(){\n\n    Main();\n\n    return 0;\n\n}"
    },
    {
        "id": "427",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\n#define For(i,n,k) for(ll i=(n);i<(k);i++)\n\n#define ALL(a)  (a).begin(),(a).end()\n\nll n,k,ans=0;\n\nvector<ll> loop(ll s,vector<ll> a){\n\n    vector<ll> cnt(200002,0),S;\n\n    if(s>0){\n\n        S.push_back(s);\n\n        cnt[s]++;\n\n    }\n\n    For(i,0,n){\n\n        if(cnt[a[i]]==0){\n\n            S.push_back(a[i]);\n\n            cnt[a[i]]++;\n\n        }\n\n        else{\n\n            while(cnt[a[i]]>0){\n\n                cnt[S[S.size()-1]]--;\n\n                S.pop_back();\n\n            }\n\n        }\n\n    }\n\n    return S;\n\n}\n\nvoid Main(){\n\n    cin>>n;\n\n    cin>>k;\n\n    vector<ll> a(n);\n\n    vector<vector<ll>> b(200002);\n\n    For(i,0,n) {\n\n        cin>>a[i];\n\n        b[a[i]].push_back(i);\n\n    }\n\n    ll init=0,cnt=0;\n\n    ll place,num;\n\n    map<ll,ll> mp;//\u521d\u671f\u5024\u3068\u7d50\u679c\n\n    vector<ll> lp;\n\n    while(true){\n\n        cnt++;\n\n        lp.push_back(init);\n\n        ll now=init;\n\n        if(now==0)place=0;\n\n        else place=b[now][0]+1;\n\n        here:;\n\n        if(place==n)break;\n\n        num=a[place];\n\n        auto itr=upper_bound(ALL(b[num]),place);\n\n        if(b[num].end()-itr==0) init=num;\n\n        else{\n\n            place=*itr+1;\n\n            now=a[place];\n\n            goto here;\n\n        }\n\n    }\n\n    init=lp[(k-1)%cnt];\n\n    vector<ll> S;\n\n    S=loop(init,a);\n\n    /*\u611a\u76f4\u306b\u3084\u3063\u3066\u3082\u9593\u306b\u5408\u308f\u306a\u3044\n\n    For(i,0,k){\n\n        S=loop(init,a);\n\n        if(S.size()>0) init=S[0];\n\n        else init=0;\n\n    }\n\n    \u305d\u308c\u306f\u305d\u3046\u306a\u3093\u3060\u3088\u306a*/\n\n    For(i,0,S.size()) cout<<S[i]<<\" \";\n\n    cout<<endl;\n\n}\n\nint main(){\n\n    Main();\n\n    return 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\n#define For(i,n,k) for(ll i=(n);i<(k);i++)\n\n#define ALL(a)  (a).begin(),(a).end()\n\nll n,k,ans=0;\n\nvector<ll> loop(ll s,vector<ll> a){\n\n    vector<bool> cnt(200002,false);\n\n    vector<ll> S;\n\n    if(s>0){\n\n        S.push_back(s);\n\n        cnt[s]=1;\n\n    }\n\n    For(i,0,n){\n\n        if(!cnt[a[i]]){\n\n            S.push_back(a[i]);\n\n            cnt[a[i]]=1;\n\n        }\n\n        else{\n\n            while(cnt[a[i]]){\n\n                cnt[S[S.size()-1]]=0;\n\n                S.pop_back();\n\n            }\n\n        }\n\n    }\n\n    return S;\n\n}\n\nvoid Main(){\n\n    cin>>n;\n\n    cin>>k;\n\n    vector<ll> a(n);\n\n    vector<vector<ll>> b(200002);\n\n    For(i,0,n){\n\n        cin>>a[i];\n\n        b[a[i]].push_back(i);\n\n    }\n\n    ll init=0,cnt=0;\n\n    ll place,num;\n\n    vector<ll> lp;\n\n    while(true){\n\n        cnt++;\n\n        lp.push_back(init);\n\n        ll now=init;\n\n        if(now==0)place=0;\n\n        else place=b[now][0]+1;\n\n        here:;\n\n        if(place==n)break;\n\n        num=a[place];\n\n        auto itr=upper_bound(ALL(b[num]),place);\n\n        if(b[num].end()-itr==0)init=num;\n\n        else{\n\n            place=*itr+1;\n\n            now=a[place];\n\n            goto here;\n\n        }\n\n    }\n\n    init=lp[(k-1)%cnt];\n\n    vector<ll> S;\n\n    S=loop(init,a);\n\n    /*\u611a\u76f4\u306b\u3084\u3063\u3066\u3082\u9593\u306b\u5408\u308f\u306a\u3044\n\n    For(i,0,k){\n\n        S=loop(init,a);\n\n        if(S.size()>0) init=S[0];\n\n        else init=0;\n\n    }\n\n    \u305d\u308c\u306f\u305d\u3046\u306a\u3093\u3060\u3088\u306a*/\n\n    For(i,0,S.size()) cout<<S[i]<<\" \";\n\n    cout<<endl;\n\n}\n\nint main(){\n\n    Main();\n\n    return 0;\n\n}"
    },
    {
        "id": "431",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cmath>\n\n#include <vector>\n\n#include <string>\n\n#include <iomanip>\n\n//#include <string.h>\n\n#include <bits/stdc++.h>\n\n#define INF 999999999\n\nusing namespace std;\n\n#define ll long long\n\n#define boost ios_base::sync_with_stdio(false); cin.tie(0); cout.tie(0);\n\nstruct shi\n\n{\n\n    int x=0;\n\n    int T;\n\n}s[1000000];\n\nint cmd(shi a,shi b)\n\n{\n\n    return a.x<b.x;\n\n}\n\n/*long long cmd(long long a, long long  b)\n\n{\n\n    return a > b;\n\n}*/\n\n\n\nint main()\n\n{\n\n    boost;\n\n    int N;\n\n    cin >>N;\n\n    int   hh[100000];\n\n    for(int i=0;i<N;i++){\n\n        cin >>hh[i];\n\n    }\n\n    sort(hh,hh+N);\n\n    int kk[105000];\n\n    int ma=0;\n\n    for(int i=0;i<N;i++){\n\n        if(i!=0&&i!=N-1){\n\n            kk[i]+=abs(hh[i]-hh[N-1])*2;\n\n            kk[i]+=abs(hh[i]-hh[0]);\n\n        }\n\n        else\n\n            kk[i]+=abs(hh[0]-hh[N-1]);\n\n\n\n    }\n\n\n\n    sort(kk,kk+N);\n\n    cout<<kk[0]<<endl;\n\n    return 0;\n\n\n\n}\n",
        "optimized_code": "#include<bits/stdc++.h>\n\n#define LL long long\n\n#define L(x) x<<1    //\u5de6\u513f\u5b50 x*2\n\n#define R(x) x<<1|1 //\u53f3\u513f\u5b50  x*2+1\n\nusing namespace std;\n\nint a[105];\n\nint main() {\n\n    int n;\n\n    cin>>n;\n\n    for(int i=0;i<n;i++)\n\n        cin>>a[i];\n\n    sort(a,a+n);\n\n    cout<<a[n-1]-a[0]<<endl;\n\n    return 0;\n\n}\n"
    },
    {
        "id": "432",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cmath>\n\n#include <vector>\n\n#include <string>\n\n#include <iomanip>\n\n//#include <string.h>\n\n#include <bits/stdc++.h>\n\n#define INF 999999999\n\nusing namespace std;\n\n#define ll long long\n\n#define boost ios_base::sync_with_stdio(false); cin.tie(0); cout.tie(0);\n\nstruct shi\n\n{\n\n    int x=0;\n\n    int T;\n\n}s[1000000];\n\nint cmd(shi a,shi b)\n\n{\n\n    return a.x<b.x;\n\n}\n\n/*long long cmd(long long a, long long  b)\n\n{\n\n    return a > b;\n\n}*/\n\n\n\nint main()\n\n{\n\n    boost;\n\n    int N;\n\n    cin >>N;\n\n    int   hh[100000];\n\n    for(int i=0;i<N;i++){\n\n        cin >>hh[i];\n\n    }\n\n    sort(hh,hh+N);\n\n    int kk[105000];\n\n    int ma=0;\n\n    for(int i=0;i<N;i++){\n\n        if(i!=0&&i!=N-1){\n\n            kk[i]+=abs(hh[i]-hh[N-1])*2;\n\n            kk[i]+=abs(hh[i]-hh[0]);\n\n        }\n\n        else\n\n            kk[i]+=abs(hh[0]-hh[N-1]);\n\n\n\n    }\n\n\n\n    sort(kk,kk+N);\n\n    cout<<kk[0]<<endl;\n\n    return 0;\n\n\n\n}\n",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n,maxi=0, mini=1000;\n\n    cin>>n;\n\n    while(n--)\n\n    {\n\n        int num;\n\n        cin>>num;\n\n\n\n        if(num>maxi)\n\n            maxi=num;\n\n        if(num<mini)\n\n            mini=num;\n\n    }\n\n    cout<<maxi-mini<<endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "433",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cmath>\n\n#include <vector>\n\n#include <string>\n\n#include <iomanip>\n\n//#include <string.h>\n\n#include <bits/stdc++.h>\n\n#define INF 999999999\n\nusing namespace std;\n\n#define ll long long\n\n#define boost ios_base::sync_with_stdio(false); cin.tie(0); cout.tie(0);\n\nstruct shi\n\n{\n\n    int x=0;\n\n    int T;\n\n}s[1000000];\n\nint cmd(shi a,shi b)\n\n{\n\n    return a.x<b.x;\n\n}\n\n/*long long cmd(long long a, long long  b)\n\n{\n\n    return a > b;\n\n}*/\n\n\n\nint main()\n\n{\n\n    boost;\n\n    int N;\n\n    cin >>N;\n\n    int   hh[100000];\n\n    for(int i=0;i<N;i++){\n\n        cin >>hh[i];\n\n    }\n\n    sort(hh,hh+N);\n\n    int kk[105000];\n\n    int ma=0;\n\n    for(int i=0;i<N;i++){\n\n        if(i!=0&&i!=N-1){\n\n            kk[i]+=abs(hh[i]-hh[N-1])*2;\n\n            kk[i]+=abs(hh[i]-hh[0]);\n\n        }\n\n        else\n\n            kk[i]+=abs(hh[0]-hh[N-1]);\n\n\n\n    }\n\n\n\n    sort(kk,kk+N);\n\n    cout<<kk[0]<<endl;\n\n    return 0;\n\n\n\n}\n",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<vector>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n,i,x;\n\n    vector<int>v;\n\n    cin>>n;\n\n    for(i=0;i<n;i++)\n\n    {\n\n        cin>>x;\n\n        v.push_back(x);\n\n    }\n\n    if(n==1)\n\n    {\n\n        cout<<\"0\"<<endl;\n\n    }\n\n    else\n\n    {\n\n    sort(v.begin(),v.end());\n\n        cout<<v[v.size()-1]-v[0]<<endl;\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "434",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cmath>\n\n#include <vector>\n\n#include <string>\n\n#include <iomanip>\n\n//#include <string.h>\n\n#include <bits/stdc++.h>\n\n#define INF 999999999\n\nusing namespace std;\n\n#define ll long long\n\n#define boost ios_base::sync_with_stdio(false); cin.tie(0); cout.tie(0);\n\nstruct shi\n\n{\n\n    int x=0;\n\n    int T;\n\n}s[1000000];\n\nint cmd(shi a,shi b)\n\n{\n\n    return a.x<b.x;\n\n}\n\n/*long long cmd(long long a, long long  b)\n\n{\n\n    return a > b;\n\n}*/\n\n\n\nint main()\n\n{\n\n    boost;\n\n    int N;\n\n    cin >>N;\n\n    int   hh[100000];\n\n    for(int i=0;i<N;i++){\n\n        cin >>hh[i];\n\n    }\n\n    sort(hh,hh+N);\n\n    int kk[105000];\n\n    int ma=0;\n\n    for(int i=0;i<N;i++){\n\n        if(i!=0&&i!=N-1){\n\n            kk[i]+=abs(hh[i]-hh[N-1])*2;\n\n            kk[i]+=abs(hh[i]-hh[0]);\n\n        }\n\n        else\n\n            kk[i]+=abs(hh[0]-hh[N-1]);\n\n\n\n    }\n\n\n\n    sort(kk,kk+N);\n\n    cout<<kk[0]<<endl;\n\n    return 0;\n\n\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n   int x;\n\n   cin>>x;\n\n    int a[x];\n\n    for(int i=0;i<x;i++)\n\n        cin>>a[i];\n\n    sort(a,a+x);\n\n    cout<<a[x-1]-a[0];\n\n   return 0;\n\n   }\n"
    },
    {
        "id": "435",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cmath>\n\n#include <vector>\n\n#include <string>\n\n#include <iomanip>\n\n//#include <string.h>\n\n#include <bits/stdc++.h>\n\n#define INF 999999999\n\nusing namespace std;\n\n#define ll long long\n\n#define boost ios_base::sync_with_stdio(false); cin.tie(0); cout.tie(0);\n\nstruct shi\n\n{\n\n    int x=0;\n\n    int T;\n\n}s[1000000];\n\nint cmd(shi a,shi b)\n\n{\n\n    return a.x<b.x;\n\n}\n\n/*long long cmd(long long a, long long  b)\n\n{\n\n    return a > b;\n\n}*/\n\n\n\nint main()\n\n{\n\n    boost;\n\n    int N;\n\n    cin >>N;\n\n    int   hh[100000];\n\n    for(int i=0;i<N;i++){\n\n        cin >>hh[i];\n\n    }\n\n    sort(hh,hh+N);\n\n    int kk[105000];\n\n    int ma=0;\n\n    for(int i=0;i<N;i++){\n\n        if(i!=0&&i!=N-1){\n\n            kk[i]+=abs(hh[i]-hh[N-1])*2;\n\n            kk[i]+=abs(hh[i]-hh[0]);\n\n        }\n\n        else\n\n            kk[i]+=abs(hh[0]-hh[N-1]);\n\n\n\n    }\n\n\n\n    sort(kk,kk+N);\n\n    cout<<kk[0]<<endl;\n\n    return 0;\n\n\n\n}\n",
        "optimized_code": "#include <iostream>\n\n#include<cmath>\n\n#include<math.h>\n\n#include<algorithm>\n\n#include<fstream>\n\n#include<queue>\n\nusing namespace std;\n\nvoid ll(){\n\n\tstd::ios_base::sync_with_stdio(0);\n\n\tcin.tie(NULL);\n\n\tcout.tie(0);\n\n}\n\nint main()\n\n{\n\n\tll();\n\n\n\n\tvector<int> v;\n\n\tint arr[1000];\n\n\tint n,d=0,t=0;\n\n\tcin >> n;\n\n\tfor (int i = 0; i < n; i++)\n\n\t{\n\n\t\tcin >> arr[i];\n\n\t\tv.push_back(arr[i]);\n\n\t}\n\n\n\n\t\tsort(v.begin(), v.end());\n\n\n\n\t\td = v[n - 1] - v[0];\n\n\tcout << d << endl;\n\n}"
    },
    {
        "id": "437",
        "source_code": "//#pragma GCC optimize(3)\n\n#include<iostream>\n\n#include<iomanip>\n\n#include<stack>\n\n#include<queue>\n\n#include<list>\n\n#include<vector>\n\n#include<set> \n\n#include<map>\n\n#include<string>\n\n#include<algorithm>\n\n#include<cmath>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<cstdlib>\n\n#include<ctime>\n\n#define ll unsigned long long\n\n#define db double\n\n#define inf 3001\n\n#define INF (int)1e8 \n\n#define mod (int)(1e9+7)\n\n#define pi acos(-1)\n\n#define rd(n) {n=0;char ch;int f=0;do{ch=getchar();if(ch=='-'){f=1;}}while(ch<'0'||ch>'9');while('0'<=ch&&ch<='9'){n=(n<<1)+(n<<3)+ch-48;ch=getchar();}if(f)n=-n;}\n\nusing namespace std;\n\nint f[2][inf*2];\n\n\n\nint DP(int n,int m){\n\n    memset(f,0,sizeof(f));\n\n\tint now=0;\n\n\tfor (int i=0;i<=n;i++){\n\n\t\tf[now][i]=1;\n\n\t}\n\n\tfor (int i=1;i<=m;i++){\n\n\t\tnow^=1;\n\n\t\tfor (int j=0;j<=n;j++){\n\n\t\t\tf[now][j]=0;\n\n\t\t}\n\n\t\tfor (int j=0;j<=n;j++){\n\n\t\t\tif(j>0){\n\n                f[now][j-1]=(f[now][j-1]+f[now^1][j])%mod;\n\n                f[now][j]=(f[now][j]+f[now^1][j])%mod;\n\n            }\n\n            if(j<n){\n\n                f[now][j+1]=(f[now][j+1]+f[now^1][j])%mod;\n\n                f[now][j]=(f[now][j]+f[now^1][j])%mod;\n\n            }\n\n\t\t}\n\n\t}\n\n\tint ans=0;\n\n\tfor (int i=0;i<=n;i++){\n\n\t\tans=(ans+f[now][i])%mod;\n\n\t}\n\n\treturn ans;\n\n}\n\n\n\nint n,m;\n\n\n\nint main(){\n\n\trd(n) rd(m)\n\n\tprintf(\"%d\\n\",(DP(n,m)-DP(n-1,m)+mod)%mod);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#define gt getchar()\n\n#define ll long long\n\n#define File(s) freopen(s\".in\",\"r\",stdin),freopen(s\".out\",\"w\",stdout)\n\ntypedef std::pair<int,int> P;\n\n#define mk std::make_pair\n\n#define fr first\n\n#define sc second\n\ninline int in()\n\n{\n\n\tint k=0;char ch=gt;bool p=1;\n\n\twhile(ch<'-')ch=gt;if(ch=='-')ch=gt,p=0;\n\n\twhile(ch>'-')k=k*10+ch-'0',ch=gt;\n\n\treturn p?k:-k;\n\n}\n\nconst int N=3005,YL=1e9+7;\n\ninline int MO(const int &x){return x>=YL?x-YL:x;}\n\ninline void add(int &x,int y){if((x+=y)>=YL)x-=YL;}\n\nint f[2][N][2],now;\n\nint main()\n\n{\n\n\tint n=in(),m=in();f[now][0][1]=1;\n\n\tfor(int i=1;i<=n;++i)f[now][i][0]=1;\n\n\tfor(int i=1;i<=m;++i)\n\n\t{\n\n\t\tnow^=1;memset(f[now],0,sizeof f[now]);\n\n\t\tfor(int j=1;j<=n;++j)add(f[now][j][0],f[now^1][j-1][0]);//WW\n\n\t\tfor(int j=1;j<=n;++j)add(f[now][j][1],f[now^1][j-1][1]);\n\n\t\tfor(int j=1;j< n;++j)add(f[now][j][0],f[now^1][j+1][0]);//BB\n\n\t\tfor(int j=1;j< n;++j)add(f[now][j][1],f[now^1][j+1][1]);\n\n\t\tadd(f[now][0][1],f[now^1][1][1]),add(f[now][0][1],f[now^1][1][0]);\n\n\t\tfor(int j=0;j< n;++j)add(f[now][j][0],f[now^1][j][0]);//WB\n\n\t\tfor(int j=0;j< n;++j)add(f[now][j][1],f[now^1][j][1]);\n\n\t\tfor(int j=2;j<=n;++j)add(f[now][j][0],f[now^1][j][0]);//BW\n\n\t\tfor(int j=2;j<=n;++j)add(f[now][j][1],f[now^1][j][1]);\n\n\t\tadd(f[now][1][1],f[now^1][1][1]),add(f[now][1][1],f[now^1][1][0]);\n\n\t}\n\n\tint ans=0;\n\n\tfor(int i=0;i<=n;++i)add(ans,f[now][i][1]);\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "438",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\nusing namespace std;\n\n#define MOD 1000000007\n\n#define MAX 3030\n\nvoid add(int &x,int y){x+=y;if(x>=MOD)x-=MOD;}\n\nint n,m,ans,f[MAX][MAX][2];\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);f[0][0][1]=1;\n\n\tfor(int i=1;i<=n;++i)f[0][i][0]=1;\n\n\tfor(int i=1;i<=m;++i)\n\n\t\tfor(int j=0;j<=n;++j)\n\n\t\t\tfor(int k=0;k<=1;++k)\n\n\t\t\t{\n\n\t\t\t\tif(j)add(f[i][j][k|(j==1)],f[i-1][j][k]),add(f[i][j-1][k|(j==1)],f[i-1][j][k]);\n\n\t\t\t\tif(n-j)add(f[i][j+1][k],f[i-1][j][k]),add(f[i][j][k],f[i-1][j][k]);\n\n\t\t\t}\n\n\tfor(int i=0;i<=n;++i)add(ans,f[m][i][1]);\n\n\tprintf(\"%d\\n\",ans);return 0;\n\n}\n",
        "optimized_code": "#include<cmath>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#define gt getchar()\n\n#define ll long long\n\n#define File(s) freopen(s\".in\",\"r\",stdin),freopen(s\".out\",\"w\",stdout)\n\ntypedef std::pair<int,int> P;\n\n#define mk std::make_pair\n\n#define fr first\n\n#define sc second\n\ninline int in()\n\n{\n\n\tint k=0;char ch=gt;bool p=1;\n\n\twhile(ch<'-')ch=gt;if(ch=='-')ch=gt,p=0;\n\n\twhile(ch>'-')k=k*10+ch-'0',ch=gt;\n\n\treturn p?k:-k;\n\n}\n\nconst int N=3005,YL=1e9+7;\n\ninline int MO(const int &x){return x>=YL?x-YL:x;}\n\ninline void add(int &x,int y){if((x+=y)>=YL)x-=YL;}\n\nint f[2][N][2],now;\n\nint main()\n\n{\n\n\tint n=in(),m=in();f[now][0][1]=1;\n\n\tfor(int i=1;i<=n;++i)f[now][i][0]=1;\n\n\tfor(int i=1;i<=m;++i)\n\n\t{\n\n\t\tnow^=1;memset(f[now],0,sizeof f[now]);\n\n\t\tfor(int j=1;j<=n;++j)add(f[now][j][0],f[now^1][j-1][0]);//WW\n\n\t\tfor(int j=1;j<=n;++j)add(f[now][j][1],f[now^1][j-1][1]);\n\n\t\tfor(int j=1;j< n;++j)add(f[now][j][0],f[now^1][j+1][0]);//BB\n\n\t\tfor(int j=1;j< n;++j)add(f[now][j][1],f[now^1][j+1][1]);\n\n\t\tadd(f[now][0][1],f[now^1][1][1]),add(f[now][0][1],f[now^1][1][0]);\n\n\t\tfor(int j=0;j< n;++j)add(f[now][j][0],f[now^1][j][0]);//WB\n\n\t\tfor(int j=0;j< n;++j)add(f[now][j][1],f[now^1][j][1]);\n\n\t\tfor(int j=2;j<=n;++j)add(f[now][j][0],f[now^1][j][0]);//BW\n\n\t\tfor(int j=2;j<=n;++j)add(f[now][j][1],f[now^1][j][1]);\n\n\t\tadd(f[now][1][1],f[now^1][1][1]),add(f[now][1][1],f[now^1][1][0]);\n\n\t}\n\n\tint ans=0;\n\n\tfor(int i=0;i<=n;++i)add(ans,f[now][i][1]);\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "439",
        "source_code": "#include<cstdio>\n\nconst int MAXN=3005,MOD=1000000007;\n\n\n\nint N,M;\n\nint dp[MAXN][MAXN][2];\n\n\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&N,&M);\n\n\tdp[0][0][1]=1;\n\n\tfor(int i=1;i<=N;i++)\n\n\t\tdp[0][i][0]=1;\n\n\tfor(int i=0;i<M;i++)\n\n\t\tfor(int j=0;j<=N;j++)\n\n\t\t\tfor(int k=0;k<2;k++)\n\n\t\t\t{\n\n\t\t\t\tif(j>0)\n\n\t\t\t\t{\n\n\t\t\t\t\t(dp[i+1][j-1][k|(j==1)]+=dp[i][j][k])%=MOD;\n\n\t\t\t\t\t(dp[i+1][j][k|(j==1)]+=dp[i][j][k])%=MOD;\n\n\t\t\t\t}\n\n\t\t\t\tif(j<N)\n\n\t\t\t\t{\n\n\t\t\t\t\t(dp[i+1][j+1][k]+=dp[i][j][k])%=MOD;\n\n\t\t\t\t\t(dp[i+1][j][k]+=dp[i][j][k])%=MOD;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\tint ans=0;\n\n\tfor(int j=0;j<=N;j++)\n\n\t\t(ans+=dp[M][j][1])%=MOD;\n\n\tprintf(\"%d\\n\",ans);\n\n\t\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<deque>\n\nusing namespace std;\n\nconst int N=3000+5;\n\nconst int mod=1e9+7;\n\nint d[N][N][2];\n\nint n,m;\n\nint main()\n\n{\n\n    scanf(\"%d%d\",&n,&m);\n\n    d[0][0][1]=1;\n\n    for(int i=1;i<=n;i++)\n\n        d[0][i][0]=1;\n\n    for(int i=0;i<m;i++)\n\n        for(int j=0;j<=n;j++)\n\n            for(int k=0;k<2;k++)\n\n                if(d[i][j][k]){\n\n                    if(j){\n\n                        d[i+1][j-1][k|(j==1)]+=d[i][j][k];\n\n                        d[i+1][j-1][k|(j==1)]%=mod;\n\n                        d[i+1][j][k|(j==1)]+=d[i][j][k];\n\n                        d[i+1][j][k|(j==1)]%=mod;\n\n                    }\n\n                    if(j<n){\n\n                        d[i+1][j][k]+=d[i][j][k];\n\n                        d[i+1][j][k]%=mod;\n\n                        d[i+1][j+1][k]+=d[i][j][k];\n\n                        d[i+1][j+1][k]%=mod;\n\n                    }\n\n                }\n\n    int ans=0;\n\n    for(int i=0;i<=n;i++){\n\n        ans+=d[m][i][1];\n\n        ans%=mod;\n\n    }\n\n    printf(\"%d\\n\",ans);\n\n}\n"
    },
    {
        "id": "440",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint f[3005][3005][2],ms=1e9+7;\n\nint main(){\n\n\tint n,m;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tf[0][0][1]=1;\n\n\tfor (int i=1;i<=n;i++)\n\n\tf[0][i][0]=1;\n\n\tfor (int i=0;i<=m;i++)\n\n\tfor (int j=0;j<=n;j++)\n\n\tfor (int k=0;k<=1;k++){\n\n\t\tif (j) (f[i+1][j-1][!(j-1)|k]+=f[i][j][k])%=ms;\n\n\t\tif (n-j) (f[i+1][j+1][k]+=f[i][j][k])%=ms;\n\n\t\tif (j) (f[i+1][j][k|(j==1)]+=f[i][j][k])%=ms;\n\n\t\tif (n-j) (f[i+1][j][k]+=f[i][j][k])%=ms;\n\n\t}\n\n\tint ans=0;\n\n\tfor (int i=0;i<=n;i++)\n\n\t(ans+=f[m][i][1])%=ms;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n\n\nint read()\n\n{\n\n  int x=0,f=1;\n\n  char ch=getchar();\n\n  while((ch<'0')||(ch>'9'))\n\n    {\n\n      if(ch=='-')\n\n        {\n\n          f=-f;\n\n        }\n\n      ch=getchar();\n\n    }\n\n  while((ch>='0')&&(ch<='9'))\n\n    {\n\n      x=x*10+ch-'0';\n\n      ch=getchar();\n\n    }\n\n  return x*f;\n\n}\n\n\n\nconst int maxn=3000;\n\nconst int mod=1000000007;\n\n\n\nint n,k,f[maxn+10][maxn+10][2],ans;\n\n\n\nint main()\n\n{\n\n  n=read();\n\n  k=read();\n\n  for(int i=0; i<=n; ++i)\n\n    {\n\n      f[0][i][(i==0)]=1;\n\n    }\n\n  for(int i=0; i<k; ++i)\n\n    {\n\n      for(int j=0; j<=n; ++j)\n\n        {\n\n          for(int sta=0; sta<2; ++sta)\n\n            {\n\n              if(j>0)\n\n                {\n\n                  f[i+1][j-1][sta|(j==1)]+=f[i][j][sta];\n\n                  if(f[i+1][j-1][sta|(j==1)]>=mod)\n\n                    {\n\n                      f[i+1][j-1][sta|(j==1)]-=mod;\n\n                    }\n\n                  f[i+1][j][sta|(j==1)]+=f[i][j][sta];\n\n                  if(f[i+1][j][sta|(j==1)]>=mod)\n\n                    {\n\n                      f[i+1][j][sta|(j==1)]-=mod;\n\n                    }\n\n                }\n\n              if(j<n)\n\n                {\n\n                  f[i+1][j+1][sta]+=f[i][j][sta];\n\n                  if(f[i+1][j+1][sta]>=mod)\n\n                    {\n\n                      f[i+1][j+1][sta]-=mod;\n\n                    }\n\n                  f[i+1][j][sta]+=f[i][j][sta];\n\n                  if(f[i+1][j][sta]>=mod)\n\n                    {\n\n                      f[i+1][j][sta]-=mod;\n\n                    }\n\n                }\n\n            }\n\n        }\n\n    }\n\n  for(int i=0; i<=n; ++i)\n\n    {\n\n      ans+=f[k][i][1];\n\n      if(ans>=mod)\n\n        {\n\n          ans-=mod;\n\n        }\n\n    }\n\n  printf(\"%d\\n\",ans);\n\n  return 0;\n\n}\n"
    },
    {
        "id": "441",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint f[3005][3005][2],ms=1e9+7;\n\nint main(){\n\n\tint n,m;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tf[0][0][1]=1;\n\n\tfor (int i=1;i<=n;i++)\n\n\tf[0][i][0]=1;\n\n\tfor (int i=0;i<=m;i++)\n\n\tfor (int j=0;j<=n;j++)\n\n\tfor (int k=0;k<=1;k++){\n\n\t\tif (j) (f[i+1][j-1][!(j-1)|k]+=f[i][j][k])%=ms;\n\n\t\tif (n-j) (f[i+1][j+1][k]+=f[i][j][k])%=ms;\n\n\t\tif (j) (f[i+1][j][k|(j==1)]+=f[i][j][k])%=ms;\n\n\t\tif (n-j) (f[i+1][j][k]+=f[i][j][k])%=ms;\n\n\t}\n\n\tint ans=0;\n\n\tfor (int i=0;i<=n;i++)\n\n\t(ans+=f[m][i][1])%=ms;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#define N 3010\n\n#define mod 1000000007\n\nint n,m,f[N][N][2],ans;\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tf[0][0][1]=1;\n\n\tfor(int i=1;i<=n;++i) f[0][i][0]=1;\n\n\tfor(int i=0;i<m;++i){\n\n\t\tfor(int j=0;j<=n;++j){\n\n\t\t\tfor(int k=0;k<=1;++k){\n\n\t\t\t\tif(j) f[i+1][j-1][k|(j==1)]=(f[i+1][j-1][k|(j==1)]+f[i][j][k])%mod;\n\n\t\t\t\tif(j) f[i+1][j][k|(j==1)]=(f[i+1][j][k|(j==1)]+f[i][j][k])%mod;\n\n\t\t\t\tif(n-j) f[i+1][j][k]=(f[i+1][j][k]+f[i][j][k])%mod;\n\n\t\t\t\tif(n-j) f[i+1][j+1][k]=(f[i+1][j+1][k]+f[i][j][k])%mod;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfor(int i=0;i<=n;++i) ans=(ans+f[m][i][1])%mod;\n\n\tprintf(\"%d\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "445",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cmath>\n\n#include<cstring>\n\nusing namespace std;\n\nint map[100005];\n\nint main()\n\n{\n\n\tint n,maxn=0,mine=666666,sum=0;\n\n\tmemset(map,0,sizeof(map));\n\n\tcin>>n;\n\n\twhile(n--)\n\n\t{\n\n\t\tint a,b;\n\n\t\tcin>>a>>b;\n\n\t\tmaxn=max(a,maxn);\n\n\t\tmaxn=max(b,maxn);\n\n\t\tmine=min(a,mine);\n\n\t\tmine=min(a,mine);\n\n\t\tfor(int i=a; i<=b; i++)\n\n\t\t{\n\n\t\t\tif(map[i])\n\n\t\t\t\tcontinue;\n\n\t\t\telse\n\n\t\t\t\tmap[i]=1;\n\n\t\t}\n\n\t}\n\n\tfor(int i=mine; i<=maxn; i++)\n\n\t\tif(map[i])\n\n\t\t\tsum++;\n\n\tcout<<sum<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\n#include<string.h>\n\nint main()\n\n{\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint a,b;\n\n\tint ans=0;\n\n\twhile(n--)\n\n\t{\n\n\t\tscanf(\"%d %d\",&a,&b);\n\n\t\tif(a!=b)\n\n\t\t{\n\n\t\t\tans+=(b-a+1);\n\n\t\t}\n\n\t\telse\n\n\t\t{\n\n\t\t\tans+=1;\n\n\t\t}\n\n\t } \n\n\t printf(\"%d\\n\",ans);\n\n\t return 0;\n\n } "
    },
    {
        "id": "446",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cmath>\n\n#include<cstring>\n\nusing namespace std;\n\nint map[100005];\n\nint main()\n\n{\n\n\tint n,maxn=0,mine=666666,sum=0;\n\n\tmemset(map,0,sizeof(map));\n\n\tcin>>n;\n\n\twhile(n--)\n\n\t{\n\n\t\tint a,b;\n\n\t\tcin>>a>>b;\n\n\t\tmaxn=max(a,maxn);\n\n\t\tmaxn=max(b,maxn);\n\n\t\tmine=min(a,mine);\n\n\t\tmine=min(a,mine);\n\n\t\tfor(int i=a; i<=b; i++)\n\n\t\t{\n\n\t\t\tif(map[i])\n\n\t\t\t\tcontinue;\n\n\t\t\telse\n\n\t\t\t\tmap[i]=1;\n\n\t\t}\n\n\t}\n\n\tfor(int i=mine; i<=maxn; i++)\n\n\t\tif(map[i])\n\n\t\t\tsum++;\n\n\tcout<<sum<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <set>\n\n#include <iomanip>\n\n#include <vector>\n\n#include <queue>\n\n#include <numeric>\n\n//#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\nconst int INF = 1 << 30;\n\n\n\nint main()\n\n{\n\n    ios::sync_with_stdio(false);\n\n    int n;\n\n    cin>>n;\n\n    int ans=0;\n\n    for(int i = 0 ; i < n ;++i)\n\n    {\n\n        int x ,y;\n\n        cin>>x>>y;\n\n        ans+=(y-x+1);\n\n    }\n\n    cout<<ans<<endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "447",
        "source_code": "#include<iostream>\n\n#include<string.h>\n\n#include<cstdio>\n\n#include<queue>\n\nusing namespace std;\n\n\n\nint flag[100010];\n\nint main(){\n\n\n\n   int n, l, r;\n\n   while(cin >> n){\n\n        memset(flag, 0, sizeof(flag));\n\n   int cnt = 0;\n\n   for(int i = 0; i < n; ++i){\n\n        cin >> l>> r;\n\n        for(int i = l; i <= r; ++i){\n\n            if(!flag[i]){\n\n                flag[i] = 1;\n\n                cnt ++;\n\n            }\n\n        }\n\n   }\n\n   cout << cnt <<endl;\n\n   }\n\n\n\n\n\n   return 0;\n\n}\n",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <set>\n\n#include <iomanip>\n\n#include <vector>\n\n#include <queue>\n\n#include <numeric>\n\n//#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\nconst int INF = 1 << 30;\n\n\n\nint main()\n\n{\n\n    ios::sync_with_stdio(false);\n\n    int n;\n\n    cin>>n;\n\n    int ans=0;\n\n    for(int i = 0 ; i < n ;++i)\n\n    {\n\n        int x ,y;\n\n        cin>>x>>y;\n\n        ans+=(y-x+1);\n\n    }\n\n    cout<<ans<<endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "448",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cmath>\n\n#include<cstring>\n\nusing namespace std;\n\nint map[100005];\n\nint main()\n\n{\n\n\tint n,maxn=0,mine=666666,sum=0;\n\n\tmemset(map,0,sizeof(map));\n\n\tcin>>n;\n\n\twhile(n--)\n\n\t{\n\n\t\tint a,b;\n\n\t\tcin>>a>>b;\n\n\t\tmaxn=max(a,maxn);\n\n\t\tmaxn=max(b,maxn);\n\n\t\tmine=min(a,mine);\n\n\t\tmine=min(a,mine);\n\n\t\tfor(int i=a; i<=b; i++)\n\n\t\t{\n\n\t\t\tif(map[i])\n\n\t\t\t\tcontinue;\n\n\t\t\telse\n\n\t\t\t\tmap[i]=1;\n\n\t\t}\n\n\t}\n\n\tfor(int i=mine; i<=maxn; i++)\n\n\t\tif(map[i])\n\n\t\t\tsum++;\n\n\tcout<<sum<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cmath>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nint ans[55];\n\n\n\nint main()\n\n{\n\n    int n,a,b;\n\n    cin>>n;\n\n    int result=0;\n\n    for (int i=0;i<n;i++){\n\n        cin>>a>>b;\n\n        result+=b-a+1;\n\n    }\n\n    cout<<result<<endl;\n\n    return 0;\n\n}\n"
    },
    {
        "id": "449",
        "source_code": "#include<iostream>\n\n#include<string.h>\n\n#include<cstdio>\n\n#include<queue>\n\nusing namespace std;\n\n\n\nint flag[100010];\n\nint main(){\n\n\n\n   int n, l, r;\n\n   while(cin >> n){\n\n        memset(flag, 0, sizeof(flag));\n\n   int cnt = 0;\n\n   for(int i = 0; i < n; ++i){\n\n        cin >> l>> r;\n\n        for(int i = l; i <= r; ++i){\n\n            if(!flag[i]){\n\n                flag[i] = 1;\n\n                cnt ++;\n\n            }\n\n        }\n\n   }\n\n   cout << cnt <<endl;\n\n   }\n\n\n\n\n\n   return 0;\n\n}\n",
        "optimized_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cmath>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nint ans[55];\n\n\n\nint main()\n\n{\n\n    int n,a,b;\n\n    cin>>n;\n\n    int result=0;\n\n    for (int i=0;i<n;i++){\n\n        cin>>a>>b;\n\n        result+=b-a+1;\n\n    }\n\n    cout<<result<<endl;\n\n    return 0;\n\n}\n"
    },
    {
        "id": "450",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cmath>\n\n#include<cstring>\n\nusing namespace std;\n\nint map[100005];\n\nint main()\n\n{\n\n\tint n,maxn=0,mine=666666,sum=0;\n\n\tmemset(map,0,sizeof(map));\n\n\tcin>>n;\n\n\twhile(n--)\n\n\t{\n\n\t\tint a,b;\n\n\t\tcin>>a>>b;\n\n\t\tmaxn=max(a,maxn);\n\n\t\tmaxn=max(b,maxn);\n\n\t\tmine=min(a,mine);\n\n\t\tmine=min(a,mine);\n\n\t\tfor(int i=a; i<=b; i++)\n\n\t\t{\n\n\t\t\tif(map[i])\n\n\t\t\t\tcontinue;\n\n\t\t\telse\n\n\t\t\t\tmap[i]=1;\n\n\t\t}\n\n\t}\n\n\tfor(int i=mine; i<=maxn; i++)\n\n\t\tif(map[i])\n\n\t\t\tsum++;\n\n\tcout<<sum<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <map>\n\n#include <iostream>\n\n#include <algorithm>\n\n#define ll long long\n\nusing namespace std;\n\nll ans;\n\nint main()\n\n{\n\n\tint n,l,r;\n\n\tscanf(\"%d\",&n);\n\n\tfor(int i=0;i<n;i++){\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tans+=(r-l)+1;\n\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n    return 0;\n\n}"
    },
    {
        "id": "451",
        "source_code": "#include<iostream>\n\n#include<string.h>\n\n#include<cstdio>\n\n#include<queue>\n\nusing namespace std;\n\n\n\nint flag[100010];\n\nint main(){\n\n\n\n   int n, l, r;\n\n   while(cin >> n){\n\n        memset(flag, 0, sizeof(flag));\n\n   int cnt = 0;\n\n   for(int i = 0; i < n; ++i){\n\n        cin >> l>> r;\n\n        for(int i = l; i <= r; ++i){\n\n            if(!flag[i]){\n\n                flag[i] = 1;\n\n                cnt ++;\n\n            }\n\n        }\n\n   }\n\n   cout << cnt <<endl;\n\n   }\n\n\n\n\n\n   return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <map>\n\n#include <iostream>\n\n#include <algorithm>\n\n#define ll long long\n\nusing namespace std;\n\nll ans;\n\nint main()\n\n{\n\n\tint n,l,r;\n\n\tscanf(\"%d\",&n);\n\n\tfor(int i=0;i<n;i++){\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tans+=(r-l)+1;\n\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n    return 0;\n\n}"
    },
    {
        "id": "452",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cmath>\n\n#include<cstring>\n\nusing namespace std;\n\nint map[100005];\n\nint main()\n\n{\n\n\tint n,maxn=0,mine=666666,sum=0;\n\n\tmemset(map,0,sizeof(map));\n\n\tcin>>n;\n\n\twhile(n--)\n\n\t{\n\n\t\tint a,b;\n\n\t\tcin>>a>>b;\n\n\t\tmaxn=max(a,maxn);\n\n\t\tmaxn=max(b,maxn);\n\n\t\tmine=min(a,mine);\n\n\t\tmine=min(a,mine);\n\n\t\tfor(int i=a; i<=b; i++)\n\n\t\t{\n\n\t\t\tif(map[i])\n\n\t\t\t\tcontinue;\n\n\t\t\telse\n\n\t\t\t\tmap[i]=1;\n\n\t\t}\n\n\t}\n\n\tfor(int i=mine; i<=maxn; i++)\n\n\t\tif(map[i])\n\n\t\t\tsum++;\n\n\tcout<<sum<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <iostream>\n\nusing namespace std;\n\nint n,a,b,x;\n\nint main () {\n\ncin >> n;\n\nfor (int i=1;i<=n;i++) {\n\n\tcin >> a >> b;\n\n\tx+=b-a+1;\n\n}\n\ncout << x << endl;\n\n}"
    },
    {
        "id": "453",
        "source_code": "#include<iostream>\n\n#include<string.h>\n\n#include<cstdio>\n\n#include<queue>\n\nusing namespace std;\n\n\n\nint flag[100010];\n\nint main(){\n\n\n\n   int n, l, r;\n\n   while(cin >> n){\n\n        memset(flag, 0, sizeof(flag));\n\n   int cnt = 0;\n\n   for(int i = 0; i < n; ++i){\n\n        cin >> l>> r;\n\n        for(int i = l; i <= r; ++i){\n\n            if(!flag[i]){\n\n                flag[i] = 1;\n\n                cnt ++;\n\n            }\n\n        }\n\n   }\n\n   cout << cnt <<endl;\n\n   }\n\n\n\n\n\n   return 0;\n\n}\n",
        "optimized_code": "#include <iostream>\n\nusing namespace std;\n\nint n,a,b,x;\n\nint main () {\n\ncin >> n;\n\nfor (int i=1;i<=n;i++) {\n\n\tcin >> a >> b;\n\n\tx+=b-a+1;\n\n}\n\ncout << x << endl;\n\n}"
    },
    {
        "id": "454",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define pb push_back\n\n#define fi first\n\n#define se second\n\n#define mem(x,n) memset(x,n,sizeof(x))\n\n#define sz(x) (int)(x).size()\n\n#define all(x) (x).begin(),(x).end()\n\n#define foreach(it,l) for(auto it=(l).begin();it!=(l).end();it++)\n\n#define pnl printf(\"\\n\")\n\n#define endl '\\n'\n\n#define len(x) (x).length()\n\n\n\ntypedef long long LL;\n\ntypedef unsigned long long ULL;\n\ntypedef pair<int,int> PII;\n\ntypedef pair<LL,LL> PLL;\n\ntypedef vector<int> VI;\n\nconst double EPS=1e-10;\n\n//const double PI=acos(-1.0);\n\nconst int INF=1<<30;\n\nconst LL LLINF=1ll<<60;\n\nconst int MOD=1e9+7;\n\nconst int xx[8]={1,0,-1,0,1,-1,1,-1};\n\nconst int yy[8]={0,1,0,-1,-1,1,1,-1};\n\n\n\nvoid fastio(){ ios_base::sync_with_stdio(false); cin.tie(0); cout.tie(0); }\n\n\n\n/***********************************\\\n\n     _____ _             _\n\n    /  __ \\ |           (_)\n\n    | /  / | __ _ _ __  _  ___\n\n    | |   | |/ _` | '_ \\| |/ _ \\\n\n    | \\__/\\ | (_| | |_) | |  __/\n\n     \\____/_|\\__,_| .__/|_|\\___|\n\n                  | |\n\n                  |_|\n\n\\***********************************/\n\n\n\nint asd[100005];\n\n\n\nint main(){\n\n\tint tc;\n\n\tscanf(\"%d\",&tc);\n\n\twhile(tc--){\n\n\t\tint x,y;\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tfor(int i=x;i<=y;i++){\n\n\t\t\tasd[i]++;\n\n\t\t}\n\n\t}\n\n\tint cnt=0;\n\n\t\tfor(int i=1;i<=100000;i++){\n\n\t\t\tif(asd[i]!=0) cnt++;\n\n\t\t}\n\n\tprintf(\"%d\",cnt);\t\t\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define ll long long\n\nll arr[200009];\n\nint main()\n\n{\n\n    ll n,t,m,x,i,j,k,maxi = INT_MIN,mini = INT_MAX,flag =0,sum=0;\n\n    vector<ll>vi;\n\n    cin>>n;\n\n    for(i= 0 ;i<n ;i++)\n\n    {\n\n        cin>>j>>k;\n\n        sum+=k-j+1;\n\n    }\n\n    cout<<sum<<endl;\n\n    return 0;\n\n}\n\n\n"
    },
    {
        "id": "455",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint n,maxn=-99998989;\n\nint f[100010],cnt,x,y;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>x>>y;\n\n\t\tmaxn=maxn<y?y:maxn;\n\n\t\tfor(int i=x;i<=y;i++)\n\n\t\t  f[i]=1;\n\n\t}\n\n\tfor(int i=1;i<=maxn;i++)\n\n\t  if(f[i]==1)\n\n\t    cnt++;\n\n\tcout<<cnt;\n\n}",
        "optimized_code": "#include <cstdio>\n\nint main(){\n\n    int n,l,r,ans=0;\n\n    scanf(\"%d\",&n);\n\n    for(int i=0;i<n;++i) scanf(\"%d %d\",&l,&r),ans+=r-l+1;\n\n    printf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "456",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <iomanip>\n\n#include <cmath>\n\n#include <string>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <sstream>\n\n#include <set>\n\n#include <queue>\n\n#include <stack>\n\n#include <cctype>\n\n#include <map>\n\n#include <climits>\n\n#include <bitset>\n\nusing namespace std;\n\n#define MATH_PI 3.14159265358979323846\n\nint main(){\n\n\tios::sync_with_stdio(false);\n\n\tint nCount,iStart,iEnd;\n\n\tregister int i,nTotal=0;\n\n\tcin >> nCount;\n\n\tfor (i = 1; i <= nCount; ++i){\n\n\t\tcin >> iStart >> iEnd;\n\n\t\tnTotal += iEnd - iStart + 1;\n\n\t}\n\n\tcout << nTotal << endl;\n\nendapp:\n\n\t//system(\"pause > nul\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\nint main(){\n\n    int n,l,r,ans=0;\n\n    scanf(\"%d\",&n);\n\n    for(int i=0;i<n;++i) scanf(\"%d %d\",&l,&r),ans+=r-l+1;\n\n    printf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "457",
        "source_code": "#include<iostream>\n\n#include<iomanip>\n\n#include<cstdio>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<algorithm>\n\nusing namespace std;\n\nint main(){\n\n\tlong long n,a,b,ans=0;\n\n\tcin>>n;\n\n\twhile(n--){\n\n\t\tcin>>a>>b;\n\n\t\tans+=b-a+1;\n\n\t}\n\n\tcout<<ans;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\nint main(){\n\n    int n,l,r,ans=0;\n\n    scanf(\"%d\",&n);\n\n    for(int i=0;i<n;++i) scanf(\"%d %d\",&l,&r),ans+=r-l+1;\n\n    printf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "458",
        "source_code": "#include <iostream>\n\nusing namespace std; //\u5934\u6587\u4ef6\u548c\u547d\u540d\u7a7a\u95f4\n\nint main(){\n\n    ios::sync_with_stdio(false); //\u8f93\u5165\u8f93\u51fa\u52a0\u901f\n\n    int nCount,iStart,iEnd; //nCount-\u56e2\u4f53\u4e2a\u6570\uff1biStart-\u5ea7\u4f4d\u53f7\u8d77\u59cb\uff1biEnd-\u5ea7\u4f4d\u53f7\u7ed3\u675f\n\n    register int i,nTotal=0; //\u5faa\u73af\u8ba1\u6570\u5668\u548c\u603b\u548c\n\n    cin >> nCount; //\u8bfb\u5165\u56e2\u4f53\u6570\n\n    for (i = 1; i <= nCount; ++i){ //\u8bfb\u5165\u6bcf\u4e2a\u56e2\u4f53\u5360\u7528\u7684\u5ea7\u4f4d\n\n        cin >> iStart >> iEnd; //\u8bfb\u5165\u8d77\u59cb\u548c\u7ed3\u675f\n\n        nTotal += iEnd - iStart + 1; //\u8ba1\u7b97\u5360\u7528\u4e86\u591a\u5c11\u4e2a\u5ea7\u4f4d\uff0c\u52a0\u603b\n\n    }\n\n    cout << nTotal << endl; //\u8f93\u51fa\uff0c\u52ff\u5fd8\u6362\u884c\n\n    return 0; //\u7ed3\u675f\n\n}",
        "optimized_code": "#include <cstdio>\n\nint main(){\n\n    int n,l,r,ans=0;\n\n    scanf(\"%d\",&n);\n\n    for(int i=0;i<n;++i) scanf(\"%d %d\",&l,&r),ans+=r-l+1;\n\n    printf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "459",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nlong long z,a,b,n;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tz+=b-a+1;\n\n\t}\n\n\tcout<<z<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\nint main(){\n\n    int n,l,r,ans=0;\n\n    scanf(\"%d\",&n);\n\n    for(int i=0;i<n;++i) scanf(\"%d %d\",&l,&r),ans+=r-l+1;\n\n    printf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "460",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint n,maxn=-99998989;\n\nint f[100010],cnt,x,y;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>x>>y;\n\n\t\tmaxn=maxn<y?y:maxn;\n\n\t\tfor(int i=x;i<=y;i++)\n\n\t\t  f[i]=1;\n\n\t}\n\n\tfor(int i=1;i<=maxn;i++)\n\n\t  if(f[i]==1)\n\n\t    cnt++;\n\n\tcout<<cnt;\n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main()\n\n{\n\n\tint l,r,n,ans=0,i;\n\n\tscanf(\"%d\",&n);\n\n\tfor(i=0;i<n;i++)\n\n\t\tscanf(\"%d %d\",&l,&r),ans+=r-l+1;\n\n\tprintf(\"%d\",ans);\n\n}"
    },
    {
        "id": "461",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <iomanip>\n\n#include <cmath>\n\n#include <string>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <sstream>\n\n#include <set>\n\n#include <queue>\n\n#include <stack>\n\n#include <cctype>\n\n#include <map>\n\n#include <climits>\n\n#include <bitset>\n\nusing namespace std;\n\n#define MATH_PI 3.14159265358979323846\n\nint main(){\n\n\tios::sync_with_stdio(false);\n\n\tint nCount,iStart,iEnd;\n\n\tregister int i,nTotal=0;\n\n\tcin >> nCount;\n\n\tfor (i = 1; i <= nCount; ++i){\n\n\t\tcin >> iStart >> iEnd;\n\n\t\tnTotal += iEnd - iStart + 1;\n\n\t}\n\n\tcout << nTotal << endl;\n\nendapp:\n\n\t//system(\"pause > nul\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main()\n\n{\n\n\tint l,r,n,ans=0,i;\n\n\tscanf(\"%d\",&n);\n\n\tfor(i=0;i<n;i++)\n\n\t\tscanf(\"%d %d\",&l,&r),ans+=r-l+1;\n\n\tprintf(\"%d\",ans);\n\n}"
    },
    {
        "id": "462",
        "source_code": "#include<iostream>\n\n#include<iomanip>\n\n#include<cstdio>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<algorithm>\n\nusing namespace std;\n\nint main(){\n\n\tlong long n,a,b,ans=0;\n\n\tcin>>n;\n\n\twhile(n--){\n\n\t\tcin>>a>>b;\n\n\t\tans+=b-a+1;\n\n\t}\n\n\tcout<<ans;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\nint main()\n\n{\n\n\tint l,r,n,ans=0,i;\n\n\tscanf(\"%d\",&n);\n\n\tfor(i=0;i<n;i++)\n\n\t\tscanf(\"%d %d\",&l,&r),ans+=r-l+1;\n\n\tprintf(\"%d\",ans);\n\n}"
    },
    {
        "id": "463",
        "source_code": "#include <iostream>\n\nusing namespace std; //\u5934\u6587\u4ef6\u548c\u547d\u540d\u7a7a\u95f4\n\nint main(){\n\n    ios::sync_with_stdio(false); //\u8f93\u5165\u8f93\u51fa\u52a0\u901f\n\n    int nCount,iStart,iEnd; //nCount-\u56e2\u4f53\u4e2a\u6570\uff1biStart-\u5ea7\u4f4d\u53f7\u8d77\u59cb\uff1biEnd-\u5ea7\u4f4d\u53f7\u7ed3\u675f\n\n    register int i,nTotal=0; //\u5faa\u73af\u8ba1\u6570\u5668\u548c\u603b\u548c\n\n    cin >> nCount; //\u8bfb\u5165\u56e2\u4f53\u6570\n\n    for (i = 1; i <= nCount; ++i){ //\u8bfb\u5165\u6bcf\u4e2a\u56e2\u4f53\u5360\u7528\u7684\u5ea7\u4f4d\n\n        cin >> iStart >> iEnd; //\u8bfb\u5165\u8d77\u59cb\u548c\u7ed3\u675f\n\n        nTotal += iEnd - iStart + 1; //\u8ba1\u7b97\u5360\u7528\u4e86\u591a\u5c11\u4e2a\u5ea7\u4f4d\uff0c\u52a0\u603b\n\n    }\n\n    cout << nTotal << endl; //\u8f93\u51fa\uff0c\u52ff\u5fd8\u6362\u884c\n\n    return 0; //\u7ed3\u675f\n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main()\n\n{\n\n\tint l,r,n,ans=0,i;\n\n\tscanf(\"%d\",&n);\n\n\tfor(i=0;i<n;i++)\n\n\t\tscanf(\"%d %d\",&l,&r),ans+=r-l+1;\n\n\tprintf(\"%d\",ans);\n\n}"
    },
    {
        "id": "464",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nlong long z,a,b,n;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tz+=b-a+1;\n\n\t}\n\n\tcout<<z<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main()\n\n{\n\n\tint l,r,n,ans=0,i;\n\n\tscanf(\"%d\",&n);\n\n\tfor(i=0;i<n;i++)\n\n\t\tscanf(\"%d %d\",&l,&r),ans+=r-l+1;\n\n\tprintf(\"%d\",ans);\n\n}"
    },
    {
        "id": "465",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n,ans=0;\n\n\tcin>>n;\n\n\twhile(n--)\n\n\t{\n\n\t\tint l,r;\n\n\t\tcin>>l>>r;\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\nint main()\n\n{\n\n\tint l,r,n,ans=0,i;\n\n\tscanf(\"%d\",&n);\n\n\tfor(i=0;i<n;i++)\n\n\t\tscanf(\"%d %d\",&l,&r),ans+=r-l+1;\n\n\tprintf(\"%d\",ans);\n\n}"
    },
    {
        "id": "466",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint n,maxn=-99998989;\n\nint f[100010],cnt,x,y;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>x>>y;\n\n\t\tmaxn=maxn<y?y:maxn;\n\n\t\tfor(int i=x;i<=y;i++)\n\n\t\t  f[i]=1;\n\n\t}\n\n\tfor(int i=1;i<=maxn;i++)\n\n\t  if(f[i]==1)\n\n\t    cnt++;\n\n\tcout<<cnt;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,x,y,ans;\n\nbool s[100002];\n\ninline void in(int &s){\n\n\ts=0;\n\n\tint f=1;\n\n\tchar c=getchar();\n\n\twhile(c<'0' || c>'9'){\n\n\t\tif(c=='-') f=-1;\n\n\t\tc=getchar();\n\n\t}\n\n\twhile(c>='0' && c<='9'){\n\n\t\ts=(s<<1)+(s<<3)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\ts*=f;\n\n}\n\nint main(){\n\n\tin(n);\n\n\twhile(n--){\n\n\t\tin(x);in(y);\n\n\t\tfor(int i=x;i<=y;++i) s[i]=1;\n\n\t}\n\n\tfor(int i=1;i<=100000;++i) if(s[i]) ++ans;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "467",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <iomanip>\n\n#include <cmath>\n\n#include <string>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <sstream>\n\n#include <set>\n\n#include <queue>\n\n#include <stack>\n\n#include <cctype>\n\n#include <map>\n\n#include <climits>\n\n#include <bitset>\n\nusing namespace std;\n\n#define MATH_PI 3.14159265358979323846\n\nint main(){\n\n\tios::sync_with_stdio(false);\n\n\tint nCount,iStart,iEnd;\n\n\tregister int i,nTotal=0;\n\n\tcin >> nCount;\n\n\tfor (i = 1; i <= nCount; ++i){\n\n\t\tcin >> iStart >> iEnd;\n\n\t\tnTotal += iEnd - iStart + 1;\n\n\t}\n\n\tcout << nTotal << endl;\n\nendapp:\n\n\t//system(\"pause > nul\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,x,y,ans;\n\nbool s[100002];\n\ninline void in(int &s){\n\n\ts=0;\n\n\tint f=1;\n\n\tchar c=getchar();\n\n\twhile(c<'0' || c>'9'){\n\n\t\tif(c=='-') f=-1;\n\n\t\tc=getchar();\n\n\t}\n\n\twhile(c>='0' && c<='9'){\n\n\t\ts=(s<<1)+(s<<3)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\ts*=f;\n\n}\n\nint main(){\n\n\tin(n);\n\n\twhile(n--){\n\n\t\tin(x);in(y);\n\n\t\tfor(int i=x;i<=y;++i) s[i]=1;\n\n\t}\n\n\tfor(int i=1;i<=100000;++i) if(s[i]) ++ans;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "468",
        "source_code": "#include<iostream>\n\n#include<iomanip>\n\n#include<cstdio>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<algorithm>\n\nusing namespace std;\n\nint main(){\n\n\tlong long n,a,b,ans=0;\n\n\tcin>>n;\n\n\twhile(n--){\n\n\t\tcin>>a>>b;\n\n\t\tans+=b-a+1;\n\n\t}\n\n\tcout<<ans;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,x,y,ans;\n\nbool s[100002];\n\ninline void in(int &s){\n\n\ts=0;\n\n\tint f=1;\n\n\tchar c=getchar();\n\n\twhile(c<'0' || c>'9'){\n\n\t\tif(c=='-') f=-1;\n\n\t\tc=getchar();\n\n\t}\n\n\twhile(c>='0' && c<='9'){\n\n\t\ts=(s<<1)+(s<<3)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\ts*=f;\n\n}\n\nint main(){\n\n\tin(n);\n\n\twhile(n--){\n\n\t\tin(x);in(y);\n\n\t\tfor(int i=x;i<=y;++i) s[i]=1;\n\n\t}\n\n\tfor(int i=1;i<=100000;++i) if(s[i]) ++ans;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "469",
        "source_code": "#include <iostream>\n\nusing namespace std; //\u5934\u6587\u4ef6\u548c\u547d\u540d\u7a7a\u95f4\n\nint main(){\n\n    ios::sync_with_stdio(false); //\u8f93\u5165\u8f93\u51fa\u52a0\u901f\n\n    int nCount,iStart,iEnd; //nCount-\u56e2\u4f53\u4e2a\u6570\uff1biStart-\u5ea7\u4f4d\u53f7\u8d77\u59cb\uff1biEnd-\u5ea7\u4f4d\u53f7\u7ed3\u675f\n\n    register int i,nTotal=0; //\u5faa\u73af\u8ba1\u6570\u5668\u548c\u603b\u548c\n\n    cin >> nCount; //\u8bfb\u5165\u56e2\u4f53\u6570\n\n    for (i = 1; i <= nCount; ++i){ //\u8bfb\u5165\u6bcf\u4e2a\u56e2\u4f53\u5360\u7528\u7684\u5ea7\u4f4d\n\n        cin >> iStart >> iEnd; //\u8bfb\u5165\u8d77\u59cb\u548c\u7ed3\u675f\n\n        nTotal += iEnd - iStart + 1; //\u8ba1\u7b97\u5360\u7528\u4e86\u591a\u5c11\u4e2a\u5ea7\u4f4d\uff0c\u52a0\u603b\n\n    }\n\n    cout << nTotal << endl; //\u8f93\u51fa\uff0c\u52ff\u5fd8\u6362\u884c\n\n    return 0; //\u7ed3\u675f\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,x,y,ans;\n\nbool s[100002];\n\ninline void in(int &s){\n\n\ts=0;\n\n\tint f=1;\n\n\tchar c=getchar();\n\n\twhile(c<'0' || c>'9'){\n\n\t\tif(c=='-') f=-1;\n\n\t\tc=getchar();\n\n\t}\n\n\twhile(c>='0' && c<='9'){\n\n\t\ts=(s<<1)+(s<<3)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\ts*=f;\n\n}\n\nint main(){\n\n\tin(n);\n\n\twhile(n--){\n\n\t\tin(x);in(y);\n\n\t\tfor(int i=x;i<=y;++i) s[i]=1;\n\n\t}\n\n\tfor(int i=1;i<=100000;++i) if(s[i]) ++ans;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "470",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nlong long z,a,b,n;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tz+=b-a+1;\n\n\t}\n\n\tcout<<z<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,x,y,ans;\n\nbool s[100002];\n\ninline void in(int &s){\n\n\ts=0;\n\n\tint f=1;\n\n\tchar c=getchar();\n\n\twhile(c<'0' || c>'9'){\n\n\t\tif(c=='-') f=-1;\n\n\t\tc=getchar();\n\n\t}\n\n\twhile(c>='0' && c<='9'){\n\n\t\ts=(s<<1)+(s<<3)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\ts*=f;\n\n}\n\nint main(){\n\n\tin(n);\n\n\twhile(n--){\n\n\t\tin(x);in(y);\n\n\t\tfor(int i=x;i<=y;++i) s[i]=1;\n\n\t}\n\n\tfor(int i=1;i<=100000;++i) if(s[i]) ++ans;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "471",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n,ans=0;\n\n\tcin>>n;\n\n\twhile(n--)\n\n\t{\n\n\t\tint l,r;\n\n\t\tcin>>l>>r;\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,x,y,ans;\n\nbool s[100002];\n\ninline void in(int &s){\n\n\ts=0;\n\n\tint f=1;\n\n\tchar c=getchar();\n\n\twhile(c<'0' || c>'9'){\n\n\t\tif(c=='-') f=-1;\n\n\t\tc=getchar();\n\n\t}\n\n\twhile(c>='0' && c<='9'){\n\n\t\ts=(s<<1)+(s<<3)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\ts*=f;\n\n}\n\nint main(){\n\n\tin(n);\n\n\twhile(n--){\n\n\t\tin(x);in(y);\n\n\t\tfor(int i=x;i<=y;++i) s[i]=1;\n\n\t}\n\n\tfor(int i=1;i<=100000;++i) if(s[i]) ++ans;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "472",
        "source_code": "#include<bits/stdc++.h>\n\n#include<cmath>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n,l,r,ans;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>l>>r;\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,x,y,ans;\n\nbool s[100002];\n\ninline void in(int &s){\n\n\ts=0;\n\n\tint f=1;\n\n\tchar c=getchar();\n\n\twhile(c<'0' || c>'9'){\n\n\t\tif(c=='-') f=-1;\n\n\t\tc=getchar();\n\n\t}\n\n\twhile(c>='0' && c<='9'){\n\n\t\ts=(s<<1)+(s<<3)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\ts*=f;\n\n}\n\nint main(){\n\n\tin(n);\n\n\twhile(n--){\n\n\t\tin(x);in(y);\n\n\t\tfor(int i=x;i<=y;++i) s[i]=1;\n\n\t}\n\n\tfor(int i=1;i<=100000;++i) if(s[i]) ++ans;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "473",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\nusing namespace std;\n\nint n;\n\nlong long ans,a,b;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n        scanf(\"%lld%lld\",&a,&b);\n\n        ans+=b-a;\n\n    }\n\n    printf(\"%lld\\n\",ans+n);\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,x,y,ans;\n\nbool s[100002];\n\ninline void in(int &s){\n\n\ts=0;\n\n\tint f=1;\n\n\tchar c=getchar();\n\n\twhile(c<'0' || c>'9'){\n\n\t\tif(c=='-') f=-1;\n\n\t\tc=getchar();\n\n\t}\n\n\twhile(c>='0' && c<='9'){\n\n\t\ts=(s<<1)+(s<<3)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\ts*=f;\n\n}\n\nint main(){\n\n\tin(n);\n\n\twhile(n--){\n\n\t\tin(x);in(y);\n\n\t\tfor(int i=x;i<=y;++i) s[i]=1;\n\n\t}\n\n\tfor(int i=1;i<=100000;++i) if(s[i]) ++ans;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "474",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    int n,a,b,ans=0;\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++){\n\n        cin>>a>>b;\n\n        ans+=b-a+1;\n\n    }\n\n    cout<<ans<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,x,y,ans;\n\nbool s[100002];\n\ninline void in(int &s){\n\n\ts=0;\n\n\tint f=1;\n\n\tchar c=getchar();\n\n\twhile(c<'0' || c>'9'){\n\n\t\tif(c=='-') f=-1;\n\n\t\tc=getchar();\n\n\t}\n\n\twhile(c>='0' && c<='9'){\n\n\t\ts=(s<<1)+(s<<3)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\ts*=f;\n\n}\n\nint main(){\n\n\tin(n);\n\n\twhile(n--){\n\n\t\tin(x);in(y);\n\n\t\tfor(int i=x;i<=y;++i) s[i]=1;\n\n\t}\n\n\tfor(int i=1;i<=100000;++i) if(s[i]) ++ans;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "475",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint n,maxn=-99998989;\n\nint f[100010],cnt,x,y;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>x>>y;\n\n\t\tmaxn=maxn<y?y:maxn;\n\n\t\tfor(int i=x;i<=y;i++)\n\n\t\t  f[i]=1;\n\n\t}\n\n\tfor(int i=1;i<=maxn;i++)\n\n\t  if(f[i]==1)\n\n\t    cnt++;\n\n\tcout<<cnt;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n  scanf(\"%d\",&n);\n\n  for(int i=1;i<=n;i++)\n\n    scanf(\"%d%d\",&a,&b),ans=ans+b-a+1;\n\n  printf(\"%d\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "476",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <iomanip>\n\n#include <cmath>\n\n#include <string>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <sstream>\n\n#include <set>\n\n#include <queue>\n\n#include <stack>\n\n#include <cctype>\n\n#include <map>\n\n#include <climits>\n\n#include <bitset>\n\nusing namespace std;\n\n#define MATH_PI 3.14159265358979323846\n\nint main(){\n\n\tios::sync_with_stdio(false);\n\n\tint nCount,iStart,iEnd;\n\n\tregister int i,nTotal=0;\n\n\tcin >> nCount;\n\n\tfor (i = 1; i <= nCount; ++i){\n\n\t\tcin >> iStart >> iEnd;\n\n\t\tnTotal += iEnd - iStart + 1;\n\n\t}\n\n\tcout << nTotal << endl;\n\nendapp:\n\n\t//system(\"pause > nul\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n  scanf(\"%d\",&n);\n\n  for(int i=1;i<=n;i++)\n\n    scanf(\"%d%d\",&a,&b),ans=ans+b-a+1;\n\n  printf(\"%d\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "477",
        "source_code": "#include<iostream>\n\n#include<iomanip>\n\n#include<cstdio>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<algorithm>\n\nusing namespace std;\n\nint main(){\n\n\tlong long n,a,b,ans=0;\n\n\tcin>>n;\n\n\twhile(n--){\n\n\t\tcin>>a>>b;\n\n\t\tans+=b-a+1;\n\n\t}\n\n\tcout<<ans;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n  scanf(\"%d\",&n);\n\n  for(int i=1;i<=n;i++)\n\n    scanf(\"%d%d\",&a,&b),ans=ans+b-a+1;\n\n  printf(\"%d\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "478",
        "source_code": "#include <iostream>\n\nusing namespace std; //\u5934\u6587\u4ef6\u548c\u547d\u540d\u7a7a\u95f4\n\nint main(){\n\n    ios::sync_with_stdio(false); //\u8f93\u5165\u8f93\u51fa\u52a0\u901f\n\n    int nCount,iStart,iEnd; //nCount-\u56e2\u4f53\u4e2a\u6570\uff1biStart-\u5ea7\u4f4d\u53f7\u8d77\u59cb\uff1biEnd-\u5ea7\u4f4d\u53f7\u7ed3\u675f\n\n    register int i,nTotal=0; //\u5faa\u73af\u8ba1\u6570\u5668\u548c\u603b\u548c\n\n    cin >> nCount; //\u8bfb\u5165\u56e2\u4f53\u6570\n\n    for (i = 1; i <= nCount; ++i){ //\u8bfb\u5165\u6bcf\u4e2a\u56e2\u4f53\u5360\u7528\u7684\u5ea7\u4f4d\n\n        cin >> iStart >> iEnd; //\u8bfb\u5165\u8d77\u59cb\u548c\u7ed3\u675f\n\n        nTotal += iEnd - iStart + 1; //\u8ba1\u7b97\u5360\u7528\u4e86\u591a\u5c11\u4e2a\u5ea7\u4f4d\uff0c\u52a0\u603b\n\n    }\n\n    cout << nTotal << endl; //\u8f93\u51fa\uff0c\u52ff\u5fd8\u6362\u884c\n\n    return 0; //\u7ed3\u675f\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n  scanf(\"%d\",&n);\n\n  for(int i=1;i<=n;i++)\n\n    scanf(\"%d%d\",&a,&b),ans=ans+b-a+1;\n\n  printf(\"%d\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "479",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nlong long z,a,b,n;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tz+=b-a+1;\n\n\t}\n\n\tcout<<z<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n  scanf(\"%d\",&n);\n\n  for(int i=1;i<=n;i++)\n\n    scanf(\"%d%d\",&a,&b),ans=ans+b-a+1;\n\n  printf(\"%d\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "480",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n,ans=0;\n\n\tcin>>n;\n\n\twhile(n--)\n\n\t{\n\n\t\tint l,r;\n\n\t\tcin>>l>>r;\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n  scanf(\"%d\",&n);\n\n  for(int i=1;i<=n;i++)\n\n    scanf(\"%d%d\",&a,&b),ans=ans+b-a+1;\n\n  printf(\"%d\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "481",
        "source_code": "#include<bits/stdc++.h>\n\n#include<cmath>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n,l,r,ans;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>l>>r;\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n  scanf(\"%d\",&n);\n\n  for(int i=1;i<=n;i++)\n\n    scanf(\"%d%d\",&a,&b),ans=ans+b-a+1;\n\n  printf(\"%d\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "482",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\nusing namespace std;\n\nint n;\n\nlong long ans,a,b;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n        scanf(\"%lld%lld\",&a,&b);\n\n        ans+=b-a;\n\n    }\n\n    printf(\"%lld\\n\",ans+n);\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n  scanf(\"%d\",&n);\n\n  for(int i=1;i<=n;i++)\n\n    scanf(\"%d%d\",&a,&b),ans=ans+b-a+1;\n\n  printf(\"%d\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "483",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    int n,a,b,ans=0;\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++){\n\n        cin>>a>>b;\n\n        ans+=b-a+1;\n\n    }\n\n    cout<<ans<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n  scanf(\"%d\",&n);\n\n  for(int i=1;i<=n;i++)\n\n    scanf(\"%d%d\",&a,&b),ans=ans+b-a+1;\n\n  printf(\"%d\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "484",
        "source_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,x,y,ans;\n\nbool s[100002];\n\ninline void in(int &s){\n\n\ts=0;\n\n\tint f=1;\n\n\tchar c=getchar();\n\n\twhile(c<'0' || c>'9'){\n\n\t\tif(c=='-') f=-1;\n\n\t\tc=getchar();\n\n\t}\n\n\twhile(c>='0' && c<='9'){\n\n\t\ts=(s<<1)+(s<<3)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\ts*=f;\n\n}\n\nint main(){\n\n\tin(n);\n\n\twhile(n--){\n\n\t\tin(x);in(y);\n\n\t\tfor(int i=x;i<=y;++i) s[i]=1;\n\n\t}\n\n\tfor(int i=1;i<=100000;++i) if(s[i]) ++ans;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n  scanf(\"%d\",&n);\n\n  for(int i=1;i<=n;i++)\n\n    scanf(\"%d%d\",&a,&b),ans=ans+b-a+1;\n\n  printf(\"%d\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "485",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\n#include<cstdio>\n\nusing namespace std;\n\nint n,a,b;\n\nint ans;\n\nint main()\n\n{\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n        cin>>a>>b;\n\n        ans+=b-a+1;\n\n    }\n\n    cout<<ans<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n  scanf(\"%d\",&n);\n\n  for(int i=1;i<=n;i++)\n\n    scanf(\"%d%d\",&a,&b),ans=ans+b-a+1;\n\n  printf(\"%d\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "486",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n,i,l,r,ans=0;\n\n\tscanf(\"%d\",&n);\n\n\tfor(i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d %d\",&l,&r);\n\n\t\tans+=r-l+1;\n\n    }\n\n    printf(\"%d\",ans);\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n  scanf(\"%d\",&n);\n\n  for(int i=1;i<=n;i++)\n\n    scanf(\"%d%d\",&a,&b),ans=ans+b-a+1;\n\n  printf(\"%d\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "487",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tans+=b-a+1;\n\n\t}\n\n\tcout<<ans;\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n  scanf(\"%d\",&n);\n\n  for(int i=1;i<=n;i++)\n\n    scanf(\"%d%d\",&a,&b),ans=ans+b-a+1;\n\n  printf(\"%d\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "488",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\nint n,a,b,ok[100010],ans,sum;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t\tcin>>a>>b; sum=max(sum,max(a,b));\n\n\t\tfor(int j=a;j<=b;j++) ok[j]=1;\n\n\t}\n\n\tfor(int i=1;i<=sum;i++) if(ok[i]) ans++;\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint main(){\n\n\tint n,x,y,ans=0;\n\n\tscanf(\"%d\",&n);\n\n\tfor(int i=1;i<=n;i++) scanf(\"%d%d\",&x,&y),ans+=y-x+1;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "489",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\nint n,a,b,ok[100010],ans,sum;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t\tcin>>a>>b; sum=max(sum,max(a,b));\n\n\t\tfor(int j=a;j<=b;j++) ok[j]=1;\n\n\t}\n\n\tfor(int i=1;i<=sum;i++) if(ok[i]) ans++;\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\tint i; \n\n\tint a,b; \n\n\tfor(i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t\t \n\n\t}\n\n\tprintf(\"%d\",ans); \n\n}"
    },
    {
        "id": "490",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint a,i,j,s=0,b;\n\n\tcin>>a;\n\n\tfor(b=1;b<=a;b++){\n\n\t\tcin>>i>>j;\n\n\t\ts=s+(j-i)+1;\n\n\t}\n\n\tcout<<s;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\tint i; \n\n\tint a,b; \n\n\tfor(i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t\t \n\n\t}\n\n\tprintf(\"%d\",ans); \n\n}"
    },
    {
        "id": "491",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\nusing namespace std;\n\n\n\nint N,L,R,ans;\n\n\n\nint main()\n\n{\n\n\tscanf(\"%d\",&N);\n\n\tfor (int i=1; i<=N; i++)\n\n\t{\n\n\t\tscanf(\"%d %d\",&L,&R);\n\n\t\tans+=R-L+1;\n\n\t}\n\n\tprintf(\"%d\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\tint i; \n\n\tint a,b; \n\n\tfor(i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t\t \n\n\t}\n\n\tprintf(\"%d\",ans); \n\n}"
    },
    {
        "id": "492",
        "source_code": "#include <cstdio>\n\n#include <iostream>\n\n#include <cstdlib>\n\nusing namespace std;\n\nint main()\n\n{\n\nint n,k,i,j,t;\n\nint a,b;\n\ncin>>n;\n\nt=0;\n\nfor (i=1; i<=n; i++)\n\n  {\n\n  cin>>a>>b;\n\n  t=t+b-a+1;\n\n  }\n\ncout<<t<<endl;\n\nreturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\tint i; \n\n\tint a,b; \n\n\tfor(i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t\t \n\n\t}\n\n\tprintf(\"%d\",ans); \n\n}"
    },
    {
        "id": "493",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\nint n,a,b,ok[100010],ans,sum;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t\tcin>>a>>b; sum=max(sum,max(a,b));\n\n\t\tfor(int j=a;j<=b;j++) ok[j]=1;\n\n\t}\n\n\tfor(int i=1;i<=sum;i++) if(ok[i]) ans++;\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nint main()\n\n{\n\n    int a,b,ans,ci;\n\n    scanf(\"%d\",&ci);\n\n    for(int i=0;i<ci;i++)\n\n    {\n\n        scanf(\"%d%d\",&a,&b);\n\n        ans+=b-a+1;\n\n    }\n\n    printf(\"%d\",ans);\n\n    return 0;\n\n}"
    },
    {
        "id": "494",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint a,i,j,s=0,b;\n\n\tcin>>a;\n\n\tfor(b=1;b<=a;b++){\n\n\t\tcin>>i>>j;\n\n\t\ts=s+(j-i)+1;\n\n\t}\n\n\tcout<<s;\n\n}",
        "optimized_code": "#include<cstdio>\n\nint main()\n\n{\n\n    int a,b,ans,ci;\n\n    scanf(\"%d\",&ci);\n\n    for(int i=0;i<ci;i++)\n\n    {\n\n        scanf(\"%d%d\",&a,&b);\n\n        ans+=b-a+1;\n\n    }\n\n    printf(\"%d\",ans);\n\n    return 0;\n\n}"
    },
    {
        "id": "495",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\nusing namespace std;\n\n\n\nint N,L,R,ans;\n\n\n\nint main()\n\n{\n\n\tscanf(\"%d\",&N);\n\n\tfor (int i=1; i<=N; i++)\n\n\t{\n\n\t\tscanf(\"%d %d\",&L,&R);\n\n\t\tans+=R-L+1;\n\n\t}\n\n\tprintf(\"%d\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nint main()\n\n{\n\n    int a,b,ans,ci;\n\n    scanf(\"%d\",&ci);\n\n    for(int i=0;i<ci;i++)\n\n    {\n\n        scanf(\"%d%d\",&a,&b);\n\n        ans+=b-a+1;\n\n    }\n\n    printf(\"%d\",ans);\n\n    return 0;\n\n}"
    },
    {
        "id": "496",
        "source_code": "#include <cstdio>\n\n#include <iostream>\n\n#include <cstdlib>\n\nusing namespace std;\n\nint main()\n\n{\n\nint n,k,i,j,t;\n\nint a,b;\n\ncin>>n;\n\nt=0;\n\nfor (i=1; i<=n; i++)\n\n  {\n\n  cin>>a>>b;\n\n  t=t+b-a+1;\n\n  }\n\ncout<<t<<endl;\n\nreturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nint main()\n\n{\n\n    int a,b,ans,ci;\n\n    scanf(\"%d\",&ci);\n\n    for(int i=0;i<ci;i++)\n\n    {\n\n        scanf(\"%d%d\",&a,&b);\n\n        ans+=b-a+1;\n\n    }\n\n    printf(\"%d\",ans);\n\n    return 0;\n\n}"
    },
    {
        "id": "497",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n,a[1005],b[1005],ans=0;\n\nint main()\n\n{\n\n    cin>>n;\n\n    for(int i=0; i<n; i++)\n\n    {    \n\n        cin>>a[i]>>b[i];\n\n        ans+=b[i]-a[i]+1;\n\n    }\n\n    cout<<ans<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nint main()\n\n{\n\n    int a,b,ans,ci;\n\n    scanf(\"%d\",&ci);\n\n    for(int i=0;i<ci;i++)\n\n    {\n\n        scanf(\"%d%d\",&a,&b);\n\n        ans+=b-a+1;\n\n    }\n\n    printf(\"%d\",ans);\n\n    return 0;\n\n}"
    },
    {
        "id": "498",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\nint n,a,b,ok[100010],ans,sum;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t\tcin>>a>>b; sum=max(sum,max(a,b));\n\n\t\tfor(int j=a;j<=b;j++) ok[j]=1;\n\n\t}\n\n\tfor(int i=1;i<=sum;i++) if(ok[i]) ans++;\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,a;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n\tscanf(\"%d%d\",&l,&r);\n\n    a+=r-l+1;\n\n\t}\n\n    printf(\"%d\\n\",a);\n\n    return 0;\n\n}"
    },
    {
        "id": "499",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint a,i,j,s=0,b;\n\n\tcin>>a;\n\n\tfor(b=1;b<=a;b++){\n\n\t\tcin>>i>>j;\n\n\t\ts=s+(j-i)+1;\n\n\t}\n\n\tcout<<s;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,a;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n\tscanf(\"%d%d\",&l,&r);\n\n    a+=r-l+1;\n\n\t}\n\n    printf(\"%d\\n\",a);\n\n    return 0;\n\n}"
    },
    {
        "id": "500",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\nusing namespace std;\n\n\n\nint N,L,R,ans;\n\n\n\nint main()\n\n{\n\n\tscanf(\"%d\",&N);\n\n\tfor (int i=1; i<=N; i++)\n\n\t{\n\n\t\tscanf(\"%d %d\",&L,&R);\n\n\t\tans+=R-L+1;\n\n\t}\n\n\tprintf(\"%d\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,a;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n\tscanf(\"%d%d\",&l,&r);\n\n    a+=r-l+1;\n\n\t}\n\n    printf(\"%d\\n\",a);\n\n    return 0;\n\n}"
    },
    {
        "id": "501",
        "source_code": "#include <cstdio>\n\n#include <iostream>\n\n#include <cstdlib>\n\nusing namespace std;\n\nint main()\n\n{\n\nint n,k,i,j,t;\n\nint a,b;\n\ncin>>n;\n\nt=0;\n\nfor (i=1; i<=n; i++)\n\n  {\n\n  cin>>a>>b;\n\n  t=t+b-a+1;\n\n  }\n\ncout<<t<<endl;\n\nreturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,a;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n\tscanf(\"%d%d\",&l,&r);\n\n    a+=r-l+1;\n\n\t}\n\n    printf(\"%d\\n\",a);\n\n    return 0;\n\n}"
    },
    {
        "id": "502",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n,a[1005],b[1005],ans=0;\n\nint main()\n\n{\n\n    cin>>n;\n\n    for(int i=0; i<n; i++)\n\n    {    \n\n        cin>>a[i]>>b[i];\n\n        ans+=b[i]-a[i]+1;\n\n    }\n\n    cout<<ans<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,a;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n\tscanf(\"%d%d\",&l,&r);\n\n    a+=r-l+1;\n\n\t}\n\n    printf(\"%d\\n\",a);\n\n    return 0;\n\n}"
    },
    {
        "id": "503",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint a,b;\n\nlong long ans;\n\nint n;\n\nint main(){\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++){\n\n        cin>>a>>b;\n\n        if(a>=b)\n\n        ans+=a-b+1;\n\n        else ans+=b-a+1;\n\n    }\n\n    cout<<ans<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,a;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n\tscanf(\"%d%d\",&l,&r);\n\n    a+=r-l+1;\n\n\t}\n\n    printf(\"%d\\n\",a);\n\n    return 0;\n\n}"
    },
    {
        "id": "504",
        "source_code": "#include<cmath>\n\n#include<iostream>\n\nusing namespace std;\n\nlong long ans=0,n,x,y;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>x>>y;\n\n\t\tans+=y-x+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,a;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n\tscanf(\"%d%d\",&l,&r);\n\n    a+=r-l+1;\n\n\t}\n\n    printf(\"%d\\n\",a);\n\n    return 0;\n\n}"
    },
    {
        "id": "505",
        "source_code": "#include<cstdio>\n\n#include<cmath>\n\n#include<algorithm>\n\n#include<cctype>\n\n#include<cstring>\n\n#include<queue>\n\n#include<iostream>\n\n#include<map>\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef double lf;\n\ntypedef unsigned un;\n\ntypedef int in;\n\n#define mian main\n\n#define maxn 10000+10\n\n#define maxm 10000+10\n\n#define _(a) read(a)\n\n#define non void\n\n#define inf 2147483647\n\n#define bre break\n\n#define con continue\n\n#define prq priority_queue\n\n#define re register\n\n#define bu bool\n\n#define cz char\n\n#define cst const\n\n#define ope operator\n\n#define inl inline\n\n#define upp upper_bound\n\n#define low lower_bound\n\n#define next_per next_permutation\n\ninl cz gc(){static cz buf[100000],*L=buf,*R=buf;return L==R&&(R=(L=buf)+fread(buf,1,100000,stdin),L==R)?EOF:*L++;}\n\ntemplate<typename T>inl T Max(T a,T b){return a>b?a:b;}\n\ntemplate<typename T>inl T Min(T a,T b){return a<b?a:b;}\n\ntemplate<typename T>inl T Abs(T a){return a<0?-a:a;}\n\ntemplate<typename T>inl non read(T &a){a=0;T k=1;char c=gc();while(c<'0'||c>'9')k=c=='-'?-1:k,c=gc();while(c>='0'&&c<='9')a=a*10+(c^48),c=gc();if(c!='.'){a*=k;return;}T t=0.1;while(c<'0'||c>'9')c=gc();while(c>='0'&&c<='9')a+=t*(c^48),c=gc(),t*=0.1;a*=k;}\n\ntemplate<typename T>non write(T a,cz t='\\n'){if(a==0){putc(48,stdout),putc(t,stdout);return;}if(a<0){a=-a;putc('-',stdout);}cz c[30];in le=0;while(a){c[++le]=a%10+48;a/=10;}for(re in i=le;i>=1;--i)putc(c[i],stdout);putc(t,stdout);}\n\nin n,l,r,sum;\n\nin main()\n\n{\n\n\tread(n);\n\n\tfor(re in i=1;i<=n;++i)read(l),read(r),sum+=r-l+1;\n\n\twrite(sum);\n\n\t//freopen(\".in\",\"r\",stdin);\n\n\t//freopen(\".out\",\"w\",stdout);\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,a;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n\tscanf(\"%d%d\",&l,&r);\n\n    a+=r-l+1;\n\n\t}\n\n    printf(\"%d\\n\",a);\n\n    return 0;\n\n}"
    },
    {
        "id": "506",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tint ans=0;\n\n\tint ai,bi;\n\n\tfor (int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>ai>>bi;\n\n\t\tans+=(bi-ai+1);\n\n\t}\n\n\tcout<<ans;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,a;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n\tscanf(\"%d%d\",&l,&r);\n\n    a+=r-l+1;\n\n\t}\n\n    printf(\"%d\\n\",a);\n\n    return 0;\n\n}"
    },
    {
        "id": "507",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint ans=0;\n\n\tint l,r;\n\n\tint n;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,a;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n\tscanf(\"%d%d\",&l,&r);\n\n    a+=r-l+1;\n\n\t}\n\n    printf(\"%d\\n\",a);\n\n    return 0;\n\n}"
    },
    {
        "id": "508",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n,x,y,ans=0,i;\n\n\tcin>>n;\n\n\tfor (i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>x>>y;\n\n\t\tans+=(y-x+1);\n\n\t}\n\n\tcout<<ans;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,a;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n\tscanf(\"%d%d\",&l,&r);\n\n    a+=r-l+1;\n\n\t}\n\n    printf(\"%d\\n\",a);\n\n    return 0;\n\n}"
    },
    {
        "id": "509",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n;\n\nint li,ri,ans;\n\nint main()\n\n{\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++)\n\n\t{\n\n        cin>>li>>ri;\n\n        ans+=ri-li+1;\n\n    }\n\n    cout<<ans<<endl;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,a;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n\tscanf(\"%d%d\",&l,&r);\n\n    a+=r-l+1;\n\n\t}\n\n    printf(\"%d\\n\",a);\n\n    return 0;\n\n}"
    },
    {
        "id": "510",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n,sum=0;\n\n\tscanf(\"%d\",&n);\n\n\tint l,r;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tsum+=r-l+1;\n\n\t}\n\n\tprintf(\"%d\",sum);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,a;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n\tscanf(\"%d%d\",&l,&r);\n\n    a+=r-l+1;\n\n\t}\n\n    printf(\"%d\\n\",a);\n\n    return 0;\n\n}"
    },
    {
        "id": "511",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint l[100000],r[100000];\n\nint main() {\n\n\tint n,i,sum=0;\n\n\tcin>>n;\n\n\tfor(i=0;i<n;i++){\n\n\t\tcin>>l[i]>>r[i];\n\n\t}\n\n\tfor(i=0;i<n;i++){\n\n\t\tsum+=r[i]-l[i]+1;\n\n\t}\n\n\tcout<<sum;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,a;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n\tscanf(\"%d%d\",&l,&r);\n\n    a+=r-l+1;\n\n\t}\n\n    printf(\"%d\\n\",a);\n\n    return 0;\n\n}"
    },
    {
        "id": "512",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\nint n,a,b,ok[100010],ans,sum;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=0;i<n;i++)\n\n\t{\n\n\t\tcin>>a>>b; sum=max(sum,max(a,b));\n\n\t\tfor(int j=a;j<=b;j++) ok[j]=1;\n\n\t}\n\n\tfor(int i=1;i<=sum;i++) if(ok[i]) ans++;\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "513",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint a,i,j,s=0,b;\n\n\tcin>>a;\n\n\tfor(b=1;b<=a;b++){\n\n\t\tcin>>i>>j;\n\n\t\ts=s+(j-i)+1;\n\n\t}\n\n\tcout<<s;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "514",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\nusing namespace std;\n\n\n\nint N,L,R,ans;\n\n\n\nint main()\n\n{\n\n\tscanf(\"%d\",&N);\n\n\tfor (int i=1; i<=N; i++)\n\n\t{\n\n\t\tscanf(\"%d %d\",&L,&R);\n\n\t\tans+=R-L+1;\n\n\t}\n\n\tprintf(\"%d\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "515",
        "source_code": "#include <cstdio>\n\n#include <iostream>\n\n#include <cstdlib>\n\nusing namespace std;\n\nint main()\n\n{\n\nint n,k,i,j,t;\n\nint a,b;\n\ncin>>n;\n\nt=0;\n\nfor (i=1; i<=n; i++)\n\n  {\n\n  cin>>a>>b;\n\n  t=t+b-a+1;\n\n  }\n\ncout<<t<<endl;\n\nreturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "516",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n,a[1005],b[1005],ans=0;\n\nint main()\n\n{\n\n    cin>>n;\n\n    for(int i=0; i<n; i++)\n\n    {    \n\n        cin>>a[i]>>b[i];\n\n        ans+=b[i]-a[i]+1;\n\n    }\n\n    cout<<ans<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "517",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint a,b;\n\nlong long ans;\n\nint n;\n\nint main(){\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++){\n\n        cin>>a>>b;\n\n        if(a>=b)\n\n        ans+=a-b+1;\n\n        else ans+=b-a+1;\n\n    }\n\n    cout<<ans<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "518",
        "source_code": "#include<cmath>\n\n#include<iostream>\n\nusing namespace std;\n\nlong long ans=0,n,x,y;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>x>>y;\n\n\t\tans+=y-x+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "519",
        "source_code": "#include<cstdio>\n\n#include<cmath>\n\n#include<algorithm>\n\n#include<cctype>\n\n#include<cstring>\n\n#include<queue>\n\n#include<iostream>\n\n#include<map>\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef double lf;\n\ntypedef unsigned un;\n\ntypedef int in;\n\n#define mian main\n\n#define maxn 10000+10\n\n#define maxm 10000+10\n\n#define _(a) read(a)\n\n#define non void\n\n#define inf 2147483647\n\n#define bre break\n\n#define con continue\n\n#define prq priority_queue\n\n#define re register\n\n#define bu bool\n\n#define cz char\n\n#define cst const\n\n#define ope operator\n\n#define inl inline\n\n#define upp upper_bound\n\n#define low lower_bound\n\n#define next_per next_permutation\n\ninl cz gc(){static cz buf[100000],*L=buf,*R=buf;return L==R&&(R=(L=buf)+fread(buf,1,100000,stdin),L==R)?EOF:*L++;}\n\ntemplate<typename T>inl T Max(T a,T b){return a>b?a:b;}\n\ntemplate<typename T>inl T Min(T a,T b){return a<b?a:b;}\n\ntemplate<typename T>inl T Abs(T a){return a<0?-a:a;}\n\ntemplate<typename T>inl non read(T &a){a=0;T k=1;char c=gc();while(c<'0'||c>'9')k=c=='-'?-1:k,c=gc();while(c>='0'&&c<='9')a=a*10+(c^48),c=gc();if(c!='.'){a*=k;return;}T t=0.1;while(c<'0'||c>'9')c=gc();while(c>='0'&&c<='9')a+=t*(c^48),c=gc(),t*=0.1;a*=k;}\n\ntemplate<typename T>non write(T a,cz t='\\n'){if(a==0){putc(48,stdout),putc(t,stdout);return;}if(a<0){a=-a;putc('-',stdout);}cz c[30];in le=0;while(a){c[++le]=a%10+48;a/=10;}for(re in i=le;i>=1;--i)putc(c[i],stdout);putc(t,stdout);}\n\nin n,l,r,sum;\n\nin main()\n\n{\n\n\tread(n);\n\n\tfor(re in i=1;i<=n;++i)read(l),read(r),sum+=r-l+1;\n\n\twrite(sum);\n\n\t//freopen(\".in\",\"r\",stdin);\n\n\t//freopen(\".out\",\"w\",stdout);\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "520",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n;\n\n\tcin>>n;\n\n\tint ans=0;\n\n\tint ai,bi;\n\n\tfor (int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>ai>>bi;\n\n\t\tans+=(bi-ai+1);\n\n\t}\n\n\tcout<<ans;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "521",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint ans=0;\n\n\tint l,r;\n\n\tint n;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "522",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n,x,y,ans=0,i;\n\n\tcin>>n;\n\n\tfor (i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>x>>y;\n\n\t\tans+=(y-x+1);\n\n\t}\n\n\tcout<<ans;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "523",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n;\n\nint li,ri,ans;\n\nint main()\n\n{\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++)\n\n\t{\n\n        cin>>li>>ri;\n\n        ans+=ri-li+1;\n\n    }\n\n    cout<<ans<<endl;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "524",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n,sum=0;\n\n\tscanf(\"%d\",&n);\n\n\tint l,r;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tsum+=r-l+1;\n\n\t}\n\n\tprintf(\"%d\",sum);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "525",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint l[100000],r[100000];\n\nint main() {\n\n\tint n,i,sum=0;\n\n\tcin>>n;\n\n\tfor(i=0;i<n;i++){\n\n\t\tcin>>l[i]>>r[i];\n\n\t}\n\n\tfor(i=0;i<n;i++){\n\n\t\tsum+=r[i]-l[i]+1;\n\n\t}\n\n\tcout<<sum;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "526",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nlong long n,l,r,s;   \n\nint main()\n\n{\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n        cin>>l>>r;\n\n        s+=r-l+1;    \n\n    }\n\n    cout<<s<<endl;\n\n    return 0;\n\n}\n\n ",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "527",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cmath>\n\n#include<algorithm>\n\n#include<string>\n\n#include<cstring>\n\n#include<cstdlib>\n\nusing namespace std;\n\nlong long a,b,n,ans;\n\nint main()\n\n{\n\n  scanf(\"%lld\",&n);\n\n  for(int i=0;i<n;i++)\n\n  {\n\n    scanf(\"%lld%lld\",&a,&b);\n\n    ans+=b-a+1;\n\n  }\n\n  printf(\"%lld\\n\",ans);\n\n  return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "528",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    int n;\n\n    int l,r,ans;\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++){\n\n        cin>>l>>r;\n\n        ans+=r-l+1;\n\n    }\n\n    cout<<ans<<endl;\n\n}",
        "optimized_code": "#include<cstdio>\n\nusing namespace std; \n\nint main(){\n\n\tint n;\n\n\tscanf(\"%d\",&n);\n\n\tint ans=0;\n\n\twhile(n--){\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tans=ans+b-a+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n}"
    },
    {
        "id": "529",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint n, i, sum = 0, a, b;\n\n\tcin >> n;\n\n\tfor(i = 0; i < n; i++){\n\n\t\tcin >> a >> b;\n\n\t\tsum += (b-a+1);\n\n\t}\n\n\tcout << sum << endl;\n\n\treturn 0;\n\n} ",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\n#define N 1100\n\n\n\nstruct Node {\n\n    int l, r;\n\n    bool operator < (const Node &u) const {\n\n        return l < u.l;\n\n    }\n\n};\n\n\n\nNode a[N];\n\n\n\nint main() {\n\n    int n;\n\n    while (scanf(\"%d\", &n) != EOF) {\n\n        for (int i = 0; i < n; ++i) {\n\n            scanf(\"%d%d\", &a[i].l, &a[i].r);\n\n        }\n\n        sort(a, a + n);\n\n        int res = 0;\n\n        int e = 0;\n\n        for (int i = 0; i < n; ++i) {\n\n            if (e >= a[i].l) {\n\n                res += a[i].r - e;\n\n            } else {\n\n                res += a[i].r - a[i].l + 1;\n\n            }\n\n            e = a[i].r;\n\n        }\n\n        printf(\"%d\\n\", res);\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "530",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main(){\n\n\tint n, i, sum = 0, a, b;\n\n\tcin >> n;\n\n\tfor(i = 0; i < n; i++){\n\n\t\tcin >> a >> b;\n\n\t\tsum += (b-a+1);\n\n\t}\n\n\tcout << sum << endl;\n\n\treturn 0;\n\n} ",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    long long int a,b;\n\n    long long int sum=0;\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n        scanf(\"%lld %lld\",&a,&b);\n\n        sum+=(b-a+1);\n\n    }\n\n    printf(\"%lld\\n\",sum);\n\n}\n"
    },
    {
        "id": "531",
        "source_code": "#include<cstdio>\n\n#include<iostream>\n\nusing namespace std;\n\nint a[100000],b[100000];\n\nint main()\n\n{\n\n\tint n,x=0;\n\n\tcin>>n;\n\n\tfor(int i=0;i<n;i++)\n\n\t   cin>>a[i]>>b[i];\n\n\tfor(int j=0;j<n;j++)\n\n\t{\n\n\t\tx+=b[j]-a[j];\n\n\t}\n\n\tcout<<x+n<<endl;\n\n\treturn 0;\n\n} ",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    long long int a,b;\n\n    long long int sum=0;\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n        scanf(\"%lld %lld\",&a,&b);\n\n        sum+=(b-a+1);\n\n    }\n\n    printf(\"%lld\\n\",sum);\n\n}\n"
    },
    {
        "id": "532",
        "source_code": "#include <iostream>\n\n\n\nusing namespace std;\n\n\n\nint main(){\n\n\n\n    int n;\n\n    int l,r;\n\n    int sum = 0;\n\n    cin >> n;\n\n    for(int i=0;i<n;i++){\n\n        cin >> l >> r;\n\n        sum += (r-l+1);\n\n    }\n\n    cout << sum << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    long long int a,b;\n\n    long long int sum=0;\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n        scanf(\"%lld %lld\",&a,&b);\n\n        sum+=(b-a+1);\n\n    }\n\n    printf(\"%lld\\n\",sum);\n\n}\n"
    },
    {
        "id": "533",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint a[100001];\n\nint main()\n\n{\n\n\tint n,l,r,i,j,cnt=0;\n\n\tcin>>n;\n\n\tfor(i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>l>>r;\n\n\t\tfor(j=l;j<=r;j++)\n\n\t\t{\n\n\t\t\ta[j]=1;\n\n\t\t}\n\n\t}\n\n\tfor(i=1;i<=100000;i++)\n\n\t{\n\n\t\tif(a[i]==1) cnt++;\n\n\t}\n\n\tcout<<cnt<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n,l,r,ans=0;\n\n\tscanf(\"%d\",&n);\n\n\twhile(n--){\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "534",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint a[100001];\n\nint main()\n\n{\n\n\tint n,l,r,i,j,cnt=0;\n\n\tcin>>n;\n\n\tfor(i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>l>>r;\n\n\t\tfor(j=l;j<=r;j++)\n\n\t\t{\n\n\t\t\ta[j]=1;\n\n\t\t}\n\n\t}\n\n\tfor(i=1;i<=100000;i++)\n\n\t{\n\n\t\tif(a[i]==1) cnt++;\n\n\t}\n\n\tcout<<cnt<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,l,r,ans;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{ \n\n\tcin>>l>>r;\n\n\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0; \n\n } "
    },
    {
        "id": "535",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint a[100001];\n\nint main()\n\n{\n\n\tint n,l,r,i,j,cnt=0;\n\n\tcin>>n;\n\n\tfor(i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>l>>r;\n\n\t\tfor(j=l;j<=r;j++)\n\n\t\t{\n\n\t\t\ta[j]=1;\n\n\t\t}\n\n\t}\n\n\tfor(i=1;i<=100000;i++)\n\n\t{\n\n\t\tif(a[i]==1) cnt++;\n\n\t}\n\n\tcout<<cnt<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<iostream>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<cmath>\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n\tint n;\n\n    scanf(\"%d\",&n);\n\n\tint sum=0,a,b;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t    sum+=b-a+1;\n\n\t}\n\n\tprintf(\"%d\",sum);\n\n    return 0;\n\n} "
    },
    {
        "id": "536",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint a[100001];\n\nint main()\n\n{\n\n\tint n,l,r,i,j,cnt=0;\n\n\tcin>>n;\n\n\tfor(i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>l>>r;\n\n\t\tfor(j=l;j<=r;j++)\n\n\t\t{\n\n\t\t\ta[j]=1;\n\n\t\t}\n\n\t}\n\n\tfor(i=1;i<=100000;i++)\n\n\t{\n\n\t\tif(a[i]==1) cnt++;\n\n\t}\n\n\tcout<<cnt<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    int l,r,ans;\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n        cin>>l>>r;\n\n        ans+=r-l+1;\n\n    }\n\n    cout<<ans<<endl;\n\n}"
    },
    {
        "id": "537",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint a,b,c;\n\nint z;\n\nint main()\n\n{\n\n\tcin>>a;\n\n\tfor (int i=1;i<=a;i++)\n\n\t{\n\n\t\tcin>>b>>c;\n\n\t\tz=z+(c-b+1);\n\n\t}\n\n\tcout<<z<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nint n,l,r,ans;\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\twhile(n--)\n\n\t\tscanf(\"%d%d\",&l,&r),ans+=r-l+1;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "538",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ninline int read()\n\n{\n\n    int num = 0;\n\n    char c;\n\n    bool flag = false;\n\n    while ((c = getchar()) == ' ' || c == '\\n' || c == '\\r');\n\n        if (c == '-') flag = true;\n\n    else\n\n        num = c - '0';\n\n    while (isdigit(c = getchar()))\n\n    num = num * 10 + c - '0';\n\n    return (flag ? -1 : 1) * num;\n\n}\n\nint main()\n\n{\n\n\tint n,a,b,sum=0;\n\n\tn=read();\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\ta=read();\n\n\t\tb=read();\n\n\t\tsum+=b-a+1;\n\n\t}\n\n\tcout<<sum<<endl;\n\n\treturn 0;\n\n}\n\n\n",
        "optimized_code": "#include<cstdio>\n\nint n,l,r,ans;\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\twhile(n--)\n\n\t\tscanf(\"%d%d\",&l,&r),ans+=r-l+1;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "539",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint a,b,c,d;\n\nint main(){\n\n    cin>>a;\n\n    for (int i=1;i<=a;++i){\n\n        cin>>b>>c;\n\n        d+=c-b+1;\n\n    }\n\n    cout<<d<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nint n,l,r,ans;\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\twhile(n--)\n\n\t\tscanf(\"%d%d\",&l,&r),ans+=r-l+1;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "540",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n,cnt=0,l,r;\n\n\tscanf(\"%d\",&n);\n\n\twhile(n--){\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tcnt+=r-l+1;\n\n\t}\n\n\tcout<<cnt<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nint n,l,r,ans;\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\twhile(n--)\n\n\t\tscanf(\"%d%d\",&l,&r),ans+=r-l+1;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "541",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n,a[10002],b[10002],ans=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>a[i]>>b[i];\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tans+=b[i]-a[i]+1;\n\n\t}\n\n\tcout<<ans;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nint n,l,r,ans;\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\twhile(n--)\n\n\t\tscanf(\"%d%d\",&l,&r),ans+=r-l+1;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "542",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool p[100001];\n\nint main()\n\n{\n\n\tint n,a,b;\n\n\tunsigned long long s=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;++i)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a;j<=b;++j)\n\n\t\t\tp[j]=true;\n\n\t}\n\n\tfor(int i=0;i<=100001;++i)\n\n\t\tif(p[i]==1)\n\n\t\t\t++s;\n\n\tcout<<s<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    int n;\n\n    int l,r,ans=0;\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++){\n\n        cin>>l>>r;\n\n        ans+=r-l+1;\n\n    }\n\n    cout<<ans<<endl;\n\n}"
    },
    {
        "id": "543",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool p[100001];\n\nint main()\n\n{\n\n\tint n,a,b;\n\n\tunsigned long long s=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;++i)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a;j<=b;++j)\n\n\t\t\tp[j]=true;\n\n\t}\n\n\tfor(int i=0;i<=100001;++i)\n\n\t\tif(p[i]==1)\n\n\t\t\t++s;\n\n\tcout<<s<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint l,r;\n\n\tint n;\n\n\tcin>>n;\n\n\tint ans=0;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>l>>r;\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n}"
    },
    {
        "id": "544",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool p[100001];\n\nint main()\n\n{\n\n\tint n,a,b;\n\n\tunsigned long long s=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;++i)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a;j<=b;++j)\n\n\t\t\tp[j]=true;\n\n\t}\n\n\tfor(int i=0;i<=100001;++i)\n\n\t\tif(p[i]==1)\n\n\t\t\t++s;\n\n\tcout<<s<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n    \tscanf(\"%d%d\",&a,&b);\n\n    \tans+=b-a+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "545",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool p[100001];\n\nint main()\n\n{\n\n\tint n,a,b;\n\n\tunsigned long long s=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;++i)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a;j<=b;++j)\n\n\t\t\tp[j]=true;\n\n\t}\n\n\tfor(int i=0;i<=100001;++i)\n\n\t\tif(p[i]==1)\n\n\t\t\t++s;\n\n\tcout<<s<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,l,r,ans;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++) \n\n\t{\n\n\t\tcin>>l>>r;\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans;\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "546",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint ans,n,a,b,c[1000001];\n\nint main() {\n\n\tcin>>n;\n\n\tfor(int i=0; i<n; i++) {\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a; j<=b; j++)\n\n\t\t\tc[j]=1;\n\n\t}\n\n\tfor(int i=0; i<1000001; i++) {\n\n\t\tif(c[i]==1)\n\n\t\t\tans++;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,l,r,ans;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++) \n\n\t{\n\n\t\tcin>>l>>r;\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans;\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "547",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool p[100001];\n\nint main()\n\n{\n\n\tint n,a,b;\n\n\tunsigned long long s=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;++i)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a;j<=b;++j)\n\n\t\t\tp[j]=true;\n\n\t}\n\n\tfor(int i=0;i<=100001;++i)\n\n\t\tif(p[i]==1)\n\n\t\t\t++s;\n\n\tcout<<s<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint m,x,y,ans;\n\nint main(){\n\n\tscanf(\"%d\",&m);\n\n\tfor(int i=1;i<=m;i++){\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tans+=(y-x+1);\n\n\t}\n\n\tprintf(\"%d\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "548",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint ans,n,a,b,c[1000001];\n\nint main() {\n\n\tcin>>n;\n\n\tfor(int i=0; i<n; i++) {\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a; j<=b; j++)\n\n\t\t\tc[j]=1;\n\n\t}\n\n\tfor(int i=0; i<1000001; i++) {\n\n\t\tif(c[i]==1)\n\n\t\t\tans++;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint m,x,y,ans;\n\nint main(){\n\n\tscanf(\"%d\",&m);\n\n\tfor(int i=1;i<=m;i++){\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tans+=(y-x+1);\n\n\t}\n\n\tprintf(\"%d\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "549",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool p[100001];\n\nint main()\n\n{\n\n\tint n,a,b;\n\n\tunsigned long long s=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;++i)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a;j<=b;++j)\n\n\t\t\tp[j]=true;\n\n\t}\n\n\tfor(int i=0;i<=100001;++i)\n\n\t\tif(p[i]==1)\n\n\t\t\t++s;\n\n\tcout<<s<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    int n,l,r,s=0;\n\n    cin>>n;\n\n    while(n--){\n\n    cin>>l>>r;\n\n    s+=r-l+1;\n\n    }\n\n    cout<<s<<endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "550",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint ans,n,a,b,c[1000001];\n\nint main() {\n\n\tcin>>n;\n\n\tfor(int i=0; i<n; i++) {\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a; j<=b; j++)\n\n\t\t\tc[j]=1;\n\n\t}\n\n\tfor(int i=0; i<1000001; i++) {\n\n\t\tif(c[i]==1)\n\n\t\t\tans++;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    int n,l,r,s=0;\n\n    cin>>n;\n\n    while(n--){\n\n    cin>>l>>r;\n\n    s+=r-l+1;\n\n    }\n\n    cout<<s<<endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "551",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint a,b,c;\n\nint z;\n\nint main()\n\n{\n\n\tcin>>a;\n\n\tfor (int i=1;i<=a;i++)\n\n\t{\n\n\t\tcin>>b>>c;\n\n\t\tz=z+(c-b+1);\n\n\t}\n\n\tcout<<z<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "552",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ninline int read()\n\n{\n\n    int num = 0;\n\n    char c;\n\n    bool flag = false;\n\n    while ((c = getchar()) == ' ' || c == '\\n' || c == '\\r');\n\n        if (c == '-') flag = true;\n\n    else\n\n        num = c - '0';\n\n    while (isdigit(c = getchar()))\n\n    num = num * 10 + c - '0';\n\n    return (flag ? -1 : 1) * num;\n\n}\n\nint main()\n\n{\n\n\tint n,a,b,sum=0;\n\n\tn=read();\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\ta=read();\n\n\t\tb=read();\n\n\t\tsum+=b-a+1;\n\n\t}\n\n\tcout<<sum<<endl;\n\n\treturn 0;\n\n}\n\n\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "553",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint a,b,c,d;\n\nint main(){\n\n    cin>>a;\n\n    for (int i=1;i<=a;++i){\n\n        cin>>b>>c;\n\n        d+=c-b+1;\n\n    }\n\n    cout<<d<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "554",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n,cnt=0,l,r;\n\n\tscanf(\"%d\",&n);\n\n\twhile(n--){\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tcnt+=r-l+1;\n\n\t}\n\n\tcout<<cnt<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "555",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n,a[10002],b[10002],ans=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>a[i]>>b[i];\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tans+=b[i]-a[i]+1;\n\n\t}\n\n\tcout<<ans;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "556",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,l,r,ans;\n\nint main(){\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++){\n\n        cin>>l>>r;\n\n        ans+=r-l+1;\n\n    }\n\n    cout<<ans<<endl;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "557",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,l,r,ans,i;\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\tfor(i=1;i<=n;i++){\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tprintf(\"%d\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "558",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool p[100001];\n\nint main()\n\n{\n\n\tint n,a,b;\n\n\tunsigned long long s=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;++i)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a;j<=b;++j)\n\n\t\t\tp[j]=true;\n\n\t}\n\n\tfor(int i=0;i<=100001;++i)\n\n\t\tif(p[i]==1)\n\n\t\t\t++s;\n\n\tcout<<s<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "559",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    int n;\n\n    int l,r,ans=0;\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++){\n\n        cin>>l>>r;\n\n        ans+=r-l+1;\n\n    }\n\n    cout<<ans<<endl;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "560",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint l,r;\n\n\tint n;\n\n\tcin>>n;\n\n\tint ans=0;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>l>>r;\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "561",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n    \tscanf(\"%d%d\",&a,&b);\n\n    \tans+=b-a+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "562",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint ans,n,a,b,c[1000001];\n\nint main() {\n\n\tcin>>n;\n\n\tfor(int i=0; i<n; i++) {\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a; j<=b; j++)\n\n\t\t\tc[j]=1;\n\n\t}\n\n\tfor(int i=0; i<1000001; i++) {\n\n\t\tif(c[i]==1)\n\n\t\t\tans++;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "563",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,l,r,ans;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++) \n\n\t{\n\n\t\tcin>>l>>r;\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans;\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "564",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint m,x,y,ans;\n\nint main(){\n\n\tscanf(\"%d\",&m);\n\n\tfor(int i=1;i<=m;i++){\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tans+=(y-x+1);\n\n\t}\n\n\tprintf(\"%d\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "565",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    int n,l,r,s=0;\n\n    cin>>n;\n\n    while(n--){\n\n    cin>>l>>r;\n\n    s+=r-l+1;\n\n    }\n\n    cout<<s<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cmath>\n\nusing namespace std;\n\n\n\nint l, r, ans, n;\n\nint main() {\n\n\tscanf(\"%d\", &n);\n\n\tfor(int i = 1; i <= n; ++i) {\n\n\t\tscanf(\"%d%d\", &l, &r);\n\n\t\tans += r - l + 1;\n\n\t}\n\n\tprintf(\"%d\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "566",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool p[100001];\n\nint main()\n\n{\n\n\tint n,a,b;\n\n\tunsigned long long s=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;++i)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a;j<=b;++j)\n\n\t\t\tp[j]=true;\n\n\t}\n\n\tfor(int i=0;i<=100001;++i)\n\n\t\tif(p[i]==1)\n\n\t\t\t++s;\n\n\tcout<<s<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    int n,l,r,a;\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++){\n\n        cin>>l>>r;\n\n        a+=r-l+1;\n\n    }\n\n    cout<<a<<endl;\n\n}"
    },
    {
        "id": "567",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint ans,n,a,b,c[1000001];\n\nint main() {\n\n\tcin>>n;\n\n\tfor(int i=0; i<n; i++) {\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a; j<=b; j++)\n\n\t\t\tc[j]=1;\n\n\t}\n\n\tfor(int i=0; i<1000001; i++) {\n\n\t\tif(c[i]==1)\n\n\t\t\tans++;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    int n,l,r,a;\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++){\n\n        cin>>l>>r;\n\n        a+=r-l+1;\n\n    }\n\n    cout<<a<<endl;\n\n}"
    },
    {
        "id": "568",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool p[100001];\n\nint main()\n\n{\n\n\tint n,a,b;\n\n\tunsigned long long s=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;++i)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a;j<=b;++j)\n\n\t\t\tp[j]=true;\n\n\t}\n\n\tfor(int i=0;i<=100001;++i)\n\n\t\tif(p[i]==1)\n\n\t\t\t++s;\n\n\tcout<<s<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n;\n\nint sum;\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\tint l,r;\n\n\twhile(n--){\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tsum+=r-l+1;\n\n\t}\n\n\tprintf(\"%d\",sum);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "569",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint ans,n,a,b,c[1000001];\n\nint main() {\n\n\tcin>>n;\n\n\tfor(int i=0; i<n; i++) {\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a; j<=b; j++)\n\n\t\t\tc[j]=1;\n\n\t}\n\n\tfor(int i=0; i<1000001; i++) {\n\n\t\tif(c[i]==1)\n\n\t\t\tans++;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n;\n\nint sum;\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\tint l,r;\n\n\twhile(n--){\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tsum+=r-l+1;\n\n\t}\n\n\tprintf(\"%d\",sum);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "570",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool p[100001];\n\nint main()\n\n{\n\n\tint n,a,b;\n\n\tunsigned long long s=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;++i)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a;j<=b;++j)\n\n\t\t\tp[j]=true;\n\n\t}\n\n\tfor(int i=0;i<=100001;++i)\n\n\t\tif(p[i]==1)\n\n\t\t\t++s;\n\n\tcout<<s<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    int l,r,ans=0;\n\n    cin>>n;\n\n    for (int i=1;i<=n;i++)\n\n    {\n\n        cin>>l>>r;\n\n        ans+=r-l+1;\n\n    }\n\n    cout<<ans<<endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "571",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint ans,n,a,b,c[1000001];\n\nint main() {\n\n\tcin>>n;\n\n\tfor(int i=0; i<n; i++) {\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a; j<=b; j++)\n\n\t\t\tc[j]=1;\n\n\t}\n\n\tfor(int i=0; i<1000001; i++) {\n\n\t\tif(c[i]==1)\n\n\t\t\tans++;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    int l,r,ans=0;\n\n    cin>>n;\n\n    for (int i=1;i<=n;i++)\n\n    {\n\n        cin>>l>>r;\n\n        ans+=r-l+1;\n\n    }\n\n    cout<<ans<<endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "572",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint a,b,c;\n\nint z;\n\nint main()\n\n{\n\n\tcin>>a;\n\n\tfor (int i=1;i<=a;i++)\n\n\t{\n\n\t\tcin>>b>>c;\n\n\t\tz=z+(c-b+1);\n\n\t}\n\n\tcout<<z<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "573",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ninline int read()\n\n{\n\n    int num = 0;\n\n    char c;\n\n    bool flag = false;\n\n    while ((c = getchar()) == ' ' || c == '\\n' || c == '\\r');\n\n        if (c == '-') flag = true;\n\n    else\n\n        num = c - '0';\n\n    while (isdigit(c = getchar()))\n\n    num = num * 10 + c - '0';\n\n    return (flag ? -1 : 1) * num;\n\n}\n\nint main()\n\n{\n\n\tint n,a,b,sum=0;\n\n\tn=read();\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\ta=read();\n\n\t\tb=read();\n\n\t\tsum+=b-a+1;\n\n\t}\n\n\tcout<<sum<<endl;\n\n\treturn 0;\n\n}\n\n\n",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "574",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint a,b,c,d;\n\nint main(){\n\n    cin>>a;\n\n    for (int i=1;i<=a;++i){\n\n        cin>>b>>c;\n\n        d+=c-b+1;\n\n    }\n\n    cout<<d<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "575",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n,cnt=0,l,r;\n\n\tscanf(\"%d\",&n);\n\n\twhile(n--){\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tcnt+=r-l+1;\n\n\t}\n\n\tcout<<cnt<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "576",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint n,a[10002],b[10002],ans=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>a[i]>>b[i];\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tans+=b[i]-a[i]+1;\n\n\t}\n\n\tcout<<ans;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "577",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,l,r,ans;\n\nint main(){\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++){\n\n        cin>>l>>r;\n\n        ans+=r-l+1;\n\n    }\n\n    cout<<ans<<endl;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "578",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,l,r,ans,i;\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\tfor(i=1;i<=n;i++){\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tprintf(\"%d\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "579",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool p[100001];\n\nint main()\n\n{\n\n\tint n,a,b;\n\n\tunsigned long long s=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;++i)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a;j<=b;++j)\n\n\t\t\tp[j]=true;\n\n\t}\n\n\tfor(int i=0;i<=100001;++i)\n\n\t\tif(p[i]==1)\n\n\t\t\t++s;\n\n\tcout<<s<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "580",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    int n;\n\n    int l,r,ans=0;\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++){\n\n        cin>>l>>r;\n\n        ans+=r-l+1;\n\n    }\n\n    cout<<ans<<endl;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "581",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint l,r;\n\n\tint n;\n\n\tcin>>n;\n\n\tint ans=0;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>l>>r;\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "582",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n,a,b,ans;\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n    \tscanf(\"%d%d\",&a,&b);\n\n    \tans+=b-a+1;\n\n\t}\n\n\tcout<<ans<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "583",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint ans,n,a,b,c[1000001];\n\nint main() {\n\n\tcin>>n;\n\n\tfor(int i=0; i<n; i++) {\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a; j<=b; j++)\n\n\t\t\tc[j]=1;\n\n\t}\n\n\tfor(int i=0; i<1000001; i++) {\n\n\t\tif(c[i]==1)\n\n\t\t\tans++;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "584",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,l,r,ans;\n\nint main()\n\n{\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++) \n\n\t{\n\n\t\tcin>>l>>r;\n\n\t\tans+=r-l+1;\n\n\t}\n\n\tcout<<ans;\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "585",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint m,x,y,ans;\n\nint main(){\n\n\tscanf(\"%d\",&m);\n\n\tfor(int i=1;i<=m;i++){\n\n\t\tscanf(\"%d%d\",&x,&y);\n\n\t\tans+=(y-x+1);\n\n\t}\n\n\tprintf(\"%d\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "586",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    int n,l,r,s=0;\n\n    cin>>n;\n\n    while(n--){\n\n    cin>>l>>r;\n\n    s+=r-l+1;\n\n    }\n\n    cout<<s<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "587",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    int n,l,r,a;\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++){\n\n        cin>>l>>r;\n\n        a+=r-l+1;\n\n    }\n\n    cout<<a<<endl;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "588",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n;\n\nint sum;\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\tint l,r;\n\n\twhile(n--){\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tsum+=r-l+1;\n\n\t}\n\n\tprintf(\"%d\",sum);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "589",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    int l,r,ans=0;\n\n    cin>>n;\n\n    for (int i=1;i<=n;i++)\n\n    {\n\n        cin>>l>>r;\n\n        ans+=r-l+1;\n\n    }\n\n    cout<<ans<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint n,r,l,lhy,i;//lhy\uff0c\u6700\u65b0\u9632\u4f2a\u6807\u8bc6!\uff08\u4e0d\u662f\u5218\u6d69\u5b87\uff01\uff01\uff01\uff09\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(i=1;i<=n;i++)\n\n    {scanf(\"%d%d\",&l,&r);//l\u4ee3\u8868\u5de6\u8fb9\uff0cr\u4ee3\u8868\u53f3\u8fb9\n\n    lhy+=r-l+1;}//\u52a0\u4e00\u4e2a\uff0c\u5934\u5c3e\u90fd\u6709\n\n    printf(\"%d\\n\",lhy);//\u56de\u8f66\u522b\u5fd8\u4e86\n\n    return 0;\n\n}"
    },
    {
        "id": "590",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool p[100001];\n\nint main()\n\n{\n\n\tint n,a,b;\n\n\tunsigned long long s=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;++i)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a;j<=b;++j)\n\n\t\t\tp[j]=true;\n\n\t}\n\n\tfor(int i=0;i<=100001;++i)\n\n\t\tif(p[i]==1)\n\n\t\t\t++s;\n\n\tcout<<s<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <cstdio>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n,x,y,s=0;\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n        cin>>x>>y;\n\n        s+=y-x+1;\n\n    }\n\n    cout<<s<<endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "591",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint ans,n,a,b,c[1000001];\n\nint main() {\n\n\tcin>>n;\n\n\tfor(int i=0; i<n; i++) {\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a; j<=b; j++)\n\n\t\t\tc[j]=1;\n\n\t}\n\n\tfor(int i=0; i<1000001; i++) {\n\n\t\tif(c[i]==1)\n\n\t\t\tans++;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <cstdio>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n,x,y,s=0;\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n        cin>>x>>y;\n\n        s+=y-x+1;\n\n    }\n\n    cout<<s<<endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "592",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool p[100001];\n\nint main()\n\n{\n\n\tint n,a,b;\n\n\tunsigned long long s=0;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;++i)\n\n\t{\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a;j<=b;++j)\n\n\t\t\tp[j]=true;\n\n\t}\n\n\tfor(int i=0;i<=100001;++i)\n\n\t\tif(p[i]==1)\n\n\t\t\t++s;\n\n\tcout<<s<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    int l,r,ans;\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n        cin>>l>>r;\n\n        ans+=r-l+1;\n\n    }\n\n    cout<<ans;\n\n}"
    },
    {
        "id": "593",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint ans,n,a,b,c[1000001];\n\nint main() {\n\n\tcin>>n;\n\n\tfor(int i=0; i<n; i++) {\n\n\t\tcin>>a>>b;\n\n\t\tfor(int j=a; j<=b; j++)\n\n\t\t\tc[j]=1;\n\n\t}\n\n\tfor(int i=0; i<1000001; i++) {\n\n\t\tif(c[i]==1)\n\n\t\t\tans++;\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int n;\n\n    int l,r,ans;\n\n    cin>>n;\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n        cin>>l>>r;\n\n        ans+=r-l+1;\n\n    }\n\n    cout<<ans;\n\n}"
    },
    {
        "id": "594",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nbool flag[100001];\n\nint n;\n\nint ans;\n\n\n\nint main()\n\n{\n\n\tscanf(\"%d\",&n);\n\n\tfor(register int i(1);i<=n;++i)\n\n\t{\n\n\t\tint a,b;\n\n\t\tscanf(\"%d%d\",&a,&b);\n\n\t\tfor(register int j(a);j<=b;++j)\n\n\t\t\tflag[j]=true;\n\n\t}\n\n\tfor(register int i(1);i<=100000;++i)\n\n\t\tif(flag[i]) ++ans;\n\n\tprintf(\"%d\\n\",ans);\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>//\u4e07\u80fd\u6587\u4ef6\u5934\n\nusing namespace std;\n\nint main(){\n\n    int n;\n\n    int l,r,ans=0;//\u6309\u7167\u9898\u5b9a\u4e49\n\n    cin>>n;//\u8f93\u5165\n\n    for(int i=1;i<=n;i++){\n\n        cin>>l>>r;//\u8f93\u5165\u516c\u5f0f\u91cc\u4e24\u4e2a\u6570\n\n        ans+=r-l+1;//\u5957\u516c\u5f0f\u73af\u8282\n\n    }\n\n    cout<<ans<<endl;//\u8f93\u51fa\u7ed3\u679c\n\n    return 0;\n\n}"
    },
    {
        "id": "595",
        "source_code": "#include <iostream>\n\n\n\nint main()\n\n{\n\n    int n, ans = 0;\n\n    std::cin >> n;\n\n    for (int i = 0; i < n; ++i) {\n\n        int l, r;\n\n        std::cin >> l >> r;\n\n        ans += (r - l + 1);\n\n    }\n\n    std::cout << ans << std::endl;\n\n}",
        "optimized_code": "#include <cstdio>\n\n\n\nint main()\n\n{\n\n    int n, ans = 0;\n\n    scanf(\"%d\", &n);\n\n    for (int i = 0; i < n; ++i) {\n\n        int l, r;\n\n        scanf(\"%d%d\", &l, &r);\n\n        ans += (r - l + 1);\n\n    }\n\n    printf(\"%d\\n\", ans);\n\n}"
    },
    {
        "id": "596",
        "source_code": "#pragma target(\"avx\")\n\n#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\ntypedef long double ld;\n\ntypedef pair<ll, ll> P;\n\ntypedef vector<ll> V;\n\ntypedef unordered_map<ll, ll> U_MAP;\n\ntypedef priority_queue<ll> pq;\n\ntypedef priority_queue<ll, vector<ll>, greater<ll>> rpq;\n\nconst int INF = 1e9, MOD = 1e9 + 7, ohara = 1e6 + 10;\n\nconst ll LINF = 1e18;\n\n\n\n#define rep(i, n) for (ll(i) = 0; (i) < (int)(n); (i)++)\n\n#define rrep(i, a, b) for (ll i = (a); i < (b); i++)\n\n#define rrrep(i, a, b) for (ll i = (a); i >= (b); i--)\n\n#define all(v) (v).begin(), (v).end()\n\n#define Size(n) (n).size()\n\n#define Cout(x) cout << (x) << endl\n\n#define doublecout(a) cout << fixed << setprecision(15) << a << endl;\n\n#define fi first\n\n#define se second\n\n#define m_p make_pair\n\n#define p_b push_back\n\n\n\n//------ Believe yourself as a genius!!!!!! ------\n\n\n\nint dy[] = {1, 0, -1, 0};\n\nint dx[] = {0, 1, 0, -1};\n\n// int dy[]={-1,0,1,-1,1,-1,0,1};int dx[]={-1,-1,-1,0,0,1,1,1};\n\nstring alph(\"abcdefghijklmnopqrstuvwxyz\"), s;\n\nll n, cnt, ans[ohara], a, b, c, d, tmp, m, h, w, x, y, sum, k, q;\n\n\n\nint main(void) {\n\n  cin.tie(0);\n\n  cout.tie(0);\n\n  ios::sync_with_stdio(false);\n\n\n\n  cin >> n;\n\n  rep(i, n) {\n\n    cin >> a >> b;\n\n    rrep(j, a, b + 1) ans[j] = 1;\n\n  }\n\n  rep(i, ohara) {\n\n    if (ans[i]) cnt++;\n\n  }\n\n  Cout(cnt);\n\n  return 0;\n\n}",
        "optimized_code": "#pragma target(\"avx\")\n\n#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\ntypedef long long ll;\n\ntypedef long double ld;\n\ntypedef pair<ll, ll> P;\n\ntypedef vector<ll> V;\n\ntypedef unordered_map<ll, ll> U_MAP;\n\ntypedef priority_queue<ll> pq;\n\ntypedef priority_queue<ll, vector<ll>, greater<ll>> rpq;\n\nconstexpr ll INF = 1e9, MOD = 1e9 + 7, ohara = 1e6 + 10;\n\nconstexpr ll LINF = 1e18;\n\n\n\n#define rep(i, n) for (ll(i) = 0; (i) < (int)(n); (i)++)\n\n#define rrep(i, a, b) for (ll i = (a); i < (b); i++)\n\n#define rrrep(i, a, b) for (ll i = (a); i >= (b); i--)\n\n#define all(v) (v).begin(), (v).end()\n\n#define Size(n) (n).size()\n\n#define Cout(x) cout << (x) << endl\n\n#define doublecout(a) cout << fixed << setprecision(15) << a << endl;\n\n#define fi first\n\n#define se second\n\n#define m_p make_pair\n\n#define p_b push_back\n\nstring to_string(string s) { return '\"' + s + '\"'; }\n\nstring to_string(const char* s) { return to_string((string)s); }\n\nstring to_string(bool b) { return (b ? \"true\" : \"false\"); }\n\ntemplate <typename A, typename B>\n\nstring to_string(pair<A, B> p) {\n\n  return \"(\" + to_string(p.first) + \", \" + to_string(p.second) + \")\";\n\n}\n\ntemplate <typename A>\n\nstring to_string(A v) {\n\n  bool first = true;\n\n  string res = \"{\";\n\n  for (const auto& x : v) {\n\n    if (!first) {\n\n      res += \", \";\n\n    }\n\n    first = false;\n\n    res += to_string(x);\n\n  }\n\n  res += \"}\";\n\n  return res;\n\n}\n\nvoid debug_out() { cerr << endl; }\n\ntemplate <typename Head, typename... Tail>\n\nvoid debug_out(Head H, Tail... T) {\n\n  cerr << \" \" << to_string(H);\n\n  debug_out(T...);\n\n}\n\n#define debug(...) cerr << \"[\" << #__VA_ARGS__ << \"]:\", debug_out(__VA_ARGS__)\n\n\n\n//------ Believe yourself as a genius!!!!!! ------\n\n\n\nint dy[] = {1, 0, -1, 0};\n\nint dx[] = {0, 1, 0, -1};\n\n// int dy[]={-1,0,1,-1,1,-1,0,1};int dx[]={-1,-1,-1,0,0,1,1,1};\n\nstring alph(\"abcdefghijklmnopqrstuvwxyz\"), s;\n\nll n, cnt, ans, a, b, c, d, tmp, m, h, w, x, y, sum, k, q;\n\nbool vi[ohara];\n\n\n\nint main(void) {\n\n  cin.tie(0);\n\n  cout.tie(0);\n\n  ios::sync_with_stdio(false);\n\n\n\n  cin >> n;\n\n  rep(i, n) {\n\n    cin >> a >> b;\n\n    rrep(j, a, b + 1) vi[j] = true;\n\n  }\n\n  rrep(i, 1, ohara) {\n\n    if (vi[i]) ans++;\n\n  }\n\n  Cout(ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "597",
        "source_code": "#include <iostream>\n\n#include <string>\n\n#include <regex>\n\n#include <algorithm>\n\nusing namespace std;\n\nint main()\n\n{\n\n    string s;\n\n    cin>>s;\n\n    int res=0;\n\n    smatch m;\n\n    for(auto it=cbegin(s); regex_search(it, cend(s), m, regex(\"[ACGT]+\")); it=m[0].second)\n\n        res=max<int>(res, m.str().size());\n\n    cout<<res<<endl;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <algorithm>\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[16], d[26];\n\n    scanf(\"%s\", s);\n\n    for(char* p=d, c='A'; c<='Z'; ++c) if (!strchr(\"ACGT\", c)) *p++=c;\n\n\n\n    int res=0;\n\n    for(char* p=strtok(s, d); p; p=strtok(NULL, d)) res=max(res, (int)strlen(p));\n\n    printf(\"%d\\n\", res);\n\n}"
    },
    {
        "id": "599",
        "source_code": "#include <iostream>\n\n#include <regex>\n\n\n\nusing namespace std;\n\nint main() {\n\n    string s;\n\n    cin >> s;\n\n    int len=0;\n\n    regex re(R\"([ACGT]+)\");\n\n    sregex_iterator iter(s.cbegin(), s.cend(), re);\n\n    sregex_iterator end;\n\n    for(;iter!=end;++iter) {\n\n        string m = iter->str();\n\n        if (m.length()>len) len = m.length();\n\n    }\n\n    cout << len << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\nusing namespace std;\n\nint main() {\n\n    string s;\n\n    cin >> s;\n\n    int slen=s.length(), len=0;\n\n    int l=0;\n\n    for(int i=0;i<slen;i++) {\n\n        char c = s[i];\n\n        if (c=='A' || c=='C' || c=='G' || c=='T') {\n\n            l++;\n\n            if (l>len) len = l;\n\n        } else {\n\n            l = 0;\n\n        }\n\n    }\n\n    cout << len << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "600",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<vector>\n\n#include<queue>\n\n#include<map>\n\n#include<set>\n\n\n\n#define fst first\n\n#define snd second\n\n\n\nusing namespace std;\n\n\n\ntypedef pair<int,int> pp;\n\nset<int> G[105000];\n\n//set<pp> res;\n\nint dis[105000];\n\nint S[105000];\n\n\n\nint main(void) {\n\n    int n,m,s,t;\n\n    scanf(\"%d%d%d%d\",&n,&m,&s,&t);\n\n    s--, t--;\n\n    memset(dis, 0x20, sizeof(dis));\n\n    for(int i=0; i<m; i++) {\n\n        int x,y;\n\n        scanf(\"%d%d\",&x,&y);\n\n        x--, y--;\n\n        G[x].insert(y);\n\n        G[y].insert(x);\n\n    }\n\n\n\n    {\n\n        priority_queue<pp> q;\n\n        q.push(pp(-0, s));\n\n\n\n        while(!q.empty()) {\n\n            pp t = q.top(); q.pop();\n\n            int d = -t.fst, x = t.snd;\n\n\n\n            if(dis[x] != 0x20202020) continue;\n\n            dis[x] = d;\n\n            S[d]++;\n\n\n\n            for(int y : G[x])\n\n                if(dis[y] == 0x20202020)\n\n                    q.push(pp(-(d+1), y));\n\n        }\n\n    }\n\n\n\n    int old = dis[t];\n\n    memset(dis, 0x20, sizeof(dis));\n\n\n\n    long long int res=0;\n\n    {\n\n        priority_queue<pp> q;\n\n        q.push(pp(-0, t));\n\n\n\n        while(!q.empty()) {\n\n            pp t = q.top(); q.pop();\n\n            int d = -t.fst, x = t.snd;\n\n\n\n            if(dis[x] != 0x20202020) continue;\n\n            dis[x] = d;\n\n\n\n            if(old-2-d >= 0)\n\n                res += S[old-2-d];\n\n\n\n            for(int y : G[x])\n\n                if(dis[y] == 0x20202020)\n\n                    q.push(pp(-(d+1), y));\n\n        }\n\n    }\n\n\n\n    printf(\"%lld\\n\", res);\n\n    return 0;\n\n\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<vector>\n\n#include<queue>\n\n#include<map>\n\n#include<set>\n\n\n\n#define fst first\n\n#define snd second\n\n\n\nusing namespace std;\n\n\n\ntypedef pair<int,int> pp;\n\nvector<int> G[105000];\n\nint dis[105000];\n\nint S[105000];\n\n\n\nint main(void) {\n\n    int n,m,s,t;\n\n    scanf(\"%d%d%d%d\",&n,&m,&s,&t);\n\n    s--, t--;\n\n    memset(dis, 0x20, sizeof(dis));\n\n    for(int i=0; i<m; i++) {\n\n        int x,y;\n\n        scanf(\"%d%d\",&x,&y);\n\n        x--, y--;\n\n        G[x].push_back(y);\n\n        G[y].push_back(x);\n\n    }\n\n\n\n    {\n\n        priority_queue<pp> q;\n\n        q.push(pp(-0, s));\n\n\n\n        while(!q.empty()) {\n\n            pp t = q.top(); q.pop();\n\n            int d = -t.fst, x = t.snd;\n\n\n\n            if(dis[x] != 0x20202020) continue;\n\n            dis[x] = d;\n\n            S[d]++;\n\n\n\n            for(int y : G[x])\n\n                if(dis[y] == 0x20202020)\n\n                    q.push(pp(-(d+1), y));\n\n        }\n\n    }\n\n\n\n    int old = dis[t];\n\n    memset(dis, 0x20, sizeof(dis));\n\n\n\n    long long int res=0;\n\n    {\n\n        priority_queue<pp> q;\n\n        q.push(pp(-0, t));\n\n\n\n        while(!q.empty()) {\n\n            pp t = q.top(); q.pop();\n\n            int d = -t.fst, x = t.snd;\n\n\n\n            if(dis[x] != 0x20202020) continue;\n\n            dis[x] = d;\n\n\n\n            if(old-2-d >= 0)\n\n                res += S[old-2-d];\n\n\n\n            for(int y : G[x])\n\n                if(dis[y] == 0x20202020)\n\n                    q.push(pp(-(d+1), y));\n\n        }\n\n    }\n\n\n\n    printf(\"%lld\\n\", res);\n\n    return 0;\n\n\n\n}"
    },
    {
        "id": "601",
        "source_code": "#pragma comment(linker, \"/STACK:1024000000,1024000000\")\n\n#include <stdio.h>\n\n#include <stdlib.h>\n\n#include <string.h>\n\n#include <time.h>\n\n#include <limits.h>\n\n#include <assert.h>\n\n#include <math.h>\n\n#include <iostream>\n\n#include <algorithm>\n\n#include <map>\n\n#include <set>\n\n#include <stack>\n\n#include <queue>\n\n#include <string>\n\n#include <bitset>\n\n#include <vector>\n\nusing namespace std;\n\n\n\n#define LL long long\n\n\n\n#define fi first\n\n#define se second\n\n#define lson l,mid,id<<1\n\n#define rson mid+1,r,id<<1|1\n\n#define ls id<<1\n\n#define rs id<<1|1\n\n#define MID(a,b) (((a)+(b))>>1)\n\n#define maxx(a,b) ((a)<(b)?(b):(a))\n\n#define minx(a,b) ((a)<(b)?(a):(b))\n\n#define absx(a) ((a)<0?-(a):(a))\n\n#define mk(a,b) make_pair(a,b)\n\n#define pb(a) push_back(a)\n\n#define itr iterator\n\n#define lowbit(x) ((x)&-(x))\n\n\n\ntypedef unsigned LL ULL;\n\ntypedef unsigned uint;\n\ntypedef map<int,int> mii;\n\ntypedef pair<int,int> pii;\n\ntypedef pair<double,double> pdd;\n\ntypedef pair<LL,LL> pLL;\n\n\n\ntemplate< typename T > inline void read(T &x) {\n\n    bool f; char ch; f=0; x=0; ch=getchar();\n\n    while(ch<'0' || ch>'9') {if(ch=='-') f=1; ch=getchar();}\n\n    while(ch>='0' && ch<='9') {x=x*10+ch-'0'; ch=getchar();}\n\n    if(f) x=-x;\n\n}\n\n\n\ntemplate< typename T > inline void Max(T &a, T b) {if(a<b) a=b;}\n\ntemplate< typename T > inline void Min(T &a, T b) {if(b<a) a=b;}\n\ntemplate< typename T > inline T Abs(T a) {if(a<0) return -a; else return a;}\n\n\n\nconst double pi=(double) acos(-1.0);\n\nconst int MOD=(int) 1e9+7;\n\nconst int INF=(int) 0x3f3f3f3f;\n\nconst LL  LINF=(LL) INF<<32|INF;\n\nconst int SINF=(uint) ~0>>1;\n\nconst LL  SLINF=(ULL) (-1)>>1;\n\nconst double DINF=(double) 1e50;\n\nconst double eps=(double) 1e-8;\n\nconst int maxn=(int) 2e5+20;\n\nconst int maxm=(int) 1e5+20;\n\nconst int maxk=(int) 5e2+20;\n\n\n\ninline int sig(double x) {return x<-eps?-1:x>eps;}\n\n\n\n//--------------start------------------\n\n\n\nint n,m;\n\nint a[maxn],sum[maxn];\n\nint T[maxn<<2];\n\nint dp[maxn];\n\n\n\nvector<int> G[maxn];\n\n\n\n#define ROOT 1,n,1\n\nvoid build(int l,int r,int id)\n\n{\n\n    T[id]=INF;\n\n    if(l==r) return ;\n\n    int mid=MID(l,r);\n\n    build(lson);\n\n    build(rson);\n\n}\n\n\n\nvoid update(int val,int L,int R,int l,int r,int id)\n\n{\n\n    if(L<=l && r<=R)\n\n    {\n\n        Min(T[id],val);\n\n        return ;\n\n    }\n\n    int mid=MID(l,r);\n\n    if(L<=mid) update(val,L,R,lson);\n\n    if(mid<R)  update(val,L,R,rson);\n\n}\n\n\n\nint query(int pos,int l,int r,int id)\n\n{\n\n    if(l==r) return T[id];\n\n    int mid=MID(l,r);\n\n    if(pos<=mid) return min(query(pos,lson),T[id]);\n\n    else return min(query(pos,rson),T[id]);\n\n}\n\n\n\nvoid work()\n\n{\n\n    read(n);\n\n    for(int i=1;i<=n;i++) read(a[i]), sum[i]=sum[i-1]+!a[i];\n\n\n\n    read(m);\n\n    while(m--)\n\n    {\n\n        int l,r; read(l), read(r);\n\n        G[r].pb(l);\n\n    }\n\n\n\n    build(ROOT);\n\n    dp[0]=0;\n\n\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n        dp[i]=dp[i-1]+a[i];\n\n        for(int j=0;j<G[i].size();j++)\n\n        {\n\n            int pos=G[i][j], tmp, tmp2;\n\n            tmp=dp[pos-1]+(sum[i]-sum[pos-1]);\n\n            tmp2=query(pos,ROOT)+sum[i];\n\n            Min(tmp,tmp2);\n\n            update(tmp-sum[i],pos,i,ROOT);\n\n            Min(dp[i],tmp);\n\n        }\n\n    }\n\n\n\n    printf(\"%d\\n\",dp[n]);\n\n}\n\n\n\n//--------------end--------------------\n\n\n\nint main()\n\n{\n\n#ifdef yukihana0416\n\nfreopen(\"in.txt\",\"r\",stdin);\n\n//freopen(\"out.txt\",\"w\",stdout);\n\n#endif // yukihana0416\n\n    work();\n\n    return 0;\n\n}\n",
        "optimized_code": "#pragma comment(linker, \"/STACK:1024000000,1024000000\")\n\n#include <stdio.h>\n\n#include <stdlib.h>\n\n#include <string.h>\n\n#include <time.h>\n\n#include <limits.h>\n\n#include <assert.h>\n\n#include <math.h>\n\n#include <iostream>\n\n#include <algorithm>\n\n#include <map>\n\n#include <set>\n\n#include <stack>\n\n#include <queue>\n\n#include <string>\n\n#include <bitset>\n\n#include <vector>\n\nusing namespace std;\n\n\n\n#define LL long long\n\n\n\n#define fi first\n\n#define se second\n\n#define lson l,mid,id<<1\n\n#define rson mid+1,r,id<<1|1\n\n#define ls id<<1\n\n#define rs id<<1|1\n\n#define MID(a,b) (((a)+(b))>>1)\n\n#define maxx(a,b) ((a)<(b)?(b):(a))\n\n#define minx(a,b) ((a)<(b)?(a):(b))\n\n#define absx(a) ((a)<0?-(a):(a))\n\n#define mk(a,b) make_pair(a,b)\n\n#define pb(a) push_back(a)\n\n#define itr iterator\n\n#define lowbit(x) ((x)&-(x))\n\n\n\ntypedef unsigned LL ULL;\n\ntypedef unsigned uint;\n\ntypedef map<int,int> mii;\n\ntypedef pair<int,int> pii;\n\ntypedef pair<double,double> pdd;\n\ntypedef pair<LL,LL> pLL;\n\n\n\ntemplate< typename T > inline void read(T &x) {\n\n    bool f; char ch; f=0; x=0; ch=getchar();\n\n    while(ch<'0' || ch>'9') {if(ch=='-') f=1; ch=getchar();}\n\n    while(ch>='0' && ch<='9') {x=x*10+ch-'0'; ch=getchar();}\n\n    if(f) x=-x;\n\n}\n\n\n\ntemplate< typename T > inline void Max(T &a, T b) {if(a<b) a=b;}\n\ntemplate< typename T > inline void Min(T &a, T b) {if(b<a) a=b;}\n\ntemplate< typename T > inline T Abs(T a) {if(a<0) return -a; else return a;}\n\n\n\nconst double pi=(double) acos(-1.0);\n\nconst int MOD=(int) 1e9+7;\n\nconst int INF=(int) 0x3f3f3f3f;\n\nconst LL  LINF=(LL) INF<<32|INF;\n\nconst int SINF=(uint) ~0>>1;\n\nconst LL  SLINF=(ULL) (-1)>>1;\n\nconst double DINF=(double) 1e50;\n\nconst double eps=(double) 1e-8;\n\nconst int maxn=(int) 2e5+20;\n\nconst int maxm=(int) 1e5+20;\n\nconst int maxk=(int) 5e2+20;\n\n\n\ninline int sig(double x) {return x<-eps?-1:x>eps;}\n\n\n\n//--------------start------------------\n\n\n\nint n,m;\n\nint a[maxn],sum[maxn];\n\nint T[maxn<<2];\n\nint dp[maxn];\n\n\n\nint i,j,pos,tmp,tmp2,l,r;\n\n\n\nstruct adjs{int to,next;}ad[maxn<<1];\n\nint head[maxn],adcnt;\n\ninline void adjs_init() {for(i=1;i<=n;i++) head[i]=-1; adcnt=0;}\n\ninline void adde(int a,int b)\n\n{\n\n    ad[adcnt].next=head[a]; ad[adcnt].to=b;\n\n    head[a]=adcnt++;\n\n}\n\n\n\n#define ROOT 1,n,1\n\nvoid build(int l,int r,int id)\n\n{\n\n    T[id]=INF;\n\n    if(l==r) return ;\n\n    int mid=MID(l,r);\n\n    build(lson);\n\n    build(rson);\n\n}\n\n\n\nvoid update(int val,int L,int R,int l,int r,int id)\n\n{\n\n    if(L<=l && r<=R)\n\n    {\n\n        Min(T[id],val);\n\n        return ;\n\n    }\n\n    int mid=MID(l,r);\n\n    if(L<=mid) update(val,L,R,lson);\n\n    if(mid<R)  update(val,L,R,rson);\n\n}\n\n\n\nint query(int pos,int l,int r,int id)\n\n{\n\n    if(l==r) return T[id];\n\n    int mid=MID(l,r);\n\n    if(pos<=mid) return min(query(pos,lson),T[id]);\n\n    else return min(query(pos,rson),T[id]);\n\n}\n\n\n\nvoid work()\n\n{\n\n    read(n);\n\n    for(i=1;i<=n;i++) read(a[i]), sum[i]=sum[i-1]+!a[i];\n\n    adjs_init();\n\n\n\n    read(m);\n\n    while(m--)\n\n    {\n\n        read(l), read(r);\n\n        adde(r,l);\n\n    }\n\n\n\n    build(ROOT);\n\n    dp[0]=0;\n\n\n\n    for(i=1;i<=n;i++)\n\n    {\n\n        dp[i]=dp[i-1]+a[i];\n\n        for(j=head[i];~j;j=ad[j].next)\n\n        {\n\n            pos=ad[j].to;\n\n            tmp=dp[pos-1]+(sum[i]-sum[pos-1]);\n\n            tmp2=query(pos,ROOT)+sum[i];\n\n            Min(tmp,tmp2);\n\n            update(tmp-sum[i],pos,i,ROOT);\n\n            Min(dp[i],tmp);\n\n        }\n\n    }\n\n\n\n    printf(\"%d\\n\",dp[n]);\n\n}\n\n\n\n//--------------end--------------------\n\n\n\nint main()\n\n{\n\n#ifdef yukihana0416\n\nfreopen(\"in.txt\",\"r\",stdin);\n\n//freopen(\"out.txt\",\"w\",stdout);\n\n#endif // yukihana0416\n\n    work();\n\n    return 0;\n\n}\n"
    },
    {
        "id": "602",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\nstruct vec{\n\n\tint x,nx;\n\n}e[5000001];\n\nint h[200001],p,cnt,co[200001];\n\nvoid ae(int fr,int to){\n\n\te[++p]=(vec){to,h[fr]};h[fr]=p; \n\n}\n\nint mi[200001<<2];\n\nint n,f[200001],q;\n\nint Min(int p,int q){\n\n\treturn p<q?p:q;\n\n}\n\nint Max(int p,int q){\n\n\treturn p>q?p:q;\n\n}\n\nint ask(int i,int l,int r,int ql,int qr){\n\n\tif(r<ql||l>qr) return 2147483647;\n\n\tif(ql<=l&&r<=qr) return mi[i];\n\n\tint m=(l+r)>>1;\n\n\treturn Min(ask(i<<1,l,m,ql,qr),ask(i<<1|1,m+1,r,ql,qr));\n\n}\n\nvoid upd(int i,int l,int r,int k,int pos){\n\n\tif(r<pos||l>pos) return;\n\n\tif(l==r&&r==pos){\n\n\t\tmi[i]=Min(mi[i],k);return;\n\n\t}\n\n\tint m=(l+r)>>1;\n\n\tupd(i<<1,l,m,k,pos);upd(i<<1|1,m+1,r,k,pos);\n\n\tmi[i]=Min(mi[i<<1],mi[i<<1|1]);\n\n}\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\tfor(int i=1,a;i<=n;i++){\n\n\t\tscanf(\"%d\",&a);\n\n\t\tcnt+=!a;\n\n\t\tco[i]=a?1:-1;\n\n\t}\n\n\tscanf(\"%d\",&q);\n\n\tfor(int i=1,l,r;i<=q;i++){\n\n\t\tscanf(\"%d%d\",&l,&r);\n\n\t\tae(l,r);\n\n\t}\n\n\tmemset(mi,0x3f,sizeof(mi));\n\n\tmemset(f,0x3f,sizeof(f));\n\n\tf[0]=0;\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tfor(int j=h[i];j;j=e[j].nx){\n\n\t\t\tint mi=f[i-1];\n\n\t\t\tmi=Min(mi,ask(1,1,n,Max(i-1,1),e[j].x));\n\n\t\t\tif(mi<f[e[j].x]){\n\n\t\t\t\tf[e[j].x]=mi;\n\n\t\t\t\tupd(1,1,n,mi,e[j].x);\n\n\t\t\t}\n\n\t\t}\n\n\t\tf[i]=Min(f[i],f[i-1]+co[i]);\n\n\t}\n\n\tprintf(\"%d\\n\",f[n]+cnt);\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#define MN 262150\n\nusing namespace std;\n\nstruct node{int x,y;}b[MN];\n\nint t[MN<<1],a[MN];\n\nint MQ,INF,n,m,ans,f0;\n\n\n\ninline int read()\n\n{\n\n\tint n=0,f=1; char c=getchar();\n\n\twhile (c<'0' || c>'9') {if(c=='-')f=-1; c=getchar();}\n\n\twhile (c>='0' && c<='9') {n=n*10+c-'0'; c=getchar();}\n\n\treturn n*f;\n\n}\n\n\n\ninline void grw(int x,int y) {for (x+=MQ;x;x>>=1) if (t[x]>y) t[x]=y; else return;}\n\ninline int gmn(int x,int y)\n\n{\n\n\tint sm=INF;\n\n\tfor (x+=MQ,y+=MQ;x<=y;x>>=1,y>>=1)\n\n\t{\n\n\t\tif ( x&1) sm=min(sm,t[x++]);\n\n\t\tif (~y&1) sm=min(sm,t[y--]);\n\n\t}\n\n\treturn sm;\n\n}\n\nbool cmp(const node& a,const node& b) {return a.x<b.x || a.x==b.x && a.y>b.y;}\n\n\n\nint main()\n\n{\n\n\tregister int i,j;\n\n\tn=read(); for (i=1;i<=n;++i) a[i]=read(),ans+=(a[i]==0),a[i]=a[i]?1:-1;\n\n\tm=read(); for (i=1;i<=m;++i) b[i].x=read(),b[i].y=read();\n\n\tsort(b+1,b+m+1,cmp); memset(t,100,sizeof(t)); INF=t[0]; f0=0;\n\n\tfor (MQ=1;MQ<n;MQ<<=1); --MQ;\n\n\tfor (i=j=1;i<=n;f0=min(f0+a[i],t[i+MQ]),++i)\n\n\t\tfor (;j<=m&&b[j].x==i;++j)\n\n\t\t\tgrw(b[j].y,min(gmn(i,b[j].y),f0));\n\n\tprintf(\"%d\",ans+f0);\n\n}"
    },
    {
        "id": "603",
        "source_code": "#include <vector>\n\n#include <stdio.h>\n\n#include <string.h>\n\n#include <iostream>\n\n#include <algorithm>\n\n#define R register\n\ntypedef long long ll;\n\ninline int read(){\n\n\tR int x; R bool f; R char c;\n\n\tfor (f=0; (c=getchar())<'0'||c>'9'; f=c=='-');\n\n\tfor (x=c^'0'; (c=getchar())>='0'&&c<='9'; x=(x<<1)+(x<<3)+(c^'0'));\n\n\treturn f?-x:x;\n\n}\n\n#define M (1<<18)\n\n#define MN 200005\n\nint T[M<<1],n,q,cost[MN],cnt;\n\nstd::vector<int> rang[MN];\n\ninline void rw(int k,int v){for (k+=M; k; k>>=1) if (T[k]<=v) return; else T[k]=v;}\n\ninline int query(int l,int r){\n\n\tR int res=0x3f3f3f3f;\n\n\tfor (l+=M-1,r+=M+1; l^r^1; l>>=1,r>>=1){\n\n\t\tif (~l&1) res=std::min(T[l^1],res);\n\n\t\tif ( r&1) res=std::min(T[r^1],res);\n\n\t}return res;\n\n}\n\nint main(){\n\n\tn=read();for (R int i=1; i<=n; ++i)\n\n\t\tcost[i]=read()?1:-1,cnt+=(bool)(!(~cost[i]));\n\n\tq=read();for (R int i=1,x,y; i<=q; ++i)\n\n\t\tx=read(),y=read(),rang[x].push_back(y);\n\n\tmemset(T,0x3f,sizeof(T));rw(0,0);\n\n\tfor (R int i=1; i<=n; ++i){\n\n\t\tfor (auto j : rang[i]){\n\n\t\t\tR int res = T[i+M-1];\n\n\t\t\tres=std::min(res,query(std::max(i-1,1),j));\n\n\t\t\trw(j,res);\n\n\t\t}rw(i,T[i+M-1]+cost[i]);\n\n\t}printf(\"%d\\n\",T[n+M]+cnt);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#define MN 262150\n\nusing namespace std;\n\nstruct node{int x,y;}b[MN];\n\nint t[MN<<1],a[MN];\n\nint MQ,INF,n,m,ans,f0;\n\n\n\ninline int read()\n\n{\n\n\tint n=0,f=1; char c=getchar();\n\n\twhile (c<'0' || c>'9') {if(c=='-')f=-1; c=getchar();}\n\n\twhile (c>='0' && c<='9') {n=n*10+c-'0'; c=getchar();}\n\n\treturn n*f;\n\n}\n\n\n\ninline void grw(int x,int y) {for (x+=MQ;x;x>>=1) if (t[x]>y) t[x]=y; else return;}\n\ninline int gmn(int x,int y)\n\n{\n\n\tint sm=INF;\n\n\tfor (x+=MQ,y+=MQ;x<=y;x>>=1,y>>=1)\n\n\t{\n\n\t\tif ( x&1) sm=min(sm,t[x++]);\n\n\t\tif (~y&1) sm=min(sm,t[y--]);\n\n\t}\n\n\treturn sm;\n\n}\n\nbool cmp(const node& a,const node& b) {return a.x<b.x || a.x==b.x && a.y>b.y;}\n\n\n\nint main()\n\n{\n\n\tregister int i,j;\n\n\tn=read(); for (i=1;i<=n;++i) a[i]=read(),ans+=(a[i]==0),a[i]=a[i]?1:-1;\n\n\tm=read(); for (i=1;i<=m;++i) b[i].x=read(),b[i].y=read();\n\n\tsort(b+1,b+m+1,cmp); memset(t,100,sizeof(t)); INF=t[0]; f0=0;\n\n\tfor (MQ=1;MQ<n;MQ<<=1); --MQ;\n\n\tfor (i=j=1;i<=n;f0=min(f0+a[i],t[i+MQ]),++i)\n\n\t\tfor (;j<=m&&b[j].x==i;++j)\n\n\t\t\tgrw(b[j].y,min(gmn(i,b[j].y),f0));\n\n\tprintf(\"%d\",ans+f0);\n\n}"
    },
    {
        "id": "606",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef pair<int,int> P;\n\n#define F first\n\n#define S second\n\n#define INF 400000\n\nstruct SEG{\n\n\tint seg[1<<19];\n\n\tSEG(void){for(int i=0;i<1<<19;i++)seg[i]=INF;}\n\n\tvoid up(int a,int x){\n\n\t\ta+=(1<<18)-1;\n\n\t\tseg[a]=min(seg[a],x);\n\n\t\twhile(a>0){\n\n\t\t\ta=(a-1)/2;\n\n\t\t\tseg[a]=min(seg[a*2+1],seg[a*2+2]);\n\n\t\t}\n\n\t}\n\n\tint que(int a,int b,int l,int r,int k){\n\n\t\tif(r<a||b<l)return INF;\n\n\t\tif(a<=l&&r<=b)return seg[k];\n\n\t\treturn min(que(a,b,l,(l+r-1)/2,k*2+1),que(a,b,(l+r+1)/2,r,k*2+2));\n\n\t}\n\n};\n\nint n,q,s[200005];\n\nP x[200005];\n\nSEG d,p;\n\nint main(void){\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++){\n\n\t\tint a;\n\n\t\tscanf(\"%d\",&a);\n\n\t\tif(a)s[i]--;\n\n\t\telse s[i]++;\n\n\t\ts[i]+=s[i-1];\n\n\t}\n\n\tscanf(\"%d\",&q);\n\n\tfor(int i=0;i<q;i++)scanf(\"%d%d\",&x[i].F,&x[i].S);\n\n\tsort(x,x+q);\n\n\td.up(0,(n-s[n])/2);\n\n\tp.up(0,(n-s[n])/2);\n\n\tfor(int i=0;i<q;i++){\n\n\t\tint l=x[i].F,r=x[i].S;\n\n\t\tint o=min(s[r]-s[l-1]+d.que(0,l-1,0,(1<<18)-1,0),s[r]+p.que(l,r,0,(1<<18)-1,0));\n\n\t\td.up(r,o);\n\n\t\tp.up(r,o-s[r]);\n\n\t}\n\n\tprintf(\"%d\\n\",d.que(0,n,0,(1<<18)-1,0));\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef pair<int,int> P;\n\n#define F first\n\n#define S second\n\n#define INF 1<<19\n\nstruct SEG{\n\n\tint seg[1<<19];\n\n\tSEG(void){for(int i=0;i<1<<19;i++)seg[i]=INF;}\n\n\tvoid up(int a,int x){\n\n\t\ta+=(1<<18)-1;\n\n\t\tseg[a]=min(seg[a],x);\n\n\t\twhile(a>0){\n\n\t\t\ta=(a-1)/2;\n\n\t\t\tseg[a]=min(seg[a*2+1],seg[a*2+2]);\n\n\t\t}\n\n\t}\n\n\tint que(int a,int b,int l,int r,int k){\n\n\t\tif(r<a||b<l)return INF;\n\n\t\tif(a<=l&&r<=b)return seg[k];\n\n\t\treturn min(que(a,b,l,(l+r-1)/2,k*2+1),que(a,b,(l+r+1)/2,r,k*2+2));\n\n\t}\n\n};\n\nint n,q,s[1<<18],l,r,a,o,dp[1<<18],d=INF,e;\n\nP x[1<<18];\n\nSEG p;\n\nint main(void){\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++){\n\n\t\tscanf(\"%d\",&a);\n\n\t\tif(a)s[i]--;\n\n\t\telse s[i]++;\n\n\t\ts[i]+=s[i-1];\n\n\t\tdp[i]=INF;\n\n\t}\n\n\tscanf(\"%d\",&q);\n\n\tfor(int i=0;i<q;i++)scanf(\"%d%d\",&x[i].F,&x[i].S);\n\n\tsort(x,x+q);\n\n\tp.up(0,(n-s[n])/2);\n\n\tdp[0]=(n-s[n])/2;\n\n\tfor(int i=0;i<q;i++){\n\n\t\tl=x[i].F,r=x[i].S;\n\n\t\twhile(e<l)d=min(d,dp[e++]);\n\n\t\to=min(d+s[r]-s[l-1],s[r]+p.que(l,r,0,(1<<18)-1,0));\n\n\t\tp.up(r,o-s[r]);\n\n\t\tdp[r]=o;\n\n\t}\n\n\twhile(e<=n)d=min(d,dp[e++]);\n\n\tprintf(\"%d\\n\",d);\n\n}\n"
    },
    {
        "id": "607",
        "source_code": "#include <iostream>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <cstring>\n\n\n\nusing namespace std;\n\n\n\nconst int MOD = 1000000007;\n\n\n\nint main(){\n\n\tint N, W;\n\n\tstatic int dp[201][10001];\n\n\twhile(cin >> N >> W){\n\n\t\tvector<int> w(N);\n\n\t\tfor(int i=0;i<N;i++) cin >> w[i];\n\n\t\tsort(w.begin(), w.end());\n\n\t\tmemset(dp, 0, sizeof(dp));\n\n\t\tdp[N][0] = 1;\n\n\t\tfor(int i=N-1;i>=0;i--){\n\n\t\t\tfor(int j=i+1;j<=N;j++){\n\n\t\t\t\tfor(int k=W;k>=0;k--){\n\n\t\t\t\t\tdp[i][k] = (dp[i][k]+dp[j][k])%MOD;\n\n\t\t\t\t\tif(k+w[i]<=W) dp[j][k+w[i]] = (dp[j][k+w[i]]+dp[j][k])%MOD;\n\n\t\t\t\t\tdp[j][k] = 0;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tint res = 0;\n\n\t\tfor(int i=0;i<=N;i++){\n\n\t\t\tfor(int j=0;j<=W;j++){\n\n\t\t\t\tif(i==N || j+w[i] > W) res = (res+dp[i][j])%MOD;\n\n\t\t\t}\n\n\t\t}\n\n\t\tcout << res << endl;\n\n\t}\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <vector>\n\n#include <numeric>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nconst int MOD = 1000000007;\n\n\n\nint solve(const vector<int>& w, int W){\n\n    if(w.back() > W || w.size() == 1) return 1;\n\n    int sum = accumulate(w.begin(), w.end(), 0);\n\n    if(sum <= W) return 1;\n\n    vector<int> dp(W+1, 0);\n\n    dp[0] = 1;\n\n    int res = 0;\n\n    for(int i=0;i<w.size();i++){\n\n        for(int j=W-w[i];j>=0;j--){\n\n            dp[j+w[i]] += dp[j];\n\n            dp[j+w[i]] %= MOD;\n\n        }\n\n        sum -= w[i];\n\n        for(int j=max(0, W-sum-w[i]+1);j<=W-sum-(i==w.size()-1?0:w[i+1]);j++){\n\n            res = (res + dp[j]) % MOD;\n\n        }\n\n    }\n\n    return res;\n\n}\n\n\n\nint main(){\n\n    int N, W;\n\n    while(cin >> N >> W){\n\n        vector<int> w(N);\n\n        for(auto& t : w) cin >> t;\n\n        sort(w.rbegin(), w.rend());\n\n        cout << solve(w, W) << endl;\n\n    }\n\n}\n"
    },
    {
        "id": "608",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cstring>\n\n\n\nusing namespace std;\n\ntypedef long long ll;\n\n\n\nconst int mod=1000000007;\n\nint N,W;\n\nint w[201];\n\nll dp[2][10001][202];\n\n\n\nint main(){\n\n\n\n\tcin>>N>>W;\n\n\tfor(int i=0;i<N;i++)cin>>w[i];\n\n\tfor(int j=0;j<10001;j++){\n\n\t\tfor(int k=0;k<=N;k++){\n\n\t\t\tif(j<=W&&(k==N||w[k]+j>W))dp[N%2][j][k]=1;\n\n\t\t\telse dp[N%2][j][k]=0;\n\n\t\t}\n\n\t}\n\n\n\n\tfor(int i=N-1;i>=0;i--){\n\n\t\tint cur=(i+1)%2;\n\n\t\tint nxt=(i)%2;\n\n\t\tfor(int j=0;j<10001;j++){\n\n\t\t\tfor(int k=0;k<=N;k++){\n\n\t\t\t\tdp[nxt][j][k]=0;\n\n\t\t\t\tint nmwidx=k;\n\n\t\t\t\tif(k==N||w[k]>w[i])nmwidx=i;\n\n\t\t\t\tdp[nxt][j][k]+=dp[cur][j][nmwidx];\n\n\t\t\t\tif(j+w[i]<=W)dp[nxt][j][k]+=dp[cur][j+w[i]][k];\n\n\t\t\t\tdp[nxt][j][k]%=mod;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcout<<dp[0][0][N]<<endl;\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cstring>\n\n\n\nusing namespace std;\n\ntypedef long long ll;\n\n\n\nconst int mod=1000000007;\n\nint N,W;\n\nint w[201];\n\nll dp[2][10001][202];\n\n\n\nint main(){\n\n\n\n\tcin>>N>>W;\n\n\tfor(int i=0;i<N;i++)cin>>w[i];\n\n\tfor(int j=0;j<=W;j++){\n\n\t\tfor(int k=0;k<=N;k++){\n\n\t\t\tif(j<=W&&(k==N||w[k]+j>W))dp[N%2][j][k]=1;\n\n\t\t\telse dp[N%2][j][k]=0;\n\n\t\t}\n\n\t}\n\n\n\n\tfor(int i=N-1;i>=0;i--){\n\n\t\tint cur=(i+1)%2;\n\n\t\tint nxt=(i)%2;\n\n\t\tfor(int j=0;j<=W;j++){\n\n\t\t\tfor(int k=0;k<=N;k++){\n\n\t\t\t\tdp[nxt][j][k]=0;\n\n\t\t\t\tint nmwidx=k;\n\n\t\t\t\tif(k==N||w[k]>w[i])nmwidx=i;\n\n\t\t\t\tdp[nxt][j][k]+=dp[cur][j][nmwidx];\n\n\t\t\t\tif(j+w[i]<=W)dp[nxt][j][k]+=dp[cur][j+w[i]][k];\n\n\t\t\t\tdp[nxt][j][k]%=mod;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcout<<dp[0][0][N]<<endl;\n\n\n\n\treturn 0;\n\n}"
    },
    {
        "id": "609",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\n#define MAX 2020\n\n\n\ninline int lowbit(const int& i){\n\n\treturn i & (-i);\n\n}\n\n\n\nint m_arr[MAX * 2];\n\n\n\nint get(int loc){\n\n\tint res = 0;\n\n\twhile(loc > 0){\n\n\t\tres += m_arr[loc];\n\n\t\tloc -= lowbit(loc);\n\n\t}\n\n\treturn res;\n\n}\n\n\n\nvoid set(int loc, int num){\n\n\twhile(loc < MAX * 2){\n\n\t\tm_arr[loc] += num;\n\n\t\tloc += lowbit(loc);\n\n\t}\n\n}\n\n\n\nint loc1[MAX], loc2[MAX];\n\n\n\nint cnt[MAX][MAX][2];\n\nint tmparr[MAX * 2];\n\nlong long int dp[MAX][MAX];\n\n\n\nvoid init(int num){\n\n\tint i, j;\n\n\n\n\tmemset(m_arr, 0, sizeof(m_arr));\n\n\tfor(i = 1; i <= num; i++){\n\n\t\tcnt[i - 1][0][0] = loc1[i] - get(loc1[i]) - 1;\n\n\t\tset(loc1[i], 1);\n\n\t}\n\n\t\n\n\tmemset(m_arr, 0, sizeof(m_arr));\n\n\tfor(i = 1; i <= num; i++){\n\n\t\tcnt[0][i - 1][1] = loc2[i] - get(loc2[i]) - 1;\n\n\t\tset(loc2[i], 1);\n\n\t}\n\n\t\n\n\tmemset(tmparr, 0, sizeof(tmparr));\n\n\tfor(i = 1; i <= num; i++){\n\n\t\tmemcpy(m_arr, tmparr, sizeof(tmparr));\n\n\t\tset(loc1[i], 1);\n\n\t\tmemcpy(tmparr, m_arr, sizeof(tmparr));\n\n\t\tfor(j = 1; j <= num; j++){\n\n\t\t\tcnt[i][j - 1][1] = loc2[j] - get(loc2[j]) - 1;\n\n\t\t\tset(loc2[j], 1);\n\n\t\t}\n\n\t}\n\n\t\n\n\tmemset(tmparr, 0, sizeof(tmparr));\n\n\tfor(i = 1; i <= num; i++){\n\n\t\tmemcpy(m_arr, tmparr, sizeof(tmparr));\n\n\t\tset(loc2[i], 1);\n\n\t\tmemcpy(tmparr, m_arr, sizeof(tmparr));\n\n\n\n\t\tfor(j = 1; j <= num; j++){\n\n\t\t\tcnt[j - 1][i][0] = loc1[j] - get(loc1[j]) - 1;\n\n\t\t\tset(loc1[j], 1);\n\n\t\t}\n\n\t}\n\n}\n\n\n\n\n\nvoid getdp(int num){\n\n\tint i, j;\n\n\n\n\tfor(i = 1; i <= num; i++){\n\n\t\tdp[i][0] = dp[i - 1][0] + cnt[i - 1][0][0];\n\n\t}\n\n\n\n\tfor(i = 1; i <= num; i++){\n\n\t\tdp[0][i] = dp[0][i - 1] + cnt[0][i - 1][1];\n\n\t}\n\n\t\n\n\tfor(i = 1; i <= num; i++){\n\n\t\tfor(j = 1; j <= num; j++){\n\n\t\t\tdp[i][j] = dp[i][j - 1] + cnt[i][j - 1][1];\n\n\t\t\tdp[i][j] = std::min(dp[i][j], dp[i - 1][j] + cnt[i - 1][j][0]);\n\n\t\t}\n\n\t}\n\n}\n\n\n\nint main()\n\n{\n\n\tint num, lo, i;\n\n\tchar ch;\n\n\twhile(~scanf(\"%d\", &num)){\n\n\t\tfor(i = 1; i <= num * 2; i++){\n\n\t\t\tgetchar();\n\n\t\t\tscanf(\"%c\", &ch);\n\n\t\t\tscanf(\"%d\", &lo);\n\n\t\t\tif(ch == 'W'){\n\n\t\t\t\tloc1[lo] = i;\n\n\t\t\t}\n\n\t\t\telse{\n\n\t\t\t\tloc2[lo] = i;\n\n\t\t\t}\n\n\t\t\t\n\n\t\t}\n\n\t\tinit(num);\n\n\t\tgetdp(num);\n\n\t\tprintf(\"%lld\\n\", dp[num][num]);\n\n\t\t\n\n\t\t\n\n\t}\n\n\t\n\n\treturn 0;\n\n}\n",
        "optimized_code": "/*\n\n *                             UM.\n\n *                            J@B@1                                                                    iO@1\n\n *                           Y@@@B@BB.                                                              7B@B@B@\n\n *                          :@B@i,B@B@O                                                          ,Z@B@B@B@Br\n\n *                          @B@q   i@B@BS                                                      7@B@@@O5vMB@q\n\n *                         8@@B      LB@B@i                                                  FB@@@BNjYjLE@B@\n\n *                        ,B@B:        0@@@Z                                               P@B@BM1JJ125JPB@B\n\n *                        B@BB          :@B@B                                            XB@B@Z2LuU52F2u2@B@.\n\n *                       :@B@             @@@B:                                        v@B@B8uJj51F1525uUB@B7\n\n *                       @B@O              0@@B.               ..::ir7vvYUuU777r::.   B@B@OULU2F2F151F11Y@B@S\n\n *                       B@B,               8B@B  :ruXMB@B@B@B@B@B@B@B@B@B@@@B@B@B@B@B@B@5Jj1211F1F1F2FUJO@BB\n\n *                      U@B@                 @B@B@B@B@B@@@B@B@B@MMqPS5JuYL7rq@B@OBB@B@B8Yu211F1515251515YGB@@\n\n *                      @B@u                 v@@@@MSur:.                    LB@MvvjJuU5YU252F1F1F25251F2uX@@@\n\n *                      @@@.                                                N@BML2U2UUU12F15252525251515Jk@@B\n\n *                     r@B@                                                 YB@Bju52121252515252F15251F2u5@B@\n\n *                     PB@B                                                  @@@PYUF151F25151F152F2F1F15jF@@B\n\n *                     @@BS                                                  N@@@UJ2F25252F251525151F1F1u5@B@\n\n *                     @@@7                                                   B@B@5Yj12F152F1F1F25252515jFB@B\n\n *                     B@Bi                                                    M@B@O2Luu52525212F151121UY1@B@7\n\n *                    O@B@:                                                     v@B@BMSuYJJuuUu2u2uujjYJJXB@B@M\n\n *                  7B@B@,                                                        1B@@@B@GPF1uujuu21PNMB@B@B@B@@\n\n *                 qB@B2                                                            i8B@B@B@B@B@@@@@B@B@B@q: @@@B\n\n *                MB@B:                                                                 7SBB@B@B@B@B@Zu:      @B@B\n\n *               ZB@B.                                              ,v.                                        @B@L\n\n *              LB@B,                         Y7                    @B@Bu                                      7@B@\n\n *   :B@B@@B2:  @@B7                         @B@Z                   r@B@B@BP:                                   B@BE\n\n *    BB@@@B@B@B@BE                        r@B@B                       7@B@B@B@Ou:                              iB@B\n\n *         :uM@@B@@2.           :7::::ivk@B@B@0                           :5B@B@B@B@B@B@G.                       @B@i\n\n *            BB@@@B@@         :@B@B@@@B@B@@1                                 .i5M@B@B@@@5                       M@@2\n\n *            B@B ,@B1          L0EZZG0F7:                                            .:,                        uB@MrP@M7\n\n *           2@B@                                                                                               ,O@B@B@B@B\n\n *           @B@1                                                     :@B@@@r                                :@@@@B@BL:,,\n\n *           B@Bi                         :2ZS;                      :@B@B@B@r                               L@B@B@BU\n\n *           @B@.                        @@@B@B@                     vB@B@B@B5                                   @B@i\n\n *           B@B                        7B@B@B@BM                     OB@B@B@                                   ,B@B\n\n *           @B@                         @B@B@@@i                       rL7.                                    B@BM\n\n *           B@B7.:                       NB@@M.                                                               .@B@.\n\n *  .;JEB@@@B@B@B@B@.                                                                                       .  @B@u\n\n *@@@B@B@B@B@@@B@18U                                                                                      :B@B@B@BU,\n\n *7@BOui.    ,@@B                                                                                          SP@B@B@B@B@Or\n\n *            @@@U                                                                                           B@BJ.YO@B@B@i\n\n *            r@B@                                                                                         :B@Bk     .k@B@\n\n *             B@B@                                                                                       LB@@k         2i\n\n *              B@BM                                      .7jXEGqF7:                                     OB@@L\n\n *              .B@BM                                   .B@B@B@B@B@B@.                                 :@B@B:\n\n *               .B@B@                                   @@MYr::ivG@B                                .M@B@G\n\n *                 B@@@S                                                                           ,MB@B@,\n\n *                  v@@@BF                                                                      .1B@B@Br\n\n *                    2@@B@BL                                                                ,FB@@@B8,\n\n *                      r@B@B@BF,                                                        :YBB@B@B@B\n\n *                         L@B@B@B@P7,                                           .ivXB@B@B@B@B@M@B@\n\n *                            ,1B@B@B@B@@@BOP2L7i:,.              ..,:i7LSNB@@B@B@@@B@B@B@Z5v;.LB@@\n\n *                              @B@OEB@B@@@B@B@B@B@B@B@B@B@@@B@B@B@B@B@@@B@B@B@B@BM0SJ7i::::i:,u@B@\n\n *                              B@Bu ::i;7vu2XNGOMB@B@BMB@B@B@B@B@B@@@B1UFuj77ii:::::::iir;r;i.YB@B\n\n *                              @B@L.:i:i:i::::::::::..Y@B@BMYi:i;SB@B@N:.::i:iirir;r;rii::::ivO@B@\n\n *                              B@@X::,::::iirir;riri:E@B@1         ,@B@Br:;;r;rii:i::::i7JEB@@@@@B\n\n *                              @@@B@BBq5v7ii:::::::.2@@@i  ..,..     @B@@,,:::::irv2XMB@B@B@B@2@B@:\n\n *                             .B@BBB@@@B@B@B@BMNP5u7@B@1 .,,:,,  :.   @B@P50MB@B@B@B@B@@@BS:   @@B1\n\n *                             E@B@   ijGB@B@B@B@B@B@B@Bi .,:,,..@@B@7 B@B@B@B@B@B@BM57.        kB@B\n\n *                            .@B@:          .,ivu5Nq@B@u  ..,.. SB@B@@@B@PL7i,                 ,@B@\n\n *                            @@@8                   i@B@:    .     :B@B@@                       B@@2\n\n *                          i@@@@                     0@B@u          B@@B.                       vB@B\n\n *                         ,@B@G                       L@B@BOv:.:iFB@B@M                          @B@Bi\n\n *                          vNi                          S@@B@B@B@B@BM:                            MB@N\n\n *                                                          758BMqJ,\n\n *\n\n *                 .  YO.               vq                            :G       Z:\n\n *        SqOMBB@B@Br @@r rBE           @B     B@@@@@B@ONX8k    i::::.OB1.:::.u@O.::::i           @B@B@U:@@B@@BPEBu\n\n *        B@@NB@k.    5@i  uB@E.        BM     1U2uUJvirB@@Z   r@@B@B@@@B@B@B@B@B@@@B@Bi   LB@B@1 BX :@k uLLLvr@BJ:\n\n *            iB      iBi    7@     .@M8@BGMZZ         @@F            ,B       Pi          v@  Bq @i v@        B@\n\n *       vuL7r8@S7vJL7N@Z7LLri;72.   F7@Bvvv@@       @BX         @@@B@B@@@@@B@@@B@B@B      7@  @F Bi @q  @B@Bu @B\n\n *       N@B@G@@@8@BBOMB@G@BMNXG@,     B@   @@      .Bk          .:u;    i@:      Zv       7@  Bk @,;@  ,BY @B B@\n\n *            r@       @G     5.      ,@v   BZ :::,.r@E .::i,      @B     B@    .@BL       7@  @F B:i@. .@  @M @B\n\n *            7B: ,vO, @@   iB@:      @B   7@:MB@B@B@@@B@B@BM       @@.    B:  2@q         7@  BS @i 0@  B. @O B@\n\n *       ,r2EBB@B@B@Bi G@  @BB        B@   @B        @S              :    r@   ..          7B  @F @7  B7 @  @B @B\n\n *       E@B@UOBr       @B@Bi          L@0PB        .BZ        .@B@B@B@B@B@B@B@B@B@B@B@,   r@  BF @i  @G B@B@B B@\n\n *            7@,      kB@U    ;r        @@@.       .@Z                GBuL@iBBi           vB@B@q BP:5@7 @u,.  @B\n\n *            LBi   YB@BrB@    @@       @B:L@Br      BM             .M@B  rB  rB@J         v@. Pi @XZ8r  .     B@\n\n *        .   G@i B@BM.  ,B@,  @B    iB@B    N, 7r..q@k         ,LB@B8    J@,   i@B@B1r           Br           @@\n\n *        MB@B@B  ,i       B@B@B,    B@:        @B@B@F         .@BB:      P@i      :OBZ          .@U       B@B@B:\n\n *                          .ll                                           rB.                     :\n\n */\n\n/*****************\n\n *   I<3   C++   *\n\n *  IWANT ANYAC  *\n\n * ILOVEPROGRAM! *\n\n *IT'SINTERESTING*\n\n * ILOVEPROGRAM! *\n\n *  INCONTESTS   *\n\n *   GETSCORE    *\n\n *    ACCODE     *\n\n *     LETS      *\n\n *      GO       *\n\n *Written by:    *\n\n *    charlieyan *\n\n *****************/\n\n#include <assert.h>\n\n#include <ctype.h>\n\n#include <errno.h>\n\n#include <float.h>\n\n#include <fstream>\n\n#include <iomanip>\n\n#include <iostream>\n\n#include <limits>\n\n#include <locale>\n\n#include <math.h>\n\n#include <stdio.h>\n\n#include <stdlib.h>\n\n#include <string.h>\n\n#include <time.h>\n\n#include <wchar.h>\n\n#include <wctype.h>\n\n#include <algorithm>\n\n#include <bitset>\n\n#include <cctype>\n\n#include <cerrno>\n\n#include <clocale>\n\n#include <cmath>\n\n#include <complex>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <ctime>\n\n#include <deque>\n\n#include <exception>\n\n#include <fstream>\n\n#include <functional>\n\n#include <limits>\n\n#include <map>\n\n#include <iomanip>\n\n#include <ios>\n\n#include <iosfwd>\n\n#include <istream>\n\n#include <ostream>\n\n#include <queue>\n\n#include <set>\n\n#include <sstream>\n\n#include <stack>\n\n#include <stdexcept>\n\n#include <streambuf>\n\n#include <string>\n\n#include <utility>\n\n#include <vector>\n\n#include <cwchar>\n\n#include <cwctype>\n\n#include <inttypes.h>\n\n#include <stdbool.h>\n\n#include <stdint.h>\n\n#include <tgmath.h>\n\n#include <numeric>\n\n#include <list>\n\n#define LL long long\n\n#define pb push_back\n\n#define pob pop_back\n\n#define mp make_pair\n\n#define FILL(a,v) memset((void*)a,v,sizeof(a))\n\n#define FILL0(a) FILL(a,0)\n\n#define FILL1(a) FILL(a,-1)\n\n#define FILLBIG(a) FILL(a,0x7f)\n\n#define ALL(a) (a).begin(),(a).end()\n\n#define Inf ((int)0x7f7f7f7f)\n\n#define INF ((long long)0x7f7f7f7f7f7f7f7f)\n\n#define Mod 1000000007\n\n#define foreach(it,x) for(__typeof(x.begin()) it=x.begin();it!=x.end();it++)\n\n#define FOR(i,x) for(int i=0;i<x;i++)\n\n#define RFOR(i,x) for(int i=x-1;i>=0;i--)\n\n#define FFOR(i,a,b) for(int i=a;i<b;i++)\n\n#define FRFOR(i,a,b) for(int i=a-1;i>=b;i--)\n\n#define SZ(a) ((int)(a).size())\n\n#define FI first\n\n#define SE second\n\n#define OVER(a) return puts(a),0\n\n#define fastio ios::sync_with_stdio(0)\n\n#define filei(f) freopen(f,\"r\",stdin)\n\n#define fileo(f) freopen(f,\"w\",stdout)\n\n#define eprintf(...) fprintf(stderr,__VA_ARGS__)\n\n#define MASK(a) (1<<(a))\n\n#define MASKX(x,a) ((x)<<(a))\n\n#define BIT(a,b) ((a>>b)&1)\n\n#define cddx(a) priority_queue<a >\n\n#define cxdd(a) priority_queue<a,vector<a >,greater<a > >\n\n#define deval(a) {cerr<<#a<<\" = \"<<a<<endl;}\n\n#define dearr(be,en) {cerr<<#be;cerr<<\" = {\";for(auto i=be;i!=en;i++)cerr<<' '<<*i;cerr<<\" }\\n\";}\n\n#define reg register\n\n#define prtime eprintf(\"\\n\\nTime used: %dms\\n\",clock());\n\n#define PI 3.1415926535897932384626\n\n#define TODEG(a) (a*180/PI)\n\n//\u0421\u043e\u044e\u0437 \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u0438\u0445 \u0441\u043e\u0446\u0438\u0430\u043b\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0440\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\n\n//\u82cf\u7ef4\u57c3\u793e\u4f1a\u4e3b\u4e49\u5171\u548c\u56fd\u8054\u76df\n\nusing namespace std;\n\ntypedef pair<int,int> pii;\n\ntypedef unsigned long long UINT;\n\ntypedef unsigned int uint;\n\ntypedef long long INT;\n\ntypedef long double ldouble;\n\ntypedef pair<INT,INT> PII;\n\ntypedef stringstream sst;\n\ntypedef istringstream iss;\n\ntypedef vector<int> vint;\n\ntypedef vector<INT> VINT;\n\ntypedef vector<pii> vpii;\n\ntypedef vector<PII> VPII;\n\ntypedef priority_queue<int> pqi;\n\ntypedef priority_queue<INT> PQI;\n\ntypedef priority_queue<pii> pqp;\n\ntypedef priority_queue<PII> PQP;\n\ntypedef priority_queue<int,vint,greater<int> > xqi;\n\ntypedef priority_queue<INT,VINT,greater<INT> > XQI;\n\ntypedef priority_queue<pii,vpii,greater<pii> > xqp;\n\ntypedef priority_queue<PII,VPII,greater<PII> > XQP;\n\ninline int read()\n\n{\n\n\tint num=0;\n\n\tchar c=getchar();\n\n\tif(c=='-')return -read();\n\n\twhile(c>='0'&&c<='9')\n\n\t{\n\n\t\tnum=(num<<3)+(num<<1)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\treturn num;\n\n}\n\ninline INT READ()\n\n{\n\n\tINT num=0;\n\n\tchar c=getchar();\n\n\tif(c=='-')return -READ();\n\n\twhile(c>='0'&&c<='9')\n\n\t{\n\n\t\tnum=(num<<3)+(num<<1)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\treturn num;\n\n}\n\n//Coded by Charlieyan\n\n//\u7248\u6743\u6240\u6709\uff0c\u7ffb\u5370\u5fc5\u7a76\n\n\n\nint n;\n\nint dp[2007][2007],dpb[4007][2007],dpw[4007][2007];\n\nchar mode[4007];\n\nint val[4007];\n\nint posb[2007],posw[2007];\n\n\n\nint main()\n\n{\n\n\tscanf(\"%d\",&n);\n\n\tfor(int i=1;i<=2*n;i++)\n\n\t{\n\n\t\tscanf(\" %c %d\",mode+i,val+i);\n\n\t\tif(mode[i]=='B')dpb[i-1][val[i]]++,posb[val[i]]=i;\n\n\t\telse dpw[i-1][val[i]]++,posw[val[i]]=i;\n\n\t}\n\n\tfor(int i=2*n-1;i>=0;i--)\n\n\t\tfor(int j=1;j<=n;j++)\n\n\t\t{\n\n\t\t\tdpb[i][j]+=dpb[i+1][j];\n\n\t\t\tdpw[i][j]+=dpw[i+1][j];\n\n\t\t}\n\n\tfor(int i=0;i<=2*n;i++)\n\n\t\tfor(int j=1;j<=n;j++)\n\n\t\t{\n\n\t\t\tdpb[i][j]+=dpb[i][j-1];\n\n\t\t\tdpw[i][j]+=dpw[i][j-1];\n\n\t\t}\n\n\tdp[0][0]=0;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tdp[i][0]=dp[i-1][0]+(posb[i]-i+dpb[posb[i]][i]+dpw[posb[i]][0]);\n\n\t\tdp[0][i]=dp[0][i-1]+(posw[i]-i+dpb[posw[i]][0]+dpw[posw[i]][i]);\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tfor(int j=1;j<=n;j++)\n\n\t\t\tdp[i][j]=min(dp[i-1][j]+(posb[i]-i-j+dpb[posb[i]][i]+dpw[posb[i]][j]),dp[i][j-1]+(posw[j]-i-j+dpb[posw[j]][i]+dpw[posw[j]][j]));\n\n\tprintf(\"%d\\n\",dp[n][n]);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "610",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\n#define MAX 2020\n\n\n\ninline int lowbit(const int& i){\n\n\treturn i & (-i);\n\n}\n\n\n\nint m_arr[MAX * 2];\n\n\n\nint get(int loc){\n\n\tint res = 0;\n\n\twhile(loc > 0){\n\n\t\tres += m_arr[loc];\n\n\t\tloc -= lowbit(loc);\n\n\t}\n\n\treturn res;\n\n}\n\n\n\nvoid set(int loc, int num){\n\n\twhile(loc < MAX * 2){\n\n\t\tm_arr[loc] += num;\n\n\t\tloc += lowbit(loc);\n\n\t}\n\n}\n\n\n\nint loc1[MAX], loc2[MAX];\n\n\n\nint cnt[MAX][MAX][2];\n\nint tmparr[MAX * 2];\n\nlong long int dp[MAX][MAX];\n\n\n\nvoid init(int num){\n\n\tint i, j;\n\n\n\n\tmemset(m_arr, 0, sizeof(m_arr));\n\n\tfor(i = 1; i <= num; i++){\n\n\t\tcnt[i - 1][0][0] = loc1[i] - get(loc1[i]) - 1;\n\n\t\tset(loc1[i], 1);\n\n\t}\n\n\t\n\n\tmemset(m_arr, 0, sizeof(m_arr));\n\n\tfor(i = 1; i <= num; i++){\n\n\t\tcnt[0][i - 1][1] = loc2[i] - get(loc2[i]) - 1;\n\n\t\tset(loc2[i], 1);\n\n\t}\n\n\t\n\n\tmemset(tmparr, 0, sizeof(tmparr));\n\n\tfor(i = 1; i <= num; i++){\n\n\t\tmemcpy(m_arr, tmparr, sizeof(tmparr));\n\n\t\tset(loc1[i], 1);\n\n\t\tmemcpy(tmparr, m_arr, sizeof(tmparr));\n\n\t\tfor(j = 1; j <= num; j++){\n\n\t\t\tcnt[i][j - 1][1] = loc2[j] - get(loc2[j]) - 1;\n\n\t\t\tset(loc2[j], 1);\n\n\t\t}\n\n\t}\n\n\t\n\n\tmemset(tmparr, 0, sizeof(tmparr));\n\n\tfor(i = 1; i <= num; i++){\n\n\t\tmemcpy(m_arr, tmparr, sizeof(tmparr));\n\n\t\tset(loc2[i], 1);\n\n\t\tmemcpy(tmparr, m_arr, sizeof(tmparr));\n\n\n\n\t\tfor(j = 1; j <= num; j++){\n\n\t\t\tcnt[j - 1][i][0] = loc1[j] - get(loc1[j]) - 1;\n\n\t\t\tset(loc1[j], 1);\n\n\t\t}\n\n\t}\n\n}\n\n\n\n\n\nvoid getdp(int num){\n\n\tint i, j;\n\n\n\n\tfor(i = 1; i <= num; i++){\n\n\t\tdp[i][0] = dp[i - 1][0] + cnt[i - 1][0][0];\n\n\t}\n\n\n\n\tfor(i = 1; i <= num; i++){\n\n\t\tdp[0][i] = dp[0][i - 1] + cnt[0][i - 1][1];\n\n\t}\n\n\t\n\n\tfor(i = 1; i <= num; i++){\n\n\t\tfor(j = 1; j <= num; j++){\n\n\t\t\tdp[i][j] = dp[i][j - 1] + cnt[i][j - 1][1];\n\n\t\t\tdp[i][j] = std::min(dp[i][j], dp[i - 1][j] + cnt[i - 1][j][0]);\n\n\t\t}\n\n\t}\n\n}\n\n\n\nint main()\n\n{\n\n\tint num, lo, i;\n\n\tchar ch;\n\n\twhile(~scanf(\"%d\", &num)){\n\n\t\tfor(i = 1; i <= num * 2; i++){\n\n\t\t\tgetchar();\n\n\t\t\tscanf(\"%c\", &ch);\n\n\t\t\tscanf(\"%d\", &lo);\n\n\t\t\tif(ch == 'W'){\n\n\t\t\t\tloc1[lo] = i;\n\n\t\t\t}\n\n\t\t\telse{\n\n\t\t\t\tloc2[lo] = i;\n\n\t\t\t}\n\n\t\t\t\n\n\t\t}\n\n\t\tinit(num);\n\n\t\tgetdp(num);\n\n\t\tprintf(\"%lld\\n\", dp[num][num]);\n\n\t\t\n\n\t\t\n\n\t}\n\n\t\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cstring>\n\nusing namespace std;\n\nconst int mx = 2020;\n\nint dp[mx][mx],cw[mx][mx],cb[mx][mx],w[mx],b[mx];\n\nchar col[10];\n\nint main()\n\n{\n\n    int n,a,cont1=1,cont2=1;\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n        for(int j=1;j<=n;j++)\n\n            dp[i][j]=100000000;\n\n    for(int i=1;i<=2*n;i++){\n\n        scanf(\"%s\",col);\n\n        scanf(\"%d\",&a);\n\n        if(col[0]=='W')\n\n            w[a]=i;\n\n        else\n\n            b[a]=i;\n\n    }\n\n    for(int i=1;i<=n;i++){\n\n        for(int j=1;j<i;j++)\n\n            if(w[j]>w[i])\n\n                cw[i][0]++;\n\n        for(int j=1;j<=n;j++){\n\n            cw[i][j]=cw[i][j-1];\n\n            if(w[i]<b[j])\n\n                cw[i][j]++;\n\n        }\n\n    }\n\n    for(int i=1;i<=n;i++){\n\n        for(int j=1;j<i;j++)\n\n            if(b[j]>b[i])\n\n                cb[0][i]++;\n\n        for(int j=1;j<=n;j++){\n\n            cb[j][i]=cb[j-1][i];\n\n            if(b[i]<w[j])\n\n                cb[j][i]++;\n\n        }\n\n    }\n\n    dp[0][0]=0;\n\n    int c1=0,c2=0;\n\n    for(int i=1;i<=n;i++){\n\n        c1+=cw[i][0];\n\n        c2+=cb[0][i];\n\n        dp[i][0]=c1;\n\n        dp[0][i]=c2;\n\n    }\n\n    for(int i=1;i<=n;i++)\n\n        for(int j=1;j<=n;j++)\n\n            dp[i][j]=min(dp[i-1][j]+cw[i][j],dp[i][j-1]+cb[i][j]);\n\n    printf(\"%d\\n\",dp[n][n]);\n\n    return 0;\n\n}\n"
    },
    {
        "id": "611",
        "source_code": "/*\n\n *                             UM.\n\n *                            J@B@1                                                                    iO@1\n\n *                           Y@@@B@BB.                                                              7B@B@B@\n\n *                          :@B@i,B@B@O                                                          ,Z@B@B@B@Br\n\n *                          @B@q   i@B@BS                                                      7@B@@@O5vMB@q\n\n *                         8@@B      LB@B@i                                                  FB@@@BNjYjLE@B@\n\n *                        ,B@B:        0@@@Z                                               P@B@BM1JJ125JPB@B\n\n *                        B@BB          :@B@B                                            XB@B@Z2LuU52F2u2@B@.\n\n *                       :@B@             @@@B:                                        v@B@B8uJj51F1525uUB@B7\n\n *                       @B@O              0@@B.               ..::ir7vvYUuU777r::.   B@B@OULU2F2F151F11Y@B@S\n\n *                       B@B,               8B@B  :ruXMB@B@B@B@B@B@B@B@B@B@@@B@B@B@B@B@B@5Jj1211F1F1F2FUJO@BB\n\n *                      U@B@                 @B@B@B@B@B@@@B@B@B@MMqPS5JuYL7rq@B@OBB@B@B8Yu211F1515251515YGB@@\n\n *                      @B@u                 v@@@@MSur:.                    LB@MvvjJuU5YU252F1F1F25251F2uX@@@\n\n *                      @@@.                                                N@BML2U2UUU12F15252525251515Jk@@B\n\n *                     r@B@                                                 YB@Bju52121252515252F15251F2u5@B@\n\n *                     PB@B                                                  @@@PYUF151F25151F152F2F1F15jF@@B\n\n *                     @@BS                                                  N@@@UJ2F25252F251525151F1F1u5@B@\n\n *                     @@@7                                                   B@B@5Yj12F152F1F1F25252515jFB@B\n\n *                     B@Bi                                                    M@B@O2Luu52525212F151121UY1@B@7\n\n *                    O@B@:                                                     v@B@BMSuYJJuuUu2u2uujjYJJXB@B@M\n\n *                  7B@B@,                                                        1B@@@B@GPF1uujuu21PNMB@B@B@B@@\n\n *                 qB@B2                                                            i8B@B@B@B@B@@@@@B@B@B@q: @@@B\n\n *                MB@B:                                                                 7SBB@B@B@B@B@Zu:      @B@B\n\n *               ZB@B.                                              ,v.                                        @B@L\n\n *              LB@B,                         Y7                    @B@Bu                                      7@B@\n\n *   :B@B@@B2:  @@B7                         @B@Z                   r@B@B@BP:                                   B@BE\n\n *    BB@@@B@B@B@BE                        r@B@B                       7@B@B@B@Ou:                              iB@B\n\n *         :uM@@B@@2.           :7::::ivk@B@B@0                           :5B@B@B@B@B@B@G.                       @B@i\n\n *            BB@@@B@@         :@B@B@@@B@B@@1                                 .i5M@B@B@@@5                       M@@2\n\n *            B@B ,@B1          L0EZZG0F7:                                            .:,                        uB@MrP@M7\n\n *           2@B@                                                                                               ,O@B@B@B@B\n\n *           @B@1                                                     :@B@@@r                                :@@@@B@BL:,,\n\n *           B@Bi                         :2ZS;                      :@B@B@B@r                               L@B@B@BU\n\n *           @B@.                        @@@B@B@                     vB@B@B@B5                                   @B@i\n\n *           B@B                        7B@B@B@BM                     OB@B@B@                                   ,B@B\n\n *           @B@                         @B@B@@@i                       rL7.                                    B@BM\n\n *           B@B7.:                       NB@@M.                                                               .@B@.\n\n *  .;JEB@@@B@B@B@B@.                                                                                       .  @B@u\n\n *@@@B@B@B@B@@@B@18U                                                                                      :B@B@B@BU,\n\n *7@BOui.    ,@@B                                                                                          SP@B@B@B@B@Or\n\n *            @@@U                                                                                           B@BJ.YO@B@B@i\n\n *            r@B@                                                                                         :B@Bk     .k@B@\n\n *             B@B@                                                                                       LB@@k         2i\n\n *              B@BM                                      .7jXEGqF7:                                     OB@@L\n\n *              .B@BM                                   .B@B@B@B@B@B@.                                 :@B@B:\n\n *               .B@B@                                   @@MYr::ivG@B                                .M@B@G\n\n *                 B@@@S                                                                           ,MB@B@,\n\n *                  v@@@BF                                                                      .1B@B@Br\n\n *                    2@@B@BL                                                                ,FB@@@B8,\n\n *                      r@B@B@BF,                                                        :YBB@B@B@B\n\n *                         L@B@B@B@P7,                                           .ivXB@B@B@B@B@M@B@\n\n *                            ,1B@B@B@B@@@BOP2L7i:,.              ..,:i7LSNB@@B@B@@@B@B@B@Z5v;.LB@@\n\n *                              @B@OEB@B@@@B@B@B@B@B@B@B@B@@@B@B@B@B@B@@@B@B@B@B@BM0SJ7i::::i:,u@B@\n\n *                              B@Bu ::i;7vu2XNGOMB@B@BMB@B@B@B@B@B@@@B1UFuj77ii:::::::iir;r;i.YB@B\n\n *                              @B@L.:i:i:i::::::::::..Y@B@BMYi:i;SB@B@N:.::i:iirir;r;rii::::ivO@B@\n\n *                              B@@X::,::::iirir;riri:E@B@1         ,@B@Br:;;r;rii:i::::i7JEB@@@@@B\n\n *                              @@@B@BBq5v7ii:::::::.2@@@i  ..,..     @B@@,,:::::irv2XMB@B@B@B@2@B@:\n\n *                             .B@BBB@@@B@B@B@BMNP5u7@B@1 .,,:,,  :.   @B@P50MB@B@B@B@B@@@BS:   @@B1\n\n *                             E@B@   ijGB@B@B@B@B@B@B@Bi .,:,,..@@B@7 B@B@B@B@B@B@BM57.        kB@B\n\n *                            .@B@:          .,ivu5Nq@B@u  ..,.. SB@B@@@B@PL7i,                 ,@B@\n\n *                            @@@8                   i@B@:    .     :B@B@@                       B@@2\n\n *                          i@@@@                     0@B@u          B@@B.                       vB@B\n\n *                         ,@B@G                       L@B@BOv:.:iFB@B@M                          @B@Bi\n\n *                          vNi                          S@@B@B@B@B@BM:                            MB@N\n\n *                                                          758BMqJ,\n\n *\n\n *                 .  YO.               vq                            :G       Z:\n\n *        SqOMBB@B@Br @@r rBE           @B     B@@@@@B@ONX8k    i::::.OB1.:::.u@O.::::i           @B@B@U:@@B@@BPEBu\n\n *        B@@NB@k.    5@i  uB@E.        BM     1U2uUJvirB@@Z   r@@B@B@@@B@B@B@B@B@@@B@Bi   LB@B@1 BX :@k uLLLvr@BJ:\n\n *            iB      iBi    7@     .@M8@BGMZZ         @@F            ,B       Pi          v@  Bq @i v@        B@\n\n *       vuL7r8@S7vJL7N@Z7LLri;72.   F7@Bvvv@@       @BX         @@@B@B@@@@@B@@@B@B@B      7@  @F Bi @q  @B@Bu @B\n\n *       N@B@G@@@8@BBOMB@G@BMNXG@,     B@   @@      .Bk          .:u;    i@:      Zv       7@  Bk @,;@  ,BY @B B@\n\n *            r@       @G     5.      ,@v   BZ :::,.r@E .::i,      @B     B@    .@BL       7@  @F B:i@. .@  @M @B\n\n *            7B: ,vO, @@   iB@:      @B   7@:MB@B@B@@@B@B@BM       @@.    B:  2@q         7@  BS @i 0@  B. @O B@\n\n *       ,r2EBB@B@B@Bi G@  @BB        B@   @B        @S              :    r@   ..          7B  @F @7  B7 @  @B @B\n\n *       E@B@UOBr       @B@Bi          L@0PB        .BZ        .@B@B@B@B@B@B@B@B@B@B@B@,   r@  BF @i  @G B@B@B B@\n\n *            7@,      kB@U    ;r        @@@.       .@Z                GBuL@iBBi           vB@B@q BP:5@7 @u,.  @B\n\n *            LBi   YB@BrB@    @@       @B:L@Br      BM             .M@B  rB  rB@J         v@. Pi @XZ8r  .     B@\n\n *        .   G@i B@BM.  ,B@,  @B    iB@B    N, 7r..q@k         ,LB@B8    J@,   i@B@B1r           Br           @@\n\n *        MB@B@B  ,i       B@B@B,    B@:        @B@B@F         .@BB:      P@i      :OBZ          .@U       B@B@B:\n\n *                          .ll                                           rB.                     :\n\n */\n\n/*****************\n\n *   I<3   C++   *\n\n *  IWANT ANYAC  *\n\n * ILOVEPROGRAM! *\n\n *IT'SINTERESTING*\n\n * ILOVEPROGRAM! *\n\n *  INCONTESTS   *\n\n *   GETSCORE    *\n\n *    ACCODE     *\n\n *     LETS      *\n\n *      GO       *\n\n *Written by:    *\n\n *    charlieyan *\n\n *****************/\n\n#include <assert.h>\n\n#include <ctype.h>\n\n#include <errno.h>\n\n#include <float.h>\n\n#include <fstream>\n\n#include <iomanip>\n\n#include <iostream>\n\n#include <limits>\n\n#include <locale>\n\n#include <math.h>\n\n#include <stdio.h>\n\n#include <stdlib.h>\n\n#include <string.h>\n\n#include <time.h>\n\n#include <wchar.h>\n\n#include <wctype.h>\n\n#include <algorithm>\n\n#include <bitset>\n\n#include <cctype>\n\n#include <cerrno>\n\n#include <clocale>\n\n#include <cmath>\n\n#include <complex>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <ctime>\n\n#include <deque>\n\n#include <exception>\n\n#include <fstream>\n\n#include <functional>\n\n#include <limits>\n\n#include <map>\n\n#include <iomanip>\n\n#include <ios>\n\n#include <iosfwd>\n\n#include <istream>\n\n#include <ostream>\n\n#include <queue>\n\n#include <set>\n\n#include <sstream>\n\n#include <stack>\n\n#include <stdexcept>\n\n#include <streambuf>\n\n#include <string>\n\n#include <utility>\n\n#include <vector>\n\n#include <cwchar>\n\n#include <cwctype>\n\n#include <inttypes.h>\n\n#include <stdbool.h>\n\n#include <stdint.h>\n\n#include <tgmath.h>\n\n#include <numeric>\n\n#include <list>\n\n#define LL long long\n\n#define pb push_back\n\n#define pob pop_back\n\n#define mp make_pair\n\n#define FILL(a,v) memset((void*)a,v,sizeof(a))\n\n#define FILL0(a) FILL(a,0)\n\n#define FILL1(a) FILL(a,-1)\n\n#define FILLBIG(a) FILL(a,0x7f)\n\n#define ALL(a) (a).begin(),(a).end()\n\n#define Inf ((int)0x7f7f7f7f)\n\n#define INF ((long long)0x7f7f7f7f7f7f7f7f)\n\n#define Mod 1000000007\n\n#define foreach(it,x) for(__typeof(x.begin()) it=x.begin();it!=x.end();it++)\n\n#define FOR(i,x) for(int i=0;i<x;i++)\n\n#define RFOR(i,x) for(int i=x-1;i>=0;i--)\n\n#define FFOR(i,a,b) for(int i=a;i<b;i++)\n\n#define FRFOR(i,a,b) for(int i=a-1;i>=b;i--)\n\n#define SZ(a) ((int)(a).size())\n\n#define FI first\n\n#define SE second\n\n#define OVER(a) return puts(a),0\n\n#define fastio ios::sync_with_stdio(0)\n\n#define filei(f) freopen(f,\"r\",stdin)\n\n#define fileo(f) freopen(f,\"w\",stdout)\n\n#define eprintf(...) fprintf(stderr,__VA_ARGS__)\n\n#define MASK(a) (1<<(a))\n\n#define MASKX(x,a) ((x)<<(a))\n\n#define BIT(a,b) ((a>>b)&1)\n\n#define cddx(a) priority_queue<a >\n\n#define cxdd(a) priority_queue<a,vector<a >,greater<a > >\n\n#define deval(a) {cerr<<#a<<\" = \"<<a<<endl;}\n\n#define dearr(be,en) {cerr<<#be;cerr<<\" = {\";for(auto i=be;i!=en;i++)cerr<<' '<<*i;cerr<<\" }\\n\";}\n\n#define reg register\n\n#define prtime eprintf(\"\\n\\nTime used: %dms\\n\",clock());\n\n#define PI 3.1415926535897932384626\n\n#define TODEG(a) (a*180/PI)\n\n//\u0421\u043e\u044e\u0437 \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u0438\u0445 \u0441\u043e\u0446\u0438\u0430\u043b\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0440\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\n\n//\u82cf\u7ef4\u57c3\u793e\u4f1a\u4e3b\u4e49\u5171\u548c\u56fd\u8054\u76df\n\nusing namespace std;\n\ntypedef pair<int,int> pii;\n\ntypedef unsigned long long UINT;\n\ntypedef unsigned int uint;\n\ntypedef long long INT;\n\ntypedef long double ldouble;\n\ntypedef pair<INT,INT> PII;\n\ntypedef stringstream sst;\n\ntypedef istringstream iss;\n\ntypedef vector<int> vint;\n\ntypedef vector<INT> VINT;\n\ntypedef vector<pii> vpii;\n\ntypedef vector<PII> VPII;\n\ntypedef priority_queue<int> pqi;\n\ntypedef priority_queue<INT> PQI;\n\ntypedef priority_queue<pii> pqp;\n\ntypedef priority_queue<PII> PQP;\n\ntypedef priority_queue<int,vint,greater<int> > xqi;\n\ntypedef priority_queue<INT,VINT,greater<INT> > XQI;\n\ntypedef priority_queue<pii,vpii,greater<pii> > xqp;\n\ntypedef priority_queue<PII,VPII,greater<PII> > XQP;\n\ninline int read()\n\n{\n\n\tint num=0;\n\n\tchar c=getchar();\n\n\tif(c=='-')return -read();\n\n\twhile(c>='0'&&c<='9')\n\n\t{\n\n\t\tnum=(num<<3)+(num<<1)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\treturn num;\n\n}\n\ninline INT READ()\n\n{\n\n\tINT num=0;\n\n\tchar c=getchar();\n\n\tif(c=='-')return -READ();\n\n\twhile(c>='0'&&c<='9')\n\n\t{\n\n\t\tnum=(num<<3)+(num<<1)+c-'0';\n\n\t\tc=getchar();\n\n\t}\n\n\treturn num;\n\n}\n\n//Coded by Charlieyan\n\n//\u7248\u6743\u6240\u6709\uff0c\u7ffb\u5370\u5fc5\u7a76\n\n\n\nint n;\n\nint dp[2007][2007],dpb[4007][2007],dpw[4007][2007];\n\nchar mode[4007];\n\nint val[4007];\n\nint posb[2007],posw[2007];\n\n\n\nint main()\n\n{\n\n\tscanf(\"%d\",&n);\n\n\tfor(int i=1;i<=2*n;i++)\n\n\t{\n\n\t\tscanf(\" %c %d\",mode+i,val+i);\n\n\t\tif(mode[i]=='B')dpb[i-1][val[i]]++,posb[val[i]]=i;\n\n\t\telse dpw[i-1][val[i]]++,posw[val[i]]=i;\n\n\t}\n\n\tfor(int i=2*n-1;i>=0;i--)\n\n\t\tfor(int j=1;j<=n;j++)\n\n\t\t{\n\n\t\t\tdpb[i][j]+=dpb[i+1][j];\n\n\t\t\tdpw[i][j]+=dpw[i+1][j];\n\n\t\t}\n\n\tfor(int i=0;i<=2*n;i++)\n\n\t\tfor(int j=1;j<=n;j++)\n\n\t\t{\n\n\t\t\tdpb[i][j]+=dpb[i][j-1];\n\n\t\t\tdpw[i][j]+=dpw[i][j-1];\n\n\t\t}\n\n\tdp[0][0]=0;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tdp[i][0]=dp[i-1][0]+(posb[i]-i+dpb[posb[i]][i]+dpw[posb[i]][0]);\n\n\t\tdp[0][i]=dp[0][i-1]+(posw[i]-i+dpb[posw[i]][0]+dpw[posw[i]][i]);\n\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\n\t\tfor(int j=1;j<=n;j++)\n\n\t\t\tdp[i][j]=min(dp[i-1][j]+(posb[i]-i-j+dpb[posb[i]][i]+dpw[posb[i]][j]),dp[i][j-1]+(posw[j]-i-j+dpb[posw[j]][i]+dpw[posw[j]][j]));\n\n\tprintf(\"%d\\n\",dp[n][n]);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <cstring>\n\nusing namespace std;\n\nconst int mx = 2020;\n\nint dp[mx][mx],cw[mx][mx],cb[mx][mx],w[mx],b[mx];\n\nchar col[10];\n\nint main()\n\n{\n\n    int n,a,cont1=1,cont2=1;\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)\n\n        for(int j=1;j<=n;j++)\n\n            dp[i][j]=100000000;\n\n    for(int i=1;i<=2*n;i++){\n\n        scanf(\"%s\",col);\n\n        scanf(\"%d\",&a);\n\n        if(col[0]=='W')\n\n            w[a]=i;\n\n        else\n\n            b[a]=i;\n\n    }\n\n    for(int i=1;i<=n;i++){\n\n        for(int j=1;j<i;j++)\n\n            if(w[j]>w[i])\n\n                cw[i][0]++;\n\n        for(int j=1;j<=n;j++){\n\n            cw[i][j]=cw[i][j-1];\n\n            if(w[i]<b[j])\n\n                cw[i][j]++;\n\n        }\n\n    }\n\n    for(int i=1;i<=n;i++){\n\n        for(int j=1;j<i;j++)\n\n            if(b[j]>b[i])\n\n                cb[0][i]++;\n\n        for(int j=1;j<=n;j++){\n\n            cb[j][i]=cb[j-1][i];\n\n            if(b[i]<w[j])\n\n                cb[j][i]++;\n\n        }\n\n    }\n\n    dp[0][0]=0;\n\n    int c1=0,c2=0;\n\n    for(int i=1;i<=n;i++){\n\n        c1+=cw[i][0];\n\n        c2+=cb[0][i];\n\n        dp[i][0]=c1;\n\n        dp[0][i]=c2;\n\n    }\n\n    for(int i=1;i<=n;i++)\n\n        for(int j=1;j<=n;j++)\n\n            dp[i][j]=min(dp[i-1][j]+cw[i][j],dp[i][j-1]+cb[i][j]);\n\n    printf(\"%d\\n\",dp[n][n]);\n\n    return 0;\n\n}\n"
    },
    {
        "id": "612",
        "source_code": "#include<bits/stdc++.h>\n\n#define F(i,a,b) for(int i=(a);i<=(b);++i)\n\n#define F2(i,a,b) for(int i=(a);i<(b);++i)\n\n#define dF(i,a,b) for(int i=(a);i>=(b);--i)\n\n#define dF2(i,a,b) for(int i=(a);i>(b);--i)\n\n#define dF3(i,a,b) for(int i=(a)-1;i>=(b);--i)\n\nusing namespace std;typedef long long ll;typedef double ld;int INF=0x3f3f3f3f;int INF2=0x7fffffff;ll LNF=0x3f3f3f3f3f3f3f3f;ll LNF2=0x7fffffffffffffff;\n\n\n\nint n;\n\nint t[4001],a[4001];\n\nint b[4001];\n\nint f[2001][2001];\n\nint bit[4001];\n\ninline void Add(int p,int x){for(;p<=n+n;p+=p&-p)bit[p]+=x;}\n\ninline int Qur(int p){int A=0;for(;p;p-=p&-p)A+=bit[p];return A;}\n\n\n\nint main(){ char s[3];\n\n\tscanf(\"%d\",&n);\n\n\tF(i,1,n+n) scanf(\"%s%d\",s,a+i), t[i]=*s=='B', b[t[i]*n+a[i]]=i;\n\n\tf[0][0]=0;\n\n\tF(i,0,n){\n\n\t\tmemset(bit,0,sizeof bit);\n\n\t\tF(j,1,n+n) Add(j,1);\n\n\t\tF(j,1,i) Add(b[j],-1);\n\n\t\tF(j,i?0:1,n){\n\n\t\t\tif(j) Add(b[n+j],-1);\n\n\t\t\tf[i][j]=INF;\n\n\t\t\tif(i) f[i][j]=min(f[i][j],f[i-1][j]+Qur(b[i]));\n\n\t\t\tif(j) f[i][j]=min(f[i][j],f[i][j-1]+Qur(b[n+j]));\n\n\t\t}\n\n\t} printf(\"%d\",f[n][n]);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<cctype>\n\n#include<cmath>\n\n#include<algorithm>\n\n#define reg register\n\n#define max(a,b) (a>b?a:b)\n\n#define min(a,b) (a<b?a:b)\n\ntypedef long long ll;\n\ntemplate<typename T>inline T read(){\n\n    reg T x=0,f=1;reg char ch=getchar();\n\n    for(;!isdigit(ch);f=ch=='-'?-1:1,ch=getchar());\n\n    for(;isdigit(ch);x=(x*10)+(ch^48),ch=getchar());\n\n    return x*f;\n\n}\n\nchar buf[15];\n\ninline void write(int v){\n\n\tif(!v){puts(\"0\");return;}\n\n\treg int cnt=0;\n\n\twhile(v)buf[++cnt]=v%10+'0',v/=10;\n\n\tfor(reg int i=cnt;i;i--)putchar(buf[i]);\n\n\tputchar('\\n');\n\n}\n\nconst int maxn=2005;\n\nconst int inf=0x7fffffff;\n\nint f[maxn][maxn],col[maxn<<1],a[maxn<<1],p[2][maxn],c[2][maxn<<1][maxn];\n\nchar ch[10];\n\nint main(){\n\n\treg int n=read<int>();\n\n\tfor(reg int i=1;i<=n*2;i++){\n\n\t\tscanf(\"%s\",ch);a[i]=read<int>();col[i]=ch[0]=='B'?1:0;\n\n\t\tp[col[i]][a[i]]=i;\n\n\t}\n\n\tfor(reg int i=1;i<=n*2;i++)\n\n\t\tfor(reg int j=0;j<=n;j++)\n\n\t\t\tc[0][i][j]=c[0][i-1][j]+(a[i-1]>j&&!col[i-1]),\n\n\t\t\tc[1][i][j]=c[1][i-1][j]+(a[i-1]>j&&col[i-1]);\n\n\tfor(reg int i=0;i<=n;i++)\n\n\t\tfor(reg int j=0;j<=n;j++){\n\n\t\t\tif(!(i|j))continue;\n\n\t\t\tf[i][j]=inf;\n\n\t\t\tif(i)f[i][j]=min(f[i][j],f[i-1][j]+c[0][p[0][i]][i-1]+c[1][p[0][i]][j]);\n\n\t\t\tif(j)f[i][j]=min(f[i][j],f[i][j-1]+c[1][p[1][j]][j-1]+c[0][p[1][j]][i]);\n\n\t\t}\n\n\twrite(f[n][n]);\n\n    return 0;\n\n}"
    },
    {
        "id": "613",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\nchar op[10];\n\nint n,a[4001];\n\nint b[4001][2],bit[4001];\n\nbool c[4001];\n\nint f[2001][2001];\n\nint Min(int a,int b){\n\n\treturn a<b?a:b;\n\n}\n\nvoid Add(int x,int ad){\n\n\tfor(int i=x;i<=n+n;i+=(i&(-i))) bit[i]+=ad;\n\n\t\n\n}\n\nint query(int x){\n\n\tint sum=0;\n\n\tfor(int i=x;i;i-=(i&(-i))) sum+=bit[i];\n\n\treturn sum;\n\n}\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\tfor(int i=1;i<=n+n;i++){\n\n\t\tscanf(\"%s%d\",op,&a[i]);\n\n\t\tif(op[0]=='W') c[i]=0;else c[i]=1;\n\n\t\tb[a[i]][c[i]]=i;\n\n\t}\n\n\tmemset(f,127/3,sizeof(f));\n\n\tf[0][0]=0;\n\n\tfor(int i=0;i<=n;i++){\n\n\t\tmemset(bit,0,sizeof(bit));\n\n\t\tfor(int j=1;j<=n+n;j++) Add(j,1);\n\n\t\tfor(int j=1;j<=i;j++) Add(b[j][0],-1);\n\n\t\tfor(int j=0;j<=n;j++){\n\n\t\t\tif(j>0) Add(b[j][1],-1);\n\n\t\t\tif(i>0) f[i][j]=Min(f[i][j],f[i-1][j]+query(b[i][0]));\n\n\t\t\tif(j>0) f[i][j]=Min(f[i][j],f[i][j-1]+query(b[j][1]));\n\n\t\t}\n\n\t}\n\n\tprintf(\"%d\",f[n][n]);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,c[4010],a[4010],\n\n    pos[2010],pos1[2010],\n\n    dp[2010][2010],\n\n    cost[4010][2010],cost1[4010][2010];\n\n    \n\n    \n\n    \n\nint main()\n\n{\n\n    \n\n    \n\n    \n\n    //color\n\n    \n\n    scanf(\"%d\",&n);\n\n    for (int i=1;i<=2*n;i++)\n\n    {\n\n        char s;\n\n        cin>>s>>a[i];\n\n        c[i]=(s=='W'?0:1);\n\n        if(c[i]==0) pos[a[i]]=i; else pos1[a[i]]=i;\n\n    }\n\n    \n\n    \n\n    \n\n    \n\n\n\n    \n\n    for (int i=1;i<=2*n;i++) for (int j=0;j<n;j++)\n\n    {\n\n        cost[i][j]=cost[i-1][j]+(a[i-1]>j&&c[i-1]==0);\n\n        cost1[i][j]=cost1[i-1][j]+(a[i-1]>j&&c[i-1]==1);\n\n    }\n\n\n\n\n\n\n\n\n\n    for (int i=0;i<=n;i++) for (int j=0;j<=n;j++)\n\n    {\n\n        if (i==0 &&j==0) continue;\n\n        dp[i][j]=0x3f3f3f3f;\n\n        \n\n        int p=pos[i];\n\n        if (i) dp[i][j] = min(dp[i][j],dp[i-1][j]+cost[p][i-1]+cost1[p][j]);\n\n\n\n\n\n\n\n        int p1=pos1[j];\n\n        if (j) dp[i][j] = min(dp[i][j],dp[i][j-1]+cost1[p1][j-1]+cost[p1][i]);\n\n    }\n\n\n\n\n\n    cout<<dp[n][n]<<endl;\n\n\n\n\n\n    return 0;\n\n}"
    },
    {
        "id": "614",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\nchar op[10];\n\nint n,a[4001];\n\nint b[4001][2],bit[4001];\n\nbool c[4001];\n\nint f[2001][2001];\n\nint Min(int a,int b){\n\n\treturn a<b?a:b;\n\n}\n\nvoid Add(int x,int ad){\n\n\tfor(int i=x;i<=n+n;i+=(i&(-i))) bit[i]+=ad;\n\n\t\n\n}\n\nint query(int x){\n\n\tint sum=0;\n\n\tfor(int i=x;i;i-=(i&(-i))) sum+=bit[i];\n\n\treturn sum;\n\n}\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\tfor(int i=1;i<=n+n;i++){\n\n\t\tscanf(\"%s%d\",op,&a[i]);\n\n\t\tif(op[0]=='W') c[i]=0;else c[i]=1;\n\n\t\tb[a[i]][c[i]]=i;\n\n\t}\n\n\tmemset(f,127/3,sizeof(f));\n\n\tf[0][0]=0;\n\n\tfor(int i=0;i<=n;i++){\n\n\t\tmemset(bit,0,sizeof(bit));\n\n\t\tfor(int j=1;j<=n+n;j++) Add(j,1);\n\n\t\tfor(int j=1;j<=i;j++) Add(b[j][0],-1);\n\n\t\tfor(int j=0;j<=n;j++){\n\n\t\t\tif(j>0) Add(b[j][1],-1);\n\n\t\t\tif(i>0) f[i][j]=Min(f[i][j],f[i-1][j]+query(b[i][0]));\n\n\t\t\tif(j>0) f[i][j]=Min(f[i][j],f[i][j-1]+query(b[j][1]));\n\n\t\t}\n\n\t}\n\n\tprintf(\"%d\",f[n][n]);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef unsigned long long ull;\n\ntypedef pair<int,int> pii;\n\n#define x first\n\n#define y second\n\n#define mp make_pair\n\n#define pb push_back\n\ntemplate <typename TYPE> inline void chkmax(TYPE &x,TYPE y){x<y?x=y:TYPE();}\n\ntemplate <typename TYPE> inline void chkmin(TYPE &x,TYPE y){y<x?x=y:TYPE();}\n\ntemplate <typename TYPE> void readint(TYPE &x)\n\n{\n\n    x=0;int f=1;char c;\n\n    for(c=getchar();!isdigit(c);c=getchar())if(c=='-')f=-1;\n\n    for(;isdigit(c);c=getchar())x=x*10+c-'0';\n\n    x*=f;\n\n}\n\nconst int MAXN=2005;\n\n\n\nint n,a[MAXN*2],col[MAXN*2],pos[2][MAXN],pre[MAXN*2][2][MAXN],f[MAXN][MAXN];\n\n\n\nint main()\n\n{\n\n\tchar str[2];\n\n\treadint(n);\n\n\tfor(int i=1;i<=2*n;++i)\n\n\t\tscanf(\"%s\",str),col[i]=(str[0]=='B'),readint(a[i]),pos[col[i]][a[i]]=i;\n\n\tfor(int i=1;i<=2*n;++i)\n\n\t{\n\n\t\tfor(int j=1;j<=i;++j)++pre[i][col[j]][a[j]];\n\n\t\tfor(int k=0;k<=1;++k)for(int j=1;j<=n;++j)pre[i][k][j]+=pre[i][k][j-1];\n\n\t}\n\n\tfor(int i=1;i<=n;++i)\n\n\t\tf[i][0]=f[i-1][0]+pos[0][i]-pre[pos[0][i]][0][i],\n\n\t\tf[0][i]=f[0][i-1]+pos[1][i]-pre[pos[1][i]][1][i];\n\n\tfor(int i=1;i<=n;++i)\n\n\t\tfor(int j=1;j<=n;++j)\n\n\t\t\tf[i][j]=min(f[i-1][j]+pos[0][i]-pre[pos[0][i]][0][i]-pre[pos[0][i]][1][j],\n\n\t\t\t\tf[i][j-1]+pos[1][j]-pre[pos[1][j]][0][i]-pre[pos[1][j]][1][j]);\n\n\tprintf(\"%d\\n\",f[n][n]);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "615",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\nchar op[10];\n\nint n,a[4001];\n\nint b[4001][2],bit[4001];\n\nbool c[4001];\n\nint f[2001][2001];\n\nint Min(int a,int b){\n\n\treturn a<b?a:b;\n\n}\n\nvoid Add(int x,int ad){\n\n\tfor(int i=x;i<=n+n;i+=(i&(-i))) bit[i]+=ad;\n\n\t\n\n}\n\nint query(int x){\n\n\tint sum=0;\n\n\tfor(int i=x;i;i-=(i&(-i))) sum+=bit[i];\n\n\treturn sum;\n\n}\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\tfor(int i=1;i<=n+n;i++){\n\n\t\tscanf(\"%s%d\",op,&a[i]);\n\n\t\tif(op[0]=='W') c[i]=0;else c[i]=1;\n\n\t\tb[a[i]][c[i]]=i;\n\n\t}\n\n\tmemset(f,127/3,sizeof(f));\n\n\tf[0][0]=0;\n\n\tfor(int i=0;i<=n;i++){\n\n\t\tmemset(bit,0,sizeof(bit));\n\n\t\tfor(int j=1;j<=n+n;j++) Add(j,1);\n\n\t\tfor(int j=1;j<=i;j++) Add(b[j][0],-1);\n\n\t\tfor(int j=0;j<=n;j++){\n\n\t\t\tif(j>0) Add(b[j][1],-1);\n\n\t\t\tif(i>0) f[i][j]=Min(f[i][j],f[i-1][j]+query(b[i][0]));\n\n\t\t\tif(j>0) f[i][j]=Min(f[i][j],f[i][j-1]+query(b[j][1]));\n\n\t\t}\n\n\t}\n\n\tprintf(\"%d\",f[n][n]);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std; \n\n\n\nint n; \n\nint a[4020], c[4020]; \n\nint pw[2020], pb[2020]; \n\nint cw[2020][2020], cb[2020][2020], dp[2020][2020]; \n\n\n\nint main() {\n\n    scanf(\"%d\", &n); \n\n    for (int i = 1; i <= 2 * n; i++) {\n\n        char s[2];\n\n        scanf(\"%s %d\", s, &a[i]); \n\n        if (s[0] == 'W') c[i] = 0, pw[a[i]] = i; \n\n        else c[i] = 1, pb[a[i]] = i; \n\n    }\n\n    for (int i = 1; i <= n; i++) {\n\n        for (int j = 1; j < i; j++) {\n\n            if (pw[i] < pw[j]) {\n\n                cw[i][0]++; \n\n            }\n\n        }\n\n        for (int j = 1; j <= n; j++) {\n\n            cw[i][j] = cw[i][j - 1]; \n\n            if (pw[i] < pb[j]) {\n\n                cw[i][j]++; \n\n            }\n\n        }\n\n    }\n\n    for (int i = 1; i <= n; i++) {\n\n        for (int j = 1; j < i; j++) {\n\n            if (pb[i] < pb[j]) {\n\n                cb[0][i]++;\n\n            }\n\n        }\n\n        for (int j = 1; j <= n; j++) {\n\n            cb[j][i] = cb[j - 1][i]; \n\n            if (pb[i] < pw[j]) {\n\n                cb[j][i]++; \n\n            }\n\n        }\n\n    }\n\n    for (int i = 1; i <= n; i++) {\n\n        dp[i][0] = dp[i - 1][0] + cw[i][0]; \n\n        dp[0][i] = dp[0][i - 1] + cb[0][i]; \n\n    }\n\n    for (int i = 1; i <= n; i++) {\n\n        for (int j = 1; j <= n; j++) {\n\n            dp[i][j] = min(dp[i - 1][j] + cw[i][j], dp[i][j - 1] + cb[i][j]); \n\n        }\n\n    }\n\n    printf(\"%d\\n\", dp[n][n]); \n\n    return 0; \n\n}\n\n//"
    },
    {
        "id": "617",
        "source_code": "#include <iostream>\n\n#include <string>\n\n#include <cmath>\n\n#include<algorithm>\n\n#include<stack>\n\n#include<queue>\n\n#include<map>\n\n#include<set>\n\n#include<iomanip>\n\n#define _USE_MATH_DEFINES\n\n#include <math.h>\n\n#include <functional>\n\n#include<complex>\n\nusing namespace std;\n\n\n\n#define rep(i,x) for(ll i=0;i<x;i++)\n\n#define repn(i,x) for(ll i=1;i<=x;i++)\n\n\n\ntypedef long long ll;\n\nconst ll INF = 1e17;\n\nconst ll MOD = 1000000007;\n\nconst ll MAX = 4000001;\n\nconst long double eps = 1E-14;\n\n\n\nll max(ll a, ll b) {\n\n\tif (a > b) { return a; }\n\n\treturn b;\n\n}\n\n\n\nll min(ll a, ll b) {\n\n\tif (a > b) { return b; }\n\n\treturn a;\n\n}\n\n\n\nll gcd(ll a, ll b) {\n\n\tif (b == 0) { return a; }\n\n\tif (a < b) { return gcd(b, a); }\n\n\treturn gcd(b, a % b);\n\n}\n\n\n\nll lcm(ll a, ll b) {\n\n\treturn a / gcd(a, b) * b;\n\n}\n\n\n\nstruct edge {\n\n\tll ind;\n\n\tll fr;\n\n\tll to;\n\n\tll d;\n\n};\n\n\n\nclass mint {\n\n\tlong long x;\n\npublic:\n\n\tmint(long long x = 0) : x((x% MOD + MOD) % MOD) {}\n\n\tmint operator-() const {\n\n\t\treturn mint(-x);\n\n\t}\n\n\tmint& operator+=(const mint& a) {\n\n\t\tif ((x += a.x) >= MOD) x -= MOD;\n\n\t\treturn *this;\n\n\t}\n\n\tmint& operator-=(const mint& a) {\n\n\t\tif ((x += MOD - a.x) >= MOD) x -= MOD;\n\n\t\treturn *this;\n\n\t}\n\n\tmint& operator*=(const  mint& a) {\n\n\t\t(x *= a.x) %= MOD;\n\n\t\treturn *this;\n\n\t}\n\n\tmint operator+(const mint& a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res += a;\n\n\t}\n\n\tmint operator-(const mint& a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res -= a;\n\n\t}\n\n\tmint operator*(const mint& a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res *= a;\n\n\t}\n\n\n\n\tmint pow(ll t) const {\n\n\t\tif (!t) return 1;\n\n\t\tmint a = pow(t >> 1);\n\n\t\ta *= a;\n\n\t\tif (t & 1) a *= *this;\n\n\t\treturn a;\n\n\t}\n\n\n\n\t// for prime MOD\n\n\tmint inv() const {\n\n\t\treturn pow(MOD - 2);\n\n\t}\n\n\tmint& operator/=(const mint& a) {\n\n\t\treturn (*this) *= a.inv();\n\n\t}\n\n\tmint operator/(const mint& a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res /= a;\n\n\t}\n\n\n\n\tfriend ostream& operator<<(ostream& os, const mint& m) {\n\n\t\tos << m.x;\n\n\t\treturn os;\n\n\t}\n\n};\n\n\n\nmint pw(mint a, ll b) {\n\n\tif (b == 0) { return 1; }\n\n\tmint ret = pw(a, b >> 1);\n\n\tret *= ret;\n\n\tif (b & 1) { ret *= a; }\n\n\treturn ret;\n\n}\n\n\n\ntypedef vector<ll> vll;\n\ntypedef vector<vector<ll>> vvll;\n\ntypedef vector<vector<vector<ll>>> vvvll;\n\n\n\ntypedef vector<mint> vmint;\n\ntypedef vector<vector<mint>> vvmint;\n\ntypedef vector<vector<vector<mint>>> vvvmint;\n\n\n\n//////////////////////////////////////\n\nll D = 365;\n\nll T = 26;//\u30bf\u30a4\u30d7\u6570\n\nvll c(T + 1);\n\nvvll s(D + 1, vll(T + 1));\n\n\n\nvvll last(D + 1,vll(T+1,0));\n\n\n\nll score(vll t) {\n\n\n\n\trepn(i, D) {\n\n\t\trepn(j, T) {\n\n\t\t\tif (t[i] == j) { last[i][j] = i; }\n\n\t\t\telse { last[i][j] = last[i - 1][j]; }\n\n\n\n\t\t\tcout << i << \" \" << j << last[i][j] << endl;\n\n\t\t}\n\n\t}\n\n\n\n\tll ret = 0;\n\n\trepn(i, D) {\n\n\t\tret += s[i][t[i]];\n\n\t\trepn(j, T) {\n\n\t\t\tret -= c[j] * (i - last[i][j]);\n\n\t\t}\n\n\t}\n\n\n\n\treturn ret;\n\n\t\n\n}\n\n\n\n\n\nint main() {\n\n\tcin >> D;\n\n\trepn(i, T) cin >> c[i];\n\n\trepn(i, D)repn(j, T) cin >> s[i][j];\n\n\n\n\tvll ans(D + 1);\n\n\t\n\n\trepn(i, D) {\n\n\t\tll id = 1;\n\n\t\trepn(j, T) {\n\n\t\t\tif (s[i][id] < s[i][j]) { id = j; }\n\n\t\t\t}\n\n\t\tans[i] = id;\n\n\t}\n\n\n\n\trepn(i, D) {\n\n\t\tcout << 1; if (i != D) { cout << endl; }\n\n\t}\n\n\n\n\t//cout << score(ans) << endl;\n\n\t\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <string>\n\n#include <cmath>\n\n#include<algorithm>\n\n#include<stack>\n\n#include<queue>\n\n#include<map>\n\n#include<set>\n\n#include<iomanip>\n\n#define _USE_MATH_DEFINES\n\n#include <math.h>\n\n#include <functional>\n\n#include<complex>\n\nusing namespace std;\n\n\n\n#define rep(i,x) for(ll i=0;i<x;i++)\n\n#define repn(i,x) for(ll i=1;i<=x;i++)\n\n\n\ntypedef long long ll;\n\nconst ll INF = 1e17;\n\nconst ll MOD = 1000000007;\n\nconst ll MAX = 4000001;\n\nconst long double eps = 1E-14;\n\n\n\nll max(ll a, ll b) {\n\n\tif (a > b) { return a; }\n\n\treturn b;\n\n}\n\n\n\nll min(ll a, ll b) {\n\n\tif (a > b) { return b; }\n\n\treturn a;\n\n}\n\n\n\nll gcd(ll a, ll b) {\n\n\tif (b == 0) { return a; }\n\n\tif (a < b) { return gcd(b, a); }\n\n\treturn gcd(b, a % b);\n\n}\n\n\n\nll lcm(ll a, ll b) {\n\n\treturn a / gcd(a, b) * b;\n\n}\n\n\n\nstruct edge {\n\n\tll ind;\n\n\tll fr;\n\n\tll to;\n\n\tll d;\n\n};\n\n\n\nclass mint {\n\n\tlong long x;\n\npublic:\n\n\tmint(long long x = 0) : x((x% MOD + MOD) % MOD) {}\n\n\tmint operator-() const {\n\n\t\treturn mint(-x);\n\n\t}\n\n\tmint& operator+=(const mint& a) {\n\n\t\tif ((x += a.x) >= MOD) x -= MOD;\n\n\t\treturn *this;\n\n\t}\n\n\tmint& operator-=(const mint& a) {\n\n\t\tif ((x += MOD - a.x) >= MOD) x -= MOD;\n\n\t\treturn *this;\n\n\t}\n\n\tmint& operator*=(const  mint& a) {\n\n\t\t(x *= a.x) %= MOD;\n\n\t\treturn *this;\n\n\t}\n\n\tmint operator+(const mint& a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res += a;\n\n\t}\n\n\tmint operator-(const mint& a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res -= a;\n\n\t}\n\n\tmint operator*(const mint& a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res *= a;\n\n\t}\n\n\n\n\tmint pow(ll t) const {\n\n\t\tif (!t) return 1;\n\n\t\tmint a = pow(t >> 1);\n\n\t\ta *= a;\n\n\t\tif (t & 1) a *= *this;\n\n\t\treturn a;\n\n\t}\n\n\n\n\t// for prime MOD\n\n\tmint inv() const {\n\n\t\treturn pow(MOD - 2);\n\n\t}\n\n\tmint& operator/=(const mint& a) {\n\n\t\treturn (*this) *= a.inv();\n\n\t}\n\n\tmint operator/(const mint& a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res /= a;\n\n\t}\n\n\n\n\tfriend ostream& operator<<(ostream& os, const mint& m) {\n\n\t\tos << m.x;\n\n\t\treturn os;\n\n\t}\n\n};\n\n\n\nmint pw(mint a, ll b) {\n\n\tif (b == 0) { return 1; }\n\n\tmint ret = pw(a, b >> 1);\n\n\tret *= ret;\n\n\tif (b & 1) { ret *= a; }\n\n\treturn ret;\n\n}\n\n\n\ntypedef vector<ll> vll;\n\ntypedef vector<vector<ll>> vvll;\n\ntypedef vector<vector<vector<ll>>> vvvll;\n\n\n\ntypedef vector<mint> vmint;\n\ntypedef vector<vector<mint>> vvmint;\n\ntypedef vector<vector<vector<mint>>> vvvmint;\n\n\n\n//////////////////////////////////////\n\n/*\n\nll D = 365;\n\nll T = 26;//\u30bf\u30a4\u30d7\u6570\n\nvll c(T + 1);\n\nvvll s(D + 1, vll(T + 1));\n\n\n\nvvll last(D + 1,vll(T+1,0));\n\n\n\nll score(vll t) {\n\n\n\n\trepn(i, D) {\n\n\t\trepn(j, T) {\n\n\t\t\tif (t[i] == j) { last[i][j] = i; }\n\n\t\t\telse { last[i][j] = last[i - 1][j]; }\n\n\n\n\t\t\tcout << i << \" \" << j << last[i][j] << endl;\n\n\t\t}\n\n\t}\n\n\n\n\tll ret = 0;\n\n\trepn(i, D) {\n\n\t\tret += s[i][t[i]];\n\n\t\trepn(j, T) {\n\n\t\t\tret -= c[j] * (i - last[i][j]);\n\n\t\t}\n\n\t}\n\n\n\n\treturn ret;\n\n\t\n\n}\n\n*/\n\n\n\n\n\nint main() {\n\n\t//cin >> D;\n\n\t//repn(i, T) cin >> c[i];\n\n\t//repn(i, D)repn(j, T) cin >> s[i][j];\n\n\n\n\t//vll ans(D + 1);\n\n\t\n\n\t//repn(i, D) {\n\n\t\t//ll id = 1;\n\n\t\t//repn(j, T) {\n\n\t\t\t//if (s[i][id] < s[i][j]) { id = j; }\n\n\t\t\t//}\n\n\t\t//ans[i] = id;\n\n\t//}\n\n\n\n\t//repn(i, D) {\n\n\t\t//cout << 1; if (i != D) { cout << endl; }\n\n\t//}\n\n\n\n\trepn(i, 365) { cout << 1 << endl; }\n\n\n\n\t//cout << score(ans) << endl;\n\n\t\n\n}"
    },
    {
        "id": "618",
        "source_code": "#define _CRT_SECURE_NO_WARNINGS\n\n#include<stdio.h>\n\n#include<vector>\n\n#include<functional>\n\n#include<algorithm>\n\n#include<stdlib.h>\n\n#include<string>\n\n#include<string.h>\n\n#define _USE_MATH_DEFINES\n\n#include<math.h>\n\n#include<deque>\n\n#include<set>\n\n#include<map>\n\n#include<queue>\n\n#include<list>\n\n#include<iostream>\n\n#include <bitset>\n\nusing namespace std;\n\ntypedef long long ll;\n\n#define rep(i,a,b) for(auto i=a;i<b;i++)\n\n#define all(_x) _x.begin(), _x.end()\n\n#define r_sort(_x) sort(_x.begin(), _x.end(), std::greater<int>())\n\n#define vec_cnt(_a, _n) (upper_bound(all(_a), _n) - lower_bound(all(_a), _n))\n\n#define vec_unique(_a) _a.erase(std::unique(all(_a)), _a.end());\n\n#define vvec vector<vector<ll>>\n\nll gcd(ll a, ll b) { return a % b == 0 ? b : gcd(b, a % b); }\n\nll lcm(ll a, ll b) { return (a / gcd(a, b)) * b; }\n\n#define INF 1 << 30\n\nconst int mod = 1000000007;\n\nll power(ll x, ll p) { ll a = 1; while (p > 0) { if (p % 2 == 0) { x *= x; p /= 2; } else { a *= x; p--; } }return a; }\n\nll mpower(ll x, ll p) { ll a = 1; while (p > 0) { if (p % 2 == 0) { x = x * x % mod; p /= 2; } else { a = a * x % mod; p--; } }return a; }\n\nll ac(ll n, ll k) { ll a = 1; rep(i, 1, k) { a *= n - i + 1; a /= i; }return a; }\n\nll mc(ll n, ll m) { ll k = 1, l = 1; rep(i, n - m + 1, n + 1) k = k * i % mod; rep(i, 1, m + 1) l = l * i % mod; l = mpower(l, mod - 2); return k * l % mod; }\n\nint D;\n\nvector<int> c(26);\n\nvector<int> last(26, 0);\n\nvector<vector<int>> s(365, vector<int>(26));\n\nvoid input();\n\nll score;\n\nint next_num;\n\nvoid dfs(int nest, int d) {\n\n\tll M = 0, temp = score;\n\n\tint prev, n;\n\n\trep(j, 0, 26) {\n\n\t\tscore = temp;\n\n\t\tscore += s[d - 1][j];\n\n\t\tprev = last[j];\n\n\t\tlast[j] = d;\n\n\t\trep(k, 0, 26)score -= c[k] * (d - last[k]);\n\n\t\tif (nest && d < D)dfs(nest - 1, d + 1);\n\n\t\tif (M < score)M = score, n = j;\n\n\t\tlast[j] = prev;\n\n\t\t//printf(\"%lld %d\\n\", *score, *next);\n\n\t}\n\n\tscore = M;\n\n\tnext_num = n;\n\n}\n\nint main()\n\n{\n\n\tinput();\n\n\trep(i, 1, D + 1) {\n\n\t\t//score = 0;\n\n\t\tdfs(2, i);\n\n\t\tprintf(\"%d\\n\", next_num + 1);\n\n\t\t//printf(\"%d\\n\", score);\n\n\t}\n\n\treturn 0;\n\n}\n\nvoid input() {\n\n\tcin >> D;\n\n\trep(i, 0, 26)cin >> c[i];\n\n\trep(i, 0, D) {\n\n\t\trep(i2, 0, 26)cin >> s[i][i2];\n\n\t}\n\n}\n",
        "optimized_code": "#define _CRT_SECURE_NO_WARNINGS\n\n#include<stdio.h>\n\n#include<vector>\n\n#include<functional>\n\n#include<algorithm>\n\n#include<stdlib.h>\n\n#include<string>\n\n#include<string.h>\n\n#define _USE_MATH_DEFINES\n\n#include<math.h>\n\n#include<deque>\n\n#include<set>\n\n#include<map>\n\n#include<queue>\n\n#include<list>\n\n#include<iostream>\n\n#include <bitset>\n\nusing namespace std;\n\ntypedef long long ll;\n\n#define rep(i,a,b) for(auto i=a;i<b;i++)\n\n#define all(_x) _x.begin(), _x.end()\n\n#define r_sort(_x) sort(_x.begin(), _x.end(), std::greater<int>())\n\n#define vec_cnt(_a, _n) (upper_bound(all(_a), _n) - lower_bound(all(_a), _n))\n\n#define vec_unique(_a) _a.erase(std::unique(all(_a)), _a.end());\n\n#define vvec vector<vector<ll>>\n\nll gcd(ll a, ll b) { return a % b == 0 ? b : gcd(b, a % b); }\n\nll lcm(ll a, ll b) { return (a / gcd(a, b)) * b; }\n\n#define INF 1 << 30\n\nconst int mod = 1000000007;\n\nll power(ll x, ll p) { ll a = 1; while (p > 0) { if (p % 2 == 0) { x *= x; p /= 2; } else { a *= x; p--; } }return a; }\n\nll mpower(ll x, ll p) { ll a = 1; while (p > 0) { if (p % 2 == 0) { x = x * x % mod; p /= 2; } else { a = a * x % mod; p--; } }return a; }\n\nll ac(ll n, ll k) { ll a = 1; rep(i, 1, k) { a *= n - i + 1; a /= i; }return a; }\n\nll mc(ll n, ll m) { ll k = 1, l = 1; rep(i, n - m + 1, n + 1) k = k * i % mod; rep(i, 1, m + 1) l = l * i % mod; l = mpower(l, mod - 2); return k * l % mod; }\n\nint D;\n\nvector<int> c(26);\n\nvector<int> last(26, 0);\n\nvector<vector<int>> s(365, vector<int>(26));\n\nvoid input();\n\nint score;\n\nint next_num;\n\nconst int Way = 26;\n\nconst int Nest = 0;\n\n/*void dfs(int nest, int d) {\n\n\tint M = 0, temp = score;\n\n\tint prev, n;\n\n\tvector<pair<int, int>> kouho(26);\n\n\trep(j, 0, 26) {\n\n\t\tscore = temp;\n\n\t\tscore += s[d - 1][j];\n\n\t\tprev = last[j];\n\n\t\tlast[j] = d;\n\n\t\trep(k, 0, 26)score -= c[k] * (d - last[k]);\n\n\t\tkouho[j].first = score;\n\n\t\tkouho[j].second = j;\n\n\t\tlast[j] = prev;\n\n\t}\n\n\t//sort(all(kouho), greater<pair<int, int>>());\n\n\trep(j, 0, Way) {\n\n\t\t//prev = last[kouho[j].second];\n\n\t\t//last[kouho[j].second] = d;\n\n\t\tscore = kouho[j].first;\n\n\t\tif (nest && d < D)dfs(nest - 1, d + 1);\n\n\t\tif (M < score)M = score, n = kouho[j].second;\n\n\t\tprintf(\"j:%2d score:%d\\n\", j, score);\n\n\t\t//last[kouho[j].second] = prev;\n\n\t}\n\n\tscore = M;\n\n\tnext_num = n;\n\n}*/\n\nint main()\n\n{\n\n\tinput();\n\n\t/*rep(i, 1, D + 1) {\n\n\t\t//score = 0;\n\n\t\tdfs(Nest, i);\n\n\t\tprintf(\"%d\\n\", next_num + 1);\n\n\t\tlast[next_num] = i;\n\n\t\tprintf(\"%d\\n\", score);\n\n\t}*/\n\n\tll score = 0, M = 0, temp;\n\n\tint prev, p;\n\n\trep(i, 1, D + 1) {\n\n\t\tM = 0;\n\n\t\ttemp = score;\n\n\t\trep(j, 0, 26) {\n\n\t\t\tscore = temp + s[i - 1][j];\n\n\t\t\tprev = last[j];\n\n\t\t\tlast[j] = i;\n\n\t\t\trep(k, 0, 26)score -= c[k] * (i - last[k]);\n\n\t\t\tlast[j] = prev;\n\n\t\t\tif (M < score)M = score, p = j;\n\n\t\t}\n\n\t\tlast[p] = i;\n\n\t\tscore = M;\n\n\t\tprintf(\"%d\\n\", p + 1);\n\n\t\t//printf(\"%d\\n\", score);\n\n\t}\n\n\treturn 0;\n\n}\n\nvoid input() {\n\n\tcin >> D;\n\n\trep(i, 0, 26)cin >> c[i];\n\n\trep(i, 0, D) {\n\n\t\trep(i2, 0, 26)cin >> s[i][i2];\n\n\t}\n\n}"
    },
    {
        "id": "619",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#ifdef LOCAL\n\n#include \"dump.hpp\"\n\n#else\n\n#define dump(...)\n\n#define dumpv(...)\n\n#endif\n\n\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define mins(x, y) (x = min(x, y))\n\n#define maxs(x, y) (x = max(x, y))\n\nusing ll = long long;\n\nusing vi = vector<int>;\n\nusing vl = vector<ll>;\n\nusing vvi = vector<vi>;\n\nusing vvl = vector<vl>;\n\nusing P = pair<ll, int>;\n\nconst int MOD = 1e9 + 7;\n\nconst int INF = 1001001001;\n\nconst ll LINF = 1001002003004005006ll;\n\n\n\nvoid solve() {\n\n  int d, n;\n\n  n = 26;\n\n  cin >> d;\n\n  vi c(n);\n\n  rep(i, n) cin >> c[i];\n\n  vvi s(d, vi(n));\n\n  rep(i, d) rep(j, n) cin >> s[i][j];\n\n  vi l(n, -1);\n\n  vector<vector<P>> g(d, vector<P>(n));\n\n  vi ans(d);\n\n  rep(i, d) {\n\n    rep(j, n) {\n\n      g[i][j].first = s[i][j];\n\n      g[i][j].second = j;\n\n      rep(k, n) {\n\n        if (j != k) g[i][j].first -= (ll)c[k] * (i - l[k]);\n\n      }\n\n    }\n\n    sort(g[i].rbegin(), g[i].rend());\n\n    // dump(g[i]);\n\n    int mi = g[i][0].second;\n\n    l[mi] = i;\n\n    ans[i] = mi;\n\n  }\n\n  auto score = [&] (vi& sel) {\n\n    ll sc = 0;\n\n    l.assign(n, -1);\n\n    rep(i, d) {\n\n      sc += s[i][sel[i]];\n\n      l[sel[i]] = i;\n\n      rep(k, n) sc -= (ll)c[k] * (i - l[k]);\n\n    }\n\n    return sc;\n\n  };\n\n  ll msc = score(ans);\n\n  dump(msc, ans);\n\n  rep(k, 20) {\n\n    rep(i, d) {\n\n      for (int j = 1; j < n; j++) {\n\n        vi sel = ans;\n\n        sel[i] = g[i][j].second;\n\n        ll ss = score(sel);\n\n        dump(i, ss, sel);\n\n        if (msc < ss) {\n\n          ans = sel;\n\n          msc = ss;\n\n        }\n\n      }\n\n    }\n\n  }\n\n  rep(i, d) cout << ans[i] + 1 << endl;\n\n}\n\n\n\nint main() {\n\n  cin.tie(0);\n\n  ios::sync_with_stdio(false);\n\n  cout << fixed << setprecision(15);\n\n  // freopen(\"temp.1\", \"r\", stdin);\n\n  solve();\n\n  return 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#ifdef LOCAL\n\n#include \"dump.hpp\"\n\n#else\n\n#define dump(...)\n\n#define dumpv(...)\n\n#endif\n\n\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n\n#define mins(x, y) (x = min(x, y))\n\n#define maxs(x, y) (x = max(x, y))\n\nusing ll = long long;\n\nusing vi = vector<int>;\n\nusing vl = vector<ll>;\n\nusing vvi = vector<vi>;\n\nusing vvl = vector<vl>;\n\nusing P = pair<ll, int>;\n\nconst int MOD = 1e9 + 7;\n\nconst int INF = 1001001001;\n\nconst ll LINF = 1001002003004005006ll;\n\n\n\nvoid solve() {\n\n  int d, n;\n\n  n = 26;\n\n  cin >> d;\n\n  vi c(n);\n\n  rep(i, n) cin >> c[i];\n\n  vvi s(d, vi(n));\n\n  rep(i, d) rep(j, n) cin >> s[i][j];\n\n  vi l(n, -1);\n\n  vector<vector<P>> g(d, vector<P>(n));\n\n  vi ans(d);\n\n  rep(i, d) {\n\n    rep(j, n) {\n\n      g[i][j].first = s[i][j];\n\n      g[i][j].second = j;\n\n      rep(k, n) {\n\n        if (j != k) g[i][j].first -= (ll)c[k] * (i - l[k]);\n\n      }\n\n    }\n\n    sort(g[i].rbegin(), g[i].rend());\n\n    // dump(g[i]);\n\n    int mi = g[i][0].second;\n\n    l[mi] = i;\n\n    ans[i] = mi;\n\n  }\n\n  auto score = [&] (vi& sel) {\n\n    ll sc = 0;\n\n    l.assign(n, -1);\n\n    rep(i, d) {\n\n      sc += s[i][sel[i]];\n\n      l[sel[i]] = i;\n\n      rep(k, n) sc -= (ll)c[k] * (i - l[k]);\n\n    }\n\n    return sc;\n\n  };\n\n  ll msc = score(ans);\n\n  dump(msc);\n\n  rep(k, 5) {\n\n    rep(i, d) {\n\n      int ix = i;\n\n      for (int j = 1; j < n; j++) {\n\n        vi sel = ans;\n\n        sel[ix] = g[ix][j].second;\n\n        ll ss = score(sel);\n\n        // dump(i, ss, sel);\n\n        if (msc < ss) {\n\n          ans = sel;\n\n          msc = ss;\n\n        }\n\n      }\n\n    }\n\n    dump(k, msc);\n\n  }\n\n  rep(i, d) {\n\n    int j = ans[i];\n\n    g[i][j].first = s[i][j];\n\n    g[i][j].second = j;\n\n    rep(k, n) {\n\n      if (j != k) g[i][j].first -= (ll)c[k] * (i - l[k]);\n\n    }\n\n    sort(g[i].rbegin(), g[i].rend());\n\n  }\n\n  rep(k, 3) {\n\n    rep(i, d) {\n\n      int ix = i;\n\n      for (int j = 1; j < 5; j++) {\n\n        vi sel = ans;\n\n        sel[ix] = g[ix][j].second;\n\n        ll ss = score(sel);\n\n        // dump(i, ss, sel);\n\n        if (msc < ss) {\n\n          ans = sel;\n\n          msc = ss;\n\n        }\n\n      }\n\n    }\n\n    dump(k, msc);\n\n  }\n\n  rep(i, d) cout << ans[i] + 1 << endl;\n\n  dump(msc);\n\n}\n\n\n\nint main() {\n\n  cin.tie(0);\n\n  ios::sync_with_stdio(false);\n\n  cout << fixed << setprecision(15);\n\n  // freopen(\"temp.1\", \"r\", stdin);\n\n  solve();\n\n  return 0;\n\n}"
    },
    {
        "id": "620",
        "source_code": "#include<iostream>\n\n#include<vector>\n\n#include<algorithm>\n\n#include<cstdlib>\n\nusing namespace std;\n\n\n\n\n\nstatic const int D=365;\n\nstatic const int ntype=26;\n\n\n\nclass Contest{\n\npublic:\n\n    Contest(){\n\n        last=0;\n\n    }\n\n    int s[D+1];\n\n    int c;\n\n    int last;\n\n};\n\n\n\nContest contest[27];\n\n\n\nvoid Input(){\n\n    int d;\n\n    cin>>d;\n\n    for(int i=1;i<=ntype;++i){\n\n        int t;\n\n        cin>>t;\n\n        contest[i].c=t;\n\n    }\n\n    for(int day=1;day<=D;++day){\n\n        for(int type=1;type<=ntype;++type){\n\n            int t;\n\n            cin>>t;\n\n            contest[type].s[day]=t;\n\n        }\n\n    }\n\n}\n\n\n\nint v[D+1];\n\n\n\nint gene[50][D+1];\n\nint next_gene[50][D+1];\n\nint elete[D+1];\n\nvector<pair<double,int>> cumfreq;\n\n\n\nvoid randGene(int i){\n\n    for(int day=1;day<=D;++day){\n\n        gene[i][day]=rand()%26+1;\n\n    }\n\n}\n\n\n\nvoid Init(){\n\n    for(int i=0;i<50;++i){\n\n        randGene(i);\n\n    }\n\n}\n\n\n\nvoid Greedy(){\n\n    vector<int> l(ntype+1,0);\n\n      int score=0;\n\n    for(int d=1;d<=D;++d){\n\n        for(int i=1;i<=ntype;++i) score-=contest[i].c*(d-l[i]);\n\n        int temp=score;\n\n        int t=-1;\n\n        for(int i=1;i<=ntype;++i){\n\n            int k=contest[i].s[d]+contest[i].c*(d-l[i])+score;\n\n            if(k>temp){\n\n                temp=k;\n\n                t=i;\n\n            }\n\n        }\n\n        gene[0][d]=t;\n\n        l[t]=d;\n\n        score+=temp;\n\n    }\n\n}\n\n\n\nvoid decoding(int i){\n\n    v[0]=0;\n\n    for(int day=1;day<=D;++day){\n\n        v[day]=0;\n\n        int type=gene[i][day];\n\n        v[day]+=contest[type].s[day];\n\n        contest[type].last=day;\n\n        for(int t=1;t<=ntype;++t){\n\n            v[day]-=contest[t].c*(day-contest[t].last);\n\n        }\n\n        v[day]+=v[day-1];\n\n    }\n\n    v[D]=v[D]<0?1:v[D];\n\n    cumfreq.push_back(make_pair((double)v[D],i));   \n\n}\n\n\n\nvoid CrossOver(int ni, int ci, int cj){\n\n    for(int i=1;i<=D;++i){\n\n        double p=rand()/RAND_MAX;\n\n        if(p>0.5) next_gene[ni][i]=gene[ci][i];\n\n        else next_gene[ni][i]=gene[cj][i];\n\n    }\n\n}\n\n\n\nvoid Mutation(int i){\n\n    /*cout<<i<<endl;\n\n    reverse(next_gene+i+1,next_gene+i+D+1);\n\n    cout<<\"mutation\"<<endl;*/\n\n    int tgene[D+1];\n\n    for(int d=1;d<=D;++d) tgene[d]=next_gene[i][d];\n\n    for(int d=1;d<=D;++d) next_gene[i][d]=tgene[D-d+1];\n\n}\n\n\n\nvoid calcCumFreq(){\n\n    double sum=0;\n\n    for(int i=0;i<50;++i){\n\n        sum+=cumfreq[i].first;\n\n    }\n\n    for(int i=0;i<50;++i){\n\n        cumfreq[i].first/=sum;\n\n    }\n\n    sort(cumfreq.begin(),cumfreq.end());\n\n    for(int i=0;i<49;++i){\n\n        cumfreq[i+1].first+=cumfreq[i].first;\n\n    }\n\n}\n\n\n\nint Select(){\n\n    double a=(double)rand()/RAND_MAX;\n\n    for(int i=0;i<49;++i){\n\n        if(cumfreq[i+1].first>a) return cumfreq[i].second;\n\n    }\n\n    return cumfreq[49].second;\n\n}\n\n\n\nvoid GA(){\n\n    static const double crossRate=0.3;\n\n    static const double mutationRate=0.05;  \n\n    for(int i=0;i<50;++i){\n\n        int pi=Select();\n\n        double crossrand=(double)rand()/RAND_MAX;\n\n        if(crossrand<crossRate){\n\n            int pj=Select();\n\n            CrossOver(i,pi,pj);\n\n        }\n\n        else{\n\n            for(int j=1;j<=D;++j) next_gene[i][j]=gene[pi][j];\n\n        }\n\n        double murand=(double)rand()/RAND_MAX;\n\n        if(murand<mutationRate){\n\n            Mutation(i);\n\n        }\n\n    }\n\n    cumfreq.resize(0);\n\n    for(int i=0;i<50;++i){\n\n        for(int j=1;j<=D;++j){\n\n            gene[i][j]=next_gene[i][j];\n\n        }\n\n        decoding(i);\n\n    }\n\n    calcCumFreq();\n\n}\n\n\n\nint main(){\n\n    srand(700);\n\n    Input();\n\n    Init();\n\n    Greedy();\n\n    /*\n\n    for(int i=0;i<50;++i){\n\n        decoding(i);\n\n    }\n\n    calcCumFreq();\n\n    for(int i=0;i<3000;++i){\n\n        GA();\n\n    }\n\n    for(int i=0;i<50;++i){\n\n        decoding(i);\n\n    }\n\n    calcCumFreq();\n\n    sort(cumfreq.begin(),cumfreq.end());\n\n    int e=cumfreq[49].second;\n\n    \n\n    for(int i=1;i<=D;++i) cout<<gene[e][i]<<endl;  \n\n    */\n\n   for(int i=1;i<=D;++i) cout<<gene[0][i]<<endl;\n\n} ",
        "optimized_code": "#include<iostream>\n\n#include<vector>\n\n#include<algorithm>\n\n#include<cstdlib>\n\nusing namespace std;\n\n#define INF 1e9\n\n\n\nstatic const int D=365;\n\nstatic const int ntype=26;\n\n\n\nclass Contest{\n\npublic:\n\n    Contest(){\n\n        last=0;\n\n    }\n\n    int s[D+1];\n\n    int c;\n\n    int last;\n\n};\n\n\n\nContest contest[ntype+1];\n\n\n\nvoid Input(){\n\n    int d;\n\n    cin>>d;\n\n    for(int i=1;i<=ntype;++i){\n\n        int t;\n\n        cin>>t;\n\n        contest[i].c=t;\n\n    }\n\n    for(int day=1;day<=D;++day){\n\n        for(int type=1;type<=ntype;++type){\n\n            int t;\n\n            cin>>t;\n\n            contest[type].s[day]=t;\n\n        }\n\n    }\n\n}\n\n\n\n\n\nvoid Greedy(){\n\n    vector<int> l(ntype+1,0);\n\n    for(int d=1;d<=D;++d){\n\n        long long score=0;\n\n        for(int i=1;i<=ntype;++i) score-=contest[i].c*(d-l[i]);\n\n        long long temp=-INF;\n\n        int t=-1;\n\n        for(int i=1;i<=ntype;++i){\n\n            long long k=contest[i].s[d]+contest[i].c*(d-l[i])+score;\n\n            if(k>temp){\n\n                temp=k;\n\n                t=i;\n\n            }\n\n        }\n\n        l[t]=d;\n\n        cout<<t<<endl;\n\n    }\n\n}\n\nint main(){\n\n    Input();\n\n    Greedy();\n\n};"
    },
    {
        "id": "621",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n\nusing ld = long double;\n\nusing vl = vector<ll>;\n\nusing vll = vector<vl>;\n\nusing Pll = pair<ll, ll>;\n\n#define rep(i,n) for(ll i=0;i<(ll)(n);i++)\n\n#define all(v) v.begin(), v.end()\n\n#define sz(x) ((int) x.size())\n\n#define pb push_back\n\n#define mp make_pair\n\n#define mt make_tuple\n\n#define F first\n\n#define S second\n\nconst int MOD = 1e9+7;\n\nconst ll INF = 2e15;\n\ntemplate<class T> void print(const T& t){ cout << t << endl; }\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\n\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n\nint gcd(int a,int b){return b?gcd(b,a%b):a;}\n\n\n\nint main(){\n\n  ll d;\n\n  cin>>d;\n\n  vl c(26);\n\n  rep(i,26){\n\n    cin >> c[i];\n\n  }\n\n  vll s(d, vl(26));\n\n  rep(i, 365){\n\n    rep(j,26){\n\n      cin >> s[i][j];\n\n    }\n\n  }\n\n  rep(i, d){\n\n    ll num = i % 26;\n\n    if(num==0){\n\n      num = 26;\n\n    }\n\n    print(num);\n\n  }\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n\nusing ld = long double;\n\nusing vl = vector<ll>;\n\nusing vll = vector<vl>;\n\nusing Pll = pair<ll, ll>;\n\n#define rep(i,n) for(ll i=0;i<(ll)(n);i++)\n\n#define all(v) v.begin(), v.end()\n\n#define sz(x) ((int) x.size())\n\n#define pb push_back\n\n#define mp make_pair\n\n#define mt make_tuple\n\n#define F first\n\n#define S second\n\nconst int MOD = 1e9+7;\n\nconst ll INF = 2e15;\n\ntemplate<class T> void print(const T& t){ cout << t << endl; }\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\n\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n\nint gcd(int a,int b){return b?gcd(b,a%b):a;}\n\n\n\nll evaluate(int contest,int date,vector<ll>&last,vector<ll>&c,vll&s){\n\n  ll point_today = 0;\n\n  point_today += s[date][contest];\n\n  ll minus = 0;\n\n  for (ll j=1; j <= 26;j++){\n\n    minus += c[contest] * (date - last[contest]);\n\n  }\n\n  return point_today;\n\n}\n\n\n\nint main(){\n\n  ll d;\n\n  cin >> d;\n\n  vl c(27);\n\n  for(ll i=1;i<=26;i++){\n\n    cin >> c[i];\n\n  }\n\n  vll s(d + 1, vl(27));\n\n  for (ll i = 1; i <= d;i++){\n\n    for (ll j = 1; j <= 26;j++){\n\n      cin >> s[i][j];\n\n    }\n\n  }\n\n  vl t;\n\n  vl last(27, 0);\n\n  ll satisfy = 0;\n\n  for (ll date = 1; date <= d;date++){\n\n    priority_queue<pair<ll, int>> q;\n\n    for (ll contest = 1; contest <= 26;contest++){\n\n      q.push(mp(evaluate(contest, date, last,c,s), contest));\n\n    }\n\n    t.pb(q.top().S);\n\n    satisfy += q.top().F;\n\n    last[q.top().S] = date;\n\n  }\n\n  rep(i,d){\n\n    print(t[i]);\n\n  }\n\n}"
    },
    {
        "id": "622",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n\nusing ld = long double;\n\nusing vl = vector<ll>;\n\nusing vll = vector<vl>;\n\nusing Pll = pair<ll, ll>;\n\n#define rep(i,n) for(ll i=0;i<(ll)(n);i++)\n\n#define all(v) v.begin(), v.end()\n\n#define sz(x) ((int) x.size())\n\n#define pb push_back\n\n#define mp make_pair\n\n#define mt make_tuple\n\n#define F first\n\n#define S second\n\nconst int MOD = 1e9+7;\n\nconst ll INF = 2e15;\n\ntemplate<class T> void print(const T& t){ cout << t << endl; }\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\n\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n\nint gcd(int a,int b){return b?gcd(b,a%b):a;}\n\n\n\nint main(){\n\n  ll d;\n\n  cin>>d;\n\n  vl c(26);\n\n  rep(i,26){\n\n    cin >> c[i];\n\n  }\n\n  vll s(d, vl(26));\n\n  rep(i, 365){\n\n    rep(j,26){\n\n      cin >> s[i][j];\n\n    }\n\n  }\n\n  rep(i, d){\n\n    ll num = i % 26;\n\n    if(num==0){\n\n      num = 26;\n\n    }\n\n    print(num);\n\n  }\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n\nusing ld = long double;\n\nusing vl = vector<ll>;\n\nusing vll = vector<vl>;\n\nusing Pll = pair<ll, ll>;\n\n#define rep(i,n) for(ll i=0;i<(ll)(n);i++)\n\n#define all(v) v.begin(), v.end()\n\n#define sz(x) ((int) x.size())\n\n#define pb push_back\n\n#define mp make_pair\n\n#define mt make_tuple\n\n#define F first\n\n#define S second\n\nconst int MOD = 1e9+7;\n\nconst ll INF = 2e15;\n\ntemplate<class T> void print(const T& t){ cout << t << endl; }\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\n\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n\nint gcd(int a,int b){return b?gcd(b,a%b):a;}\n\n\n\nll evaluate(int contest,int date,vector<ll>&last,vector<ll>&c,vll&s){\n\n  ll point_today = 0;\n\n  point_today += s[date][contest];\n\n  ll minus = 0;\n\n  for (ll j=1; j <= 26;j++){\n\n    minus += c[contest] * (date - last[contest]);\n\n  }\n\n  point_today -= minus;\n\n  return point_today;\n\n}\n\n\n\nint main(){\n\n  ll d;\n\n  cin >> d;//\u5168\u65e5\u6570\n\n  vl c(27);\n\n  for(ll i=1;i<=26;i++){//c_i==c[i]\n\n    cin >> c[i];\n\n  }\n\n  vll s(d + 1, vl(27)); //s_d,i==s[d][i]\n\n  for (ll i = 1; i <= d; i++){\n\n    for (ll j = 1; j <= 26;j++){\n\n      cin >> s[i][j];\n\n    }\n\n  }\n\n  vl t;\n\n  vl last(27, 0);//last(d,i)==last[i]\n\n  //ll satisfy = 0;\n\n  for (ll date = 1; date <= d;date++){\n\n    priority_queue<pair<ll, int>> q;\n\n    for (ll contest = 1; contest <= 26;contest++){\n\n      q.push(mp(evaluate(contest, date, last,c,s), contest));\n\n    }\n\n    t.pb(q.top().S);\n\n    //satisfy += q.top().F;\n\n    last[q.top().S] = date;\n\n  }\n\n  rep(i,d){\n\n    print(t[i]);\n\n  }\n\n}"
    },
    {
        "id": "623",
        "source_code": "#include<iostream>\n\n#include<string>\n\n#include<iomanip>\n\n#include<cmath>\n\n#include<vector>\n\n#include<algorithm>\n\n#include<utility>\n\n#include<cstdlib>\n\n#include<ctime>\n\n\n\nusing namespace std;\n\n\n\n#define int long long\n\n#define endl \"\\n\"\n\n\n\nconstexpr long long INF = (long long)1e18;\n\nconstexpr long long MOD = 1'000'000'007; \n\n\n\n// struct fast_io {\n\n\t// fast_io(){\n\n\t\t// std::cin.tie(nullptr);\n\n\t\t// std::ios::sync_with_stdio(false);\n\n\t// };\n\n// } fio;\n\n\n\nconstexpr int num = 26;\n\nint D;\n\nvector<int> c(num);\n\n\n\nvector<vector<int>> s; \n\n\n\nint point(vector<int> &t){\n\n\tint res = 0;\n\n\t\n\n\tvector<int> last(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tres += s[i][t[i]];\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tlast[j]++;\n\n\t\t}\n\n\t\t\n\n\t\tlast[t[i]] = 0;\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tres -= c[j] * last[j];\n\n\t\t}\n\n\t}\n\n\t\n\n\treturn res + 1'000'000;\n\n}\n\n\n\nvector<int> solve(int Z){\n\n\tvector<int> t(D);\n\n\tvector<int> con(num);\n\n\tvector<int> last(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\t\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tcin>>s[i][j];\n\n\t\t\t\n\n\t\t\tif(s[i][t[i]] + last[t[i]] * last[t[i]]/Z * c[t[i]] < s[i][j] + last[j] * last[j]/Z * c[j]) {\n\n\t\t\t\t\n\n\t\t\t\t\n\n\t\t\t\tt[i] = j;\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tif(j == t[i]) {\n\n\t\t\t\tlast[j] = 0;\n\n\t\t\t} else {\n\n\t\t\t\tlast[j]++;\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tcon[t[i]]++;\n\n\t}\n\n\t\n\n\treturn t;\n\n}\n\n\n\nvector<int> t;\n\nint p;\n\n\n\nvoid change(int U){\n\n\tvector<int> con1(D), con2(D), con(D);\n\n\tvector<int> last(num);\n\n\tvector<int> nt(t);\n\n\t\n\n\tvector<pair<int,int>> s;\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tif(t[i] == U) con1[i] = 0;\n\n\t\telse if(i) con1[i] = con1[i-1] + 1;\n\n\t\telse con1[i] = 1;\n\n\t\t\n\n\t\t// s.push_back({con1[i], i});\n\n\t}\n\n\t\n\n\tfor(int i = D-1; i >= 0; i--){\n\n\t\tif(t[i] == U) con2[i] = 0;\n\n\t\telse if(i+1!=D) con2[i] = con2[i+1] + 1;\n\n\t\telse con2[i] = 1;\n\n\t}\n\n\t\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\ts.push_back({min(con1[i], con2[i]), i});\n\n\t}\n\n\t\n\n\t// cout<<\"U = \"<<U<<endl;\n\n\t\n\n\tsort(s.begin(), s.end(), greater<pair<int,int>>());\n\n\t\n\n\tfor(int i = 0; i < s.size(); i++){//cout<<\"i = \"<<i<<endl;\n\n\t\tnt[s[i].second] = U;\n\n\t\t// cout<<s[i].second<<\" \"<<s[i].first<<endl;\n\n\t\t\n\n\t\tint np = point(nt);\n\n\t\t\n\n\t\tif(p < np) {\n\n\t\t\tt = nt;\n\n\t\t\tp = np;\n\n\t\t}\n\n\t}\n\n}\n\n\n\nvector<pair<int,int>> con(vector<int> &t){\n\n\tvector<pair<int,int>> con(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tcon[t[i]].first++;\n\n\t}\n\n\t\n\n\tfor(int i = 0; i < num; i++){\n\n\t\t// cout<<i<<\" \"<<con[i].first<<endl;\n\n\t\tcon[i].second = i;\n\n\t}\n\n\t\n\n\tsort(con.begin(), con.end());\n\n\t\n\n\treturn con;\n\n}\n\n\n\nsigned main(){\n\n\tcout<<fixed<<setprecision(10);\n\n\t\n\n\t// vector<int> t;\n\n\t// srand(time(NULL));\n\n\t\n\n\tcin>>D;\n\n\t\n\n\t// D = 365;\n\n\t\n\n\ts.resize(D, vector<int>(num));\n\n\tt.resize(D, 0);\n\n\t\n\n\tfor(int i = 0; i < num; i++){\n\n\t\tcin>>c[i];\n\n\t\t// c[i] = rand()%100;\n\n\t}\n\n\t\n\n\t// int p;\n\n\t\n\n\tp = 0;\n\n\t// cout<<1<<\" \"<<p<<endl;\n\n\t\n\n\tfor(int i = 1; i <= 20; i++){\n\n\t\tvector<int> nt;\n\n\t\t\n\n\t\tnt = solve(i);\n\n\t\tint np = point(nt);\n\n\t\t\n\n\t\tif(p < np) {\n\n\t\t\tt = nt;\n\n\t\t\tp = np;\n\n\t\t}\n\n\t}\n\n\t\n\n\tvector<pair<int,int>> c = con(t);\n\n\t\n\n\tfor(int i = 0; i < c.size(); i++){//cout<<i<<endl;\n\n\t\t// int x = rand()%num, np;\n\n\t\t// int x = i%num;\n\n\t\tint x = c[i].second;\n\n\t\tint tx;\n\n\t\tvector<int> nt;\n\n\t\t\n\n\t\tchange(x);\n\n\n\n\t\t\n\n\t}\n\n\t\n\n\tcon(t);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tcout<<t[i]+1<<endl;\n\n\t}\n\n\t\n\n\t// cout<<point(t)<<endl;\n\n\t\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<string>\n\n#include<iomanip>\n\n#include<cmath>\n\n#include<vector>\n\n#include<algorithm>\n\n#include<utility>\n\n#include<cstdlib>\n\n#include<ctime>\n\n\n\nusing namespace std;\n\n\n\n#define int long long\n\n#define endl \"\\n\"\n\n\n\nconstexpr long long INF = (long long)1e18;\n\nconstexpr long long MOD = 1'000'000'007; \n\n\n\nstruct fast_io {\n\n\tfast_io(){\n\n\t\tstd::cin.tie(nullptr);\n\n\t\tstd::ios::sync_with_stdio(false);\n\n\t};\n\n} fio;\n\n\n\nconstexpr int num = 26;\n\nint D;\n\nvector<int> c(num);\n\n\n\nvector<vector<int>> s; \n\n\n\nint point(vector<int> &t){\n\n\tint res = 0;\n\n\t\n\n\tvector<int> last(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tres += s[i][t[i]];\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tlast[j]++;\n\n\t\t}\n\n\t\t\n\n\t\tlast[t[i]] = 0;\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tres -= c[j] * last[j];\n\n\t\t}\n\n\t}\n\n\t\n\n\treturn res + 1'000'000;\n\n}\n\n\n\nvector<int> solve(int Z){\n\n\tvector<int> t(D);\n\n\t\n\n\tvector<int> last(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tcin>>s[i][j];\n\n\t\t\tif(s[i][t[i]] + last[t[i]] * last[t[i]]/Z * c[t[i]] < s[i][j] + last[j] * last[j]/Z * c[j]) {\n\n\t\t\t\tt[i] = j;\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tif(j == t[i]) {\n\n\t\t\t\tlast[j] = 0;\n\n\t\t\t} else {\n\n\t\t\t\tlast[j]++;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t\n\n\treturn t;\n\n}\n\n\n\nsigned main(){\n\n\tcout<<fixed<<setprecision(10);\n\n\t\n\n\tvector<int> t;\n\n\t\n\n\t\n\n\tcin>>D;\n\n\t\n\n\ts.resize(D, vector<int>(num));\n\n\tt.resize(D, 0);\n\n\t\n\n\tfor(int i = 0; i < num; i++){\n\n\t\tcin>>c[i];\n\n\t}\n\n\t\n\n\tint p = 0;\n\n\t\n\n\tfor(int i = 1; i < 10; i++){\n\n\t\tvector<int> nt;\n\n\t\t\n\n\t\tnt = solve(i);\n\n\t\tint np = point(nt);\n\n\t\t\n\n\t\tif(p < np) {\n\n\t\t\tt = nt;\n\n\t\t\tp = np;\n\n\t\t}\n\n\t}\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tcout<<t[i]+1<<endl;\n\n\t}\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "624",
        "source_code": "#include<iostream>\n\n#include<string>\n\n#include<iomanip>\n\n#include<cmath>\n\n#include<vector>\n\n#include<algorithm>\n\n#include<utility>\n\n#include<cstdlib>\n\n#include<ctime>\n\n\n\nusing namespace std;\n\n\n\n#define int long long\n\n#define endl \"\\n\"\n\n\n\nconstexpr long long INF = (long long)1e18;\n\nconstexpr long long MOD = 1'000'000'007; \n\n\n\n// struct fast_io {\n\n\t// fast_io(){\n\n\t\t// std::cin.tie(nullptr);\n\n\t\t// std::ios::sync_with_stdio(false);\n\n\t// };\n\n// } fio;\n\n\n\nconstexpr int num = 26;\n\nint D;\n\nvector<int> c(num);\n\n\n\nvector<vector<int>> s; \n\n\n\nint point(vector<int> &t){\n\n\tint res = 0;\n\n\t\n\n\tvector<int> last(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tres += s[i][t[i]];\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tlast[j]++;\n\n\t\t}\n\n\t\t\n\n\t\tlast[t[i]] = 0;\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tres -= c[j] * last[j];\n\n\t\t}\n\n\t}\n\n\t\n\n\treturn res + 1'000'000;\n\n}\n\n\n\nvector<int> solve(int Z){\n\n\tvector<int> t(D);\n\n\tvector<int> con(num);\n\n\tvector<int> last(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\t\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tcin>>s[i][j];\n\n\t\t\t\n\n\t\t\tif(s[i][t[i]] + last[t[i]] * last[t[i]]/Z * c[t[i]] < s[i][j] + last[j] * last[j]/Z * c[j]) {\n\n\t\t\t\t\n\n\t\t\t\t\n\n\t\t\t\tt[i] = j;\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tif(j == t[i]) {\n\n\t\t\t\tlast[j] = 0;\n\n\t\t\t} else {\n\n\t\t\t\tlast[j]++;\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tcon[t[i]]++;\n\n\t}\n\n\t\n\n\treturn t;\n\n}\n\n\n\nvector<int> t;\n\nint p;\n\n\n\nvoid change(int U){\n\n\tvector<int> con1(D), con2(D), con(D);\n\n\tvector<int> last(num);\n\n\tvector<int> nt(t);\n\n\t\n\n\tvector<pair<int,int>> s;\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tif(t[i] == U) con1[i] = 0;\n\n\t\telse if(i) con1[i] = con1[i-1] + 1;\n\n\t\telse con1[i] = 1;\n\n\t\t\n\n\t\t// s.push_back({con1[i], i});\n\n\t}\n\n\t\n\n\tfor(int i = D-1; i >= 0; i--){\n\n\t\tif(t[i] == U) con2[i] = 0;\n\n\t\telse if(i+1!=D) con2[i] = con2[i+1] + 1;\n\n\t\telse con2[i] = 1;\n\n\t}\n\n\t\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\ts.push_back({min(con1[i], con2[i]), i});\n\n\t}\n\n\t\n\n\t// cout<<\"U = \"<<U<<endl;\n\n\t\n\n\tsort(s.begin(), s.end(), greater<pair<int,int>>());\n\n\t\n\n\tfor(int i = 0; i < s.size(); i++){//cout<<\"i = \"<<i<<endl;\n\n\t\tnt[s[i].second] = U;\n\n\t\t// cout<<s[i].second<<\" \"<<s[i].first<<endl;\n\n\t\t\n\n\t\tint np = point(nt);\n\n\t\t\n\n\t\tif(p < np) {\n\n\t\t\tt = nt;\n\n\t\t\tp = np;\n\n\t\t}\n\n\t}\n\n}\n\n\n\nvector<pair<int,int>> con(vector<int> &t){\n\n\tvector<pair<int,int>> con(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tcon[t[i]].first++;\n\n\t}\n\n\t\n\n\tfor(int i = 0; i < num; i++){\n\n\t\t// cout<<i<<\" \"<<con[i].first<<endl;\n\n\t\tcon[i].second = i;\n\n\t}\n\n\t\n\n\tsort(con.begin(), con.end());\n\n\t\n\n\treturn con;\n\n}\n\n\n\nsigned main(){\n\n\tcout<<fixed<<setprecision(10);\n\n\t\n\n\t// vector<int> t;\n\n\t// srand(time(NULL));\n\n\t\n\n\tcin>>D;\n\n\t\n\n\t// D = 365;\n\n\t\n\n\ts.resize(D, vector<int>(num));\n\n\tt.resize(D, 0);\n\n\t\n\n\tfor(int i = 0; i < num; i++){\n\n\t\tcin>>c[i];\n\n\t\t// c[i] = rand()%100;\n\n\t}\n\n\t\n\n\t// int p;\n\n\t\n\n\tp = 0;\n\n\t// cout<<1<<\" \"<<p<<endl;\n\n\t\n\n\tfor(int i = 1; i <= 20; i++){\n\n\t\tvector<int> nt;\n\n\t\t\n\n\t\tnt = solve(i);\n\n\t\tint np = point(nt);\n\n\t\t\n\n\t\tif(p < np) {\n\n\t\t\tt = nt;\n\n\t\t\tp = np;\n\n\t\t}\n\n\t}\n\n\t\n\n\tvector<pair<int,int>> c = con(t);\n\n\t\n\n\tfor(int i = 0; i < c.size(); i++){//cout<<i<<endl;\n\n\t\t// int x = rand()%num, np;\n\n\t\t// int x = i%num;\n\n\t\tint x = c[i].second;\n\n\t\tint tx;\n\n\t\tvector<int> nt;\n\n\t\t\n\n\t\tchange(x);\n\n\n\n\t\t\n\n\t}\n\n\t\n\n\tcon(t);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tcout<<t[i]+1<<endl;\n\n\t}\n\n\t\n\n\t// cout<<point(t)<<endl;\n\n\t\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<string>\n\n#include<iomanip>\n\n#include<cmath>\n\n#include<vector>\n\n#include<algorithm>\n\n#include<utility>\n\n#include<cstdlib>\n\n#include<ctime>\n\n\n\nusing namespace std;\n\n\n\n#define int long long\n\n#define endl \"\\n\"\n\n\n\nconstexpr long long INF = (long long)1e18;\n\nconstexpr long long MOD = 1'000'000'007; \n\n\n\nstruct fast_io {\n\n\tfast_io(){\n\n\t\tstd::cin.tie(nullptr);\n\n\t\tstd::ios::sync_with_stdio(false);\n\n\t};\n\n} fio;\n\n\n\nconstexpr int num = 26;\n\nint D;\n\nvector<int> c(num);\n\n\n\nvector<vector<int>> s; \n\n\n\nint point(vector<int> &t){\n\n\tint res = 0;\n\n\t\n\n\tvector<int> last(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tres += s[i][t[i]];\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tlast[j]++;\n\n\t\t}\n\n\t\t\n\n\t\tlast[t[i]] = 0;\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tres -= c[j] * last[j];\n\n\t\t}\n\n\t}\n\n\t\n\n\treturn res + 1'000'000;\n\n}\n\n\n\nvector<int> solve(int Z){\n\n\tvector<int> t(D);\n\n\t\n\n\tvector<int> last(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tcin>>s[i][j];\n\n\t\t\tif(s[i][t[i]] + last[t[i]] * last[t[i]]/Z * c[t[i]] < s[i][j] + last[j] * last[j]/Z * c[j]) {\n\n\t\t\t\tt[i] = j;\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tif(j == t[i]) {\n\n\t\t\t\tlast[j] = 0;\n\n\t\t\t} else {\n\n\t\t\t\tlast[j]++;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t\n\n\treturn t;\n\n}\n\n\n\nsigned main(){\n\n\tcout<<fixed<<setprecision(10);\n\n\t\n\n\tvector<int> t;\n\n\t\n\n\t\n\n\tcin>>D;\n\n\t\n\n\ts.resize(D, vector<int>(num));\n\n\tt.resize(D, 0);\n\n\t\n\n\tfor(int i = 0; i < num; i++){\n\n\t\tcin>>c[i];\n\n\t}\n\n\t\n\n\tint p = 0;\n\n\t\n\n\t// for(int i = 1; i < 10; i++){\n\n\t\t// vector<int> nt;\n\n\t\t\n\n\t\t// nt = solve(i);\n\n\t\t// int np = point(nt);\n\n\t\t\n\n\t\t// if(p < np) {\n\n\t\t\t// t = nt;\n\n\t\t\t// p = np;\n\n\t\t// }\n\n\t// }\n\n\n\n\tt = solve(5);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tcout<<t[i]+1<<endl;\n\n\t}\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "625",
        "source_code": "#include<iostream>\n\n#include<string>\n\n#include<iomanip>\n\n#include<cmath>\n\n#include<vector>\n\n#include<algorithm>\n\n#include<utility>\n\n#include<cstdlib>\n\n#include<ctime>\n\n\n\nusing namespace std;\n\n\n\n#define int long long\n\n#define endl \"\\n\"\n\n\n\nconstexpr long long INF = (long long)1e18;\n\nconstexpr long long MOD = 1'000'000'007; \n\n\n\n// struct fast_io {\n\n\t// fast_io(){\n\n\t\t// std::cin.tie(nullptr);\n\n\t\t// std::ios::sync_with_stdio(false);\n\n\t// };\n\n// } fio;\n\n\n\nconstexpr int num = 26;\n\nint D;\n\nvector<int> c(num);\n\n\n\nvector<vector<int>> s; \n\n\n\nint point(vector<int> &t){\n\n\tint res = 0;\n\n\t\n\n\tvector<int> last(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tres += s[i][t[i]];\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tlast[j]++;\n\n\t\t}\n\n\t\t\n\n\t\tlast[t[i]] = 0;\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tres -= c[j] * last[j];\n\n\t\t}\n\n\t}\n\n\t\n\n\treturn res + 1'000'000;\n\n}\n\n\n\nvector<int> solve(int Z){\n\n\tvector<int> t(D);\n\n\tvector<int> con(num);\n\n\tvector<int> last(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\t\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tcin>>s[i][j];\n\n\t\t\t\n\n\t\t\tif(s[i][t[i]] + last[t[i]] * last[t[i]]/Z * c[t[i]] < s[i][j] + last[j] * last[j]/Z * c[j]) {\n\n\t\t\t\t\n\n\t\t\t\t\n\n\t\t\t\tt[i] = j;\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tif(j == t[i]) {\n\n\t\t\t\tlast[j] = 0;\n\n\t\t\t} else {\n\n\t\t\t\tlast[j]++;\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tcon[t[i]]++;\n\n\t}\n\n\t\n\n\treturn t;\n\n}\n\n\n\nvector<int> t;\n\nint p;\n\n\n\nvoid change(int U){\n\n\tvector<int> con1(D), con2(D), con(D);\n\n\tvector<int> last(num);\n\n\tvector<int> nt(t);\n\n\t\n\n\tvector<pair<int,int>> s;\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tif(t[i] == U) con1[i] = 0;\n\n\t\telse if(i) con1[i] = con1[i-1] + 1;\n\n\t\telse con1[i] = 1;\n\n\t\t\n\n\t\t// s.push_back({con1[i], i});\n\n\t}\n\n\t\n\n\tfor(int i = D-1; i >= 0; i--){\n\n\t\tif(t[i] == U) con2[i] = 0;\n\n\t\telse if(i+1!=D) con2[i] = con2[i+1] + 1;\n\n\t\telse con2[i] = 1;\n\n\t}\n\n\t\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\ts.push_back({min(con1[i], con2[i]), i});\n\n\t}\n\n\t\n\n\t// cout<<\"U = \"<<U<<endl;\n\n\t\n\n\tsort(s.begin(), s.end(), greater<pair<int,int>>());\n\n\t\n\n\tfor(int i = 0; i < s.size(); i++){//cout<<\"i = \"<<i<<endl;\n\n\t\tnt[s[i].second] = U;\n\n\t\t// cout<<s[i].second<<\" \"<<s[i].first<<endl;\n\n\t\t\n\n\t\tint np = point(nt);\n\n\t\t\n\n\t\tif(p < np) {\n\n\t\t\tt = nt;\n\n\t\t\tp = np;\n\n\t\t}\n\n\t}\n\n}\n\n\n\nvector<pair<int,int>> con(vector<int> &t){\n\n\tvector<pair<int,int>> con(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tcon[t[i]].first++;\n\n\t}\n\n\t\n\n\tfor(int i = 0; i < num; i++){\n\n\t\t// cout<<i<<\" \"<<con[i].first<<endl;\n\n\t\tcon[i].second = i;\n\n\t}\n\n\t\n\n\tsort(con.begin(), con.end());\n\n\t\n\n\treturn con;\n\n}\n\n\n\nsigned main(){\n\n\tcout<<fixed<<setprecision(10);\n\n\t\n\n\t// vector<int> t;\n\n\t// srand(time(NULL));\n\n\t\n\n\tcin>>D;\n\n\t\n\n\t// D = 365;\n\n\t\n\n\ts.resize(D, vector<int>(num));\n\n\tt.resize(D, 0);\n\n\t\n\n\tfor(int i = 0; i < num; i++){\n\n\t\tcin>>c[i];\n\n\t\t// c[i] = rand()%100;\n\n\t}\n\n\t\n\n\t// int p;\n\n\t\n\n\tp = 0;\n\n\t// cout<<1<<\" \"<<p<<endl;\n\n\t\n\n\tfor(int i = 1; i <= 20; i++){\n\n\t\tvector<int> nt;\n\n\t\t\n\n\t\tnt = solve(i);\n\n\t\tint np = point(nt);\n\n\t\t\n\n\t\tif(p < np) {\n\n\t\t\tt = nt;\n\n\t\t\tp = np;\n\n\t\t}\n\n\t}\n\n\t\n\n\tvector<pair<int,int>> c = con(t);\n\n\t\n\n\tfor(int i = 0; i < c.size(); i++){//cout<<i<<endl;\n\n\t\t// int x = rand()%num, np;\n\n\t\t// int x = i%num;\n\n\t\tint x = c[i].second;\n\n\t\tint tx;\n\n\t\tvector<int> nt;\n\n\t\t\n\n\t\tchange(x);\n\n\n\n\t\t\n\n\t}\n\n\t\n\n\tcon(t);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tcout<<t[i]+1<<endl;\n\n\t}\n\n\t\n\n\t// cout<<point(t)<<endl;\n\n\t\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<string>\n\n#include<iomanip>\n\n#include<cmath>\n\n#include<vector>\n\n#include<algorithm>\n\n#include<utility>\n\n#include<cstdlib>\n\n#include<ctime>\n\n\n\nusing namespace std;\n\n\n\n#define int long long\n\n#define endl \"\\n\"\n\n\n\nconstexpr long long INF = (long long)1e18;\n\nconstexpr long long MOD = 1'000'000'007; \n\n\n\nstruct fast_io {\n\n\tfast_io(){\n\n\t\tstd::cin.tie(nullptr);\n\n\t\tstd::ios::sync_with_stdio(false);\n\n\t};\n\n} fio;\n\n\n\nconstexpr int num = 26;\n\nint D;\n\nvector<int> c(num);\n\n\n\nvector<vector<int>> s; \n\n\n\nint point(vector<int> &t){\n\n\tint res = 0;\n\n\t\n\n\tvector<int> last(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tres += s[i][t[i]];\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tlast[j]++;\n\n\t\t}\n\n\t\t\n\n\t\tlast[t[i]] = 0;\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tres -= c[j] * last[j];\n\n\t\t}\n\n\t}\n\n\t\n\n\treturn res + 1'000'000;\n\n}\n\n\n\nvector<int> solve(int Z){\n\n\tvector<int> t(D);\n\n\t\n\n\tvector<int> last(num);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tcin>>s[i][j];\n\n\t\t\tif(s[i][t[i]] + last[t[i]] * last[t[i]]/Z * c[t[i]] < s[i][j] + last[j] * last[j]/Z * c[j]) {\n\n\t\t\t\tt[i] = j;\n\n\t\t\t}\n\n\t\t}\n\n\t\t\n\n\t\tfor(int j = 0; j < num; j++){\n\n\t\t\tif(j == t[i]) {\n\n\t\t\t\tlast[j] = 0;\n\n\t\t\t} else {\n\n\t\t\t\tlast[j]++;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t\n\n\treturn t;\n\n}\n\n\n\nsigned main(){\n\n\tcout<<fixed<<setprecision(10);\n\n\t\n\n\tvector<int> t;\n\n\t\n\n\t\n\n\tcin>>D;\n\n\t\n\n\ts.resize(D, vector<int>(num));\n\n\tt.resize(D, 0);\n\n\t\n\n\tfor(int i = 0; i < num; i++){\n\n\t\tcin>>c[i];\n\n\t}\n\n\t\n\n\tint p = 0;\n\n\t\n\n\t// for(int i = 1; i < 10; i++){\n\n\t\t// vector<int> nt;\n\n\t\t\n\n\t\t// nt = solve(i);\n\n\t\t// int np = point(nt);\n\n\t\t\n\n\t\t// if(p < np) {\n\n\t\t\t// t = nt;\n\n\t\t\t// p = np;\n\n\t\t// }\n\n\t// }\n\n\n\n\tt = solve(1);\n\n\t\n\n\tfor(int i = 0; i < D; i++){\n\n\t\tcout<<t[i]+1<<endl;\n\n\t}\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "626",
        "source_code": "#include<iostream>\n\n#include<set>\n\n#include<vector>\n\n#include<array>\n\n#include<algorithm>\n\n#include<chrono>\n\n\n\nint const INF = 1e9;\n\n\n\nuint64_t xor64(void) {\n\n  static uint64_t x = 88172645463325252ULL;\n\n  x = x ^ (x << 7);\n\n  return x = x ^ (x >> 9);\n\n}\n\n\n\nauto b_cl = std::chrono::system_clock::now();\n\ninline double get_time() {\n\n  auto e_cl = std::chrono::system_clock::now();\n\n  double msec = std::chrono::duration_cast<std::chrono::milliseconds>(e_cl - b_cl).count();\n\n  return msec;\n\n}\n\n\n\nint main() {\n\n  std::cin.tie(0); std::ios::sync_with_stdio(false);\n\n  int D; std::cin >> D;\n\n  int c[26];\n\n  for(auto& ci: c) std::cin >> ci;\n\n  std::vector<std::array<int,26>> s(D);\n\n  for(int d = 0; d < D; ++d) {\n\n    for(auto& si: s[d]) std::cin >> si;\n\n  }\n\n  std::vector<int> t(D), bestT(D);\n\n  int ans = -INF;\n\n  //std::set<int> last[26];\n\n  //for(auto& li: last) li.insert(-1); // sentinel\n\n  int ansa[27];\n\n  for(int k = 0; k <= 26; ++k) {\n\n    ansa[k] = 0;\n\n    int las[26];\n\n    std::fill_n(las, 26, -1);\n\n    for(int d = 0; d < D; ++d) {\n\n      int ma = -INF, tt = -1;\n\n      for(int T = 0; T < 26; ++T) {\n\n        int cur = s[d][T];\n\n        int sv = las[T];\n\n        las[T] = d;\n\n        for(int dd = d; dd <= d+k && dd < D; ++dd) {\n\n          for(int cx = 0; cx < 26; ++cx) {\n\n            cur -= c[cx]*(dd - las[cx]);\n\n          }\n\n        }\n\n        las[T] = sv;\n\n        if(cur > ma) { ma = cur; tt = T; }\n\n      }\n\n      las[tt] = d;\n\n      t[d] = tt;\n\n      ansa[k] += s[d][tt];\n\n      for(int cx = 0; cx < 26; ++cx) {\n\n        ansa[k] -= c[cx]*(d - las[cx]);\n\n      }\n\n    }\n\n    if(ansa[k] > ans) {\n\n      ans = ansa[k];\n\n      std::copy(t.begin(), t.end(), bestT.begin());\n\n    }\n\n  }\n\n  std::copy(bestT.begin(), bestT.end(), t.begin());\n\n  //for(auto& li: last) li.insert(D); // sentinel\n\n#if 0  \n\n  // additional score when t[d] = i compare to t[d] = -1\n\n  auto sum_up = [](int d) { return d*(d-1)/2; };\n\n  auto score = [&](int d, int i)->int {\n\n    int res = s[d][i];\n\n    auto it = last[i].lower_bound(d);\n\n    int nd = *it;\n\n    int pd = *--it;\n\n    int diff = sum_up(d-pd) + sum_up(nd-d) - sum_up(nd-pd);\n\n    res -= c[i]*diff;\n\n    return res;\n\n  };\n\n  int lm = 0, renew = 0;\n\n  int sc[26];\n\n  auto one_day = [&](int d) {\n\n    int pi = t[d];\n\n    last[pi].erase(d);\n\n    for(int i = 0; i < 26; ++i) sc[i] = score(d, i);\n\n    int mi = std::max_element(sc, sc+26) - sc;\n\n    if(mi != pi) {\n\n      ans += sc[mi] - sc[pi];\n\n      ++renew;\n\n    }\n\n    last[mi].insert(d);\n\n  };\n\n  \n\n  // hill climbing\n\n  int range = 50;\n\n  for(int rep = 0;; ++rep) {\n\n    if((xor64()>>25)%2) {\n\n      one_day(xor64()%365);\n\n    } else {\n\n      // swap\n\n      int d1 = xor64()%D, d2 = xor64()%D;\n\n      while(d1 < d2-range || d2 < d1-range || t[d1] == t[d2]) {\n\n          d1 = xor64()%D; d2 = xor64()%D;\n\n      }\n\n      int pi1 = t[d1], pi2 = t[d2];\n\n      last[pi1].erase(d1);\n\n      int diff = score(d1, pi2) - score(d1, pi1);\n\n      last[pi2].insert(d1);\n\n      last[pi2].erase(d2);\n\n      diff += score(d2, pi1) - score(d2, pi2);\n\n      if(diff > 0) {\n\n        last[pi1].insert(d2);\n\n        t[d1] = pi2;\n\n        t[d2] = pi1;\n\n        lm = 0;\n\n      } else {\n\n        last[pi2].insert(d2);\n\n        last[pi2].erase(d1);\n\n        last[pi1].insert(d1);\n\n      }\n\n    }\n\n    if(rep%100 == 0) {\n\n      int x = get_time();\n\n      if(x > 1950) break;\n\n    }\n\n  }\n\n#endif\n\n  for(auto ti: t) std::cout << ti+1 << \"\\n\";\n\n  return 0;\n\n}\n",
        "optimized_code": "#include<iostream>\n\n#include<set>\n\n#include<vector>\n\n#include<array>\n\n#include<algorithm>\n\n#include<chrono>\n\n\n\nint const INF = 1e9;\n\n\n\nuint64_t xor64(void) {\n\n  static uint64_t x = 88172645463325252ULL;\n\n  x = x ^ (x << 7);\n\n  return x = x ^ (x >> 9);\n\n}\n\n\n\nauto b_cl = std::chrono::system_clock::now();\n\ninline double get_time() {\n\n  auto e_cl = std::chrono::system_clock::now();\n\n  double msec = std::chrono::duration_cast<std::chrono::milliseconds>(e_cl - b_cl).count();\n\n  return msec;\n\n}\n\n\n\nint main() {\n\n  std::cin.tie(0); std::ios::sync_with_stdio(false);\n\n  int D; std::cin >> D;\n\n  int c[26];\n\n  for(auto& ci: c) std::cin >> ci;\n\n  std::vector<std::array<int,26>> s(D);\n\n  for(int d = 0; d < D; ++d) {\n\n    for(auto& si: s[d]) std::cin >> si;\n\n  }\n\n  std::vector<int> t(D), bestT(D);\n\n  int ans = -INF;\n\n  //std::set<int> last[26];\n\n  //for(auto& li: last) li.insert(-1); // sentinel\n\n  int ansa[27];\n\n  for(int k = 0; k <= 6; ++k) {\n\n    ansa[k] = 0;\n\n    int las[26];\n\n    std::fill_n(las, 26, -1);\n\n    for(int d = 0; d < D; ++d) {\n\n      int ma = -INF, tt = -1;\n\n      for(int T = 0; T < 26; ++T) {\n\n        int cur = s[d][T];\n\n        int sv = las[T];\n\n        las[T] = d;\n\n        for(int dd = d; dd <= d+k && dd < D; ++dd) {\n\n          for(int cx = 0; cx < 26; ++cx) {\n\n            cur -= c[cx]*(dd - las[cx]);\n\n          }\n\n        }\n\n        las[T] = sv;\n\n        if(cur > ma) { ma = cur; tt = T; }\n\n      }\n\n      las[tt] = d;\n\n      t[d] = tt;\n\n      ansa[k] += s[d][tt];\n\n      for(int cx = 0; cx < 26; ++cx) {\n\n        ansa[k] -= c[cx]*(d - las[cx]);\n\n      }\n\n    }\n\n    if(ansa[k] > ans) {\n\n      ans = ansa[k];\n\n      std::copy(t.begin(), t.end(), bestT.begin());\n\n    }\n\n  }\n\n  std::copy(bestT.begin(), bestT.end(), t.begin());\n\n  //for(auto& li: last) li.insert(D); // sentinel\n\n#if 0  \n\n  // additional score when t[d] = i compare to t[d] = -1\n\n  auto sum_up = [](int d) { return d*(d-1)/2; };\n\n  auto score = [&](int d, int i)->int {\n\n    int res = s[d][i];\n\n    auto it = last[i].lower_bound(d);\n\n    int nd = *it;\n\n    int pd = *--it;\n\n    int diff = sum_up(d-pd) + sum_up(nd-d) - sum_up(nd-pd);\n\n    res -= c[i]*diff;\n\n    return res;\n\n  };\n\n  int lm = 0, renew = 0;\n\n  int sc[26];\n\n  auto one_day = [&](int d) {\n\n    int pi = t[d];\n\n    last[pi].erase(d);\n\n    for(int i = 0; i < 26; ++i) sc[i] = score(d, i);\n\n    int mi = std::max_element(sc, sc+26) - sc;\n\n    if(mi != pi) {\n\n      ans += sc[mi] - sc[pi];\n\n      ++renew;\n\n    }\n\n    last[mi].insert(d);\n\n  };\n\n  \n\n  // hill climbing\n\n  int range = 50;\n\n  for(int rep = 0;; ++rep) {\n\n    if((xor64()>>25)%2) {\n\n      one_day(xor64()%365);\n\n    } else {\n\n      // swap\n\n      int d1 = xor64()%D, d2 = xor64()%D;\n\n      while(d1 < d2-range || d2 < d1-range || t[d1] == t[d2]) {\n\n          d1 = xor64()%D; d2 = xor64()%D;\n\n      }\n\n      int pi1 = t[d1], pi2 = t[d2];\n\n      last[pi1].erase(d1);\n\n      int diff = score(d1, pi2) - score(d1, pi1);\n\n      last[pi2].insert(d1);\n\n      last[pi2].erase(d2);\n\n      diff += score(d2, pi1) - score(d2, pi2);\n\n      if(diff > 0) {\n\n        last[pi1].insert(d2);\n\n        t[d1] = pi2;\n\n        t[d2] = pi1;\n\n        lm = 0;\n\n      } else {\n\n        last[pi2].insert(d2);\n\n        last[pi2].erase(d1);\n\n        last[pi1].insert(d1);\n\n      }\n\n    }\n\n    if(rep%100 == 0) {\n\n      int x = get_time();\n\n      if(x > 1950) break;\n\n    }\n\n  }\n\n#endif\n\n  for(auto ti: t) std::cout << ti+1 << \"\\n\";\n\n  return 0;\n\n}\n"
    },
    {
        "id": "627",
        "source_code": "#include<iostream>\n\n#include<set>\n\n#include<vector>\n\n#include<array>\n\n#include<algorithm>\n\n#include<chrono>\n\n\n\nint const INF = 1e9;\n\n\n\nuint64_t xor64(void) {\n\n  static uint64_t x = 88172645463325252ULL;\n\n  x = x ^ (x << 7);\n\n  return x = x ^ (x >> 9);\n\n}\n\n\n\nauto b_cl = std::chrono::system_clock::now();\n\ninline double get_time() {\n\n  auto e_cl = std::chrono::system_clock::now();\n\n  double msec = std::chrono::duration_cast<std::chrono::milliseconds>(e_cl - b_cl).count();\n\n  return msec;\n\n}\n\n\n\nint main() {\n\n  std::cin.tie(0); std::ios::sync_with_stdio(false);\n\n  int D; std::cin >> D;\n\n  int c[26];\n\n  for(auto& ci: c) std::cin >> ci;\n\n  std::vector<std::array<int,26>> s(D);\n\n  for(int d = 0; d < D; ++d) {\n\n    for(auto& si: s[d]) std::cin >> si;\n\n  }\n\n  std::vector<int> t(D), bestT(D);\n\n  int ans = -INF;\n\n  //std::set<int> last[26];\n\n  //for(auto& li: last) li.insert(-1); // sentinel\n\n  int ansa[27];\n\n  for(int k = 0; k <= 26; ++k) {\n\n    ansa[k] = 0;\n\n    int las[26];\n\n    std::fill_n(las, 26, -1);\n\n    for(int d = 0; d < D; ++d) {\n\n      int ma = -INF, tt = -1;\n\n      for(int T = 0; T < 26; ++T) {\n\n        int cur = s[d][T];\n\n        int sv = las[T];\n\n        las[T] = d;\n\n        for(int dd = d; dd <= d+k && dd < D; ++dd) {\n\n          for(int cx = 0; cx < 26; ++cx) {\n\n            cur -= c[cx]*(dd - las[cx]);\n\n          }\n\n        }\n\n        las[T] = sv;\n\n        if(cur > ma) { ma = cur; tt = T; }\n\n      }\n\n      las[tt] = d;\n\n      t[d] = tt;\n\n      ansa[k] += s[d][tt];\n\n      for(int cx = 0; cx < 26; ++cx) {\n\n        ansa[k] -= c[cx]*(d - las[cx]);\n\n      }\n\n    }\n\n    if(ansa[k] > ans) {\n\n      ans = ansa[k];\n\n      std::copy(t.begin(), t.end(), bestT.begin());\n\n    }\n\n  }\n\n  std::copy(bestT.begin(), bestT.end(), t.begin());\n\n  //for(auto& li: last) li.insert(D); // sentinel\n\n#if 0  \n\n  // additional score when t[d] = i compare to t[d] = -1\n\n  auto sum_up = [](int d) { return d*(d-1)/2; };\n\n  auto score = [&](int d, int i)->int {\n\n    int res = s[d][i];\n\n    auto it = last[i].lower_bound(d);\n\n    int nd = *it;\n\n    int pd = *--it;\n\n    int diff = sum_up(d-pd) + sum_up(nd-d) - sum_up(nd-pd);\n\n    res -= c[i]*diff;\n\n    return res;\n\n  };\n\n  int lm = 0, renew = 0;\n\n  int sc[26];\n\n  auto one_day = [&](int d) {\n\n    int pi = t[d];\n\n    last[pi].erase(d);\n\n    for(int i = 0; i < 26; ++i) sc[i] = score(d, i);\n\n    int mi = std::max_element(sc, sc+26) - sc;\n\n    if(mi != pi) {\n\n      ans += sc[mi] - sc[pi];\n\n      ++renew;\n\n    }\n\n    last[mi].insert(d);\n\n  };\n\n  \n\n  // hill climbing\n\n  int range = 50;\n\n  for(int rep = 0;; ++rep) {\n\n    if((xor64()>>25)%2) {\n\n      one_day(xor64()%365);\n\n    } else {\n\n      // swap\n\n      int d1 = xor64()%D, d2 = xor64()%D;\n\n      while(d1 < d2-range || d2 < d1-range || t[d1] == t[d2]) {\n\n          d1 = xor64()%D; d2 = xor64()%D;\n\n      }\n\n      int pi1 = t[d1], pi2 = t[d2];\n\n      last[pi1].erase(d1);\n\n      int diff = score(d1, pi2) - score(d1, pi1);\n\n      last[pi2].insert(d1);\n\n      last[pi2].erase(d2);\n\n      diff += score(d2, pi1) - score(d2, pi2);\n\n      if(diff > 0) {\n\n        last[pi1].insert(d2);\n\n        t[d1] = pi2;\n\n        t[d2] = pi1;\n\n        lm = 0;\n\n      } else {\n\n        last[pi2].insert(d2);\n\n        last[pi2].erase(d1);\n\n        last[pi1].insert(d1);\n\n      }\n\n    }\n\n    if(rep%100 == 0) {\n\n      int x = get_time();\n\n      if(x > 1950) break;\n\n    }\n\n  }\n\n#endif\n\n  for(auto ti: t) std::cout << ti+1 << \"\\n\";\n\n  return 0;\n\n}\n",
        "optimized_code": "#include<iostream>\n\n#include<set>\n\n#include<vector>\n\n#include<array>\n\n#include<algorithm>\n\n#include<chrono>\n\n\n\nint const INF = 1e9;\n\n\n\nuint64_t xor64(void) {\n\n  static uint64_t x = 88172645463325252ULL;\n\n  x = x ^ (x << 7);\n\n  return x = x ^ (x >> 9);\n\n}\n\n\n\nauto b_cl = std::chrono::system_clock::now();\n\ninline double get_time() {\n\n  auto e_cl = std::chrono::system_clock::now();\n\n  double msec = std::chrono::duration_cast<std::chrono::milliseconds>(e_cl - b_cl).count();\n\n  return msec;\n\n}\n\n\n\nint main() {\n\n  std::cin.tie(0); std::ios::sync_with_stdio(false);\n\n  int D; std::cin >> D;\n\n  int c[26];\n\n  for(auto& ci: c) std::cin >> ci;\n\n  std::vector<std::array<int,26>> s(D);\n\n  for(int d = 0; d < D; ++d) {\n\n    for(auto& si: s[d]) std::cin >> si;\n\n  }\n\n  std::vector<int> t(D), bestT(D);\n\n  int ans = -INF;\n\n  //std::set<int> last[26];\n\n  //for(auto& li: last) li.insert(-1); // sentinel\n\n  int ansa[27];\n\n  for(int k = 0; k <= 9; ++k) {\n\n    ansa[k] = 0;\n\n    int las[26];\n\n    std::fill_n(las, 26, -1);\n\n    for(int d = 0; d < D; ++d) {\n\n      int ma = -INF, tt = -1;\n\n      for(int T = 0; T < 26; ++T) {\n\n        int cur = s[d][T];\n\n        int sv = las[T];\n\n        las[T] = d;\n\n        for(int dd = d; dd <= d+k && dd < D; ++dd) {\n\n          for(int cx = 0; cx < 26; ++cx) {\n\n            cur -= c[cx]*(dd - las[cx]);\n\n          }\n\n        }\n\n        las[T] = sv;\n\n        if(cur > ma) { ma = cur; tt = T; }\n\n      }\n\n      las[tt] = d;\n\n      t[d] = tt;\n\n      ansa[k] += s[d][tt];\n\n      for(int cx = 0; cx < 26; ++cx) {\n\n        ansa[k] -= c[cx]*(d - las[cx]);\n\n      }\n\n    }\n\n    if(ansa[k] > ans) {\n\n      ans = ansa[k];\n\n      std::copy(t.begin(), t.end(), bestT.begin());\n\n    }\n\n  }\n\n  std::copy(bestT.begin(), bestT.end(), t.begin());\n\n  //for(auto& li: last) li.insert(D); // sentinel\n\n#if 0  \n\n  // additional score when t[d] = i compare to t[d] = -1\n\n  auto sum_up = [](int d) { return d*(d-1)/2; };\n\n  auto score = [&](int d, int i)->int {\n\n    int res = s[d][i];\n\n    auto it = last[i].lower_bound(d);\n\n    int nd = *it;\n\n    int pd = *--it;\n\n    int diff = sum_up(d-pd) + sum_up(nd-d) - sum_up(nd-pd);\n\n    res -= c[i]*diff;\n\n    return res;\n\n  };\n\n  int lm = 0, renew = 0;\n\n  int sc[26];\n\n  auto one_day = [&](int d) {\n\n    int pi = t[d];\n\n    last[pi].erase(d);\n\n    for(int i = 0; i < 26; ++i) sc[i] = score(d, i);\n\n    int mi = std::max_element(sc, sc+26) - sc;\n\n    if(mi != pi) {\n\n      ans += sc[mi] - sc[pi];\n\n      ++renew;\n\n    }\n\n    last[mi].insert(d);\n\n  };\n\n  \n\n  // hill climbing\n\n  int range = 50;\n\n  for(int rep = 0;; ++rep) {\n\n    if((xor64()>>25)%2) {\n\n      one_day(xor64()%365);\n\n    } else {\n\n      // swap\n\n      int d1 = xor64()%D, d2 = xor64()%D;\n\n      while(d1 < d2-range || d2 < d1-range || t[d1] == t[d2]) {\n\n          d1 = xor64()%D; d2 = xor64()%D;\n\n      }\n\n      int pi1 = t[d1], pi2 = t[d2];\n\n      last[pi1].erase(d1);\n\n      int diff = score(d1, pi2) - score(d1, pi1);\n\n      last[pi2].insert(d1);\n\n      last[pi2].erase(d2);\n\n      diff += score(d2, pi1) - score(d2, pi2);\n\n      if(diff > 0) {\n\n        last[pi1].insert(d2);\n\n        t[d1] = pi2;\n\n        t[d2] = pi1;\n\n        lm = 0;\n\n      } else {\n\n        last[pi2].insert(d2);\n\n        last[pi2].erase(d1);\n\n        last[pi1].insert(d1);\n\n      }\n\n    }\n\n    if(rep%100 == 0) {\n\n      int x = get_time();\n\n      if(x > 1950) break;\n\n    }\n\n  }\n\n#endif\n\n  for(auto ti: t) std::cout << ti+1 << \"\\n\";\n\n  return 0;\n\n}\n"
    },
    {
        "id": "628",
        "source_code": "#include<iostream>\n\n#include<set>\n\n#include<vector>\n\n#include<array>\n\n#include<algorithm>\n\n#include<chrono>\n\n\n\nint const INF = 1e9;\n\n\n\nuint64_t xor64(void) {\n\n  static uint64_t x = 88172645463325252ULL;\n\n  x = x ^ (x << 7);\n\n  return x = x ^ (x >> 9);\n\n}\n\n\n\nauto b_cl = std::chrono::system_clock::now();\n\ninline double get_time() {\n\n  auto e_cl = std::chrono::system_clock::now();\n\n  double msec = std::chrono::duration_cast<std::chrono::milliseconds>(e_cl - b_cl).count();\n\n  return msec;\n\n}\n\n\n\nint main() {\n\n  std::cin.tie(0); std::ios::sync_with_stdio(false);\n\n  int D; std::cin >> D;\n\n  int c[26];\n\n  for(auto& ci: c) std::cin >> ci;\n\n  std::vector<std::array<int,26>> s(D);\n\n  for(int d = 0; d < D; ++d) {\n\n    for(auto& si: s[d]) std::cin >> si;\n\n  }\n\n  std::vector<int> t(D), bestT(D);\n\n  int ans = -INF;\n\n  //std::set<int> last[26];\n\n  //for(auto& li: last) li.insert(-1); // sentinel\n\n  int ansa[27];\n\n  for(int k = 0; k <= 26; ++k) {\n\n    ansa[k] = 0;\n\n    int las[26];\n\n    std::fill_n(las, 26, -1);\n\n    for(int d = 0; d < D; ++d) {\n\n      int ma = -INF, tt = -1;\n\n      for(int T = 0; T < 26; ++T) {\n\n        int cur = s[d][T];\n\n        int sv = las[T];\n\n        las[T] = d;\n\n        for(int dd = d; dd <= d+k && dd < D; ++dd) {\n\n          for(int cx = 0; cx < 26; ++cx) {\n\n            cur -= c[cx]*(dd - las[cx]);\n\n          }\n\n        }\n\n        las[T] = sv;\n\n        if(cur > ma) { ma = cur; tt = T; }\n\n      }\n\n      las[tt] = d;\n\n      t[d] = tt;\n\n      ansa[k] += s[d][tt];\n\n      for(int cx = 0; cx < 26; ++cx) {\n\n        ansa[k] -= c[cx]*(d - las[cx]);\n\n      }\n\n    }\n\n    if(ansa[k] > ans) {\n\n      ans = ansa[k];\n\n      std::copy(t.begin(), t.end(), bestT.begin());\n\n    }\n\n  }\n\n  std::copy(bestT.begin(), bestT.end(), t.begin());\n\n  //for(auto& li: last) li.insert(D); // sentinel\n\n#if 0  \n\n  // additional score when t[d] = i compare to t[d] = -1\n\n  auto sum_up = [](int d) { return d*(d-1)/2; };\n\n  auto score = [&](int d, int i)->int {\n\n    int res = s[d][i];\n\n    auto it = last[i].lower_bound(d);\n\n    int nd = *it;\n\n    int pd = *--it;\n\n    int diff = sum_up(d-pd) + sum_up(nd-d) - sum_up(nd-pd);\n\n    res -= c[i]*diff;\n\n    return res;\n\n  };\n\n  int lm = 0, renew = 0;\n\n  int sc[26];\n\n  auto one_day = [&](int d) {\n\n    int pi = t[d];\n\n    last[pi].erase(d);\n\n    for(int i = 0; i < 26; ++i) sc[i] = score(d, i);\n\n    int mi = std::max_element(sc, sc+26) - sc;\n\n    if(mi != pi) {\n\n      ans += sc[mi] - sc[pi];\n\n      ++renew;\n\n    }\n\n    last[mi].insert(d);\n\n  };\n\n  \n\n  // hill climbing\n\n  int range = 50;\n\n  for(int rep = 0;; ++rep) {\n\n    if((xor64()>>25)%2) {\n\n      one_day(xor64()%365);\n\n    } else {\n\n      // swap\n\n      int d1 = xor64()%D, d2 = xor64()%D;\n\n      while(d1 < d2-range || d2 < d1-range || t[d1] == t[d2]) {\n\n          d1 = xor64()%D; d2 = xor64()%D;\n\n      }\n\n      int pi1 = t[d1], pi2 = t[d2];\n\n      last[pi1].erase(d1);\n\n      int diff = score(d1, pi2) - score(d1, pi1);\n\n      last[pi2].insert(d1);\n\n      last[pi2].erase(d2);\n\n      diff += score(d2, pi1) - score(d2, pi2);\n\n      if(diff > 0) {\n\n        last[pi1].insert(d2);\n\n        t[d1] = pi2;\n\n        t[d2] = pi1;\n\n        lm = 0;\n\n      } else {\n\n        last[pi2].insert(d2);\n\n        last[pi2].erase(d1);\n\n        last[pi1].insert(d1);\n\n      }\n\n    }\n\n    if(rep%100 == 0) {\n\n      int x = get_time();\n\n      if(x > 1950) break;\n\n    }\n\n  }\n\n#endif\n\n  for(auto ti: t) std::cout << ti+1 << \"\\n\";\n\n  return 0;\n\n}\n",
        "optimized_code": "#include<iostream>\n\n#include<set>\n\n#include<vector>\n\n#include<array>\n\n#include<algorithm>\n\n#include<chrono>\n\n\n\nint const INF = 1e9;\n\n\n\nuint64_t xor64(void) {\n\n  static uint64_t x = 88172645463325252ULL;\n\n  x = x ^ (x << 7);\n\n  return x = x ^ (x >> 9);\n\n}\n\n\n\nauto b_cl = std::chrono::system_clock::now();\n\ninline double get_time() {\n\n  auto e_cl = std::chrono::system_clock::now();\n\n  double msec = std::chrono::duration_cast<std::chrono::milliseconds>(e_cl - b_cl).count();\n\n  return msec;\n\n}\n\n\n\nint main() {\n\n  std::cin.tie(0); std::ios::sync_with_stdio(false);\n\n  int D; std::cin >> D;\n\n  int c[26];\n\n  for(auto& ci: c) std::cin >> ci;\n\n  std::vector<std::array<int,26>> s(D);\n\n  for(int d = 0; d < D; ++d) {\n\n    for(auto& si: s[d]) std::cin >> si;\n\n  }\n\n  std::vector<int> t(D), bestT(D);\n\n  int ans = -INF;\n\n  //std::set<int> last[26];\n\n  //for(auto& li: last) li.insert(-1); // sentinel\n\n  int ansa[27];\n\n  for(int k = 0; k <= 8; ++k) {\n\n    ansa[k] = 0;\n\n    int las[26];\n\n    std::fill_n(las, 26, -1);\n\n    for(int d = 0; d < D; ++d) {\n\n      int ma = -INF, tt = -1;\n\n      for(int T = 0; T < 26; ++T) {\n\n        int cur = s[d][T];\n\n        int sv = las[T];\n\n        las[T] = d;\n\n        for(int dd = d; dd <= d+k && dd < D; ++dd) {\n\n          for(int cx = 0; cx < 26; ++cx) {\n\n            cur -= c[cx]*(dd - las[cx]);\n\n          }\n\n        }\n\n        las[T] = sv;\n\n        if(cur > ma) { ma = cur; tt = T; }\n\n      }\n\n      las[tt] = d;\n\n      t[d] = tt;\n\n      ansa[k] += s[d][tt];\n\n      for(int cx = 0; cx < 26; ++cx) {\n\n        ansa[k] -= c[cx]*(d - las[cx]);\n\n      }\n\n    }\n\n    if(ansa[k] > ans) {\n\n      ans = ansa[k];\n\n      std::copy(t.begin(), t.end(), bestT.begin());\n\n    }\n\n  }\n\n  std::copy(bestT.begin(), bestT.end(), t.begin());\n\n  //for(auto& li: last) li.insert(D); // sentinel\n\n#if 0  \n\n  // additional score when t[d] = i compare to t[d] = -1\n\n  auto sum_up = [](int d) { return d*(d-1)/2; };\n\n  auto score = [&](int d, int i)->int {\n\n    int res = s[d][i];\n\n    auto it = last[i].lower_bound(d);\n\n    int nd = *it;\n\n    int pd = *--it;\n\n    int diff = sum_up(d-pd) + sum_up(nd-d) - sum_up(nd-pd);\n\n    res -= c[i]*diff;\n\n    return res;\n\n  };\n\n  int lm = 0, renew = 0;\n\n  int sc[26];\n\n  auto one_day = [&](int d) {\n\n    int pi = t[d];\n\n    last[pi].erase(d);\n\n    for(int i = 0; i < 26; ++i) sc[i] = score(d, i);\n\n    int mi = std::max_element(sc, sc+26) - sc;\n\n    if(mi != pi) {\n\n      ans += sc[mi] - sc[pi];\n\n      ++renew;\n\n    }\n\n    last[mi].insert(d);\n\n  };\n\n  \n\n  // hill climbing\n\n  int range = 50;\n\n  for(int rep = 0;; ++rep) {\n\n    if((xor64()>>25)%2) {\n\n      one_day(xor64()%365);\n\n    } else {\n\n      // swap\n\n      int d1 = xor64()%D, d2 = xor64()%D;\n\n      while(d1 < d2-range || d2 < d1-range || t[d1] == t[d2]) {\n\n          d1 = xor64()%D; d2 = xor64()%D;\n\n      }\n\n      int pi1 = t[d1], pi2 = t[d2];\n\n      last[pi1].erase(d1);\n\n      int diff = score(d1, pi2) - score(d1, pi1);\n\n      last[pi2].insert(d1);\n\n      last[pi2].erase(d2);\n\n      diff += score(d2, pi1) - score(d2, pi2);\n\n      if(diff > 0) {\n\n        last[pi1].insert(d2);\n\n        t[d1] = pi2;\n\n        t[d2] = pi1;\n\n        lm = 0;\n\n      } else {\n\n        last[pi2].insert(d2);\n\n        last[pi2].erase(d1);\n\n        last[pi1].insert(d1);\n\n      }\n\n    }\n\n    if(rep%100 == 0) {\n\n      int x = get_time();\n\n      if(x > 1950) break;\n\n    }\n\n  }\n\n#endif\n\n  for(auto ti: t) std::cout << ti+1 << \"\\n\";\n\n  return 0;\n\n}\n"
    },
    {
        "id": "629",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int, int> P;\n\n#define rep(i, n) for (int i = 0; i < (int)(n); i++)\n\n#define all(x) (x).begin(),(x).end()\n\n#define m0(x) memset(x,-1,sizeof(x))\n\nconst int INF = 1e9 + 1;\n\nconst ll MOD = 1e9 + 7;\n\nconst double PI = 3.141592653589793;\n\nconst int MAX_N = 2e5;\n\n\n\nint d, c[365], s[365][26], t[365], last[26], u;\n\n\n\nvoid input(){\n\n  cin >> d;\n\n  rep(i, 26) cin >> c[i];\n\n  rep(i, d){\n\n    rep(j, 26){\n\n      cin >> s[i][j];\n\n    }\n\n  }\n\n  rep(i, d){\n\n    int k;\n\n    cin >> k;\n\n    k--;\n\n    t[i] = k;\n\n  }\n\n  fill(last, last+26, 0);\n\n}\n\n\n\nint test(int k, int i){\n\n  ll res = 0;\n\n  rep(j, 26){\n\n    if(j == k) continue;\n\n    res -= c[j] * last[j];\n\n  }\n\n  \n\n  return res + s[i][k];\n\n}\n\n\n\nvoid greedy(){\n\n  rep(i, d){\n\n    rep(i, 26) last[i]++;\n\n    int res = -INF;\n\n    rep(k, 26){\n\n      if(res < test(k, i)){\n\n        u = k;\n\n        res = test(k, i);\n\n      }\n\n    }\n\n    last[u] = 0;\n\n    t[i] = u;\n\n  }\n\n}\n\n\n\nint p_calc(){\n\n  ll res = 0;\n\n  int last[26];\n\n  fill(last, last+26, 0);\n\n  rep(i, d){\n\n    res += s[i][t[i]];\n\n    rep(i, 26) last[i]++;\n\n    last[t[i]] = 0;\n\n    rep(j, 26){\n\n      res -= c[j]*last[j];\n\n    }\n\n  }\n\n    \n\n  return res;\n\n}\n\n  \n\n\n\n\n\n  \n\nint main(){\n\n  input();\n\n  greedy();\n\n  ll ans = p_calc();\n\n\n\n  \n\n  for(int i = 364; i >= 0; i--){\n\n    int p = i;\n\n    int tmp = t[i];\n\n    for(int j = 0; j < 26; j++){\n\n      if(j == t[i]) continue;\n\n      t[i] = j;\n\n      if(ans > p_calc()) t[i] = tmp;\n\n    }\n\n  }\n\n  rep(i, d) cout << t[i]+1 <<endl;\n\n}\n\n\n\n  ",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int, int> P;\n\n#define rep(i, n) for (int i = 0; i < (int)(n); i++)\n\n#define all(x) (x).begin(),(x).end()\n\n#define m0(x) memset(x,-1,sizeof(x))\n\nconst int INF = 1e9 + 1;\n\nconst ll MOD = 1e9 + 7;\n\nconst double PI = 3.141592653589793;\n\nconst int MAX_N = 2e5;\n\n\n\n\n\n  \n\nint main(){\n\n\n\n  int d;\n\n  cin >> d;\n\n  vector<int> s[365], t[365];\n\n  rep(i, d){\n\n    rep(j, 26){\n\n      int a;\n\n      cin >> a;\n\n      s[i].push_back(a);t[i].push_back(a);\n\n    }\n\n  }\n\n  rep(i, d) sort(all(t[i]));\n\n  rep(i, d){\n\n    auto itr = find(all(s[i]), t[i][25]);\n\n    cout << distance(s[i].begin(), itr)+1 <<endl;;\n\n  }\n\n}\n\n\n\n  "
    },
    {
        "id": "630",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n\n\n\nint main() {\n\n  ios::sync_with_stdio(false);\n\n  cin.tie(0);\n\n\n\n  ll D; cin >> D;\n\n  vector<ll> C(26); for (ll i = 0; i < 26; i++) cin >> C[i];\n\n  vector<vector<ll>> S(365, vector<ll>(26, 0));\n\n  for (ll i = 0; i < 365; i++) {\n\n    for (ll j = 0; j < 26; j++) {\n\n      cin >> S[i][j];\n\n    }\n\n  }\n\n  for (ll i = 0; i < 365; i++) {\n\n    ll ans = rand() % 26 + 1;\n\n    cout << ans << '\\n';\n\n  }\n\n\n\n  return 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n\n\n\nint main() {\n\n  ios::sync_with_stdio(false);\n\n  cin.tie(0);\n\n\n\n  ll D; cin >> D;\n\n  vector<ll> C(26); for (ll i = 0; i < 26; i++) cin >> C[i];\n\n  vector<vector<ll>> S(D, vector<ll>(26, 0));\n\n  for (ll i = 0; i < D; i++) {\n\n    for (ll j = 0; j < 26; j++) {\n\n      cin >> S[i][j];\n\n    }\n\n  }\n\n\n\n  ll cnt = 0;\n\n  vector<ll> T(D, 0);\n\n  vector<ll> last(26, 0);\n\n\n\n  ll ans = 0;\n\n  for (ll i = 0; i < D; i++) {\n\n    ll t = 0;\n\n    for (ll j = 0; j < 26; j++) {\n\n      if ( C[j] * (i + 1 - last[j]) > C[t] * (i + 1 - last[t]) ) t = j;\n\n    }\n\n    T[i] = t;\n\n    ans += S[i][T[i]];\n\n    last[T[i]] = i + 1;\n\n    ll temp = 0;\n\n    for (ll j = 0; j < 26; j++) {\n\n      temp += C[j] * (i + 1 - last[j]);\n\n    }\n\n    ans -= temp;\n\n  }\n\n  for (ll i = 0; i < D; i++) {\n\n    cout << (T[i] + 1) << '\\n';\n\n  }\n\n  // cout << ans << '\\n';\n\n\n\n  return 0;\n\n}"
    },
    {
        "id": "631",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(int i = 0; i < n; i++)\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int,int> P;\n\nll c[30],s[400][30];\n\n \n\nint main()\n\n{\n\n\tint D;\n\n\tcin >> D;\n\n\trep(i,26)\n\n\t{\n\n\t\tcin >> c[i];\n\n\t}\n\n\trep(i,365)\n\n\t{\n\n\t\trep(j,26)\n\n\t\t{\n\n\t\t\tcin >>s[i][j];\n\n\t\t}\n\n\t}\n\n\trep(i,365)\n\n\t{\n\n\t\tcout << 26 - (i%26) << endl;\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(int i = 0; i < n; i++)\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int,int> P;\n\nll c[30],s[400][30],las[30];\n\n\n\nint main()\n\n{\n\n\tint D;\n\n\tcin >> D;\n\n\trep(i,26)\n\n\t{\n\n\t\tcin >> c[i];\n\n\t}\n\n\trep(i,D)\n\n\t{\n\n\t\trep(j,26)\n\n\t\t{\n\n\t\t\tcin >> s[i][j];\n\n\t\t}\n\n\t}\n\n\trep(i,D)\n\n\t{\n\n\t\tll best = -1 * 1e10;\n\n\t\tll bestv = 0;\n\n\t\trep(j,26)\n\n\t\t{\n\n\t\t\tll tmp = 0;\n\n\t\t\ttmp += s[i][j];\n\n\t\t\trep(k,26)\n\n\t\t\t{\n\n\t\t\t\tif (k != j)\n\n\t\t\t\t{\n\n\t\t\t\t\ttmp -= c[k] * (i+1 - las[k]);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif (tmp > best)\n\n\t\t\t{\n\n\t\t\t\tbest = tmp;\n\n\t\t\t\tbestv = j+1;\n\n\t\t\t}\n\n\t\t}\n\n\t\tcout << bestv << endl;\n\n\t\tlas[bestv] = i+1;\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "632",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(int i = 0; i < n; i++)\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int,int> P;\n\nll c[30],s[400][30];\n\n \n\nint main()\n\n{\n\n\tint D;\n\n\tcin >> D;\n\n\trep(i,26)\n\n\t{\n\n\t\tcin >> c[i];\n\n\t}\n\n\trep(i,365)\n\n\t{\n\n\t\trep(j,26)\n\n\t\t{\n\n\t\t\tcin >>s[i][j];\n\n\t\t}\n\n\t}\n\n\trep(i,365)\n\n\t{\n\n\t\tcout << 26 - (i%26) << endl;\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(int i = 0; i < n; i++)\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int,int> P;\n\nll c[30],s[400][30],las[30];\n\n\n\nint main()\n\n{\n\n\tint D;\n\n\tcin >> D;\n\n\trep(i,26)\n\n\t{\n\n\t\tcin >> c[i];\n\n\t}\n\n\trep(i,D)\n\n\t{\n\n\t\trep(j,26)\n\n\t\t{\n\n\t\t\tcin >> s[i][j];\n\n\t\t}\n\n\t}\n\n\tfor (ll i = 0; i < D; ++i)\n\n\t{\n\n\t\tll best = -1 * 1e10;\n\n\t\tll bestv = 0;\n\n\t\trep(j,26)\n\n\t\t{\n\n\t\t\tll tmp = 0;\n\n\t\t\ttmp += s[i][j];\n\n\t\t\trep(k,26)\n\n\t\t\t{\n\n\t\t\t\tif (k != j)\n\n\t\t\t\t{\n\n\t\t\t\t\ttmp -= c[k] * (i+1 - las[k]);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif (tmp > best)\n\n\t\t\t{\n\n\t\t\t\tbest = tmp;\n\n\t\t\t\tbestv = j;\n\n\t\t\t}\n\n\t\t}\n\n\t\tcout << bestv+1 << endl;\n\n\t\tlas[bestv] = i+1;\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "634",
        "source_code": "#include <algorithm>\n\n#include <bitset>\n\n#include <cmath>\n\n#include <functional>\n\n#include <iomanip>\n\n#include <iostream>\n\n#include <limits>\n\n#include <map>\n\n#include <queue>\n\n#include <random>\n\n#include <set>\n\n#include <tuple>\n\n#include <vector>\n\n\n\nusing namespace std;\n\n\n\n#define rep(i, n) for (int64_t i = 0; i < (int64_t)(n); i++)\n\n#define irep(i, n) for (int64_t i = 0; i <= (int64_t)(n); i++)\n\n#define rrep(i, n) for (int64_t i = (n)-1; i >= 0; i--)\n\n#define rirep(i, n) for (int64_t i = n; i >= 0; i--)\n\n\n\n#define chmax(a, b) (a) = max(a, b)\n\n#define chmin(a, b) (a) = min(a, b)\n\n\n\nint D;\n\nvector<int> c(26);\n\nvector<vector<int>> s;\n\n\n\nint64_t calc_score(const vector<int>& t) {\n\n  int64_t result = 0;\n\n  vector<int> last(26, -1);\n\n  rep(i, D) {\n\n    const int j = t[i];\n\n    result += s[i][j];\n\n    last[j] = i;\n\n    rep(k, 26) { result -= c[k] * (i - last[k]); }\n\n  }\n\n  return result;\n\n}\n\n\n\nint main() {\n\n  cin >> D;\n\n\n\n  rep(i, 26) { cin >> c[i]; }\n\n\n\n  s.resize(D, vector<int>(26));\n\n  rep(i, D) rep(j, 26) { cin >> s[i][j]; }\n\n\n\n  vector<vector<int>> last;\n\n  vector<int> parent;\n\n  vector<int> kind;\n\n\n\n  using P = pair<int64_t, int>;\n\n  priority_queue<P, vector<P>, greater<P>> q;\n\n\n\n  last.push_back(vector<int>(26, -1));\n\n  parent.push_back(-1);\n\n  kind.push_back(-1);\n\n  q.push(P(0, 0));\n\n\n\n  const int width = 100;\n\n  rep(i, D) {\n\n    priority_queue<P, vector<P>, greater<P>> nxt;\n\n\n\n    while (!q.empty()) {\n\n      int64_t z;\n\n      int idx;\n\n      tie(z, idx) = q.top();\n\n      q.pop();\n\n\n\n      int64_t penalty = 0;\n\n      rep(j, 26) { penalty += c[j] * (i - last[idx][j]); }\n\n\n\n      rep(j, 26) {\n\n        int nidx = last.size();\n\n        int64_t w = z + s[i][j] - penalty + c[j] * (i - last[idx][j]);\n\n        nxt.push(P(w, nidx));\n\n        if (nxt.size() > width) {\n\n          nxt.pop();\n\n        }\n\n\n\n        last.push_back(last[idx]);\n\n        last[nidx][j] = i;\n\n        parent.push_back(idx);\n\n        kind.push_back(j);\n\n      }\n\n    }\n\n\n\n    q = move(nxt);\n\n  }\n\n\n\n  while (q.size() > 1) {\n\n    q.pop();\n\n  }\n\n\n\n  int64_t score;\n\n  int idx;\n\n  tie(score, idx) = q.top();\n\n  vector<int> sln;\n\n  while (idx != 0) {\n\n    sln.push_back(kind[idx]);\n\n    idx = parent[idx];\n\n  }\n\n  rrep(i, D) { cout << sln[i] + 1 << \"\\n\"; }\n\n  cerr << score << \"\\n\";\n\n\n\n  return 0;\n\n}",
        "optimized_code": "#include <algorithm>\n\n#include <bitset>\n\n#include <cmath>\n\n#include <functional>\n\n#include <iomanip>\n\n#include <iostream>\n\n#include <limits>\n\n#include <map>\n\n#include <queue>\n\n#include <random>\n\n#include <set>\n\n#include <tuple>\n\n#include <vector>\n\n\n\nusing namespace std;\n\n\n\n#define rep(i, n) for (int64_t i = 0; i < (int64_t)(n); i++)\n\n#define irep(i, n) for (int64_t i = 0; i <= (int64_t)(n); i++)\n\n#define rrep(i, n) for (int64_t i = (n)-1; i >= 0; i--)\n\n#define rirep(i, n) for (int64_t i = n; i >= 0; i--)\n\n\n\n#define chmax(a, b) (a) = max(a, b)\n\n#define chmin(a, b) (a) = min(a, b)\n\n\n\nint D;\n\nvector<int> c(26);\n\nvector<vector<int>> s;\n\n\n\nint main() {\n\n  cin.tie(0);\n\n  ios::sync_with_stdio(false);\n\n\n\n  cin >> D;\n\n\n\n  rep(i, 26) { cin >> c[i]; }\n\n\n\n  s.resize(D, vector<int>(26));\n\n  rep(i, D) rep(j, 26) { cin >> s[i][j]; }\n\n\n\n  const int width = 10;\n\n\n\n  vector<vector<int16_t>> last;\n\n  vector<int> parent;\n\n  vector<char> kind;\n\n\n\n  using P = pair<int64_t, int>;\n\n  priority_queue<P, vector<P>, greater<P>> q;\n\n\n\n  last.push_back(vector<int16_t>(26, -1));\n\n  parent.push_back(-1);\n\n  kind.push_back(-1);\n\n  q.push(P(0, 0));\n\n\n\n  mt19937 rng(111);\n\n  uniform_int_distribution<int> dist(0, 500 - 1);\n\n\n\n  rep(i, D) {\n\n    priority_queue<P, vector<P>, greater<P>> nxt;\n\n    queue<P> mutant;\n\n\n\n    while (!q.empty()) {\n\n      int64_t z;\n\n      int idx;\n\n      tie(z, idx) = q.top();\n\n      q.pop();\n\n\n\n      int64_t penalty = 0;\n\n      rep(j, 26) { penalty += c[j] * (i - last[idx][j]); }\n\n\n\n      rep(j, 26) {\n\n        int nidx = last.size();\n\n        int64_t w = z + s[i][j] - penalty + c[j] * (i - last[idx][j]);\n\n        nxt.push(P(w, nidx));\n\n        if (nxt.size() > width) {\n\n          if (dist(rng) == 0) {\n\n            mutant.push(nxt.top());\n\n          }\n\n          nxt.pop();\n\n        }\n\n\n\n        last.push_back(last[idx]);\n\n        last[nidx][j] = i;\n\n        parent.push_back(idx);\n\n        kind.push_back(j);\n\n      }\n\n    }\n\n\n\n    q = move(nxt);\n\n    while (!mutant.empty()) {\n\n      q.push(mutant.front());\n\n      mutant.pop();\n\n    }\n\n  }\n\n\n\n  while (q.size() > 1) {\n\n    q.pop();\n\n  }\n\n\n\n  int64_t score;\n\n  int idx;\n\n  tie(score, idx) = q.top();\n\n  vector<int> sln;\n\n  while (idx != 0) {\n\n    sln.push_back(kind[idx]);\n\n    idx = parent[idx];\n\n  }\n\n  rrep(i, D) { cout << sln[i] + 1 << \"\\n\"; }\n\n  // cerr << score << \"\\n\";\n\n\n\n  return 0;\n\n}"
    },
    {
        "id": "635",
        "source_code": "/*#pragma GCC target(\"avx512f,avx512dq,avx512cd,avx512bw,avx512vl\")\n\n#pragma GCC optimize(\"O3\")\n\n#pragma GCC optimize(\"unroll-loops\")*/\n\n//#include<bits/stdc++.h>\n\n#include<iostream>\n\n#include<vector>\n\nusing namespace std;\n\n#define ll long long\n\n\n\n//\u8272\u3005\u8a08\u7b97\u3059\u308b\u7528\n\nvector<ll>C(26),last2(26),T(365),Tans(365),V(365),Vorigin(365);\n\nvector<vector<ll>>S(365,vector<ll>(26)),\n\n                last(365,vector<ll>(26)),\n\n                last_sim(365,vector<ll>(26));\n\nll D,vmax,dadd_best,steps=0;\n\n\n\n//\u30ea\u30bb\u30c3\u30c8\u7528\u306e\u95a2\u6570S\n\nvoid R26(vector<ll>&A){\n\n    for(int i=0;i<26;++i)A[i]=0;\n\n}\n\n\n\nvoid R365(vector<ll>&A){\n\n    for(int i=0;i<365;++i)A[i]=0;\n\n}\n\n\n\nvoid R365_26(vector<vector<ll>>&A){\n\n    for(int i=0;i<365;++i)for(int j=0;j<26;++j)A[i][j]=0;\n\n}\n\n\n\nvoid greedy(){\n\n    ll dadd,i,j,k,l,i_calc,tbest,score,vbest;\n\n    for(dadd=0;dadd<=26;++dadd){\n\n        //\u30ea\u30bb\u30c3\u30c8\n\n        R26(last2);\n\n        R365_26(last);\n\n\n\n        for(i=0;i<D;++i){\n\n            i_calc=min(i+dadd+1,D);\n\n            for(j=0;j<26;++j){\n\n                //\u5f97\u70b9\u306e\u521d\u671f\u5316\n\n                if(i==0){\n\n                    V[i]=0;\n\n                }else{\n\n                    V[i]=V[i-1];\n\n                }\n\n                \n\n                //last\u306e\u521d\u671f\u5316\n\n                if(i==0)R26(last[i]);\n\n                else last[i]=last[i-1];\n\n\n\n                last[i][j]=i+1;\n\n                V[i]+=S[i][j];\n\n\n\n                for(k=0;k<26;++k)\n\n                    for(l=i;l<i_calc;l++)V[i]-=C[k]*(l+1-last[i][k]);\n\n\n\n                if(j==0||V[i]>=vmax){\n\n                    vmax=V[i];\n\n                    tbest=j;\n\n                }\n\n            }\n\n            if(i==0)R26(last[i]);\n\n            else last[i]=last[i-1];\n\n            T[i]=tbest+1;\n\n            last[i][tbest]=i+1;\n\n        }\n\n\n\n        //\u5f97\u70b9\u306e\u518d\u8a08\u7b97\n\n        score=0;\n\n        R26(last2);\n\n\n\n        for(i=0;i<D;++i){\n\n            score+=S[i][T[i]-1];\n\n            last2[T[i]-1]=i+1;\n\n            for(j=0;j<26;j++)score-=C[j]*(i+1-last2[j]);\n\n        }\n\n\n\n        if(dadd==0||(dadd!=0 && score>vbest)){\n\n            dadd_best=dadd;\n\n            vbest=score;\n\n            Tans=T;\n\n            last_sim=last;\n\n        }\n\n    }\n\n\n\n    vmax=vbest;\n\n    T=Tans;\n\n    last=last_sim;\n\n}\n\n\n\nint main(){\n\n    int i,j;\n\n    cin>>D;\n\n    for(i=0;i<26;++i)cin>>C[i];\n\n    for(i=0;i<D;++i)for(j=0;j<26;++j)cin>>S[i][j];\n\n\n\n    //\u521d\u671f\u89e3\u306e\u751f\u6210    \n\n    greedy();\n\n\n\n    for(i=0;i<D;++i)cout<<T[i]<<\"\\n\";\n\n    return 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<vector>\n\nusing namespace std;\n\n#define ll long long\n\n\n\n//\u8272\u3005\u8a08\u7b97\u3059\u308b\u7528\n\nll C[26],last2[26],T[365],Tans[365],V[365],Vorigin[365];\n\nll S[365][26],last[365][26],last_sim[365][26];\n\nll D,vmax,dadd_best,steps=0;\n\n\n\n//\u30ea\u30bb\u30c3\u30c8\u7528\u306e\u95a2\u6570S\n\nvoid R26(ll A[26]){\n\n    for(int i=0;i<26;++i)A[i]=0;\n\n}\n\n\n\nvoid R365(ll A[365]){\n\n    for(int i=0;i<365;++i)A[i]=0;\n\n}\n\n\n\nvoid R365_26(ll A[365][26]){\n\n    for(int i=0;i<365;++i)for(int j=0;j<26;++j)A[i][j]=0;\n\n}\n\n\n\nvoid copy26(ll A[26],ll B[26]){\n\n    for(int i=0;i<26;++i)A[i]=B[i];\n\n}\n\n\n\nvoid copy365(ll A[365],ll B[365]){\n\n    for(int i=0;i<365;++i)A[i]=B[i];\n\n}\n\n\n\nvoid copy365_26(ll A[365][26],ll B[365][26]){\n\n    for(int i=0;i<365;++i)for(int j=0;j<26;++j)A[i][j]=B[i][j];\n\n}\n\n\n\nvoid greedy(){\n\n    ll dadd,i,j,k,l,i_calc,tbest,score,vbest;\n\n    for(dadd=0;dadd<=26;++dadd){\n\n        //\u30ea\u30bb\u30c3\u30c8\n\n        R26(last2);\n\n        R365_26(last);\n\n\n\n        for(i=0;i<D;++i){\n\n            i_calc=min(i+dadd+1,D);\n\n            for(j=0;j<26;++j){\n\n                //\u5f97\u70b9\u306e\u521d\u671f\u5316\n\n                if(i==0){\n\n                    V[i]=0;\n\n                }else{\n\n                    V[i]=V[i-1];\n\n                }\n\n                \n\n                //last\u306e\u521d\u671f\u5316\n\n                if(i==0)R26(last[i]);\n\n                else copy26(last[i],last[i-1]);\n\n\n\n                last[i][j]=i+1;\n\n                V[i]+=S[i][j];\n\n\n\n                for(k=0;k<26;++k)\n\n                    for(l=i;l<i_calc;l++)V[i]-=C[k]*(l+1-last[i][k]);\n\n\n\n                if(j==0||V[i]>=vmax){\n\n                    vmax=V[i];\n\n                    tbest=j;\n\n                }\n\n            }\n\n            if(i==0)R26(last[i]);\n\n            else copy26(last[i],last[i-1]);\n\n            T[i]=tbest+1;\n\n            last[i][tbest]=i+1;\n\n        }\n\n\n\n        //\u5f97\u70b9\u306e\u518d\u8a08\u7b97\n\n        score=0;\n\n        R26(last2);\n\n\n\n        for(i=0;i<D;++i){\n\n            score+=S[i][T[i]-1];\n\n            last2[T[i]-1]=i+1;\n\n            for(j=0;j<26;j++)score-=C[j]*(i+1-last2[j]);\n\n        }\n\n\n\n        if(dadd==0||(dadd!=0 && score>vbest)){\n\n            dadd_best=dadd;\n\n            vbest=score;\n\n            copy365(Tans,T);\n\n            copy365_26(last_sim,last);\n\n        }\n\n    }\n\n\n\n    vmax=vbest;\n\n    copy365(T,Tans);\n\n    copy365_26(last,last_sim);\n\n}\n\n\n\nint main(){\n\n    int i,j;\n\n    cin>>D;\n\n    for(i=0;i<26;++i)scanf(\"%lld\",&C[i]);\n\n    for(i=0;i<D;++i)for(j=0;j<26;++j)scanf(\"%lld\",&S[i][j]);\n\n\n\n    //\u521d\u671f\u89e3\u306e\u751f\u6210    \n\n    greedy();\n\n\n\n    for(i=0;i<D;++i)printf(\"%lld\\n\",T[i]);\n\n    return 0;\n\n}"
    },
    {
        "id": "636",
        "source_code": "#include <bits/stdc++.h>\n\n\n\n#include <utility>\n\nusing namespace std;\n\n\n\n#define REP(i, n) for ( int i = 0; i < (n); i++ )\n\nconst int INF = 1e9;\n\nusing Pii = pair<int, int>;\n\n\n\nconst int con_type = 26;\n\nint D = 365;\n\nint C[con_type];\n\nint S[365][con_type];\n\nvector<int> ans;\n\nint last[con_type];\n\n\n\nstruct State {\n\n  int cost;\n\n  vector<int> ans;\n\n  vector<int> last;\n\n\n\n  State() {\n\n    cost = 0;\n\n    last = vector<int>(26, -1);\n\n  }\n\n\n\n  State(int cost, vector<int> ans, vector<int> last):\n\n    cost(cost), ans(ans), last(last) {};\n\n\n\n  bool operator<( const State& s ) const {\n\n    return cost < s.cost;\n\n  }\n\n\n\n  bool operator>( const State& s ) const {\n\n    return cost > s.cost;\n\n  }\n\n};\n\n\n\nvoid solve() {\n\n  priority_queue<State> Q;\n\n  Q.push(State());\n\n  REP(d, D) {\n\n    priority_queue<State> nQ;\n\n    while ( !Q.empty() ) {\n\n      State now = Q.top(); Q.pop();\n\n      vector<Pii> add_cost;\n\n      int sum = 0;\n\n      int type_cost[26];\n\n      REP(i, con_type) {\n\n        sum += (d-now.last[i])*C[i];\n\n        type_cost[i] = (d-now.last[i])*C[i];\n\n      }\n\n      REP(i, con_type) {\n\n        add_cost.emplace_back(Pii(S[d][i]+(d-now.last[i])*C[i]-sum, i));\n\n      }\n\n      sort(add_cost.begin(), add_cost.end(), greater<Pii>());\n\n      REP(i, 6) {\n\n        int id = add_cost[i].second;\n\n        State next = now;\n\n        next.cost += S[d][id];\n\n        next.cost -= sum;\n\n        next.cost += type_cost[id];\n\n        next.ans.emplace_back(id);\n\n        next.last[id] = d;\n\n        nQ.push(next);\n\n      }\n\n    }\n\n    Q = priority_queue<State>();\n\n    REP(i, min(1400, (int)nQ.size())) {\n\n      Q.push(nQ.top()); nQ.pop();\n\n    }\n\n  }\n\n\n\n  ans = Q.top().ans;\n\n}\n\n\n\nvoid input() {\n\n  cin >> D;\n\n  REP(i, con_type) {\n\n    cin >> C[i];\n\n    last[i] = -1;\n\n  }\n\n  REP(i, D) REP(j, con_type) cin >> S[i][j];\n\n}\n\n\n\nvoid output() {\n\n  REP(i, D) cout << ans[i]+1 << endl;\n\n}\n\n\n\nsigned main() {\n\n  cin.tie(0);\n\n  ios_base::sync_with_stdio(0);\n\n  cout << fixed << setprecision(12);\n\n\n\n  input();\n\n  solve();\n\n  output();\n\n\n\n  return 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\n#include <utility>\n\nusing namespace std;\n\n\n\n#define REP(i, n) for ( int i = 0; i < (n); i++ )\n\nconst int INF = 1e9;\n\nusing Pii = pair<int, int>;\n\n\n\nconst int con_type = 26;\n\nint D = 365;\n\nint C[con_type];\n\nint S[365][con_type];\n\nvector<int> ans;\n\nint last[con_type];\n\n\n\nstruct State {\n\n  int cost;\n\n  vector<int> ans;\n\n  vector<int> last;\n\n\n\n  State() {\n\n    cost = 0;\n\n    last = vector<int>(26, -1);\n\n  }\n\n\n\n  State(int cost, vector<int> ans, vector<int> last):\n\n    cost(cost), ans(ans), last(last) {};\n\n\n\n  bool operator<( const State& s ) const {\n\n    return cost < s.cost;\n\n  }\n\n\n\n  bool operator>( const State& s ) const {\n\n    return cost > s.cost;\n\n  }\n\n};\n\n\n\nvoid solve() {\n\n  priority_queue<State> Q;\n\n  Q.push(State());\n\n  REP(d, D) {\n\n    priority_queue<State> nQ;\n\n    while ( !Q.empty() ) {\n\n      State now = Q.top(); Q.pop();\n\n      vector<Pii> add_cost;\n\n      int sum = 0;\n\n      int type_cost[26];\n\n      REP(i, con_type) {\n\n        sum += (d-now.last[i])*C[i];\n\n        type_cost[i] = (d-now.last[i])*C[i];\n\n      }\n\n      REP(i, con_type) {\n\n        add_cost.emplace_back(Pii(S[d][i]+(d-now.last[i])*C[i]-sum, i));\n\n      }\n\n      sort(add_cost.begin(), add_cost.end(), greater<Pii>());\n\n      REP(i, 4) {\n\n        int id = add_cost[i].second;\n\n        State next = now;\n\n        next.cost += S[d][id];\n\n        next.cost -= sum;\n\n        next.cost += type_cost[id];\n\n        next.ans.emplace_back(id);\n\n        next.last[id] = d;\n\n        nQ.push(next);\n\n      }\n\n    }\n\n    Q = priority_queue<State>();\n\n    REP(i, min(1600, (int)nQ.size())) {\n\n      Q.push(nQ.top()); nQ.pop();\n\n    }\n\n  }\n\n\n\n  ans = Q.top().ans;\n\n  REP(i, 1000) {\n\n    vector<int> next = ans;\n\n\n\n  }\n\n}\n\n\n\nvoid input() {\n\n  cin >> D;\n\n  REP(i, con_type) {\n\n    cin >> C[i];\n\n    last[i] = -1;\n\n  }\n\n  REP(i, D) REP(j, con_type) cin >> S[i][j];\n\n}\n\n\n\nvoid output() {\n\n  REP(i, D) cout << ans[i]+1 << endl;\n\n}\n\n\n\nsigned main() {\n\n  cin.tie(0);\n\n  ios_base::sync_with_stdio(0);\n\n  cout << fixed << setprecision(12);\n\n\n\n  input();\n\n  solve();\n\n  output();\n\n\n\n  return 0;\n\n}\n"
    },
    {
        "id": "637",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(int i=0; i<n; i++)\n\n#define PI 3.14159265359\n\n#define INF 1000100100//000000000\n\n#define MOD 1000000007\n\n#define all(x) (x).begin(),(x).end()\n\ntypedef long long ll;\n\n#define P pair<int, int>\n\n#define PP pair<P,P>\n\n#define T tuple<int,int,int> \n\nusing namespace std;\n\n \n\nvector<vector<int> > s;\n\nvector<int> c;\n\n\n\nint score(vector<int> held){\n\n    vector<int> ld(26,0);\n\n    int ans=0;\n\n    rep(i,held.size()){\n\n        int t=held[i];\n\n        ld[t]=i+1;\n\n        ans+=s[i][t];\n\n        rep(j,26){\n\n            rep(k,26){\n\n                ans-=c[j]*(k*(1+k)/2+i+1-ld[j]);\n\n            }\n\n        }\n\n    }\n\n    return ans;\n\n}\n\n\n\nint main(){\n\n    int d; cin >> d;\n\n    vector<int> cc(26);\n\n    c=cc;\n\n    rep(i,26) cin >> c[i];\n\n    vector<vector<int> > ss(d);\n\n    s=ss;\n\n    rep(i,d)rep(j,26){\n\n        int a; cin >> a;\n\n        s[i].push_back(a);\n\n    }\n\n \n\n    //vector<int> ld(26,0);\n\n    vector<vector<int> > ds(26);\n\n    vector<int> days(0);\n\n\n\n    rep(i,d){\n\n        int now=-INF;\n\n        int whatday;\n\n        rep(j,26){\n\n            vector<int> tmp=days;\n\n            tmp.push_back(j);\n\n            int sc=score(tmp);\n\n            if(sc>now){\n\n                whatday=j;\n\n                now=sc;\n\n            }\n\n        }\n\n        days.push_back(whatday);\n\n    }\n\n    rep(i,d) cout << days[i]+1 << endl;\n\nreturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(int i=0; i<n; i++)\n\n#define PI 3.14159265359\n\n#define INF 1000100100//000000000\n\n#define MOD 1000000007\n\n#define all(x) (x).begin(),(x).end()\n\ntypedef long long ll;\n\n#define P pair<int, int>\n\n#define PP pair<P,P>\n\n#define T tuple<int,int,int> \n\nusing namespace std;\n\n \n\nvector<vector<int> > s;\n\nvector<int> c;\n\n\n\nint score(vector<int> held,int k){\n\n    vector<int> ld(26,0);\n\n    int ans=0;\n\n\n\n    rep(i,held.size()){\n\n        int t=held[i];\n\n        ld[t]=i+1;\n\n        ans+=s[i][t];\n\n        rep(j,26){\n\n            ans-=c[j]*(i+1-ld[j]);\n\n        }\n\n    }\n\n\n\n    rep(i,26){\n\n        ans-=c[i]*(held.size()+k*(1+k)+1-ld[i]);\n\n    }\n\n\n\n    return ans;\n\n}\n\n\n\nint main(){\n\n    int d; cin >> d;\n\n    vector<int> cc(26);\n\n    c=cc;\n\n    rep(i,26) cin >> c[i];\n\n    vector<vector<int> > ss(d);\n\n    s=ss;\n\n    rep(i,d)rep(j,26){\n\n        int a; cin >> a;\n\n        s[i].push_back(a);\n\n    }\n\n \n\n    //vector<int> ld(26,0);\n\n    vector<vector<int> > ds(26);\n\n    vector<int> days(0);\n\n\n\n    rep(i,d){\n\n        int now=-INF;\n\n        int whatday;\n\n        rep(j,26){\n\n            vector<int> tmp=days;\n\n            tmp.push_back(j);\n\n            int sc=score(tmp,9);\n\n            if(sc>now){\n\n                whatday=j;\n\n                now=sc;\n\n            }\n\n        }\n\n        days.push_back(whatday);\n\n    }\n\n    rep(i,d) cout << days[i]+1 << endl;\n\nreturn 0;\n\n}"
    },
    {
        "id": "638",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(int i=0; i<n; i++)\n\n#define PI 3.14159265359\n\n#define INF 1000100100//000000000\n\n#define MOD 1000000007\n\n#define all(x) (x).begin(),(x).end()\n\ntypedef long long ll;\n\n#define P pair<int, int>\n\n#define PP pair<P,P>\n\n#define T tuple<int,int,int> \n\nusing namespace std;\n\n \n\nvector<vector<int> > s;\n\nvector<int> c;\n\n\n\nint score(vector<int> held,int k){\n\n    vector<int> ld(26,0);\n\n    int ans=0;\n\n    rep(i,held.size()){\n\n        int t=held[i];\n\n        ld[t]=i+1;\n\n        ans+=s[i][t];\n\n        rep(j,26){\n\n            ans-=c[j]*(k*(1+k)/2+i+1-ld[j]);\n\n        }\n\n    }\n\n    return ans;\n\n}\n\n\n\nint main(){\n\n    int d; cin >> d;\n\n    vector<int> cc(26);\n\n    c=cc;\n\n    rep(i,26) cin >> c[i];\n\n    vector<vector<int> > ss(d);\n\n    s=ss;\n\n    rep(i,d)rep(j,26){\n\n        int a; cin >> a;\n\n        s[i].push_back(a);\n\n    }\n\n \n\n    //vector<int> ld(26,0);\n\n    vector<vector<int> > ds(26);\n\n    vector<int> ans;\n\n    int tmps=-INF;\n\n    rep(p,26){\n\n        vector<int> days(0);\n\n    rep(i,d){\n\n        int now=-INF;\n\n        int whatday;\n\n        rep(j,26){\n\n            vector<int> tmp=days;\n\n            tmp.push_back(j);\n\n            int sc=score(tmp,p);\n\n            if(sc>now){\n\n                whatday=j;\n\n                now=sc;\n\n            }\n\n        }\n\n        days.push_back(whatday);\n\n    }\n\n    int nows=score(days,0);\n\n    if(nows>tmps){\n\n        tmps=nows;\n\n        ans=days;\n\n    }\n\n    }\n\n    rep(i,d) cout << ans[i]+1 << endl;\n\nreturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(int i=0; i<n; i++)\n\n#define PI 3.14159265359\n\n#define INF 1000100100//000000000\n\n#define MOD 1000000007\n\n#define all(x) (x).begin(),(x).end()\n\ntypedef long long ll;\n\n#define P pair<int, int>\n\n#define PP pair<P,P>\n\n#define T tuple<int,int,int> \n\nusing namespace std;\n\n \n\nvector<vector<int> > s;\n\nvector<int> c;\n\n\n\nint score(vector<int> held,int k){\n\n    vector<int> ld(26,0);\n\n    int ans=0;\n\n\n\n    rep(i,held.size()){\n\n        int t=held[i];\n\n        ld[t]=i+1;\n\n        ans+=s[i][t];\n\n        rep(j,26){\n\n            ans-=c[j]*(i+1-ld[j]);\n\n        }\n\n    }\n\n\n\n    rep(i,26){\n\n        ans-=c[i]*(held.size()+k*(1+k)+1-ld[i]);\n\n    }\n\n\n\n    return ans;\n\n}\n\n\n\nint main(){\n\n    int d; cin >> d;\n\n    vector<int> cc(26);\n\n    c=cc;\n\n    rep(i,26) cin >> c[i];\n\n    vector<vector<int> > ss(d);\n\n    s=ss;\n\n    rep(i,d)rep(j,26){\n\n        int a; cin >> a;\n\n        s[i].push_back(a);\n\n    }\n\n \n\n    //vector<int> ld(26,0);\n\n    vector<vector<int> > ds(26);\n\n    vector<int> days(0);\n\n\n\n    rep(i,d){\n\n        int now=-INF;\n\n        int whatday;\n\n        rep(j,26){\n\n            vector<int> tmp=days;\n\n            tmp.push_back(j);\n\n            int sc=score(tmp,9);\n\n            if(sc>now){\n\n                whatday=j;\n\n                now=sc;\n\n            }\n\n        }\n\n        days.push_back(whatday);\n\n    }\n\n    rep(i,d) cout << days[i]+1 << endl;\n\nreturn 0;\n\n}"
    },
    {
        "id": "639",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(ll i=0;i<(n);++i)\n\n#define all(a) (a).begin(),(a).end()\n\nusing namespace std;\n\nusing Graph = vector<vector<int>>;\n\ntypedef pair<int,int> P;\n\ntypedef long long ll;\n\n\n\nint main(){\n\n    ll d; cin >> d;\n\n    vector<ll> c(26); rep(i,26) cin >> c[i];\n\n    vector<vector<ll>> g(365, vector<ll> (26));\n\n\n\n    rep(i,365){\n\n        rep(j,26){\n\n            cin >> g[i][j];\n\n        }\n\n    }\n\n\n\n    rep(i,365){\n\n        ll jud = rand() % 26;\n\n        cout << jud + 1 << endl;\n\n    }\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(ll i=0;i<(n);++i)\n\n#define all(a) (a).begin(),(a).end()\n\nusing namespace std;\n\nusing Graph = vector<vector<int>>;\n\ntypedef pair<int,int> P;\n\ntypedef long long ll;\n\n\n\nint main(){\n\n    ll d; cin >> d;\n\n    vector<P> p(26);\n\n    rep(i,26){\n\n        ll c; cin >> c;\n\n        p[i].first = c;\n\n        p[i].second = i;\n\n    }\n\n\n\n    sort(all(p)); reverse(all(p));\n\n    vector<vector<ll>> g(d, vector<ll> (26));\n\n\n\n    rep(i,d){\n\n        rep(j,26){\n\n            cin >> g[i][j];\n\n        }\n\n    }\n\n\n\n    rep(i,7){\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[1].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[2].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[3].second + 1 << endl;\n\n        cout << p[1].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[4].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n\n\n        cout << p[5].second + 1 << endl;\n\n        cout << p[1].second + 1 << endl;\n\n        cout << p[6].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[7].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[8].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[9].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n\n\n        cout << p[10].second + 1 << endl;\n\n        cout << p[1].second + 1 << endl;\n\n        cout << p[11].second + 1 << endl;\n\n        cout << p[2].second + 1 << endl;\n\n        cout << p[12].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[13].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[14].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n\n\n        cout << p[15].second + 1 << endl;\n\n        cout << p[1].second + 1 << endl;\n\n        cout << p[16].second + 1 << endl;\n\n        cout << p[3].second + 1 << endl;\n\n        cout << p[17].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[18].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[19].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n\n\n        cout << p[20].second + 1 << endl;\n\n        cout << p[2].second + 1 << endl;\n\n        cout << p[21].second + 1 << endl;\n\n        cout << p[4].second + 1 << endl;\n\n        cout << p[22].second + 1 << endl;\n\n        cout << p[5].second + 1 << endl;\n\n        cout << p[23].second + 1 << endl;\n\n        cout << p[6].second + 1 << endl;\n\n        cout << p[24].second + 1 << endl;\n\n        cout << p[25].second + 1 << endl;                                              \n\n    }\n\n\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[1].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[2].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[3].second + 1 << endl;\n\n        cout << p[1].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[4].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n\n\n        cout << p[5].second + 1 << endl;\n\n        cout << p[1].second + 1 << endl;\n\n        cout << p[6].second + 1 << endl;\n\n        cout << p[0].second + 1 << endl;\n\n        cout << p[7].second + 1 << endl;\n\n\n\n}"
    },
    {
        "id": "640",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <map>\n\n#include <queue>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint main() {\n\n    ll d;\n\n    cin >> d;\n\n    ////////\n\n    vector<vector<ll>> s(365, vector<ll>(26, 0));\n\n    vector<int> c(26);\n\n    vector<ll> t(d, 1);\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        ll tmp = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n            /*if(tmp < s[i][j]) {\n\n                tmp = s[i][j];\n\n                t[i] = j+1;\n\n            }\n\n            */\n\n        }\n\n    }\n\n\n\n    /////////////////\n\n    /*\n\n    for(int i = 0; i < d; i++) {\n\n        t[i] = i+1;\n\n    }\n\n    */\n\n    //for(int i = 0; i < d; i++) cin >> t[i];\n\n    ll mx_v = 0;\n\n    vector<ll> swap_set;\n\n    vector<pair<int, int>> p(d);\n\n    for(int i = 0; i < d; i++) {\n\n        mx_v = -1;\n\n        int ni = i, nj = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            if(s[i][j] > mx_v) {\n\n                mx_v = s[i][j];\n\n                ni = i;\n\n                nj = j;\n\n            }\n\n        }\n\n        swap_set.push_back(mx_v);\n\n        p[i] = make_pair(ni, nj);\n\n        //p.push_back(make_pair(ni, nj));\n\n    }\n\n\n\n    ///////////////\n\n    ll m;\n\n    m = d;\n\n    //cin >> m;\n\n    vector<pair<int, int>> dq(m);\n\n    for(int i = 0; i < m; i++) {\n\n        //cin >> dq[i].first >> dq[i].second;\n\n        dq[i].first = p[i].first+1;\n\n        dq[i].second = p[i].second+1;\n\n        //cout << dq[i].first << \" \" << dq[i].second << endl;\n\n    }\n\n    vector<ll> ans(d, 0);\n\n    ll v = 0;\n\n    //ll tmp = 0;\n\n    map<ll, ll> mp;\n\n    priority_queue<ll> que;\n\n    vector<vector<ll>> list(m, vector<ll>(d, 1));\n\n    //int num = 0;\n\n    for(int k = 0; k < m; k++) {\n\n        //\n\n        //tmp = t[dq[k].first-1];\n\n        //cout << dq[k].first-1 << \" \" << t[dq[k].first-1] << endl;\n\n        t[dq[k].first-1] = dq[k].second; \n\n\n\n        /////////////////////\n\n        vector<ll> last(26, 0);\n\n        for(int i = 0; i < d; i++) {\n\n            //if(t[i]-1 >= 26) cout << \"t: \" << t[i]-1 << endl;\n\n            v += s[i][t[i]-1];//-1\n\n            //v += s[t[i]-1][];\n\n            //v += \n\n            last[t[i]-1] = i+1;//-1\n\n            for(int j = 0; j < 26; j++) {\n\n                v -= c[j]*((i+1)-last[j]);\n\n            }    \n\n        }\n\n        //cout << v << endl;\n\n        que.push(v);\n\n        mp[v] = k;\n\n        for(int i = 0; i < d; i++) {\n\n            //list[k].push_back(t[i]);\n\n            list[k][i] = t[i];\n\n            //cout << t[i] << endl;\n\n        }\n\n        v = 0;\n\n    }\n\n\n\n    //cout << mp[que.top()] << endl;\n\n    //cout << list[0].size() << endl;\n\n    //cout << m << endl;\n\n    ll tmp = que.top();\n\n    for(int i = 0; i < m; i++) {\n\n        //cout << list[mp[que.top()]][i] << endl;\n\n        cout << list[mp[tmp]][i] << endl;\n\n        //cout << que.top() << endl;\n\n        //que.pop();\n\n        /*\n\n        cout << \"i: \" << i << endl;\n\n        for(int j = 0; j < list[i].size(); j++) {\n\n            cout << list[i][j]+1 << endl;\n\n        }\n\n        */\n\n        \n\n    }\n\n\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\nvector<vector<int>> s(d+1, vector<int>(26+1, 0));\n\nvector<int> c(26+1);\n\nvector<int> t(d);\n\n\n\nll calc(ll v, int d, int j, vector<ll> last) {\n\n    ll tmp = v;\n\n    ll p = 0;\n\n    last[j] = d;\n\n    //\n\n    for(int i = 0; i < d; i++) {\n\n        tmp -= c[i]*(d-last[i]);\n\n        p -= c[i]*(d-last[i]);\n\n    }\n\n    //return tmp-v;\n\n    p += s[d-1][j];\n\n    return p;\n\n    //return tmp;\n\n}\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nint main() {\n\n    init();\n\n    /////////////////\n\n    vector<int> t(d, 1);\n\n    //vector<ll> ans(d, 0);\n\n    vector<ll> last1(26+1, 0), last2(26+1, 0);\n\n    vector<ll> last(26+1, 0);\n\n    ll v = 0;\n\n    ll tmp1 = 0, tmp2 = -1;\n\n    ll ans = 0;\n\n    for(int i = 0; i < d; i++) {\n\n        //v += s[i][t[i]-1];\n\n        //last[t[i]-1] = i+1;\n\n        for(int j = 0; j < 26; j++) {\n\n            //ans[i] -= c[j]*((i+1)-last[j]);\n\n            //t[i] = j+1;\n\n            last1[j] = i+1; // d\n\n            tmp1 = calc(v+s[i][j], (i+1), (j), last);\n\n            if(tmp2 < tmp1) {\n\n                tmp2 = tmp1;\n\n                last1 = last2;\n\n                last2[j] = i+1;\n\n                t[i] = j+1;\n\n                last[j] = i+1;\n\n            }\n\n            // v -= c[j]*((i+1)-last[j]);\n\n        }\n\n        last1 = last2;\n\n        v += (tmp2-v);\n\n        ans += tmp2;\n\n        tmp1 = 0, tmp2 = 0;\n\n        //cout << \"v: \" << v << endl;\n\n    }\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        //cout << \"i: \" << i << \" \" << t[i] << endl;\n\n        cout << t[i] << endl;\n\n    }\n\n    //cout << ans << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "641",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out, int k) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        //cout << i << endl;\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        //cout << \"out[\" << i << \"] \" << out[i] << \" \";\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    int p = min(int(out.size()+13), d);\n\n    for(int i = out.size(); i < p; i++) {\n\n        //cout << i << endl;\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        //cout << score << endl;\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    /*\n\n    vector<int> out;\n\n    vector<int> ans;\n\n    for(int i = 0; i <= 26; i++) {\n\n        out = proc(i);\n\n        for(int j = 0; j < out.size(); j++) {\n\n\n\n        }\n\n    }\n\n    */\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            for(int k = 0; k < 26; k++) {\n\n                ll tmp = calc(out, k);\n\n                if(max_v < tmp) {\n\n                    max_v = tmp;\n\n                    best = j;\n\n                }\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        //cout << i << endl;\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        //cout << \"out[\" << i << \"] \" << out[i] << \" \";\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    ll q = 0;\n\n    ll score_tmp = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        q = 0;\n\n        int p = min(int(out.size()+k), d);\n\n        for(int i = out.size(); i < p; i++) {\n\n            //cout << i << endl;\n\n            for(int j = 0; j < 26; j++) {\n\n                q -= c[j]*((i)-last[j]);\n\n            }\n\n            //cout << score << endl;\n\n        }\n\n        if(score-score_tmp < score-q) {\n\n            score_tmp = q;\n\n        }\n\n    }\n\n    return score-q;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    /*\n\n    vector<int> out;\n\n    vector<int> ans;\n\n    for(int i = 0; i <= 26; i++) {\n\n        out = proc(i);\n\n        for(int j = 0; j < out.size(); j++) {\n\n\n\n        }\n\n    }\n\n    */\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "642",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out, int k) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        //cout << i << endl;\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        //cout << \"out[\" << i << \"] \" << out[i] << \" \";\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    int p = min(int(out.size()+13), d);\n\n    for(int i = out.size(); i < p; i++) {\n\n        //cout << i << endl;\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        //cout << score << endl;\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    /*\n\n    vector<int> out;\n\n    vector<int> ans;\n\n    for(int i = 0; i <= 26; i++) {\n\n        out = proc(i);\n\n        for(int j = 0; j < out.size(); j++) {\n\n\n\n        }\n\n    }\n\n    */\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            for(int k = 0; k < 26; k++) {\n\n                ll tmp = calc(out, k);\n\n                if(max_v < tmp) {\n\n                    max_v = tmp;\n\n                    best = j;\n\n                }\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    int k = 13;\n\n    //int p = min(int(out.size()+k), d);\n\n    int p = out.size()+k;\n\n    for(int i = out.size(); i < p; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n    }\n\n        \n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "643",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        //cout << i << endl;\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        //cout << \"out[\" << i << \"] \" << out[i] << \" \";\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    ll q = 0;\n\n    ll score_tmp = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        q = 0;\n\n        int p = min(int(out.size()+k), d);\n\n        for(int i = out.size(); i < p; i++) {\n\n            //cout << i << endl;\n\n            for(int j = 0; j < 26; j++) {\n\n                q -= c[j]*((i)-last[j]);\n\n            }\n\n            //cout << score << endl;\n\n        }\n\n        if(score-score_tmp < score-q) {\n\n            score_tmp = q;\n\n        }\n\n    }\n\n    return score-q;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    /*\n\n    vector<int> out;\n\n    vector<int> ans;\n\n    for(int i = 0; i <= 26; i++) {\n\n        out = proc(i);\n\n        for(int j = 0; j < out.size(); j++) {\n\n\n\n        }\n\n    }\n\n    */\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    int k = 13;\n\n    //int p = min(int(out.size()+k), d);\n\n    int p = out.size()+k;\n\n    for(int i = out.size(); i < p; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n    }\n\n        \n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "644",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out, int k) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        //cout << i << endl;\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        //cout << \"out[\" << i << \"] \" << out[i] << \" \";\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    int p = min(int(out.size()+13), d);\n\n    for(int i = out.size(); i < p; i++) {\n\n        //cout << i << endl;\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        //cout << score << endl;\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    /*\n\n    vector<int> out;\n\n    vector<int> ans;\n\n    for(int i = 0; i <= 26; i++) {\n\n        out = proc(i);\n\n        for(int j = 0; j < out.size(); j++) {\n\n\n\n        }\n\n    }\n\n    */\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            for(int k = 0; k < 26; k++) {\n\n                ll tmp = calc(out, k);\n\n                if(max_v < tmp) {\n\n                    max_v = tmp;\n\n                    best = j;\n\n                }\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    //int k = 13;\n\n    //int p = min(int(out.size()+k), d);\n\n    ll q = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        int p = out.size()+k;\n\n        ll tmp = 0;\n\n        for(int i = out.size(); i < p; i++) {\n\n            for(int j = 0; j < 26; j++) {\n\n                //score -= c[j]*((i)-last[j]);\n\n                tmp -= c[j]*((i)-last[j]);\n\n            }\n\n        }\n\n        if(tmp < q) {\n\n            q = tmp;\n\n        }\n\n    }\n\n    return score-q;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "645",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        //cout << i << endl;\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        //cout << \"out[\" << i << \"] \" << out[i] << \" \";\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    ll q = 0;\n\n    ll score_tmp = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        q = 0;\n\n        int p = min(int(out.size()+k), d);\n\n        for(int i = out.size(); i < p; i++) {\n\n            //cout << i << endl;\n\n            for(int j = 0; j < 26; j++) {\n\n                q -= c[j]*((i)-last[j]);\n\n            }\n\n            //cout << score << endl;\n\n        }\n\n        if(score-score_tmp < score-q) {\n\n            score_tmp = q;\n\n        }\n\n    }\n\n    return score-q;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    /*\n\n    vector<int> out;\n\n    vector<int> ans;\n\n    for(int i = 0; i <= 26; i++) {\n\n        out = proc(i);\n\n        for(int j = 0; j < out.size(); j++) {\n\n\n\n        }\n\n    }\n\n    */\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    //int k = 13;\n\n    //int p = min(int(out.size()+k), d);\n\n    ll q = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        int p = out.size()+k;\n\n        ll tmp = 0;\n\n        for(int i = out.size(); i < p; i++) {\n\n            for(int j = 0; j < 26; j++) {\n\n                //score -= c[j]*((i)-last[j]);\n\n                tmp -= c[j]*((i)-last[j]);\n\n            }\n\n        }\n\n        if(tmp < q) {\n\n            q = tmp;\n\n        }\n\n    }\n\n    return score-q;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "646",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out, int k) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        //cout << i << endl;\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        //cout << \"out[\" << i << \"] \" << out[i] << \" \";\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    int p = min(int(out.size()+13), d);\n\n    for(int i = out.size(); i < p; i++) {\n\n        //cout << i << endl;\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        //cout << score << endl;\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    /*\n\n    vector<int> out;\n\n    vector<int> ans;\n\n    for(int i = 0; i <= 26; i++) {\n\n        out = proc(i);\n\n        for(int j = 0; j < out.size(); j++) {\n\n\n\n        }\n\n    }\n\n    */\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            for(int k = 0; k < 26; k++) {\n\n                ll tmp = calc(out, k);\n\n                if(max_v < tmp) {\n\n                    max_v = tmp;\n\n                    best = j;\n\n                }\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    //int k = 13;\n\n    //int p = min(int(out.size()+k), d);\n\n    ll q = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        int p = out.size()+k;\n\n        ll tmp = 0;\n\n        for(int i = out.size(); i < p; i++) {\n\n            for(int j = 0; j < 26; j++) {\n\n                //score -= c[j]*((i)-last[j]);\n\n                tmp -= c[j]*((i+1)-last[j]);\n\n            }\n\n        }\n\n        if(tmp < q) {\n\n            q = tmp;\n\n        }\n\n    }\n\n    return score-q;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "647",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        //cout << i << endl;\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        //cout << \"out[\" << i << \"] \" << out[i] << \" \";\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    ll q = 0;\n\n    ll score_tmp = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        q = 0;\n\n        int p = min(int(out.size()+k), d);\n\n        for(int i = out.size(); i < p; i++) {\n\n            //cout << i << endl;\n\n            for(int j = 0; j < 26; j++) {\n\n                q -= c[j]*((i)-last[j]);\n\n            }\n\n            //cout << score << endl;\n\n        }\n\n        if(score-score_tmp < score-q) {\n\n            score_tmp = q;\n\n        }\n\n    }\n\n    return score-q;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    /*\n\n    vector<int> out;\n\n    vector<int> ans;\n\n    for(int i = 0; i <= 26; i++) {\n\n        out = proc(i);\n\n        for(int j = 0; j < out.size(); j++) {\n\n\n\n        }\n\n    }\n\n    */\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    //int k = 13;\n\n    //int p = min(int(out.size()+k), d);\n\n    ll q = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        int p = out.size()+k;\n\n        ll tmp = 0;\n\n        for(int i = out.size(); i < p; i++) {\n\n            for(int j = 0; j < 26; j++) {\n\n                //score -= c[j]*((i)-last[j]);\n\n                tmp -= c[j]*((i+1)-last[j]);\n\n            }\n\n        }\n\n        if(tmp < q) {\n\n            q = tmp;\n\n        }\n\n    }\n\n    return score-q;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "648",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out, int k) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        //cout << i << endl;\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        //cout << \"out[\" << i << \"] \" << out[i] << \" \";\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    int p = min(int(out.size()+13), d);\n\n    for(int i = out.size(); i < p; i++) {\n\n        //cout << i << endl;\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        //cout << score << endl;\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    /*\n\n    vector<int> out;\n\n    vector<int> ans;\n\n    for(int i = 0; i <= 26; i++) {\n\n        out = proc(i);\n\n        for(int j = 0; j < out.size(); j++) {\n\n\n\n        }\n\n    }\n\n    */\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            for(int k = 0; k < 26; k++) {\n\n                ll tmp = calc(out, k);\n\n                if(max_v < tmp) {\n\n                    max_v = tmp;\n\n                    best = j;\n\n                }\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    //int k = 13;\n\n    //int p = min(int(out.size()+k), d);\n\n    ll q = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        int p = min(int(out.size()+k), int(d));\n\n        ll tmp = 0;\n\n        for(int i = out.size(); i < p; i++) {\n\n            for(int j = 0; j < 26; j++) {\n\n                //score -= c[j]*((i)-last[j]);\n\n                tmp -= c[j]*((i)-last[j]);\n\n            }\n\n        }\n\n        if(tmp > q) {\n\n            q = tmp;\n\n        }\n\n    }\n\n    return score+q;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "649",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out, int k) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        //cout << i << endl;\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        //cout << \"out[\" << i << \"] \" << out[i] << \" \";\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    int p = min(int(out.size()+13), d);\n\n    for(int i = out.size(); i < p; i++) {\n\n        //cout << i << endl;\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        //cout << score << endl;\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    /*\n\n    vector<int> out;\n\n    vector<int> ans;\n\n    for(int i = 0; i <= 26; i++) {\n\n        out = proc(i);\n\n        for(int j = 0; j < out.size(); j++) {\n\n\n\n        }\n\n    }\n\n    */\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            for(int k = 0; k < 26; k++) {\n\n                ll tmp = calc(out, k);\n\n                if(max_v < tmp) {\n\n                    max_v = tmp;\n\n                    best = j;\n\n                }\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n    \n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    //int k = 13;\n\n    //int p = min(int(out.size()+k), d);\n\n    /*\n\n    ll q = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        int p = min(int(out.size()+k), int(d));\n\n        ll tmp = 0;\n\n        for(int i = out.size(); i < p; i++) {\n\n            for(int j = 0; j < 26; j++) {\n\n                //score -= c[j]*((i)-last[j]);\n\n                tmp -= c[j]*((i)-last[j]);\n\n            }\n\n        }\n\n        if(tmp > q) {\n\n            q = tmp;\n\n        }\n\n    }\n\n    */\n\n\n\n    int k = 10;\n\n    int p = min(int(out.size()+k), int(d));\n\n    for(int i = out.size(); i < p; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i)-last[j]);\n\n            //tmp -= c[j]*((i)-last[j]);\n\n        }\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "650",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        //cout << i << endl;\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        //cout << \"out[\" << i << \"] \" << out[i] << \" \";\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    ll q = 0;\n\n    ll score_tmp = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        q = 0;\n\n        int p = min(int(out.size()+k), d);\n\n        for(int i = out.size(); i < p; i++) {\n\n            //cout << i << endl;\n\n            for(int j = 0; j < 26; j++) {\n\n                q -= c[j]*((i)-last[j]);\n\n            }\n\n            //cout << score << endl;\n\n        }\n\n        if(score-score_tmp < score-q) {\n\n            score_tmp = q;\n\n        }\n\n    }\n\n    return score-q;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    /*\n\n    vector<int> out;\n\n    vector<int> ans;\n\n    for(int i = 0; i <= 26; i++) {\n\n        out = proc(i);\n\n        for(int j = 0; j < out.size(); j++) {\n\n\n\n        }\n\n    }\n\n    */\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n    \n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    //int k = 13;\n\n    //int p = min(int(out.size()+k), d);\n\n    /*\n\n    ll q = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        int p = min(int(out.size()+k), int(d));\n\n        ll tmp = 0;\n\n        for(int i = out.size(); i < p; i++) {\n\n            for(int j = 0; j < 26; j++) {\n\n                //score -= c[j]*((i)-last[j]);\n\n                tmp -= c[j]*((i)-last[j]);\n\n            }\n\n        }\n\n        if(tmp > q) {\n\n            q = tmp;\n\n        }\n\n    }\n\n    */\n\n\n\n    int k = 10;\n\n    int p = min(int(out.size()+k), int(d));\n\n    for(int i = out.size(); i < p; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i)-last[j]);\n\n            //tmp -= c[j]*((i)-last[j]);\n\n        }\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "651",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    //int k = 13;\n\n    //int p = min(int(out.size()+k), d);\n\n    ll q = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        int p = min(int(out.size()+k), int(d));\n\n        ll tmp = 0;\n\n        for(int i = out.size(); i < p; i++) {\n\n            for(int j = 0; j < 26; j++) {\n\n                //score -= c[j]*((i)-last[j]);\n\n                tmp -= c[j]*((i)-last[j]);\n\n            }\n\n        }\n\n        if(tmp > q) {\n\n            q = tmp;\n\n        }\n\n    }\n\n    return score+q;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n    \n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    //int k = 13;\n\n    //int p = min(int(out.size()+k), d);\n\n    /*\n\n    ll q = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        int p = min(int(out.size()+k), int(d));\n\n        ll tmp = 0;\n\n        for(int i = out.size(); i < p; i++) {\n\n            for(int j = 0; j < 26; j++) {\n\n                //score -= c[j]*((i)-last[j]);\n\n                tmp -= c[j]*((i)-last[j]);\n\n            }\n\n        }\n\n        if(tmp > q) {\n\n            q = tmp;\n\n        }\n\n    }\n\n    */\n\n\n\n    int k = 10;\n\n    int p = min(int(out.size()+k), int(d));\n\n    for(int i = out.size(); i < p; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i)-last[j]);\n\n            //tmp -= c[j]*((i)-last[j]);\n\n        }\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "652",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out, int k) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        //cout << i << endl;\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        //cout << \"out[\" << i << \"] \" << out[i] << \" \";\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    int p = min(int(out.size()+13), d);\n\n    for(int i = out.size(); i < p; i++) {\n\n        //cout << i << endl;\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        //cout << score << endl;\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    /*\n\n    vector<int> out;\n\n    vector<int> ans;\n\n    for(int i = 0; i <= 26; i++) {\n\n        out = proc(i);\n\n        for(int j = 0; j < out.size(); j++) {\n\n\n\n        }\n\n    }\n\n    */\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            for(int k = 0; k < 26; k++) {\n\n                ll tmp = calc(out, k);\n\n                if(max_v < tmp) {\n\n                    max_v = tmp;\n\n                    best = j;\n\n                }\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\nint k = 0;\n\n\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n    \n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    //int k = 13;\n\n    //int p = min(int(out.size()+k), d);\n\n    /*\n\n    ll q = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        int p = min(int(out.size()+k), int(d));\n\n        ll tmp = 0;\n\n        for(int i = out.size(); i < p; i++) {\n\n            for(int j = 0; j < 26; j++) {\n\n                //score -= c[j]*((i)-last[j]);\n\n                tmp -= c[j]*((i)-last[j]);\n\n            }\n\n        }\n\n        if(tmp > q) {\n\n            q = tmp;\n\n        }\n\n    }\n\n    */\n\n\n\n    //int k = 10;\n\n    ll score_tmp = score;\n\n    ll score_max = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) { \n\n        score_tmp = score;\n\n        int p = min(int(out.size()+k), int(d));\n\n        for(int i = out.size(); i < p; i++) {\n\n            for(int j = 0; j < 26; j++) {\n\n                //score -= c[j]*((i)-last[j]);\n\n                score_tmp -= c[j]*((i)-last[j]);\n\n                //tmp -= c[j]*((i)-last[j]);\n\n            }\n\n        }\n\n        if(score_tmp > score_max) {\n\n            score_max = score_tmp;\n\n        }\n\n    }\n\n    return score_max;\n\n}\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "653",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out, int k) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        //cout << i << endl;\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        //cout << \"out[\" << i << \"] \" << out[i] << \" \";\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    int p = min(int(out.size()+13), d);\n\n    for(int i = out.size(); i < p; i++) {\n\n        //cout << i << endl;\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        //cout << score << endl;\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    /*\n\n    vector<int> out;\n\n    vector<int> ans;\n\n    for(int i = 0; i <= 26; i++) {\n\n        out = proc(i);\n\n        for(int j = 0; j < out.size(); j++) {\n\n\n\n        }\n\n    }\n\n    */\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            for(int k = 0; k < 26; k++) {\n\n                ll tmp = calc(out, k);\n\n                if(max_v < tmp) {\n\n                    max_v = tmp;\n\n                    best = j;\n\n                }\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\nint k = 0;\n\n\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n    \n\n\n\n    //int k = 10;\n\n    k = 3;\n\n    int p = min(int(out.size()+k), int(d));\n\n    for(int i = out.size(); i < p; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n            //tmp -= c[j]*((i)-last[j]);\n\n        }\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "654",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        //cout << i << endl;\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        //cout << \"out[\" << i << \"] \" << out[i] << \" \";\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    ll q = 0;\n\n    ll score_tmp = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        q = 0;\n\n        int p = min(int(out.size()+k), d);\n\n        for(int i = out.size(); i < p; i++) {\n\n            //cout << i << endl;\n\n            for(int j = 0; j < 26; j++) {\n\n                q -= c[j]*((i)-last[j]);\n\n            }\n\n            //cout << score << endl;\n\n        }\n\n        if(score-score_tmp < score-q) {\n\n            score_tmp = q;\n\n        }\n\n    }\n\n    return score-q;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    /*\n\n    vector<int> out;\n\n    vector<int> ans;\n\n    for(int i = 0; i <= 26; i++) {\n\n        out = proc(i);\n\n        for(int j = 0; j < out.size(); j++) {\n\n\n\n        }\n\n    }\n\n    */\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\nint k = 0;\n\n\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n    \n\n\n\n    //int k = 10;\n\n    k = 3;\n\n    int p = min(int(out.size()+k), int(d));\n\n    for(int i = out.size(); i < p; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n            //tmp -= c[j]*((i)-last[j]);\n\n        }\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "655",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\n//int k = 0;\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n\n\n    //int p = min(int(out.size()+k), int(d));\n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    //int k = 13;\n\n    //int p = min(int(out.size()+k), d);\n\n    ll q = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        int p = min(int(out.size()+k), int(d));\n\n        ll tmp = 0;\n\n        for(int i = out.size(); i < p; i++) {\n\n            for(int j = 0; j < 26; j++) {\n\n                //score -= c[j]*((i)-last[j]);\n\n                tmp -= c[j]*((i)-last[j]);\n\n            }\n\n        }\n\n        if(tmp > q) {\n\n            q = tmp;\n\n        }\n\n    }\n\n    return score+q;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\nint k = 0;\n\n\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n    \n\n\n\n    //int k = 10;\n\n    k = 3;\n\n    int p = min(int(out.size()+k), int(d));\n\n    for(int i = out.size(); i < p; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n            //tmp -= c[j]*((i)-last[j]);\n\n        }\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "656",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\nint k = 0;\n\n\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n    \n\n    //cout << p << endl;\n\n    //if(out.size() >= d) return score;\n\n    //cout << k << endl;\n\n    //cout << out.size() << \" \" << d << endl;\n\n    //int p = min(int(out.size()+k), d);\n\n    //int k = 13;\n\n    //int p = min(int(out.size()+k), d);\n\n    /*\n\n    ll q = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) {\n\n        int p = min(int(out.size()+k), int(d));\n\n        ll tmp = 0;\n\n        for(int i = out.size(); i < p; i++) {\n\n            for(int j = 0; j < 26; j++) {\n\n                //score -= c[j]*((i)-last[j]);\n\n                tmp -= c[j]*((i)-last[j]);\n\n            }\n\n        }\n\n        if(tmp > q) {\n\n            q = tmp;\n\n        }\n\n    }\n\n    */\n\n\n\n    //int k = 10;\n\n    ll score_tmp = score;\n\n    ll score_max = LLONG_MIN;\n\n    for(int k = 0; k < 26; k++) { \n\n        score_tmp = score;\n\n        int p = min(int(out.size()+k), int(d));\n\n        for(int i = out.size(); i < p; i++) {\n\n            for(int j = 0; j < 26; j++) {\n\n                //score -= c[j]*((i)-last[j]);\n\n                score_tmp -= c[j]*((i)-last[j]);\n\n                //tmp -= c[j]*((i)-last[j]);\n\n            }\n\n        }\n\n        if(score_tmp > score_max) {\n\n            score_max = score_tmp;\n\n        }\n\n    }\n\n    return score_max;\n\n}\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <cmath>\n\n#include <climits>\n\nusing namespace std;\n\n#define ll long long\n\n\n\nint d = 365;\n\nint k = 0;\n\n\n\nvector<vector<int>> s(d, vector<int>(26, 0));\n\nvector<ll> c(26);\n\n\n\nvoid init() {\n\n    cin >> d;\n\n    for(int i = 0; i < 26; i++) cin >> c[i];\n\n    for(int i = 0; i < d; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            cin >> s[i][j];\n\n        }\n\n    }\n\n    return;\n\n}\n\n\n\nll calc(vector<int> out) {\n\n    ll score = 0;\n\n    vector<ll> last(26, 0);\n\n    for(int i = 0; i < out.size(); i++) {\n\n        last[out[i]] = i+1; // \u30bf\u30a4\u30d7\u756a\u53f7\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n        }\n\n        score += s[i][out[i]];\n\n        //cout << \"score : \" << score << endl;\n\n    }\n\n    \n\n\n\n    //int k = 10;\n\n    k = 3;\n\n    int p = min(int(out.size()+k), int(d));\n\n    for(int i = out.size(); i < p; i++) {\n\n        for(int j = 0; j < 26; j++) {\n\n            score -= c[j]*((i+1)-last[j]);\n\n            //tmp -= c[j]*((i)-last[j]);\n\n        }\n\n    }\n\n    return score;\n\n}\n\n\n\n/*\n\nvector<int> proc(int k) {\n\n    vector<int> out;\n\n    ll ans = 0;\n\n    //ll tmp = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n    //cout << \"k: \" << k << endl;\n\n    //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    return out;\n\n}\n\n*/\n\n\n\nint main() {\n\n    init();\n\n    \n\n    vector<int> out;\n\n    ll ans = 0;\n\n    ll max_v = -1;\n\n    //for(int k = 0; k < 26; k++) {\n\n        //cout << \"k: \" << k << endl;\n\n        //vector<int> out;\n\n    for(int i = 0; i < d; i++) {\n\n        //max_v = -100000000000;\n\n        max_v = LLONG_MIN;\n\n        int best = 0;\n\n        for(int j = 0; j < 26; j++) {\n\n            out.push_back(j);\n\n            //for(int k = 0; k < 26; k++) {\n\n            ll tmp = calc(out);\n\n            if(max_v < tmp) {\n\n                max_v = tmp;\n\n                best = j;\n\n            }\n\n            //}\n\n            out.pop_back();\n\n        }\n\n        out.push_back(best);\n\n    }\n\n    //}\n\n    \n\n    for(int i = 0; i < d; i++) {\n\n        cout << out[i]+1 << endl;\n\n    }\n\n    //cout << max_v << endl;\n\n    return 0;\n\n}"
    },
    {
        "id": "657",
        "source_code": "#include <bits/stdc++.h>\n\n#define ALL(x) (x).begin(),(x).end()\n\n#define PB push_back\n\n#define MP make_pair\n\n#define Mod 998244353\n\n#define MOD 1000000007\n\nusing namespace std;\n\nusing lint = long long;\n\nusing vi = vector<lint>;\n\nusing vvi = vector<vi>;\n\nusing vvvi = vector<vvi>;\n\n\n\n// cout << fixed << setprecision(12)\n\n\n\nint main(){\n\n  \n\n  lint D; cin >> D;\n\n  vi c(26); // contest 0-25\n\n  for(lint i=0; i<26; i++) cin >> c[i];\n\n  vvi s(D+1, vi(26)); // day 0-D\n\n  for(lint d=1; d<=D; d++){\n\n    for(lint j=0; j<26; j++){\n\n      cin >> s[d][j];\n\n    }\n\n  }\n\n  \n\n  vi t(D+1); // day 0-D\n\n  /*\n\n  for(lint d=1; d<=D; d++){\n\n    cin >> t[d];\n\n    t[d]--;\n\n  }\n\n  */\n\n  \n\n  vi last(26,0);\n\n  \n\n  // lint ans = 0;\n\n  \n\n  // lint incr = 2;\n\n  \n\n  for(lint d=1; d<=D-1; d+=2){// 2days!!!!!\n\n    vvi diff(26, vi(26));\n\n    \n\n    for(lint i=0; i<26; i++){ // if contest i (0-25)\n\n      for(lint ii=0 ;ii<26; ii++){\n\n        // ans += s[d][t[d]];\n\n        lint plus = s[d][i];\n\n    \n\n        // last[t[d]] = d;\n\n        lint oldlast = last[i];\n\n        last[i] = d;\n\n    \n\n        lint minus = 0;\n\n    \n\n        for(lint j=0; j<26; j++){\n\n          // ans -= c[j] * (d - last[j]);\n\n          minus += c[j] * (d - last[j]);\n\n        }\n\n      \n\n        // last[i] = oldlast;\n\n        // diff[i] = plus - minus;\n\n        \n\n        ////////////////////\n\n        \n\n        // ans += s[d][t[d]];\n\n        lint pluss = s[d+1][ii];\n\n    \n\n        // last[t[d]] = d;\n\n        lint oldlastt = last[ii];\n\n        last[ii] = d+1;\n\n    \n\n        lint minuss = 0;\n\n    \n\n        for(lint j=0; j<26; j++){\n\n          // ans -= c[j] * (d - last[j]);\n\n          minuss += c[j] * (d+1 - last[j]);\n\n        }\n\n      \n\n        // last[i] = oldlast;\n\n        // diff[i] = plus - minus;\n\n        \n\n        ////////////////////\n\n        \n\n        diff[i][ii] = plus + pluss - minus - minuss;\n\n        last[i] = oldlast;\n\n        last[ii] = oldlastt;\n\n      }\n\n    }\n\n    \n\n    vi soto (0);\n\n    for(lint i=0; i<26; i++){\n\n      for(lint ii=0; ii<26; ii++){\n\n        soto.PB(diff[i][ii]);\n\n      }\n\n    }\n\n    sort(ALL(soto));\n\n    // reverse(ALL(soto));\n\n    lint t = -1;\n\n    lint tt = -1;\n\n    for(lint i=0; i<26; i++){\n\n      for(lint ii=0; ii<26; ii++){\n\n        if(diff[i][ii] == soto[0]){\n\n          t = i;\n\n          tt = ii;\n\n        }\n\n      }\n\n    }\n\n    cout << t+1 << endl;\n\n    cout << tt+1 << endl;\n\n    last[t] = d;\n\n    last[tt] = d+1;\n\n    \n\n  }\n\n  \n\n  // 364 days so far\n\n  // last one day\n\n  \n\n  vi dif(26);\n\n  for(lint i=0; i<26; i++){\n\n    lint plu = s[D][i];\n\n    // lint oldlas = last[i];\n\n    last[i] = D;\n\n    \n\n    lint minu = 0;\n\n    \n\n    for(lint j=0; j<26; j++){\n\n    minu += c[j] * (D - last[j]);\n\n    }\n\n    \n\n    dif[i] = plu - minu;\n\n  }\n\n  \n\n  vi sot(0);\n\n    for(lint i=0; i<26; i++){\n\n      sot.PB(dif[i]);\n\n    }\n\n    sort(ALL(sot));\n\n    lint tl = -1;\n\n    for(lint i=0; i<26; i++){\n\n      if(dif[i] == sot[sot.size()-1]){\n\n        tl = i;\n\n      }\n\n    }\n\n  cout << tl+1 << endl;\n\n}\n\n \n\n  \n\n  \n\n  \n\n  ",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define ALL(x) (x).begin(),(x).end()\n\n#define PB push_back\n\n#define MP make_pair\n\n#define Mod 998244353\n\n#define MOD 1000000007\n\nusing namespace std;\n\nusing lint = long long;\n\nusing vi = vector<lint>;\n\nusing vvi = vector<vi>;\n\nusing vvvi = vector<vvi>;\n\n\n\n// cout << fixed << setprecision(12)\n\n\n\nint main(){\n\n  \n\n  lint D; cin >> D;\n\n  vi c(26); // contest 0-25\n\n  for(lint i=0; i<26; i++) cin >> c[i];\n\n  vvi s(D+1, vi(26)); // day 0-D\n\n  for(lint d=1; d<=D; d++){\n\n    for(lint j=0; j<26; j++){\n\n      cin >> s[d][j];\n\n    }\n\n  }\n\n  /*\n\n  vi t(D+1); // day 0-D\n\n  \n\n  for(lint d=1; d<=D; d++){\n\n    cin >> t[d];\n\n    t[d]--;\n\n  }\n\n  */\n\n  \n\n  vi last(26,0);\n\n  \n\n  // lint ans = 0;\n\n  vi ans(D+1);\n\n  \n\n  for(lint d=1; d<=D; d++){\n\n    vi diff(26);\n\n    \n\n    for(lint i=0; i<26; i++){ // if contest i (0-25)\n\n      // ans += s[d][t[d]];\n\n      lint plus = s[d][i];\n\n    \n\n      // last[t[d]] = d;\n\n      lint oldlast = last[i];\n\n      last[i] = d;\n\n    \n\n      lint minus = 0;\n\n    \n\n      for(lint j=0; j<26; j++){\n\n        // ans -= c[j] * (d - last[j]);\n\n        minus += c[j] * (d - last[j]);\n\n      }\n\n      \n\n      last[i] = oldlast;\n\n      diff[i] = plus - minus;\n\n    }\n\n    \n\n    vi oldiff = diff;\n\n    sort(ALL(diff));\n\n    lint t = -1;\n\n    for(lint j=0; j<26; j++){\n\n      if(oldiff[j] == diff[25]) t = j;\n\n    }\n\n    // cout << t+1 << endl;\n\n    ans[d] = t+1;\n\n    last[t] = d;\n\n    \n\n  }\n\n  /*\n\n  sort(ALL(c));\n\n  lint tmp = 18; // delete suru kosuu\n\n  for(lint j=0; j<tmp; j++) c.pop_back();\n\n          \n\n  for(lint d=1; d<=D; d++){\n\n    cout << c[d%(26-tmp)] << endl;\n\n  }\n\n  */\n\n  \n\n  lint times = 1;\n\n  for(lint i=0; i<times; i++){\n\n    lint rd = rand()%25;\n\n    swap(ans[rd], ans[rd+1]);\n\n  }\n\n  \n\n  for(lint d=1; d<=D; d++) cout << ans[d] << endl;\n\n}\n\n      \n\n      \n\n    \n\n  \n\n  \n\n  \n\n  \n"
    },
    {
        "id": "658",
        "source_code": "#include <bits/stdc++.h>\n\n#define ALL(x) (x).begin(),(x).end()\n\n#define PB push_back\n\n#define MP make_pair\n\n#define Mod 998244353\n\n#define MOD 1000000007\n\nusing namespace std;\n\nusing lint = long long;\n\nusing vi = vector<lint>;\n\nusing vvi = vector<vi>;\n\nusing vvvi = vector<vvi>;\n\n\n\n// cout << fixed << setprecision(12)\n\n\n\nint main(){\n\n  \n\n  lint D; cin >> D;\n\n  vi c(26); // contest 0-25\n\n  for(lint i=0; i<26; i++) cin >> c[i];\n\n  vvi s(D+1, vi(26)); // day 0-D\n\n  for(lint d=1; d<=D; d++){\n\n    for(lint j=0; j<26; j++){\n\n      cin >> s[d][j];\n\n    }\n\n  }\n\n  \n\n  vi t(D+1); // day 0-D\n\n  /*\n\n  for(lint d=1; d<=D; d++){\n\n    cin >> t[d];\n\n    t[d]--;\n\n  }\n\n  */\n\n  \n\n  vi last(26,0);\n\n  \n\n  // lint ans = 0;\n\n  \n\n  // lint incr = 2;\n\n  \n\n  for(lint d=1; d<=D-1; d+=2){// 2days!!!!!\n\n    vvi diff(26, vi(26));\n\n    \n\n    for(lint i=0; i<26; i++){ // if contest i (0-25)\n\n      for(lint ii=0 ;ii<26; ii++){\n\n        // ans += s[d][t[d]];\n\n        lint plus = s[d][i];\n\n    \n\n        // last[t[d]] = d;\n\n        lint oldlast = last[i];\n\n        last[i] = d;\n\n    \n\n        lint minus = 0;\n\n    \n\n        for(lint j=0; j<26; j++){\n\n          // ans -= c[j] * (d - last[j]);\n\n          minus += c[j] * (d - last[j]);\n\n        }\n\n      \n\n        // last[i] = oldlast;\n\n        // diff[i] = plus - minus;\n\n        \n\n        ////////////////////\n\n        \n\n        // ans += s[d][t[d]];\n\n        lint pluss = s[d+1][ii];\n\n    \n\n        // last[t[d]] = d;\n\n        lint oldlastt = last[ii];\n\n        last[ii] = d+1;\n\n    \n\n        lint minuss = 0;\n\n    \n\n        for(lint j=0; j<26; j++){\n\n          // ans -= c[j] * (d - last[j]);\n\n          minuss += c[j] * (d+1 - last[j]);\n\n        }\n\n      \n\n        // last[i] = oldlast;\n\n        // diff[i] = plus - minus;\n\n        \n\n        ////////////////////\n\n        \n\n        diff[i][ii] = plus + pluss - minus - minuss;\n\n        last[i] = oldlast;\n\n        last[ii] = oldlastt;\n\n      }\n\n    }\n\n    \n\n    vi soto (0);\n\n    for(lint i=0; i<26; i++){\n\n      for(lint ii=0; ii<26; ii++){\n\n        soto.PB(diff[i][ii]);\n\n      }\n\n    }\n\n    sort(ALL(soto));\n\n    reverse(ALL(soto));\n\n    lint t = -1;\n\n    lint tt = -1;\n\n    for(lint i=0; i<26; i++){\n\n      for(lint ii=0; ii<26; ii++){\n\n        if(diff[i][ii] == soto[0]){\n\n          t = i;\n\n          tt = ii;\n\n        }\n\n      }\n\n    }\n\n    cout << t+1 << endl;\n\n    cout << tt+1 << endl;\n\n    last[t] = d;\n\n    last[tt] = d+1;\n\n    \n\n  }\n\n  \n\n  // 364 days so far\n\n  // last one day\n\n  \n\n  vi dif(26);\n\n  for(lint i=0; i<26; i++){\n\n    lint plu = s[D][i];\n\n    // lint oldlas = last[i];\n\n    last[i] = D;\n\n    \n\n    lint minu = 0;\n\n    \n\n    for(lint j=0; j<26; j++){\n\n    minu += c[j] * (D - last[j]);\n\n    }\n\n    \n\n    dif[i] = plu - minu;\n\n  }\n\n  \n\n  vi sot(0);\n\n    for(lint i=0; i<26; i++){\n\n      sot.PB(dif[i]);\n\n    }\n\n    sort(ALL(sot));\n\n    // lint tl = -1;\n\n    for(lint i=0; i<26; i++){\n\n      if(dif[i] == sot[sot.size()-1]){\n\n        // tl = i;\n\n        cout << i+1 << endl;\n\n        break;\n\n      }\n\n    }\n\n // cout << tl+1 << endl;\n\n}\n\n \n\n  \n\n  \n\n  \n\n  ",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define ALL(x) (x).begin(),(x).end()\n\n#define PB push_back\n\n#define MP make_pair\n\n#define Mod 998244353\n\n#define MOD 1000000007\n\nusing namespace std;\n\nusing lint = long long;\n\nusing vi = vector<lint>;\n\nusing vvi = vector<vi>;\n\nusing vvvi = vector<vvi>;\n\n\n\n// cout << fixed << setprecision(12)\n\n\n\nint main(){\n\n  \n\n  lint D; cin >> D;\n\n  vi c(26); // contest 0-25\n\n  for(lint i=0; i<26; i++) cin >> c[i];\n\n  vvi s(D+1, vi(26)); // day 0-D\n\n  for(lint d=1; d<=D; d++){\n\n    for(lint j=0; j<26; j++){\n\n      cin >> s[d][j];\n\n    }\n\n  }\n\n  /*\n\n  vi t(D+1); // day 0-D\n\n  \n\n  for(lint d=1; d<=D; d++){\n\n    cin >> t[d];\n\n    t[d]--;\n\n  }\n\n  */\n\n  \n\n  vi last(26,0);\n\n  \n\n  // lint ans = 0;\n\n  vi ans(D+1);\n\n  \n\n  for(lint d=1; d<=D; d++){\n\n    vi diff(26);\n\n    \n\n    for(lint i=0; i<26; i++){ // if contest i (0-25)\n\n      // ans += s[d][t[d]];\n\n      lint plus = s[d][i];\n\n    \n\n      // last[t[d]] = d;\n\n      lint oldlast = last[i];\n\n      last[i] = d;\n\n    \n\n      lint minus = 0;\n\n    \n\n      for(lint j=0; j<26; j++){\n\n        // ans -= c[j] * (d - last[j]);\n\n        minus += c[j] * (d - last[j]);\n\n      }\n\n      \n\n      last[i] = oldlast;\n\n      diff[i] = plus - minus;\n\n    }\n\n    \n\n    vi oldiff = diff;\n\n    sort(ALL(diff));\n\n    lint t = -1;\n\n    for(lint j=0; j<26; j++){\n\n      if(oldiff[j] == diff[25]) t = j;\n\n    }\n\n    // cout << t+1 << endl;\n\n    ans[d] = t+1;\n\n    last[t] = d;\n\n    \n\n  }\n\n  /*\n\n  sort(ALL(c));\n\n  lint tmp = 18; // delete suru kosuu\n\n  for(lint j=0; j<tmp; j++) c.pop_back();\n\n          \n\n  for(lint d=1; d<=D; d++){\n\n    cout << c[d%(26-tmp)] << endl;\n\n  }\n\n  */\n\n  \n\n  lint times = 1;\n\n  for(lint i=0; i<times; i++){\n\n    lint rd = rand()%25;\n\n    swap(ans[rd], ans[rd+1]);\n\n  }\n\n  \n\n  for(lint d=1; d<=D; d++) cout << ans[d] << endl;\n\n}\n\n      \n\n      \n\n    \n\n  \n\n  \n\n  \n\n  \n"
    },
    {
        "id": "659",
        "source_code": "#include <bits/stdc++.h>\n\n#include <cstdlib>\n\n#include <cmath>\n\n#include <algorithm>\n\nusing namespace std;\n\nusing ll = long long;\n\nusing P = pair<int,int>;\n\nusing Graph= vector<vector<int>>; \n\n#define rep(i,n) for (ll i=0; i < (n); ++i)\n\n#define rep2(i,n,m) for(ll i=n;i<=m;i++)\n\n#define rep3(i,n,m) for(ll i=n;i>=m;i--)\n\n#define pb push_back\n\n#define eb emplace_back\n\n#define ppb pop_back\n\n#define mpa make_pair\n\nconst ll INF=1e18 ;\n\ninline void chmax(ll& a,ll b){a=max(a,b);}\n\ninline void chmin(ll& a,ll b){a=min(a,b);}\n\n\n\n\n\nint main(){\n\n ll d ; cin>> d ;\n\n ll c[26] ; rep(i,26) cin>>c[i] ;\n\n ll s[d][26] ;\n\n vector<ll> bns(d)  ;\n\n  rep(i,d){\n\n     rep(j,26){\n\n        cin>> s[i][j] ;\n\n        if(s[i][bns[i]] <s[i][j]) bns[i]= j ;\n\n     }\n\n }\n\n \n\n ll t[d] ; \n\n \n\n rep(i,d){\n\n   t[i]=(bns[0]+i)%26 ;\n\n }\n\n \n\n ll m= 365*100 ;\n\n ll p[m] ;ll q[m] ;\n\n rep(i,m){\n\n   p[i]=m%365 ;\n\n   ll a= p[i] ;\n\n   q[i]= bns[a] ;\n\n }\n\n ll ans=0 ;\n\nll last[26] ; rep(i,26) last[i]=0 ;\n\nrep(i,d){\n\n  ans+= s[i][t[i]] ;\n\n  rep(i,26) last[i] ++ ;\n\n  last[t[i]]=0 ;\n\n  ll sum=0 ;\n\n  rep(i,26) sum+= c[i]*last[i] ;\n\n  ans-= sum ;\n\n  }\n\n  \n\n  \n\n  \n\n  rep(i,m){\n\n   ll rans= ans ;\n\n   ll memo = t[p[i]] ;\n\n   t[p[i]]= q[i] ;\n\n   ll maex=p[i]+1, atox= d-p[i] ;\n\n   ll maey=p[i]+1 ,atoy= d-p[i] ;\n\n    rep(j,d){\n\n     if(t[j]==memo&&j<p[i]) maex=p[i]-j ;\n\n     if(t[j]==memo&&j>p[i]){\n\n       atox= j-p[i] ;\n\n       break ;\n\n     }\n\n    }\n\n    rep(j,d){\n\n     if(t[j]==q[i]&&j<p[i]) maey=p[i]-j ;\n\n     if(t[j]==q[i]&&j>p[i]){\n\n       atoy= j-p[i] ;\n\n       break ;\n\n     }\n\n    }\n\n    ans -= c[memo]*atox*maex ;\n\n    ans += c[q[i]]*atoy*maey ;\n\n    ans = ans- s[p[i]][memo] + s[p[i]][q[i]] ;\n\n    if(ans<rans){\n\n      t[p[i]]= memo ;\n\n    }\n\n  }\n\n\n\n   rep(i,d) cout<< t[i]+1<<endl ;\n\n return 0 ;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n#include <cstdlib>\n\n#include <cmath>\n\n#include <algorithm>\n\nusing namespace std;\n\nusing ll = long long;\n\nusing P = pair<int,int>;\n\nusing Graph= vector<vector<int>>; \n\n#define rep(i,n) for (ll i=0; i < (n); ++i)\n\n#define rep2(i,n,m) for(ll i=n;i<=m;i++)\n\n#define rep3(i,n,m) for(ll i=n;i>=m;i--)\n\n#define pb push_back\n\n#define eb emplace_back\n\n#define ppb pop_back\n\n#define mpa make_pair\n\nconst ll INF=1e18 ;\n\ninline void chmax(ll& a,ll b){a=max(a,b);}\n\ninline void chmin(ll& a,ll b){a=min(a,b);}\n\n\n\n\n\nint main(){\n\n ll d ; cin>> d ;\n\n ll c[26] ; rep(i,26) cin>>c[i] ;\n\n ll s[d][26] ;\n\n vector<ll> bns(d)  ;\n\n  rep(i,d){\n\n     rep(j,26){\n\n        cin>> s[i][j] ;\n\n        if(s[i][bns[i]] <s[i][j]) bns[i]= j ;\n\n     }\n\n }\n\n \n\n ll t[d] ; \n\n \n\n rep(i,d){\n\n   t[i]=(bns[0]+i)%26 ;\n\n }\n\n \n\n ll m= 365*100 ;\n\n ll p[m] ;ll q[m] ;\n\n rep(i,m){\n\n   p[i]=m%365 ;\n\n   ll a= m/365 ;\n\n   q[i]= 25- ((i+a)%26) ;\n\n }\n\n ll ans=0 ;\n\nll last[26] ; rep(i,26) last[i]=0 ;\n\nrep(i,d){\n\n  ans+= s[i][t[i]] ;\n\n  rep(i,26) last[i] ++ ;\n\n  last[t[i]]=0 ;\n\n  ll sum=0 ;\n\n  rep(i,26) sum+= c[i]*last[i] ;\n\n  ans-= sum ;\n\n  }\n\n  \n\n  \n\n  \n\n  rep(i,m){\n\n   ll rans= ans ;\n\n   ll memo = t[p[i]] ;\n\n   t[p[i]]= q[i] ;\n\n   ll maex=p[i]+1, atox= d-p[i] ;\n\n   ll maey=p[i]+1 ,atoy= d-p[i] ;\n\n    rep(j,d){\n\n     if(t[j]==memo&&j<p[i]) maex=p[i]-j ;\n\n     if(t[j]==memo&&j>p[i]){\n\n       atox= j-p[i] ;\n\n       break ;\n\n     }\n\n    }\n\n    rep(j,d){\n\n     if(t[j]==q[i]&&j<p[i]) maey=p[i]-j ;\n\n     if(t[j]==q[i]&&j>p[i]){\n\n       atoy= j-p[i] ;\n\n       break ;\n\n     }\n\n    }\n\n    ans -= c[memo]*atox*maex ;\n\n    ans += c[q[i]]*atoy*maey ;\n\n    ans = ans- s[p[i]][memo] + s[p[i]][q[i]] ;\n\n    if(ans<rans){\n\n      t[p[i]]= memo ;\n\n    }\n\n  }\n\n\n\n   rep(i,d) cout<< t[i]+1<<endl ;\n\n return 0 ;\n\n}\n"
    },
    {
        "id": "660",
        "source_code": "#include <stdio.h>\n\n#include <iostream>\n\n#include <vector>\n\n#include <queue>\n\n#include <stack>\n\n#include <algorithm>\n\n#include <numeric>\n\n#include <iterator>\n\n#include <random>\n\n\n\nusing ll = long long int;\n\nusing P = std::pair<ll, int>;\n\nconst int INF = (1<<30);\n\nconst ll INFLL = (1ll<<60);\n\nconst ll MOD = (ll)(1e9+7);\n\n\n\n#define l_ength size\n\n\n\nvoid mul_mod(ll& a, ll b){\n\n\ta *= b;\n\n\ta %= MOD;\n\n}\n\n\n\nvoid add_mod(ll& a, ll b){\n\n\ta = (a<MOD)?a:(a-MOD);\n\n\tb = (b<MOD)?b:(b-MOD);\n\n\ta += b;\n\n\ta = (a<MOD)?a:(a-MOD);\n\n}\n\n\n\nint l[30];\n\nll c[30],s[400][30],ans[3];\n\n\n\nint main(void){\n\n\tint d,i,j,n=26,k,m=100;\n\n\tll ansm = -INFLL;\n\n\tstd::vector<int> v[m];\n\n\tfor(k=0; k<m; ++k){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tv[k].push_back(j);\n\n\t\t}\n\n\t\tstd::random_device seed_gen;\n\n\t\tstd::mt19937 engine(seed_gen());\n\n\t\tstd::shuffle(v[k].begin(), v[k].end(), engine);\n\n\t}\n\n\tstd::cin >> d;\n\n\tfor(i=0; i<26; ++i){\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tstd::cin >> s[i][j];\n\n\t\t}\n\n\t}\n\n\tfor(k=0; k<m; ++k){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tl[j] = -1;\n\n\t\t}\n\n\t\tfor(i=0; i<d; ++i){\n\n\t\t\tans[k] += s[i][v[k][i%26]];\n\n\t\t\tl[v[k][i%26]] = i;\n\n\t\t\tfor(j=0; j<n; ++j){\n\n\t\t\t\tans[k] -= c[j]*(i-l[j]);\n\n\t\t\t}\n\n\t\t}\n\n\t\tansm = std::max(ansm,ans[k]);\n\n\t}\n\n\tfor(k=0; k<m; ++k){\n\n\t\tif(ans[k] == ansm){\n\n\t\t\tfor(i=0; i<d; ++i){\n\n\t\t\t\tstd::cout << v[k][i%26]+1 << std::endl;\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n#include <iostream>\n\n#include <vector>\n\n#include <queue>\n\n#include <stack>\n\n#include <algorithm>\n\n#include <numeric>\n\n#include <iterator>\n\n#include <random>\n\n\n\nusing ll = long long int;\n\nusing P = std::pair<ll, int>;\n\nconst int INF = (1<<30);\n\nconst ll INFLL = (1ll<<60);\n\nconst ll MOD = (ll)(1e9+7);\n\n\n\n#define l_ength size\n\n\n\nvoid mul_mod(ll& a, ll b){\n\n\ta *= b;\n\n\ta %= MOD;\n\n}\n\n\n\nvoid add_mod(ll& a, ll b){\n\n\ta = (a<MOD)?a:(a-MOD);\n\n\tb = (b<MOD)?b:(b-MOD);\n\n\ta += b;\n\n\ta = (a<MOD)?a:(a-MOD);\n\n}\n\n\n\nint l[30];\n\nll c[30],s[400][30];\n\nstd::vector<P> v;\n\n\n\nint main(void){\n\n\tint d,i,j,n=26;\n\n\tll ansm = -INFLL;\n\n\tstd::cin >> d;\n\n\tfor(i=0; i<n; ++i){\n\n\t\tl[i] = -1;\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tstd::cin >> s[i][j];\n\n\t\t}\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tv.push_back(P(s[i][j]+c[j]*(i-l[j]),j+1));\n\n\t\t}\n\n\t\tstd::sort(v.begin(),v.end(),std::greater<P>());\n\n\t\tstd::cout << v[0].second << std::endl;\n\n\t}\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "661",
        "source_code": "#include <stdio.h>\n\n#include <iostream>\n\n#include <vector>\n\n#include <queue>\n\n#include <stack>\n\n#include <algorithm>\n\n#include <numeric>\n\n#include <iterator>\n\n#include <random>\n\n\n\nusing ll = long long int;\n\nusing P = std::pair<ll, int>;\n\nconst int INF = (1<<30);\n\nconst ll INFLL = (1ll<<60);\n\nconst ll MOD = (ll)(1e9+7);\n\n\n\n#define l_ength size\n\n\n\nvoid mul_mod(ll& a, ll b){\n\n\ta *= b;\n\n\ta %= MOD;\n\n}\n\n\n\nvoid add_mod(ll& a, ll b){\n\n\ta = (a<MOD)?a:(a-MOD);\n\n\tb = (b<MOD)?b:(b-MOD);\n\n\ta += b;\n\n\ta = (a<MOD)?a:(a-MOD);\n\n}\n\n\n\nint l[30];\n\nll c[30],s[400][30],ans[111];\n\n\n\nint main(void){\n\n\tint d,i,j,n=26,k,m=100;\n\n\tll ansm = -INFLL;\n\n\tstd::vector<int> v[m];\n\n\tfor(k=0; k<m; ++k){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tv[k].push_back(j);\n\n\t\t}\n\n\t\tstd::random_device seed_gen;\n\n\t\tstd::mt19937 engine(seed_gen());\n\n\t\tstd::shuffle(v[k].begin(), v[k].end(), engine);\n\n\t}\n\n\tstd::cin >> d;\n\n\tfor(i=0; i<26; ++i){\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tstd::cin >> s[i][j];\n\n\t\t}\n\n\t}\n\n\tfor(k=0; k<m; ++k){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tl[j] = -1;\n\n\t\t}\n\n\t\tfor(i=0; i<d; ++i){\n\n\t\t\tans[k] += s[i][v[k][i%26]];\n\n\t\t\tl[v[k][i%26]] = i;\n\n\t\t\tfor(j=0; j<n; ++j){\n\n\t\t\t\tans[k] -= c[j]*(i-l[j]);\n\n\t\t\t}\n\n\t\t}\n\n\t\tansm = std::max(ansm,ans[k]);\n\n\t\t// std::cout << ans[k] << std::endl;\n\n\t}\n\n\tfor(k=0; k<m; ++k){\n\n\t\tif(ans[k] == ansm){\n\n\t\t\tfor(i=0; i<d; ++i){\n\n\t\t\t\tstd::cout << v[k][i%26]+1 << std::endl;\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n#include <iostream>\n\n#include <vector>\n\n#include <queue>\n\n#include <stack>\n\n#include <algorithm>\n\n#include <numeric>\n\n#include <iterator>\n\n#include <random>\n\n\n\nusing ll = long long int;\n\nusing P = std::pair<ll, int>;\n\nconst int INF = (1<<30);\n\nconst ll INFLL = (1ll<<60);\n\nconst ll MOD = (ll)(1e9+7);\n\n\n\n#define l_ength size\n\n\n\nvoid mul_mod(ll& a, ll b){\n\n\ta *= b;\n\n\ta %= MOD;\n\n}\n\n\n\nvoid add_mod(ll& a, ll b){\n\n\ta = (a<MOD)?a:(a-MOD);\n\n\tb = (b<MOD)?b:(b-MOD);\n\n\ta += b;\n\n\ta = (a<MOD)?a:(a-MOD);\n\n}\n\n\n\nint l[30];\n\nll c[30],s[400][30];\n\nstd::vector<P> v;\n\n\n\nint main(void){\n\n\tint d,i,j,n=26;\n\n\tll ansm = -INFLL;\n\n\tstd::cin >> d;\n\n\tfor(i=0; i<n; ++i){\n\n\t\tl[i] = -1;\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tstd::cin >> s[i][j];\n\n\t\t}\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tv.push_back(P(s[i][j]+c[j]*(i-l[j]),j+1));\n\n\t\t}\n\n\t\tstd::sort(v.begin(),v.end(),std::greater<P>());\n\n\t\tstd::cout << v[0].second << std::endl;\n\n\t}\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "662",
        "source_code": "#include <stdio.h>\n\n#include <iostream>\n\n#include <vector>\n\n#include <queue>\n\n#include <stack>\n\n#include <algorithm>\n\n#include <numeric>\n\n#include <iterator>\n\n#include <random>\n\n\n\nusing ll = long long int;\n\nusing P = std::pair<ll, int>;\n\nconst int INF = (1<<30);\n\nconst ll INFLL = (1ll<<60);\n\nconst ll MOD = (ll)(1e9+7);\n\n\n\n#define l_ength size\n\n\n\nvoid mul_mod(ll& a, ll b){\n\n\ta *= b;\n\n\ta %= MOD;\n\n}\n\n\n\nvoid add_mod(ll& a, ll b){\n\n\ta = (a<MOD)?a:(a-MOD);\n\n\tb = (b<MOD)?b:(b-MOD);\n\n\ta += b;\n\n\ta = (a<MOD)?a:(a-MOD);\n\n}\n\n\n\nint l[30];\n\nll c[30],s[400][30],ans[3];\n\n\n\nint main(void){\n\n\tint d,i,j,n=26,k,m=100;\n\n\tll ansm = -INFLL;\n\n\tstd::vector<int> v[m];\n\n\tfor(k=0; k<m; ++k){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tv[k].push_back(j);\n\n\t\t}\n\n\t\tstd::random_device seed_gen;\n\n\t\tstd::mt19937 engine(seed_gen());\n\n\t\tstd::shuffle(v[k].begin(), v[k].end(), engine);\n\n\t}\n\n\tstd::cin >> d;\n\n\tfor(i=0; i<26; ++i){\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tstd::cin >> s[i][j];\n\n\t\t}\n\n\t}\n\n\tfor(k=0; k<m; ++k){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tl[j] = -1;\n\n\t\t}\n\n\t\tfor(i=0; i<d; ++i){\n\n\t\t\tans[k] += s[i][v[k][i%26]];\n\n\t\t\tl[v[k][i%26]] = i;\n\n\t\t\tfor(j=0; j<n; ++j){\n\n\t\t\t\tans[k] -= c[j]*(i-l[j]);\n\n\t\t\t}\n\n\t\t}\n\n\t\tansm = std::max(ansm,ans[k]);\n\n\t}\n\n\tfor(k=0; k<m; ++k){\n\n\t\tif(ans[k] == ansm){\n\n\t\t\tfor(i=0; i<d; ++i){\n\n\t\t\t\tstd::cout << v[k][i%26]+1 << std::endl;\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n#include <iostream>\n\n#include <vector>\n\n#include <queue>\n\n#include <stack>\n\n#include <algorithm>\n\n#include <numeric>\n\n#include <iterator>\n\n#include <random>\n\n\n\nusing ll = long long int;\n\nusing P = std::pair<ll, int>;\n\nconst int INF = (1<<30);\n\nconst ll INFLL = (1ll<<60);\n\nconst ll MOD = (ll)(1e9+7);\n\n\n\n#define l_ength size\n\n\n\nvoid mul_mod(ll& a, ll b){\n\n\ta *= b;\n\n\ta %= MOD;\n\n}\n\n\n\nvoid add_mod(ll& a, ll b){\n\n\ta = (a<MOD)?a:(a-MOD);\n\n\tb = (b<MOD)?b:(b-MOD);\n\n\ta += b;\n\n\ta = (a<MOD)?a:(a-MOD);\n\n}\n\n\n\nint l[30];\n\nll c[30],s[400][30];\n\nstd::vector<P> v;\n\n\n\nint main(void){\n\n\tint d,i,j,n=26;\n\n\tll ansm = -INFLL;\n\n\tstd::cin >> d;\n\n\tfor(i=0; i<n; ++i){\n\n\t\tl[i] = -1;\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tstd::cin >> s[i][j];\n\n\t\t}\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tv.push_back(P(s[i][j]+c[j]*(i-l[j]),j+1));\n\n\t\t}\n\n\t\tstd::sort(v.begin(),v.end(),std::greater<P>());\n\n\t\tstd::cout << v[0].second << std::endl;\n\n\t\tl[v[0].second-1] = i;\n\n\t}\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "663",
        "source_code": "#include <stdio.h>\n\n#include <iostream>\n\n#include <vector>\n\n#include <queue>\n\n#include <stack>\n\n#include <algorithm>\n\n#include <numeric>\n\n#include <iterator>\n\n#include <random>\n\n\n\nusing ll = long long int;\n\nusing P = std::pair<ll, int>;\n\nconst int INF = (1<<30);\n\nconst ll INFLL = (1ll<<60);\n\nconst ll MOD = (ll)(1e9+7);\n\n\n\n#define l_ength size\n\n\n\nvoid mul_mod(ll& a, ll b){\n\n\ta *= b;\n\n\ta %= MOD;\n\n}\n\n\n\nvoid add_mod(ll& a, ll b){\n\n\ta = (a<MOD)?a:(a-MOD);\n\n\tb = (b<MOD)?b:(b-MOD);\n\n\ta += b;\n\n\ta = (a<MOD)?a:(a-MOD);\n\n}\n\n\n\nint l[30];\n\nll c[30],s[400][30],ans[111];\n\n\n\nint main(void){\n\n\tint d,i,j,n=26,k,m=100;\n\n\tll ansm = -INFLL;\n\n\tstd::vector<int> v[m];\n\n\tfor(k=0; k<m; ++k){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tv[k].push_back(j);\n\n\t\t}\n\n\t\tstd::random_device seed_gen;\n\n\t\tstd::mt19937 engine(seed_gen());\n\n\t\tstd::shuffle(v[k].begin(), v[k].end(), engine);\n\n\t}\n\n\tstd::cin >> d;\n\n\tfor(i=0; i<26; ++i){\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tstd::cin >> s[i][j];\n\n\t\t}\n\n\t}\n\n\tfor(k=0; k<m; ++k){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tl[j] = -1;\n\n\t\t}\n\n\t\tfor(i=0; i<d; ++i){\n\n\t\t\tans[k] += s[i][v[k][i%26]];\n\n\t\t\tl[v[k][i%26]] = i;\n\n\t\t\tfor(j=0; j<n; ++j){\n\n\t\t\t\tans[k] -= c[j]*(i-l[j]);\n\n\t\t\t}\n\n\t\t}\n\n\t\tansm = std::max(ansm,ans[k]);\n\n\t\t// std::cout << ans[k] << std::endl;\n\n\t}\n\n\tfor(k=0; k<m; ++k){\n\n\t\tif(ans[k] == ansm){\n\n\t\t\tfor(i=0; i<d; ++i){\n\n\t\t\t\tstd::cout << v[k][i%26]+1 << std::endl;\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n#include <iostream>\n\n#include <vector>\n\n#include <queue>\n\n#include <stack>\n\n#include <algorithm>\n\n#include <numeric>\n\n#include <iterator>\n\n#include <random>\n\n\n\nusing ll = long long int;\n\nusing P = std::pair<ll, int>;\n\nconst int INF = (1<<30);\n\nconst ll INFLL = (1ll<<60);\n\nconst ll MOD = (ll)(1e9+7);\n\n\n\n#define l_ength size\n\n\n\nvoid mul_mod(ll& a, ll b){\n\n\ta *= b;\n\n\ta %= MOD;\n\n}\n\n\n\nvoid add_mod(ll& a, ll b){\n\n\ta = (a<MOD)?a:(a-MOD);\n\n\tb = (b<MOD)?b:(b-MOD);\n\n\ta += b;\n\n\ta = (a<MOD)?a:(a-MOD);\n\n}\n\n\n\nint l[30];\n\nll c[30],s[400][30];\n\nstd::vector<P> v;\n\n\n\nint main(void){\n\n\tint d,i,j,n=26;\n\n\tll ansm = -INFLL;\n\n\tstd::cin >> d;\n\n\tfor(i=0; i<n; ++i){\n\n\t\tl[i] = -1;\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tstd::cin >> s[i][j];\n\n\t\t}\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tv.push_back(P(s[i][j]+c[j]*(i-l[j]),j+1));\n\n\t\t}\n\n\t\tstd::sort(v.begin(),v.end(),std::greater<P>());\n\n\t\tstd::cout << v[0].second << std::endl;\n\n\t\tl[v[0].second-1] = i;\n\n\t}\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "664",
        "source_code": "#include <stdio.h>\n\n#include <iostream>\n\n#include <vector>\n\n#include <queue>\n\n#include <stack>\n\n#include <algorithm>\n\n#include <numeric>\n\n#include <iterator>\n\n#include <random>\n\n\n\nusing ll = long long int;\n\nusing P = std::pair<ll, int>;\n\nconst int INF = (1<<30);\n\nconst ll INFLL = (1ll<<60);\n\nconst ll MOD = (ll)(1e9+7);\n\n\n\n#define l_ength size\n\n\n\nvoid mul_mod(ll& a, ll b){\n\n\ta *= b;\n\n\ta %= MOD;\n\n}\n\n\n\nvoid add_mod(ll& a, ll b){\n\n\ta = (a<MOD)?a:(a-MOD);\n\n\tb = (b<MOD)?b:(b-MOD);\n\n\ta += b;\n\n\ta = (a<MOD)?a:(a-MOD);\n\n}\n\n\n\nint l[30];\n\nll c[30],s[400][30],ans[3];\n\n\n\nint main(void){\n\n\tint d,i,j,n=26,k,m=100;\n\n\tll ansm = -INFLL;\n\n\tstd::vector<int> v[m];\n\n\tfor(k=0; k<m; ++k){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tv[k].push_back(j);\n\n\t\t}\n\n\t\tstd::random_device seed_gen;\n\n\t\tstd::mt19937 engine(seed_gen());\n\n\t\tstd::shuffle(v[k].begin(), v[k].end(), engine);\n\n\t}\n\n\tstd::cin >> d;\n\n\tfor(i=0; i<26; ++i){\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tstd::cin >> s[i][j];\n\n\t\t}\n\n\t}\n\n\tfor(k=0; k<m; ++k){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tl[j] = -1;\n\n\t\t}\n\n\t\tfor(i=0; i<d; ++i){\n\n\t\t\tans[k] += s[i][v[k][i%26]];\n\n\t\t\tl[v[k][i%26]] = i;\n\n\t\t\tfor(j=0; j<n; ++j){\n\n\t\t\t\tans[k] -= c[j]*(i-l[j]);\n\n\t\t\t}\n\n\t\t}\n\n\t\tansm = std::max(ansm,ans[k]);\n\n\t}\n\n\tfor(k=0; k<m; ++k){\n\n\t\tif(ans[k] == ansm){\n\n\t\t\tfor(i=0; i<d; ++i){\n\n\t\t\t\tstd::cout << v[k][i%26]+1 << std::endl;\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n#include <iostream>\n\n#include <vector>\n\n#include <queue>\n\n#include <stack>\n\n#include <algorithm>\n\n#include <numeric>\n\n#include <iterator>\n\n#include <random>\n\n\n\nusing ll = long long int;\n\nusing P = std::pair<ll, int>;\n\nconst int INF = (1<<30);\n\nconst ll INFLL = (1ll<<60);\n\nconst ll MOD = (ll)(1e9+7);\n\n\n\n#define l_ength size\n\n\n\nvoid mul_mod(ll& a, ll b){\n\n\ta *= b;\n\n\ta %= MOD;\n\n}\n\n\n\nvoid add_mod(ll& a, ll b){\n\n\ta = (a<MOD)?a:(a-MOD);\n\n\tb = (b<MOD)?b:(b-MOD);\n\n\ta += b;\n\n\ta = (a<MOD)?a:(a-MOD);\n\n}\n\n\n\nint l[30];\n\nll c[30],s[400][30];\n\nstd::vector<P> v;\n\n\n\nint main(void){\n\n\tint d,i,j,n=26;\n\n\tll ansm = -INFLL;\n\n\tstd::cin >> d;\n\n\tfor(i=0; i<n; ++i){\n\n\t\tl[i] = -1;\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tstd::cin >> s[i][j];\n\n\t\t}\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tv.push_back(P(s[i][j]+c[j]*(i-l[j]),j+1));\n\n\t\t}\n\n\t\tstd::sort(v.begin(),v.end(),std::greater<P>());\n\n\t\tstd::cout << v[0].second << std::endl;\n\n\t\tl[v[0].second-1] = i;\n\n\t\tv.clear();\n\n\t}\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "665",
        "source_code": "#include <stdio.h>\n\n#include <iostream>\n\n#include <vector>\n\n#include <queue>\n\n#include <stack>\n\n#include <algorithm>\n\n#include <numeric>\n\n#include <iterator>\n\n#include <random>\n\n\n\nusing ll = long long int;\n\nusing P = std::pair<ll, int>;\n\nconst int INF = (1<<30);\n\nconst ll INFLL = (1ll<<60);\n\nconst ll MOD = (ll)(1e9+7);\n\n\n\n#define l_ength size\n\n\n\nvoid mul_mod(ll& a, ll b){\n\n\ta *= b;\n\n\ta %= MOD;\n\n}\n\n\n\nvoid add_mod(ll& a, ll b){\n\n\ta = (a<MOD)?a:(a-MOD);\n\n\tb = (b<MOD)?b:(b-MOD);\n\n\ta += b;\n\n\ta = (a<MOD)?a:(a-MOD);\n\n}\n\n\n\nint l[30];\n\nll c[30],s[400][30],ans[111];\n\n\n\nint main(void){\n\n\tint d,i,j,n=26,k,m=100;\n\n\tll ansm = -INFLL;\n\n\tstd::vector<int> v[m];\n\n\tfor(k=0; k<m; ++k){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tv[k].push_back(j);\n\n\t\t}\n\n\t\tstd::random_device seed_gen;\n\n\t\tstd::mt19937 engine(seed_gen());\n\n\t\tstd::shuffle(v[k].begin(), v[k].end(), engine);\n\n\t}\n\n\tstd::cin >> d;\n\n\tfor(i=0; i<26; ++i){\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tstd::cin >> s[i][j];\n\n\t\t}\n\n\t}\n\n\tfor(k=0; k<m; ++k){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tl[j] = -1;\n\n\t\t}\n\n\t\tfor(i=0; i<d; ++i){\n\n\t\t\tans[k] += s[i][v[k][i%26]];\n\n\t\t\tl[v[k][i%26]] = i;\n\n\t\t\tfor(j=0; j<n; ++j){\n\n\t\t\t\tans[k] -= c[j]*(i-l[j]);\n\n\t\t\t}\n\n\t\t}\n\n\t\tansm = std::max(ansm,ans[k]);\n\n\t\t// std::cout << ans[k] << std::endl;\n\n\t}\n\n\tfor(k=0; k<m; ++k){\n\n\t\tif(ans[k] == ansm){\n\n\t\t\tfor(i=0; i<d; ++i){\n\n\t\t\t\tstd::cout << v[k][i%26]+1 << std::endl;\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n#include <iostream>\n\n#include <vector>\n\n#include <queue>\n\n#include <stack>\n\n#include <algorithm>\n\n#include <numeric>\n\n#include <iterator>\n\n#include <random>\n\n\n\nusing ll = long long int;\n\nusing P = std::pair<ll, int>;\n\nconst int INF = (1<<30);\n\nconst ll INFLL = (1ll<<60);\n\nconst ll MOD = (ll)(1e9+7);\n\n\n\n#define l_ength size\n\n\n\nvoid mul_mod(ll& a, ll b){\n\n\ta *= b;\n\n\ta %= MOD;\n\n}\n\n\n\nvoid add_mod(ll& a, ll b){\n\n\ta = (a<MOD)?a:(a-MOD);\n\n\tb = (b<MOD)?b:(b-MOD);\n\n\ta += b;\n\n\ta = (a<MOD)?a:(a-MOD);\n\n}\n\n\n\nint l[30];\n\nll c[30],s[400][30];\n\nstd::vector<P> v;\n\n\n\nint main(void){\n\n\tint d,i,j,n=26;\n\n\tll ansm = -INFLL;\n\n\tstd::cin >> d;\n\n\tfor(i=0; i<n; ++i){\n\n\t\tl[i] = -1;\n\n\t\tstd::cin >> c[i];\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tstd::cin >> s[i][j];\n\n\t\t}\n\n\t}\n\n\tfor(i=0; i<d; ++i){\n\n\t\tfor(j=0; j<n; ++j){\n\n\t\t\tv.push_back(P(s[i][j]+c[j]*(i-l[j]),j+1));\n\n\t\t}\n\n\t\tstd::sort(v.begin(),v.end(),std::greater<P>());\n\n\t\tstd::cout << v[0].second << std::endl;\n\n\t\tl[v[0].second-1] = i;\n\n\t\tv.clear();\n\n\t}\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "666",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef long double ld;\n\ntypedef vector<ll> vi;\n\ntypedef vector<vi> vvi;\n\n#define INF (1e9)\n\n\n\nint D = 365;\n\nvi c, ans;\n\nvvi s;\n\n\n\nvoid input() {\n\n  cin >> D;\n\n  c = vi(26);\n\n  s = vvi(D, vi(26));\n\n  for (int i = 0; i < 26; i++) {\n\n    cin >> c[i];\n\n  }\n\n  for (int i = 0; i < D; i++) {\n\n    for (int j = 0; j < 26; j++) {\n\n      cin >> s[i][j];\n\n    }\n\n  }\n\n}\n\n\n\nvoid output() {\n\n  for (int i = 0; i < D; i++) {\n\n    cout << ans[i] + 1 << endl;\n\n  }\n\n}\n\n\n\nint simulate(vi a) {\n\n  int sum = 0;\n\n  vi last(26, 0);\n\n  for (int i = 0; i < D; i++) {\n\n    sum += s[i][a[i]];\n\n    last[a[i]] = i + 1;\n\n    for (int j = 0; j < 26; j++) {\n\n      sum -= c[j] * (i - last[j] + 1);\n\n    }\n\n  }\n\n  return (int)1e6 + sum;\n\n  // return max((int)1e6 + sum, 0);\n\n}\n\n\n\nvoid solve() {\n\n  int best = simulate(ans);\n\n\n\n  // \u5468\u671f\n\n  for (int i = 0; i < 26; i++) {\n\n    vi a(D);\n\n    for (int j = 0; j < D; j++) {\n\n      a[j] = (i + j) % 26;\n\n    }\n\n\n\n    int x = simulate(a);\n\n    if (x > best) {\n\n      best = x;\n\n      ans = a;\n\n    }\n\n  }\n\n\n\n  //\n\n  srand((unsigned)time(NULL));\n\n  int loop = 20;\n\n  bool lastIsNew = true;\n\n  while (loop--) {\n\n    vi a = ans;\n\n    if (!lastIsNew) {\n\n      int change = D / 2;\n\n      while (change--) {\n\n        a[rand() % D] = rand() % 26;\n\n      }\n\n    }\n\n\n\n    for (int i = 0; i < D; i++) {\n\n      vi b = a;\n\n      int idx = 0, bst = simulate(b);\n\n      for (int j = 0; j < 26; j++) {\n\n        b[i] = j;\n\n        int x = simulate(b);\n\n        if (x > bst) {\n\n          bst = x;\n\n          idx = j;\n\n        }\n\n      }\n\n      a[i] = idx;\n\n    }\n\n\n\n    lastIsNew = false;\n\n    int x = simulate(a);\n\n    if (x > best) {\n\n      best = x;\n\n      ans = a;\n\n      lastIsNew = true;\n\n    }\n\n  }\n\n}\n\n\n\nint main() {\n\n  input();\n\n  ans = vi(D, 0);\n\n  solve();\n\n  output();\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef long double ld;\n\ntypedef vector<ll> vi;\n\ntypedef vector<vi> vvi;\n\n#define INF (1e9)\n\n\n\nint D = 365;\n\nvi c, ans;\n\nvvi s;\n\n\n\nvoid input() {\n\n  cin >> D;\n\n  c = vi(26);\n\n  s = vvi(D, vi(26));\n\n  for (int i = 0; i < 26; i++) {\n\n    cin >> c[i];\n\n  }\n\n  for (int i = 0; i < D; i++) {\n\n    for (int j = 0; j < 26; j++) {\n\n      cin >> s[i][j];\n\n    }\n\n  }\n\n}\n\n\n\nvoid output() {\n\n  for (int i = 0; i < D; i++) {\n\n    cout << ans[i] + 1 << endl;\n\n  }\n\n}\n\n\n\nint simulate(vi a, int day) {\n\n  int sum = 0;\n\n  vi last(26, 0);\n\n  for (int i = 0; i <= day; i++) {\n\n    sum += s[i][a[i]];\n\n    last[a[i]] = i + 1;\n\n    for (int j = 0; j < 26; j++) {\n\n      sum -= c[j] * (i - last[j] + 1);\n\n    }\n\n  }\n\n  return sum;\n\n  // return max((int)1e6 + sum, 0);\n\n}\n\n\n\nint simulate(vi a) { return simulate(a, D - 1); }\n\n\n\nvoid solve() {\n\n  int best = simulate(ans);\n\n\n\n  //\n\n  {\n\n    vi a = ans;\n\n    for (int i = 0; i < D; i++) {\n\n      int bst = -INF, idx = 0;\n\n      for (int j = 0; j < 26; j++) {\n\n        a[i] = j;\n\n        int x = simulate(a, i);\n\n        if (x > bst) {\n\n          bst = x;\n\n          idx = j;\n\n        }\n\n      }\n\n      a[i] = idx;\n\n    }\n\n    if (best < simulate(a)) ans = a, best = simulate(ans);\n\n  }\n\n\n\n  //\n\n  srand((unsigned)time(NULL));\n\n  int loop = 0;  // 20;\n\n  bool lastIsNew = true;\n\n  while (loop--) {\n\n    vi a = ans;\n\n    if (!lastIsNew) {\n\n      int change = D / 2;\n\n      while (change--) {\n\n        a[rand() % D] = rand() % 26;\n\n      }\n\n    }\n\n\n\n    for (int i = 0; i < D; i++) {\n\n      vi b = a;\n\n      int idx = 0, bst = simulate(b);\n\n      for (int j = 0; j < 26; j++) {\n\n        b[i] = j;\n\n        int x = simulate(b);\n\n        if (x > bst) {\n\n          bst = x;\n\n          idx = j;\n\n        }\n\n      }\n\n      a[i] = idx;\n\n    }\n\n\n\n    lastIsNew = false;\n\n    int x = simulate(a);\n\n    if (x > best) {\n\n      best = x;\n\n      ans = a;\n\n      lastIsNew = true;\n\n    }\n\n  }\n\n}\n\n\n\nint main() {\n\n  input();\n\n  ans = vi(D, 0);\n\n  solve();\n\n  output();\n\n}\n"
    },
    {
        "id": "667",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef long double ld;\n\ntypedef vector<ll> vi;\n\ntypedef vector<vi> vvi;\n\n#define INF (1e9)\n\n\n\nint D = 365;\n\nvi c, ans;\n\nvvi s;\n\n\n\nvoid input() {\n\n  cin >> D;\n\n  c = vi(26);\n\n  s = vvi(D, vi(26));\n\n  for (int i = 0; i < 26; i++) {\n\n    cin >> c[i];\n\n  }\n\n  for (int i = 0; i < D; i++) {\n\n    for (int j = 0; j < 26; j++) {\n\n      cin >> s[i][j];\n\n    }\n\n  }\n\n}\n\n\n\nvoid output() {\n\n  for (int i = 0; i < D; i++) {\n\n    cout << ans[i] + 1 << endl;\n\n  }\n\n}\n\n\n\nint simulate(vi a) {\n\n  int sum = 0;\n\n  vi last(26, 0);\n\n  for (int i = 0; i < D; i++) {\n\n    sum += s[i][a[i]];\n\n    last[a[i]] = i + 1;\n\n    for (int j = 0; j < 26; j++) {\n\n      sum -= c[j] * (i - last[j] + 1);\n\n    }\n\n  }\n\n  return (int)1e6 + sum;\n\n  // return max((int)1e6 + sum, 0);\n\n}\n\n\n\nvoid solve() {\n\n  int best = simulate(ans);\n\n\n\n  // \u5468\u671f\n\n  for (int i = 0; i < 26; i++) {\n\n    vi a(D);\n\n    for (int j = 0; j < D; j++) {\n\n      a[j] = (i + j) % 26;\n\n    }\n\n\n\n    int x = simulate(a);\n\n    if (x > best) {\n\n      best = x;\n\n      ans = a;\n\n    }\n\n  }\n\n\n\n  //\n\n  srand((unsigned)time(NULL));\n\n  int loop = 20;\n\n  bool lastIsNew = true;\n\n  while (loop--) {\n\n    vi a = ans;\n\n    if (!lastIsNew) {\n\n      int change = D / 2;\n\n      while (change--) {\n\n        a[rand() % D] = rand() % 26;\n\n      }\n\n    }\n\n\n\n    for (int i = 0; i < D; i++) {\n\n      vi b = a;\n\n      int idx = 0, bst = simulate(b);\n\n      for (int j = 0; j < 26; j++) {\n\n        b[i] = j;\n\n        int x = simulate(b);\n\n        if (x > bst) {\n\n          bst = x;\n\n          idx = j;\n\n        }\n\n      }\n\n      a[i] = idx;\n\n    }\n\n\n\n    lastIsNew = false;\n\n    int x = simulate(a);\n\n    if (x > best) {\n\n      best = x;\n\n      ans = a;\n\n      lastIsNew = true;\n\n    }\n\n  }\n\n}\n\n\n\nint main() {\n\n  input();\n\n  ans = vi(D, 0);\n\n  solve();\n\n  output();\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef long double ld;\n\ntypedef vector<ll> vi;\n\ntypedef vector<vi> vvi;\n\n#define INF (1e9)\n\n\n\nint D = 365;\n\nvi c, ans;\n\nvvi s;\n\n\n\nvoid input() {\n\n  cin >> D;\n\n  c = vi(26);\n\n  s = vvi(D, vi(26));\n\n  for (int i = 0; i < 26; i++) {\n\n    cin >> c[i];\n\n  }\n\n  for (int i = 0; i < D; i++) {\n\n    for (int j = 0; j < 26; j++) {\n\n      cin >> s[i][j];\n\n    }\n\n  }\n\n}\n\n\n\nvoid output() {\n\n  for (int i = 0; i < D; i++) {\n\n    cout << ans[i] + 1 << endl;\n\n  }\n\n}\n\n\n\nint simulate(vi a, int day) {\n\n  int sum = 0;\n\n  vi last(26, 0);\n\n  for (int i = 0; i <= day; i++) {\n\n    sum += s[i][a[i]];\n\n    last[a[i]] = i + 1;\n\n    for (int j = 0; j < 26; j++) {\n\n      sum -= c[j] * (i - last[j] + 1);\n\n    }\n\n  }\n\n  return sum;\n\n  // return max((int)1e6 + sum, 0);\n\n}\n\n\n\nint simulate(vi a) { return simulate(a, D - 1); }\n\n\n\nvoid solve() {\n\n  int best = simulate(ans);\n\n\n\n  //\n\n  {\n\n    vi a = ans;\n\n    for (int i = 0; i < D; i++) {\n\n      int bst = -INF, idx = 0;\n\n      for (int j = 0; j < 26; j++) {\n\n        a[i] = j;\n\n        int x = simulate(a, i);\n\n        if (x > bst) {\n\n          bst = x;\n\n          idx = j;\n\n        }\n\n      }\n\n      a[i] = idx;\n\n    }\n\n    if (best < simulate(a)) ans = a, best = simulate(ans);\n\n  }\n\n\n\n  //\n\n  srand((unsigned)time(NULL));\n\n  int loop = 1000;\n\n  while (loop--) {\n\n    vi a = ans;\n\n    int change = D / 2;\n\n    while (change--) {\n\n      int idx = rand() % (D - 1);\n\n      int tmp = a[idx + 1];\n\n      a[idx + 1] = a[idx];\n\n      a[idx] = tmp;\n\n    }\n\n\n\n    int x = simulate(a);\n\n    if (x > best) {\n\n      best = x;\n\n      ans = a;\n\n    }\n\n  }\n\n}\n\n\n\nint main() {\n\n  input();\n\n  ans = vi(D, 0);\n\n  solve();\n\n  output();\n\n}\n"
    },
    {
        "id": "668",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef long double ld;\n\ntypedef vector<ll> vi;\n\ntypedef vector<vi> vvi;\n\n#define INF (1e9)\n\n\n\nint D = 365;\n\nvi c, ans;\n\nvvi s;\n\n\n\nvoid input() {\n\n  cin >> D;\n\n  c = vi(26);\n\n  s = vvi(D, vi(26));\n\n  for (int i = 0; i < 26; i++) {\n\n    cin >> c[i];\n\n  }\n\n  for (int i = 0; i < D; i++) {\n\n    for (int j = 0; j < 26; j++) {\n\n      cin >> s[i][j];\n\n    }\n\n  }\n\n}\n\n\n\nvoid output() {\n\n  for (int i = 0; i < D; i++) {\n\n    cout << ans[i] + 1 << endl;\n\n  }\n\n}\n\n\n\nint simulate(vi a, int day) {\n\n  int sum = 0;\n\n  vi last(26, 0);\n\n  for (int i = 0; i <= day; i++) {\n\n    sum += s[i][a[i]];\n\n    last[a[i]] = i + 1;\n\n    for (int j = 0; j < 26; j++) {\n\n      sum -= c[j] * (i - last[j] + 1);\n\n    }\n\n  }\n\n  return sum;\n\n  // return max((int)1e6 + sum, 0);\n\n}\n\n\n\nint simulate(vi a) { return simulate(a, D - 1); }\n\n\n\nvoid solve() {\n\n  int best = simulate(ans);\n\n\n\n  //\n\n  {\n\n    vi a = ans;\n\n    for (int i = 0; i < D; i++) {\n\n      int bst = -INF, idx = 0;\n\n      for (int j = 0; j < 26; j++) {\n\n        a[i] = j;\n\n        int x = simulate(a, i);\n\n        if (x > bst) {\n\n          bst = x;\n\n          idx = j;\n\n        }\n\n      }\n\n      a[i] = idx;\n\n    }\n\n    if (best < simulate(a)) ans = a, best = simulate(ans);\n\n  }\n\n\n\n  //\n\n  srand((unsigned)time(NULL));\n\n  int loop = 20;\n\n  bool lastIsNew = true;\n\n  while (loop--) {\n\n    vi a = ans;\n\n    if (!lastIsNew) {\n\n      int change = D / 2;\n\n      while (change--) {\n\n        a[rand() % D] = rand() % 26;\n\n      }\n\n    }\n\n\n\n    for (int i = 0; i < D; i++) {\n\n      vi b = a;\n\n      int idx = 0, bst = simulate(b);\n\n      for (int j = 0; j < 26; j++) {\n\n        b[i] = j;\n\n        int x = simulate(b);\n\n        if (x > bst) {\n\n          bst = x;\n\n          idx = j;\n\n        }\n\n      }\n\n      a[i] = idx;\n\n    }\n\n\n\n    lastIsNew = false;\n\n    int x = simulate(a);\n\n    if (x > best) {\n\n      best = x;\n\n      ans = a;\n\n      lastIsNew = true;\n\n    }\n\n  }\n\n}\n\n\n\nint main() {\n\n  input();\n\n  ans = vi(D, 0);\n\n  solve();\n\n  output();\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef long double ld;\n\ntypedef vector<ll> vi;\n\ntypedef vector<vi> vvi;\n\n#define INF (1e9)\n\n\n\nint D = 365;\n\nvi c, ans;\n\nvvi s;\n\n\n\nvoid input() {\n\n  cin >> D;\n\n  c = vi(26);\n\n  s = vvi(D, vi(26));\n\n  for (int i = 0; i < 26; i++) {\n\n    cin >> c[i];\n\n  }\n\n  for (int i = 0; i < D; i++) {\n\n    for (int j = 0; j < 26; j++) {\n\n      cin >> s[i][j];\n\n    }\n\n  }\n\n}\n\n\n\nvoid output() {\n\n  for (int i = 0; i < D; i++) {\n\n    cout << ans[i] + 1 << endl;\n\n  }\n\n}\n\n\n\nint simulate(vi a, int day) {\n\n  int sum = 0;\n\n  vi last(26, 0);\n\n  for (int i = 0; i <= day; i++) {\n\n    sum += s[i][a[i]];\n\n    last[a[i]] = i + 1;\n\n    for (int j = 0; j < 26; j++) {\n\n      sum -= c[j] * (i - last[j] + 1);\n\n    }\n\n  }\n\n  return sum;\n\n  // return max((int)1e6 + sum, 0);\n\n}\n\n\n\nint simulate(vi a) { return simulate(a, D - 1); }\n\n\n\nvoid solve() {\n\n  int best = simulate(ans);\n\n\n\n  //\n\n  {\n\n    vi a = ans;\n\n    for (int i = 0; i < D; i++) {\n\n      int bst = -INF, idx = 0;\n\n      for (int j = 0; j < 26; j++) {\n\n        a[i] = j;\n\n        int x = simulate(a, i);\n\n        if (x > bst) {\n\n          bst = x;\n\n          idx = j;\n\n        }\n\n      }\n\n      a[i] = idx;\n\n    }\n\n    if (best < simulate(a)) ans = a, best = simulate(ans);\n\n  }\n\n\n\n  //\n\n  srand((unsigned)time(NULL));\n\n  int loop = 1000;\n\n  while (loop--) {\n\n    vi a = ans;\n\n    int change = D / 2;\n\n    while (change--) {\n\n      int idx = rand() % (D - 1);\n\n      int tmp = a[idx + 1];\n\n      a[idx + 1] = a[idx];\n\n      a[idx] = tmp;\n\n    }\n\n\n\n    int x = simulate(a);\n\n    if (x > best) {\n\n      best = x;\n\n      ans = a;\n\n    }\n\n  }\n\n}\n\n\n\nint main() {\n\n  input();\n\n  ans = vi(D, 0);\n\n  solve();\n\n  output();\n\n}\n"
    },
    {
        "id": "669",
        "source_code": "\n\n/*****/\n\n\n\n#define TRUE true\n\n#define FALSE false\n\n\n\n#include <bits/stdc++.h>\n\n\n\n/**/\n\n#pragma GCC target(\"avx\")\n\n#pragma GCC optimize(\"O3\")\n\n#pragma GCC optimize(\"unroll-loops\")\n\n/**/\n\n\n\nusing namespace std;\n\nusing ll = long long;\n\nusing ld = long double;\n\nusing pint = pair<int, int>;\n\nusing pll = pair<long long, long long>;\n\ntemplate <class T>\n\nusing vec = vector<T>;\n\ntemplate <class T>\n\nusing vec2 = vector<vector<T>>;\n\ntemplate <class T>\n\nusing vec3 = vector<vector<vector<T>>>;\n\n\n\nconstexpr int INF = numeric_limits<int>::max();\n\nconstexpr ll INFL = numeric_limits<ll>::max();\n\nconstexpr ll MOD = 1000000007; // 10^9+7\n\n\n\n#ifdef TRUE\n\n\n\n#define rep(i, n) for (ll i = 0, i##_len = (n); i < i##_len; ++i)\n\n#define rep1(i, n) for (ll i = 1, i##_len = (n); i <= i##_len; ++i)\n\n#define rrep(i, n) for (ll i = (n)-1; i >= 0; --i)\n\n#define rrep1(i, n) for (ll i = (n); i > 0; --i)\n\n#define step(i, a, n) for (ll i = (a), i##_len = (a) + (n); i < i##_len; ++i)\n\n#define rstep(i, a, n) for (ll i = (a) + (n)-1, i##_len = (a); i >= i##_len; --i)\n\n#define range(i, a, b) for (ll i = (a), i##_len = (b); i < i##_len; ++i)\n\n#define rrange(i, a, b) for (ll i = (b)-1, i##_len = (a); i >= i##_len; --i)\n\n\n\nstd::string strMulti(const int n, const std::string &t)\n\n{\n\n    std::string out = \"\";\n\n    for (int i = 0; i < n; i++)\n\n    {\n\n        out += t;\n\n    }\n\n    return out;\n\n}\n\nstd::string tab(const int n)\n\n{\n\n    return string(n, '\\t');\n\n}\n\nstd::string join(const vector<string> &v, const char *delim = 0)\n\n{\n\n    std::string s;\n\n    if (!v.empty())\n\n    {\n\n        s += v[0];\n\n        for (decltype(v.size()) i = 1, c = v.size(); i < c; ++i)\n\n        {\n\n            if (delim)\n\n                s += delim;\n\n            s += v[i];\n\n        }\n\n    }\n\n    return s;\n\n}\n\n\n\nstring to_string(string &s) { return '\"' + s + '\"'; }\n\nstring to_string(char &c) { return string({'\\'', c, '\\''}); }\n\ntemplate <class T1, class T2>\n\nstring to_string(pair<T1, T2> p) { return \"(\" + to_string(p.first) + \", \" + to_string(p.second) + \")\"; }\n\ntemplate <class Tuple, size_t... I>\n\nstring _to_string_tuple(Tuple &&t, std::index_sequence<I...>) { return \"(\" + join({to_string(std::get<I>(t))...}, \", \") + \")\"; }\n\ntemplate <class... Args>\n\nstring to_string(tuple<Args...> t) { return _to_string_tuple(std::forward<tuple<Args...>>(t), std::make_index_sequence<std::tuple_size<std::decay_t<tuple<Args...>>>::value>{}); }\n\ntemplate <class T>\n\nstring to_string(vector<T> ar)\n\n{\n\n    vector<string> texts(ar.size());\n\n    for (size_t i = 0; i < ar.size(); ++i)\n\n    {\n\n        texts[i] = to_string(ar[i]);\n\n    }\n\n    return \"{\" + join(texts, \", \") + \"}\";\n\n}\n\ntemplate <class T>\n\nstring to_string(initializer_list<T> il)\n\n{\n\n    vector<string> texts(il.size());\n\n    size_t i = 0;\n\n    for (T v : il)\n\n    {\n\n        texts[i] = to_string(v);\n\n        i++;\n\n    }\n\n    return \"{\" + join(texts, \", \") + \"}\";\n\n}\n\n\n\nvoid debug(string name);\n\nvoid debugn(string name);\n\ntemplate <class T>\n\nvoid debug(string name, T v);\n\ntemplate <class T>\n\nvoid debugn(string name, T v);\n\ntemplate <class T>\n\nvoid debug(string name, initializer_list<T> il);\n\ntemplate <class T>\n\nvoid debugn(string name, initializer_list<T> il);\n\ntemplate <class... Args>\n\nvoid debug(string name, Args... args);\n\ntemplate <class... Args>\n\nvoid debugn(string name, Args... args);\n\nvoid debugdo(function<void()> func);\n\n\n\n#ifdef DEBUG_BUILD\n\n#define debugvar(x) debugn(#x, (x))\n\n#define debugvartab(x, t) debugn(tab(t) + #x, (x))\n\nvoid debug(string name)\n\n{\n\n    std::cerr << name;\n\n}\n\nvoid debugn(string name) { std::cerr << name << '\\n'; }\n\ntemplate <class T>\n\nvoid debug(string name, T v) { std::cerr << name << \" = \" << to_string(v); }\n\ntemplate <class T>\n\nvoid debugn(string name, T v) { std::cerr << name << \" = \" << to_string(v) << '\\n'; }\n\ntemplate <class T>\n\nvoid debug(string name, initializer_list<T> il) { std::cerr << name << \" = \" << to_string(il); }\n\ntemplate <class T>\n\nvoid debugn(string name, initializer_list<T> il) { std::cerr << name << \" = \" << to_string(il) << '\\n'; }\n\ntemplate <class... Args>\n\nvoid debug(string name, Args... args) { std::cerr << name << \" = \" << to_string(tuple<Args...>(args...)); }\n\ntemplate <class... Args>\n\nvoid debugn(string name, Args... args) { std::cerr << name << \" = \" << to_string(tuple<Args...>(args...)) << '\\n'; }\n\nvoid debugdo(function<void()> func) { func(); }\n\n#else\n\n#define debugvar(x)\n\n#define debugvartab(x, t)\n\nvoid debug(string name)\n\n{\n\n}\n\nvoid debugln(string name) {}\n\ntemplate <class T>\n\nvoid debug(string name, T v) {}\n\ntemplate <class T>\n\nvoid debugn(string name, T v) {}\n\ntemplate <class T>\n\nvoid debug(string name, initializer_list<T> il) {}\n\ntemplate <class T>\n\nvoid debugn(string name, initializer_list<T> il) {}\n\ntemplate <class... Args>\n\nvoid debug(string name, Args... args) {}\n\ntemplate <class... Args>\n\nvoid debugn(string name, Args... args) {}\n\nvoid debugdo(function<void()> func) {}\n\n#endif\n\n\n\n#define all(x) (x).begin(), (x).end()\n\n#define pair(a, b) make_pair(a, b)\n\n\n\ntemplate <class T>\n\nbool chmax(T &a, const T b)\n\n{\n\n    if (a < b)\n\n    {\n\n        a = b;\n\n        return true;\n\n    }\n\n    return false;\n\n}\n\ntemplate <class T>\n\nbool chmin(T &a, const T b)\n\n{\n\n    if (a > b)\n\n    {\n\n        a = b;\n\n        return true;\n\n    }\n\n    return false;\n\n}\n\ntemplate <class T>\n\nT divup(const T a, const T b)\n\n{\n\n    if (a % b == 0)\n\n    {\n\n        return a / b;\n\n    }\n\n    return a / b + 1;\n\n}\n\ntemplate <class T>\n\nbool cmp_2nd(pair<T, T> a, pair<T, T> b)\n\n{\n\n    if (a.second != b.second)\n\n    {\n\n        return a.second < b.second;\n\n    }\n\n    return a.first < b.first;\n\n}\n\nll modpow(ll x, ll n, const ll &p)\n\n{\n\n    ll ret = 1;\n\n    while (n > 0)\n\n    {\n\n        if (n & 1)\n\n        {\n\n            (ret *= x) %= p;\n\n        }\n\n        (x *= x) %= p;\n\n        n >>= 1;\n\n    }\n\n    return ret;\n\n}\n\ntemplate <class T>\n\nT modinv(T a, const T &p)\n\n{\n\n    T b = p, u = 1, v = 0;\n\n    while (b)\n\n    {\n\n        T t = a / b;\n\n        a -= t * b;\n\n        swap(a, b);\n\n        u -= t * v;\n\n        swap(u, v);\n\n    }\n\n    u %= p;\n\n    if (u < 0)\n\n    {\n\n        u += p;\n\n    }\n\n    return u;\n\n}\n\ntemplate <class T>\n\nT math_P(T m, T n)\n\n{\n\n    T ret = 1;\n\n    for (T i = m; i > m - n; i--)\n\n    {\n\n        ret *= i;\n\n    }\n\n    return ret;\n\n}\n\ntemplate <class T>\n\nT math_C(T m, T n)\n\n{\n\n    T ret = math_P(m, n);\n\n    for (T i = 2; i <= n; i++)\n\n    {\n\n        ret /= i;\n\n    }\n\n    return ret;\n\n}\n\nll extended_euclidean(ll u, ll v)\n\n{\n\n    ll r0 = u;\n\n    ll r1 = v;\n\n    ll s0 = 1;\n\n    ll s1 = 0;\n\n    ll t0 = 0;\n\n    ll t1 = 1;\n\n    while (r1 != 0)\n\n    {\n\n        ll q = r0 / r1;\n\n        ll r = r0 - q * r1;\n\n        ll s = s0 - q * s1;\n\n        ll t = t0 - q * t1;\n\n        r0 = r1;\n\n        s0 = s1;\n\n        t0 = t1;\n\n        r1 = r;\n\n        s1 = s;\n\n        t1 = t;\n\n    }\n\n    if (t0 < 0)\n\n    {\n\n        return t0 + u;\n\n    }\n\n    else\n\n    {\n\n        return t0;\n\n    }\n\n}\n\nll math_C_mod(ll n, ll c, const ll &p)\n\n{\n\n    ll upe = 1;\n\n    ll dow = 1;\n\n    for (ll i = 1; i < c + 1; ++i)\n\n    {\n\n        upe = upe * n % p;\n\n        dow = dow * i % p;\n\n        n -= 1;\n\n    }\n\n    return (upe * extended_euclidean(p, dow)) % p;\n\n}\n\ntemplate <class T>\n\nT math_gcd(T a, T b)\n\n{\n\n    if (b == 0)\n\n    {\n\n        return a;\n\n    }\n\n    else\n\n    {\n\n        return math_gcd(b, a % b);\n\n    }\n\n}\n\ntemplate <class T>\n\nT math_lcm(T a, T b) { return a / math_gcd(a, b) * b; }\n\ntemplate <class T>\n\nT SumStep(T a, T n, T d) { return n * (2 * a + (n - 1) * d) / 2; }\n\ntemplate <class T>\n\nT SumRange(T a, T b, T d) { return SumStep(a, (b - a) / d, d); }\n\n\n\n#endif\n\n\n\n/*****/\n\n\n\nconstexpr ll Type = 26;\n\nll D = 365;\n\nvec<ll> C;\n\nvec2<ll> S;\n\nvec<ll> T;\n\nll M;\n\nvec<ll> _Score;\n\n\n\nll solve_score(ll begin = 0, ll end = D)\n\n{\n\n    _Score.resize(D + 1);\n\n    vec<ll> last(Type, -1);\n\n    if (begin == 0)\n\n        _Score[0] = 0;\n\n    else\n\n        _Score[begin] = _Score[begin - 1];\n\n    range(day, begin, end)\n\n    {\n\n        ll t = T[day];\n\n        if (t != -1)\n\n        {\n\n            _Score[day] += S[day][t];\n\n            last[t] = day;\n\n        }\n\n\n\n        rep(j, Type)\n\n        {\n\n            _Score[day] -= C[j] * (day - last[j]);\n\n        }\n\n        _Score[day + 1] = _Score[day];\n\n    }\n\n    return _Score[end];\n\n}\n\n\n\nvoid set_greedy()\n\n{\n\n    rep(day, D)\n\n    {\n\n        //int maxSI = max_element(all(S[day])) - S[day].begin();\n\n\n\n        ll maxsc = -INFL;\n\n        ll maxsc_t = -1;\n\n        rep(t, Type)\n\n        {\n\n            T[day] = t;\n\n            if (chmax(maxsc, solve_score(day)))\n\n            {\n\n                maxsc_t = t;\n\n            }\n\n        }\n\n\n\n        T[day] = maxsc_t;\n\n        solve_score(day);\n\n    }\n\n}\n\n\n\nvoid input()\n\n{\n\n#ifdef DEBUG_BUILD\n\n    std::ifstream ifs(\"Comp\\\\input.txt\");\n\n    if (!ifs)\n\n    {\n\n        cerr << \"Error: file not opened.\" << endl;\n\n        return;\n\n    }\n\n    //debugn(\"D\");\n\n    ifs >> D;\n\n    C.resize(Type);\n\n    //debugn(\"C\");\n\n    rep(i, Type) ifs >> C[i];\n\n    //debugn(\"S\");\n\n    S.resize(D, vec<ll>(Type));\n\n    rep(i, D) rep(j, Type) ifs >> S[i][j];\n\n#else\n\n    cin >> D;\n\n    C.resize(Type);\n\n    rep(i, Type) cin >> C[i];\n\n    S.resize(D, vec<ll>(Type));\n\n    rep(i, D) rep(j, Type) cin >> S[i][j];\n\n#endif\n\n\n\n    T.resize(D, -1);\n\n    set_greedy();\n\n}\n\n\n\nvoid Main()\n\n{\n\n    input();\n\n\n\n    T.resize(D, -1);\n\n    set_greedy();\n\n\n\n    /*****/\n\n\n\n    /**/\n\n    rep(i, 5)\n\n    {\n\n        rrep(day, D)\n\n        {\n\n            ll maxsc = -INFL;\n\n            ll maxsc_t = -1;\n\n            rep(t, Type)\n\n            {\n\n                T[day] = t;\n\n                if (chmax(maxsc, solve_score(day)))\n\n                {\n\n                    maxsc_t = t;\n\n                }\n\n            }\n\n\n\n            T[day] = maxsc_t;\n\n            solve_score(day);\n\n        }\n\n        rep(day, D)\n\n        {\n\n            ll maxsc = -INFL;\n\n            ll maxsc_t = -1;\n\n            rep(t, Type)\n\n            {\n\n                T[day] = t;\n\n                if (chmax(maxsc, solve_score()))\n\n                {\n\n                    maxsc_t = t;\n\n                }\n\n            }\n\n\n\n            T[day] = maxsc_t;\n\n            solve_score();\n\n        }\n\n    }\n\n    //*/\n\n\n\n    /*****/\n\n\n\n    rep(i, D)\n\n    {\n\n        cout << T[i] + 1 << '\\n';\n\n    }\n\n    debugvar(solve_score());\n\n}\n\n\n\n/*****/\n\n\n\nint main()\n\n{\n\n    std::ios::sync_with_stdio(false);\n\n    std::cin.tie(0);\n\n\n\n    std::cout << std::fixed << std::setprecision(10);\n\n\n\n    Main();\n\n    std::cerr << flush;\n\n    std::cout << flush;\n\n\n\n    return 0;\n\n}\n",
        "optimized_code": "\n\n/*****/\n\n\n\n#define TRUE true\n\n#define FALSE false\n\n\n\n#include <bits/stdc++.h>\n\n\n\n/**/\n\n#pragma GCC target(\"avx\")\n\n#pragma GCC optimize(\"O3\")\n\n#pragma GCC optimize(\"unroll-loops\")\n\n/**/\n\n\n\nusing namespace std;\n\nusing ll = long long;\n\nusing ld = long double;\n\nusing pint = pair<int, int>;\n\nusing pll = pair<long long, long long>;\n\ntemplate <class T>\n\nusing vec = vector<T>;\n\ntemplate <class T>\n\nusing vec2 = vector<vector<T>>;\n\ntemplate <class T>\n\nusing vec3 = vector<vector<vector<T>>>;\n\n\n\nconstexpr int INF = numeric_limits<int>::max();\n\nconstexpr ll INFL = numeric_limits<ll>::max();\n\nconstexpr ll MOD = 1000000007; // 10^9+7\n\n\n\n#ifdef TRUE\n\n\n\n#define rep(i, n) for (ll i = 0, i##_len = (n); i < i##_len; ++i)\n\n#define rep1(i, n) for (ll i = 1, i##_len = (n); i <= i##_len; ++i)\n\n#define rrep(i, n) for (ll i = (n)-1; i >= 0; --i)\n\n#define rrep1(i, n) for (ll i = (n); i > 0; --i)\n\n#define step(i, a, n) for (ll i = (a), i##_len = (a) + (n); i < i##_len; ++i)\n\n#define rstep(i, a, n) for (ll i = (a) + (n)-1, i##_len = (a); i >= i##_len; --i)\n\n#define range(i, a, b) for (ll i = (a), i##_len = (b); i < i##_len; ++i)\n\n#define rrange(i, a, b) for (ll i = (b)-1, i##_len = (a); i >= i##_len; --i)\n\n\n\nstd::string strMulti(const int n, const std::string &t)\n\n{\n\n    std::string out = \"\";\n\n    for (int i = 0; i < n; i++)\n\n    {\n\n        out += t;\n\n    }\n\n    return out;\n\n}\n\nstd::string tab(const int n)\n\n{\n\n    return string(n, '\\t');\n\n}\n\nstd::string join(const vector<string> &v, const char *delim = 0)\n\n{\n\n    std::string s;\n\n    if (!v.empty())\n\n    {\n\n        s += v[0];\n\n        for (decltype(v.size()) i = 1, c = v.size(); i < c; ++i)\n\n        {\n\n            if (delim)\n\n                s += delim;\n\n            s += v[i];\n\n        }\n\n    }\n\n    return s;\n\n}\n\n\n\nstring to_string(string &s) { return '\"' + s + '\"'; }\n\nstring to_string(char &c) { return string({'\\'', c, '\\''}); }\n\ntemplate <class T1, class T2>\n\nstring to_string(pair<T1, T2> p) { return \"(\" + to_string(p.first) + \", \" + to_string(p.second) + \")\"; }\n\ntemplate <class Tuple, size_t... I>\n\nstring _to_string_tuple(Tuple &&t, std::index_sequence<I...>) { return \"(\" + join({to_string(std::get<I>(t))...}, \", \") + \")\"; }\n\ntemplate <class... Args>\n\nstring to_string(tuple<Args...> t) { return _to_string_tuple(std::forward<tuple<Args...>>(t), std::make_index_sequence<std::tuple_size<std::decay_t<tuple<Args...>>>::value>{}); }\n\ntemplate <class T>\n\nstring to_string(vector<T> ar)\n\n{\n\n    vector<string> texts(ar.size());\n\n    for (size_t i = 0; i < ar.size(); ++i)\n\n    {\n\n        texts[i] = to_string(ar[i]);\n\n    }\n\n    return \"{\" + join(texts, \", \") + \"}\";\n\n}\n\ntemplate <class T>\n\nstring to_string(initializer_list<T> il)\n\n{\n\n    vector<string> texts(il.size());\n\n    size_t i = 0;\n\n    for (T v : il)\n\n    {\n\n        texts[i] = to_string(v);\n\n        i++;\n\n    }\n\n    return \"{\" + join(texts, \", \") + \"}\";\n\n}\n\n\n\nvoid debug(string name);\n\nvoid debugn(string name);\n\ntemplate <class T>\n\nvoid debug(string name, T v);\n\ntemplate <class T>\n\nvoid debugn(string name, T v);\n\ntemplate <class T>\n\nvoid debug(string name, initializer_list<T> il);\n\ntemplate <class T>\n\nvoid debugn(string name, initializer_list<T> il);\n\ntemplate <class... Args>\n\nvoid debug(string name, Args... args);\n\ntemplate <class... Args>\n\nvoid debugn(string name, Args... args);\n\nvoid debugdo(function<void()> func);\n\n\n\n#ifdef DEBUG_BUILD\n\n#define debugvar(x) debugn(#x, (x))\n\n#define debugvartab(x, t) debugn(tab(t) + #x, (x))\n\nvoid debug(string name)\n\n{\n\n    std::cerr << name;\n\n}\n\nvoid debugn(string name) { std::cerr << name << '\\n'; }\n\ntemplate <class T>\n\nvoid debug(string name, T v) { std::cerr << name << \" = \" << to_string(v); }\n\ntemplate <class T>\n\nvoid debugn(string name, T v) { std::cerr << name << \" = \" << to_string(v) << '\\n'; }\n\ntemplate <class T>\n\nvoid debug(string name, initializer_list<T> il) { std::cerr << name << \" = \" << to_string(il); }\n\ntemplate <class T>\n\nvoid debugn(string name, initializer_list<T> il) { std::cerr << name << \" = \" << to_string(il) << '\\n'; }\n\ntemplate <class... Args>\n\nvoid debug(string name, Args... args) { std::cerr << name << \" = \" << to_string(tuple<Args...>(args...)); }\n\ntemplate <class... Args>\n\nvoid debugn(string name, Args... args) { std::cerr << name << \" = \" << to_string(tuple<Args...>(args...)) << '\\n'; }\n\nvoid debugdo(function<void()> func) { func(); }\n\n#else\n\n#define debugvar(x)\n\n#define debugvartab(x, t)\n\nvoid debug(string name)\n\n{\n\n}\n\nvoid debugln(string name) {}\n\ntemplate <class T>\n\nvoid debug(string name, T v) {}\n\ntemplate <class T>\n\nvoid debugn(string name, T v) {}\n\ntemplate <class T>\n\nvoid debug(string name, initializer_list<T> il) {}\n\ntemplate <class T>\n\nvoid debugn(string name, initializer_list<T> il) {}\n\ntemplate <class... Args>\n\nvoid debug(string name, Args... args) {}\n\ntemplate <class... Args>\n\nvoid debugn(string name, Args... args) {}\n\nvoid debugdo(function<void()> func) {}\n\n#endif\n\n\n\n#define all(x) (x).begin(), (x).end()\n\n#define pair(a, b) make_pair(a, b)\n\n\n\ntemplate <class T>\n\nbool chmax(T &a, const T b)\n\n{\n\n    if (a < b)\n\n    {\n\n        a = b;\n\n        return true;\n\n    }\n\n    return false;\n\n}\n\ntemplate <class T>\n\nbool chmin(T &a, const T b)\n\n{\n\n    if (a > b)\n\n    {\n\n        a = b;\n\n        return true;\n\n    }\n\n    return false;\n\n}\n\ntemplate <class T>\n\nT divup(const T a, const T b)\n\n{\n\n    if (a % b == 0)\n\n    {\n\n        return a / b;\n\n    }\n\n    return a / b + 1;\n\n}\n\ntemplate <class T>\n\nbool cmp_2nd(pair<T, T> a, pair<T, T> b)\n\n{\n\n    if (a.second != b.second)\n\n    {\n\n        return a.second < b.second;\n\n    }\n\n    return a.first < b.first;\n\n}\n\nll modpow(ll x, ll n, const ll &p)\n\n{\n\n    ll ret = 1;\n\n    while (n > 0)\n\n    {\n\n        if (n & 1)\n\n        {\n\n            (ret *= x) %= p;\n\n        }\n\n        (x *= x) %= p;\n\n        n >>= 1;\n\n    }\n\n    return ret;\n\n}\n\ntemplate <class T>\n\nT modinv(T a, const T &p)\n\n{\n\n    T b = p, u = 1, v = 0;\n\n    while (b)\n\n    {\n\n        T t = a / b;\n\n        a -= t * b;\n\n        swap(a, b);\n\n        u -= t * v;\n\n        swap(u, v);\n\n    }\n\n    u %= p;\n\n    if (u < 0)\n\n    {\n\n        u += p;\n\n    }\n\n    return u;\n\n}\n\ntemplate <class T>\n\nT math_P(T m, T n)\n\n{\n\n    T ret = 1;\n\n    for (T i = m; i > m - n; i--)\n\n    {\n\n        ret *= i;\n\n    }\n\n    return ret;\n\n}\n\ntemplate <class T>\n\nT math_C(T m, T n)\n\n{\n\n    T ret = math_P(m, n);\n\n    for (T i = 2; i <= n; i++)\n\n    {\n\n        ret /= i;\n\n    }\n\n    return ret;\n\n}\n\nll extended_euclidean(ll u, ll v)\n\n{\n\n    ll r0 = u;\n\n    ll r1 = v;\n\n    ll s0 = 1;\n\n    ll s1 = 0;\n\n    ll t0 = 0;\n\n    ll t1 = 1;\n\n    while (r1 != 0)\n\n    {\n\n        ll q = r0 / r1;\n\n        ll r = r0 - q * r1;\n\n        ll s = s0 - q * s1;\n\n        ll t = t0 - q * t1;\n\n        r0 = r1;\n\n        s0 = s1;\n\n        t0 = t1;\n\n        r1 = r;\n\n        s1 = s;\n\n        t1 = t;\n\n    }\n\n    if (t0 < 0)\n\n    {\n\n        return t0 + u;\n\n    }\n\n    else\n\n    {\n\n        return t0;\n\n    }\n\n}\n\nll math_C_mod(ll n, ll c, const ll &p)\n\n{\n\n    ll upe = 1;\n\n    ll dow = 1;\n\n    for (ll i = 1; i < c + 1; ++i)\n\n    {\n\n        upe = upe * n % p;\n\n        dow = dow * i % p;\n\n        n -= 1;\n\n    }\n\n    return (upe * extended_euclidean(p, dow)) % p;\n\n}\n\ntemplate <class T>\n\nT math_gcd(T a, T b)\n\n{\n\n    if (b == 0)\n\n    {\n\n        return a;\n\n    }\n\n    else\n\n    {\n\n        return math_gcd(b, a % b);\n\n    }\n\n}\n\ntemplate <class T>\n\nT math_lcm(T a, T b) { return a / math_gcd(a, b) * b; }\n\ntemplate <class T>\n\nT SumStep(T a, T n, T d) { return n * (2 * a + (n - 1) * d) / 2; }\n\ntemplate <class T>\n\nT SumRange(T a, T b, T d) { return SumStep(a, (b - a) / d, d); }\n\n\n\n#endif\n\n\n\n/*****/\n\n\n\nconstexpr ll Type = 26;\n\nll D = 365;\n\nvec<ll> C;\n\nvec2<ll> S;\n\nvec2<ll> T;\n\nll M;\n\nvec<ll> _Score;\n\nll choise = 0;\n\n\n\nll solve_score(ll begin = 0, ll end = D)\n\n{\n\n    _Score.resize(D + 1);\n\n    vec<ll> last(Type, -1);\n\n    if (begin == 0)\n\n        _Score[0] = 0;\n\n    else\n\n        _Score[begin] = _Score[begin - 1];\n\n    range(day, begin, end)\n\n    {\n\n        ll t = T[choise][day];\n\n        if (t != -1)\n\n        {\n\n            _Score[day] += S[day][t];\n\n            last[t] = day;\n\n        }\n\n\n\n        rep(j, Type)\n\n        {\n\n            _Score[day] -= C[j] * (day - last[j]);\n\n        }\n\n        _Score[day + 1] = _Score[day];\n\n    }\n\n    return _Score[end];\n\n}\n\n\n\nvoid set_greedy()\n\n{\n\n    rep(day, D)\n\n    {\n\n        //int maxSI = max_element(all(S[day])) - S[day].begin();\n\n\n\n        ll maxsc = -INFL;\n\n        ll maxsc_t = -1;\n\n        rep(t, Type)\n\n        {\n\n            T[choise][day] = t;\n\n            if (chmax(maxsc, solve_score(day, day + 1)))\n\n            {\n\n                maxsc_t = t;\n\n            }\n\n        }\n\n\n\n        T[choise][day] = maxsc_t;\n\n        solve_score(day, day + 1);\n\n    }\n\n}\n\n\n\nvoid input()\n\n{\n\n#ifdef DEBUG_BUILD\n\n    std::ifstream ifs(\"Comp\\\\input.txt\");\n\n    if (!ifs)\n\n    {\n\n        cerr << \"Error: file not opened.\" << endl;\n\n        return;\n\n    }\n\n    //debugn(\"D\");\n\n    ifs >> D;\n\n    C.resize(Type);\n\n    //debugn(\"C\");\n\n    rep(i, Type) ifs >> C[i];\n\n    //debugn(\"S\");\n\n    S.resize(D, vec<ll>(Type));\n\n    rep(i, D) rep(j, Type) ifs >> S[i][j];\n\n#else\n\n    cin >> D;\n\n    C.resize(Type);\n\n    rep(i, Type) cin >> C[i];\n\n    S.resize(D, vec<ll>(Type));\n\n    rep(i, D) rep(j, Type) cin >> S[i][j];\n\n#endif\n\n\n\n    T.resize(20, vec<ll>(D, -1));\n\n    set_greedy();\n\n}\n\n\n\nvoid Main()\n\n{\n\n    input();\n\n\n\n    //set_greedy();\n\n\n\n    /*****/\n\n\n\n    /**/\n\n    // 20\n\n    ll maxScore = -INFL;\n\n    ll maxScoreChoise = 0;\n\n    rep(i, 1)\n\n    {\n\n        choise = i;\n\n        if (i == 0)\n\n            set_greedy();\n\n        else\n\n        {\n\n            rep(j, D)\n\n            {\n\n                T[i][j] = (i * 3 + j * 13) % Type;\n\n            }\n\n        }\n\n        //debugvar(T[i]);\n\n        rep(time, 1)\n\n        {\n\n            rrep(day, D)\n\n            {\n\n                ll maxsc = -INFL;\n\n                ll maxsc_t = -1;\n\n                rep(t, Type)\n\n                {\n\n                    T[i][day] = t;\n\n                    if (chmax(maxsc, solve_score(day)))\n\n                    {\n\n                        maxsc_t = t;\n\n                    }\n\n                }\n\n\n\n                T[i][day] = maxsc_t;\n\n                solve_score(day);\n\n            }\n\n            rep(day, D)\n\n            {\n\n                ll maxsc = -INFL;\n\n                ll maxsc_t = -1;\n\n                rep(t, Type)\n\n                {\n\n                    T[i][day] = t;\n\n                    if (chmax(maxsc, solve_score()))\n\n                    {\n\n                        maxsc_t = t;\n\n                    }\n\n                }\n\n\n\n                T[i][day] = maxsc_t;\n\n                solve_score();\n\n            }\n\n        }\n\n\n\n        debugvar(i);\n\n        debugvar(solve_score());\n\n       \n\n        if (chmax(maxScore, solve_score()))\n\n        {\n\n            maxScoreChoise = i;\n\n        }\n\n    }\n\n    //*/\n\n\n\n    /*****/\n\n\n\n    rep(i, D)\n\n    {\n\n        cout << T[maxScoreChoise][i] + 1 << '\\n';\n\n    }\n\n    debugvar(solve_score());\n\n}\n\n\n\n/*****/\n\n\n\nint main()\n\n{\n\n    std::ios::sync_with_stdio(false);\n\n    std::cin.tie(0);\n\n\n\n    std::cout << std::fixed << std::setprecision(10);\n\n\n\n    Main();\n\n    std::cerr << flush;\n\n    std::cout << flush;\n\n\n\n    return 0;\n\n}\n"
    },
    {
        "id": "670",
        "source_code": "\n\n/*****/\n\n\n\n#define TRUE true\n\n#define FALSE false\n\n\n\n#include <bits/stdc++.h>\n\n\n\n/**/\n\n#pragma GCC target(\"avx\")\n\n#pragma GCC optimize(\"O3\")\n\n#pragma GCC optimize(\"unroll-loops\")\n\n/**/\n\n\n\nusing namespace std;\n\nusing ll = long long;\n\nusing ld = long double;\n\nusing pint = pair<int, int>;\n\nusing pll = pair<long long, long long>;\n\ntemplate <class T>\n\nusing vec = vector<T>;\n\ntemplate <class T>\n\nusing vec2 = vector<vector<T>>;\n\ntemplate <class T>\n\nusing vec3 = vector<vector<vector<T>>>;\n\n\n\nconstexpr int INF = numeric_limits<int>::max();\n\nconstexpr ll INFL = numeric_limits<ll>::max();\n\nconstexpr ll MOD = 1000000007; // 10^9+7\n\n\n\n#ifdef TRUE\n\n\n\n#define rep(i, n) for (ll i = 0, i##_len = (n); i < i##_len; ++i)\n\n#define rep1(i, n) for (ll i = 1, i##_len = (n); i <= i##_len; ++i)\n\n#define rrep(i, n) for (ll i = (n)-1; i >= 0; --i)\n\n#define rrep1(i, n) for (ll i = (n); i > 0; --i)\n\n#define step(i, a, n) for (ll i = (a), i##_len = (a) + (n); i < i##_len; ++i)\n\n#define rstep(i, a, n) for (ll i = (a) + (n)-1, i##_len = (a); i >= i##_len; --i)\n\n#define range(i, a, b) for (ll i = (a), i##_len = (b); i < i##_len; ++i)\n\n#define rrange(i, a, b) for (ll i = (b)-1, i##_len = (a); i >= i##_len; --i)\n\n\n\nstd::string strMulti(const int n, const std::string &t)\n\n{\n\n    std::string out = \"\";\n\n    for (int i = 0; i < n; i++)\n\n    {\n\n        out += t;\n\n    }\n\n    return out;\n\n}\n\nstd::string tab(const int n)\n\n{\n\n    return string(n, '\\t');\n\n}\n\nstd::string join(const vector<string> &v, const char *delim = 0)\n\n{\n\n    std::string s;\n\n    if (!v.empty())\n\n    {\n\n        s += v[0];\n\n        for (decltype(v.size()) i = 1, c = v.size(); i < c; ++i)\n\n        {\n\n            if (delim)\n\n                s += delim;\n\n            s += v[i];\n\n        }\n\n    }\n\n    return s;\n\n}\n\n\n\nstring to_string(string &s) { return '\"' + s + '\"'; }\n\nstring to_string(char &c) { return string({'\\'', c, '\\''}); }\n\ntemplate <class T1, class T2>\n\nstring to_string(pair<T1, T2> p) { return \"(\" + to_string(p.first) + \", \" + to_string(p.second) + \")\"; }\n\ntemplate <class Tuple, size_t... I>\n\nstring _to_string_tuple(Tuple &&t, std::index_sequence<I...>) { return \"(\" + join({to_string(std::get<I>(t))...}, \", \") + \")\"; }\n\ntemplate <class... Args>\n\nstring to_string(tuple<Args...> t) { return _to_string_tuple(std::forward<tuple<Args...>>(t), std::make_index_sequence<std::tuple_size<std::decay_t<tuple<Args...>>>::value>{}); }\n\ntemplate <class T>\n\nstring to_string(vector<T> ar)\n\n{\n\n    vector<string> texts(ar.size());\n\n    for (size_t i = 0; i < ar.size(); ++i)\n\n    {\n\n        texts[i] = to_string(ar[i]);\n\n    }\n\n    return \"{\" + join(texts, \", \") + \"}\";\n\n}\n\ntemplate <class T>\n\nstring to_string(initializer_list<T> il)\n\n{\n\n    vector<string> texts(il.size());\n\n    size_t i = 0;\n\n    for (T v : il)\n\n    {\n\n        texts[i] = to_string(v);\n\n        i++;\n\n    }\n\n    return \"{\" + join(texts, \", \") + \"}\";\n\n}\n\n\n\nvoid debug(string name);\n\nvoid debugn(string name);\n\ntemplate <class T>\n\nvoid debug(string name, T v);\n\ntemplate <class T>\n\nvoid debugn(string name, T v);\n\ntemplate <class T>\n\nvoid debug(string name, initializer_list<T> il);\n\ntemplate <class T>\n\nvoid debugn(string name, initializer_list<T> il);\n\ntemplate <class... Args>\n\nvoid debug(string name, Args... args);\n\ntemplate <class... Args>\n\nvoid debugn(string name, Args... args);\n\nvoid debugdo(function<void()> func);\n\n\n\n#ifdef DEBUG_BUILD\n\n#define debugvar(x) debugn(#x, (x))\n\n#define debugvartab(x, t) debugn(tab(t) + #x, (x))\n\nvoid debug(string name)\n\n{\n\n    std::cerr << name;\n\n}\n\nvoid debugn(string name) { std::cerr << name << '\\n'; }\n\ntemplate <class T>\n\nvoid debug(string name, T v) { std::cerr << name << \" = \" << to_string(v); }\n\ntemplate <class T>\n\nvoid debugn(string name, T v) { std::cerr << name << \" = \" << to_string(v) << '\\n'; }\n\ntemplate <class T>\n\nvoid debug(string name, initializer_list<T> il) { std::cerr << name << \" = \" << to_string(il); }\n\ntemplate <class T>\n\nvoid debugn(string name, initializer_list<T> il) { std::cerr << name << \" = \" << to_string(il) << '\\n'; }\n\ntemplate <class... Args>\n\nvoid debug(string name, Args... args) { std::cerr << name << \" = \" << to_string(tuple<Args...>(args...)); }\n\ntemplate <class... Args>\n\nvoid debugn(string name, Args... args) { std::cerr << name << \" = \" << to_string(tuple<Args...>(args...)) << '\\n'; }\n\nvoid debugdo(function<void()> func) { func(); }\n\n#else\n\n#define debugvar(x)\n\n#define debugvartab(x, t)\n\nvoid debug(string name)\n\n{\n\n}\n\nvoid debugln(string name) {}\n\ntemplate <class T>\n\nvoid debug(string name, T v) {}\n\ntemplate <class T>\n\nvoid debugn(string name, T v) {}\n\ntemplate <class T>\n\nvoid debug(string name, initializer_list<T> il) {}\n\ntemplate <class T>\n\nvoid debugn(string name, initializer_list<T> il) {}\n\ntemplate <class... Args>\n\nvoid debug(string name, Args... args) {}\n\ntemplate <class... Args>\n\nvoid debugn(string name, Args... args) {}\n\nvoid debugdo(function<void()> func) {}\n\n#endif\n\n\n\n#define all(x) (x).begin(), (x).end()\n\n#define pair(a, b) make_pair(a, b)\n\n\n\ntemplate <class T>\n\nbool chmax(T &a, const T b)\n\n{\n\n    if (a < b)\n\n    {\n\n        a = b;\n\n        return true;\n\n    }\n\n    return false;\n\n}\n\ntemplate <class T>\n\nbool chmin(T &a, const T b)\n\n{\n\n    if (a > b)\n\n    {\n\n        a = b;\n\n        return true;\n\n    }\n\n    return false;\n\n}\n\ntemplate <class T>\n\nT divup(const T a, const T b)\n\n{\n\n    if (a % b == 0)\n\n    {\n\n        return a / b;\n\n    }\n\n    return a / b + 1;\n\n}\n\ntemplate <class T>\n\nbool cmp_2nd(pair<T, T> a, pair<T, T> b)\n\n{\n\n    if (a.second != b.second)\n\n    {\n\n        return a.second < b.second;\n\n    }\n\n    return a.first < b.first;\n\n}\n\nll modpow(ll x, ll n, const ll &p)\n\n{\n\n    ll ret = 1;\n\n    while (n > 0)\n\n    {\n\n        if (n & 1)\n\n        {\n\n            (ret *= x) %= p;\n\n        }\n\n        (x *= x) %= p;\n\n        n >>= 1;\n\n    }\n\n    return ret;\n\n}\n\ntemplate <class T>\n\nT modinv(T a, const T &p)\n\n{\n\n    T b = p, u = 1, v = 0;\n\n    while (b)\n\n    {\n\n        T t = a / b;\n\n        a -= t * b;\n\n        swap(a, b);\n\n        u -= t * v;\n\n        swap(u, v);\n\n    }\n\n    u %= p;\n\n    if (u < 0)\n\n    {\n\n        u += p;\n\n    }\n\n    return u;\n\n}\n\ntemplate <class T>\n\nT math_P(T m, T n)\n\n{\n\n    T ret = 1;\n\n    for (T i = m; i > m - n; i--)\n\n    {\n\n        ret *= i;\n\n    }\n\n    return ret;\n\n}\n\ntemplate <class T>\n\nT math_C(T m, T n)\n\n{\n\n    T ret = math_P(m, n);\n\n    for (T i = 2; i <= n; i++)\n\n    {\n\n        ret /= i;\n\n    }\n\n    return ret;\n\n}\n\nll extended_euclidean(ll u, ll v)\n\n{\n\n    ll r0 = u;\n\n    ll r1 = v;\n\n    ll s0 = 1;\n\n    ll s1 = 0;\n\n    ll t0 = 0;\n\n    ll t1 = 1;\n\n    while (r1 != 0)\n\n    {\n\n        ll q = r0 / r1;\n\n        ll r = r0 - q * r1;\n\n        ll s = s0 - q * s1;\n\n        ll t = t0 - q * t1;\n\n        r0 = r1;\n\n        s0 = s1;\n\n        t0 = t1;\n\n        r1 = r;\n\n        s1 = s;\n\n        t1 = t;\n\n    }\n\n    if (t0 < 0)\n\n    {\n\n        return t0 + u;\n\n    }\n\n    else\n\n    {\n\n        return t0;\n\n    }\n\n}\n\nll math_C_mod(ll n, ll c, const ll &p)\n\n{\n\n    ll upe = 1;\n\n    ll dow = 1;\n\n    for (ll i = 1; i < c + 1; ++i)\n\n    {\n\n        upe = upe * n % p;\n\n        dow = dow * i % p;\n\n        n -= 1;\n\n    }\n\n    return (upe * extended_euclidean(p, dow)) % p;\n\n}\n\ntemplate <class T>\n\nT math_gcd(T a, T b)\n\n{\n\n    if (b == 0)\n\n    {\n\n        return a;\n\n    }\n\n    else\n\n    {\n\n        return math_gcd(b, a % b);\n\n    }\n\n}\n\ntemplate <class T>\n\nT math_lcm(T a, T b) { return a / math_gcd(a, b) * b; }\n\ntemplate <class T>\n\nT SumStep(T a, T n, T d) { return n * (2 * a + (n - 1) * d) / 2; }\n\ntemplate <class T>\n\nT SumRange(T a, T b, T d) { return SumStep(a, (b - a) / d, d); }\n\n\n\n#endif\n\n\n\n/*****/\n\n\n\nconstexpr ll Type = 26;\n\nll D = 365;\n\nvec<ll> C;\n\nvec2<ll> S;\n\nvec<ll> T;\n\nll M;\n\nvec<ll> _Score;\n\n\n\nll solve_score(ll begin = 0, ll end = D)\n\n{\n\n    _Score.resize(D + 1);\n\n    vec<ll> last(Type, -1);\n\n    if (begin == 0)\n\n        _Score[0] = 0;\n\n    else\n\n        _Score[begin] = _Score[begin - 1];\n\n    range(day, begin, end)\n\n    {\n\n        ll t = T[day];\n\n        if (t != -1)\n\n        {\n\n            _Score[day] += S[day][t];\n\n            last[t] = day;\n\n        }\n\n\n\n        rep(j, Type)\n\n        {\n\n            _Score[day] -= C[j] * (day - last[j]);\n\n        }\n\n        _Score[day + 1] = _Score[day];\n\n    }\n\n    return _Score[end];\n\n}\n\n\n\nvoid set_greedy()\n\n{\n\n    rep(day, D)\n\n    {\n\n        //int maxSI = max_element(all(S[day])) - S[day].begin();\n\n\n\n        ll maxsc = -INFL;\n\n        ll maxsc_t = -1;\n\n        rep(t, Type)\n\n        {\n\n            T[day] = t;\n\n            if (chmax(maxsc, solve_score(day)))\n\n            {\n\n                maxsc_t = t;\n\n            }\n\n        }\n\n\n\n        T[day] = maxsc_t;\n\n        solve_score(day);\n\n    }\n\n}\n\n\n\nvoid input()\n\n{\n\n#ifdef DEBUG_BUILD\n\n    std::ifstream ifs(\"Comp\\\\input.txt\");\n\n    if (!ifs)\n\n    {\n\n        cerr << \"Error: file not opened.\" << endl;\n\n        return;\n\n    }\n\n    //debugn(\"D\");\n\n    ifs >> D;\n\n    C.resize(Type);\n\n    //debugn(\"C\");\n\n    rep(i, Type) ifs >> C[i];\n\n    //debugn(\"S\");\n\n    S.resize(D, vec<ll>(Type));\n\n    rep(i, D) rep(j, Type) ifs >> S[i][j];\n\n#else\n\n    cin >> D;\n\n    C.resize(Type);\n\n    rep(i, Type) cin >> C[i];\n\n    S.resize(D, vec<ll>(Type));\n\n    rep(i, D) rep(j, Type) cin >> S[i][j];\n\n#endif\n\n\n\n    T.resize(D, -1);\n\n    set_greedy();\n\n}\n\n\n\nvoid Main()\n\n{\n\n    input();\n\n\n\n    T.resize(D, -1);\n\n    set_greedy();\n\n\n\n    /*****/\n\n\n\n    /**/\n\n    rep(i, 5)\n\n    {\n\n        rrep(day, D)\n\n        {\n\n            ll maxsc = -INFL;\n\n            ll maxsc_t = -1;\n\n            rep(t, Type)\n\n            {\n\n                T[day] = t;\n\n                if (chmax(maxsc, solve_score(day)))\n\n                {\n\n                    maxsc_t = t;\n\n                }\n\n            }\n\n\n\n            T[day] = maxsc_t;\n\n            solve_score(day);\n\n        }\n\n        rep(day, D)\n\n        {\n\n            ll maxsc = -INFL;\n\n            ll maxsc_t = -1;\n\n            rep(t, Type)\n\n            {\n\n                T[day] = t;\n\n                if (chmax(maxsc, solve_score()))\n\n                {\n\n                    maxsc_t = t;\n\n                }\n\n            }\n\n\n\n            T[day] = maxsc_t;\n\n            solve_score();\n\n        }\n\n    }\n\n    //*/\n\n\n\n    /*****/\n\n\n\n    rep(i, D)\n\n    {\n\n        cout << T[i] + 1 << '\\n';\n\n    }\n\n    debugvar(solve_score());\n\n}\n\n\n\n/*****/\n\n\n\nint main()\n\n{\n\n    std::ios::sync_with_stdio(false);\n\n    std::cin.tie(0);\n\n\n\n    std::cout << std::fixed << std::setprecision(10);\n\n\n\n    Main();\n\n    std::cerr << flush;\n\n    std::cout << flush;\n\n\n\n    return 0;\n\n}\n",
        "optimized_code": "/*****/\n\n\n\n#define TRUE true\n\n#define FALSE false\n\n\n\n#include <bits/stdc++.h>\n\n\n\n/**/\n\n#pragma GCC target(\"avx\")\n\n#pragma GCC optimize(\"O3\")\n\n#pragma GCC optimize(\"unroll-loops\")\n\n/**/\n\n\n\nusing namespace std;\n\nusing ll = long long;\n\nusing ld = long double;\n\nusing pint = pair<int, int>;\n\nusing pll = pair<long long, long long>;\n\ntemplate <class T>\n\nusing vec = vector<T>;\n\ntemplate <class T>\n\nusing vec2 = vector<vector<T>>;\n\ntemplate <class T>\n\nusing vec3 = vector<vector<vector<T>>>;\n\n\n\nconstexpr int INF = numeric_limits<int>::max();\n\nconstexpr ll INFL = numeric_limits<ll>::max();\n\nconstexpr ll MOD = 1000000007; // 10^9+7\n\n\n\n#ifdef TRUE\n\n\n\n#define rep(i, n) for (ll i = 0, i##_len = (n); i < i##_len; ++i)\n\n#define rep1(i, n) for (ll i = 1, i##_len = (n); i <= i##_len; ++i)\n\n#define rrep(i, n) for (ll i = (n)-1; i >= 0; --i)\n\n#define rrep1(i, n) for (ll i = (n); i > 0; --i)\n\n#define step(i, a, n) for (ll i = (a), i##_len = (a) + (n); i < i##_len; ++i)\n\n#define rstep(i, a, n) for (ll i = (a) + (n)-1, i##_len = (a); i >= i##_len; --i)\n\n#define range(i, a, b) for (ll i = (a), i##_len = (b); i < i##_len; ++i)\n\n#define rrange(i, a, b) for (ll i = (b)-1, i##_len = (a); i >= i##_len; --i)\n\n\n\nstd::string strMulti(const int n, const std::string &t)\n\n{\n\n    std::string out = \"\";\n\n    for (int i = 0; i < n; i++)\n\n    {\n\n        out += t;\n\n    }\n\n    return out;\n\n}\n\nstd::string tab(const int n)\n\n{\n\n    return string(n, '\\t');\n\n}\n\nstd::string join(const vector<string> &v, const char *delim = 0)\n\n{\n\n    std::string s;\n\n    if (!v.empty())\n\n    {\n\n        s += v[0];\n\n        for (decltype(v.size()) i = 1, c = v.size(); i < c; ++i)\n\n        {\n\n            if (delim)\n\n                s += delim;\n\n            s += v[i];\n\n        }\n\n    }\n\n    return s;\n\n}\n\n\n\nstring to_string(string &s) { return '\"' + s + '\"'; }\n\nstring to_string(char &c) { return string({'\\'', c, '\\''}); }\n\ntemplate <class T1, class T2>\n\nstring to_string(pair<T1, T2> p) { return \"(\" + to_string(p.first) + \", \" + to_string(p.second) + \")\"; }\n\ntemplate <class Tuple, size_t... I>\n\nstring _to_string_tuple(Tuple &&t, std::index_sequence<I...>) { return \"(\" + join({to_string(std::get<I>(t))...}, \", \") + \")\"; }\n\ntemplate <class... Args>\n\nstring to_string(tuple<Args...> t) { return _to_string_tuple(std::forward<tuple<Args...>>(t), std::make_index_sequence<std::tuple_size<std::decay_t<tuple<Args...>>>::value>{}); }\n\ntemplate <class T>\n\nstring to_string(vector<T> ar)\n\n{\n\n    vector<string> texts(ar.size());\n\n    for (size_t i = 0; i < ar.size(); ++i)\n\n    {\n\n        texts[i] = to_string(ar[i]);\n\n    }\n\n    return \"{\" + join(texts, \", \") + \"}\";\n\n}\n\ntemplate <class T>\n\nstring to_string(initializer_list<T> il)\n\n{\n\n    vector<string> texts(il.size());\n\n    size_t i = 0;\n\n    for (T v : il)\n\n    {\n\n        texts[i] = to_string(v);\n\n        i++;\n\n    }\n\n    return \"{\" + join(texts, \", \") + \"}\";\n\n}\n\n\n\nvoid debug(string name);\n\nvoid debugn(string name);\n\ntemplate <class T>\n\nvoid debug(string name, T v);\n\ntemplate <class T>\n\nvoid debugn(string name, T v);\n\ntemplate <class T>\n\nvoid debug(string name, initializer_list<T> il);\n\ntemplate <class T>\n\nvoid debugn(string name, initializer_list<T> il);\n\ntemplate <class... Args>\n\nvoid debug(string name, Args... args);\n\ntemplate <class... Args>\n\nvoid debugn(string name, Args... args);\n\nvoid debugdo(function<void()> func);\n\n\n\n#ifdef DEBUG_BUILD\n\n#define debugvar(x) debugn(#x, (x))\n\n#define debugvartab(x, t) debugn(tab(t) + #x, (x))\n\nvoid debug(string name)\n\n{\n\n    std::cerr << name;\n\n}\n\nvoid debugn(string name) { std::cerr << name << '\\n'; }\n\ntemplate <class T>\n\nvoid debug(string name, T v) { std::cerr << name << \" = \" << to_string(v); }\n\ntemplate <class T>\n\nvoid debugn(string name, T v) { std::cerr << name << \" = \" << to_string(v) << '\\n'; }\n\ntemplate <class T>\n\nvoid debug(string name, initializer_list<T> il) { std::cerr << name << \" = \" << to_string(il); }\n\ntemplate <class T>\n\nvoid debugn(string name, initializer_list<T> il) { std::cerr << name << \" = \" << to_string(il) << '\\n'; }\n\ntemplate <class... Args>\n\nvoid debug(string name, Args... args) { std::cerr << name << \" = \" << to_string(tuple<Args...>(args...)); }\n\ntemplate <class... Args>\n\nvoid debugn(string name, Args... args) { std::cerr << name << \" = \" << to_string(tuple<Args...>(args...)) << '\\n'; }\n\nvoid debugdo(function<void()> func) { func(); }\n\n#else\n\n#define debugvar(x)\n\n#define debugvartab(x, t)\n\nvoid debug(string name)\n\n{\n\n}\n\nvoid debugln(string name) {}\n\ntemplate <class T>\n\nvoid debug(string name, T v) {}\n\ntemplate <class T>\n\nvoid debugn(string name, T v) {}\n\ntemplate <class T>\n\nvoid debug(string name, initializer_list<T> il) {}\n\ntemplate <class T>\n\nvoid debugn(string name, initializer_list<T> il) {}\n\ntemplate <class... Args>\n\nvoid debug(string name, Args... args) {}\n\ntemplate <class... Args>\n\nvoid debugn(string name, Args... args) {}\n\nvoid debugdo(function<void()> func) {}\n\n#endif\n\n\n\n#define all(x) (x).begin(), (x).end()\n\n#define pair(a, b) make_pair(a, b)\n\n\n\ntemplate <class T>\n\nbool chmax(T &a, const T b)\n\n{\n\n    if (a < b)\n\n    {\n\n        a = b;\n\n        return true;\n\n    }\n\n    return false;\n\n}\n\ntemplate <class T>\n\nbool chmin(T &a, const T b)\n\n{\n\n    if (a > b)\n\n    {\n\n        a = b;\n\n        return true;\n\n    }\n\n    return false;\n\n}\n\ntemplate <class T>\n\nT divup(const T a, const T b)\n\n{\n\n    if (a % b == 0)\n\n    {\n\n        return a / b;\n\n    }\n\n    return a / b + 1;\n\n}\n\ntemplate <class T>\n\nbool cmp_2nd(pair<T, T> a, pair<T, T> b)\n\n{\n\n    if (a.second != b.second)\n\n    {\n\n        return a.second < b.second;\n\n    }\n\n    return a.first < b.first;\n\n}\n\nll modpow(ll x, ll n, const ll &p)\n\n{\n\n    ll ret = 1;\n\n    while (n > 0)\n\n    {\n\n        if (n & 1)\n\n        {\n\n            (ret *= x) %= p;\n\n        }\n\n        (x *= x) %= p;\n\n        n >>= 1;\n\n    }\n\n    return ret;\n\n}\n\ntemplate <class T>\n\nT modinv(T a, const T &p)\n\n{\n\n    T b = p, u = 1, v = 0;\n\n    while (b)\n\n    {\n\n        T t = a / b;\n\n        a -= t * b;\n\n        swap(a, b);\n\n        u -= t * v;\n\n        swap(u, v);\n\n    }\n\n    u %= p;\n\n    if (u < 0)\n\n    {\n\n        u += p;\n\n    }\n\n    return u;\n\n}\n\ntemplate <class T>\n\nT math_P(T m, T n)\n\n{\n\n    T ret = 1;\n\n    for (T i = m; i > m - n; i--)\n\n    {\n\n        ret *= i;\n\n    }\n\n    return ret;\n\n}\n\ntemplate <class T>\n\nT math_C(T m, T n)\n\n{\n\n    T ret = math_P(m, n);\n\n    for (T i = 2; i <= n; i++)\n\n    {\n\n        ret /= i;\n\n    }\n\n    return ret;\n\n}\n\nll extended_euclidean(ll u, ll v)\n\n{\n\n    ll r0 = u;\n\n    ll r1 = v;\n\n    ll s0 = 1;\n\n    ll s1 = 0;\n\n    ll t0 = 0;\n\n    ll t1 = 1;\n\n    while (r1 != 0)\n\n    {\n\n        ll q = r0 / r1;\n\n        ll r = r0 - q * r1;\n\n        ll s = s0 - q * s1;\n\n        ll t = t0 - q * t1;\n\n        r0 = r1;\n\n        s0 = s1;\n\n        t0 = t1;\n\n        r1 = r;\n\n        s1 = s;\n\n        t1 = t;\n\n    }\n\n    if (t0 < 0)\n\n    {\n\n        return t0 + u;\n\n    }\n\n    else\n\n    {\n\n        return t0;\n\n    }\n\n}\n\nll math_C_mod(ll n, ll c, const ll &p)\n\n{\n\n    ll upe = 1;\n\n    ll dow = 1;\n\n    for (ll i = 1; i < c + 1; ++i)\n\n    {\n\n        upe = upe * n % p;\n\n        dow = dow * i % p;\n\n        n -= 1;\n\n    }\n\n    return (upe * extended_euclidean(p, dow)) % p;\n\n}\n\ntemplate <class T>\n\nT math_gcd(T a, T b)\n\n{\n\n    if (b == 0)\n\n    {\n\n        return a;\n\n    }\n\n    else\n\n    {\n\n        return math_gcd(b, a % b);\n\n    }\n\n}\n\ntemplate <class T>\n\nT math_lcm(T a, T b) { return a / math_gcd(a, b) * b; }\n\ntemplate <class T>\n\nT SumStep(T a, T n, T d) { return n * (2 * a + (n - 1) * d) / 2; }\n\ntemplate <class T>\n\nT SumRange(T a, T b, T d) { return SumStep(a, (b - a) / d, d); }\n\n\n\n#endif\n\n\n\n/*****/\n\n\n\nconstexpr ll Type = 26;\n\nll D = 365;\n\nvec<ll> C;\n\nvec2<ll> S;\n\nvec<ll> T;\n\nvec<ll> _Score;\n\n\n\nll solve_score(ll begin = 0, ll end = D)\n\n{\n\n    _Score.resize(D + 1);\n\n    vec<ll> last(Type, -1);\n\n    if (begin == 0)\n\n        _Score[0] = 0;\n\n    else\n\n        _Score[begin] = _Score[begin - 1];\n\n    range(day, begin, end)\n\n    {\n\n        ll t = T[day];\n\n        if (t != -1)\n\n        {\n\n            _Score[day] += S[day][t];\n\n            last[t] = day;\n\n        }\n\n\n\n        rep(j, Type)\n\n        {\n\n            _Score[day] -= C[j] * (day - last[j]);\n\n        }\n\n\n\n        _Score[day + 1] = _Score[day];\n\n    }\n\n    return _Score[end];\n\n}\n\n\n\nll set_greedy()\n\n{\n\n    ll score = 0;\n\n    vec<ll> last(Type, -1);\n\n\n\n    rep(day, D)\n\n    {\n\n        ll down = 0;\n\n        rep(t, Type)\n\n        {\n\n            down += C[t] * (day - last[t]);\n\n        }\n\n\n\n        ll maxsc = -INFL;\n\n        ll maxsc_t = -1;\n\n        rep(t, Type)\n\n        {\n\n            ll sc = 0;\n\n            sc += score + S[day][t] - down + C[t] * (day - last[t]);\n\n\n\n            if (chmax(maxsc, sc))\n\n            {\n\n                maxsc_t = t;\n\n            }\n\n        }\n\n\n\n        T[day] = maxsc_t;\n\n        score += S[day][maxsc_t] - down + C[maxsc_t] * (day - last[maxsc_t]);\n\n        last[maxsc_t] = day;\n\n        //debugvar(score);\n\n    }\n\n    return score;\n\n}\n\n\n\nvoid input()\n\n{\n\n#ifdef DEBUG_BUILD\n\n    std::ifstream ifs(\"Comp\\\\input.txt\");\n\n    if (!ifs)\n\n    {\n\n        cerr << \"Error: file not opened.\" << endl;\n\n        return;\n\n    }\n\n    //debugn(\"D\");\n\n    ifs >> D;\n\n    C.resize(Type);\n\n    //debugn(\"C\");\n\n    rep(i, Type) ifs >> C[i];\n\n    //debugn(\"S\");\n\n    S.resize(D, vec<ll>(Type));\n\n    rep(i, D) rep(j, Type) ifs >> S[i][j];\n\n#else\n\n    cin >> D;\n\n    C.resize(Type);\n\n    rep(i, Type) cin >> C[i];\n\n    S.resize(D, vec<ll>(Type));\n\n    rep(i, D) rep(j, Type) cin >> S[i][j];\n\n#endif\n\n\n\n    T.resize(D, 0);\n\n}\n\n\n\nvoid Main()\n\n{\n\n    input();\n\n\n\n    //cout << set_greedy() << endl;\n\n\n\n    /*****/\n\n\n\n    /*****/\n\n\n\n    rep(i, D)\n\n    {\n\n        cout << T[i] + 1 << '\\n';\n\n    }\n\n    //cout << solve_score() << endl;\n\n}\n\n\n\n/*****/\n\n\n\nint main()\n\n{\n\n    std::ios::sync_with_stdio(false);\n\n    std::cin.tie(0);\n\n\n\n    std::cout << std::fixed << std::setprecision(10);\n\n\n\n    Main();\n\n    std::cerr << flush;\n\n    std::cout << flush;\n\n\n\n    return 0;\n\n}\n"
    },
    {
        "id": "671",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint maxtype(vector<int> C, vector<long> S, int day, map<int, int> Last) {\n\n  int T = 26;\n\n  long max = 0;\n\n  long score = 0;\n\n  int type = 1;\n\n  int keep;\n\n  for (int i = 1; i <= T; i++) {\n\n    keep = Last[i];\n\n    Last[i] = day;\n\n    score += S.at(i);\n\n    for (int j = 1; j <= T; j++) {\n\n      if (j != i) {\n\n        score -= C.at(j) * (day - Last[j]);\n\n      }\n\n    }\n\n    if (score > max) {\n\n      type = i;\n\n      max = score;\n\n    }\n\n    score = 0;\n\n    Last[i] = keep;\n\n  }\n\n  return type;\n\n}\n\n\n\nint main() {\n\n  int D;\n\n  cin >> D;\n\n  const int T = 26;\n\n  vector<int> c(T+1);\n\n  vector<vector<long>> s(D+1, vector<long>(T+1));\n\n  map<int, int> last;\n\n  for (int i = 1; i <= D; i++) {\n\n    last[i] = 0;\n\n  }\n\n  int t;\n\n  \n\n  // \u5165\u529b\n\n  for (int i = 1; i <= T; i++) {\n\n    cin >> c.at(i);\n\n  }\n\n  for (int i = 1; i <= D; i++) {\n\n    for (int j = 1; j <= T; j++) {\n\n      cin >> s.at(i).at(j);\n\n    }\n\n  }\n\n  \n\n  // \u51e6\u7406\n\n  for (int i = 1; i <= D; i++) {\n\n    t = maxtype(c, s.at(i), i, last);\n\n    // last\u66f4\u65b0\n\n    last[t] = i;\n\n    cout << t << endl;\n\n  }\n\n  return 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main() {\n\n  int D;\n\n  cin >> D;\n\n  for (int i = 1; i <= D; i++) {\n\n    cout << 1 << endl;\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "672",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint maxtype(vector<int> C, vector<long> S, int day, map<int, int> Last) {\n\n  int T = 26;\n\n  long max = 0;\n\n  long score = 0;\n\n  int type = 1;\n\n  int keep;\n\n  for (int i = 1; i <= T; i++) {\n\n    keep = Last[i];\n\n    Last[i] = day;\n\n    score += S.at(i);\n\n    for (int j = 1; j <= T; j++) {\n\n      if (j != i) {\n\n        score -= C.at(j) * (day - Last[j]);\n\n      }\n\n    }\n\n    if (score > max) {\n\n      type = i;\n\n      max = score;\n\n    }\n\n    score = 0;\n\n    Last[i] = keep;\n\n  }\n\n  return type;\n\n}\n\n\n\nint main() {\n\n  int D;\n\n  cin >> D;\n\n  const int T = 26;\n\n  vector<int> c(T+1);\n\n  vector<vector<long>> s(D+1, vector<long>(T+1));\n\n  map<int, int> last;\n\n  for (int i = 1; i <= D; i++) {\n\n    last[i] = 0;\n\n  }\n\n  int t;\n\n  \n\n  // \u5165\u529b\n\n  for (int i = 1; i <= T; i++) {\n\n    cin >> c.at(i);\n\n  }\n\n  for (int i = 1; i <= D; i++) {\n\n    for (int j = 1; j <= T; j++) {\n\n      cin >> s.at(i).at(j);\n\n    }\n\n  }\n\n  \n\n  // \u51e6\u7406\n\n  for (int i = 1; i <= D; i++) {\n\n    t = maxtype(c, s.at(i), i, last);\n\n    // last\u66f4\u65b0\n\n    last[t] = i;\n\n    cout << t << endl;\n\n  }\n\n  return 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main() {\n\n  int D;\n\n  cin >> D;\n\n  for (int i = 1; i <= D; i++) {\n\n    cout << 1 << endl;\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "673",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint maxtype(vector<int> C, vector<long> S, int day, map<int, int> Last) {\n\n  int T = 26;\n\n  long max = 0;\n\n  long score = 0;\n\n  int type = 1;\n\n  int keep;\n\n  for (int i = 1; i <= T; i++) {\n\n    keep = Last[i];\n\n    Last[i] = day;\n\n    score += S.at(i);\n\n    for (int j = 1; j <= T; j++) {\n\n      if (j != i) {\n\n        score -= C.at(j) * (day - Last[j]);\n\n      }\n\n    }\n\n    if (score > max) {\n\n      type = i;\n\n      max = score;\n\n    }\n\n    score = 0;\n\n    Last[i] = keep;\n\n  }\n\n  return type;\n\n}\n\n\n\nint main() {\n\n  int D;\n\n  cin >> D;\n\n  const int T = 26;\n\n  vector<int> c(T+1);\n\n  vector<vector<long>> s(D+1, vector<long>(T+1));\n\n  map<int, int> last;\n\n  for (int i = 1; i <= D; i++) {\n\n    last[i] = 0;\n\n  }\n\n  int t;\n\n  \n\n  // \u5165\u529b\n\n  for (int i = 1; i <= T; i++) {\n\n    cin >> c.at(i);\n\n  }\n\n  for (int i = 1; i <= D; i++) {\n\n    for (int j = 1; j <= T; j++) {\n\n      cin >> s.at(i).at(j);\n\n    }\n\n  }\n\n  \n\n  // \u51e6\u7406\n\n  for (int i = 1; i <= D; i++) {\n\n    t = maxtype(c, s.at(i), i, last);\n\n    // last\u66f4\u65b0\n\n    last[t] = i;\n\n    cout << t << endl;\n\n  }\n\n  return 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main() {\n\n  int D;\n\n  cin >> D;\n\n  for (int i = 0; i < D; i++) {\n\n    cout << i % 26 + 1 << endl;\n\n  }\n\n  return 0;\n\n}"
    },
    {
        "id": "674",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint maxtype(vector<int> C, vector<long> S, int day, map<int, int> Last) {\n\n  int T = 26;\n\n  long max = 0;\n\n  long score = 0;\n\n  int type = 1;\n\n  int keep;\n\n  for (int i = 1; i <= T; i++) {\n\n    keep = Last[i];\n\n    Last[i] = day;\n\n    score += S.at(i);\n\n    for (int j = 1; j <= T; j++) {\n\n      if (j != i) {\n\n        score -= C.at(j) * (day - Last[j]);\n\n      }\n\n    }\n\n    if (score > max) {\n\n      type = i;\n\n      max = score;\n\n    }\n\n    score = 0;\n\n    Last[i] = keep;\n\n  }\n\n  return type;\n\n}\n\n\n\nint main() {\n\n  int D;\n\n  cin >> D;\n\n  const int T = 26;\n\n  vector<int> c(T+1);\n\n  vector<vector<long>> s(D+1, vector<long>(T+1));\n\n  map<int, int> last;\n\n  for (int i = 1; i <= D; i++) {\n\n    last[i] = 0;\n\n  }\n\n  int t;\n\n  \n\n  // \u5165\u529b\n\n  for (int i = 1; i <= T; i++) {\n\n    cin >> c.at(i);\n\n  }\n\n  for (int i = 1; i <= D; i++) {\n\n    for (int j = 1; j <= T; j++) {\n\n      cin >> s.at(i).at(j);\n\n    }\n\n  }\n\n  \n\n  // \u51e6\u7406\n\n  for (int i = 1; i <= D; i++) {\n\n    t = maxtype(c, s.at(i), i, last);\n\n    // last\u66f4\u65b0\n\n    last[t] = i;\n\n    cout << t << endl;\n\n  }\n\n  return 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main() {\n\n  int D;\n\n  cin >> D;\n\n  for (int i = 10; i < D+10; i++) {\n\n    cout << i % 26 + 1 << endl;\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "675",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define rep(i, n) for (int i = 0; i < (int)(n); i++)\n\n#define rep2(i, n) for (int i = 1; i <= (int)(n); i++)\n\n#define ll long long\n\n#define umap unordered_map\n\nusing graph = vector<vector<int>>;\n\nusing graph2 = vector<vector<pair<int, int>>>;\n\n#define oorret true //std::out_of_range\u304c\u8fd4\u3055\u308c\u305f\u6642\n\n#define oor(x) [&](){try{x;} catch(const std::out_of_range& oor){return oorret;} return x;}()\n\ndouble pi = 3.141592653589793238;\n\nll mod(ll x, ll y){if(x>=0||x%y==0) return x%y;return y+x%y;} //mod including minus\n\nll dv0(ll x, ll y){if(x>=0||x%y==0)return x/y;return x/y-1;} //rnd down\n\nll dv1(ll x, ll y){if(x%y==0) return dv0(x,y);return dv0(x,y)+1;} //rnd up\n\nint D;\n\nvoid calculate(vector<int> c, vector<vector<int>> s, int contest,int day, vector<int> &t, ll &score){\n\n    ll p=0;\n\n    int a[26];\n\n    rep(i, 26){\n\n        a[i]=0;\n\n    }\n\n    rep(i, D){\n\n        rep(j, 26){\n\n            p-=c[j]*(i+1-a[j]);\n\n        }\n\n        if(i!=day){\n\n            p+=s[i].at(t[i])+c[t[i]]*(i+1-a[t[i]]);\n\n            a[t[i]]=i+1;\n\n        }else{\n\n            p+=s[day].at(contest)+c[contest]*(day+1-a[contest]);\n\n            a[contest]=i+1;\n\n        }\n\n        \n\n    }\n\n    if(score<p){\n\n        score=p;\n\n        t[day]=contest;\n\n    }\n\n}\n\n\n\nint main(){\n\ncin>>D;\n\nvector<int> c(26);\n\nrep(i, 26){\n\n    cin>>c[i];\n\n}\n\nvector<vector<int>> s(D);\n\nint r;\n\nrep(i, D){\n\n    rep(j, 26){\n\n        cin>>r;\n\n        s[i].push_back(r);\n\n    }\n\n}\n\nint M2=0,M3=0,M4=0,M5=0,M6=0,M7=0,M8=0;\n\nvector<int> m2(D);\n\nvector<int> m3(D);\n\nvector<int> m4(D);\n\nvector<int> m5(D);\n\nvector<int> m6(D);\n\nvector<int> m7(D);\n\nvector<int> m8(D);\n\nvector<int> a(26);\n\nvector<int> m(D);\n\n\n\nrep(i, 26){\n\n    a[i]=0;\n\n}\n\nint M=0;\n\nrep(i, D){\n\n}\n\nvector<int> t(D);\n\n\n\nll score=0;\n\nrep(i, D){\n\n    M=0;\n\n    rep(j, 26){\n\n        score-=c[j]*(i+1-a[j]);\n\n        if(s[i].at(j)+c[j]*(i+1-a[j])>M){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=M3;\n\n            M3=M2;\n\n            M2=M;\n\n            M=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=m3[i];\n\n            m3[i]=m2[i];\n\n            m2[i]=m[i];\n\n            m[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M2){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=M3;\n\n            M3=M2;\n\n            M2=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=m3[i];\n\n            m3[i]=m2[i];\n\n            m2[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M3){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=M3;\n\n            M3=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=m3[i];\n\n            m3[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M4){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M5){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M6){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=j;\n\n        }\n\n        else if(s[i].at(j)+c[j]*(i+1-a[j])>M7){\n\n            M8=M7;\n\n            M7=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M8){\n\n            M8=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=j;\n\n        }\n\n    }\n\n    score+=M;\n\n    a[m[i]]=i+1;\n\n    t[i]=m[i];\n\n}\n\nrep(j, 30){\n\nrep(i, D){\n\n    calculate(c, s, m2[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m3[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m4[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m5[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m6[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m7[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m8[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m[i], i, t, score);\n\n}\n\n}\n\nrep(i, D){\n\n    cout<<t[i]+1<<endl;\n\n}\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define rep(i, n) for (int i = 0; i < (int)(n); i++)\n\n#define rep2(i, n) for (int i = 1; i <= (int)(n); i++)\n\n#define ll long long\n\n#define umap unordered_map\n\nusing graph = vector<vector<int>>;\n\nusing graph2 = vector<vector<pair<int, int>>>;\n\n#define oorret true //std::out_of_range\u304c\u8fd4\u3055\u308c\u305f\u6642\n\n#define oor(x) [&](){try{x;} catch(const std::out_of_range& oor){return oorret;} return x;}()\n\ndouble pi = 3.141592653589793238;\n\nll mod(ll x, ll y){if(x>=0||x%y==0) return x%y;return y+x%y;} //mod including minus\n\nll dv0(ll x, ll y){if(x>=0||x%y==0)return x/y;return x/y-1;} //rnd down\n\nll dv1(ll x, ll y){if(x%y==0) return dv0(x,y);return dv0(x,y)+1;} //rnd up\n\nint D;\n\nvoid calculate(vector<int> c, vector<vector<int>> s, int contest,int day, vector<int> &t, ll &score){\n\n    ll p=0;\n\n    int a[26];\n\n    rep(i, 26){\n\n        a[i]=0;\n\n    }\n\n    rep(i, D){\n\n        rep(j, 26){\n\n            p-=c[j]*(i+1-a[j]);\n\n        }\n\n        if(i!=day){\n\n            p+=s[i].at(t[i])+c[t[i]]*(i+1-a[t[i]]);\n\n            a[t[i]]=i+1;\n\n        }else{\n\n            p+=s[day].at(contest)+c[contest]*(day+1-a[contest]);\n\n            a[contest]=i+1;\n\n        }\n\n        \n\n    }\n\n    if(score<p){\n\n        score=p;\n\n        t[day]=contest;\n\n    }\n\n}\n\n\n\nint main(){\n\ncin>>D;\n\nvector<int> c(26);\n\nrep(i, 26){\n\n    cin>>c[i];\n\n}\n\nvector<vector<int>> s(D);\n\nint r;\n\nrep(i, D){\n\n    rep(j, 26){\n\n        cin>>r;\n\n        s[i].push_back(r);\n\n    }\n\n}\n\nint M2=0,M3=0,M4=0,M5=0,M6=0,M7=0,M8=0;\n\nvector<int> m2(D);\n\nvector<int> m3(D);\n\nvector<int> m4(D);\n\nvector<int> m5(D);\n\nvector<int> m6(D);\n\nvector<int> m7(D);\n\nvector<int> m8(D);\n\nvector<int> a(26);\n\nvector<int> m(D);\n\n\n\nrep(i, 26){\n\n    a[i]=0;\n\n}\n\nint M=0;\n\nrep(i, D){\n\n}\n\nvector<int> t(D);\n\n\n\nll score=0;\n\nrep(i, D){\n\n    M=0;\n\n    rep(j, 26){\n\n        score-=c[j]*(i+1-a[j]);\n\n        if(s[i].at(j)+c[j]*(i+1-a[j])>M){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=M3;\n\n            M3=M2;\n\n            M2=M;\n\n            M=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=m3[i];\n\n            m3[i]=m2[i];\n\n            m2[i]=m[i];\n\n            m[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M2){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=M3;\n\n            M3=M2;\n\n            M2=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=m3[i];\n\n            m3[i]=m2[i];\n\n            m2[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M3){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=M3;\n\n            M3=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=m3[i];\n\n            m3[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M4){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M5){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M6){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=j;\n\n        }\n\n        else if(s[i].at(j)+c[j]*(i+1-a[j])>M7){\n\n            M8=M7;\n\n            M7=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M8){\n\n            M8=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=j;\n\n        }\n\n    }\n\n    score+=M;\n\n    a[m[i]]=i+1;\n\n    t[i]=m[i];\n\n}\n\nrep(j, 20){\n\nrep(i, D){\n\n    calculate(c, s, m2[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m3[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m4[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m5[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m6[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m7[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m8[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m[i], i, t, score);\n\n}\n\n}\n\nrep(i, D){\n\n    cout<<t[i]+1<<endl;\n\n}\n\n}\n"
    },
    {
        "id": "676",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define rep(i, n) for (int i = 0; i < (int)(n); i++)\n\n#define rep2(i, n) for (int i = 1; i <= (int)(n); i++)\n\n#define ll long long\n\n#define umap unordered_map\n\nusing graph = vector<vector<int>>;\n\nusing graph2 = vector<vector<pair<int, int>>>;\n\n#define oorret true //std::out_of_range\u304c\u8fd4\u3055\u308c\u305f\u6642\n\n#define oor(x) [&](){try{x;} catch(const std::out_of_range& oor){return oorret;} return x;}()\n\ndouble pi = 3.141592653589793238;\n\nll mod(ll x, ll y){if(x>=0||x%y==0) return x%y;return y+x%y;} //mod including minus\n\nll dv0(ll x, ll y){if(x>=0||x%y==0)return x/y;return x/y-1;} //rnd down\n\nll dv1(ll x, ll y){if(x%y==0) return dv0(x,y);return dv0(x,y)+1;} //rnd up\n\nint D;\n\nvoid calculate(vector<int> c, vector<vector<int>> s, int contest,int day, vector<int> &t, ll &score){\n\n    ll p=0;\n\n    int a[26];\n\n    rep(i, 26){\n\n        a[i]=0;\n\n    }\n\n    rep(i, D){\n\n        rep(j, 26){\n\n            p-=c[j]*(i+1-a[j]);\n\n        }\n\n        if(i!=day){\n\n            p+=s[i].at(t[i])+c[t[i]]*(i+1-a[t[i]]);\n\n            a[t[i]]=i+1;\n\n        }else{\n\n            p+=s[day].at(contest)+c[contest]*(day+1-a[contest]);\n\n            a[contest]=i+1;\n\n        }\n\n        \n\n    }\n\n    if(score<p){\n\n        score=p;\n\n        t[day]=contest;\n\n    }\n\n}\n\n\n\nint main(){\n\ncin>>D;\n\nvector<int> c(26);\n\nrep(i, 26){\n\n    cin>>c[i];\n\n}\n\nvector<vector<int>> s(D);\n\nint r;\n\nrep(i, D){\n\n    rep(j, 26){\n\n        cin>>r;\n\n        s[i].push_back(r);\n\n    }\n\n}\n\nint M2=0,M3=0,M4=0,M5=0,M6=0,M7=0,M8=0;\n\nvector<int> m2(D);\n\nvector<int> m3(D);\n\nvector<int> m4(D);\n\nvector<int> m5(D);\n\nvector<int> m6(D);\n\nvector<int> m7(D);\n\nvector<int> m8(D);\n\nvector<int> a(26);\n\nvector<int> m(D);\n\n\n\nrep(i, 26){\n\n    a[i]=0;\n\n}\n\nint M=0;\n\nrep(i, D){\n\n}\n\nvector<int> t(D);\n\n\n\nll score=0;\n\nrep(i, D){\n\n    M=0;\n\n    rep(j, 26){\n\n        score-=c[j]*(i+1-a[j]);\n\n        if(s[i].at(j)+c[j]*(i+1-a[j])>M){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=M3;\n\n            M3=M2;\n\n            M2=M;\n\n            M=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=m3[i];\n\n            m3[i]=m2[i];\n\n            m2[i]=m[i];\n\n            m[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M2){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=M3;\n\n            M3=M2;\n\n            M2=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=m3[i];\n\n            m3[i]=m2[i];\n\n            m2[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M3){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=M3;\n\n            M3=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=m3[i];\n\n            m3[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M4){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M5){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M6){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=j;\n\n        }\n\n        else if(s[i].at(j)+c[j]*(i+1-a[j])>M7){\n\n            M8=M7;\n\n            M7=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M8){\n\n            M8=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=j;\n\n        }\n\n    }\n\n    score+=M;\n\n    a[m[i]]=i+1;\n\n    t[i]=m[i];\n\n}\n\nrep(j, 30){\n\nrep(i, D){\n\n    calculate(c, s, m2[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m3[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m4[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m5[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m6[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m7[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m8[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m[i], i, t, score);\n\n}\n\n}\n\nrep(i, D){\n\n    cout<<t[i]+1<<endl;\n\n}\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define rep(i, n) for (int i = 0; i < (int)(n); i++)\n\n#define rep2(i, n) for (int i = 1; i <= (int)(n); i++)\n\n#define ll long long\n\n#define umap unordered_map\n\nusing graph = vector<vector<int>>;\n\nusing graph2 = vector<vector<pair<int, int>>>;\n\n#define oorret true //std::out_of_range\u304c\u8fd4\u3055\u308c\u305f\u6642\n\n#define oor(x) [&](){try{x;} catch(const std::out_of_range& oor){return oorret;} return x;}()\n\ndouble pi = 3.141592653589793238;\n\nll mod(ll x, ll y){if(x>=0||x%y==0) return x%y;return y+x%y;} //mod including minus\n\nll dv0(ll x, ll y){if(x>=0||x%y==0)return x/y;return x/y-1;} //rnd down\n\nll dv1(ll x, ll y){if(x%y==0) return dv0(x,y);return dv0(x,y)+1;} //rnd up\n\nint D;\n\nvoid calculate(vector<int> c, vector<vector<int>> s, int contest,int day, vector<int> &t, ll &score){\n\n    ll p=0;\n\n    int a[26];\n\n    rep(i, 26){\n\n        a[i]=0;\n\n    }\n\n    rep(i, D){\n\n        rep(j, 26){\n\n            p-=c[j]*(i+1-a[j]);\n\n        }\n\n        if(i!=day){\n\n            p+=s[i].at(t[i])+c[t[i]]*(i+1-a[t[i]]);\n\n            a[t[i]]=i+1;\n\n        }else{\n\n            p+=s[day].at(contest)+c[contest]*(day+1-a[contest]);\n\n            a[contest]=i+1;\n\n        }\n\n        \n\n    }\n\n    if(score<p){\n\n        score=p;\n\n        t[day]=contest;\n\n    }\n\n}\n\n\n\nint main(){\n\ncin>>D;\n\nvector<int> c(26);\n\nrep(i, 26){\n\n    cin>>c[i];\n\n}\n\nvector<vector<int>> s(D);\n\nint r;\n\nrep(i, D){\n\n    rep(j, 26){\n\n        cin>>r;\n\n        s[i].push_back(r);\n\n    }\n\n}\n\nint M2=0,M3=0,M4=0,M5=0,M6=0,M7=0,M8=0;\n\nvector<int> m2(D);\n\nvector<int> m3(D);\n\nvector<int> m4(D);\n\nvector<int> m5(D);\n\nvector<int> m6(D);\n\nvector<int> m7(D);\n\nvector<int> m8(D);\n\nvector<int> a(26);\n\nvector<int> m(D);\n\n\n\nrep(i, 26){\n\n    a[i]=0;\n\n}\n\nint M=0;\n\nrep(i, D){\n\n}\n\nvector<int> t(D);\n\n\n\nll score=0;\n\nrep(i, D){\n\n    M=0;\n\n    M2=0;\n\n    M3=0;\n\n    M4=0;\n\n    M5=0;\n\n    M6=0;\n\n    M7=0;\n\n    M8=0;\n\n    rep(j, 26){\n\n        score-=c[j]*(i+1-a[j]);\n\n        if(s[i].at(j)+c[j]*(i+1-a[j])>M){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=M3;\n\n            M3=M2;\n\n            M2=M;\n\n            M=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=m3[i];\n\n            m3[i]=m2[i];\n\n            m2[i]=m[i];\n\n            m[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M2){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=M3;\n\n            M3=M2;\n\n            M2=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=m3[i];\n\n            m3[i]=m2[i];\n\n            m2[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M3){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=M3;\n\n            M3=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=m3[i];\n\n            m3[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M4){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=M4;\n\n            M4=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=m4[i];\n\n            m4[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M5){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=M5;\n\n            M5=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=m5[i];\n\n            m5[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M6){\n\n            M8=M7;\n\n            M7=M6;\n\n            M6=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=m6[i];\n\n            m6[i]=j;\n\n        }\n\n        else if(s[i].at(j)+c[j]*(i+1-a[j])>M7){\n\n            M8=M7;\n\n            M7=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=m7[i];\n\n            m7[i]=j;\n\n        }else if(s[i].at(j)+c[j]*(i+1-a[j])>M8){\n\n            M8=s[i].at(j)+c[j]*(i+1-a[j]);\n\n            m8[i]=j;\n\n        }\n\n    }\n\n    score+=M;\n\n    a[m[i]]=i+1;\n\n    t[i]=m[i];\n\n}\n\nrep(j, 20){\n\nrep(i, D){\n\n    calculate(c, s, m2[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m3[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m4[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m5[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m6[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m7[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m8[i], i, t, score);\n\n}\n\nrep(i, D){\n\n    calculate(c, s, m[i], i, t, score);\n\n}\n\n}\n\nrep(i, D){\n\n    cout<<t[i]+1<<endl;\n\n}\n\n}\n"
    },
    {
        "id": "677",
        "source_code": "#include <climits>\n\n#include <iostream>\n\n#include <vector>\n\n\n\nconst int N = 26, D = 365;\n\n\n\nusing namespace std;\n\nint main() {\n\n    int d;\n\n    cin >> d;\n\n    vector<int> c(N);\n\n    vector<vector<int>> s(D, vector<int>(N));\n\n    for (int i = 0; i < N; ++i)\n\n        cin >> c[i];\n\n    for (int i = 0; i < d; ++i)\n\n        for (int j = 0; j < N; ++j)\n\n            cin >> s[i][j];\n\n    vector<int> ans;\n\n    vector<int> last(N, 0);\n\n    for (int i = 1; i <= d; ++i) {\n\n        int maxt = 0, maxg = INT_MIN;\n\n        for (int j = 0; j < N; ++j) {\n\n            int gain = s[i - 1][j];\n\n            for (int k = 0; k < N; ++k)\n\n                if (k != j)\n\n                    gain -= c[k] * (i - last[k]);\n\n            if (i < d) {\n\n                int tmp = last[j];\n\n                last[j] = i;\n\n                int maxt2 = 0, maxg2 = INT_MIN;\n\n                for (int k = 0; k < N; ++k) {\n\n                    int gain2 = s[i][k];\n\n                    for (int k2 = 0; k2 < N; ++k2)\n\n                        if (k2 != k)\n\n                            gain2 -= c[k2] * (i + 1 - last[k]);\n\n                    if (gain2 > maxg2) {\n\n                        maxg2 = gain2;\n\n                        maxt2 = k;\n\n                    }\n\n                }\n\n                last[j] = tmp;\n\n                gain += maxg2;\n\n            }\n\n            if (gain > maxg) {\n\n                maxg = gain;\n\n                maxt = j;\n\n            }\n\n        }\n\n        last[maxt] = i;\n\n        ans.emplace_back(maxt + 1);\n\n    }\n\n    for (int i : ans)\n\n        cout << i << endl;\n\n}",
        "optimized_code": "#include <algorithm>\n\n#include <climits>\n\n#include <iostream>\n\n#include <vector>\n\n\n\nconst int N = 26, D = 365;\n\n\n\nusing namespace std;\n\nint main() {\n\n    int d;\n\n    cin >> d;\n\n    vector<int> c(N);\n\n    vector<vector<int>> s(D, vector<int>(N));\n\n    for (int i = 0; i < N; ++i)\n\n        cin >> c[i];\n\n    for (int i = 0; i < d; ++i)\n\n        for (int j = 0; j < N; ++j)\n\n            cin >> s[i][j];\n\n    vector<int> ans;\n\n    vector<int> last(N, 0);\n\n    for (int i = 1; i <= d; ++i) {\n\n        int maxt = 0, maxg = INT_MIN;\n\n        int hi = *max_element(s[i - 1].begin(), s[i - 1].end());\n\n        int maxloss = 0, maxlosst = 0;\n\n        for (int j = 0; j < N; ++j) {\n\n            int loss = (i - last[j]) * c[j];\n\n            if (loss > maxloss) {\n\n                maxloss = loss;\n\n                maxlosst = j;\n\n            }\n\n        }\n\n        if (hi < maxloss) {\n\n            last[maxlosst] = i;\n\n            ans.emplace_back(maxlosst + 1);\n\n            continue;\n\n        }\n\n        for (int j = 0; j < N; ++j) {\n\n            int gain = s[i - 1][j];\n\n            for (int k = 0; k < N; ++k)\n\n                if (k != j)\n\n                    gain -= c[k] * (i - last[k]);\n\n            if (gain > maxg) {\n\n                maxg = gain;\n\n                maxt = j;\n\n            }\n\n        }\n\n        last[maxt] = i;\n\n        ans.emplace_back(maxt + 1);\n\n    }\n\n    for (int i : ans)\n\n        cout << i << endl;\n\n}\n"
    },
    {
        "id": "678",
        "source_code": "#include <climits>\n\n#include <iostream>\n\n#include <vector>\n\n\n\nconst int N = 26, D = 365;\n\n\n\nusing namespace std;\n\nint main() {\n\n    int d;\n\n    cin >> d;\n\n    vector<int> c(N);\n\n    vector<vector<int>> s(D, vector<int>(N));\n\n    for (int i = 0; i < N; ++i)\n\n        cin >> c[i];\n\n    for (int i = 0; i < d; ++i)\n\n        for (int j = 0; j < N; ++j)\n\n            cin >> s[i][j];\n\n    vector<int> ans;\n\n    vector<int> last(N, 0);\n\n    for (int i = 1; i <= d; ++i) {\n\n        int maxt = 0, maxg = INT_MIN;\n\n        for (int j = 0; j < N; ++j) {\n\n            int gain = s[i - 1][j];\n\n            for (int k = 0; k < N; ++k)\n\n                if (k != j)\n\n                    gain -= c[k] * (i - last[k]);\n\n            if (i < d) {\n\n                int tmp = last[j];\n\n                last[j] = i;\n\n                int maxt2 = 0, maxg2 = INT_MIN;\n\n                for (int k = 0; k < N; ++k) {\n\n                    int gain2 = s[i][k];\n\n                    for (int k2 = 0; k2 < N; ++k2)\n\n                        if (k2 != k)\n\n                            gain2 -= c[k2] * (i + 1 - last[k]);\n\n                    if (gain2 > maxg2) {\n\n                        maxg2 = gain2;\n\n                        maxt2 = k;\n\n                    }\n\n                }\n\n                last[j] = tmp;\n\n                gain += maxg2;\n\n            }\n\n            if (gain > maxg) {\n\n                maxg = gain;\n\n                maxt = j;\n\n            }\n\n        }\n\n        last[maxt] = i;\n\n        ans.emplace_back(maxt + 1);\n\n    }\n\n    for (int i : ans)\n\n        cout << i << endl;\n\n}",
        "optimized_code": "#include <algorithm>\n\n#include <climits>\n\n#include <iostream>\n\n#include <vector>\n\n\n\nconst int N = 26, D = 365;\n\n\n\nusing namespace std;\n\nint main() {\n\n    int d;\n\n    cin >> d;\n\n    vector<int> c(N);\n\n    vector<vector<int>> s(D, vector<int>(N));\n\n    for (int i = 0; i < N; ++i)\n\n        cin >> c[i];\n\n    for (int i = 0; i < d; ++i)\n\n        for (int j = 0; j < N; ++j)\n\n            cin >> s[i][j];\n\n    vector<int> ans;\n\n    vector<int> last(N, 0);\n\n    for (int i = 1; i <= d; ++i) {\n\n        int maxt = 0;\n\n        double maxg = INT_MIN;\n\n        for (int j = 0; j < N; ++j) {\n\n            double gain = s[i - 1][j];\n\n            for (int k = 0; k < N; ++k)\n\n                if (k != j)\n\n                    gain -= 1.2 * c[k] * (i - last[k]);\n\n            if (gain > maxg) {\n\n                maxg = gain;\n\n                maxt = j;\n\n            }\n\n        }\n\n        last[maxt] = i;\n\n        ans.emplace_back(maxt + 1);\n\n    }\n\n    for (int i : ans)\n\n        cout << i << endl;\n\n}\n"
    },
    {
        "id": "679",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#pragma GCC optimize(\"Ofast\")\n\n#pragma GCC target(\"avx\")\n\n#define all(x) (x).begin(),(x).end()\n\n#define rep(i,n) for(int (i)=0;i<(n);i++)\n\n#define rrep(i,n) for(int (i)=1;i<=(n);i++)\n\n#define REP(i,m,n) for(int (i)=(m);(i)<(n);(i)++)\n\n#define MOD 1000000007\n\n#define INF 1e18\n\n#define int long long\n\n#define endl \"\\n\"\n\n#define yorn(f) puts((f)?\"Yes\":\"No\")\n\n#define YORN(f) puts((f)?\"YES\":\"NO\")\n\ntypedef long long ll;\n\ntypedef pair<int, int> P;\n\nint gcd(int a,int b){return b?gcd(b,a%b):a;};\n\nint lcm(int a,int b){return a/gcd(a,b)*b;};\n\nint mod(int a,int b){return (a+b-1)/b;};\n\ntemplate<typename A, size_t N, typename T>\n\nvoid Fill(A(&array)[N],const T &val){std::fill((T*)array,(T*)(array+N),val);}\n\ntemplate<class T>inline bool chmax(T& a,T b){if(a<b){a=b;return true;}return false;};\n\ntemplate<class T>inline bool chmin(T& a,T b){if(a>b){a=b;return true;}return false;};\n\n\n\nint D;\n\nvector<int> c(26);\n\nvector<vector<int>> s(365, vector<int>(26));\n\n\n\nint get_score(vector<int> &t) {\n\n\tint score = 0;\n\n\tvector<int> last(26, -1);\n\n\trep(i, t.size()) {\n\n\t\tscore += s[i][t[i]];\n\n\t\tlast[t[i]] = i;\n\n\t\trep(j, 26) score -= c[j] * (i - last[j]);\n\n\t}\n\n\treturn score;\n\n}\n\n\n\nint evaluate(vector<int> &t, int k) {\n\n\tint score = 0;\n\n\tvector<int> last(26, -1);\n\n\trep(i, t.size()) {\n\n\t\tscore += s[i][t[i]];\n\n\t\tlast[t[i]] = i;\n\n\t\trep(j, 26) score -= c[j] * (i - last[j]);\n\n\t}\n\n\n\n\tfor(int d = t.size(); d < min<int>(D, t.size() + k); d++) {\n\n\t\trep(j, 26) {\n\n\t\t\tscore -= (d - last[j]) * c[j];\n\n\t\t}\n\n\t}\n\n\treturn score;\n\n}\n\n\n\nvector<int> solve(int k) {\n\n\tvector<int> res;\n\n\trep(i, D) {\n\n\t\tint max_score = LLONG_MIN;\n\n\t\tint type = -1;\n\n\t\trep(j, 26) {\n\n\t\t\tres.push_back(j);\n\n\t\t\tint score = evaluate(res, k);\n\n\t\t\tif(max_score < score) {\n\n\t\t\t\tmax_score = score;\n\n\t\t\t\ttype = j;\n\n\t\t\t}\n\n\t\t\tres.pop_back();\n\n\t\t}\n\n\t\tres.push_back(type);\n\n\t}\n\n\treturn res;\n\n}\n\n\n\nsigned main() {\n\n\tcin.tie(0);\n\n\tcout.tie(0);\n\n\tios::sync_with_stdio(false);\n\n\t//cout << fixed << setprecision(15);\n\n\t\n\n\tcin >> D;\n\n\trep(i, 26) {\n\n\t\tcin >> c[i];\n\n\t\tc[i]--;\n\n\t}\n\n\trep(i, D) {\n\n\t\trep(j, 26) cin >> s[i][j];\n\n\t}\n\n\n\n\tvector<int> ans;\n\n\tint ans_score = LLONG_MIN;\n\n\trep(k, 26) {\n\n\t\tvector<int> out = solve(k);\n\n\t\tint score = get_score(out);\n\n\t\tif(ans_score < score) {\n\n\t\t\tans_score = score;\n\n\t\t\tans = out;\n\n\t\t}\n\n\t}\n\n\trep(i, ans.size()) cout << ans[i] + 1 << endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#pragma GCC optimize(\"Ofast\")\n\n#pragma GCC target(\"avx\")\n\n#define all(x) (x).begin(),(x).end()\n\n#define rep(i,n) for(int (i)=0;i<(n);i++)\n\n#define rrep(i,n) for(int (i)=1;i<=(n);i++)\n\n#define REP(i,m,n) for(int (i)=(m);(i)<(n);(i)++)\n\n#define MOD 1000000007\n\n#define INF 1e18\n\n#define int long long\n\n#define endl \"\\n\"\n\n#define yorn(f) puts((f)?\"Yes\":\"No\")\n\n#define YORN(f) puts((f)?\"YES\":\"NO\")\n\ntypedef long long ll;\n\ntypedef pair<int, int> P;\n\nint gcd(int a,int b){return b?gcd(b,a%b):a;};\n\nint lcm(int a,int b){return a/gcd(a,b)*b;};\n\nint mod(int a,int b){return (a+b-1)/b;};\n\ntemplate<typename A, size_t N, typename T>\n\nvoid Fill(A(&array)[N],const T &val){std::fill((T*)array,(T*)(array+N),val);}\n\ntemplate<class T>inline bool chmax(T& a,T b){if(a<b){a=b;return true;}return false;};\n\ntemplate<class T>inline bool chmin(T& a,T b){if(a>b){a=b;return true;}return false;};\n\n\n\n\n\n\n\nsigned main() {\n\n\tcin.tie(0);\n\n\tcout.tie(0);\n\n\tios::sync_with_stdio(false);\n\n\t//cout << fixed << setprecision(15);\n\n\t\n\n\tint D;\n\n\tcin >> D;\n\n\tint c[26];\n\n\trep(i, 26) cin >> c[i];\n\n\tint s[D][26];\n\n\trep(i, D) rep(j, 26) cin >> s[i][j];\n\n\trep(i, D) {\n\n\t\tint sc = 0, id;\n\n\t\trep(j, 26) {\n\n\t\t\tif(sc < s[i][j]) {\n\n\t\t\t\tsc = s[i][j];\n\n\t\t\t\tid = j;\n\n\t\t\t}\n\n\t\t}\n\n\t\tcout << id + 1 << endl;\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "680",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(int i=0; i<(n); i++)\n\nusing namespace std;\n\nusing P = pair<int,int>;\n\nusing ll = long long; \n\n\n\nint MAX = 0;\n\n\n\nint main(){\n\n    //\u5165\u529b\n\n    int d=365;\n\n    vector<int> c;\n\n    int all_c=0;\n\n    int tmp;\n\n    rep(i,26){\n\n        cin>>tmp;\n\n        c.push_back(tmp);\n\n        all_c+=tmp;\n\n    }\n\n    int max_s;\n\n    int ans = 1;\n\n    rep(i,d){\n\n        max_s = MAX;\n\n        rep(j,26){\n\n            cin>>tmp;\n\n            if(tmp>max_s){\n\n                max_s=tmp;\n\n                ans = j+1;\n\n            }\n\n        }\n\n        cout<<ans<<endl;\n\n    }\n\n\n\n   return 0;\n\n\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(int i=0; i<(n); i++)\n\nusing namespace std;\n\nusing P = pair<int,int>;\n\nusing ll = long long; \n\n\n\nint main(){\n\n    //\u5165\u529b\n\n    int d;\n\n    cin>>d;\n\n    vector<int> c;\n\n    int all_c=0;\n\n    int tmp;\n\n    rep(i,26){\n\n        cin>>tmp;\n\n        c.push_back(tmp);\n\n        all_c+=tmp;\n\n    }\n\n    vector<vector<int>> s(d, vector<int>(26));\n\n    rep(i,d){\n\n        rep(j,26){\n\n            cin>>s.at(i).at(j);\n\n        }\n\n    }\n\n\n\n    //\u521d\u671f\u5316\n\n    vector<int> last;\n\n    rep(i,26){\n\n        last.push_back(0);\n\n    }\n\n\n\n    //\u30b3\u30f3\u30c6\u30b9\u30c8\u5165\u529b\n\n    int score=0;\n\n    int complain;\n\n    rep(i,d){\n\n        //MAX\u306escore\u3092\u7b97\u51fa\u3059\u308b\n\n        int ans=0;\n\n\n\n        //1-26\u306e\u30b3\u30f3\u30c6\u30b9\u30c8\u3092\u958b\u3044\u305f\u3068\u304d\u306escore\u304b\u3089\u3001\u6700\u5927\u306e\u3082\u306e\u3092\u9078\u629e\u3059\u308b\n\n        int max_score=0;\n\n        rep(n,26){\n\n            score=0;\n\n\n\n            complain=0;\n\n            //\u4e0d\u6e80\u3092\u7b97\u51fa\u3059\u308b\n\n            rep(j,26){\n\n                if(j!=n){\n\n                    complain+=c[j]*(last[j]+1);\n\n                }else{\n\n                    last[j]=0;\n\n                }\n\n            }\n\n            score = score + s[i][n] - complain;\n\n            // cout<<n<<\":\"<<score<<endl;\n\n            if(score>max_score){\n\n                max_score=score;\n\n                ans = n+1;\n\n            }\n\n        }\n\n        cout<<ans<<endl;\n\n        //last\u306e\u8a08\u7b97\u78ba\u5b9a\n\n        rep(j,26){\n\n            if(j!=(ans-1)){\n\n                last[j]+=1;\n\n            }else{\n\n                last[j]=0;\n\n            }\n\n        }\n\n    }\n\n\n\n\n\n   return 0;\n\n\n\n}\n"
    },
    {
        "id": "681",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(int i=0; i<(n); i++)\n\nusing namespace std;\n\nusing P = pair<int,int>;\n\nusing ll = long long; \n\n\n\nint MAX = 0;\n\n\n\nint main(){\n\n    //\u5165\u529b\n\n    int d=365;\n\n    vector<int> c;\n\n    int all_c=0;\n\n    int tmp;\n\n    rep(i,26){\n\n        cin>>tmp;\n\n        c.push_back(tmp);\n\n        all_c+=tmp;\n\n    }\n\n    int max_s;\n\n    int ans = 1;\n\n    rep(i,d){\n\n        max_s = MAX;\n\n        rep(j,26){\n\n            cin>>tmp;\n\n            if(tmp>max_s){\n\n                max_s=tmp;\n\n                ans = j+1;\n\n            }\n\n        }\n\n        cout<<ans<<endl;\n\n    }\n\n\n\n   return 0;\n\n\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(ll i=0; i<(n); i++)\n\nusing namespace std;\n\nusing P = pair<int,int>;\n\nusing ll = long long; \n\n\n\nint main(){\n\n    //\u5165\u529b\n\n    ll d;\n\n    cin>>d;\n\n    vector<ll> c;\n\n    ll all_c=0;\n\n    ll tmp;\n\n    rep(i,26){\n\n        cin>>tmp;\n\n        c.push_back(tmp);\n\n        all_c+=tmp;\n\n    }\n\n    vector<vector<ll>> s(d, vector<ll>(26));\n\n    rep(i,d){\n\n        rep(j,26){\n\n            cin>>s.at(i).at(j);\n\n        }\n\n    }\n\n\n\n    //\u521d\u671f\u5316\n\n    vector<ll> last;\n\n    rep(i,26){\n\n        last.push_back(0);\n\n    }\n\n\n\n    //\u8a08\u7b97\n\n    ll now_score=0;\n\n    ll score=0;\n\n    ll complain;\n\n    rep(i,d){\n\n        //MAX\u306escore\u3092\u7b97\u51fa\u3059\u308b\n\n        ll ans=0;\n\n\n\n        //1-26\u306e\u30b3\u30f3\u30c6\u30b9\u30c8\u3092\u958b\u3044\u305f\u3068\u304d\u306escore\u304b\u3089\u3001\u6700\u5927\u306e\u3082\u306e\u3092\u9078\u629e\u3059\u308b\n\n        ll max_score=0;\n\n        rep(n,26){\n\n            score=now_score;\n\n\n\n            complain=0;\n\n            //\u4e0d\u6e80\u3092\u7b97\u51fa\u3059\u308b\n\n            rep(j,26){\n\n                if(j!=n){\n\n                    complain+=c[j]*(last[j]+1);\n\n                }else{\n\n                    last[j]=0;\n\n                }\n\n            }\n\n            score = score + s[i][n] - complain;\n\n            // cout<<n<<\":\"<<score<<endl;\n\n            if(score>max_score){\n\n                max_score=score;\n\n                ans = n+1;\n\n            }\n\n        }\n\n        cout<<ans<<endl;\n\n        //last\u306e\u8a08\u7b97\u78ba\u5b9a\n\n        rep(j,26){\n\n            if(j!=(ans-1)){\n\n                last[j]+=1;\n\n            }else{\n\n                last[j]=0;\n\n            }\n\n        }\n\n        now_score = score;\n\n    }\n\n\n\n\n\n   return 0;\n\n\n\n}\n"
    },
    {
        "id": "682",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(int i=0; i<(n); i++)\n\nusing namespace std;\n\nusing P = pair<int,int>;\n\nusing ll = long long; \n\n\n\nint MAX = 0;\n\n\n\nint main(){\n\n    //\u5165\u529b\n\n    int d=365;\n\n    vector<int> c;\n\n    int all_c=0;\n\n    int tmp;\n\n    rep(i,26){\n\n        cin>>tmp;\n\n        c.push_back(tmp);\n\n        all_c+=tmp;\n\n    }\n\n    int max_s;\n\n    int ans = 1;\n\n    rep(i,d){\n\n        max_s = MAX;\n\n        rep(j,26){\n\n            cin>>tmp;\n\n            if(tmp>max_s){\n\n                max_s=tmp;\n\n                ans = j+1;\n\n            }\n\n        }\n\n        cout<<ans<<endl;\n\n    }\n\n\n\n   return 0;\n\n\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n#define rep(i,n) for(ll i=0; i<(n); i++)\n\nusing namespace std;\n\nusing P = pair<int,int>;\n\nusing ll = long long; \n\n\n\nint main(){\n\n rep(i,365){\n\n\tcout<<i%26 + 1<<endl;\n\n }\n\n return 0;\n\n}"
    },
    {
        "id": "683",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nstruct dat {\n\n  int d;\n\n  vector<int> c;\n\n  vector<vector<int>> s;\n\n};\n\n\n\nint calc(const dat &a, const vector<int> &last, int day, int t) {\n\n  int v = 0;\n\n  v += a.s.at(day - 1).at(t);\n\n  for (int i = 0; i < 26; i++) {\n\n    if (i == t) continue;\n\n    v -= a.c.at(i) * (day - last.at(i));\n\n  }\n\n  return v;\n\n}\n\n\n\nint main() {\n\n  int d;\n\n  cin >> d;\n\n  vector<int> c(26);\n\n  vector<vector<int>> s(d, vector<int>(26));\n\n  for (int i = 0; i < 26; i++) {\n\n    cin >> c.at(i);\n\n  }\n\n  for (int i = 0; i < d; i++) {\n\n    for (int j = 0; j < 26; j++) {\n\n      cin >> s.at(i).at(j);\n\n    }\n\n  }\n\n  dat a = {d, c, s};\n\n  \n\n  int w = 26;\n\n  vector<vector<int>> last(w, vector<int>(26)), ans(w);\n\n  vector<int> score(w);\n\n  for (int i = 0; i < d; i++) {\n\n    vector<tuple<int, int, int>> idx;\n\n    for (int j = 0; j < w; j++) {\n\n      vector<int> best(w, -1e9), best_t(w);\n\n      for (int t = 0; t < 26; t++) {\n\n        int v = calc(a, last.at(j), i + 1, t);\n\n        if (v > best.at(w - 1)) {\n\n          best.at(w - 1) = v;\n\n          best_t.at(w - 1) = t;\n\n        }\n\n        for (int k = w - 1; k > 0; k--) {\n\n          if (best.at(k - 1) < best.at(k)) {\n\n            swap(best.at(k - 1), best.at(k));\n\n            swap(best_t.at(k - 1), best_t.at(k));\n\n          }\n\n        }\n\n      }\n\n      for (int k = 0; k < w; k++) {\n\n        idx.emplace_back(score.at(j) + best.at(k), j, best_t.at(k));\n\n      }\n\n    }\n\n    sort(idx.rbegin(), idx.rend());\n\n    vector<vector<int>> newlast(w, vector<int>(26)), newans(w);\n\n    for (int j = 0; j < w; j++) {\n\n      int k = get<1>(idx.at(j)), t = get<2>(idx.at(j));\n\n      score.at(j) = get<0>(idx.at(j));\n\n      newans.at(j) = ans.at(k);\n\n      newlast.at(j) = last.at(k);\n\n      newans.at(j).push_back(t);\n\n      newlast.at(j).at(t) = i + 1;\n\n    }\n\n    ans = newans;\n\n    last = newlast;\n\n  }\n\n  for (int i = 0; i < d; i++) {\n\n    cout << ans.at(0).at(i) + 1 << endl;\n\n  }\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nstruct dat {\n\n  int d;\n\n  vector<int> c;\n\n  vector<vector<int>> s;\n\n};\n\n\n\nint calc(const dat &a, const vector<int> &last, int day, int t) {\n\n  int v = 0;\n\n  v += a.s.at(day - 1).at(t);\n\n  for (int i = 0; i < 26; i++) {\n\n    if (i == t) continue;\n\n    v -= a.c.at(i) * (day - last.at(i));\n\n  }\n\n  return v;\n\n}\n\n\n\nint main() {\n\n  int d;\n\n  cin >> d;\n\n  vector<int> c(26);\n\n  vector<vector<int>> s(d, vector<int>(26));\n\n  for (int i = 0; i < 26; i++) {\n\n    cin >> c.at(i);\n\n  }\n\n  for (int i = 0; i < d; i++) {\n\n    for (int j = 0; j < 26; j++) {\n\n      cin >> s.at(i).at(j);\n\n    }\n\n  }\n\n  dat a = {d, c, s};\n\n  \n\n  int w = 10;\n\n  vector<vector<int>> last(w, vector<int>(26)), ans(w);\n\n  vector<int> score(w);\n\n  for (int i = 0; i < d; i++) {\n\n    vector<tuple<int, int, int>> idx;\n\n    for (int j = 0; j < w; j++) {\n\n      vector<int> best(w, -4e4), best_t(w);\n\n      for (int t = 0; t < 26; t++) {\n\n        int v = calc(a, last.at(j), i + 1, t);\n\n        if (v > best.at(w - 1)) {\n\n          best.at(w - 1) = v;\n\n          best_t.at(w - 1) = t;\n\n        }\n\n        for (int k = w - 1; k > 0; k--) {\n\n          if (best.at(k - 1) < best.at(k)) {\n\n            swap(best.at(k - 1), best.at(k));\n\n            swap(best_t.at(k - 1), best_t.at(k));\n\n          }\n\n        }\n\n      }\n\n      for (int k = 0; k < w; k++) {\n\n        if (best.at(k) == -4e4) continue;\n\n        idx.emplace_back(score.at(j) + best.at(k), j, best_t.at(k));\n\n      }\n\n    }\n\n    sort(idx.rbegin(), idx.rend());\n\n    vector<vector<int>> newlast(w, vector<int>(26)), newans(w);\n\n    for (int j = 0; j < w; j++) {\n\n      if (j >= idx.size()) break;\n\n      int k = get<1>(idx.at(j)), t = get<2>(idx.at(j));\n\n      score.at(j) = get<0>(idx.at(j));\n\n      newans.at(j) = ans.at(k);\n\n      newlast.at(j) = last.at(k);\n\n      newans.at(j).push_back(t);\n\n      newlast.at(j).at(t) = i + 1;\n\n    }\n\n    ans = newans;\n\n    last = newlast;\n\n  }\n\n  for (int i = 0; i < d; i++) {\n\n    cout << ans.at(0).at(i) + 1 << endl;\n\n  }\n\n}\n"
    },
    {
        "id": "684",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nlong long calc(int n, const vector<int>& options, const vector<int>& cost,\n\n               const vector<array<int, 26>>& s, int dd, int nt, int ot) {\n\n  //long long x(total);\n\n  int before(dd-1), after(dd+1);\n\n  while (before >= 0 && options[before] != nt) before--;\n\n  while (after < n && options[after] != nt) after++;\n\n  int a(dd - before - 1), b(after - dd - 1), c(after - before - 1);\n\n  int diff = c * (c+1) / 2 - a * (a+1) / 2 - b * (b+1) / 2;\n\n  int before2(dd-1), after2(dd+1);\n\n  while (before2 >= 0 && options[before2] != ot) before2--;\n\n  while (after2 < n && options[after2] != ot) after2++;\n\n  int a2(dd - before2 - 1), b2(after2 - dd - 1), c2(after2 - before2 - 1);\n\n  int diff2 = c2 * (c2+1) / 2 - a2 * (a2+1) / 2 - b2 * (b2+1) / 2;\n\n  return - (long long) diff * cost[nt] + (long long) diff2 * cost[ot] + s[dd][nt] - s[dd][ot];\n\n}\n\nint main() {\n\n  int n;\n\n  cin >> n;\n\n  vector<int> c(26);\n\n  vector<array<int, 26>> s(n);\n\n  \n\n  vector<int> last(26, -1);\n\n  \n\n  for (int i = 0; i < 26; ++i)\n\n    cin >> c[i];\n\n  for (int i = 0; i < n; ++i)\n\n    for (int j = 0; j < 26; ++j)\n\n      cin >> s[i][j];\n\n  \n\n  long long total(0);\n\n  vector<int> options(n);\n\n  \n\n  for (int i = 0; i < n; ++i) {\n\n    int neg(0), test(-1);\n\n    for (int j = 0; j < 26; ++j) {\n\n      neg -= c[j] * (i - last[j]);\n\n    }\n\n    //cout << neg << 'n' << endl;\n\n    int max_score = -1e9;\n\n    for (int j = 0; j < 26; ++j) {\n\n      int ss = s[i][j] + neg + c[j] * (i - last[j]);\n\n      if (ss > max_score) {\n\n        max_score = ss;\n\n        test = j;\n\n      }\n\n    }\n\n    total += max_score;\n\n    //cout << test + 1 << endl;\n\n    options[i] = test;\n\n    //cout << test + 1 << ' ' << max_score << endl;\n\n    last[test] = i;\n\n  }\n\n  //cout << total << endl;\n\n  for (int t = 1; t <= 500; ++t) {\n\n    for (int dd = n - 1; dd >= 0; --dd) {\n\n      for (int tt = 25; tt >= 0; --tt) {\n\n        if (tt == options[dd]) continue;\n\n        int ot = options[dd];\n\n        \n\n        long long ns = calc(n, options, c, s, dd, tt, ot);\n\n        //cout << ns << endl;\n\n        if (ns > 0) {\n\n      \t\ttotal += ns;\n\n          options[dd] = tt;\n\n    \t}\n\n      }\n\n    }\n\n  }\n\n  for (const int& i: options) cout << i + 1 << endl;\n\n  //cout << total << endl;\n\n  return 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n \n\nlong long calc(int n, int c1, int c2, int s1, int s2, const vector<int>& options,\n\n               int d, int nt, int ot) {\n\n  int b1(d-1), a1(d+1), b2(d-1), a2(d+1);\n\n  while (b1 >= 0 && options[b1] != nt) b1--;\n\n  while (b2 >= 0 && options[b2] != ot) b2--;\n\n  while (a1 < n && options[a1] != nt) a1++;\n\n  while (a2 < n && options[a2] != ot) a2++;\n\n  int x1(d-b1-1), y1(a1-d-1), z1(a1-b1-1), x2(d-b2-1), y2(a2-d-1), z2(a2-b2-1);\n\n  int diff1 = z1*(z1+1)/2-x1*(x1+1)/2-y1*(y1+1)/2;\n\n  int diff2 = z2*(z2+1)/2-x2*(x2+1)/2-y2*(y2+1)/2;\n\n  return (long long) diff1 * c1 - (long long) diff2 * c2 + s1 - s2;\n\n}\n\n \n\nint main() {\n\n  int n;\n\n  cin >> n;\n\n  vector<int> c(26);\n\n  vector<array<int, 26>> s(n);\n\n  \n\n  vector<int> last(26, -1);\n\n  \n\n  for (int i = 0; i < 26; ++i)\n\n    cin >> c[i];\n\n  for (int i = 0; i < n; ++i)\n\n    for (int j = 0; j < 26; ++j)\n\n      cin >> s[i][j];\n\n  \n\n  long long total(0);\n\n  vector<int> options(n);\n\n  \n\n  for (int i = 0; i < n; ++i) {\n\n    int neg(0), test(-1);\n\n    for (int j = 0; j < 26; ++j) {\n\n      neg -= c[j] * (i - last[j]);\n\n    }\n\n    \n\n    int max_score = -1e9;\n\n    for (int j = 0; j < 26; ++j) {\n\n      int ss = s[i][j] + neg + c[j] * (i - last[j]);\n\n      if (ss > max_score) {\n\n        max_score = ss;\n\n        test = j;\n\n      }\n\n    }\n\n    total += max_score;\n\n    options[i] = test;\n\n    last[test] = i;\n\n  }\n\n  /* reversed: 109149564 */\n\n  /* sorted: */\n\n  /* stocahstic */\n\n  for (int t = 1; t <= 500; ++t) {\n\n    bool entered = false;\n\n    for (int dd = 0; dd < n; ++dd) {\n\n      for (int tt = 0; tt < 26; ++tt) {\n\n        if (tt == options[dd]) continue;\n\n        int ot = options[dd];\n\n        long long ns = calc(n, c[tt], c[ot], s[dd][tt], s[dd][ot],\n\n                            options, dd, tt, ot);\n\n        //cout << ns << endl;\n\n        if (ns > 0) {\n\n          entered = true;\n\n          total += ns;\n\n          options[dd] = tt;\n\n    \t}\n\n      }\n\n    }\n\n    if (!entered) break;\n\n  }\n\n  for (const int& i: options) cout << i + 1 << endl;\n\n  \n\n  return 0;\n\n}"
    },
    {
        "id": "685",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nlong long calc(int n, const vector<int>& options, const vector<int>& cost,\n\n               const vector<array<int, 26>>& s, int dd, int nt, int ot) {\n\n  //long long x(total);\n\n  int before(dd-1), after(dd+1);\n\n  while (before >= 0 && options[before] != nt) before--;\n\n  while (after < n && options[after] != nt) after++;\n\n  int a(dd - before - 1), b(after - dd - 1), c(after - before - 1);\n\n  int diff = c * (c+1) / 2 - a * (a+1) / 2 - b * (b+1) / 2;\n\n  int before2(dd-1), after2(dd+1);\n\n  while (before2 >= 0 && options[before2] != ot) before2--;\n\n  while (after2 < n && options[after2] != ot) after2++;\n\n  int a2(dd - before2 - 1), b2(after2 - dd - 1), c2(after2 - before2 - 1);\n\n  int diff2 = c2 * (c2+1) / 2 - a2 * (a2+1) / 2 - b2 * (b2+1) / 2;\n\n  return + (long long) diff * cost[nt] - (long long) diff2 * cost[ot] + s[dd][nt] - s[dd][ot];\n\n}\n\nint main() {\n\n  int n;\n\n  cin >> n;\n\n  vector<int> c(26);\n\n  vector<array<int, 26>> s(n);\n\n  \n\n  vector<int> last(26, -1);\n\n  \n\n  for (int i = 0; i < 26; ++i)\n\n    cin >> c[i];\n\n  for (int i = 0; i < n; ++i)\n\n    for (int j = 0; j < 26; ++j)\n\n      cin >> s[i][j];\n\n  \n\n  long long total(0);\n\n  vector<int> options(n);\n\n  \n\n  for (int i = 0; i < n; ++i) {\n\n    int neg(0), test(-1);\n\n    for (int j = 0; j < 26; ++j) {\n\n      neg -= c[j] * (i - last[j]);\n\n    }\n\n    //cout << neg << 'n' << endl;\n\n    int max_score = -1e9;\n\n    for (int j = 0; j < 26; ++j) {\n\n      int ss = s[i][j] + neg + c[j] * (i - last[j]);\n\n      if (ss > max_score) {\n\n        max_score = ss;\n\n        test = j;\n\n      }\n\n    }\n\n    total += max_score;\n\n    //cout << test + 1 << endl;\n\n    options[i] = test;\n\n    //cout << test + 1 << ' ' << max_score << endl;\n\n    last[test] = i;\n\n  }\n\n  //cout << total << endl;\n\n  for (int t = 1; t <= 500; ++t) {\n\n    for (int dd = n - 1; dd >= 0; --dd) {\n\n      for (int tt = 25; tt >= 0; --tt) {\n\n        if (tt == options[dd]) continue;\n\n        int ot = options[dd];\n\n        \n\n        long long ns = calc(n, options, c, s, dd, tt, ot);\n\n        //cout << ns << endl;\n\n        if (ns > 0) {\n\n      \t\ttotal += ns;\n\n          options[dd] = tt;\n\n    \t}\n\n      }\n\n    }\n\n  }\n\n  for (const int& i: options) cout << i + 1 << endl;\n\n  //cout << total << endl;\n\n  return 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n \n\nlong long calc(int n, int c1, int c2, int s1, int s2, const vector<int>& options,\n\n               int d, int nt, int ot) {\n\n  int b1(d-1), a1(d+1), b2(d-1), a2(d+1);\n\n  while (b1 >= 0 && options[b1] != nt) b1--;\n\n  while (b2 >= 0 && options[b2] != ot) b2--;\n\n  while (a1 < n && options[a1] != nt) a1++;\n\n  while (a2 < n && options[a2] != ot) a2++;\n\n  int x1(d-b1-1), y1(a1-d-1), z1(a1-b1-1), x2(d-b2-1), y2(a2-d-1), z2(a2-b2-1);\n\n  int diff1 = z1*(z1+1)/2-x1*(x1+1)/2-y1*(y1+1)/2;\n\n  int diff2 = z2*(z2+1)/2-x2*(x2+1)/2-y2*(y2+1)/2;\n\n  return (long long) diff1 * c1 - (long long) diff2 * c2 + s1 - s2;\n\n}\n\n \n\nint main() {\n\n  int n;\n\n  cin >> n;\n\n  vector<int> c(26);\n\n  vector<array<int, 26>> s(n);\n\n  \n\n  vector<int> last(26, -1);\n\n  \n\n  for (int i = 0; i < 26; ++i)\n\n    cin >> c[i];\n\n  for (int i = 0; i < n; ++i)\n\n    for (int j = 0; j < 26; ++j)\n\n      cin >> s[i][j];\n\n  \n\n  long long total(0);\n\n  vector<int> options(n);\n\n  \n\n  for (int i = 0; i < n; ++i) {\n\n    int neg(0), test(-1);\n\n    for (int j = 0; j < 26; ++j) {\n\n      neg -= c[j] * (i - last[j]);\n\n    }\n\n    \n\n    int max_score = -1e9;\n\n    for (int j = 0; j < 26; ++j) {\n\n      int ss = s[i][j] + neg + c[j] * (i - last[j]);\n\n      if (ss > max_score) {\n\n        max_score = ss;\n\n        test = j;\n\n      }\n\n    }\n\n    total += max_score;\n\n    options[i] = test;\n\n    last[test] = i;\n\n  }\n\n  /* reversed: 109149564 */\n\n  /* sorted: */\n\n  /* stocahstic */\n\n  for (int t = 1; t <= 500; ++t) {\n\n    bool entered = false;\n\n    for (int dd = 0; dd < n; ++dd) {\n\n      for (int tt = 0; tt < 26; ++tt) {\n\n        if (tt == options[dd]) continue;\n\n        int ot = options[dd];\n\n        long long ns = calc(n, c[tt], c[ot], s[dd][tt], s[dd][ot],\n\n                            options, dd, tt, ot);\n\n        //cout << ns << endl;\n\n        if (ns > 0) {\n\n          entered = true;\n\n          total += ns;\n\n          options[dd] = tt;\n\n    \t}\n\n      }\n\n    }\n\n    if (!entered) break;\n\n  }\n\n  for (const int& i: options) cout << i + 1 << endl;\n\n  \n\n  return 0;\n\n}"
    },
    {
        "id": "686",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nlong long calc(int n, int c1, int c2, int s1, int s2, const vector<int>& options,\n\n               int d, int nt, int ot) {\n\n  int b1(d-1), a1(d+1), b2(d-1), a2(d+1);\n\n  while (b1 >= 0 && options[b1] != nt) b1--;\n\n  while (b2 >= 0 && options[b2] != ot) b2--;\n\n  while (a1 < n && options[a1] != nt) a1++;\n\n  while (a2 < n && options[a2] != ot) a2++;\n\n  int x1(d-b1), y1(a1-d), z1(y1-x1), x2(d-b2), y2(a2-d), z2(y2-x2);\n\n  int diff1 = z1*(z1-1)/2-x1*(x1-1)/2-y1*(y1-1)/2;\n\n  int diff2 = z2*(z2-1)/2-x2*(x2-1)/2-y2*(y2-1)/2;\n\n  return (long long) diff1 * c1 - (long long) diff2 * c2 + s1 - s2;\n\n}\n\n\n\nint main() {\n\n  int n;\n\n  cin >> n;\n\n  vector<int> c(26);\n\n  vector<array<int, 26>> s(n);\n\n  \n\n  vector<int> last(26, -1);\n\n  \n\n  for (int i = 0; i < 26; ++i)\n\n    cin >> c[i];\n\n  for (int i = 0; i < n; ++i)\n\n    for (int j = 0; j < 26; ++j)\n\n      cin >> s[i][j];\n\n  \n\n  long long total(0);\n\n  vector<int> options(n);\n\n  \n\n  for (int i = 0; i < n; ++i) {\n\n    int neg(0), test(-1);\n\n    for (int j = 0; j < 26; ++j) {\n\n      neg -= c[j] * (i - last[j]);\n\n    }\n\n    \n\n    int max_score = -1e9;\n\n    for (int j = 0; j < 26; ++j) {\n\n      int ss = s[i][j] + neg + c[j] * (i - last[j]);\n\n      if (ss > max_score) {\n\n        max_score = ss;\n\n        test = j;\n\n      }\n\n    }\n\n    total += max_score;\n\n    options[i] = test;\n\n    last[test] = i;\n\n  }\n\n  \n\n  for (int t = 1; t <= 500; ++t) {\n\n    for (int dd = n - 1; dd >= 0; --dd) {\n\n      for (int tt = 25; tt >= 0; --tt) {\n\n        if (tt == options[dd]) continue;\n\n        int ot = options[dd];\n\n        long long ns = calc(n, c[tt], c[ot], s[dd][tt], s[dd][ot],\n\n                            options, dd, tt, ot);\n\n        //cout << ns << endl;\n\n        if (ns > 0) {\n\n          total += ns;\n\n          options[dd] = tt;\n\n    \t}\n\n      }\n\n    }\n\n  }\n\n  for (const int& i: options) cout << i + 1 << endl;\n\n  \n\n  return 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n \n\nlong long calc(int n, int c1, int c2, int s1, int s2, const vector<int>& options,\n\n               int d, int nt, int ot) {\n\n  int b1(d-1), a1(d+1), b2(d-1), a2(d+1);\n\n  while (b1 >= 0 && options[b1] != nt) b1--;\n\n  while (b2 >= 0 && options[b2] != ot) b2--;\n\n  while (a1 < n && options[a1] != nt) a1++;\n\n  while (a2 < n && options[a2] != ot) a2++;\n\n  int x1(d-b1-1), y1(a1-d-1), z1(a1-b1-1), x2(d-b2-1), y2(a2-d-1), z2(a2-b2-1);\n\n  int diff1 = z1*(z1+1)/2-x1*(x1+1)/2-y1*(y1+1)/2;\n\n  int diff2 = z2*(z2+1)/2-x2*(x2+1)/2-y2*(y2+1)/2;\n\n  return (long long) diff1 * c1 - (long long) diff2 * c2 + s1 - s2;\n\n}\n\n \n\nint main() {\n\n  int n;\n\n  cin >> n;\n\n  vector<int> c(26);\n\n  vector<array<int, 26>> s(n);\n\n  \n\n  vector<int> last(26, -1);\n\n  \n\n  for (int i = 0; i < 26; ++i)\n\n    cin >> c[i];\n\n  for (int i = 0; i < n; ++i)\n\n    for (int j = 0; j < 26; ++j)\n\n      cin >> s[i][j];\n\n  \n\n  long long total(0);\n\n  vector<int> options(n);\n\n  \n\n  for (int i = 0; i < n; ++i) {\n\n    int neg(0), test(-1);\n\n    for (int j = 0; j < 26; ++j) {\n\n      neg -= c[j] * (i - last[j]);\n\n    }\n\n    \n\n    int max_score = -1e9;\n\n    for (int j = 0; j < 26; ++j) {\n\n      int ss = s[i][j] + neg + c[j] * (i - last[j]);\n\n      if (ss > max_score) {\n\n        max_score = ss;\n\n        test = j;\n\n      }\n\n    }\n\n    total += max_score;\n\n    options[i] = test;\n\n    last[test] = i;\n\n  }\n\n  /* reversed: 109149564 */\n\n  /* sorted: */\n\n  /* stocahstic */\n\n  for (int t = 1; t <= 500; ++t) {\n\n    bool entered = false;\n\n    for (int dd = 0; dd < n; ++dd) {\n\n      for (int tt = 0; tt < 26; ++tt) {\n\n        if (tt == options[dd]) continue;\n\n        int ot = options[dd];\n\n        long long ns = calc(n, c[tt], c[ot], s[dd][tt], s[dd][ot],\n\n                            options, dd, tt, ot);\n\n        //cout << ns << endl;\n\n        if (ns > 0) {\n\n          entered = true;\n\n          total += ns;\n\n          options[dd] = tt;\n\n    \t}\n\n      }\n\n    }\n\n    if (!entered) break;\n\n  }\n\n  for (const int& i: options) cout << i + 1 << endl;\n\n  \n\n  return 0;\n\n}"
    },
    {
        "id": "687",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nlong long calc(int n, int c1, int c2, int s1, int s2, const vector<int>& options,\n\n               int d, int nt, int ot) {\n\n  int b1(d-1), a1(d+1), b2(d-1), a2(d+1);\n\n  while (b1 >= 0 && options[b1] != nt) b1--;\n\n  while (b2 >= 0 && options[b2] != ot) b2--;\n\n  while (a1 < n && options[a1] != nt) a1++;\n\n  while (a2 < n && options[a2] != ot) a2++;\n\n  int x1(d-b1-1), y1(a1-d-1), z1(a1-b1-1), x2(d-b2-1), y2(a2-d-1), z2(a2-b2-1);\n\n  int diff1 = z1*(z1+1)/2-x1*(x1+1)/2-y1*(y1+1)/2;\n\n  int diff2 = z2*(z2+1)/2-x2*(x2+1)/2-y2*(y2+1)/2;\n\n  return (long long) diff1 * c1 - (long long) diff2 * c2 + s1 - s2;\n\n}\n\n\n\nint main() {\n\n  int n;\n\n  cin >> n;\n\n  vector<int> c(26);\n\n  vector<array<int, 26>> s(n);\n\n  \n\n  vector<int> last(26, -1);\n\n  \n\n  for (int i = 0; i < 26; ++i)\n\n    cin >> c[i];\n\n  for (int i = 0; i < n; ++i)\n\n    for (int j = 0; j < 26; ++j)\n\n      cin >> s[i][j];\n\n  \n\n  long long total(0);\n\n  vector<int> options(n);\n\n  \n\n  for (int i = 0; i < n; ++i) {\n\n    int neg(0), test(-1);\n\n    for (int j = 0; j < 26; ++j) {\n\n      neg -= c[j] * (i - last[j]);\n\n    }\n\n    \n\n    int max_score = -1e9;\n\n    for (int j = 0; j < 26; ++j) {\n\n      int ss = s[i][j] + neg + c[j] * (i - last[j]);\n\n      if (ss > max_score) {\n\n        max_score = ss;\n\n        test = j;\n\n      }\n\n    }\n\n    total += max_score;\n\n    options[i] = test;\n\n    last[test] = i;\n\n  }\n\n  \n\n  for (int t = 1; t <= 500; ++t) {\n\n    for (int dd = n - 1; dd >= 0; --dd) {\n\n      for (int tt = 25; tt >= 0; --tt) {\n\n        if (tt == options[dd]) continue;\n\n        int ot = options[dd];\n\n        long long ns = calc(n, c[tt], c[ot], s[dd][tt], s[dd][ot],\n\n                            options, dd, tt, ot);\n\n        //cout << ns << endl;\n\n        if (ns > 0) {\n\n          total += ns;\n\n          options[dd] = tt;\n\n    \t}\n\n      }\n\n    }\n\n  }\n\n  for (const int& i: options) cout << i + 1 << endl;\n\n  \n\n  return 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n \n\nlong long calc(int n, int c1, int c2, int s1, int s2, const vector<int>& options,\n\n               int d, int nt, int ot) {\n\n  int b1(d-1), a1(d+1), b2(d-1), a2(d+1);\n\n  while (b1 >= 0 && options[b1] != nt) b1--;\n\n  while (b2 >= 0 && options[b2] != ot) b2--;\n\n  while (a1 < n && options[a1] != nt) a1++;\n\n  while (a2 < n && options[a2] != ot) a2++;\n\n  int x1(d-b1-1), y1(a1-d-1), z1(a1-b1-1), x2(d-b2-1), y2(a2-d-1), z2(a2-b2-1);\n\n  int diff1 = z1*(z1+1)/2-x1*(x1+1)/2-y1*(y1+1)/2;\n\n  int diff2 = z2*(z2+1)/2-x2*(x2+1)/2-y2*(y2+1)/2;\n\n  return (long long) diff1 * c1 - (long long) diff2 * c2 + s1 - s2;\n\n}\n\n \n\nint main() {\n\n  int n;\n\n  cin >> n;\n\n  vector<int> c(26);\n\n  vector<array<int, 26>> s(n);\n\n  \n\n  vector<int> last(26, -1);\n\n  \n\n  for (int i = 0; i < 26; ++i)\n\n    cin >> c[i];\n\n  for (int i = 0; i < n; ++i)\n\n    for (int j = 0; j < 26; ++j)\n\n      cin >> s[i][j];\n\n  \n\n  long long total(0);\n\n  vector<int> options(n);\n\n  \n\n  for (int i = 0; i < n; ++i) {\n\n    int neg(0), test(-1);\n\n    for (int j = 0; j < 26; ++j) {\n\n      neg -= c[j] * (i - last[j]);\n\n    }\n\n    \n\n    int max_score = -1e9;\n\n    for (int j = 0; j < 26; ++j) {\n\n      int ss = s[i][j] + neg + c[j] * (i - last[j]);\n\n      if (ss > max_score) {\n\n        max_score = ss;\n\n        test = j;\n\n      }\n\n    }\n\n    total += max_score;\n\n    options[i] = test;\n\n    last[test] = i;\n\n  }\n\n  /* reversed: 109149564 */\n\n  /* sorted: */\n\n  /* stocahstic */\n\n  for (int t = 1; t <= 500; ++t) {\n\n    bool entered = false;\n\n    for (int dd = 0; dd < n; ++dd) {\n\n      for (int tt = 0; tt < 26; ++tt) {\n\n        if (tt == options[dd]) continue;\n\n        int ot = options[dd];\n\n        long long ns = calc(n, c[tt], c[ot], s[dd][tt], s[dd][ot],\n\n                            options, dd, tt, ot);\n\n        //cout << ns << endl;\n\n        if (ns > 0) {\n\n          entered = true;\n\n          total += ns;\n\n          options[dd] = tt;\n\n    \t}\n\n      }\n\n    }\n\n    if (!entered) break;\n\n  }\n\n  for (const int& i: options) cout << i + 1 << endl;\n\n  \n\n  return 0;\n\n}"
    },
    {
        "id": "688",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nlong long calc(int n, int c1, int c2, int s1, int s2, const vector<int>& options,\n\n               int d, int nt, int ot) {\n\n  int b1(d-1), a1(d+1), b2(d-1), a2(d+1);\n\n  while (b1 >= 0 && options[b1] != nt) b1--;\n\n  while (b2 >= 0 && options[b2] != ot) b2--;\n\n  while (a1 < n && options[a1] != nt) a1++;\n\n  while (a2 < n && options[a2] != ot) a2++;\n\n  int x1(d-b1-1), y1(a1-d-1), z1(a1-b1-1), x2(d-b2-1), y2(a2-d-1), z2(a2-b2-1);\n\n  int diff1 = z1*(z1+1)/2-x1*(x1+1)/2-y1*(y1+1)/2;\n\n  int diff2 = z2*(z2+1)/2-x2*(x2+1)/2-y2*(y2+1)/2;\n\n  return (long long) diff1 * c1 - (long long) diff2 * c2 + s1 - s2;\n\n}\n\n\n\nint main() {\n\n  int n;\n\n  cin >> n;\n\n  vector<int> c(26);\n\n  vector<array<int, 26>> s(n);\n\n  \n\n  vector<int> last(26, -1);\n\n  \n\n  for (int i = 0; i < 26; ++i)\n\n    cin >> c[i];\n\n  for (int i = 0; i < n; ++i)\n\n    for (int j = 0; j < 26; ++j)\n\n      cin >> s[i][j];\n\n  \n\n  long long total(0);\n\n  vector<int> options(n);\n\n  \n\n  for (int i = 0; i < n; ++i) {\n\n    int neg(0), test(-1);\n\n    for (int j = 0; j < 26; ++j) {\n\n      neg -= c[j] * (i - last[j]);\n\n    }\n\n    \n\n    int max_score = -1e9;\n\n    for (int j = 0; j < 26; ++j) {\n\n      int ss = s[i][j] + neg + c[j] * (i - last[j]);\n\n      if (ss > max_score) {\n\n        max_score = ss;\n\n        test = j;\n\n      }\n\n    }\n\n    total += max_score;\n\n    options[i] = test;\n\n    last[test] = i;\n\n  }\n\n  /* reversed: 109149564 */\n\n  /* sorted: */\n\n  /* stocahstic */\n\n  for (int t = 1; t <= 500; ++t) {\n\n    for (int dd = 0; dd < n; ++dd) {\n\n      for (int tt = 0; tt < 26; ++tt) {\n\n        if (tt == options[dd]) continue;\n\n        int ot = options[dd];\n\n        long long ns = calc(n, c[tt], c[ot], s[dd][tt], s[dd][ot],\n\n                            options, dd, tt, ot);\n\n        //cout << ns << endl;\n\n        if (ns > 0) {\n\n          total += ns;\n\n          options[dd] = tt;\n\n    \t}\n\n      }\n\n    }\n\n  }\n\n  for (const int& i: options) cout << i + 1 << endl;\n\n  \n\n  return 0;\n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n \n\nlong long calc(int n, int c1, int c2, int s1, int s2, const vector<int>& options,\n\n               int d, int nt, int ot) {\n\n  int b1(d-1), a1(d+1), b2(d-1), a2(d+1);\n\n  while (b1 >= 0 && options[b1] != nt) b1--;\n\n  while (b2 >= 0 && options[b2] != ot) b2--;\n\n  while (a1 < n && options[a1] != nt) a1++;\n\n  while (a2 < n && options[a2] != ot) a2++;\n\n  int x1(d-b1-1), y1(a1-d-1), z1(a1-b1-1), x2(d-b2-1), y2(a2-d-1), z2(a2-b2-1);\n\n  int diff1 = z1*(z1+1)/2-x1*(x1+1)/2-y1*(y1+1)/2;\n\n  int diff2 = z2*(z2+1)/2-x2*(x2+1)/2-y2*(y2+1)/2;\n\n  return (long long) diff1 * c1 - (long long) diff2 * c2 + s1 - s2;\n\n}\n\n \n\nint main() {\n\n  int n;\n\n  cin >> n;\n\n  vector<int> c(26);\n\n  vector<array<int, 26>> s(n);\n\n  \n\n  vector<int> last(26, -1);\n\n  \n\n  for (int i = 0; i < 26; ++i)\n\n    cin >> c[i];\n\n  for (int i = 0; i < n; ++i)\n\n    for (int j = 0; j < 26; ++j)\n\n      cin >> s[i][j];\n\n  \n\n  long long total(0);\n\n  vector<int> options(n);\n\n  \n\n  for (int i = 0; i < n; ++i) {\n\n    int neg(0), test(-1);\n\n    for (int j = 0; j < 26; ++j) {\n\n      neg -= c[j] * (i - last[j]);\n\n    }\n\n    \n\n    int max_score = -1e9;\n\n    for (int j = 0; j < 26; ++j) {\n\n      int ss = s[i][j] + neg + c[j] * (i - last[j]);\n\n      if (ss > max_score) {\n\n        max_score = ss;\n\n        test = j;\n\n      }\n\n    }\n\n    total += max_score;\n\n    options[i] = test;\n\n    last[test] = i;\n\n  }\n\n  /* reversed: 109149564 */\n\n  /* sorted: */\n\n  /* stocahstic */\n\n  for (int t = 1; t <= 500; ++t) {\n\n    bool entered = false;\n\n    for (int dd = 0; dd < n; ++dd) {\n\n      for (int tt = 0; tt < 26; ++tt) {\n\n        if (tt == options[dd]) continue;\n\n        int ot = options[dd];\n\n        long long ns = calc(n, c[tt], c[ot], s[dd][tt], s[dd][ot],\n\n                            options, dd, tt, ot);\n\n        //cout << ns << endl;\n\n        if (ns > 0) {\n\n          entered = true;\n\n          total += ns;\n\n          options[dd] = tt;\n\n    \t}\n\n      }\n\n    }\n\n    if (!entered) break;\n\n  }\n\n  for (const int& i: options) cout << i + 1 << endl;\n\n  \n\n  return 0;\n\n}"
    },
    {
        "id": "691",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define all(v) v.begin(), v.end()\n\nusing in = int64_t;\n\n#define rep(i, n) for (int i = 0; i < (int)(n); i++)\n\n#define REP(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n\n#define Yes cout<<\"Yes\"<<endl \n\n#define No cout<<\"No\"<<endl\n\n#define yes cout<<\"yes\"<<endl \n\n#define no cout<<\"no\"<<endl\n\n#define vec(a,y,x)  vector<vector<char>> a (y,vector<char>(x))\n\nconst double PI=3.14159265358979323846;\n\nconst in MOD = 1000000007;\n\nconst in INF=1e18+7;\n\nconst int inf=1e9+7;\n\nconst vector<int> dx={1,0,-1,0};\n\nconst vector<int> dy={0,1,0,-1};\n\n\n\nint main(){\n\n  int D=365;\n\n  //cin>>D;\n\n  vector<int> c(26);\n\n  vector<vector<int>> s(D,vector<int>(26,0));\n\n  vector<int> t(D,0);\n\n  rep(i,26)\n\n    cin>>c.at(i);\n\n  rep(i,D){\n\n    rep(j,26)\n\n      cin>>s.at(i).at(j);\n\n  }\n\n  \n\n  /*rep(i,D){\n\n    cin>>t.at(i);\n\n    t.at(i)--;\n\n  }*/\n\n  \n\n  vector<in> v(D,0);\n\n  vector<int> last(26,0);\n\n  vector<int> last_alt=last;\n\n  in sum=0;\n\n  \n\n  for(int i=0;i<D;i++){\n\n    rep(T,26){\n\n      in sum_alt;\n\n      if(i==0) sum=0;\n\n      else\n\n        sum_alt=v.at(i-1);\n\n      \n\n      last_alt=last;\n\n      \n\n      last_alt.at(T)=i+1;\n\n      sum_alt+=s.at(i).at(T);\n\n      rep(j,26)\n\n        sum_alt-=c.at(j)*(i+1-last.at(j));\n\n      if(sum<sum_alt){\n\n        t.at(i)=T;\n\n        sum=sum_alt;\n\n      }\n\n    }\n\n    v.at(i)=sum;\n\n  }\n\n  \n\n  /*rep(i,D)\n\n    cout<<v.at(i)<<endl;*/\n\n  rep(i,D)\n\n    cout<<t.at(i)+1<<endl;\n\n  \n\n}",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define all(v) v.begin(), v.end()\n\nusing in = int64_t;\n\n#define rep(i, n) for (int i = 0; i < (int)(n); i++)\n\n#define REP(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n\n#define Yes cout<<\"Yes\"<<endl \n\n#define No cout<<\"No\"<<endl\n\n#define yes cout<<\"yes\"<<endl \n\n#define no cout<<\"no\"<<endl\n\n#define vec(a,y,x)  vector<vector<char>> a (y,vector<char>(x))\n\nconst double PI=3.14159265358979323846;\n\nconst in MOD = 1000000007;\n\nconst in INF=1e18+7;\n\nconst int inf=1e9+7;\n\nconst vector<int> dx={1,0,-1,0};\n\nconst vector<int> dy={0,1,0,-1};\n\n\n\nint main(){\n\n  int D=365;\n\n  cin>>D;\n\n  vector<int> c(26);\n\n  vector<vector<int>> s(D,vector<int>(26,0));\n\n  vector<int> t(D,0);\n\n  rep(i,26)\n\n    cin>>c.at(i);\n\n  rep(i,D){\n\n    rep(j,26)\n\n      cin>>s.at(i).at(j);\n\n  }\n\n  \n\n  /*rep(i,D){\n\n    cin>>t.at(i);\n\n    t.at(i)--;\n\n  }*/\n\n  \n\n  vector<in> v(D,0);\n\n  vector<int> last(26,0);\n\n  vector<int> last_alt=last;\n\n  in sum=0;\n\n  \n\n  for(int i=0;i<D;i++){\n\n    rep(T,26){\n\n      in sum_alt;\n\n      if(i==0) sum=0;\n\n      else\n\n        sum_alt=v.at(i-1);\n\n      \n\n      last_alt=last;\n\n      \n\n      last_alt.at(T)=i+1;\n\n      sum_alt+=s.at(i).at(T);\n\n      rep(j,26)\n\n        sum_alt-=c.at(j)*(i+1-last.at(j));\n\n      if(sum<sum_alt){\n\n        t.at(i)=T;\n\n        sum=sum_alt;\n\n      }\n\n    }\n\n    v.at(i)=sum;\n\n  }\n\n  \n\n  /*rep(i,D)\n\n    cout<<v.at(i)<<endl;*/\n\n  rep(i,D)\n\n    cout<<t.at(i)+1<<endl;\n\n  \n\n}"
    },
    {
        "id": "693",
        "source_code": "#include <iostream>\n\n#include <string>\n\n#include <vector>\n\n#include <set>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <algorithm>\n\n#include <iomanip>\n\n#include <math.h>\n\n#include <string.h>\n\n#include <cstdio>\n\n#include <tuple>\n\n#include <numeric>\n\nusing namespace std; using ll = long long; using ld = long double;  using pll = pair<ll, ll>;\n\nusing vl = vector<ll>; using vll = vector<vl>; using vpll = vector<pll>;\n\nusing vs = vector<string>; using tll = tuple<ll, ll, ll>; using vtll = vector<tll>;\n\nconst ld PI = 3.1415926535897932;\n\n#define debug(...) cerr << \"[\" << #__VA_ARGS__ << \"]:\", debug_out(__VA_ARGS__)\n\n#define mp make_pair\n\n#define mt make_tuple\n\n#define pb push_back\n\n#define co(i) cout << i << endl;\n\n#define co2(i,j) cout << i << \" \" << j << endl;\n\n#define co3(i) cout << i << \" \";\n\n#define po(i) cout << i.first << \" \" << i.second << endl;\n\nvoid in() {}\n\nvoid debug_out() { cerr << endl; }\n\ntemplate<typename Head, typename... Tail>\n\nvoid debug_out(Head h, Tail... t) {\n\n\tcerr << \" \" << h;\n\n\tif (sizeof...(t) > 0) cerr << \" :\";\n\n\tdebug_out(t...);\n\n}\n\ntemplate <typename T>\n\nostream& operator<<(ostream& os, vector<T> vec) {\n\n\tfor (size_t i = 0; i < vec.size(); i++)os << vec[i] << (i + 1 == vec.size() ? \"\" : \" \");\n\n\treturn os;\n\n}\n\nll ctoi(char c) {\n\n\tswitch (c) {\n\n\tcase '0': return 0; case '1': return 1; case '2': return 2;\n\n\tcase '3': return 3; case '4': return 4; case '5': return 5;\n\n\tcase '6': return 6; case '7': return 7; case '8': return 8;\n\n\tcase '9': return 9;  default: return 0;\n\n\t}\n\n}\n\nbool pairCompare(const pll firstElof, pll secondElof)\n\n{\n\n\treturn firstElof.first > secondElof.first;\n\n}\n\n//**Snippet\u30ea\u30b9\u30c8**//\n\n//rep, vin, all, iteLoop, bitSearch, bitList, nod, digitDP, treeDP//\n\n//gcdlcm, isPrime, eratos, primeFactorize, Npow, combination, divisor, modinv, doubling//\n\n//dfs, bfs, dijkstra, WarshallFloyd, BellmanFord, UnionFind, Kruskal, RMQ, LCA//\n\nll i, j, k, l; ll N, M, K, H, W, L, X, Y, Z, R, Q;\n\nll MOD = 1000000007, INF = 1LL << 60, ans = 0, z = 0, o = 1;\n\nvpll flag, D; vll path;\n\n//***********//\n\nint main() {\n\n\tll D;\n\n\tcin >> D;\n\n\tvl C(26);\n\n\tfor (i = 0; i < 26; i++) cin >> C[i];\n\n\tvll S(D, vl(26));\n\n\tfor (i = 0; i < D; i++) {\n\n\t\tfor (j = 0; j < 26; j++) {\n\n\t\t\tcin >> S[i][j];\n\n\t\t}\n\n\t}\n\n\tvl T(D);\n\n\tvl last(26, -1);\n\n\tfor (i = 0; i < D; i++) {\n\n\t\tll pre = 0;\n\n\t\tfor (j = 0; j < 26; j++) {\n\n\t\t\tif (S[i][j]-C[j]*105 > S[i][pre]-C[pre]*105) {\n\n\t\t\t\tpre = j;\n\n\t\t\t}\n\n\t\t}\n\n\t\tT[i] = pre;\n\n\t}\n\n\t//exit(0);\n\n\t//debug\u7528\n\n\tans = -INF;\n\n\tfor (ll loop = 0; loop < 20; loop++) {\n\n\t\tfor (k = 0; k < D; k++) {\n\n\t\t\tll pre2 = 0;\n\n\t\t\tfor (l = 0; l < 26; l++) {\n\n\t\t\t\tT[k] = l;\n\n\t\t\t\tll pre = 0;\n\n\t\t\t\tfor (i = 0; i < D; i++) {\n\n\t\t\t\t\tpre += S[i][T[i]];\n\n\t\t\t\t\tlast[T[i]] = i;\n\n\t\t\t\t\tfor (j = 0; j < 26; j++) {\n\n\t\t\t\t\t\tpre -= C[j] * (i - last[j]);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t//debug(pre);\n\n\t\t\t\tif (ans < pre) {\n\n\t\t\t\t\tans = pre;\n\n\t\t\t\t\tpre2 = l;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tT[k] = pre2;\n\n\t\t}\n\n\t}\n\n\tdebug(ans);\n\n\tfor (i = 0; i < D; i++) {\n\n\t\tco(T[i]+1);\n\n\t}\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <string>\n\n#include <vector>\n\n#include <set>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <algorithm>\n\n#include <iomanip>\n\n#include <math.h>\n\n#include <string.h>\n\n#include <cstdio>\n\n#include <tuple>\n\n#include <numeric>\n\nusing namespace std; using ll = long long; using ld = long double;  using pll = pair<ll, ll>;\n\nusing vl = vector<ll>; using vll = vector<vl>; using vpll = vector<pll>;\n\nusing vs = vector<string>; using tll = tuple<ll, ll, ll>; using vtll = vector<tll>;\n\nconst ld PI = 3.1415926535897932;\n\n#define debug(...) cerr << \"[\" << #__VA_ARGS__ << \"]:\", debug_out(__VA_ARGS__)\n\n#define mp make_pair\n\n#define mt make_tuple\n\n#define pb push_back\n\n#define co(i) cout << i << endl;\n\n#define co2(i,j) cout << i << \" \" << j << endl;\n\n#define co3(i) cout << i << \" \";\n\n#define po(i) cout << i.first << \" \" << i.second << endl;\n\nvoid in() {}\n\nvoid debug_out() { cerr << endl; }\n\ntemplate<typename Head, typename... Tail>\n\nvoid debug_out(Head h, Tail... t) {\n\n\tcerr << \" \" << h;\n\n\tif (sizeof...(t) > 0) cerr << \" :\";\n\n\tdebug_out(t...);\n\n}\n\ntemplate <typename T>\n\nostream& operator<<(ostream& os, vector<T> vec) {\n\n\tfor (size_t i = 0; i < vec.size(); i++)os << vec[i] << (i + 1 == vec.size() ? \"\" : \" \");\n\n\treturn os;\n\n}\n\nll ctoi(char c) {\n\n\tswitch (c) {\n\n\tcase '0': return 0; case '1': return 1; case '2': return 2;\n\n\tcase '3': return 3; case '4': return 4; case '5': return 5;\n\n\tcase '6': return 6; case '7': return 7; case '8': return 8;\n\n\tcase '9': return 9;  default: return 0;\n\n\t}\n\n}\n\nbool pairCompare(const pll firstElof, pll secondElof)\n\n{\n\n\treturn firstElof.first > secondElof.first;\n\n}\n\n//**Snippet\u30ea\u30b9\u30c8**//\n\n//rep, vin, all, iteLoop, bitSearch, bitList, nod, digitDP, treeDP//\n\n//gcdlcm, isPrime, eratos, primeFactorize, Npow, combination, divisor, modinv, doubling//\n\n//dfs, bfs, dijkstra, WarshallFloyd, BellmanFord, UnionFind, Kruskal, RMQ, LCA//\n\nll i, j, k, l; ll N, M, K, H, W, L, X, Y, Z, R, Q;\n\nll MOD = 1000000007, INF = 1LL << 60, ans = 0, z = 0, o = 1;\n\nvpll flag, D; vll path;\n\n//***********//\n\nint main() {\n\n\tll D;\n\n\tcin >> D;\n\n\tvl C(26);\n\n\tfor (i = 0; i < 26; i++) cin >> C[i];\n\n\tvll S(D, vl(26));\n\n\tfor (i = 0; i < D; i++) {\n\n\t\tfor (j = 0; j < 26; j++) {\n\n\t\t\tcin >> S[i][j];\n\n\t\t}\n\n\t}\n\n\tvl T(D);\n\n\tvl last(26, -1);\n\n\tfor (i = 0; i < D; i++) {\n\n\t\tll pre = 0;\n\n\t\tfor (j = 0; j < 26; j++) {\n\n\t\t\tif (S[i][j]+C[j]*105 > S[i][pre]+C[pre]*105) {\n\n\t\t\t\tpre = j;\n\n\t\t\t}\n\n\t\t}\n\n\t\tT[i] = pre;\n\n\t}\n\n\t//exit(0);\n\n\t//debug\u7528\n\n\tfor (i = 0; i < D; i++) {\n\n\t\tans += S[i][T[i]];\n\n\t\tlast[T[i]] = i;\n\n\t\tfor (j = 0; j < 26; j++) {\n\n\t\t\tans -= C[j] * (i - last[j]);\n\n\t\t}\n\n\t}\n\n\tdebug(ans);\n\n\tfor (ll loop = 0; loop < 10; loop++) {\n\n\t\tfor (k = 0; k < D; k++) {\n\n\t\t\tll pre2 = 0;\n\n\t\t\tfor (l = 0; l < 26; l++) {\n\n\t\t\t\tT[k] = l;\n\n\t\t\t\tll pre = 0;\n\n\t\t\t\tvl last2(26, -1);\n\n\t\t\t\tfor (i = 0; i < D; i++) {\n\n\t\t\t\t\tpre += S[i][T[i]];\n\n\t\t\t\t\tlast2[T[i]] = i;\n\n\t\t\t\t\tfor (j = 0; j < 26; j++) {\n\n\t\t\t\t\t\tpre -= C[j] * (i - last2[j]);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t//debug(pre);\n\n\t\t\t\tif (ans < pre) {\n\n\t\t\t\t\tans = pre;\n\n\t\t\t\t\tpre2 = l;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tT[k] = pre2;\n\n\t\t}\n\n\t}\n\n\tdebug(ans);\n\n\tfor (i = 0; i < D; i++) {\n\n\t\tco(T[i]+1);\n\n\t}\n\n}"
    },
    {
        "id": "694",
        "source_code": "#include <bits/stdc++.h>\n\n// #include <boost/multiprecision/cpp_int.hpp>\n\nusing namespace std;\n\n\n\n#define all(a) (a).begin(), (a).end()\n\n#define rall(a) (a).rbegin(), (a).rend()\n\n#define MIN(a) *std::min_element((a).begin(), (a).end())\n\n#define MAX(a) *std::max_element((a).begin(), (a).end())\n\n#define SUM(a) std::accumulate((a).begin(), (a).end(), 0LL)\n\n#define REP(i, n) for (int (i) = 0; (i) < (n); (i)++)\n\n#define RREP(i, n) for (int (i) = (n)-1; (i) >= 0; (i)--)\n\n#define FOR(i, m, n) for (int (i) = (m); (i) < (n); i++)\n\n#define FORR(i, m, n) for (int (i) = (n)-1; (i) >= (m); i--)\n\n#define debug(x) std::cerr << #x << \" = \" << x << '\\n'\n\n// #define int long long\n\n\n\nusing ll = long long;\n\nusing ull = unsigned long long;\n\nusing ld = long double;\n\nusing vl = std::vector<long long>;\n\nusing vvl = std::vector<std::vector<long long>>;\n\n// using bint = boost::multiprecision::cpp_int;\n\n// using rat = boost::rational<bint>;\n\n\n\nconstexpr int inf = (1 << 30) - 1;\n\nconstexpr long long INF = 1LL << 60;\n\nconstexpr double eps = 1e-9;\n\n\n\ninline void ios_() {std::cin.tie(nullptr); std::ios::sync_with_stdio(false);}\n\ntemplate<typename T> inline T Div(const T& a, const T& b) {return (a + b - 1) / b;}\n\ntemplate<typename T> bool chmin(T& a, const T& b) {if(a > b){a = b; return true;} return false;}\n\ntemplate<typename T> bool chmax(T& a, const T& b) {if(a < b){a = b; return true;} return false;}\n\n\n\ntemplate<typename T>\n\ninline void finish(const T& msg) {\n\n    std::cout << msg << std::endl;\n\n    std::exit(0);\n\n}\n\n\n\ntemplate<typename T>\n\nlong long binarySearch(long long ng, long long ok, const T& fn) {\n\n    while (std::abs(ok - ng) > 1) {\n\n        long long mid = (ok + ng) / 2;\n\n        if (fn(mid)) ok = mid;\n\n        else ng = mid;\n\n    }\n\n    return ok;\n\n}\n\n\n\nstruct ModInt {\n\n    long long value;\n\n    static constexpr long long mod = 1e9+7;\n\n    // static constexpr long long mod = 998244353;\n\n\n\n    constexpr ModInt(long long v = 0) : value(((v % mod) + mod) % mod) {}\n\n\n\n    constexpr ModInt pow(long long n) const {\n\n        long long x = value, res = 1;\n\n        while (n > 0) {\n\n            if (n & 1) {\n\n                res = res * x % mod;\n\n            }\n\n            x = x * x % mod;\n\n            n >>= 1;\n\n        }\n\n        return ModInt(res);\n\n    }\n\n\n\n    constexpr ModInt inverse() const {\n\n        return pow(mod - 2);\n\n    }\n\n\n\n    constexpr ModInt operator-() const {\n\n        return ModInt((mod - value) % mod);\n\n    }\n\n\n\n    constexpr ModInt& operator+=(const ModInt& a) {\n\n        value += a.value;\n\n        value %= mod;\n\n        return *this;\n\n    }\n\n\n\n    constexpr ModInt& operator-=(const ModInt& a) {\n\n        value += (-a).value;\n\n        value %= mod;\n\n        return *this;\n\n    }\n\n\n\n    constexpr ModInt& operator*=(const ModInt& a) {\n\n        value *= a.value;\n\n        value %= mod;\n\n        return *this;\n\n    }\n\n\n\n    constexpr ModInt& operator/=(const ModInt& a) {\n\n        return (*this) *= a.inverse();\n\n    }\n\n\n\n    constexpr ModInt operator+(const ModInt& a) const {\n\n        return ModInt(*this) += a;\n\n    }\n\n\n\n    constexpr ModInt operator-(const ModInt& a) const {\n\n        return ModInt(*this) -= a;\n\n    }\n\n\n\n    constexpr ModInt operator*(const ModInt& a) const {\n\n        return ModInt(*this) *= a;\n\n    }\n\n\n\n    constexpr ModInt operator/(const ModInt& a) const {\n\n        return ModInt(*this) /= a;\n\n    }\n\n\n\n    constexpr bool operator==(const ModInt& a) const {\n\n        return value == a.value;\n\n    }\n\n\n\n    constexpr bool operator!=(const ModInt& a) const {\n\n        return value != a.value;\n\n    }\n\n\n\n    friend std::istream& operator>>(std::istream& is, ModInt& a) {\n\n        long long v;\n\n        is >> v;\n\n        a = v;\n\n        return is;\n\n    }\n\n\n\n    friend std::ostream& operator<<(std::ostream& os, const ModInt& a) {\n\n        os << a.value;\n\n        return os;\n\n    }\n\n\n\n    static ModInt factorial(int n) {\n\n        static std::vector<ModInt> fact(1 << 18);\n\n\n\n        if (fact.size() <= n) fact.resize(n + 1);\n\n\n\n        if (n < 0) return 0;\n\n        if (n == 0) return 1;\n\n        if (fact[n] != 0) return fact[n];\n\n\n\n        return fact[n] = factorial(n - 1) * n;\n\n    }\n\n\n\n    static ModInt combin(int n, int k) {\n\n        if (n < 0 || k < 0 || n < k) return 0;\n\n        return factorial(n) / (factorial(k) * factorial(n - k));\n\n    }\n\n};\n\n\n\nusing mint = ModInt;\n\n\n\nstruct Solver {\n\n    int days;\n\n    const int alpha = 26;\n\n    vector<int> coef;\n\n    vector<vector<ll>> score;\n\n    vector<int> last;\n\n    vector<vector<int>> hist;\n\n    // vector<int> ans;\n\n\n\n    Solver(int d) : days(d), coef(alpha), score(d, vl(alpha)), last(alpha, 0), hist(alpha) {\n\n        REP(i, alpha) cin >> coef[i];\n\n        REP(i, days){\n\n            REP(j, alpha){\n\n                cin >> score[i][j];\n\n            }\n\n        }\n\n    }\n\n\n\n    ll calcScore(const vector<int>& select) {\n\n        ll s = 0;\n\n        REP(i, alpha){\n\n            hist[i].clear();\n\n            hist[i].push_back(0);\n\n        }\n\n\n\n        REP(i, days){\n\n            int t = select[i];\n\n            hist[t].push_back(i+1);\n\n            s += score[i][t];\n\n            REP(j, alpha){\n\n                s -= coef[j] * (i + 1 - hist[j].back());\n\n            }\n\n        }\n\n        return s;\n\n    }\n\n\n\n    void update(vector<int>& select) {\n\n        REP(i, days){\n\n            int t = select[i];\n\n            ll ms = score[i][t];\n\n\n\n            auto itr = lower_bound(all(hist[t]), i+1);\n\n            int a = *itr;\n\n            itr--;\n\n            a -= *itr;\n\n            itr++;\n\n            int b = -*itr;\n\n            itr++;\n\n            b += (itr == hist[t].end() ? days : *itr);\n\n\n\n            ms += coef[t] * (a*(a+1) + b*(b+1) - (a+b)*(a+b+1)) / 2;\n\n\n\n            REP(j, alpha){\n\n                auto itr = upper_bound(all(hist[j]), i+1);\n\n                a = (itr == hist[j].end() ? days : *itr);\n\n                a -= i + 1;\n\n                itr--;\n\n                b = i + 1 - *itr;\n\n                ll s = score[i][j] + coef[j] * ((a+b)*(a+b+1) - a*(a+1) - b*(b+1)) / 2;\n\n                if(chmax(ms, s)){\n\n                    t = j;\n\n                }\n\n            }\n\n            select[i] = t;\n\n        }\n\n    }\n\n\n\n    void solve() {\n\n        vector<int> select(days, 0);\n\n        REP(i, days) select[i] = (i % 26);\n\n        int iteration = 100, loop = 0;;\n\n        do{\n\n            calcScore(select);\n\n            update(select);\n\n            loop++;\n\n        }while(loop < iteration);\n\n\n\n        print(select);\n\n    }\n\n\n\n    void print(const vector<int>& select) const {\n\n        for(const auto& i : select) {\n\n            cout << i + 1 << '\\n';\n\n        }\n\n    }\n\n\n\n};\n\n\n\nsigned main() {\n\n    int d;\n\n    cin >> d;\n\n    Solver s(d);\n\n    s.solve();\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n// #include <boost/multiprecision/cpp_int.hpp>\n\nusing namespace std;\n\n\n\n#define all(a) (a).begin(), (a).end()\n\n#define rall(a) (a).rbegin(), (a).rend()\n\n#define MIN(a) *std::min_element((a).begin(), (a).end())\n\n#define MAX(a) *std::max_element((a).begin(), (a).end())\n\n#define SUM(a) std::accumulate((a).begin(), (a).end(), 0LL)\n\n#define REP(i, n) for (int (i) = 0; (i) < (n); (i)++)\n\n#define RREP(i, n) for (int (i) = (n)-1; (i) >= 0; (i)--)\n\n#define FOR(i, m, n) for (int (i) = (m); (i) < (n); i++)\n\n#define FORR(i, m, n) for (int (i) = (n)-1; (i) >= (m); i--)\n\n#define debug(x) std::cerr << #x << \" = \" << x << '\\n'\n\n// #define int long long\n\n\n\nusing ll = long long;\n\nusing ull = unsigned long long;\n\nusing ld = long double;\n\nusing vl = std::vector<long long>;\n\nusing vvl = std::vector<std::vector<long long>>;\n\n// using bint = boost::multiprecision::cpp_int;\n\n// using rat = boost::rational<bint>;\n\n\n\nconstexpr int inf = (1 << 30) - 1;\n\nconstexpr long long INF = 1LL << 60;\n\nconstexpr double eps = 1e-9;\n\n\n\ninline void ios_() {std::cin.tie(nullptr); std::ios::sync_with_stdio(false);}\n\ntemplate<typename T> inline T Div(const T& a, const T& b) {return (a + b - 1) / b;}\n\ntemplate<typename T> bool chmin(T& a, const T& b) {if(a > b){a = b; return true;} return false;}\n\ntemplate<typename T> bool chmax(T& a, const T& b) {if(a < b){a = b; return true;} return false;}\n\n\n\ntemplate<typename T>\n\ninline void finish(const T& msg) {\n\n    std::cout << msg << std::endl;\n\n    std::exit(0);\n\n}\n\n\n\ntemplate<typename T>\n\nlong long binarySearch(long long ng, long long ok, const T& fn) {\n\n    while (std::abs(ok - ng) > 1) {\n\n        long long mid = (ok + ng) / 2;\n\n        if (fn(mid)) ok = mid;\n\n        else ng = mid;\n\n    }\n\n    return ok;\n\n}\n\n\n\nstruct ModInt {\n\n    long long value;\n\n    static constexpr long long mod = 1e9+7;\n\n    // static constexpr long long mod = 998244353;\n\n\n\n    constexpr ModInt(long long v = 0) : value(((v % mod) + mod) % mod) {}\n\n\n\n    constexpr ModInt pow(long long n) const {\n\n        long long x = value, res = 1;\n\n        while (n > 0) {\n\n            if (n & 1) {\n\n                res = res * x % mod;\n\n            }\n\n            x = x * x % mod;\n\n            n >>= 1;\n\n        }\n\n        return ModInt(res);\n\n    }\n\n\n\n    constexpr ModInt inverse() const {\n\n        return pow(mod - 2);\n\n    }\n\n\n\n    constexpr ModInt operator-() const {\n\n        return ModInt((mod - value) % mod);\n\n    }\n\n\n\n    constexpr ModInt& operator+=(const ModInt& a) {\n\n        value += a.value;\n\n        value %= mod;\n\n        return *this;\n\n    }\n\n\n\n    constexpr ModInt& operator-=(const ModInt& a) {\n\n        value += (-a).value;\n\n        value %= mod;\n\n        return *this;\n\n    }\n\n\n\n    constexpr ModInt& operator*=(const ModInt& a) {\n\n        value *= a.value;\n\n        value %= mod;\n\n        return *this;\n\n    }\n\n\n\n    constexpr ModInt& operator/=(const ModInt& a) {\n\n        return (*this) *= a.inverse();\n\n    }\n\n\n\n    constexpr ModInt operator+(const ModInt& a) const {\n\n        return ModInt(*this) += a;\n\n    }\n\n\n\n    constexpr ModInt operator-(const ModInt& a) const {\n\n        return ModInt(*this) -= a;\n\n    }\n\n\n\n    constexpr ModInt operator*(const ModInt& a) const {\n\n        return ModInt(*this) *= a;\n\n    }\n\n\n\n    constexpr ModInt operator/(const ModInt& a) const {\n\n        return ModInt(*this) /= a;\n\n    }\n\n\n\n    constexpr bool operator==(const ModInt& a) const {\n\n        return value == a.value;\n\n    }\n\n\n\n    constexpr bool operator!=(const ModInt& a) const {\n\n        return value != a.value;\n\n    }\n\n\n\n    friend std::istream& operator>>(std::istream& is, ModInt& a) {\n\n        long long v;\n\n        is >> v;\n\n        a = v;\n\n        return is;\n\n    }\n\n\n\n    friend std::ostream& operator<<(std::ostream& os, const ModInt& a) {\n\n        os << a.value;\n\n        return os;\n\n    }\n\n\n\n    static ModInt factorial(int n) {\n\n        static std::vector<ModInt> fact(1 << 18);\n\n\n\n        if (fact.size() <= n) fact.resize(n + 1);\n\n\n\n        if (n < 0) return 0;\n\n        if (n == 0) return 1;\n\n        if (fact[n] != 0) return fact[n];\n\n\n\n        return fact[n] = factorial(n - 1) * n;\n\n    }\n\n\n\n    static ModInt combin(int n, int k) {\n\n        if (n < 0 || k < 0 || n < k) return 0;\n\n        return factorial(n) / (factorial(k) * factorial(n - k));\n\n    }\n\n};\n\n\n\nusing mint = ModInt;\n\n\n\nstruct Solver {\n\n    int days;\n\n    const int alpha = 26;\n\n    vector<int> coef;\n\n    vector<vector<ll>> score;\n\n    vector<int> last;\n\n    vector<vector<int>> hist;\n\n    // vector<int> ans;\n\n\n\n    Solver(int d) : days(d), coef(alpha), score(d, vl(alpha)), last(alpha, 0), hist(alpha) {\n\n        REP(i, alpha) cin >> coef[i];\n\n        REP(i, days){\n\n            REP(j, alpha){\n\n                cin >> score[i][j];\n\n            }\n\n        }\n\n    }\n\n\n\n    ll calcScore(const vector<int>& select) {\n\n        ll s = 0;\n\n        REP(i, alpha){\n\n            hist[i].clear();\n\n            hist[i].push_back(0);\n\n        }\n\n\n\n        REP(i, days){\n\n            int t = select[i];\n\n            hist[t].push_back(i+1);\n\n            s += score[i][t];\n\n            REP(j, alpha){\n\n                s -= coef[j] * (i + 1 - hist[j].back());\n\n            }\n\n        }\n\n        return s;\n\n    }\n\n\n\n    void update(vector<int>& select) {\n\n        REP(i, days){\n\n            int t = select[i];\n\n            ll ms = score[i][t];\n\n\n\n            auto itr = lower_bound(all(hist[t]), i+1);\n\n            int a = *itr;\n\n            itr--;\n\n            a -= *itr;\n\n            itr++;\n\n            int b = -*itr;\n\n            itr++;\n\n            b += (itr == hist[t].end() ? days : *itr);\n\n\n\n            ms += coef[t] * (a*(a+1) + b*(b+1) - (a+b)*(a+b+1)) / 2;\n\n\n\n            REP(j, alpha){\n\n                auto itr = upper_bound(all(hist[j]), i+1);\n\n                a = (itr == hist[j].end() ? days : *itr);\n\n                a -= i + 1;\n\n                itr--;\n\n                b = i + 1 - *itr;\n\n                ll s = score[i][j] + coef[j] * ((a+b)*(a+b+1) - a*(a+1) - b*(b+1)) / 2;\n\n                if(chmax(ms, s)){\n\n                    t = j;\n\n                }\n\n            }\n\n            select[i] = t;\n\n        }\n\n    }\n\n\n\n    void solve() {\n\n        vector<int> select(days, 0);\n\n        REP(i, days) select[i] = (i % 26);\n\n        int iteration = 1, loop = 0;;\n\n        do{\n\n            calcScore(select);\n\n            update(select);\n\n            loop++;\n\n        }while(loop < iteration);\n\n\n\n        print(select);\n\n    }\n\n\n\n    void print(const vector<int>& select) const {\n\n        for(const auto& i : select) {\n\n            cout << i + 1 << '\\n';\n\n        }\n\n    }\n\n\n\n};\n\n\n\nsigned main() {\n\n    int d;\n\n    cin >> d;\n\n    Solver s(d);\n\n    s.solve();\n\n    return 0;\n\n}\n"
    },
    {
        "id": "695",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <array>\n\n#include <bitset>\n\n#include <cmath>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <vector>\n\n#include <queue>\n\n#include <set>\n\n#include <map>\n\n#include <unordered_set>\n\n#include <unordered_map>\n\n#include <string>\n\n#include <tuple>\n\n#include <utility>\n\n#include <functional>\n\n#include <sys/time.h>\n\n#include <iomanip>\n\n\n\nusing namespace std;\n\nusing ll = long long;\n\nusing ull = unsigned long long;\n\nusing ld = long double;\n\n#define REP(i, m, n) for(int i = (m); i < (n); ++i)\n\n#define rep(i, n) REP(i, 0, n)\n\n#define all(s) (s).begin(), (s).end()\n\n#define pb push_back\n\n#define fs first\n\n#define sc second\n\ntemplate <typename T>\n\nbool chmax(T &a, const T b){if(a < b){a = b; return true;} return false;}\n\ntemplate <typename T>\n\nbool chmin(T &a, const T b){if(a > b){a = b; return true;} return false;}\n\ntemplate <typename T>\n\nll pow2(const T n){return (1LL << n);}\n\nvoid setp(const int n){cout << fixed << setprecision(n);}\n\nconstexpr int INF = 1e9+1;\n\nconstexpr ll LINF = 1e18+1;\n\nconstexpr ll MOD = 1e9+7;\n\n//constexpr ll MOD = 998244353;\n\nconstexpr ld EPS = 1e-11;\n\nconst ld PI = acos(-1);\n\n\n\nstruct Xorshift {\n\n\tunsigned int x, y, z, w;\n\n\t\n\n\tXorshift() {\n\n\t\tx = 123456789, y = 362436069, z = 521288629, w = 88675123;\n\n\t}\n\n\n\n\tunsigned int rand(){\n\n\t\tunsigned int t = (x^(x<<11));\n\n\t\tx = y; y = z; z = w;\n\n\t\treturn w = (w^(w>>19))^(t^(t>>8));\n\n\t}\n\n\n\n\tdouble rand_d(){\n\n\t\treturn (double)rand() / (1LL << 32);\n\n\t}\n\n};\n\nXorshift xor128;\n\n\n\nconstexpr int BEAM_SIZE = 1;\n\nconstexpr int SZ = 26;\n\nconstexpr int D = 365;\n\narray<int, SZ> C;\n\nint SUM = 0;\n\narray<array<int, SZ>, D> S;\n\n\n\nstruct beam_search {\n\n\tstruct State {\n\n\t\tarray<short, SZ> last = {};\n\n\t\tarray<char, D> ans;\n\n\t\tint score = 0, sum = 0;\n\n\n\n\t\tvoid update_score(int d, int t) {\n\n\t\t\tscore += S[d][t];\n\n\t\t\tsum -= C[t] * (d + 1 - last[t]);\n\n\t\t\tlast[t] = d + 1;\n\n\t\t\tsum += SUM;\n\n\t\t\tscore -= sum;\n\n\t\t}\n\n\n\n\t\tint next_eval(int d, int t){\n\n\t\t\tint res = score;\n\n\t\t\tres += S[d][t];\n\n\t\t\tres += C[t] * (d + 1 - last[t]);\n\n\t\t\tres -= sum + SUM;\n\n\t\t\treturn res;\n\n\t\t}\n\n\n\n\t\tint eval() const {\n\n\t\t\treturn score;\n\n\t\t}\n\n\n\n\t\tState place(int d, int t) {\n\n\t\t\tState res = *this;\n\n\t\t\tres.ans[d] = t;\n\n\t\t\tres.update_score(d, t);\n\n\t\t\treturn res;\n\n\t\t}\n\n\n\n\t\tarray<char, D> answer() {\n\n\t\t\treturn ans;\n\n\t\t}\n\n\t};\n\n\n\n\t\n\n\tarray<char, D> solve() {\n\n\t\tState initial_state;\n\n\t\tusing f = function<bool(State&, State&)>;\n\n\t\tpriority_queue<State, vector<State>, f> cur([](State& a, State& b){return a.eval() > b.eval();});\n\n\t\tcur.push(initial_state);\n\n\t\tpriority_queue<State, vector<State>, f> nxt([](State& a, State& b){return a.eval() > b.eval();});\n\n\t\trep(d, D){\n\n\t\t\twhile(!nxt.empty()) nxt.pop();\n\n\t\t\twhile(!cur.empty()){\n\n\t\t\t\tState now = cur.top(); cur.pop();\n\n\t\t\t\trep(t, SZ){\n\n\t\t\t\t\tif(nxt.size() < BEAM_SIZE || now.next_eval(d, t) > nxt.top().eval()) nxt.push(now.place(d, t));\n\n\t\t\t\t\tif(nxt.size() > BEAM_SIZE) nxt.pop();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tswap(cur, nxt);\n\n\t\t}\n\n\n\n\t\tState res;\n\n\t\twhile(!cur.empty()){\n\n\t\t\tif(cur.size() == 1) res = cur.top();\n\n\t\t\tcur.pop();\n\n\t\t}\n\n\t\tcerr << res.eval() << endl;\n\n\t\treturn res.answer();\n\n\t}\n\n};\n\n\n\nconstexpr double T0 = 5e3, T1 = 1e2, TL = 1.98;\n\n\n\nstruct annealing {\n\n\tdouble temperature(double t){\n\n\t\tt /= TL;\n\n\t\treturn pow(T0, 1.0 - t) * pow(T1, t);\n\n\t}\n\n\n\n\tint calc_score(array<char, D> ans){\n\n\t\tint res = 0, sum = 0;\n\n\t\tarray<short, SZ> last = {};\n\n\t\trep(d, D){\n\n\t\t\tchar t = ans[d];\n\n\t\t\tres += S[d][t];\n\n\t\t\tsum -= C[t] * (d + 1 - last[t]);\n\n\t\t\tlast[t] = d + 1;\n\n\t\t\tsum += SUM;\n\n\t\t\tres -= sum;\n\n\t\t}\n\n\t\treturn res;\n\n\t}\n\n\n\n\tbool is_update(int new_score, int prev_score, double temp){\n\n\t\tif (new_score >= prev_score) return true;\n\n\t\treturn exp((double)(new_score - prev_score) / temp) >= xor128.rand_d();\n\n\t}\n\n\n\n\tint solve(array<char, D> &ans) {\n\n\t\tint score = calc_score(ans);\n\n\n\n\t\twhile((double)clock() / CLOCKS_PER_SEC < TL){\n\n\t\t\tdouble t = (double)clock() / CLOCKS_PER_SEC;\n\n\t\t\tdouble temp = temperature(t);\n\n\t\t\trep(i, 300){\n\n\t\t\t\tif(xor128.rand() % 2){\n\n\t\t\t\t\tint d = xor128.rand() % D;\n\n\t\t\t\t\tchar e = xor128.rand() % SZ;\n\n\t\t\t\t\tswap(ans[d], e);\n\n\t\t\t\t\tint new_score = calc_score(ans);\n\n\t\t\t\t\tif (!is_update(new_score, score, temp)) swap(ans[d], e);\n\n\t\t\t\t\telse score = new_score;\n\n\t\t\t\t}else{\n\n\t\t\t\t\tint d1 = xor128.rand() % (D - 1);\n\n\t\t\t\t\tint d2 = min((int)(d1 + 1 + xor128.rand() % 20), D - 1);\n\n\t\t\t\t\tswap(ans[d1], ans[d2]);\n\n\t\t\t\t\tint new_score = calc_score(ans);\n\n\t\t\t\t\tif (!is_update(new_score, score, temp)) swap(ans[d2], ans[d1]);\n\n\t\t\t\t\telse score = new_score;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\treturn score;\n\n\t}\n\n};\n\n\n\nint main(void){\n\n\tint tmp;\n\n\tcin >> tmp;\n\n\trep(i, SZ) cin >> C[i];\n\n\trep(i, SZ) SUM += C[i];\n\n\trep(i, D) rep(j, SZ) cin >> S[i][j];\n\n\n\n\tbeam_search state1;\n\n\tauto ans = state1.solve();\n\n\tannealing state2;\n\n\tcerr << state2.solve(ans) << endl;\n\n\tfor (char i : ans) cout << (int)i + 1 << endl;\n\n\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <array>\n\n#include <bitset>\n\n#include <cmath>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <vector>\n\n#include <queue>\n\n#include <set>\n\n#include <map>\n\n#include <unordered_set>\n\n#include <unordered_map>\n\n#include <string>\n\n#include <tuple>\n\n#include <utility>\n\n#include <functional>\n\n#include <sys/time.h>\n\n#include <iomanip>\n\n\n\nusing namespace std;\n\nusing ll = long long;\n\n#define REP(i, m, n) for(int i = (m); i < (n); ++i)\n\n#define rep(i, n) REP(i, 0, n)\n\ntemplate <typename T>\n\nbool chmax(T &a, const T b){if(a < b){a = b; return true;} return false;}\n\ntemplate <typename T>\n\nbool chmin(T &a, const T b){if(a > b){a = b; return true;} return false;}\n\nconstexpr int INF = 1e9+1;\n\nconstexpr ll LINF = 1e18+1;\n\nconstexpr int MOD = 1e9+7;\n\n// constexpr ll MOD = 998244353;\n\nconstexpr double EPS = 1e-11;\n\n\n\nstruct Xorshift {\n\n\tunsigned int x, y, z, w;\n\n\t\n\n\tXorshift() {\n\n\t\tx = 123456789, y = 362436069, z = 521288629, w = 88675123;\n\n\t}\n\n\n\n\tunsigned int rand(){\n\n\t\tunsigned int t = (x^(x<<11));\n\n\t\tx = y; y = z; z = w;\n\n\t\treturn w = (w^(w>>19))^(t^(t>>8));\n\n\t}\n\n\n\n\tdouble rand_d(){\n\n\t\treturn (double)rand() / (1LL << 32);\n\n\t}\n\n};\n\nXorshift xor128;\n\n\n\nconstexpr int BEAM_SIZE = 1000;\n\nconstexpr int SZ = 26;\n\nconstexpr int D = 365;\n\narray<int, SZ> C;\n\nint SUM = 0;\n\narray<array<int, SZ>, D> S;\n\n\n\nstruct beam_search {\n\n\tstruct State {\n\n\t\tarray<short, SZ> last = {};\n\n\t\tarray<char, D> ans;\n\n\t\tint score = 0, sum = 0;\n\n\n\n\t\tvoid update_score(int d, int t) {\n\n\t\t\tscore += S[d][t];\n\n\t\t\tsum -= C[t] * (d + 1 - last[t]);\n\n\t\t\tlast[t] = d + 1;\n\n\t\t\tsum += SUM;\n\n\t\t\tscore -= sum;\n\n\t\t}\n\n\n\n\t\tint next_eval(int d, int t){\n\n\t\t\tint res = score;\n\n\t\t\tres += S[d][t];\n\n\t\t\tres += C[t] * (d + 1 - last[t]);\n\n\t\t\tres -= sum + SUM;\n\n\t\t\treturn res;\n\n\t\t}\n\n\n\n\t\tint eval() const {\n\n\t\t\treturn score;\n\n\t\t}\n\n\n\n\t\tState place(int d, int t) {\n\n\t\t\tState res = *this;\n\n\t\t\tres.ans[d] = t;\n\n\t\t\tres.update_score(d, t);\n\n\t\t\treturn res;\n\n\t\t}\n\n\n\n\t\tarray<char, D> answer() {\n\n\t\t\treturn ans;\n\n\t\t}\n\n\t};\n\n\n\n\t\n\n\tarray<char, D> solve() {\n\n\t\tState initial_state;\n\n\t\tusing f = function<bool(State&, State&)>;\n\n\t\tpriority_queue<State, vector<State>, f> cur([](State& a, State& b){return a.eval() > b.eval();});\n\n\t\tcur.push(initial_state);\n\n\t\tpriority_queue<State, vector<State>, f> nxt([](State& a, State& b){return a.eval() > b.eval();});\n\n\t\trep(d, D){\n\n\t\t\twhile(!nxt.empty()) nxt.pop();\n\n\t\t\twhile(!cur.empty()){\n\n\t\t\t\tState now = cur.top(); cur.pop();\n\n\t\t\t\trep(t, SZ){\n\n\t\t\t\t\tif(nxt.size() < BEAM_SIZE || now.next_eval(d, t) > nxt.top().eval()) nxt.push(now.place(d, t));\n\n\t\t\t\t\tif(nxt.size() > BEAM_SIZE) nxt.pop();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tswap(cur, nxt);\n\n\t\t}\n\n\n\n\t\tState res;\n\n\t\twhile(!cur.empty()){\n\n\t\t\tif(cur.size() == 1) res = cur.top();\n\n\t\t\tcur.pop();\n\n\t\t}\n\n\t\tcerr << res.eval() << endl;\n\n\t\treturn res.answer();\n\n\t}\n\n};\n\n\n\nconstexpr double T0 = 5e3, T1 = 1e2, TL = 1.95;\n\n\n\nstruct annealing {\n\n\tdouble temperature(double t){\n\n\t\tt /= TL;\n\n\t\treturn pow(T0, 1.0 - t) * pow(T1, t);\n\n\t}\n\n\n\n\tint calc_score(array<char, D> ans){\n\n\t\tint res = 0, sum = 0;\n\n\t\tarray<short, SZ> last = {};\n\n\t\trep(d, D){\n\n\t\t\tchar t = ans[d];\n\n\t\t\tres += S[d][t];\n\n\t\t\tsum -= C[t] * (d + 1 - last[t]);\n\n\t\t\tlast[t] = d + 1;\n\n\t\t\tsum += SUM;\n\n\t\t\tres -= sum;\n\n\t\t}\n\n\t\treturn res;\n\n\t}\n\n\n\n\tbool is_update(int diff_score, double temp){\n\n\t\tif (diff_score >= 0) return true;\n\n\t\treturn exp((double)diff_score / temp) >= xor128.rand_d();\n\n\t}\n\n\n\n\tint solve(array<char, D> &ans) {\n\n\t\tint score = calc_score(ans);\n\n\n\n\t\twhile((double)clock() / CLOCKS_PER_SEC < TL){\n\n\t\t\tdouble t = (double)clock() / CLOCKS_PER_SEC;\n\n\t\t\tdouble temp = temperature(t);\n\n\t\t\trep(i, 100){\n\n\t\t\t\tif(xor128.rand() % 2){\n\n\t\t\t\t\tint d = xor128.rand() % D;\n\n\t\t\t\t\tchar e = xor128.rand() % SZ;\n\n\t\t\t\t\tswap(ans[d], e);\n\n\t\t\t\t\tint new_score = calc_score(ans);\n\n\t\t\t\t\tif (!is_update(new_score - score, temp)) swap(ans[d], e);\n\n\t\t\t\t\telse score = new_score;\n\n\t\t\t\t}else{\n\n\t\t\t\t\tint d1 = xor128.rand() % (D - 1);\n\n\t\t\t\t\tint d2 = min((int)(d1 + 1 + xor128.rand() % 20), D - 1);\n\n\t\t\t\t\tswap(ans[d1], ans[d2]);\n\n\t\t\t\t\tint new_score = calc_score(ans);\n\n\t\t\t\t\tif (!is_update(new_score - score, temp)) swap(ans[d2], ans[d1]);\n\n\t\t\t\t\telse score = new_score;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\treturn score;\n\n\t}\n\n};\n\n\n\nint main(void){\n\n\tint tmp;\n\n\tcin >> tmp;\n\n\trep(i, SZ) cin >> C[i];\n\n\trep(i, SZ) SUM += C[i];\n\n\trep(i, D) rep(j, SZ) cin >> S[i][j];\n\n\n\n\tbeam_search state1;\n\n\t// auto ans = state1.solve();\n\n\tarray<char, D> ans;\n\n\trep(i, D) ans[i] = i % SZ;\n\n\tannealing state2;\n\n\tcerr << state2.solve(ans) << endl;\n\n\tfor (char i : ans) cout << (int)i + 1 << endl;\n\n\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "697",
        "source_code": "#include <bits/stdc++.h>\n\n\n\ntemplate <class T>\n\ninline void read(T &res)\n\n{\n\n\tchar ch; bool flag = false; res = 0;\n\n\twhile (ch = getchar(), !isdigit(ch) && ch != '-');\n\n\tch == '-' ? flag = true : res = ch ^ 48;\n\n\twhile (ch = getchar(), isdigit(ch))\n\n\t\tres = res * 10 + ch - 48;\n\n\tflag ? res = -res : 0;\n\n}\n\n\n\ntemplate <class T>\n\ninline void put(T x)\n\n{\n\n\tif (x > 9)\n\n\t\tput(x / 10);\n\n\tputchar(x % 10 + 48);\n\n}\n\n\n\ntemplate <class T>\n\ninline void CkMax(T &x, T y) {x < y ? x = y : 0;}\n\ntemplate <class T>\n\ninline void CkMin(T &x, T y) {x > y ? x = y : 0;}\n\ntemplate <class T>\n\ninline T Max(T x, T y) {return x > y ? x : y;}\n\ntemplate <class T>\n\ninline T Min(T x, T y) {return x < y ? x : y;}\n\n\n\nconst int N = 1e5 + 5;\n\nint n, ans;\n\n\n\nstruct seg\n\n{\n\n\tint l, r;\n\n\n\n\tseg() {}\n\n\tseg(int L, int R):\n\n\t\tl(L), r(R) {}\n\n\n\n\tinline int len()\n\n\t{\n\n\t\treturn r >= l ? r - l + 1 : 0;\n\n\t}\n\n\n\n\tinline void scan()\n\n\t{\n\n\t\tread(l);\n\n\t\tread(r);\n\n\t}\n\n\n\n\tinline bool operator < (const seg &a) const\n\n\t{\n\n\t\treturn r < a.r || r == a.r && l > a.l;\n\n\t}\n\n\n\n\tinline seg operator & (const seg &a) const \n\n\t{\n\n\t\treturn seg(Max(l, a.l), Min(r, a.r));\n\n\t}\n\n}p[N], pre[N], suf[N];\n\n\n\ninline void solve()\n\n{\n\n\tpre[0] = seg(1, 1e9);\n\n\tfor (int i = 1; i <= n; ++i)\n\n\t\tpre[i] = pre[i - 1] & p[i];\n\n\tsuf[n + 1] = seg(1, 1e9);\n\n\tfor (int i = n; i >= 1; --i)\n\n\t\tsuf[i] = suf[i + 1] & p[i];\n\n\tfor (int i = 1; i < n; ++i)\n\n\t\tCkMax(ans, pre[i].len() + suf[i + 1].len());\n\n\tfor (int i = 1; i <= n; ++i)\n\n\t\tCkMax(ans, (pre[i - 1] & suf[i + 1]).len() + p[i].len());\n\n}\n\n\n\nint main()\n\n{\n\n\tread(n);\n\n\tfor (int i = 1; i <= n; ++i)\n\n\t\tp[i].scan();\n\n\n\n\tstd::sort(p + 1, p + n + 1);\n\n\tsolve();\n\n\tfor (int i = n; i >= 1; --i)\n\n\t{\n\n\t\tp[i].l = 1e9 - p[i].l + 1;\n\n\t\tp[i].r = 1e9 - p[i].r + 1;\n\n\t}\n\n\n\n\tstd::sort(p + 1, p + n + 1);\n\n\tsolve();\n\n\tfor (int i = 1; i <= 100; ++i)\n\n\t{\n\n\t\tfor (int j = 1; j <= 100; ++j)\n\n\t\t\tstd::swap(p[1ll * rand() * rand() % n + 1], p[1ll * rand() * rand() % n + 1]);\n\n\t\tsolve();\n\n\t}\n\n\t\n\n\tprintf(\"%d\\n\", ans);\n\n\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\ntemplate <class T>\n\ninline void read(T &res)\n\n{\n\n\tchar ch; bool flag = false; res = 0;\n\n\twhile (ch = getchar(), !isdigit(ch) && ch != '-');\n\n\tch == '-' ? flag = true : res = ch ^ 48;\n\n\twhile (ch = getchar(), isdigit(ch))\n\n\t\tres = res * 10 + ch - 48;\n\n\tflag ? res = -res : 0;\n\n}\n\n\n\ntemplate <class T>\n\ninline void put(T x)\n\n{\n\n\tif (x > 9)\n\n\t\tput(x / 10);\n\n\tputchar(x % 10 + 48);\n\n}\n\n\n\ntemplate <class T>\n\ninline void CkMax(T &x, T y) {x < y ? x = y : 0;}\n\ntemplate <class T>\n\ninline void CkMin(T &x, T y) {x > y ? x = y : 0;}\n\ntemplate <class T>\n\ninline T Max(T x, T y) {return x > y ? x : y;}\n\ntemplate <class T>\n\ninline T Min(T x, T y) {return x < y ? x : y;}\n\n\n\nconst int N = 1e5 + 5;\n\nint n, ans;\n\n\n\nstruct seg\n\n{\n\n\tint l, r;\n\n\n\n\tseg() {}\n\n\tseg(int L, int R):\n\n\t\tl(L), r(R) {}\n\n\n\n\tinline int len()\n\n\t{\n\n\t\treturn r >= l ? r - l + 1 : 0;\n\n\t}\n\n\n\n\tinline void scan()\n\n\t{\n\n\t\tread(l);\n\n\t\tread(r);\n\n\t}\n\n\n\n\tinline bool operator < (const seg &a) const\n\n\t{\n\n\t\treturn r < a.r || r == a.r && l > a.l;\n\n\t}\n\n\n\n\tinline seg operator & (const seg &a) const \n\n\t{\n\n\t\treturn seg(Max(l, a.l), Min(r, a.r));\n\n\t}\n\n}p[N], pre[N], suf[N];\n\n\n\ninline void solve()\n\n{\n\n\tpre[0] = seg(1, 1e9);\n\n\tfor (int i = 1; i <= n; ++i)\n\n\t\tpre[i] = pre[i - 1] & p[i];\n\n\tsuf[n + 1] = seg(1, 1e9);\n\n\tfor (int i = n; i >= 1; --i)\n\n\t\tsuf[i] = suf[i + 1] & p[i];\n\n\tfor (int i = 1; i < n; ++i)\n\n\t\tCkMax(ans, pre[i].len() + suf[i + 1].len());\n\n\tfor (int i = 1; i <= n; ++i)\n\n\t\tCkMax(ans, (pre[i - 1] & suf[i + 1]).len() + p[i].len());\n\n}\n\n\n\nint main()\n\n{\n\n\tread(n);\n\n\tfor (int i = 1; i <= n; ++i)\n\n\t\tp[i].scan();\n\n\n\n\tstd::sort(p + 1, p + n + 1);\n\n\tsolve();\n\n\tprintf(\"%d\\n\", ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "699",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef signed long long ll;\n\n\n\n#undef _P\n\n#define _P(...) (void)printf(__VA_ARGS__)\n\n#define FOR(x,to) for(x=0;x<(to);x++)\n\n#define FORR(x,arr) for(auto& x:arr)\n\n#define ITR(x,c) for(__typeof(c.begin()) x=c.begin();x!=c.end();x++)\n\n#define ALL(a) (a.begin()),(a.end())\n\n#define ZERO(a) memset(a,0,sizeof(a))\n\n#define MINUS(a) memset(a,0xff,sizeof(a))\n\n//-------------------------------------------------------\n\n\n\nint N;\n\npair<ll,ll> P[101010];\n\nll A[101010],B[101010];\n\n\n\nvoid solve() {\n\n\tint i,j,k,l,r,x,y; string s;\n\n\t\n\n\tcin>>N;\n\n\tll ma=0;\n\n\tFOR(i,N) {\n\n\t\tcin>>x>>y;\n\n\t\ty++;\n\n\t\tma=max(ma,(ll)y-x);\n\n\t\tP[i]={y,x};\n\n\t}\n\n\t\n\n\tsort(P,P+N);\n\n\tll L=P[0].second,R=P[0].first;\n\n\tA[0]=R-L;\n\n\tfor(i=1;i<N;i++) {\n\n\t\tL=max(L,P[i].second);\n\n\t\tR=min(R,P[i].first);\n\n\t\tA[i]=max(0LL,R-L);\n\n\t}\n\n\tL=P[N-1].second,R=P[N-1].first;\n\n\tB[N-1]=R-L;\n\n\tfor(i=N-2;i>=0;i--) {\n\n\t\tL=max(L,P[i].second);\n\n\t\tR=min(R,P[i].first);\n\n\t\tB[i]=max(0LL,R-L);\n\n\t}\n\n\t\t\n\n\tFOR(i,N) {\n\n\t\tma=max(ma,A[i]+B[i+1]);\n\n\t}\n\n\t\n\n\tFOR(i,N) swap(P[i].first,P[i].second);\n\n\tsort(P+1,P+N);\n\n\tZERO(A);\n\n\tZERO(B);\n\n\tL=P[0].first,R=P[0].second;\n\n\tA[0]=R-L;\n\n\tfor(i=1;i<N;i++) {\n\n\t\tL=max(L,P[i].first);\n\n\t\tR=min(R,P[i].second);\n\n\t\tA[i]=max(0LL,R-L);\n\n\t}\n\n\tL=P[N-1].first,R=P[N-1].second;\n\n\tB[N-1]=R-L;\n\n\tfor(i=N-2;i>=0;i--) {\n\n\t\tL=max(L,P[i].first);\n\n\t\tR=min(R,P[i].second);\n\n\t\tB[i]=max(0LL,R-L);\n\n\t}\n\n\t\n\n\tsort(P,P+N);\n\n\tZERO(A);\n\n\tZERO(B);\n\n\tL=P[0].first,R=P[0].second;\n\n\tA[0]=R-L;\n\n\tfor(i=1;i<N;i++) {\n\n\t\tL=max(L,P[i].first);\n\n\t\tR=min(R,P[i].second);\n\n\t\tA[i]=max(0LL,R-L);\n\n\t}\n\n\tL=P[N-1].first,R=P[N-1].second;\n\n\tB[N-1]=R-L;\n\n\tfor(i=N-2;i>=0;i--) {\n\n\t\tL=max(L,P[i].first);\n\n\t\tR=min(R,P[i].second);\n\n\t\tB[i]=max(0LL,R-L);\n\n\t}\n\n\tFOR(i,N) {\n\n\t\tma=max(ma,A[i]+B[i+1]);\n\n\t}\n\n\t\n\n\t\n\n\tmultiset<int> SL,SR;\n\n\tFOR(i,N) SL.insert(P[i].first),SR.insert(P[i].second);\n\n\tFOR(i,N) {\n\n\t\tSL.erase(SL.find(P[i].first));\n\n\t\tSR.erase(SR.find(P[i].second));\n\n\t\t\n\n\t\tint AL=*SL.rbegin();\n\n\t\tint AR=*SR.begin();\n\n\t\tma=max(ma,P[i].second-P[i].first+max(0,AR-AL));\n\n\t\tSL.insert(P[i].first);\n\n\t\tSR.insert(P[i].second);\n\n\t}\n\n\t\n\n\t\n\n\t\n\n\tcout<<ma<<endl;\n\n\t\n\n\t\n\n\t\n\n}\n\n\n\n\n\nint main(int argc,char** argv){\n\n\tstring s;int i;\n\n\tif(argc==1) ios::sync_with_stdio(false), cin.tie(0);\n\n\tFOR(i,argc-1) s+=argv[i+1],s+='\\n'; FOR(i,s.size()) ungetc(s[s.size()-1-i],stdin);\n\n\tcout.tie(0); solve(); return 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef signed long long ll;\n\n\n\n#undef _P\n\n#define _P(...) (void)printf(__VA_ARGS__)\n\n#define FOR(x,to) for(x=0;x<(to);x++)\n\n#define FORR(x,arr) for(auto& x:arr)\n\n#define ITR(x,c) for(__typeof(c.begin()) x=c.begin();x!=c.end();x++)\n\n#define ALL(a) (a.begin()),(a.end())\n\n#define ZERO(a) memset(a,0,sizeof(a))\n\n#define MINUS(a) memset(a,0xff,sizeof(a))\n\n//-------------------------------------------------------\n\n\n\nint N;\n\npair<ll,ll> P[101010];\n\nll A[101010],B[101010];\n\n\n\nvoid solve() {\n\n\tint i,j,k,l,r,x,y; string s;\n\n\t\n\n\tcin>>N;\n\n\tll ma=0;\n\n\tFOR(i,N) {\n\n\t\tcin>>x>>y;\n\n\t\ty++;\n\n\t\tP[i]={x,y};\n\n\t}\n\n\t/*\n\n\tsort(P,P+N);\n\n\tll L=P[0].second,R=P[0].first;\n\n\tA[0]=R-L;\n\n\tfor(i=1;i<N;i++) {\n\n\t\tL=max(L,P[i].second);\n\n\t\tR=min(R,P[i].first);\n\n\t\tA[i]=max(0LL,R-L);\n\n\t}\n\n\tL=P[N-1].second,R=P[N-1].first;\n\n\tB[N-1]=R-L;\n\n\tfor(i=N-2;i>=0;i--) {\n\n\t\tL=max(L,P[i].second);\n\n\t\tR=min(R,P[i].first);\n\n\t\tB[i]=max(0LL,R-L);\n\n\t}\n\n\t\t\n\n\tFOR(i,N) {\n\n\t\tma=max(ma,A[i]+B[i+1]);\n\n\t}\n\n\t\n\n\tFOR(i,N) swap(P[i].first,P[i].second);\n\n\tsort(P+1,P+N);\n\n\tZERO(A);\n\n\tZERO(B);\n\n\tL=P[0].first,R=P[0].second;\n\n\tA[0]=R-L;\n\n\tfor(i=1;i<N;i++) {\n\n\t\tL=max(L,P[i].first);\n\n\t\tR=min(R,P[i].second);\n\n\t\tA[i]=max(0LL,R-L);\n\n\t}\n\n\tL=P[N-1].first,R=P[N-1].second;\n\n\tB[N-1]=R-L;\n\n\tfor(i=N-2;i>=0;i--) {\n\n\t\tL=max(L,P[i].first);\n\n\t\tR=min(R,P[i].second);\n\n\t\tB[i]=max(0LL,R-L);\n\n\t}\n\n\t*/\n\n\tsort(P,P+N);\n\n\tZERO(A);\n\n\tZERO(B);\n\n\tll L=P[0].first,R=P[0].second;\n\n\tA[0]=R-L;\n\n\tfor(i=1;i<N;i++) {\n\n\t\tL=max(L,P[i].first);\n\n\t\tR=min(R,P[i].second);\n\n\t\tA[i]=max(0LL,R-L);\n\n\t}\n\n\tL=P[N-1].first,R=P[N-1].second;\n\n\tB[N-1]=R-L;\n\n\tfor(i=N-2;i>=0;i--) {\n\n\t\tL=max(L,P[i].first);\n\n\t\tR=min(R,P[i].second);\n\n\t\tB[i]=max(0LL,R-L);\n\n\t}\n\n\tFOR(i,N) {\n\n\t\tma=max(ma,A[i]+B[i+1]);\n\n\t}\n\n\t\n\n\t\n\n\tmultiset<int> SL,SR;\n\n\tFOR(i,N) SL.insert(P[i].first),SR.insert(P[i].second);\n\n\tFOR(i,N) {\n\n\t\tSL.erase(SL.find(P[i].first));\n\n\t\tSR.erase(SR.find(P[i].second));\n\n\t\t\n\n\t\tint AL=*SL.rbegin();\n\n\t\tint AR=*SR.begin();\n\n\t\tma=max(ma,P[i].second-P[i].first+max(0,AR-AL));\n\n\t\tSL.insert(P[i].first);\n\n\t\tSR.insert(P[i].second);\n\n\t}\n\n\t\n\n\t\n\n\t\n\n\tcout<<ma<<endl;\n\n\t\n\n\t\n\n\t\n\n}\n\n\n\n\n\nint main(int argc,char** argv){\n\n\tstring s;int i;\n\n\tif(argc==1) ios::sync_with_stdio(false), cin.tie(0);\n\n\tFOR(i,argc-1) s+=argv[i+1],s+='\\n'; FOR(i,s.size()) ungetc(s[s.size()-1-i],stdin);\n\n\tcout.tie(0); solve(); return 0;\n\n}\n"
    },
    {
        "id": "700",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include <cstdlib>  \n\n#include <math.h>\n\n#include <cmath>\n\n#include<cctype>\n\n#include<string>\n\n#include<set>\n\n#include<iomanip>\n\n#include <map>\n\n#include<algorithm>\n\n#include <functional>\n\n#include<vector>\n\n#include<climits>\n\n#include<stack>\n\n#include<queue>\n\n#include<bitset>\n\n#include <deque>\n\n#include <climits>\n\n#include <typeinfo>\n\n#include <utility> \n\nusing namespace std;\n\nusing ll = long long;\n\ntemplate<typename T>using min_priority_queue = priority_queue<T, vector<T>, greater<T>>;\n\nconst ll inf = 1LL << 60;\n\n#define all(x) (x).begin(),(x).end()\n\n#define puts(x) cout << x << endl\n\n#define rep(i,m,n) for(ll i = m;i < n;++i)\n\n#define pb push_back\n\n#define fore(i,a) for(auto &i:a)\n\n#define rrep(i,m,n) for(ll i = m;i >= n;--i)\n\n\n\nll mod = 998244353;\n\nll fact[101010];\n\nint main() {\n\n\tios::sync_with_stdio(false);\n\n\tcin.tie(nullptr);\n\n\n\n\tint N;\n\n\tstring S;\n\n\tcin >> N >> S;\n\n\tfact[0] = 1;\n\n\tfor (ll i = 1; i < 101010; i++) {\n\n\t\tfact[i] = fact[i - 1] * i;\n\n\t\tfact[i] %= mod;\n\n\t}\n\n\n\n\tll ans = fact[N];\n\n\tmap<char, int>mp;\n\n\tmp['R'] = 0;\n\n\tmp['G'] = 0;\n\n\tmp['B'] = 0;\n\n\tfor (int i = 0; i < 3 * N; i++) {\n\n\t\tchar c = S[i];\n\n\t\tvector<pair<int, char>>v;\n\n\t\tfore(x, mp)v.pb({x.second,x.first});\n\n\t\tsort(all(v));\n\n\t\tif (mp[c] == v[0].first) {\n\n\t\t\tif (v[0].first < v[1].first)ans *= v[1].first - v[0].first;\n\n\t\t\telse if(v[1].first < v[2].first) ans *= v[2].first - v[0].first;\n\n\t\t}\n\n\t\telse if (mp[c] == v[1].first) {\n\n\t\t\tif (v[1].first < v[2].first)ans *= v[2].first - v[1].first;\n\n\t\t}\n\n\t\tmp[c]++;\n\n\t\tans %= mod;\n\n\t}\n\n\tputs(ans);\n\n\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include <cstdlib>  \n\n#include <math.h>\n\n#include <cmath>\n\n#include<cctype>\n\n#include<string>\n\n#include<set>\n\n#include<iomanip>\n\n#include <map>\n\n#include<algorithm>\n\n#include <functional>\n\n#include<vector>\n\n#include<climits>\n\n#include<stack>\n\n#include<queue>\n\n#include<bitset>\n\n#include <deque>\n\n#include <climits>\n\n#include <typeinfo>\n\n#include <utility> \n\nusing namespace std;\n\nusing ll = long long;\n\ntemplate<typename T>using min_priority_queue = priority_queue<T, vector<T>, greater<T>>;\n\nconst ll inf = 1LL << 60;\n\n#define all(x) (x).begin(),(x).end()\n\n#define puts(x) cout << x << endl\n\n#define rep(i,m,n) for(ll i = m;i < n;++i)\n\n#define pb push_back\n\n#define fore(i,a) for(auto &i:a)\n\n#define rrep(i,m,n) for(ll i = m;i >= n;--i)\n\n\n\n\n\nll mod = 998244353;\n\nint main() {\n\n\tios::sync_with_stdio(false);\n\n\tcin.tie(nullptr);\n\n\n\n\tint N;\n\n\tstring S;\n\n\tcin >> N >> S;\n\n\tvector<ll>cnt(7);\n\n\tcnt[6] = N;\n\n\tll ans = 1;\n\n\tfor (int i = 0; i < 3*N; i++) {\n\n\t\tint c = S[i];\n\n\t\tif (c == 'R') {\n\n\t\t\tif (cnt[2]) {\n\n\t\t\t\tans *= cnt[2];\n\n\t\t\t\tcnt[2]--;\n\n\t\t\t}\n\n\t\t\telse if (cnt[3]) {\n\n\t\t\t\tans *= cnt[3];\n\n\t\t\t\tcnt[3]--;\n\n\t\t\t\tcnt[0]++;\n\n\t\t\t}\n\n\t\t\telse if (cnt[5]) {\n\n\t\t\t\tans *= cnt[5];\n\n\t\t\t\tcnt[5]--;\n\n\t\t\t\tcnt[1]++;\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tans *= cnt[6];\n\n\t\t\t\tcnt[6]--;\n\n\t\t\t\tcnt[4]++;\n\n\t\t\t}\n\n\t\t}\n\n\t\telse if (c == 'G') {\n\n\t\t\tif (cnt[1]) {\n\n\t\t\t\tans *= cnt[1];\n\n\t\t\t\tcnt[1]--;\n\n\t\t\t}\n\n\t\t\telse if (cnt[4]) {\n\n\t\t\t\tans *= cnt[4];\n\n\t\t\t\tcnt[4]--;\n\n\t\t\t\tcnt[0]++;\n\n\t\t\t}\n\n\t\t\telse if (cnt[5]) {\n\n\t\t\t\tans *= cnt[5];\n\n\t\t\t\tcnt[5]--;\n\n\t\t\t\tcnt[2]++;\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tans *= cnt[6];\n\n\t\t\t\tcnt[6]--;\n\n\t\t\t\tcnt[3]++;\n\n\t\t\t}\n\n\t\t}\n\n\t\telse {\n\n\t\t\tif (cnt[0]) {\n\n\t\t\t\tans *= cnt[0];\n\n\t\t\t\tcnt[0]--;\n\n\t\t\t}\n\n\t\t\telse if (cnt[3]) {\n\n\t\t\t\tans *= cnt[3];\n\n\t\t\t\tcnt[3]--;\n\n\t\t\t\tcnt[2]++;\n\n\t\t\t}\n\n\t\t\telse if (cnt[4]) {\n\n\t\t\t\tans *= cnt[4];\n\n\t\t\t\tcnt[4]--;\n\n\t\t\t\tcnt[1]++;\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tans *= cnt[6];\n\n\t\t\t\tcnt[6]--;\n\n\t\t\t\tcnt[5]++;\n\n\t\t\t}\n\n\t\t}\n\n\t\tans %= mod;\n\n\t}\n\n\tputs(ans);\n\n\n\n\treturn 0;\n\n}\n\n\n"
    },
    {
        "id": "701",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <iomanip>\n\n#include <stdlib.h>\n\n#include <string.h>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <map>\n\n#include <queue>\n\n#include <deque>\n\n#include <stack>\n\n#include <set>\n\n#include <stdio.h>\n\n#include <tuple>\n\n#include <bitset>\n\n#include <cfloat>\n\n#include <fstream>\n\n#include <limits.h>\n\n#include <list>\n\n#include <math.h>\n\n#include <random>\n\n#include <unordered_map>\n\n#include <unordered_set>\n\n#include <bitset>\n\n#include <numeric>\n\n#include <utility>\n\n#include <sstream>\n\n#include <cassert>\n\n\n\ntemplate<class T> inline bool chmin(T& a, T b) {\n\n\tif (a > b) {\n\n\t\ta = b;\n\n\t\treturn true;\n\n\t}\n\n\treturn false;\n\n}\n\ntemplate<class T> inline bool chmax(T& a, T b) {\n\n\tif (a < b) {\n\n\t\ta = b;\n\n\t\treturn true;\n\n\t}\n\n\treturn false;\n\n}\n\n\n\nusing namespace std;\n\n#define int long long\n\n#define ll long long\n\n#define rep(i, n) for (ll i = 0; i < (n); i++)\n\n#define P pair<ll, ll>\n\n#define sz(x) (ll)x.size()\n\n#define ALL(x) (x).begin(),(x).end()\n\n#define ALLR(x) (x).rbegin(),(x).rend()\n\n#define VE vector<ll>\n\n#define COUT(x) cout<<(x)<<endl\n\n#define MA map<ll,ll>\n\n#define SE set<ll>\n\n#define PQ priority_queue<ll>\n\n#define PQR priority_queue<ll,VE,greater<ll>>\n\n#define COUT(x) cout<<(x)<<endl\n\n#define YES(n) cout << ((n) ? \"YES\" : \"NO\"  ) << endl\n\n#define Yes(n) cout << ((n) ? \"Yes\" : \"No\"  ) << endl\n\n#define EPS (1e-10)\n\n#define pb push_back\n\n\n\nconst long long MOD = 1000000007;\n\n//const long long MOD = 998244353;\n\nconst long long INF = 1LL << 60;\n\nconst double PI = acos(-1.0);\n\nusing Graph = vector<VE>;\n\n\n\nstruct mint {\n\n\tll x; // typedef long long ll;\n\n\tmint(ll x = 0) :x((x%MOD + MOD) % MOD) {}\n\n\tmint operator-() const { return mint(-x); }\n\n\tmint& operator+=(const mint a) {\n\n\t\tif ((x += a.x) >= MOD) x -= MOD;\n\n\t\treturn *this;\n\n\t}\n\n\tmint& operator-=(const mint a) {\n\n\t\tif ((x += MOD - a.x) >= MOD) x -= MOD;\n\n\t\treturn *this;\n\n\t}\n\n\tmint& operator*=(const mint a) {\n\n\t\t(x *= a.x) %= MOD;\n\n\t\treturn *this;\n\n\t}\n\n\tmint operator+(const mint a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res += a;\n\n\t}\n\n\tmint operator-(const mint a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res -= a;\n\n\t}\n\n\tmint operator*(const mint a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res *= a;\n\n\t}\n\n\tmint pow(ll t) const {\n\n\t\tif (!t) return 1;\n\n\t\tmint a = pow(t >> 1);\n\n\t\ta *= a;\n\n\t\tif (t & 1) a *= *this;\n\n\t\treturn a;\n\n\t}\n\n\n\n\t// for prime MOD\n\n\tmint inv() const {\n\n\t\treturn pow(MOD - 2);\n\n\t}\n\n\tmint& operator/=(const mint a) {\n\n\t\treturn (*this) *= a.inv();\n\n\t}\n\n\tmint operator/(const mint a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res /= a;\n\n\t}\n\n};\n\nstruct combination {\n\n\tvector<mint> fact, ifact;\n\n\tcombination(int n) :fact(n + 1), ifact(n + 1) {\n\n\t\t//assert(n < MOD);\n\n\t\tfact[0] = 1;\n\n\t\tfor (int i = 1; i <= n; ++i) fact[i] = fact[i - 1] * i;\n\n\t\tifact[n] = fact[n].inv();\n\n\t\tfor (int i = n; i >= 1; --i) ifact[i - 1] = ifact[i] * i;\n\n\t}\n\n\tmint operator()(int n, int k) {\n\n\t\tif (k < 0 || k > n) return 0;\n\n\t\treturn fact[n] * ifact[k] * ifact[n - k];\n\n\t}\n\n}com(100010);\n\nstruct edge { ll to, cost; };\n\n\n\n\n\nll gcd(ll a, ll b) {\n\n\tif (a < b)swap(a, b);\n\n\tif (b == 0) return a;\n\n\tunsigned r;\n\n\twhile ((r = a % b)) {\n\n\t\ta = b;\n\n\t\tb = r;\n\n\t}\n\n\treturn b;\n\n}\n\nll lcm(ll a, ll b) {\n\n\tll g = gcd(a, b);\n\n\treturn a * b / g;\n\n}\n\nbool prime(ll n) {\n\n\tfor (ll i = 2; i <= sqrt(n); i++) {\n\n\t\tif (n%i == 0)return false;\n\n\t}\n\n\treturn n != 1;\n\n}\n\nmap<ll, ll> prime_factor(ll n) {\n\n\tmap<ll, ll> ret;\n\n\tfor (ll i = 2; i * i <= n; i++) {\n\n\t\twhile (n % i == 0) {\n\n\t\t\tret[i]++;\n\n\t\t\tn /= i;\n\n\t\t}\n\n\t}\n\n\tif (n != 1) ret[n] = 1;\n\n\treturn ret;\n\n}\n\nll modinv(ll a, ll m) {\n\n\tll b = m, u = 1, v = 0;\n\n\twhile (b) {\n\n\t\tll t = a / b;\n\n\t\ta -= t * b; swap(a, b);\n\n\t\tu -= t * v; swap(u, v);\n\n\t}\n\n\tu %= m;\n\n\tif (u < 0) u += m;\n\n\treturn u;\n\n}\n\nvector<pair<char, int>> RunLength(string s) {\n\n\tif (s.size() == 0)return {};\n\n\tvector<pair<char, int>>res(1, pair<char, int>(s[0], 0));\n\n\tfor (char p : s) {\n\n\t\tif (res.back().first == p) {\n\n\t\t\tres.back().second++;\n\n\t\t}\n\n\t\telse {\n\n\t\t\tres.emplace_back(p, 1);\n\n\t\t}\n\n\t}\n\n\treturn res;\n\n}\n\n// Digit Count\n\nint GetDigit(int num) {\n\n\treturn log10(num) + 1;\n\n}\n\n// bit calculation[how many \"1\"] (= __builtin_popcount())\n\nint bit_count(int n) {\n\n\tint cnt = 0;\n\n\twhile (n > 0) {\n\n\t\tif (n % 2 == 1)cnt++;\n\n\t\tn /= 2;\n\n\t}\n\n\treturn cnt;\n\n}\n\nmint POW(mint n, int p) {\n\n\tif (p == 0)return 1;\n\n\tif (p % 2 == 0) {\n\n\t\tmint t = POW(n, p / 2);\n\n\t\treturn t * t;\n\n\t}\n\n\treturn n * POW(n, p - 1);\n\n}\n\n#define ld long double\n\nconst int dx[6] = { -1,-1,0,1,1,0 };\n\nconst int dy[2][6] = { {-1,0,1,0,-1,-1},{0,1,1,1,0,-1} };\n\nint field[200][200];\n\nsigned main() {\n\n\tios_base::sync_with_stdio(0);\n\n\tcin.tie(0);\n\n\tcout.tie(0);\n\n\t//cout << fixed << setprecision(15);\n\n\tint a, b, c; cin >> a >> b >> c;\n\n\tif (a == b && b == c)cout << \"Yes\" << endl;\n\n\telse cout << \"No\" << endl;\n\n\treturn 0;\n\n\n\n}",
        "optimized_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <string>\n\n#include <vector>\n\n#include <algorithm>\n\n#include <functional>\n\n#include <iomanip>\n\n#include <stdlib.h>\n\n#include <string.h>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <map>\n\n#include <queue>\n\n#include <deque>\n\n#include <stack>\n\n#include <set>\n\n#include <stdio.h>\n\n#include <tuple>\n\n#include <bitset>\n\n#include <cfloat>\n\n#include <fstream>\n\n#include <limits.h>\n\n#include <list>\n\n#include <math.h>\n\n#include <random>\n\n#include <unordered_map>\n\n#include <unordered_set>\n\n#include <bitset>\n\n#include <numeric>\n\n#include <utility>\n\n#include <sstream>\n\n#include <cassert>\n\n\n\ntemplate<class T> inline bool chmin(T& a, T b) {\n\n\tif (a > b) {\n\n\t\ta = b;\n\n\t\treturn true;\n\n\t}\n\n\treturn false;\n\n}\n\ntemplate<class T> inline bool chmax(T& a, T b) {\n\n\tif (a < b) {\n\n\t\ta = b;\n\n\t\treturn true;\n\n\t}\n\n\treturn false;\n\n}\n\n\n\nusing namespace std;\n\n#define int long long\n\n#define ll long long\n\n#define rep(i, n) for (ll i = 0; i < (n); i++)\n\n#define P pair<ll, ll>\n\n#define sz(x) (ll)x.size()\n\n#define ALL(x) (x).begin(),(x).end()\n\n#define ALLR(x) (x).rbegin(),(x).rend()\n\n#define VE vector<ll>\n\n#define COUT(x) cout<<(x)<<endl\n\n#define MA map<ll,ll>\n\n#define SE set<ll>\n\n#define PQ priority_queue<ll>\n\n#define PQR priority_queue<ll,VE,greater<ll>>\n\n#define COUT(x) cout<<(x)<<endl\n\n#define YES(n) cout << ((n) ? \"YES\" : \"NO\"  ) << endl\n\n#define Yes(n) cout << ((n) ? \"Yes\" : \"No\"  ) << endl\n\n#define EPS (1e-10)\n\n#define pb push_back\n\n\n\nconst long long MOD = 1000000007;\n\n//const long long MOD = 998244353;\n\nconst long long INF = 1LL << 60;\n\nconst double PI = acos(-1.0);\n\nusing Graph = vector<VE>;\n\n\n\nstruct mint {\n\n\tll x; // typedef long long ll;\n\n\tmint(ll x = 0) :x((x%MOD + MOD) % MOD) {}\n\n\tmint operator-() const { return mint(-x); }\n\n\tmint& operator+=(const mint a) {\n\n\t\tif ((x += a.x) >= MOD) x -= MOD;\n\n\t\treturn *this;\n\n\t}\n\n\tmint& operator-=(const mint a) {\n\n\t\tif ((x += MOD - a.x) >= MOD) x -= MOD;\n\n\t\treturn *this;\n\n\t}\n\n\tmint& operator*=(const mint a) {\n\n\t\t(x *= a.x) %= MOD;\n\n\t\treturn *this;\n\n\t}\n\n\tmint operator+(const mint a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res += a;\n\n\t}\n\n\tmint operator-(const mint a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res -= a;\n\n\t}\n\n\tmint operator*(const mint a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res *= a;\n\n\t}\n\n\tmint pow(ll t) const {\n\n\t\tif (!t) return 1;\n\n\t\tmint a = pow(t >> 1);\n\n\t\ta *= a;\n\n\t\tif (t & 1) a *= *this;\n\n\t\treturn a;\n\n\t}\n\n\n\n\t// for prime MOD\n\n\tmint inv() const {\n\n\t\treturn pow(MOD - 2);\n\n\t}\n\n\tmint& operator/=(const mint a) {\n\n\t\treturn (*this) *= a.inv();\n\n\t}\n\n\tmint operator/(const mint a) const {\n\n\t\tmint res(*this);\n\n\t\treturn res /= a;\n\n\t}\n\n};\n\nstruct combination {\n\n\tvector<mint> fact, ifact;\n\n\tcombination(int n) :fact(n + 1), ifact(n + 1) {\n\n\t\t//assert(n < MOD);\n\n\t\tfact[0] = 1;\n\n\t\tfor (int i = 1; i <= n; ++i) fact[i] = fact[i - 1] * i;\n\n\t\tifact[n] = fact[n].inv();\n\n\t\tfor (int i = n; i >= 1; --i) ifact[i - 1] = ifact[i] * i;\n\n\t}\n\n\tmint operator()(int n, int k) {\n\n\t\tif (k < 0 || k > n) return 0;\n\n\t\treturn fact[n] * ifact[k] * ifact[n - k];\n\n\t}\n\n}com(10);\n\nstruct edge { ll to, cost; };\n\nstruct Sieve {\n\n\tint n;\n\n\tvector<int> f, primes;\n\n\t// n\u4ee5\u4e0b\u306e\u7d20\u6570\u3092\u5217\u6319\u3059\u308b\n\n\tSieve(int n = 1) :n(n), f(n + 1) {\n\n\t\tf[0] = f[1] = -1;\n\n\t\tfor (ll i = 2; i <= n; ++i) {\n\n\t\t\tif (f[i]) continue;\n\n\t\t\tprimes.push_back(i);\n\n\t\t\tf[i] = i;\n\n\t\t\tfor (ll j = i * i; j <= n; j += i) {\n\n\t\t\t\tif (!f[j]) f[j] = i;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// x\u304c\u7d20\u6570\u304b\u3069\u3046\u304b\u5224\u5b9a\u3059\u308b\n\n\tbool isPrime(int x) { return f[x] == x; }\n\n\t// \u7d20\u56e0\u6570\u3092\u5168\u5217\u6319\n\n\tvector<int> factorList(int x) {\n\n\t\tvector<int> res;\n\n\t\twhile (x != 1) {\n\n\t\t\tres.push_back(f[x]);\n\n\t\t\tx /= f[x];\n\n\t\t}\n\n\t\treturn res;\n\n\t}\n\n\t// \u30e9\u30f3\u30ec\u30f3\u30b0\u30b9\u5727\u7e2e\n\n\tvector<P> factor(int x) {\n\n\t\tvector<int> fl = factorList(x);\n\n\t\tif (fl.size() == 0) return {};\n\n\t\tvector<P> res(1, P(fl[0], 0));\n\n\t\tfor (int p : fl) {\n\n\t\t\tif (res.back().first == p) {\n\n\t\t\t\tres.back().second++;\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tres.emplace_back(p, 1);\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn res;\n\n\t}\n\n};\n\nclass UnionFind {\n\npublic:\n\n\tvector <ll> par; // \u5404\u5143\u306e\u89aa\u3092\u8868\u3059\u914d\u5217\n\n\tvector <ll> siz; // \u7d20\u96c6\u5408\u306e\u30b5\u30a4\u30ba\u3092\u8868\u3059\u914d\u5217(1 \u3067\u521d\u671f\u5316)\n\n\n\n\t// Constructor\n\n\tUnionFind(ll sz_) : par(sz_), siz(sz_, 1) {\n\n\t\tfor (ll i = 0; i < sz_; ++i) par[i] = i; // \u521d\u671f\u3067\u306f\u89aa\u306f\u81ea\u5206\u81ea\u8eab\n\n\t}\n\n\tvoid init(ll sz_) {\n\n\t\tpar.resize(sz_);\n\n\t\tsiz.resize(sz_, 1);\n\n\t\tfor (ll i = 0; i < sz_; ++i) par[i] = i; // \u521d\u671f\u3067\u306f\u89aa\u306f\u81ea\u5206\u81ea\u8eab\n\n\t}\n\n\n\n\t// Member Function\n\n\t// Find\n\n\tll root(ll x) { // \u6839\u306e\u691c\u7d22\n\n\t\twhile (par[x] != x) {\n\n\t\t\tx = par[x] = par[par[x]]; // x \u306e\u89aa\u306e\u89aa\u3092 x \u306e\u89aa\u3068\u3059\u308b\n\n\t\t}\n\n\t\treturn x;\n\n\t}\n\n\n\n\t// Union(Unite, Merge)\n\n\tbool merge(ll x, ll y) {\n\n\t\tx = root(x);\n\n\t\ty = root(y);\n\n\t\tif (x == y) return false;\n\n\t\t// merge technique\uff08\u30c7\u30fc\u30bf\u69cb\u9020\u3092\u30de\u30fc\u30b8\u3059\u308b\u30c6\u30af\uff0e\u5c0f\u3092\u5927\u306b\u304f\u3063\u3064\u3051\u308b\uff09\n\n\t\tif (siz[x] < siz[y]) swap(x, y);\n\n\t\tsiz[x] += siz[y];\n\n\t\tpar[y] = x;\n\n\t\treturn true;\n\n\t}\n\n\n\n\tbool issame(ll x, ll y) { // \u9023\u7d50\u5224\u5b9a\n\n\t\treturn root(x) == root(y);\n\n\t}\n\n\n\n\tll size(ll x) { // \u7d20\u96c6\u5408\u306e\u30b5\u30a4\u30ba\n\n\t\treturn siz[root(x)];\n\n\t}\n\n};\n\n\n\nll gcd(ll a, ll b) {\n\n\tif (a < b)swap(a, b);\n\n\tif (b == 0) return a;\n\n\tunsigned r;\n\n\twhile ((r = a % b)) {\n\n\t\ta = b;\n\n\t\tb = r;\n\n\t}\n\n\treturn b;\n\n}\n\nll lcm(ll a, ll b) {\n\n\tll g = gcd(a, b);\n\n\treturn a * b / g;\n\n}\n\nbool prime(ll n) {\n\n\tfor (ll i = 2; i <= sqrt(n); i++) {\n\n\t\tif (n%i == 0)return false;\n\n\t}\n\n\treturn n != 1;\n\n}\n\nmap<ll, ll> prime_factor(ll n) {\n\n\tmap<ll, ll> ret;\n\n\tfor (ll i = 2; i * i <= n; i++) {\n\n\t\twhile (n % i == 0) {\n\n\t\t\tret[i]++;\n\n\t\t\tn /= i;\n\n\t\t}\n\n\t}\n\n\tif (n != 1) ret[n] = 1;\n\n\treturn ret;\n\n}\n\nll modinv(ll a, ll m) {\n\n\tll b = m, u = 1, v = 0;\n\n\twhile (b) {\n\n\t\tll t = a / b;\n\n\t\ta -= t * b; swap(a, b);\n\n\t\tu -= t * v; swap(u, v);\n\n\t}\n\n\tu %= m;\n\n\tif (u < 0) u += m;\n\n\treturn u;\n\n}\n\nvector<pair<char, int>> RunLength(string s) {\n\n\tif (s.size() == 0)return {};\n\n\tvector<pair<char, int>>res(1, pair<char, int>(s[0], 0));\n\n\tfor (char p : s) {\n\n\t\tif (res.back().first == p) {\n\n\t\t\tres.back().second++;\n\n\t\t}\n\n\t\telse {\n\n\t\t\tres.emplace_back(p, 1);\n\n\t\t}\n\n\t}\n\n\treturn res;\n\n}\n\n// Digit Count\n\nint GetDigit(int num) {\n\n\treturn log10(num) + 1;\n\n}\n\n// bit calculation[how many \"1\"] (= __builtin_popcount())\n\nint bit_count(int n) {\n\n\tint cnt = 0;\n\n\twhile (n > 0) {\n\n\t\tif (n % 2 == 1)cnt++;\n\n\t\tn /= 2;\n\n\t}\n\n\treturn cnt;\n\n}\n\nmint POW(mint n, int p) {\n\n\tif (p == 0)return 1;\n\n\tif (p % 2 == 0) {\n\n\t\tmint t = POW(n, p / 2);\n\n\t\treturn t * t;\n\n\t}\n\n\treturn n * POW(n, p - 1);\n\n}\n\n#define ld long double\n\n\n\nconst int dx[4] = { 1,0,-1,0 };\n\nconst int dy[4] = { 0,1,0,-1 };\n\n\n\n\n\n\n\nsigned main() {\n\n\tios_base::sync_with_stdio(0);\n\n\tcin.tie(0);\n\n\tcout.tie(0);\n\n\t//cout << fixed << setprecision(15);\n\n\tint a, b, c; cin >> a >> b >> c;\n\n\tYes(a == b && b == c);\n\n\treturn 0;\n\n\n\n}"
    },
    {
        "id": "702",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <cstdlib>\n\n#include <algorithm>\n\n#include <set>\n\n#include <map>\n\n#define INF 0x3f3f3f3f\n\nusing namespace std;\n\nchar ka[734567];\n\nstruct node\n\n{\n\n    char a;\n\n    struct node * next;\n\n    struct node * rnext;\n\n};\n\nint main()\n\n{\n\n    scanf(\"%s\", ka);\n\n    struct node *head = (struct node*)malloc(sizeof(struct node));\n\n    head->next = head->rnext = NULL;\n\n    struct node *tail = (struct node*)malloc(sizeof(struct node));\n\n    tail = head;\n\n    for(int i=0; ka[i]; i++)\n\n    {\n\n        struct node *p = (struct node *)malloc(sizeof(struct node));\n\n        p->a = ka[i];\n\n        p->next = NULL;\n\n        p->rnext = tail;\n\n        tail->next = p;\n\n        tail = p;\n\n    }\n\n    int num = 0;\n\n    int f = 0;\n\n    while(1)\n\n    {\n\n        if(head->next == tail)\n\n        {\n\n            f = 1;\n\n            break;\n\n        }\n\n        else\n\n        {\n\n            struct node * p = head->next;\n\n            while(p)\n\n            {\n\n                if(p==head->next)\n\n                    p = p->next;\n\n                if(p->next!=NULL)\n\n                {\n\n                    if(p->rnext->a!=p->next->a)\n\n                    {\n\n                        p->rnext->next = p->next;\n\n                        p->next->rnext = p->rnext;\n\n                        num++;\n\n                        free(p);\n\n                        break;\n\n                    }\n\n                    else\n\n                        p = p->next;\n\n                }\n\n                else\n\n                {\n\n                    f = 1;\n\n                    break;\n\n                }\n\n            }\n\n            if(f)\n\n                break;\n\n        }\n\n    }\n\n    if(num%2)\n\n        printf(\"First\\n\");\n\n    else\n\n        printf(\"Second\\n\");\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <string.h>\n\n#include <stdio.h>\n\n#include <stdlib.h>\n\nusing namespace std;\n\nstruct node\n\n{\n\n    char data;\n\n    struct node *next, *last;\n\n};\n\nchar ch[100100];\n\nint main()\n\n{\n\n    scanf(\"%s\",ch);\n\n   int len=strlen(ch);\n\n   struct node *head,*tail;\n\n   head=(struct node *)malloc(sizeof(struct node ));\n\n   head->data='0';\n\n   head->next=NULL;\n\n   head->last=NULL;\n\n   tail=head;\n\n   struct node *p;\n\n   for(int i=0;i<len;i++)\n\n   {\n\n       p=(struct node *)malloc(sizeof(struct node ));\n\n       p->next=NULL;\n\n       p->last=NULL;\n\n       p->data=ch[i];\n\n       tail->next=p;\n\n       p->last=tail;\n\n       tail=p;\n\n   }\n\n   p=head->next->next;\n\n   int k=0;\n\n   while(p->next&&p)\n\n   {\n\n       if(p==head)\n\n       {\n\n           p=p->next->next;\n\n           if(p==tail)\n\n           {\n\n               break;\n\n           }\n\n       }\n\n       if(p==head->next)\n\n       {\n\n           p=p->next;\n\n           if(p==tail)\n\n           {\n\n               break;\n\n           }\n\n       }\n\n       if(p->last->data!=p->next->data)\n\n       {\n\n           struct node *z=(struct node *)malloc(sizeof(struct node));\n\n           z=p->next;\n\n           struct node *zz=(struct node *)malloc(sizeof(struct node ));\n\n           zz=p->last;\n\n           zz->next=z;\n\n           z->last=zz;\n\n           p=zz->last;\n\n           k++;\n\n       }\n\n       if(p==tail)\n\n       {\n\n           break;\n\n       }\n\n       p=p->next;\n\n   }\n\n   if(k%2==1)\n\n   {\n\n       printf(\"First\\n\");\n\n   }\n\n   else\n\n   {\n\n       printf(\"Second\\n\");\n\n   }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "703",
        "source_code": "#include <iostream>\n\n#include <string.h>\n\n#include <stdio.h>\n\n#include <queue>\n\n#include <vector>\n\n#include <algorithm>\n\nusing namespace std;\n\nconst int Max=3e5+100;\n\nchar str[Max];\n\nint main(){\n\n    scanf(\"%s\", str);\n\n    int len=strlen(str);\n\n    if(str[len-1]!=str[0]){\n\n        if(len%2)printf(\"First\\n\");\n\n        else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n        int num=0, ans=0;\n\n        char pos=str[0];\n\n        for(int a=0; a<len; a++){\n\n            if(str[a]==pos)ans+=max(0, num-1), num=0;\n\n            else num++;\n\n        }\n\n        //printf(\"%d\\n\", ans);\n\n        if(ans%2==0)printf(\"Second\\n\");\n\n        else printf(\"First\\n\");\n\n    }\n\n    return 0;\n\n}",
        "optimized_code": "#include <string.h>\n\n#include <stdio.h>\n\n#include <stdlib.h>\n\nusing namespace std;\n\nstruct node\n\n{\n\n    char data;\n\n    struct node *next, *last;\n\n};\n\nchar ch[100100];\n\nint main()\n\n{\n\n    scanf(\"%s\",ch);\n\n   int len=strlen(ch);\n\n   struct node *head,*tail;\n\n   head=(struct node *)malloc(sizeof(struct node ));\n\n   head->data='0';\n\n   head->next=NULL;\n\n   head->last=NULL;\n\n   tail=head;\n\n   struct node *p;\n\n   for(int i=0;i<len;i++)\n\n   {\n\n       p=(struct node *)malloc(sizeof(struct node ));\n\n       p->next=NULL;\n\n       p->last=NULL;\n\n       p->data=ch[i];\n\n       tail->next=p;\n\n       p->last=tail;\n\n       tail=p;\n\n   }\n\n   p=head->next->next;\n\n   int k=0;\n\n   while(p->next&&p)\n\n   {\n\n       if(p==head)\n\n       {\n\n           p=p->next->next;\n\n           if(p==tail)\n\n           {\n\n               break;\n\n           }\n\n       }\n\n       if(p==head->next)\n\n       {\n\n           p=p->next;\n\n           if(p==tail)\n\n           {\n\n               break;\n\n           }\n\n       }\n\n       if(p->last->data!=p->next->data)\n\n       {\n\n           struct node *z=(struct node *)malloc(sizeof(struct node));\n\n           z=p->next;\n\n           struct node *zz=(struct node *)malloc(sizeof(struct node ));\n\n           zz=p->last;\n\n           zz->next=z;\n\n           z->last=zz;\n\n           p=zz->last;\n\n           k++;\n\n       }\n\n       if(p==tail)\n\n       {\n\n           break;\n\n       }\n\n       p=p->next;\n\n   }\n\n   if(k%2==1)\n\n   {\n\n       printf(\"First\\n\");\n\n   }\n\n   else\n\n   {\n\n       printf(\"Second\\n\");\n\n   }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "704",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    string s;\n\n    int buc[30] = {};\n\n    cin >> s;\n\n    for (int i = 0; i < s.size(); i++)\n\n        buc[s[i] - '0']++;\n\n    int cnt = 0;\n\n    for (int i = 0; i < 30; i++)\n\n        if (buc[i])\n\n            cnt++;\n\n    if (cnt == 2)\n\n        cout << \"Second\" << endl;\n\n    else\n\n    {\n\n        if (s[0] == s[s.size() - 1])\n\n            cout << (s.size() % 2 ? \"Second\" : \"First\") << endl;\n\n        else\n\n            cout << (s.size() % 2 ? \"First\" : \"Second\") << endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <string.h>\n\n#include <stdio.h>\n\n#include <stdlib.h>\n\nusing namespace std;\n\nstruct node\n\n{\n\n    char data;\n\n    struct node *next, *last;\n\n};\n\nchar ch[100100];\n\nint main()\n\n{\n\n    scanf(\"%s\",ch);\n\n   int len=strlen(ch);\n\n   struct node *head,*tail;\n\n   head=(struct node *)malloc(sizeof(struct node ));\n\n   head->data='0';\n\n   head->next=NULL;\n\n   head->last=NULL;\n\n   tail=head;\n\n   struct node *p;\n\n   for(int i=0;i<len;i++)\n\n   {\n\n       p=(struct node *)malloc(sizeof(struct node ));\n\n       p->next=NULL;\n\n       p->last=NULL;\n\n       p->data=ch[i];\n\n       tail->next=p;\n\n       p->last=tail;\n\n       tail=p;\n\n   }\n\n   p=head->next->next;\n\n   int k=0;\n\n   while(p->next&&p)\n\n   {\n\n       if(p==head)\n\n       {\n\n           p=p->next->next;\n\n           if(p==tail)\n\n           {\n\n               break;\n\n           }\n\n       }\n\n       if(p==head->next)\n\n       {\n\n           p=p->next;\n\n           if(p==tail)\n\n           {\n\n               break;\n\n           }\n\n       }\n\n       if(p->last->data!=p->next->data)\n\n       {\n\n           struct node *z=(struct node *)malloc(sizeof(struct node));\n\n           z=p->next;\n\n           struct node *zz=(struct node *)malloc(sizeof(struct node ));\n\n           zz=p->last;\n\n           zz->next=z;\n\n           z->last=zz;\n\n           p=zz->last;\n\n           k++;\n\n       }\n\n       if(p==tail)\n\n       {\n\n           break;\n\n       }\n\n       p=p->next;\n\n   }\n\n   if(k%2==1)\n\n   {\n\n       printf(\"First\\n\");\n\n   }\n\n   else\n\n   {\n\n       printf(\"Second\\n\");\n\n   }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "705",
        "source_code": "#include <bits/stdc++.h>\n\n#define N 200010\n\n\n\nusing namespace std;\n\n\n\nchar str[N];\n\nbool ok;\n\n\n\nint main()\n\n{\n\n    scanf(\"%s\",str);\n\n    int len=strlen(str);\n\n    int i;\n\n    ok=true;\n\n    for(i=0;i<len-2;i++)\n\n    {\n\n        if(str[i]!=str[i+2])ok=false;\n\n    }\n\n    if(!ok)\n\n    {\n\n        if(str[0]==str[len-1])--len;\n\n        if(len%2==1)ok=false;\n\n        else ok=true;\n\n    }\n\n    if(!ok)printf(\"First\\n\");\n\n    else printf(\"Second\\n\");\n\n}\n",
        "optimized_code": "#include <string.h>\n\n#include <stdio.h>\n\n#include <stdlib.h>\n\nusing namespace std;\n\nstruct node\n\n{\n\n    char data;\n\n    struct node *next, *last;\n\n};\n\nchar ch[100100];\n\nint main()\n\n{\n\n    scanf(\"%s\",ch);\n\n   int len=strlen(ch);\n\n   struct node *head,*tail;\n\n   head=(struct node *)malloc(sizeof(struct node ));\n\n   head->data='0';\n\n   head->next=NULL;\n\n   head->last=NULL;\n\n   tail=head;\n\n   struct node *p;\n\n   for(int i=0;i<len;i++)\n\n   {\n\n       p=(struct node *)malloc(sizeof(struct node ));\n\n       p->next=NULL;\n\n       p->last=NULL;\n\n       p->data=ch[i];\n\n       tail->next=p;\n\n       p->last=tail;\n\n       tail=p;\n\n   }\n\n   p=head->next->next;\n\n   int k=0;\n\n   while(p->next&&p)\n\n   {\n\n       if(p==head)\n\n       {\n\n           p=p->next->next;\n\n           if(p==tail)\n\n           {\n\n               break;\n\n           }\n\n       }\n\n       if(p==head->next)\n\n       {\n\n           p=p->next;\n\n           if(p==tail)\n\n           {\n\n               break;\n\n           }\n\n       }\n\n       if(p->last->data!=p->next->data)\n\n       {\n\n           struct node *z=(struct node *)malloc(sizeof(struct node));\n\n           z=p->next;\n\n           struct node *zz=(struct node *)malloc(sizeof(struct node ));\n\n           zz=p->last;\n\n           zz->next=z;\n\n           z->last=zz;\n\n           p=zz->last;\n\n           k++;\n\n       }\n\n       if(p==tail)\n\n       {\n\n           break;\n\n       }\n\n       p=p->next;\n\n   }\n\n   if(k%2==1)\n\n   {\n\n       printf(\"First\\n\");\n\n   }\n\n   else\n\n   {\n\n       printf(\"Second\\n\");\n\n   }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "706",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    char s[100005];\n\n    scanf(\"%s\",s);\n\n    int n=strlen(s);\n\n    if(s[0]==s[n-1])\n\n        n--;\n\n    if(n&1)\n\n        printf(\"First\\n\");\n\n    else\n\n        printf(\"Second\\n\");\n\n}\n",
        "optimized_code": "#include <string.h>\n\n#include <stdio.h>\n\n#include <stdlib.h>\n\nusing namespace std;\n\nstruct node\n\n{\n\n    char data;\n\n    struct node *next, *last;\n\n};\n\nchar ch[100100];\n\nint main()\n\n{\n\n    scanf(\"%s\",ch);\n\n   int len=strlen(ch);\n\n   struct node *head,*tail;\n\n   head=(struct node *)malloc(sizeof(struct node ));\n\n   head->data='0';\n\n   head->next=NULL;\n\n   head->last=NULL;\n\n   tail=head;\n\n   struct node *p;\n\n   for(int i=0;i<len;i++)\n\n   {\n\n       p=(struct node *)malloc(sizeof(struct node ));\n\n       p->next=NULL;\n\n       p->last=NULL;\n\n       p->data=ch[i];\n\n       tail->next=p;\n\n       p->last=tail;\n\n       tail=p;\n\n   }\n\n   p=head->next->next;\n\n   int k=0;\n\n   while(p->next&&p)\n\n   {\n\n       if(p==head)\n\n       {\n\n           p=p->next->next;\n\n           if(p==tail)\n\n           {\n\n               break;\n\n           }\n\n       }\n\n       if(p==head->next)\n\n       {\n\n           p=p->next;\n\n           if(p==tail)\n\n           {\n\n               break;\n\n           }\n\n       }\n\n       if(p->last->data!=p->next->data)\n\n       {\n\n           struct node *z=(struct node *)malloc(sizeof(struct node));\n\n           z=p->next;\n\n           struct node *zz=(struct node *)malloc(sizeof(struct node ));\n\n           zz=p->last;\n\n           zz->next=z;\n\n           z->last=zz;\n\n           p=zz->last;\n\n           k++;\n\n       }\n\n       if(p==tail)\n\n       {\n\n           break;\n\n       }\n\n       p=p->next;\n\n   }\n\n   if(k%2==1)\n\n   {\n\n       printf(\"First\\n\");\n\n   }\n\n   else\n\n   {\n\n       printf(\"Second\\n\");\n\n   }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "707",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <cstdlib>\n\n#include <algorithm>\n\n#include <set>\n\n#include <map>\n\n#define INF 0x3f3f3f3f\n\nusing namespace std;\n\nchar ka[734567];\n\nstruct node\n\n{\n\n    char a;\n\n    struct node * next;\n\n    struct node * rnext;\n\n};\n\nint main()\n\n{\n\n    scanf(\"%s\", ka);\n\n    struct node *head = (struct node*)malloc(sizeof(struct node));\n\n    head->next = head->rnext = NULL;\n\n    struct node *tail = (struct node*)malloc(sizeof(struct node));\n\n    tail = head;\n\n    for(int i=0; ka[i]; i++)\n\n    {\n\n        struct node *p = (struct node *)malloc(sizeof(struct node));\n\n        p->a = ka[i];\n\n        p->next = NULL;\n\n        p->rnext = tail;\n\n        tail->next = p;\n\n        tail = p;\n\n    }\n\n    int num = 0;\n\n    int f = 0;\n\n    while(1)\n\n    {\n\n        if(head->next == tail)\n\n        {\n\n            f = 1;\n\n            break;\n\n        }\n\n        else\n\n        {\n\n            struct node * p = head->next;\n\n            while(p)\n\n            {\n\n                if(p==head->next)\n\n                    p = p->next;\n\n                if(p->next!=NULL)\n\n                {\n\n                    if(p->rnext->a!=p->next->a)\n\n                    {\n\n                        p->rnext->next = p->next;\n\n                        p->next->rnext = p->rnext;\n\n                        num++;\n\n                        free(p);\n\n                        break;\n\n                    }\n\n                    else\n\n                        p = p->next;\n\n                }\n\n                else\n\n                {\n\n                    f = 1;\n\n                    break;\n\n                }\n\n            }\n\n            if(f)\n\n                break;\n\n        }\n\n    }\n\n    if(num%2)\n\n        printf(\"First\\n\");\n\n    else\n\n        printf(\"Second\\n\");\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\nchar s[100005];\n\ninline int getstring(char *_s){\n\n\tint l=0;\n\n\tfor(char ch=getchar();ch!='\\n';ch=getchar(),l++)\n\n\t\t_s[l]=ch;\n\n\treturn l;\n\n}\n\nint main(){\n\n\tint l=getstring(s);\n\n\tprintf(\"%s\",(s[0]==s[l-1])^(l%2)?\"First\":\"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "708",
        "source_code": "#include <iostream>\n\n#include <string.h>\n\n#include <stdio.h>\n\n#include <queue>\n\n#include <vector>\n\n#include <algorithm>\n\nusing namespace std;\n\nconst int Max=3e5+100;\n\nchar str[Max];\n\nint main(){\n\n    scanf(\"%s\", str);\n\n    int len=strlen(str);\n\n    if(str[len-1]!=str[0]){\n\n        if(len%2)printf(\"First\\n\");\n\n        else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n        int num=0, ans=0;\n\n        char pos=str[0];\n\n        for(int a=0; a<len; a++){\n\n            if(str[a]==pos)ans+=max(0, num-1), num=0;\n\n            else num++;\n\n        }\n\n        //printf(\"%d\\n\", ans);\n\n        if(ans%2==0)printf(\"Second\\n\");\n\n        else printf(\"First\\n\");\n\n    }\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\nchar s[100005];\n\ninline int getstring(char *_s){\n\n\tint l=0;\n\n\tfor(char ch=getchar();ch!='\\n';ch=getchar(),l++)\n\n\t\t_s[l]=ch;\n\n\treturn l;\n\n}\n\nint main(){\n\n\tint l=getstring(s);\n\n\tprintf(\"%s\",(s[0]==s[l-1])^(l%2)?\"First\":\"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "709",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    string s;\n\n    int buc[30] = {};\n\n    cin >> s;\n\n    for (int i = 0; i < s.size(); i++)\n\n        buc[s[i] - '0']++;\n\n    int cnt = 0;\n\n    for (int i = 0; i < 30; i++)\n\n        if (buc[i])\n\n            cnt++;\n\n    if (cnt == 2)\n\n        cout << \"Second\" << endl;\n\n    else\n\n    {\n\n        if (s[0] == s[s.size() - 1])\n\n            cout << (s.size() % 2 ? \"Second\" : \"First\") << endl;\n\n        else\n\n            cout << (s.size() % 2 ? \"First\" : \"Second\") << endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\nchar s[100005];\n\ninline int getstring(char *_s){\n\n\tint l=0;\n\n\tfor(char ch=getchar();ch!='\\n';ch=getchar(),l++)\n\n\t\t_s[l]=ch;\n\n\treturn l;\n\n}\n\nint main(){\n\n\tint l=getstring(s);\n\n\tprintf(\"%s\",(s[0]==s[l-1])^(l%2)?\"First\":\"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "710",
        "source_code": "#include <bits/stdc++.h>\n\n#define N 200010\n\n\n\nusing namespace std;\n\n\n\nchar str[N];\n\nbool ok;\n\n\n\nint main()\n\n{\n\n    scanf(\"%s\",str);\n\n    int len=strlen(str);\n\n    int i;\n\n    ok=true;\n\n    for(i=0;i<len-2;i++)\n\n    {\n\n        if(str[i]!=str[i+2])ok=false;\n\n    }\n\n    if(!ok)\n\n    {\n\n        if(str[0]==str[len-1])--len;\n\n        if(len%2==1)ok=false;\n\n        else ok=true;\n\n    }\n\n    if(!ok)printf(\"First\\n\");\n\n    else printf(\"Second\\n\");\n\n}\n",
        "optimized_code": "#include <cstdio>\n\nchar s[100005];\n\ninline int getstring(char *_s){\n\n\tint l=0;\n\n\tfor(char ch=getchar();ch!='\\n';ch=getchar(),l++)\n\n\t\t_s[l]=ch;\n\n\treturn l;\n\n}\n\nint main(){\n\n\tint l=getstring(s);\n\n\tprintf(\"%s\",(s[0]==s[l-1])^(l%2)?\"First\":\"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "711",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n    char s[100005];\n\n    scanf(\"%s\",s);\n\n    int n=strlen(s);\n\n    if(s[0]==s[n-1])\n\n        n--;\n\n    if(n&1)\n\n        printf(\"First\\n\");\n\n    else\n\n        printf(\"Second\\n\");\n\n}\n",
        "optimized_code": "#include <cstdio>\n\nchar s[100005];\n\ninline int getstring(char *_s){\n\n\tint l=0;\n\n\tfor(char ch=getchar();ch!='\\n';ch=getchar(),l++)\n\n\t\t_s[l]=ch;\n\n\treturn l;\n\n}\n\nint main(){\n\n\tint l=getstring(s);\n\n\tprintf(\"%s\",(s[0]==s[l-1])^(l%2)?\"First\":\"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "712",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nusing VS = vector<string>;    using LL = long long;\n\nusing VI = vector<int>;       using VVI = vector<VI>;\n\nusing PII = pair<int, int>;   using PLL = pair<LL, LL>;\n\nusing VL = vector<LL>;        using VVL = vector<VL>;\n\n\n\n#define ALL(a)  begin((a)),end((a))\n\n#define RALL(a) (a).rbegin(), (a).rend()\n\n#define PB push_back\n\n#define EB emplace_back\n\n#define MP make_pair\n\n#define SZ(a) int((a).size())\n\n#define SORT(c) sort(ALL((c)))\n\n#define RSORT(c) sort(RALL((c)))\n\n#define UNIQ(c) (c).erase(unique(ALL((c))), end((c)))\n\n#define FOR(i, s, e) for (int(i) = (s); (i) < (e); (i)++)\n\n#define FORR(i, s, e) for (int(i) = (s); (i) > (e); (i)--)\n\n#define debug(x) cerr << #x << \": \" << x << endl\n\nconst int INF = 1e9;                          const LL LINF = 1e16;\n\nconst LL MOD = 1000000007;                    const double PI = acos(-1.0);\n\nint DX[8] = { 0, 0, 1, -1, 1, 1, -1, -1 };    int DY[8] = { 1, -1, 0, 0, 1, -1, 1, -1 };\n\n\n\n/* -----  2018/02/27  Problem: 064_arc_b / Link: https://abc048.contest.atcoder.jp/tasks/arc064_b?lang=en  ----- */\n\n/* ------\u554f\u984c------\n\n\n\n\u9577\u3055 3 \u4ee5\u4e0a\u306e\u6587\u5b57\u5217 s \u304c\u3042\u308a\u307e\u3059\u3002 s \u306e\u4e2d\u306b\u540c\u4e00\u306e\u6587\u5b57\u304c\u96a3\u308a\u5408\u3046\u7b87\u6240\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u9ad8\u6a4b\u541b\u3068\u9752\u6728\u541b\u304c\u30b2\u30fc\u30e0\u3067\u52dd\u8ca0\u3057\u307e\u3059\u3002 \u4e8c\u4eba\u306f\u4ea4\u4e92\u306b\u6b21\u306e\u64cd\u4f5c\u3092\u884c\u3044\u307e\u3059\u3002 \u9ad8\u6a4b\u541b\u304c\u5148\u624b\u3067\u3059\u3002\n\ns \u304b\u3089\u4e21\u7aef\u4ee5\u5916\u306e\u6587\u5b57\u3092\u3072\u3068\u3064\u53d6\u308a\u9664\u304f\u3002 \u305f\u3060\u3057\u3001\u305d\u306e\u6587\u5b57\u3092\u53d6\u308a\u9664\u304f\u3053\u3068\u3067\u3001s \u306e\u4e2d\u306b\u540c\u4e00\u306e\u6587\u5b57\u304c\u96a3\u308a\u5408\u3046\u7b87\u6240\u304c\u3067\u304d\u308b\u5834\u5408\u3001\u305d\u306e\u6587\u5b57\u3092\u53d6\u308a\u9664\u304f\u3053\u3068\u306f\u3067\u304d\u306a\u3044\u3002\n\n\u5148\u306b\u64cd\u4f5c\u3092\u884c\u3048\u306a\u304f\u306a\u3063\u305f\u4eba\u304c\u8ca0\u3051\u3067\u3059\u3002 \u4e8c\u4eba\u304c\u6700\u9069\u306b\u884c\u52d5\u3057\u305f\u3068\u304d\u3001\u3069\u3061\u3089\u304c\u52dd\u3064\u304b\u3092\u5224\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n\n-----\u554f\u984c\u3053\u3053\u307e\u3067----- */\n\n/* -----\u89e3\u8aac\u7b49-----\n\n\n\n\u7d42\u4e86\u6761\u4ef6\u306f\u7aef\u304c\u4e00\u7dd2\u3067\u6587\u5b57\u5217\u304c\u5947\u6570\u306e\u3068\u304d\n\n\u7aef\u304c\u7570\u306a\u3063\u3066\u6587\u5b57\u5217\u304c\u5076\u6570\u306e\u3068\u304d\n\n\u624b\u306b\u3088\u308c\u305a\u52dd\u3066\u305f\n\n\n\n----\u89e3\u8aac\u3053\u3053\u307e\u3067---- */\n\n\n\nLL N;\n\n\n\nLL ans = 0LL;\n\n\n\nint main() {\n\n\tcin.tie(0);\n\n\tios_base::sync_with_stdio(false);\n\n\n\n\tstring s;\n\n\tcin >> s;\n\n\tcout << ((s.front() == s.back())^(SZ(s)%2)?\"First\":\"Second\") << \"\\n\";\n\n\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\nchar s[100005];\n\ninline int getstring(char *_s){\n\n\tint l=0;\n\n\tfor(char ch=getchar();ch!='\\n';ch=getchar(),l++)\n\n\t\t_s[l]=ch;\n\n\treturn l;\n\n}\n\nint main(){\n\n\tint l=getstring(s);\n\n\tprintf(\"%s\",(s[0]==s[l-1])^(l%2)?\"First\":\"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "713",
        "source_code": "#include<iostream>\n\n#include<string.h>\n\n#define LL long long\n\nusing namespace std;\n\nconst int maxn=1e5+10;\n\nint n;\n\nchar a[maxn];\n\nint main()\n\n{\n\n    while(scanf(\"%s\",a)!=EOF)\n\n    {\n\n        int ans=0;\n\n        int len=strlen(a);\n\n        for(int i=1; i<len-1; i++)\n\n            if(a[i-1]!=a[i+1])\n\n\t\t\t ans++;\n\n        if(ans==0)\n\n        {\n\n            printf(\"Second\\n\");\n\n            continue;\n\n        }\n\n        if(a[0]!=a[len-1])\n\n\t\t  {\n\n\t\t    if(len%2==1)\n\n\t\t\tprintf(\"%s\\n\",\"First\");\n\n\t\t\telse\n\n\t\t\tprintf(\"%s\\n\",\"Second\");\n\n\t\t  \t\n\n\t\t  }\n\n\t  else if(len%2==1)\n\n\t\t\tprintf(\"%s\\n\",\"Second\");\n\n\t\t\telse\n\n\t\t\tprintf(\"%s\\n\",\"First\");\t\n\n    }\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\nchar s[100005];\n\ninline int getstring(char *_s){\n\n\tint l=0;\n\n\tfor(char ch=getchar();ch!='\\n';ch=getchar(),l++)\n\n\t\t_s[l]=ch;\n\n\treturn l;\n\n}\n\nint main(){\n\n\tint l=getstring(s);\n\n\tprintf(\"%s\",(s[0]==s[l-1])^(l%2)?\"First\":\"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "714",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar s[100001],ss[100001];\n\nint main()\n\n{    \n\n\tscanf(\"%s\",s+1);\n\n\tregister int sum=0,ans=0,l=strlen(s+1);\n\n\twhile(1)\n\n\t{\n\n\t\tfor(register int i=2;i<l;++i)\n\n\t\t{\n\n\t\t\tif(s[i]!='\\0')\n\n\t\t\t{\n\n\t\t\t\tregister int x=i-1;\n\n\t\t\t\twhile(s[x]=='\\0')\n\n\t\t\t\t\t--x;\n\n\t\t\t\tif(s[x]!=s[i+1])\n\n\t\t\t\t\ts[i]='\\0',++sum;\n\n            }        \n\n\t\t}        \n\n\t\tregister int cnt=0;\n\n\t\tfor(register int i=1;i<=l;++i)\n\n\t\t\tif(s[i]!='\\0')\n\n\t\t\t\tss[++cnt]=s[i];\n\n\t\tfor(register int i=1;i<=l;++i)\n\n\t\t\ts[i]=ss[i];\n\n\t\tl=cnt;\n\n\t\tif(sum==ans)\n\n\t\t\tbreak;\n\n\t\tans=sum;\n\n\t}    \n\n\tif(sum%2) return printf(\"First\"),0;\n\n\telse return printf(\"Second\"),0;\n\n} ",
        "optimized_code": "#include <cstdio>\n\nchar s[100005];\n\ninline int getstring(char *_s){\n\n\tint l=0;\n\n\tfor(char ch=getchar();ch!='\\n';ch=getchar(),l++)\n\n\t\t_s[l]=ch;\n\n\treturn l;\n\n}\n\nint main(){\n\n\tint l=getstring(s);\n\n\tprintf(\"%s\",(s[0]==s[l-1])^(l%2)?\"First\":\"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "715",
        "source_code": "#include <bits/stdc++.h>\n\n#define LL long long\n\nusing namespace std;\n\n\n\nconst int N=1e5+10;\n\nint len,Cnt;\n\nchar a[N];\n\n\n\nint main ()\n\n{\n\n\tscanf (\"%s\", a+1);\n\n\tlen=strlen (a+1);\n\n\tfor (int i=1;i<=len>>1;++i)\n\n\t\tif (a[i]!=a[len-i+1]) Cnt++;\n\n\tif (Cnt==0) {\n\n\t\tputs (\"Second\");\n\n\t\treturn 0;\n\n\t}\t\n\n\ta[1]==a[len]? (len & 1?puts (\"Second\") : puts (\"First\") ) : (len & 1?puts (\"First\") : puts (\"Second\") );\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\nchar s[100005];\n\ninline int getstring(char *_s){\n\n\tint l=0;\n\n\tfor(char ch=getchar();ch!='\\n';ch=getchar(),l++)\n\n\t\t_s[l]=ch;\n\n\treturn l;\n\n}\n\nint main(){\n\n\tint l=getstring(s);\n\n\tprintf(\"%s\",(s[0]==s[l-1])^(l%2)?\"First\":\"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "716",
        "source_code": "#include<iostream>\n\n#include<cstring>\n\nusing namespace std;\n\nint main()\n\n{\n\n   char m[100010];\n\n   int a,b;\n\n   while (cin>>m)\n\n    {\n\n       a=strlen(m);\n\n       if (m[0]==m[a-1])\n\n\t   b=a-3;\n\n       else \n\n\t   b=a-2;\n\n       if (b%2==1)\n\n\t   cout<<\"First\"<<endl;\n\n       else \n\n\t   cout<<\"Second\"<<endl;\n\n    }\n\n   return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nint n; char s[100010];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s); n=strlen(s);\n\n\tif(s[0]==s[n-1]) --n;\n\n\tputs(n%2 ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "717",
        "source_code": "#include<iostream>\n\n#include<algorithm> \n\n#include<string.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint b;\n\n\tstring s;\n\n\twhile(cin>>s)\n\n\t{\n\n\tint a=s.length();\n\n\tif(s[0]==s[a-1])\n\n\tb=a-3;\n\n\telse\n\n\tb=a-2;\n\n\tif(b%2)\n\n\tcout<<\"First\"<<endl;\n\n\telse\n\n\tcout<<\"Second\"<<endl;\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nint n; char s[100010];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s); n=strlen(s);\n\n\tif(s[0]==s[n-1]) --n;\n\n\tputs(n%2 ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "718",
        "source_code": "\n\n#include<iostream>\n\n#include<string.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tstring s;\n\n\tint t;\n\n\tcin>>s;\n\n\tt=s.size();\n\n\tif(s[0]==s[t-1])\n\n\t{\n\n\tif(t%2==0)\n\n\tcout<<\"First\"<<endl;\n\n\tif(t%2!=0)\n\n\tcout<<\"Second\"<<endl;\n\n\t}\n\n\telse \n\n\t{\n\n\t\tif(t%2==0) \n\n\t\tcout<<\"Second\"<<endl;\n\n\t\telse\n\n\t\tcout<<\"First\"<<endl;\n\n\t\t}\n\n\t\treturn 0;\n\n\t}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nint n; char s[100010];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s); n=strlen(s);\n\n\tif(s[0]==s[n-1]) --n;\n\n\tputs(n%2 ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "719",
        "source_code": "#include <iostream>\n\n#include <cstring>\n\nusing namespace std;\n\nint main(){\n\n  string s;\n\n  cin>>s;\n\n  if(s[0]==s[s.length()-1]){\n\n    if(s.length()%2==0)\n\n      cout<<\"First\"<<endl;\n\n    else cout<<\"Second\"<<endl;\n\n  }\n\n  else {\n\n    if(s.length()%2==0)\n\n      cout<<\"Second\"<<endl;\n\n    else cout<<\"First\"<<endl;\n\n  }\n\n  return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nint n; char s[100010];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s); n=strlen(s);\n\n\tif(s[0]==s[n-1]) --n;\n\n\tputs(n%2 ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "720",
        "source_code": "#include<cstring> \n\n#include<iostream> \n\nusing namespace std;\n\nint main()\n\n{\n\n\tint flag=0,count=0;\n\n\tchar a[100005];\n\n\tcin>>a;\n\n\t(a[0]==a[strlen(a)-1])?(flag=1):0;\n\n\tcount+=flag+strlen(a);\n\n\tcout<<((count&1)?\"First\":\"Second\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nint n; char s[100010];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s); n=strlen(s);\n\n\tif(s[0]==s[n-1]) --n;\n\n\tputs(n%2 ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "721",
        "source_code": "#include <cmath>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <iostream>\n\n#include <algorithm>\n\nusing namespace std;\n\nint num,num2;\n\nchar l,r,ch;\n\nint main()\n\n{\n\n\tl=getchar(); num=1;\n\n\twhile(ch=getchar(),ch<='z'&&ch>='a')\n\n\t{\n\n\t\tnum++;\n\n\t\tr=ch;\n\n\t}\n\n\tnum%=2;\n\n\tif(l==r) num2=1;\n\n\telse num2=0;\n\n\tif(num==num2) cout<<\"Second\";\n\n\telse cout<<\"First\";\n\n\t\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nint n; char s[100010];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s); n=strlen(s);\n\n\tif(s[0]==s[n-1]) --n;\n\n\tputs(n%2 ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "722",
        "source_code": "#include <iostream>\n\n#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nchar c[100005];\n\nint main()\n\n{\n\n    cin>>c;\n\n    int len=strlen(c);\n\n    if(c[0]==c[len-1])\n\n        len++;\n\n    if(len%2==0)\n\n        cout<<\"Second\"<<endl;\n\n    else\n\n    cout << \"First\" << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nint n; char s[100010];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s); n=strlen(s);\n\n\tif(s[0]==s[n-1]) --n;\n\n\tputs(n%2 ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "723",
        "source_code": "#include <algorithm>\n\n#include <bitset>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <vector>\n\n#define MP make_pair\n\n#define ls (o << 1)\n\n#define rs (o << 1 | 1)\n\n#define mid ((L + R) >> 1)\n\n#define eps (1e-5)\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst LL mod = 1e9 + 7;\n\nint n, m;\n\ntypedef pair<int, int> PII;\n\nchar s[100050];\n\nint main() {\n\n    scanf(\"%s\", s);\n\n    auto len = strlen(s);\n\n    if (s[0] != s[len - 1] && len % 2 == 0) {\n\n        puts(\"Second\");\n\n        return 0;\n\n    }\n\n    if (s[0] != s[len - 1] && len % 2 == 1) {\n\n        puts(\"First\");\n\n        return 0;\n\n    }\n\n    printf(\"%s\\n\", len & 1 ? \"Second\" : \"First\");\n\n    return 0;\n\n}\n\n//\u82cf\u5b50\u66f0\uff1a\u201c\u5ba2\u4ea6\u77e5\u592b\uff08f\u00fa\uff09\u6c34\u4e0e\u6708\u4e4e\uff1f\u901d\u8005\u5982\u65af[36]\uff0c\u800c\u672a\u5c1d\u5f80\u4e5f\uff1b\u76c8\u865a\u8005\u5982\u5f7c[37]\uff0c\u800c\u5352[38]\u83ab\u6d88\u957f(zh\u01ceng)\u4e5f\u3002\u76d6\u5c06\u81ea\u5176\u53d8\u8005\u800c\u89c2\u4e4b\uff0c\u5219\u5929\u5730\u66fe\uff08z\u0113ng\uff09\u4e0d\u80fd\u4ee5\u4e00\u77ac\uff1b\u81ea\u5176\u4e0d\u53d8\u8005\u800c\u89c2\u4e4b\uff0c\u5219\u7269\u4e0e\u6211\u7686\u65e0\u5c3d\u4e5f\uff0c\u800c\u53c8\u4f55\u7fa1\u4e4e\uff01\u4e14\u592b\uff08f\u00fa\uff09\u5929\u5730\u4e4b\u95f4\uff0c\u7269\u5404\u6709\u4e3b\uff0c\u82df\uff08g\u01d2u\uff09\u975e\u543e\u4e4b\u6240\u6709\uff0c\u867d\u4e00\u6beb\u800c\u83ab\u53d6\u3002\u60df\u6c5f\u4e0a\u4e4b\u6e05\u98ce\uff0c\u4e0e\u5c71\u95f4\u4e4b\u660e\u6708\uff0c\u8033\u5f97\u4e4b\u800c\u4e3a\u58f0\uff0c\u76ee\u9047\u4e4b\u800c\u6210\u8272\uff0c\u53d6\u4e4b\u65e0\u7981\uff0c\u7528\u4e4b\u4e0d\u7aed\uff0c\u662f\u9020\u7269\u8005\u4e4b\u65e0\u5c3d\u85cf[39]\uff08z\u00e0ng\uff09\u4e5f\uff0c\u800c\u543e\u4e0e\u5b50\u4e4b\u6240\u5171\u9002[40]\u3002\u201d\n\n//\u5ba2\u559c\u800c\u7b11\uff0c\u6d17\u76cf(zh\u01cen)\u66f4\uff08g\u0113ng\uff09\u914c[41]\uff08zhu\u00f3\uff09\u3002\u80b4\uff08y\u00e1o\uff09\u6838\u65e2\u5c3d[42]\uff0c\u676f\u76d8\u72fc\u7c4d\u3002\u76f8\u4e0e\u6795\u85c9[43]\uff08ji\u00e8\uff09\u4e4e\u821f\u4e2d\uff0c\u4e0d\u77e5\u4e1c\u65b9\u4e4b\u65e2\u767d[44]",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nint n; char s[100010];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s); n=strlen(s);\n\n\tif(s[0]==s[n-1]) --n;\n\n\tputs(n%2 ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "724",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[100010];\n\n    int ans,len;\n\n    scanf(\"%s\",s);len=strlen(s);\n\n    if (s[0]==s[len-1])\n\n    {\n\n        if (len & 1) ans=2;\n\n        else ans=1;\n\n    }\n\n    else\n\n    {\n\n        if (len & 1) ans=1;\n\n        else ans=2;\n\n    }\n\n    if (ans==1) cout<<\"First\"<<endl;\n\n    else cout<<\"Second\"<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nint n; char s[100010];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s); n=strlen(s);\n\n\tif(s[0]==s[n-1]) --n;\n\n\tputs(n%2 ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "725",
        "source_code": "#include <iostream>\n\n#include <cstring>\n\n#include <cstdio>\n\n#include <string>\n\nusing namespace std;\n\nstring s;\n\nint main(){\n\n\t\t//freopen(\"main.in\",\"r\",stdin);\n\n\t\tcin >> s;\n\n\t\tint len;\n\n\t\tif(s[0] == s[s.length()-1]) {\n\n\t\t\t\tlen = s.length() - 3;\n\n\t\t}\n\n\t\telse{\n\n\t\t\t\tlen = s.length() - 2;\n\n\t\t}\n\n\t\tif(len % 2){\n\n\t\t\t   \tcout << \"First\" << endl;\n\n\n\n\t\t}else {\n\n\t\t\t\tcout << \"Second\" << endl;\n\n\t\t}\n\n\t\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nint n; char s[100010];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s); n=strlen(s);\n\n\tif(s[0]==s[n-1]) --n;\n\n\tputs(n%2 ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "726",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar s[100010];\n\nint main(){\n\n\tscanf(\"%s\",s);\n\n\tint len=strlen(s);\n\n\tint ans=(s[0]==s[len-1])^(len%2);\n\n\tif(!ans)cout<<\"Second\"<<endl;\n\n\telse cout<<\"First\"<<endl;\n\n}\n\n\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nint n; char s[100010];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s); n=strlen(s);\n\n\tif(s[0]==s[n-1]) --n;\n\n\tputs(n%2 ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "727",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\nint main(){\n\n\tcin >> s;\n\n\tif(s[0] == s[s.length() - 1]){\n\n\t\tif(s.length() % 2)\n\n\t\t\tcout << \"Second\" << endl;\n\n\t\telse\n\n\t\t\tcout << \"First\" << endl;\n\n\t}else{\n\n\t\tif(s.length() % 2)\n\n\t\t\tcout << \"First\" << endl;\n\n\t\telse\n\n\t\t\tcout << \"Second\" << endl;\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nint n; char s[100010];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s); n=strlen(s);\n\n\tif(s[0]==s[n-1]) --n;\n\n\tputs(n%2 ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "728",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nchar st[100010];\n\n\n\nint main() {\n\n\tscanf(\"%s\", st);\n\n\tint l = strlen(st);\n\n\tif (st[0] == st[l-1]) {\n\n\t\tif (l % 2 == 1) {\n\n\t\t\tputs(\"Second\");\n\n\t\t} else {\n\n\t\t\tputs(\"First\");\n\n\t\t}\n\n\t} else {\n\n\t\tif (l % 2 == 1) {\n\n\t\t\tputs(\"First\");\n\n\t\t} else {\n\n\t\t\tputs(\"Second\");\n\n\t\t}\n\n\t}\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nint n; char s[100010];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s); n=strlen(s);\n\n\tif(s[0]==s[n-1]) --n;\n\n\tputs(n%2 ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "729",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nchar s[100010];\n\n\n\nint main(){\n\n    scanf(\"%s\",s);\n\n    int len = strlen(s);\n\n    if(s[0] == s[len-1]) len--;\n\n    if(len & 1) printf(\"First\");\n\n    else printf(\"Second\");\n\n\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nint n; char s[100010];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s); n=strlen(s);\n\n\tif(s[0]==s[n-1]) --n;\n\n\tputs(n%2 ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "730",
        "source_code": "#include<iostream>\n\n#include<cstring>\n\nusing namespace std;\n\nint main()\n\n{\n\n   char m[100010];\n\n   int a,b;\n\n   while (cin>>m)\n\n    {\n\n       a=strlen(m);\n\n       if (m[0]==m[a-1])\n\n\t   b=a-3;\n\n       else \n\n\t   b=a-2;\n\n       if (b%2==1)\n\n\t   cout<<\"First\"<<endl;\n\n       else \n\n\t   cout<<\"Second\"<<endl;\n\n    }\n\n   return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "731",
        "source_code": "#include<iostream>\n\n#include<algorithm> \n\n#include<string.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint b;\n\n\tstring s;\n\n\twhile(cin>>s)\n\n\t{\n\n\tint a=s.length();\n\n\tif(s[0]==s[a-1])\n\n\tb=a-3;\n\n\telse\n\n\tb=a-2;\n\n\tif(b%2)\n\n\tcout<<\"First\"<<endl;\n\n\telse\n\n\tcout<<\"Second\"<<endl;\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "732",
        "source_code": "\n\n#include<iostream>\n\n#include<string.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tstring s;\n\n\tint t;\n\n\tcin>>s;\n\n\tt=s.size();\n\n\tif(s[0]==s[t-1])\n\n\t{\n\n\tif(t%2==0)\n\n\tcout<<\"First\"<<endl;\n\n\tif(t%2!=0)\n\n\tcout<<\"Second\"<<endl;\n\n\t}\n\n\telse \n\n\t{\n\n\t\tif(t%2==0) \n\n\t\tcout<<\"Second\"<<endl;\n\n\t\telse\n\n\t\tcout<<\"First\"<<endl;\n\n\t\t}\n\n\t\treturn 0;\n\n\t}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "733",
        "source_code": "#include <iostream>\n\n#include <cstring>\n\nusing namespace std;\n\nint main(){\n\n  string s;\n\n  cin>>s;\n\n  if(s[0]==s[s.length()-1]){\n\n    if(s.length()%2==0)\n\n      cout<<\"First\"<<endl;\n\n    else cout<<\"Second\"<<endl;\n\n  }\n\n  else {\n\n    if(s.length()%2==0)\n\n      cout<<\"Second\"<<endl;\n\n    else cout<<\"First\"<<endl;\n\n  }\n\n  return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "734",
        "source_code": "#include<cstring> \n\n#include<iostream> \n\nusing namespace std;\n\nint main()\n\n{\n\n\tint flag=0,count=0;\n\n\tchar a[100005];\n\n\tcin>>a;\n\n\t(a[0]==a[strlen(a)-1])?(flag=1):0;\n\n\tcount+=flag+strlen(a);\n\n\tcout<<((count&1)?\"First\":\"Second\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "735",
        "source_code": "#include <cmath>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <iostream>\n\n#include <algorithm>\n\nusing namespace std;\n\nint num,num2;\n\nchar l,r,ch;\n\nint main()\n\n{\n\n\tl=getchar(); num=1;\n\n\twhile(ch=getchar(),ch<='z'&&ch>='a')\n\n\t{\n\n\t\tnum++;\n\n\t\tr=ch;\n\n\t}\n\n\tnum%=2;\n\n\tif(l==r) num2=1;\n\n\telse num2=0;\n\n\tif(num==num2) cout<<\"Second\";\n\n\telse cout<<\"First\";\n\n\t\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "736",
        "source_code": "#include <iostream>\n\n#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nchar c[100005];\n\nint main()\n\n{\n\n    cin>>c;\n\n    int len=strlen(c);\n\n    if(c[0]==c[len-1])\n\n        len++;\n\n    if(len%2==0)\n\n        cout<<\"Second\"<<endl;\n\n    else\n\n    cout << \"First\" << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "737",
        "source_code": "#include <algorithm>\n\n#include <bitset>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <vector>\n\n#define MP make_pair\n\n#define ls (o << 1)\n\n#define rs (o << 1 | 1)\n\n#define mid ((L + R) >> 1)\n\n#define eps (1e-5)\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst LL mod = 1e9 + 7;\n\nint n, m;\n\ntypedef pair<int, int> PII;\n\nchar s[100050];\n\nint main() {\n\n    scanf(\"%s\", s);\n\n    auto len = strlen(s);\n\n    if (s[0] != s[len - 1] && len % 2 == 0) {\n\n        puts(\"Second\");\n\n        return 0;\n\n    }\n\n    if (s[0] != s[len - 1] && len % 2 == 1) {\n\n        puts(\"First\");\n\n        return 0;\n\n    }\n\n    printf(\"%s\\n\", len & 1 ? \"Second\" : \"First\");\n\n    return 0;\n\n}\n\n//\u82cf\u5b50\u66f0\uff1a\u201c\u5ba2\u4ea6\u77e5\u592b\uff08f\u00fa\uff09\u6c34\u4e0e\u6708\u4e4e\uff1f\u901d\u8005\u5982\u65af[36]\uff0c\u800c\u672a\u5c1d\u5f80\u4e5f\uff1b\u76c8\u865a\u8005\u5982\u5f7c[37]\uff0c\u800c\u5352[38]\u83ab\u6d88\u957f(zh\u01ceng)\u4e5f\u3002\u76d6\u5c06\u81ea\u5176\u53d8\u8005\u800c\u89c2\u4e4b\uff0c\u5219\u5929\u5730\u66fe\uff08z\u0113ng\uff09\u4e0d\u80fd\u4ee5\u4e00\u77ac\uff1b\u81ea\u5176\u4e0d\u53d8\u8005\u800c\u89c2\u4e4b\uff0c\u5219\u7269\u4e0e\u6211\u7686\u65e0\u5c3d\u4e5f\uff0c\u800c\u53c8\u4f55\u7fa1\u4e4e\uff01\u4e14\u592b\uff08f\u00fa\uff09\u5929\u5730\u4e4b\u95f4\uff0c\u7269\u5404\u6709\u4e3b\uff0c\u82df\uff08g\u01d2u\uff09\u975e\u543e\u4e4b\u6240\u6709\uff0c\u867d\u4e00\u6beb\u800c\u83ab\u53d6\u3002\u60df\u6c5f\u4e0a\u4e4b\u6e05\u98ce\uff0c\u4e0e\u5c71\u95f4\u4e4b\u660e\u6708\uff0c\u8033\u5f97\u4e4b\u800c\u4e3a\u58f0\uff0c\u76ee\u9047\u4e4b\u800c\u6210\u8272\uff0c\u53d6\u4e4b\u65e0\u7981\uff0c\u7528\u4e4b\u4e0d\u7aed\uff0c\u662f\u9020\u7269\u8005\u4e4b\u65e0\u5c3d\u85cf[39]\uff08z\u00e0ng\uff09\u4e5f\uff0c\u800c\u543e\u4e0e\u5b50\u4e4b\u6240\u5171\u9002[40]\u3002\u201d\n\n//\u5ba2\u559c\u800c\u7b11\uff0c\u6d17\u76cf(zh\u01cen)\u66f4\uff08g\u0113ng\uff09\u914c[41]\uff08zhu\u00f3\uff09\u3002\u80b4\uff08y\u00e1o\uff09\u6838\u65e2\u5c3d[42]\uff0c\u676f\u76d8\u72fc\u7c4d\u3002\u76f8\u4e0e\u6795\u85c9[43]\uff08ji\u00e8\uff09\u4e4e\u821f\u4e2d\uff0c\u4e0d\u77e5\u4e1c\u65b9\u4e4b\u65e2\u767d[44]",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "738",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[100010];\n\n    int ans,len;\n\n    scanf(\"%s\",s);len=strlen(s);\n\n    if (s[0]==s[len-1])\n\n    {\n\n        if (len & 1) ans=2;\n\n        else ans=1;\n\n    }\n\n    else\n\n    {\n\n        if (len & 1) ans=1;\n\n        else ans=2;\n\n    }\n\n    if (ans==1) cout<<\"First\"<<endl;\n\n    else cout<<\"Second\"<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "739",
        "source_code": "#include <iostream>\n\n#include <cstring>\n\n#include <cstdio>\n\n#include <string>\n\nusing namespace std;\n\nstring s;\n\nint main(){\n\n\t\t//freopen(\"main.in\",\"r\",stdin);\n\n\t\tcin >> s;\n\n\t\tint len;\n\n\t\tif(s[0] == s[s.length()-1]) {\n\n\t\t\t\tlen = s.length() - 3;\n\n\t\t}\n\n\t\telse{\n\n\t\t\t\tlen = s.length() - 2;\n\n\t\t}\n\n\t\tif(len % 2){\n\n\t\t\t   \tcout << \"First\" << endl;\n\n\n\n\t\t}else {\n\n\t\t\t\tcout << \"Second\" << endl;\n\n\t\t}\n\n\t\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "740",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar s[100010];\n\nint main(){\n\n\tscanf(\"%s\",s);\n\n\tint len=strlen(s);\n\n\tint ans=(s[0]==s[len-1])^(len%2);\n\n\tif(!ans)cout<<\"Second\"<<endl;\n\n\telse cout<<\"First\"<<endl;\n\n}\n\n\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "741",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\nint main(){\n\n\tcin >> s;\n\n\tif(s[0] == s[s.length() - 1]){\n\n\t\tif(s.length() % 2)\n\n\t\t\tcout << \"Second\" << endl;\n\n\t\telse\n\n\t\t\tcout << \"First\" << endl;\n\n\t}else{\n\n\t\tif(s.length() % 2)\n\n\t\t\tcout << \"First\" << endl;\n\n\t\telse\n\n\t\t\tcout << \"Second\" << endl;\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "742",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nchar st[100010];\n\n\n\nint main() {\n\n\tscanf(\"%s\", st);\n\n\tint l = strlen(st);\n\n\tif (st[0] == st[l-1]) {\n\n\t\tif (l % 2 == 1) {\n\n\t\t\tputs(\"Second\");\n\n\t\t} else {\n\n\t\t\tputs(\"First\");\n\n\t\t}\n\n\t} else {\n\n\t\tif (l % 2 == 1) {\n\n\t\t\tputs(\"First\");\n\n\t\t} else {\n\n\t\t\tputs(\"Second\");\n\n\t\t}\n\n\t}\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "743",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nchar s[100010];\n\n\n\nint main(){\n\n    scanf(\"%s\",s);\n\n    int len = strlen(s);\n\n    if(s[0] == s[len-1]) len--;\n\n    if(len & 1) printf(\"First\");\n\n    else printf(\"Second\");\n\n\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "744",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\nint main() {\n\n  cin >> s;\n\n  int l = s.size();\n\n  if(s[0] == s[l-1]) {\n\n    if((l - 2) % 2)printf(\"Second\\n\");\n\n    else printf(\"First\\n\");\n\n  }\n\n  else {\n\n    if((l - 2) % 2) printf(\"First\\n\");\n\n    else printf(\"Second\\n\");\n\n  }\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "745",
        "source_code": "//#include <bits/stdc++.h>\n\n#include <stdio.h>\n\n#include <iostream>\n\n#include <string.h>\n\n#include <math.h>\n\n#include <stdlib.h>\n\n#include <limits.h>\n\n#include <algorithm>\n\n#include <queue>\n\n#include <vector>\n\n#include <set>\n\n#include <map>\n\n#include <stack>\n\n#include <bitset>\n\n#include <string>\n\n#include <time.h>\n\nusing namespace std;\n\nlong double esp=1e-11;\n\n//#pragma comment(linker, \"/STACK:1024000000,1024000000\")\n\n#define fi first\n\n#define se second\n\n#define all(a) (a).begin(),(a).end()\n\n#define cle(a) while(!a.empty())a.pop()\n\n#define mem(p,c) memset(p,c,sizeof(p))\n\n#define mp(A, B) make_pair(A, B)\n\n#define pb push_back\n\n#define lson l , m , rt << 1\n\n#define rson m + 1 , r , rt << 1 | 1\n\ntypedef long long int LL;\n\nconst long double PI = acos((long double)-1);\n\nconst LL INF=0x3f3f3f3f3f3f3f3fll;\n\nconst int MOD =1000000007ll;\n\nconst int maxn=210100;\n\nchar s[maxn];\n\nint main()\n\n{\n\n    //freopen(\"in9.txt\", \"r\", stdin);\n\n    //freopen(\"in9.txt\", \"r\", stdin);\n\n    //freopen(\"out9.txt\", \"w\", stdout);\n\n    //::iterator iter;                  %I64d\n\n    //for(int x=1;x<=n;x++)\n\n    //for(int y=1;y<=n;y++)\n\n    //scanf(\"%d\",&a);\n\n    //printf(\"%d\\n\",ans);\n\n    scanf(\"%s\",s);\n\n    int n=strlen(s);\n\n    int f=1;\n\n    for(int x=0;x<n-2;x++)\n\n        if(s[x]!=s[x+2])\n\n        {\n\n            f=0;\n\n            break;\n\n        }\n\n    if(f==1)\n\n    {\n\n        printf(\"Second\\n\");\n\n        return 0;\n\n    }\n\n    if(s[0]==s[n-1])n--;\n\n    if(n&1)printf(\"First\\n\");\n\n    else printf(\"Second\\n\");\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "746",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\nint l;\n\nint main() {\n\n\tcin>>s;\n\n\tl = s.length();\n\n\tif (s[0] == s[l - 1]) {\n\n\t\tif (l % 2 == 0) cout<<\"First\"; else cout<<\"Second\";\n\n\t} else {\n\n\t\tif (l % 2 == 0) cout<<\"Second\"; else cout<<\"First\";\n\n\t}\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "747",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nconst int maxn=1e5+7;\n\n\n\nchar s[maxn];\n\n\n\nint main()\n\n{\n\n\tint i,j;\n\n\tscanf(\"%s\",s);\n\n\tint n=strlen(s);\n\n\tif(n%2==0)\n\n\t{\n\n\t\tif(s[0]==s[n-1])\n\n\t\t  printf(\"First\");\n\n\t\telse printf(\"Second\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif(s[0]==s[n-1])\n\n\t\t  printf(\"Second\");\n\n\t\telse printf(\"First\");\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "748",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn=  1e5+10;\n\nchar s[maxn];\n\nint main (void) {\n\n    scanf (\"%s\", s);\n\n    int len = strlen (s);\n\n    if (s[0] == s[len-1]) len--;\n\n    if (len % 2 == 1) printf (\"First\\n\");\n\n    else printf (\"Second\\n\");\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#include <vector>\n\n#define ll long long\n\nusing namespace std;\n\nconst int maxn = 200010;\n\n\n\nchar s[maxn];\n\nint n, flag;\n\n\n\nint main () {\n\n\tscanf (\"%s\", s);\n\n\tn = strlen(s);\n\n\tif (s[0] == s[n-1]) {\n\n        if (n&1) flag = true;\n\n\t} else {\n\n\t\tif(n&1);\n\n\t\telse flag = true;\n\n\t}\n\n\n\n\tif (flag) puts (\"Second\");\n\n\telse puts (\"First\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "749",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cstdio>\n\n#include <string.h>\n\n#include <cmath>\n\n#include <cstdlib>\n\n#include <map>\n\nusing namespace std;\n\n\n\nconst int INF = 1 << 30;\n\nconst int maxn = 100000 + 10;\n\nchar arr[maxn];\n\nint book[maxn];\n\n\n\nint main()\n\n{\n\n    //freopen(\"in\", \"r\", stdin);\n\n    scanf(\"%s\", arr);\n\n    int len = strlen(arr), cnt = 0;\n\n    for (int i = 1; i < len - 1; i++)\n\n        if (arr[i] == arr[i - 1]);\n\n            cnt++;\n\n    if (arr[len - 1] == arr[0])\n\n        len -= 3;\n\n    else\n\n        len -= 2;\n\n\n\n    //printf(\"%d\\n\", cnt);\n\n    if (len % 2 == 0)\n\n        printf(\"Second\\n\");\n\n    else\n\n        printf(\"First\\n\");\n\n\n\n    return 0;\n\n}\n"
    },
    {
        "id": "750",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <string>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <vector>\n\n\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst ll mol=1000000007;\n\nconst int maxn=1000000;\n\nconst double PI=acos(-1.0);\n\nchar ch[maxn];\n\nint main()\n\n{\n\n#ifdef LOCAL\n\nfreopen(\"3.h\",\"r\",stdin);\n\n#endif\n\n    scanf(\"%s\",ch);\n\n    int len=strlen(ch);int num=0;\n\n    int dp1=0,dp2=0;\n\n    for(int i=1;i<len-1;i++)\n\n    if(ch[i+1]!=ch[i-1])num++;\n\n    /*for(int i=2;i<len-2;i++)\n\n    {\n\n        if(ch[i+1]!=ch[i-1])\n\n        {\n\n            if(ch[i-2]==ch[i]&&ch[i+2]==ch[i])dp1=1;\n\n            else if(ch[i-2]==ch[i+1]&&ch[i+2]==ch[i-1])dp1=1;\n\n            else if((ch[i-2]==ch[i]||ch[i+2]==ch[i])&&(ch[i-2]==ch[i+1]||ch[i+2]==ch[i-1]))dp2=1;\n\n            else dp1=1;\n\n        }\n\n    }\n\n    if((num%2)==0&&dp2==0)printf(\"Second\");\n\n    else printf(\"First\");*/\n\n    if(num==0)printf(\"Second\");\n\n    //else if(num==1)printf(\"First\");\n\n    else if(ch[0]==ch[len-1])\n\n    {\n\n        if(!(len%2))printf(\"First\");\n\n        else printf(\"Second\");\n\n    }\n\n    else\n\n    {\n\n        if(len%2)printf(\"First\");\n\n        else printf(\"Second\");\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "751",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#define bi\n\n#include <iostream>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<set>\n\n#include<map>\n\n#include<vector>\n\n#include<queue>\n\n#include<string>\n\n#define MP make_pair\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst ll maxn=1e5+10;\n\nconst ll mod=1e9+7;\n\nchar ch[maxn];\n\n\n\nint main()\n\n{\n\n#ifdef bibi\n\n    freopen(\"in.txt\",\"r\",stdin);\n\n#endif\n\n    ios::sync_with_stdio(false);\n\n    cin.tie(0);\n\n    cin>>ch;\n\n    ll len=strlen(ch);\n\n    if(ch[0]==ch[len-1])\n\n    {\n\n        if(len%2==0)\n\n            cout<<\"First\";\n\n        else\n\n            cout<<\"Second\";\n\n    }\n\n    else\n\n    {\n\n        if(len%2==0)\n\n            cout<<\"Second\";\n\n        else\n\n            cout<<\"First\";\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "752",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <assert.h>\n\n#define IOS ios::sync_with_stdio(false)\n\nusing namespace std;\n\n#define inf (0x3f3f3f3f)\n\ntypedef long long int LL;\n\n\n\n\n\n#include <iostream>\n\n#include <sstream>\n\n#include <vector>\n\n#include <set>\n\n#include <map>\n\n#include <queue>\n\n#include <string>\n\n#include <bitset>\n\n#include <list>\n\nlist<char>theList;\n\nconst int maxn = 1e5 + 20;\n\nchar str[maxn];\n\nvoid work() {\n\n    scanf(\"%s\", str + 1);\n\n    int lenstr = strlen(str + 1);\n\n    for (int i = 1; i <= lenstr; ++i) {\n\n        theList.push_back(str[i]);\n\n    }\n\n//    for (list<char> :: iterator it = theList.begin(); it != theList.end(); ++it) {\n\n//        cout << *it;\n\n//    }\n\n    int ans = 0;\n\n    while (theList.size() > 2) {\n\n        if (theList.size() == 3 && theList.front() == theList.back()) break;\n\n        list<char> :: iterator itBegin = theList.begin();\n\n        itBegin++;\n\n        list<char> :: iterator itEnd = theList.end();\n\n        itEnd--;\n\n        list<char> :: iterator itBeginPre = theList.begin();\n\n        list<char> :: iterator itBeginNext = itBegin; itBeginNext++;\n\n        bool flag = false;\n\n        while (itBegin != itEnd) {\n\n            if (*itBeginPre == *itBeginNext) {\n\n                itBeginPre++;\n\n                itBegin++;\n\n                itBeginNext++;\n\n            } else {\n\n                theList.erase(itBegin);\n\n                flag = true;\n\n                break;\n\n            }\n\n        }\n\n        if (!flag) break;\n\n        ans++;\n\n    }\n\n//    cout << ans << endl;\n\n    if (ans & 1) {\n\n        cout << \"First\" << endl;\n\n    } else cout << \"Second\" << endl;\n\n}\n\n\n\nint main() {\n\n#ifdef local\n\n    freopen(\"data.txt\", \"r\", stdin);\n\n//    freopen(\"data.txt\", \"w\", stdout);\n\n#endif\n\n    work();\n\n    return 0;\n\n}\n"
    },
    {
        "id": "753",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <assert.h>\n\n#define IOS ios::sync_with_stdio(false)\n\nusing namespace std;\n\n#define inf (0x3f3f3f3f)\n\ntypedef long long int LL;\n\n\n\n\n\n#include <iostream>\n\n#include <sstream>\n\n#include <vector>\n\n#include <set>\n\n#include <map>\n\n#include <queue>\n\n#include <string>\n\n#include <bitset>\n\n#include <list>\n\nlist<char>theList;\n\nconst int maxn = 1e5 + 20;\n\nchar str[maxn];\n\nvoid work() {\n\n    scanf(\"%s\", str + 1);\n\n    int lenstr = strlen(str + 1);\n\n    lenstr -= 2;\n\n    if (str[1] == str[strlen(str + 1)]) lenstr--;\n\n    if (lenstr & 1) {\n\n        cout << \"First\" << endl;\n\n    } else cout << \"Second\" << endl;\n\n}\n\n\n\nint main() {\n\n#ifdef local\n\n    freopen(\"data.txt\", \"r\", stdin);\n\n//    freopen(\"data.txt\", \"w\", stdout);\n\n#endif\n\n    work();\n\n    return 0;\n\n}\n"
    },
    {
        "id": "754",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <iostream>\n\n#include <cstring>\n\n#include <algorithm>\n\nusing namespace std;\n\nconst int maxn=1e5+10;\n\nchar str[maxn];\n\nint main()\n\n{\n\n   cin>>str;\n\n   int len=strlen(str);\n\n   if (str[0]==str[len-1]){\n\n       if (len&1){\n\n         cout<<\"Second\\n\";\n\n\n\n       }\n\n       else cout<<\"First\\n\";\n\n\n\n   }\n\n   else {\n\n      if (len&1){\n\n         cout<<\"First\\n\";\n\n      }\n\n      else cout<<\"Second\\n\";\n\n   }\n\n\n\n   return 0;\n\n}\n"
    },
    {
        "id": "755",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <stack>\n\n#include <queue>\n\n#include <vector>\n\n#include <map>\n\n#include <set>\n\nusing namespace std;\n\n#define ll long long\n\nchar s[300005];\n\n\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int l=strlen(s);\n\n    int x=l-2;\n\n    if(s[0]==s[l-1])\n\n    {\n\n        if(x%2==0) printf(\"First\");\n\n        else printf(\"Second\");\n\n    }\n\n    else\n\n    {\n\n        if(x%2==1) printf(\"First\");\n\n        else printf(\"Second\");\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "756",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<bits/stdc++.h>\n\n#define rep(i,j,k) for(int i=(j);i<(k);i++)\n\n#define mp make_pair\n\n#define sz(a) (int)(a).size()\n\n#define pb push_back\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int,int> pii;\n\ntypedef pair<double,double> pdd;\n\ntypedef long double ld;\n\n//----head----\n\nchar str[100005];\n\nint main()\n\n{\n\n\tscanf(\"%s\",str);\n\n\tint n=strlen(str);\n\n\tint ans=(str[0]==str[n-1]);\n\n\tans^=(n%2);\n\n\tputs(ans?\"First\":\"Second\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "757",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <iostream>\n\n#include <cstdlib>\n\n#include <algorithm>\n\n#include <cstdio>\n\n#include <cmath>\n\n#include <cstring>\n\n\n\nusing namespace std;\n\n\n\nchar s[100005];\n\n\n\nint main() {\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    if ((len&1)!=(s[0]==s[len-1])) printf(\"First\\n\"); else printf(\"Second\\n\");\n\n\n\n    return 0;\n\n}\n\n\n"
    },
    {
        "id": "758",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\nconst int maxn=1e5+5;\n\nchar a[maxn];\n\nint main()\n\n{\n\n    while(~scanf(\"%s\", a))\n\n    {\n\n        int len=strlen(a);\n\n        if(len&1)\n\n        {\n\n            if(a[0]==a[len-1])printf(\"Second\\n\");\n\n            else printf(\"First\\n\");\n\n        }\n\n        else\n\n        {\n\n            if(a[0]==a[len-1])printf(\"First\\n\");\n\n            else printf(\"Second\\n\");\n\n        }\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "759",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<bits/stdc++.h>\n\n\n\nusing namespace std;\n\nconst int N=112345;\n\n\n\nchar s[N];\n\n\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    set<char>S;\n\n    for(int i=0;i<=len-1;i++)\n\n        S.insert(s[i]);\n\n    if(S.size()>2)\n\n    {\n\n        if(s[0]==s[len-1])\n\n        {\n\n            if ((len - 3) % 2 == 0)printf(\"Second\\n\");\n\n            else printf(\"First\\n\");\n\n        }\n\n        else {\n\n            if ((len - 2) % 2 == 0)printf(\"Second\\n\");\n\n            else printf(\"First\\n\");\n\n        }\n\n    }\n\n    else if(S.size()==2)\n\n    {\n\n        printf(\"Second\\n\");\n\n    }\n\n    else if(S.size()==1)\n\n    {\n\n        printf(\"Second\\n\");\n\n    }\n\n    return 0;\n\n}"
    },
    {
        "id": "760",
        "source_code": "#include<iostream>\n\n#include<cstring>\n\nusing namespace std;\n\nint main()\n\n{\n\n   char m[100010];\n\n   int a,b;\n\n   while (cin>>m)\n\n    {\n\n       a=strlen(m);\n\n       if (m[0]==m[a-1])\n\n\t   b=a-3;\n\n       else \n\n\t   b=a-2;\n\n       if (b%2==1)\n\n\t   cout<<\"First\"<<endl;\n\n       else \n\n\t   cout<<\"Second\"<<endl;\n\n    }\n\n   return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "761",
        "source_code": "#include<iostream>\n\n#include<algorithm> \n\n#include<string.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint b;\n\n\tstring s;\n\n\twhile(cin>>s)\n\n\t{\n\n\tint a=s.length();\n\n\tif(s[0]==s[a-1])\n\n\tb=a-3;\n\n\telse\n\n\tb=a-2;\n\n\tif(b%2)\n\n\tcout<<\"First\"<<endl;\n\n\telse\n\n\tcout<<\"Second\"<<endl;\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "762",
        "source_code": "\n\n#include<iostream>\n\n#include<string.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tstring s;\n\n\tint t;\n\n\tcin>>s;\n\n\tt=s.size();\n\n\tif(s[0]==s[t-1])\n\n\t{\n\n\tif(t%2==0)\n\n\tcout<<\"First\"<<endl;\n\n\tif(t%2!=0)\n\n\tcout<<\"Second\"<<endl;\n\n\t}\n\n\telse \n\n\t{\n\n\t\tif(t%2==0) \n\n\t\tcout<<\"Second\"<<endl;\n\n\t\telse\n\n\t\tcout<<\"First\"<<endl;\n\n\t\t}\n\n\t\treturn 0;\n\n\t}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "763",
        "source_code": "#include <iostream>\n\n#include <cstring>\n\nusing namespace std;\n\nint main(){\n\n  string s;\n\n  cin>>s;\n\n  if(s[0]==s[s.length()-1]){\n\n    if(s.length()%2==0)\n\n      cout<<\"First\"<<endl;\n\n    else cout<<\"Second\"<<endl;\n\n  }\n\n  else {\n\n    if(s.length()%2==0)\n\n      cout<<\"Second\"<<endl;\n\n    else cout<<\"First\"<<endl;\n\n  }\n\n  return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "764",
        "source_code": "#include<cstring> \n\n#include<iostream> \n\nusing namespace std;\n\nint main()\n\n{\n\n\tint flag=0,count=0;\n\n\tchar a[100005];\n\n\tcin>>a;\n\n\t(a[0]==a[strlen(a)-1])?(flag=1):0;\n\n\tcount+=flag+strlen(a);\n\n\tcout<<((count&1)?\"First\":\"Second\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "765",
        "source_code": "#include <cmath>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <iostream>\n\n#include <algorithm>\n\nusing namespace std;\n\nint num,num2;\n\nchar l,r,ch;\n\nint main()\n\n{\n\n\tl=getchar(); num=1;\n\n\twhile(ch=getchar(),ch<='z'&&ch>='a')\n\n\t{\n\n\t\tnum++;\n\n\t\tr=ch;\n\n\t}\n\n\tnum%=2;\n\n\tif(l==r) num2=1;\n\n\telse num2=0;\n\n\tif(num==num2) cout<<\"Second\";\n\n\telse cout<<\"First\";\n\n\t\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "766",
        "source_code": "#include <iostream>\n\n#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nchar c[100005];\n\nint main()\n\n{\n\n    cin>>c;\n\n    int len=strlen(c);\n\n    if(c[0]==c[len-1])\n\n        len++;\n\n    if(len%2==0)\n\n        cout<<\"Second\"<<endl;\n\n    else\n\n    cout << \"First\" << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "767",
        "source_code": "#include <algorithm>\n\n#include <bitset>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <vector>\n\n#define MP make_pair\n\n#define ls (o << 1)\n\n#define rs (o << 1 | 1)\n\n#define mid ((L + R) >> 1)\n\n#define eps (1e-5)\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst LL mod = 1e9 + 7;\n\nint n, m;\n\ntypedef pair<int, int> PII;\n\nchar s[100050];\n\nint main() {\n\n    scanf(\"%s\", s);\n\n    auto len = strlen(s);\n\n    if (s[0] != s[len - 1] && len % 2 == 0) {\n\n        puts(\"Second\");\n\n        return 0;\n\n    }\n\n    if (s[0] != s[len - 1] && len % 2 == 1) {\n\n        puts(\"First\");\n\n        return 0;\n\n    }\n\n    printf(\"%s\\n\", len & 1 ? \"Second\" : \"First\");\n\n    return 0;\n\n}\n\n//\u82cf\u5b50\u66f0\uff1a\u201c\u5ba2\u4ea6\u77e5\u592b\uff08f\u00fa\uff09\u6c34\u4e0e\u6708\u4e4e\uff1f\u901d\u8005\u5982\u65af[36]\uff0c\u800c\u672a\u5c1d\u5f80\u4e5f\uff1b\u76c8\u865a\u8005\u5982\u5f7c[37]\uff0c\u800c\u5352[38]\u83ab\u6d88\u957f(zh\u01ceng)\u4e5f\u3002\u76d6\u5c06\u81ea\u5176\u53d8\u8005\u800c\u89c2\u4e4b\uff0c\u5219\u5929\u5730\u66fe\uff08z\u0113ng\uff09\u4e0d\u80fd\u4ee5\u4e00\u77ac\uff1b\u81ea\u5176\u4e0d\u53d8\u8005\u800c\u89c2\u4e4b\uff0c\u5219\u7269\u4e0e\u6211\u7686\u65e0\u5c3d\u4e5f\uff0c\u800c\u53c8\u4f55\u7fa1\u4e4e\uff01\u4e14\u592b\uff08f\u00fa\uff09\u5929\u5730\u4e4b\u95f4\uff0c\u7269\u5404\u6709\u4e3b\uff0c\u82df\uff08g\u01d2u\uff09\u975e\u543e\u4e4b\u6240\u6709\uff0c\u867d\u4e00\u6beb\u800c\u83ab\u53d6\u3002\u60df\u6c5f\u4e0a\u4e4b\u6e05\u98ce\uff0c\u4e0e\u5c71\u95f4\u4e4b\u660e\u6708\uff0c\u8033\u5f97\u4e4b\u800c\u4e3a\u58f0\uff0c\u76ee\u9047\u4e4b\u800c\u6210\u8272\uff0c\u53d6\u4e4b\u65e0\u7981\uff0c\u7528\u4e4b\u4e0d\u7aed\uff0c\u662f\u9020\u7269\u8005\u4e4b\u65e0\u5c3d\u85cf[39]\uff08z\u00e0ng\uff09\u4e5f\uff0c\u800c\u543e\u4e0e\u5b50\u4e4b\u6240\u5171\u9002[40]\u3002\u201d\n\n//\u5ba2\u559c\u800c\u7b11\uff0c\u6d17\u76cf(zh\u01cen)\u66f4\uff08g\u0113ng\uff09\u914c[41]\uff08zhu\u00f3\uff09\u3002\u80b4\uff08y\u00e1o\uff09\u6838\u65e2\u5c3d[42]\uff0c\u676f\u76d8\u72fc\u7c4d\u3002\u76f8\u4e0e\u6795\u85c9[43]\uff08ji\u00e8\uff09\u4e4e\u821f\u4e2d\uff0c\u4e0d\u77e5\u4e1c\u65b9\u4e4b\u65e2\u767d[44]",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "768",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[100010];\n\n    int ans,len;\n\n    scanf(\"%s\",s);len=strlen(s);\n\n    if (s[0]==s[len-1])\n\n    {\n\n        if (len & 1) ans=2;\n\n        else ans=1;\n\n    }\n\n    else\n\n    {\n\n        if (len & 1) ans=1;\n\n        else ans=2;\n\n    }\n\n    if (ans==1) cout<<\"First\"<<endl;\n\n    else cout<<\"Second\"<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "769",
        "source_code": "#include <iostream>\n\n#include <cstring>\n\n#include <cstdio>\n\n#include <string>\n\nusing namespace std;\n\nstring s;\n\nint main(){\n\n\t\t//freopen(\"main.in\",\"r\",stdin);\n\n\t\tcin >> s;\n\n\t\tint len;\n\n\t\tif(s[0] == s[s.length()-1]) {\n\n\t\t\t\tlen = s.length() - 3;\n\n\t\t}\n\n\t\telse{\n\n\t\t\t\tlen = s.length() - 2;\n\n\t\t}\n\n\t\tif(len % 2){\n\n\t\t\t   \tcout << \"First\" << endl;\n\n\n\n\t\t}else {\n\n\t\t\t\tcout << \"Second\" << endl;\n\n\t\t}\n\n\t\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "770",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar s[100010];\n\nint main(){\n\n\tscanf(\"%s\",s);\n\n\tint len=strlen(s);\n\n\tint ans=(s[0]==s[len-1])^(len%2);\n\n\tif(!ans)cout<<\"Second\"<<endl;\n\n\telse cout<<\"First\"<<endl;\n\n}\n\n\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "771",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\nint main(){\n\n\tcin >> s;\n\n\tif(s[0] == s[s.length() - 1]){\n\n\t\tif(s.length() % 2)\n\n\t\t\tcout << \"Second\" << endl;\n\n\t\telse\n\n\t\t\tcout << \"First\" << endl;\n\n\t}else{\n\n\t\tif(s.length() % 2)\n\n\t\t\tcout << \"First\" << endl;\n\n\t\telse\n\n\t\t\tcout << \"Second\" << endl;\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "772",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nchar st[100010];\n\n\n\nint main() {\n\n\tscanf(\"%s\", st);\n\n\tint l = strlen(st);\n\n\tif (st[0] == st[l-1]) {\n\n\t\tif (l % 2 == 1) {\n\n\t\t\tputs(\"Second\");\n\n\t\t} else {\n\n\t\t\tputs(\"First\");\n\n\t\t}\n\n\t} else {\n\n\t\tif (l % 2 == 1) {\n\n\t\t\tputs(\"First\");\n\n\t\t} else {\n\n\t\t\tputs(\"Second\");\n\n\t\t}\n\n\t}\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "773",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nchar s[100010];\n\n\n\nint main(){\n\n    scanf(\"%s\",s);\n\n    int len = strlen(s);\n\n    if(s[0] == s[len-1]) len--;\n\n    if(len & 1) printf(\"First\");\n\n    else printf(\"Second\");\n\n\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "774",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\nint main() {\n\n  cin >> s;\n\n  int l = s.size();\n\n  if(s[0] == s[l-1]) {\n\n    if((l - 2) % 2)printf(\"Second\\n\");\n\n    else printf(\"First\\n\");\n\n  }\n\n  else {\n\n    if((l - 2) % 2) printf(\"First\\n\");\n\n    else printf(\"Second\\n\");\n\n  }\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "775",
        "source_code": "//#include <bits/stdc++.h>\n\n#include <stdio.h>\n\n#include <iostream>\n\n#include <string.h>\n\n#include <math.h>\n\n#include <stdlib.h>\n\n#include <limits.h>\n\n#include <algorithm>\n\n#include <queue>\n\n#include <vector>\n\n#include <set>\n\n#include <map>\n\n#include <stack>\n\n#include <bitset>\n\n#include <string>\n\n#include <time.h>\n\nusing namespace std;\n\nlong double esp=1e-11;\n\n//#pragma comment(linker, \"/STACK:1024000000,1024000000\")\n\n#define fi first\n\n#define se second\n\n#define all(a) (a).begin(),(a).end()\n\n#define cle(a) while(!a.empty())a.pop()\n\n#define mem(p,c) memset(p,c,sizeof(p))\n\n#define mp(A, B) make_pair(A, B)\n\n#define pb push_back\n\n#define lson l , m , rt << 1\n\n#define rson m + 1 , r , rt << 1 | 1\n\ntypedef long long int LL;\n\nconst long double PI = acos((long double)-1);\n\nconst LL INF=0x3f3f3f3f3f3f3f3fll;\n\nconst int MOD =1000000007ll;\n\nconst int maxn=210100;\n\nchar s[maxn];\n\nint main()\n\n{\n\n    //freopen(\"in9.txt\", \"r\", stdin);\n\n    //freopen(\"in9.txt\", \"r\", stdin);\n\n    //freopen(\"out9.txt\", \"w\", stdout);\n\n    //::iterator iter;                  %I64d\n\n    //for(int x=1;x<=n;x++)\n\n    //for(int y=1;y<=n;y++)\n\n    //scanf(\"%d\",&a);\n\n    //printf(\"%d\\n\",ans);\n\n    scanf(\"%s\",s);\n\n    int n=strlen(s);\n\n    int f=1;\n\n    for(int x=0;x<n-2;x++)\n\n        if(s[x]!=s[x+2])\n\n        {\n\n            f=0;\n\n            break;\n\n        }\n\n    if(f==1)\n\n    {\n\n        printf(\"Second\\n\");\n\n        return 0;\n\n    }\n\n    if(s[0]==s[n-1])n--;\n\n    if(n&1)printf(\"First\\n\");\n\n    else printf(\"Second\\n\");\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "776",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\nint l;\n\nint main() {\n\n\tcin>>s;\n\n\tl = s.length();\n\n\tif (s[0] == s[l - 1]) {\n\n\t\tif (l % 2 == 0) cout<<\"First\"; else cout<<\"Second\";\n\n\t} else {\n\n\t\tif (l % 2 == 0) cout<<\"Second\"; else cout<<\"First\";\n\n\t}\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "777",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nconst int maxn=1e5+7;\n\n\n\nchar s[maxn];\n\n\n\nint main()\n\n{\n\n\tint i,j;\n\n\tscanf(\"%s\",s);\n\n\tint n=strlen(s);\n\n\tif(n%2==0)\n\n\t{\n\n\t\tif(s[0]==s[n-1])\n\n\t\t  printf(\"First\");\n\n\t\telse printf(\"Second\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif(s[0]==s[n-1])\n\n\t\t  printf(\"Second\");\n\n\t\telse printf(\"First\");\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "778",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn=  1e5+10;\n\nchar s[maxn];\n\nint main (void) {\n\n    scanf (\"%s\", s);\n\n    int len = strlen (s);\n\n    if (s[0] == s[len-1]) len--;\n\n    if (len % 2 == 1) printf (\"First\\n\");\n\n    else printf (\"Second\\n\");\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "779",
        "source_code": "\n\n#include<bits/stdc++.h>\n\n#define MEM(a,x) memset(a,x,sizeof(a))\n\n#define MEMINF(a) memset(a,0x3f,sizeof(a))\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int MAXN=2e5 + 10;\n\nconst int INF=0x3f3f3f3f;\n\nconst int MOD=1000000007;\n\nint main() {\n\n  LL len;\n\n  string s;\n\n  cin >> s;\n\n  len = s.length();\n\n  if ((len%2 == 0) ^ (s[0] == s[len-1]))\n\n    cout << \"Second\" << endl;\n\n\n\n  else   cout  << \"First\" << endl;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "780",
        "source_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <queue>\n\n#include <vector>\n\n#include <time.h>\n\n#include <string>\n\n#include <stack>\n\n#include <set>\n\n#include <map>\n\n#include <iostream>\n\n#include <bitset>\n\n#include <algorithm>\n\nusing namespace std;\n\n#define MP make_pair\n\n#define PB push_back\n\n#define ms(a,b) memset((a),(b),sizeof(a))\n\ntypedef long long LL;\n\ntypedef unsigned long long uLL;\n\ntypedef pair<int, int> Pii;\n\ntypedef vector<int> Vi;\n\ntypedef vector<Pii> Vii;\n\nconst int inf = 0x3f3f3f3f;\n\nconst LL INF = (1uLL << 63) - 1;\n\nconst LL mod = 1000000007;\n\nconst int N = 150 + 5;\n\nconst double Pi = acos(-1.0);\n\nconst int maxn = 100005;\n\nusing namespace std;\n\nchar s[maxn];\n\nint main() {\n\n#ifdef local\n\n    freopen(\"in\",\"r\",stdin);\n\n#endif\n\n    cin>>s;\n\n    int len = strlen(s);\n\n    int sf = len - 2;\n\n    if(s[0] == s[len - 1]){\n\n        sf++;\n\n        if(sf&1){\n\n            cout<<\"First\"<<endl;\n\n        }\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    else {\n\n        if(sf&1){\n\n            cout<<\"First\"<<endl;\n\n        }\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "781",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\nusing namespace std;\n\n\n\nchar s[100010];\n\n\n\nint main () {\n\n    cin >> s;\n\n    int len = strlen (s);\n\n    if (s[0] == s[len - 1]) {\n\n        if (len % 2 == 0) {\n\n            cout << \"First\" << endl;\n\n        } else {\n\n            cout << \"Second\" << endl;\n\n        }\n\n    } else {\n\n        if (len % 2 == 0) {\n\n            cout << \"Second\" << endl;\n\n        } else {\n\n            cout << \"First\" << endl;\n\n        }\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "782",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define X first\n\n#define Y second\n\n#define LL long long\n\n#define ULL unsigned long long\n\n#define PB push_back\n\n#define MP make_pair\n\n#define VI vector<int>\n\n#define PII pair<int,int>\n\n#define IOS ios::sync_with_stdio(0);cin.tie(0);\n\n#define IN freopen(\"in\", \"r\", stdin);\n\n#define OUT freopen(\"out\", \"w\", stdout);\n\n\n\nconst int maxn=100010;\n\n\n\nchar s[maxn];\n\n\n\nint main()\n\n{\n\n\tIOS;\n\n\tcin>>s;\n\n\tint n=strlen(s);\n\n\tbool ans=0;\n\n\tif (s[0]!=s[n-1]) ans^=1;\n\n\tans^=(bool)(n%2);\n\n\tif (ans) cout<<\"Second\"<<endl;\n\n\telse cout<<\"First\"<<endl;\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "783",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <queue>\n\n#include <cmath>\n\n#include <stack>\n\n#include <map>\n\n#include <set>\n\n#include <utility>\n\n#include <cstring>\n\n#include <vector>\n\n#define rep(i,n) for(ll i=1;i<=n;i++)\n\n#define repn(i,n) for(ll i=n;i>=1;i--)\n\n#define ll long long\n\n#define mt(a,x) memset(a,x,sizeof(a))\n\nconst ll mod = 1e9+7;\n\nconst ll maxn = 1000050;\n\nusing namespace std;\n\nint main()\n\n{\n\n    //freopen(\"data\",\"r\",stdin);\n\n    ios::sync_with_stdio(0);\n\n    string s;\n\n    while(cin>>s)\n\n    {\n\n        int num = s.length();\n\n        if(s[0]==s[num-1])\n\n        {\n\n            if(num&1) cout<<\"Second\"<<endl;\n\n            else cout<<\"First\"<<endl;\n\n        }\n\n        else\n\n        {\n\n            if(num&1) cout<<\"First\"<<endl;\n\n            else cout<<\"Second\"<<endl;\n\n        }\n\n    }\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "784",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <set>\n\n#include <utility>\n\n#include <vector>\n\n#include <map>\n\n#include <queue>\n\n#include <stack>\n\nconst int inf=0x3f3f3f3f;\n\nconst double PI=acos(-1.0);\n\nconst double EPS=1e-10;\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int,int> P;\n\n\n\nchar str[100050];\n\nint len;\n\nint main()\n\n{\n\n    //freopen(\"input.txt\",\"r\",stdin);\n\n    scanf(\"%s\",str+1);\n\n    len=strlen(str+1);\n\n    //\n\n    if(str[1]==str[len])\n\n    {\n\n        len-=2;\n\n        if(len%2==1) printf(\"Second\\n\");\n\n        else printf(\"First\\n\");\n\n    }\n\n    else\n\n    {\n\n        len-=2;\n\n        if(len%2==1) printf(\"First\\n\");\n\n        else printf(\"Second\\n\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "785",
        "source_code": "#include <iostream>\n\n#include <stdio.h>\n\n#include <cstdlib>\n\n#include <algorithm>\n\n#include <cmath>\n\n#include <cstring>\n\n#include <stack>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <vector>\n\n#include <queue>\n\n#include <bitset>\n\n#define ms(A, B) memset(A, B, sizeof(A))\n\nusing namespace std;\n\ntypedef long long LL;\n\ntypedef pair<int, int> pii;\n\nconst int INF = 0x7fffffff;\n\nconst int N = 1e5 + 10;\n\n\n\nchar s[N];\n\n\n\nint main() {\n\n#ifdef local\n\n    freopen(\"case.in\", \"r\", stdin);\n\n#endif\n\n    scanf(\"%s\", s);\n\n    int len = strlen(s);\n\n    bool flag = true;\n\n    for (int i = 0; i < len - 2; i++) {\n\n        if (s[i] != s[i + 2]) {\n\n            flag = false;\n\n            break;\n\n        }\n\n    }\n\n    if (flag) {\n\n        puts(\"Second\");\n\n        return 0;\n\n    }\n\n    if (len & 1) {\n\n        if (s[0] == s[len-1])\n\n            puts(\"Second\");\n\n        else\n\n            puts(\"First\");\n\n    }\n\n    else {\n\n        if (s[0] == s[len-1])\n\n            puts(\"First\");\n\n        else\n\n            puts(\"Second\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "786",
        "source_code": "#include <stdio.h>\n\n#include <string.h>\n\n#include <iostream>\n\n#include <algorithm>\n\n#include <queue>\n\n#include <vector>\n\n#include <string>\n\n#include <set>\n\n#include <map>\n\n#define ll long long\n\n#define ull unsigned long long\n\n#define rep(i, to) for(int i = 0; i < (to); ++i)\n\n#define rep1(i, to) for(int i = 1; i <= (to); ++i)\n\n#define ms(x, v) memset(x, v, sizeof(x))\n\nusing namespace std;\n\nconst int N = 100005, M = 6;\n\nchar s[N];\n\nint main()\n\n{\n\n#ifdef LOCAL\n\n    freopen(\"in\", \"r\", stdin);\n\n#endif\n\n//    ios::sync_with_stdio(0);\n\n    while(scanf(\"%s\", s) > 0)\n\n    {\n\n        int n = strlen(s);\n\n        if(s[0] != s[n - 1]) n++;\n\n        puts((n & 1) ? \"Second\" : \"First\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "787",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <queue>\n\n#include <string>\n\n#include <stack>\n\n#include <map>\n\n#include <ctime>\n\n#include <set>\n\n#include <bitset>\n\n#define X first\n\n#define Y second\n\n#define clr(u,v); memset(u,v,sizeof(u));\n\n#define in() freopen(\"data\",\"r\",stdin);\n\n#define out() freopen(\"data\",\"w\",stdout);\n\n#define Clear(Q); while (!Q.empty()) Q.pop();\n\n#define pb push_back\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int, int> pii;\n\ntypedef pair<char, int> pci;\n\nconst int maxn = 1e5 + 10;\n\nconst int INF = 0x3f3f3f3f;\n\nchar str[maxn];\n\nint main()\n\n{\n\n#ifdef LOCAL\n\n    in();\n\n#endif\n\n    scanf(\"%s\",str);\n\n    int len = strlen(str);\n\n    if (str[0]==str[len-1]) len--;\n\n    if (len&1) puts(\"First\");\n\n    else puts(\"Second\");\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "788",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "789",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cstdio>\n\n#include <string.h>\n\n#include <cmath>\n\n#include <cstdlib>\n\n#include <map>\n\nusing namespace std;\n\n\n\nconst int INF = 1 << 30;\n\nconst int maxn = 100000 + 10;\n\nchar arr[maxn];\n\nint book[maxn];\n\n\n\nint main()\n\n{\n\n    //freopen(\"in\", \"r\", stdin);\n\n    scanf(\"%s\", arr);\n\n    int len = strlen(arr), cnt = 0;\n\n    for (int i = 1; i < len - 1; i++)\n\n        if (arr[i] == arr[i - 1]);\n\n            cnt++;\n\n    if (arr[len - 1] == arr[0])\n\n        len -= 3;\n\n    else\n\n        len -= 2;\n\n\n\n    //printf(\"%d\\n\", cnt);\n\n    if (len % 2 == 0)\n\n        printf(\"Second\\n\");\n\n    else\n\n        printf(\"First\\n\");\n\n\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "790",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <string>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <vector>\n\n\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst ll mol=1000000007;\n\nconst int maxn=1000000;\n\nconst double PI=acos(-1.0);\n\nchar ch[maxn];\n\nint main()\n\n{\n\n#ifdef LOCAL\n\nfreopen(\"3.h\",\"r\",stdin);\n\n#endif\n\n    scanf(\"%s\",ch);\n\n    int len=strlen(ch);int num=0;\n\n    int dp1=0,dp2=0;\n\n    for(int i=1;i<len-1;i++)\n\n    if(ch[i+1]!=ch[i-1])num++;\n\n    /*for(int i=2;i<len-2;i++)\n\n    {\n\n        if(ch[i+1]!=ch[i-1])\n\n        {\n\n            if(ch[i-2]==ch[i]&&ch[i+2]==ch[i])dp1=1;\n\n            else if(ch[i-2]==ch[i+1]&&ch[i+2]==ch[i-1])dp1=1;\n\n            else if((ch[i-2]==ch[i]||ch[i+2]==ch[i])&&(ch[i-2]==ch[i+1]||ch[i+2]==ch[i-1]))dp2=1;\n\n            else dp1=1;\n\n        }\n\n    }\n\n    if((num%2)==0&&dp2==0)printf(\"Second\");\n\n    else printf(\"First\");*/\n\n    if(num==0)printf(\"Second\");\n\n    //else if(num==1)printf(\"First\");\n\n    else if(ch[0]==ch[len-1])\n\n    {\n\n        if(!(len%2))printf(\"First\");\n\n        else printf(\"Second\");\n\n    }\n\n    else\n\n    {\n\n        if(len%2)printf(\"First\");\n\n        else printf(\"Second\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "791",
        "source_code": "#define bi\n\n#include <iostream>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<set>\n\n#include<map>\n\n#include<vector>\n\n#include<queue>\n\n#include<string>\n\n#define MP make_pair\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst ll maxn=1e5+10;\n\nconst ll mod=1e9+7;\n\nchar ch[maxn];\n\n\n\nint main()\n\n{\n\n#ifdef bibi\n\n    freopen(\"in.txt\",\"r\",stdin);\n\n#endif\n\n    ios::sync_with_stdio(false);\n\n    cin.tie(0);\n\n    cin>>ch;\n\n    ll len=strlen(ch);\n\n    if(ch[0]==ch[len-1])\n\n    {\n\n        if(len%2==0)\n\n            cout<<\"First\";\n\n        else\n\n            cout<<\"Second\";\n\n    }\n\n    else\n\n    {\n\n        if(len%2==0)\n\n            cout<<\"Second\";\n\n        else\n\n            cout<<\"First\";\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "792",
        "source_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <assert.h>\n\n#define IOS ios::sync_with_stdio(false)\n\nusing namespace std;\n\n#define inf (0x3f3f3f3f)\n\ntypedef long long int LL;\n\n\n\n\n\n#include <iostream>\n\n#include <sstream>\n\n#include <vector>\n\n#include <set>\n\n#include <map>\n\n#include <queue>\n\n#include <string>\n\n#include <bitset>\n\n#include <list>\n\nlist<char>theList;\n\nconst int maxn = 1e5 + 20;\n\nchar str[maxn];\n\nvoid work() {\n\n    scanf(\"%s\", str + 1);\n\n    int lenstr = strlen(str + 1);\n\n    for (int i = 1; i <= lenstr; ++i) {\n\n        theList.push_back(str[i]);\n\n    }\n\n//    for (list<char> :: iterator it = theList.begin(); it != theList.end(); ++it) {\n\n//        cout << *it;\n\n//    }\n\n    int ans = 0;\n\n    while (theList.size() > 2) {\n\n        if (theList.size() == 3 && theList.front() == theList.back()) break;\n\n        list<char> :: iterator itBegin = theList.begin();\n\n        itBegin++;\n\n        list<char> :: iterator itEnd = theList.end();\n\n        itEnd--;\n\n        list<char> :: iterator itBeginPre = theList.begin();\n\n        list<char> :: iterator itBeginNext = itBegin; itBeginNext++;\n\n        bool flag = false;\n\n        while (itBegin != itEnd) {\n\n            if (*itBeginPre == *itBeginNext) {\n\n                itBeginPre++;\n\n                itBegin++;\n\n                itBeginNext++;\n\n            } else {\n\n                theList.erase(itBegin);\n\n                flag = true;\n\n                break;\n\n            }\n\n        }\n\n        if (!flag) break;\n\n        ans++;\n\n    }\n\n//    cout << ans << endl;\n\n    if (ans & 1) {\n\n        cout << \"First\" << endl;\n\n    } else cout << \"Second\" << endl;\n\n}\n\n\n\nint main() {\n\n#ifdef local\n\n    freopen(\"data.txt\", \"r\", stdin);\n\n//    freopen(\"data.txt\", \"w\", stdout);\n\n#endif\n\n    work();\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "793",
        "source_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <assert.h>\n\n#define IOS ios::sync_with_stdio(false)\n\nusing namespace std;\n\n#define inf (0x3f3f3f3f)\n\ntypedef long long int LL;\n\n\n\n\n\n#include <iostream>\n\n#include <sstream>\n\n#include <vector>\n\n#include <set>\n\n#include <map>\n\n#include <queue>\n\n#include <string>\n\n#include <bitset>\n\n#include <list>\n\nlist<char>theList;\n\nconst int maxn = 1e5 + 20;\n\nchar str[maxn];\n\nvoid work() {\n\n    scanf(\"%s\", str + 1);\n\n    int lenstr = strlen(str + 1);\n\n    lenstr -= 2;\n\n    if (str[1] == str[strlen(str + 1)]) lenstr--;\n\n    if (lenstr & 1) {\n\n        cout << \"First\" << endl;\n\n    } else cout << \"Second\" << endl;\n\n}\n\n\n\nint main() {\n\n#ifdef local\n\n    freopen(\"data.txt\", \"r\", stdin);\n\n//    freopen(\"data.txt\", \"w\", stdout);\n\n#endif\n\n    work();\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "794",
        "source_code": "#include <cstdio>\n\n#include <iostream>\n\n#include <cstring>\n\n#include <algorithm>\n\nusing namespace std;\n\nconst int maxn=1e5+10;\n\nchar str[maxn];\n\nint main()\n\n{\n\n   cin>>str;\n\n   int len=strlen(str);\n\n   if (str[0]==str[len-1]){\n\n       if (len&1){\n\n         cout<<\"Second\\n\";\n\n\n\n       }\n\n       else cout<<\"First\\n\";\n\n\n\n   }\n\n   else {\n\n      if (len&1){\n\n         cout<<\"First\\n\";\n\n      }\n\n      else cout<<\"Second\\n\";\n\n   }\n\n\n\n   return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "795",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <stack>\n\n#include <queue>\n\n#include <vector>\n\n#include <map>\n\n#include <set>\n\nusing namespace std;\n\n#define ll long long\n\nchar s[300005];\n\n\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int l=strlen(s);\n\n    int x=l-2;\n\n    if(s[0]==s[l-1])\n\n    {\n\n        if(x%2==0) printf(\"First\");\n\n        else printf(\"Second\");\n\n    }\n\n    else\n\n    {\n\n        if(x%2==1) printf(\"First\");\n\n        else printf(\"Second\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "796",
        "source_code": "#include<bits/stdc++.h>\n\n#define rep(i,j,k) for(int i=(j);i<(k);i++)\n\n#define mp make_pair\n\n#define sz(a) (int)(a).size()\n\n#define pb push_back\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int,int> pii;\n\ntypedef pair<double,double> pdd;\n\ntypedef long double ld;\n\n//----head----\n\nchar str[100005];\n\nint main()\n\n{\n\n\tscanf(\"%s\",str);\n\n\tint n=strlen(str);\n\n\tint ans=(str[0]==str[n-1]);\n\n\tans^=(n%2);\n\n\tputs(ans?\"First\":\"Second\");\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "797",
        "source_code": "#include <iostream>\n\n#include <cstdlib>\n\n#include <algorithm>\n\n#include <cstdio>\n\n#include <cmath>\n\n#include <cstring>\n\n\n\nusing namespace std;\n\n\n\nchar s[100005];\n\n\n\nint main() {\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    if ((len&1)!=(s[0]==s[len-1])) printf(\"First\\n\"); else printf(\"Second\\n\");\n\n\n\n    return 0;\n\n}\n\n\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "798",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\nconst int maxn=1e5+5;\n\nchar a[maxn];\n\nint main()\n\n{\n\n    while(~scanf(\"%s\", a))\n\n    {\n\n        int len=strlen(a);\n\n        if(len&1)\n\n        {\n\n            if(a[0]==a[len-1])printf(\"Second\\n\");\n\n            else printf(\"First\\n\");\n\n        }\n\n        else\n\n        {\n\n            if(a[0]==a[len-1])printf(\"First\\n\");\n\n            else printf(\"Second\\n\");\n\n        }\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "799",
        "source_code": "#include<bits/stdc++.h>\n\n\n\nusing namespace std;\n\nconst int N=112345;\n\n\n\nchar s[N];\n\n\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    set<char>S;\n\n    for(int i=0;i<=len-1;i++)\n\n        S.insert(s[i]);\n\n    if(S.size()>2)\n\n    {\n\n        if(s[0]==s[len-1])\n\n        {\n\n            if ((len - 3) % 2 == 0)printf(\"Second\\n\");\n\n            else printf(\"First\\n\");\n\n        }\n\n        else {\n\n            if ((len - 2) % 2 == 0)printf(\"Second\\n\");\n\n            else printf(\"First\\n\");\n\n        }\n\n    }\n\n    else if(S.size()==2)\n\n    {\n\n        printf(\"Second\\n\");\n\n    }\n\n    else if(S.size()==1)\n\n    {\n\n        printf(\"Second\\n\");\n\n    }\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\nchar st[104014];\n\n\n\nint main(){\n\n  while(~scanf(\"%s\", st)){\n\n    int len = strlen(st);\n\n    if(st[0] != st[len-1]){\n\n      if(len & 1) printf(\"First\\n\");\n\n      else printf(\"Second\\n\");\n\n    }\n\n    else {\n\n      if(len & 1) printf(\"Second\\n\");\n\n      else printf(\"First\\n\");\n\n    }\n\n  }\n\n  return 0;\n\n}\n"
    },
    {
        "id": "800",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<iostream>\n\n#include <math.h>\n\n#include <bits/stdc++.h>\n\n#define ll long long\n\n#define inf 0x3f3f3f3f\n\n#define maxn 310000\n\nusing namespace std;\n\nint vis[maxn];\n\nchar s[111111];\n\nint main()\n\n{\n\n    int i,j,n,jj=0,sum=0,k,flag;\n\n    cin>>s;\n\n    n=strlen(s);\n\n    if(n%2==0)\n\n    {\n\n        if(s[0]==s[n-1]) \n\n            printf(\"First\\n\");\n\n        else printf(\"Second\\n\");\n\n    }\n\n    if(n%2!=0)\n\n    {\n\n        if(s[0]!=s[n-1]) \n\n            printf(\"First\\n\");\n\n        else printf(\"Second\\n\");\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "801",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "/*QAQ\u4e09\u8fde\uff1a\u4ee5\u524d\u7684\u9898\u90fd\u8865\u4e86\u5417\uff0c\u4eca\u5929\u7684\u9898\u90fd\u505a\u4e86\u5417\uff0c\u4e0d\u4f1a\u7684\u7b97\u6cd5\u90fd\u4f1a\u4e86\u5417*/\n\n/*\u91d1\u6854\u9000\u5f79\u4e09\u8fde\uff1a\u9000\u5f79\u9009\u624b\u4e0d\u5b66\u4e0d\u4f1a\u4e0d\u7ec3*/\n\n#include <bits/stdc++.h>\n\n#define LDQ 1000000007\n\n#define QAQ 0x3f3f3f3f\n\n#define PI 3.14159265358979323846\n\nusing namespace std;\n\nint main()\n\n{\n\n    int i;\n\n    char s[100001];\n\n    scanf(\"%s\",s);\n\n    if(strlen(s)%2==0)\n\n    {\n\n        if(s[0]==s[strlen(s)-1])\n\n        {\n\n            printf(\"First\");\n\n        }\n\n        else\n\n        {\n\n            printf(\"Second\");\n\n        }\n\n    }\n\n    else\n\n    {\n\n        if(s[0]==s[strlen(s)-1])\n\n        {\n\n            printf(\"Second\");\n\n        }\n\n        else\n\n        {\n\n            printf(\"First\");\n\n        }\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "802",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    string s;\n\n    cin >> s;\n\n    if(s[0] == s[s.size() - 1])\n\n        cout << (s.size() & 1 ? \"Second\" : \"First\");\n\n    else\n\n        cout << (s.size() & 1 ? \"First\" : \"Second\");\n\n    return 0;\n\n}"
    },
    {
        "id": "803",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint s1,s2,a;\n\nchar c[100010],c1,c2;\n\nint main(){\n\n\tscanf(\"%s\",c+1);\n\n\ta=strlen(c+1);\n\n\tc1=c[1],c2=c[a];\n\n\tif((c1==c2&&a%2==0)||c1!=c2&&a%2!=0) cout<<\"First\";\n\n\telse cout<<\"Second\"; \n\n\treturn 0;\n\n}"
    },
    {
        "id": "804",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <iostream>\n\nusing namespace std;\n\n\n\nint main(){\n\n\tstring s;\n\n\tcin >> s;\n\n\tint ans = s.size()-2;\n\n\t\n\n\tif(s[0]==s[s.size()-1]) ans-=1;\n\n\tif(ans&1) cout << \"First\";\t//\u957f\u5ea6\u4e3a\u5947\u6570\n\n\telse cout << \"Second\"; \n\n}"
    },
    {
        "id": "805",
        "source_code": "#include<iostream>\n\n#include<cstring>\n\nusing namespace std;\n\nint main()\n\n{\n\n   char m[100010];\n\n   int a,b;\n\n   while (cin>>m)\n\n    {\n\n       a=strlen(m);\n\n       if (m[0]==m[a-1])\n\n\t   b=a-3;\n\n       else \n\n\t   b=a-2;\n\n       if (b%2==1)\n\n\t   cout<<\"First\"<<endl;\n\n       else \n\n\t   cout<<\"Second\"<<endl;\n\n    }\n\n   return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "806",
        "source_code": "#include<iostream>\n\n#include<algorithm> \n\n#include<string.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint b;\n\n\tstring s;\n\n\twhile(cin>>s)\n\n\t{\n\n\tint a=s.length();\n\n\tif(s[0]==s[a-1])\n\n\tb=a-3;\n\n\telse\n\n\tb=a-2;\n\n\tif(b%2)\n\n\tcout<<\"First\"<<endl;\n\n\telse\n\n\tcout<<\"Second\"<<endl;\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "807",
        "source_code": "\n\n#include<iostream>\n\n#include<string.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tstring s;\n\n\tint t;\n\n\tcin>>s;\n\n\tt=s.size();\n\n\tif(s[0]==s[t-1])\n\n\t{\n\n\tif(t%2==0)\n\n\tcout<<\"First\"<<endl;\n\n\tif(t%2!=0)\n\n\tcout<<\"Second\"<<endl;\n\n\t}\n\n\telse \n\n\t{\n\n\t\tif(t%2==0) \n\n\t\tcout<<\"Second\"<<endl;\n\n\t\telse\n\n\t\tcout<<\"First\"<<endl;\n\n\t\t}\n\n\t\treturn 0;\n\n\t}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "808",
        "source_code": "#include <iostream>\n\n#include <cstring>\n\nusing namespace std;\n\nint main(){\n\n  string s;\n\n  cin>>s;\n\n  if(s[0]==s[s.length()-1]){\n\n    if(s.length()%2==0)\n\n      cout<<\"First\"<<endl;\n\n    else cout<<\"Second\"<<endl;\n\n  }\n\n  else {\n\n    if(s.length()%2==0)\n\n      cout<<\"Second\"<<endl;\n\n    else cout<<\"First\"<<endl;\n\n  }\n\n  return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "809",
        "source_code": "#include<cstring> \n\n#include<iostream> \n\nusing namespace std;\n\nint main()\n\n{\n\n\tint flag=0,count=0;\n\n\tchar a[100005];\n\n\tcin>>a;\n\n\t(a[0]==a[strlen(a)-1])?(flag=1):0;\n\n\tcount+=flag+strlen(a);\n\n\tcout<<((count&1)?\"First\":\"Second\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "810",
        "source_code": "#include <cmath>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <iostream>\n\n#include <algorithm>\n\nusing namespace std;\n\nint num,num2;\n\nchar l,r,ch;\n\nint main()\n\n{\n\n\tl=getchar(); num=1;\n\n\twhile(ch=getchar(),ch<='z'&&ch>='a')\n\n\t{\n\n\t\tnum++;\n\n\t\tr=ch;\n\n\t}\n\n\tnum%=2;\n\n\tif(l==r) num2=1;\n\n\telse num2=0;\n\n\tif(num==num2) cout<<\"Second\";\n\n\telse cout<<\"First\";\n\n\t\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "811",
        "source_code": "#include <iostream>\n\n#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nchar c[100005];\n\nint main()\n\n{\n\n    cin>>c;\n\n    int len=strlen(c);\n\n    if(c[0]==c[len-1])\n\n        len++;\n\n    if(len%2==0)\n\n        cout<<\"Second\"<<endl;\n\n    else\n\n    cout << \"First\" << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "812",
        "source_code": "#include <algorithm>\n\n#include <bitset>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <iostream>\n\n#include <map>\n\n#include <queue>\n\n#include <set>\n\n#include <vector>\n\n#define MP make_pair\n\n#define ls (o << 1)\n\n#define rs (o << 1 | 1)\n\n#define mid ((L + R) >> 1)\n\n#define eps (1e-5)\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst LL mod = 1e9 + 7;\n\nint n, m;\n\ntypedef pair<int, int> PII;\n\nchar s[100050];\n\nint main() {\n\n    scanf(\"%s\", s);\n\n    auto len = strlen(s);\n\n    if (s[0] != s[len - 1] && len % 2 == 0) {\n\n        puts(\"Second\");\n\n        return 0;\n\n    }\n\n    if (s[0] != s[len - 1] && len % 2 == 1) {\n\n        puts(\"First\");\n\n        return 0;\n\n    }\n\n    printf(\"%s\\n\", len & 1 ? \"Second\" : \"First\");\n\n    return 0;\n\n}\n\n//\u82cf\u5b50\u66f0\uff1a\u201c\u5ba2\u4ea6\u77e5\u592b\uff08f\u00fa\uff09\u6c34\u4e0e\u6708\u4e4e\uff1f\u901d\u8005\u5982\u65af[36]\uff0c\u800c\u672a\u5c1d\u5f80\u4e5f\uff1b\u76c8\u865a\u8005\u5982\u5f7c[37]\uff0c\u800c\u5352[38]\u83ab\u6d88\u957f(zh\u01ceng)\u4e5f\u3002\u76d6\u5c06\u81ea\u5176\u53d8\u8005\u800c\u89c2\u4e4b\uff0c\u5219\u5929\u5730\u66fe\uff08z\u0113ng\uff09\u4e0d\u80fd\u4ee5\u4e00\u77ac\uff1b\u81ea\u5176\u4e0d\u53d8\u8005\u800c\u89c2\u4e4b\uff0c\u5219\u7269\u4e0e\u6211\u7686\u65e0\u5c3d\u4e5f\uff0c\u800c\u53c8\u4f55\u7fa1\u4e4e\uff01\u4e14\u592b\uff08f\u00fa\uff09\u5929\u5730\u4e4b\u95f4\uff0c\u7269\u5404\u6709\u4e3b\uff0c\u82df\uff08g\u01d2u\uff09\u975e\u543e\u4e4b\u6240\u6709\uff0c\u867d\u4e00\u6beb\u800c\u83ab\u53d6\u3002\u60df\u6c5f\u4e0a\u4e4b\u6e05\u98ce\uff0c\u4e0e\u5c71\u95f4\u4e4b\u660e\u6708\uff0c\u8033\u5f97\u4e4b\u800c\u4e3a\u58f0\uff0c\u76ee\u9047\u4e4b\u800c\u6210\u8272\uff0c\u53d6\u4e4b\u65e0\u7981\uff0c\u7528\u4e4b\u4e0d\u7aed\uff0c\u662f\u9020\u7269\u8005\u4e4b\u65e0\u5c3d\u85cf[39]\uff08z\u00e0ng\uff09\u4e5f\uff0c\u800c\u543e\u4e0e\u5b50\u4e4b\u6240\u5171\u9002[40]\u3002\u201d\n\n//\u5ba2\u559c\u800c\u7b11\uff0c\u6d17\u76cf(zh\u01cen)\u66f4\uff08g\u0113ng\uff09\u914c[41]\uff08zhu\u00f3\uff09\u3002\u80b4\uff08y\u00e1o\uff09\u6838\u65e2\u5c3d[42]\uff0c\u676f\u76d8\u72fc\u7c4d\u3002\u76f8\u4e0e\u6795\u85c9[43]\uff08ji\u00e8\uff09\u4e4e\u821f\u4e2d\uff0c\u4e0d\u77e5\u4e1c\u65b9\u4e4b\u65e2\u767d[44]",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "813",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[100010];\n\n    int ans,len;\n\n    scanf(\"%s\",s);len=strlen(s);\n\n    if (s[0]==s[len-1])\n\n    {\n\n        if (len & 1) ans=2;\n\n        else ans=1;\n\n    }\n\n    else\n\n    {\n\n        if (len & 1) ans=1;\n\n        else ans=2;\n\n    }\n\n    if (ans==1) cout<<\"First\"<<endl;\n\n    else cout<<\"Second\"<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "814",
        "source_code": "#include <iostream>\n\n#include <cstring>\n\n#include <cstdio>\n\n#include <string>\n\nusing namespace std;\n\nstring s;\n\nint main(){\n\n\t\t//freopen(\"main.in\",\"r\",stdin);\n\n\t\tcin >> s;\n\n\t\tint len;\n\n\t\tif(s[0] == s[s.length()-1]) {\n\n\t\t\t\tlen = s.length() - 3;\n\n\t\t}\n\n\t\telse{\n\n\t\t\t\tlen = s.length() - 2;\n\n\t\t}\n\n\t\tif(len % 2){\n\n\t\t\t   \tcout << \"First\" << endl;\n\n\n\n\t\t}else {\n\n\t\t\t\tcout << \"Second\" << endl;\n\n\t\t}\n\n\t\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "815",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar s[100010];\n\nint main(){\n\n\tscanf(\"%s\",s);\n\n\tint len=strlen(s);\n\n\tint ans=(s[0]==s[len-1])^(len%2);\n\n\tif(!ans)cout<<\"Second\"<<endl;\n\n\telse cout<<\"First\"<<endl;\n\n}\n\n\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "816",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\nint main(){\n\n\tcin >> s;\n\n\tif(s[0] == s[s.length() - 1]){\n\n\t\tif(s.length() % 2)\n\n\t\t\tcout << \"Second\" << endl;\n\n\t\telse\n\n\t\t\tcout << \"First\" << endl;\n\n\t}else{\n\n\t\tif(s.length() % 2)\n\n\t\t\tcout << \"First\" << endl;\n\n\t\telse\n\n\t\t\tcout << \"Second\" << endl;\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "817",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nchar st[100010];\n\n\n\nint main() {\n\n\tscanf(\"%s\", st);\n\n\tint l = strlen(st);\n\n\tif (st[0] == st[l-1]) {\n\n\t\tif (l % 2 == 1) {\n\n\t\t\tputs(\"Second\");\n\n\t\t} else {\n\n\t\t\tputs(\"First\");\n\n\t\t}\n\n\t} else {\n\n\t\tif (l % 2 == 1) {\n\n\t\t\tputs(\"First\");\n\n\t\t} else {\n\n\t\t\tputs(\"Second\");\n\n\t\t}\n\n\t}\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "818",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nchar s[100010];\n\n\n\nint main(){\n\n    scanf(\"%s\",s);\n\n    int len = strlen(s);\n\n    if(s[0] == s[len-1]) len--;\n\n    if(len & 1) printf(\"First\");\n\n    else printf(\"Second\");\n\n\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "819",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\nint main() {\n\n  cin >> s;\n\n  int l = s.size();\n\n  if(s[0] == s[l-1]) {\n\n    if((l - 2) % 2)printf(\"Second\\n\");\n\n    else printf(\"First\\n\");\n\n  }\n\n  else {\n\n    if((l - 2) % 2) printf(\"First\\n\");\n\n    else printf(\"Second\\n\");\n\n  }\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "820",
        "source_code": "//#include <bits/stdc++.h>\n\n#include <stdio.h>\n\n#include <iostream>\n\n#include <string.h>\n\n#include <math.h>\n\n#include <stdlib.h>\n\n#include <limits.h>\n\n#include <algorithm>\n\n#include <queue>\n\n#include <vector>\n\n#include <set>\n\n#include <map>\n\n#include <stack>\n\n#include <bitset>\n\n#include <string>\n\n#include <time.h>\n\nusing namespace std;\n\nlong double esp=1e-11;\n\n//#pragma comment(linker, \"/STACK:1024000000,1024000000\")\n\n#define fi first\n\n#define se second\n\n#define all(a) (a).begin(),(a).end()\n\n#define cle(a) while(!a.empty())a.pop()\n\n#define mem(p,c) memset(p,c,sizeof(p))\n\n#define mp(A, B) make_pair(A, B)\n\n#define pb push_back\n\n#define lson l , m , rt << 1\n\n#define rson m + 1 , r , rt << 1 | 1\n\ntypedef long long int LL;\n\nconst long double PI = acos((long double)-1);\n\nconst LL INF=0x3f3f3f3f3f3f3f3fll;\n\nconst int MOD =1000000007ll;\n\nconst int maxn=210100;\n\nchar s[maxn];\n\nint main()\n\n{\n\n    //freopen(\"in9.txt\", \"r\", stdin);\n\n    //freopen(\"in9.txt\", \"r\", stdin);\n\n    //freopen(\"out9.txt\", \"w\", stdout);\n\n    //::iterator iter;                  %I64d\n\n    //for(int x=1;x<=n;x++)\n\n    //for(int y=1;y<=n;y++)\n\n    //scanf(\"%d\",&a);\n\n    //printf(\"%d\\n\",ans);\n\n    scanf(\"%s\",s);\n\n    int n=strlen(s);\n\n    int f=1;\n\n    for(int x=0;x<n-2;x++)\n\n        if(s[x]!=s[x+2])\n\n        {\n\n            f=0;\n\n            break;\n\n        }\n\n    if(f==1)\n\n    {\n\n        printf(\"Second\\n\");\n\n        return 0;\n\n    }\n\n    if(s[0]==s[n-1])n--;\n\n    if(n&1)printf(\"First\\n\");\n\n    else printf(\"Second\\n\");\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "821",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\nint l;\n\nint main() {\n\n\tcin>>s;\n\n\tl = s.length();\n\n\tif (s[0] == s[l - 1]) {\n\n\t\tif (l % 2 == 0) cout<<\"First\"; else cout<<\"Second\";\n\n\t} else {\n\n\t\tif (l % 2 == 0) cout<<\"Second\"; else cout<<\"First\";\n\n\t}\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "822",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n\n\nconst int maxn=1e5+7;\n\n\n\nchar s[maxn];\n\n\n\nint main()\n\n{\n\n\tint i,j;\n\n\tscanf(\"%s\",s);\n\n\tint n=strlen(s);\n\n\tif(n%2==0)\n\n\t{\n\n\t\tif(s[0]==s[n-1])\n\n\t\t  printf(\"First\");\n\n\t\telse printf(\"Second\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif(s[0]==s[n-1])\n\n\t\t  printf(\"Second\");\n\n\t\telse printf(\"First\");\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "823",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn=  1e5+10;\n\nchar s[maxn];\n\nint main (void) {\n\n    scanf (\"%s\", s);\n\n    int len = strlen (s);\n\n    if (s[0] == s[len-1]) len--;\n\n    if (len % 2 == 1) printf (\"First\\n\");\n\n    else printf (\"Second\\n\");\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "824",
        "source_code": "\n\n#include<bits/stdc++.h>\n\n#define MEM(a,x) memset(a,x,sizeof(a))\n\n#define MEMINF(a) memset(a,0x3f,sizeof(a))\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int MAXN=2e5 + 10;\n\nconst int INF=0x3f3f3f3f;\n\nconst int MOD=1000000007;\n\nint main() {\n\n  LL len;\n\n  string s;\n\n  cin >> s;\n\n  len = s.length();\n\n  if ((len%2 == 0) ^ (s[0] == s[len-1]))\n\n    cout << \"Second\" << endl;\n\n\n\n  else   cout  << \"First\" << endl;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "825",
        "source_code": "#include <cstdio>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <queue>\n\n#include <vector>\n\n#include <time.h>\n\n#include <string>\n\n#include <stack>\n\n#include <set>\n\n#include <map>\n\n#include <iostream>\n\n#include <bitset>\n\n#include <algorithm>\n\nusing namespace std;\n\n#define MP make_pair\n\n#define PB push_back\n\n#define ms(a,b) memset((a),(b),sizeof(a))\n\ntypedef long long LL;\n\ntypedef unsigned long long uLL;\n\ntypedef pair<int, int> Pii;\n\ntypedef vector<int> Vi;\n\ntypedef vector<Pii> Vii;\n\nconst int inf = 0x3f3f3f3f;\n\nconst LL INF = (1uLL << 63) - 1;\n\nconst LL mod = 1000000007;\n\nconst int N = 150 + 5;\n\nconst double Pi = acos(-1.0);\n\nconst int maxn = 100005;\n\nusing namespace std;\n\nchar s[maxn];\n\nint main() {\n\n#ifdef local\n\n    freopen(\"in\",\"r\",stdin);\n\n#endif\n\n    cin>>s;\n\n    int len = strlen(s);\n\n    int sf = len - 2;\n\n    if(s[0] == s[len - 1]){\n\n        sf++;\n\n        if(sf&1){\n\n            cout<<\"First\"<<endl;\n\n        }\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    else {\n\n        if(sf&1){\n\n            cout<<\"First\"<<endl;\n\n        }\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "826",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\nusing namespace std;\n\n\n\nchar s[100010];\n\n\n\nint main () {\n\n    cin >> s;\n\n    int len = strlen (s);\n\n    if (s[0] == s[len - 1]) {\n\n        if (len % 2 == 0) {\n\n            cout << \"First\" << endl;\n\n        } else {\n\n            cout << \"Second\" << endl;\n\n        }\n\n    } else {\n\n        if (len % 2 == 0) {\n\n            cout << \"Second\" << endl;\n\n        } else {\n\n            cout << \"First\" << endl;\n\n        }\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "827",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define X first\n\n#define Y second\n\n#define LL long long\n\n#define ULL unsigned long long\n\n#define PB push_back\n\n#define MP make_pair\n\n#define VI vector<int>\n\n#define PII pair<int,int>\n\n#define IOS ios::sync_with_stdio(0);cin.tie(0);\n\n#define IN freopen(\"in\", \"r\", stdin);\n\n#define OUT freopen(\"out\", \"w\", stdout);\n\n\n\nconst int maxn=100010;\n\n\n\nchar s[maxn];\n\n\n\nint main()\n\n{\n\n\tIOS;\n\n\tcin>>s;\n\n\tint n=strlen(s);\n\n\tbool ans=0;\n\n\tif (s[0]!=s[n-1]) ans^=1;\n\n\tans^=(bool)(n%2);\n\n\tif (ans) cout<<\"Second\"<<endl;\n\n\telse cout<<\"First\"<<endl;\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "828",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <queue>\n\n#include <cmath>\n\n#include <stack>\n\n#include <map>\n\n#include <set>\n\n#include <utility>\n\n#include <cstring>\n\n#include <vector>\n\n#define rep(i,n) for(ll i=1;i<=n;i++)\n\n#define repn(i,n) for(ll i=n;i>=1;i--)\n\n#define ll long long\n\n#define mt(a,x) memset(a,x,sizeof(a))\n\nconst ll mod = 1e9+7;\n\nconst ll maxn = 1000050;\n\nusing namespace std;\n\nint main()\n\n{\n\n    //freopen(\"data\",\"r\",stdin);\n\n    ios::sync_with_stdio(0);\n\n    string s;\n\n    while(cin>>s)\n\n    {\n\n        int num = s.length();\n\n        if(s[0]==s[num-1])\n\n        {\n\n            if(num&1) cout<<\"Second\"<<endl;\n\n            else cout<<\"First\"<<endl;\n\n        }\n\n        else\n\n        {\n\n            if(num&1) cout<<\"First\"<<endl;\n\n            else cout<<\"Second\"<<endl;\n\n        }\n\n    }\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "829",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <set>\n\n#include <utility>\n\n#include <vector>\n\n#include <map>\n\n#include <queue>\n\n#include <stack>\n\nconst int inf=0x3f3f3f3f;\n\nconst double PI=acos(-1.0);\n\nconst double EPS=1e-10;\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int,int> P;\n\n\n\nchar str[100050];\n\nint len;\n\nint main()\n\n{\n\n    //freopen(\"input.txt\",\"r\",stdin);\n\n    scanf(\"%s\",str+1);\n\n    len=strlen(str+1);\n\n    //\n\n    if(str[1]==str[len])\n\n    {\n\n        len-=2;\n\n        if(len%2==1) printf(\"Second\\n\");\n\n        else printf(\"First\\n\");\n\n    }\n\n    else\n\n    {\n\n        len-=2;\n\n        if(len%2==1) printf(\"First\\n\");\n\n        else printf(\"Second\\n\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "830",
        "source_code": "#include <iostream>\n\n#include <stdio.h>\n\n#include <cstdlib>\n\n#include <algorithm>\n\n#include <cmath>\n\n#include <cstring>\n\n#include <stack>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <vector>\n\n#include <queue>\n\n#include <bitset>\n\n#define ms(A, B) memset(A, B, sizeof(A))\n\nusing namespace std;\n\ntypedef long long LL;\n\ntypedef pair<int, int> pii;\n\nconst int INF = 0x7fffffff;\n\nconst int N = 1e5 + 10;\n\n\n\nchar s[N];\n\n\n\nint main() {\n\n#ifdef local\n\n    freopen(\"case.in\", \"r\", stdin);\n\n#endif\n\n    scanf(\"%s\", s);\n\n    int len = strlen(s);\n\n    bool flag = true;\n\n    for (int i = 0; i < len - 2; i++) {\n\n        if (s[i] != s[i + 2]) {\n\n            flag = false;\n\n            break;\n\n        }\n\n    }\n\n    if (flag) {\n\n        puts(\"Second\");\n\n        return 0;\n\n    }\n\n    if (len & 1) {\n\n        if (s[0] == s[len-1])\n\n            puts(\"Second\");\n\n        else\n\n            puts(\"First\");\n\n    }\n\n    else {\n\n        if (s[0] == s[len-1])\n\n            puts(\"First\");\n\n        else\n\n            puts(\"Second\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "831",
        "source_code": "#include <stdio.h>\n\n#include <string.h>\n\n#include <iostream>\n\n#include <algorithm>\n\n#include <queue>\n\n#include <vector>\n\n#include <string>\n\n#include <set>\n\n#include <map>\n\n#define ll long long\n\n#define ull unsigned long long\n\n#define rep(i, to) for(int i = 0; i < (to); ++i)\n\n#define rep1(i, to) for(int i = 1; i <= (to); ++i)\n\n#define ms(x, v) memset(x, v, sizeof(x))\n\nusing namespace std;\n\nconst int N = 100005, M = 6;\n\nchar s[N];\n\nint main()\n\n{\n\n#ifdef LOCAL\n\n    freopen(\"in\", \"r\", stdin);\n\n#endif\n\n//    ios::sync_with_stdio(0);\n\n    while(scanf(\"%s\", s) > 0)\n\n    {\n\n        int n = strlen(s);\n\n        if(s[0] != s[n - 1]) n++;\n\n        puts((n & 1) ? \"Second\" : \"First\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "832",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <queue>\n\n#include <string>\n\n#include <stack>\n\n#include <map>\n\n#include <ctime>\n\n#include <set>\n\n#include <bitset>\n\n#define X first\n\n#define Y second\n\n#define clr(u,v); memset(u,v,sizeof(u));\n\n#define in() freopen(\"data\",\"r\",stdin);\n\n#define out() freopen(\"data\",\"w\",stdout);\n\n#define Clear(Q); while (!Q.empty()) Q.pop();\n\n#define pb push_back\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int, int> pii;\n\ntypedef pair<char, int> pci;\n\nconst int maxn = 1e5 + 10;\n\nconst int INF = 0x3f3f3f3f;\n\nchar str[maxn];\n\nint main()\n\n{\n\n#ifdef LOCAL\n\n    in();\n\n#endif\n\n    scanf(\"%s\",str);\n\n    int len = strlen(str);\n\n    if (str[0]==str[len-1]) len--;\n\n    if (len&1) puts(\"First\");\n\n    else puts(\"Second\");\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "833",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <algorithm>\n\n#include <vector>\n\n#include <stack>\n\n#include <queue>\n\n#include <map>\n\n#include <set>\n\n#include <string>\n\n#include <cstring>\n\n#define ll long long\n\n#define rep(x,n) for(ll (x)=0;(x)<n;(x)++)\n\n#define rep1(x,n) for(ll (x)=1;(x)<=n;(x)++)\n\nusing namespace std;\n\n\n\nchar s[300005],book[300005];\n\n\n\nint main()\n\n{\n\n    #ifdef LOCAL\n\n        freopen(\"B_data\",\"r\",stdin);\n\n    #endif\n\n    while(cin>>s)\n\n    {\n\n        ll len=strlen(s),cnt=0,l=0,r=2;\n\n        memset(book,0,sizeof(book));\n\n        rep(i,len)\n\n        {\n\n            if(!i || i==(len-1) || book[i]) continue;\n\n            while(l && book[l]) l--;\n\n            while(r<=i || (r<len && book[r])) r++;\n\n            if(s[l]!=s[r])\n\n            {\n\n                cnt++,book[i]=1;\n\n                //cout<<s[i];\n\n                i-=2;\n\n            }\n\n        }\n\n        //cout<<endl;\n\n        if(cnt%2) cout<<\"First\"<<endl;\n\n        else cout<<\"Second\"<<endl;\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "834",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cstdio>\n\n#include <string.h>\n\n#include <cmath>\n\n#include <cstdlib>\n\n#include <map>\n\nusing namespace std;\n\n\n\nconst int INF = 1 << 30;\n\nconst int maxn = 100000 + 10;\n\nchar arr[maxn];\n\nint book[maxn];\n\n\n\nint main()\n\n{\n\n    //freopen(\"in\", \"r\", stdin);\n\n    scanf(\"%s\", arr);\n\n    int len = strlen(arr), cnt = 0;\n\n    for (int i = 1; i < len - 1; i++)\n\n        if (arr[i] == arr[i - 1]);\n\n            cnt++;\n\n    if (arr[len - 1] == arr[0])\n\n        len -= 3;\n\n    else\n\n        len -= 2;\n\n\n\n    //printf(\"%d\\n\", cnt);\n\n    if (len % 2 == 0)\n\n        printf(\"Second\\n\");\n\n    else\n\n        printf(\"First\\n\");\n\n\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "835",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <string>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <vector>\n\n\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst ll mol=1000000007;\n\nconst int maxn=1000000;\n\nconst double PI=acos(-1.0);\n\nchar ch[maxn];\n\nint main()\n\n{\n\n#ifdef LOCAL\n\nfreopen(\"3.h\",\"r\",stdin);\n\n#endif\n\n    scanf(\"%s\",ch);\n\n    int len=strlen(ch);int num=0;\n\n    int dp1=0,dp2=0;\n\n    for(int i=1;i<len-1;i++)\n\n    if(ch[i+1]!=ch[i-1])num++;\n\n    /*for(int i=2;i<len-2;i++)\n\n    {\n\n        if(ch[i+1]!=ch[i-1])\n\n        {\n\n            if(ch[i-2]==ch[i]&&ch[i+2]==ch[i])dp1=1;\n\n            else if(ch[i-2]==ch[i+1]&&ch[i+2]==ch[i-1])dp1=1;\n\n            else if((ch[i-2]==ch[i]||ch[i+2]==ch[i])&&(ch[i-2]==ch[i+1]||ch[i+2]==ch[i-1]))dp2=1;\n\n            else dp1=1;\n\n        }\n\n    }\n\n    if((num%2)==0&&dp2==0)printf(\"Second\");\n\n    else printf(\"First\");*/\n\n    if(num==0)printf(\"Second\");\n\n    //else if(num==1)printf(\"First\");\n\n    else if(ch[0]==ch[len-1])\n\n    {\n\n        if(!(len%2))printf(\"First\");\n\n        else printf(\"Second\");\n\n    }\n\n    else\n\n    {\n\n        if(len%2)printf(\"First\");\n\n        else printf(\"Second\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "836",
        "source_code": "#define bi\n\n#include <iostream>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cmath>\n\n#include<cstring>\n\n#include<algorithm>\n\n#include<set>\n\n#include<map>\n\n#include<vector>\n\n#include<queue>\n\n#include<string>\n\n#define MP make_pair\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst ll maxn=1e5+10;\n\nconst ll mod=1e9+7;\n\nchar ch[maxn];\n\n\n\nint main()\n\n{\n\n#ifdef bibi\n\n    freopen(\"in.txt\",\"r\",stdin);\n\n#endif\n\n    ios::sync_with_stdio(false);\n\n    cin.tie(0);\n\n    cin>>ch;\n\n    ll len=strlen(ch);\n\n    if(ch[0]==ch[len-1])\n\n    {\n\n        if(len%2==0)\n\n            cout<<\"First\";\n\n        else\n\n            cout<<\"Second\";\n\n    }\n\n    else\n\n    {\n\n        if(len%2==0)\n\n            cout<<\"Second\";\n\n        else\n\n            cout<<\"First\";\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "837",
        "source_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <assert.h>\n\n#define IOS ios::sync_with_stdio(false)\n\nusing namespace std;\n\n#define inf (0x3f3f3f3f)\n\ntypedef long long int LL;\n\n\n\n\n\n#include <iostream>\n\n#include <sstream>\n\n#include <vector>\n\n#include <set>\n\n#include <map>\n\n#include <queue>\n\n#include <string>\n\n#include <bitset>\n\n#include <list>\n\nlist<char>theList;\n\nconst int maxn = 1e5 + 20;\n\nchar str[maxn];\n\nvoid work() {\n\n    scanf(\"%s\", str + 1);\n\n    int lenstr = strlen(str + 1);\n\n    for (int i = 1; i <= lenstr; ++i) {\n\n        theList.push_back(str[i]);\n\n    }\n\n//    for (list<char> :: iterator it = theList.begin(); it != theList.end(); ++it) {\n\n//        cout << *it;\n\n//    }\n\n    int ans = 0;\n\n    while (theList.size() > 2) {\n\n        if (theList.size() == 3 && theList.front() == theList.back()) break;\n\n        list<char> :: iterator itBegin = theList.begin();\n\n        itBegin++;\n\n        list<char> :: iterator itEnd = theList.end();\n\n        itEnd--;\n\n        list<char> :: iterator itBeginPre = theList.begin();\n\n        list<char> :: iterator itBeginNext = itBegin; itBeginNext++;\n\n        bool flag = false;\n\n        while (itBegin != itEnd) {\n\n            if (*itBeginPre == *itBeginNext) {\n\n                itBeginPre++;\n\n                itBegin++;\n\n                itBeginNext++;\n\n            } else {\n\n                theList.erase(itBegin);\n\n                flag = true;\n\n                break;\n\n            }\n\n        }\n\n        if (!flag) break;\n\n        ans++;\n\n    }\n\n//    cout << ans << endl;\n\n    if (ans & 1) {\n\n        cout << \"First\" << endl;\n\n    } else cout << \"Second\" << endl;\n\n}\n\n\n\nint main() {\n\n#ifdef local\n\n    freopen(\"data.txt\", \"r\", stdin);\n\n//    freopen(\"data.txt\", \"w\", stdout);\n\n#endif\n\n    work();\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "838",
        "source_code": "#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <assert.h>\n\n#define IOS ios::sync_with_stdio(false)\n\nusing namespace std;\n\n#define inf (0x3f3f3f3f)\n\ntypedef long long int LL;\n\n\n\n\n\n#include <iostream>\n\n#include <sstream>\n\n#include <vector>\n\n#include <set>\n\n#include <map>\n\n#include <queue>\n\n#include <string>\n\n#include <bitset>\n\n#include <list>\n\nlist<char>theList;\n\nconst int maxn = 1e5 + 20;\n\nchar str[maxn];\n\nvoid work() {\n\n    scanf(\"%s\", str + 1);\n\n    int lenstr = strlen(str + 1);\n\n    lenstr -= 2;\n\n    if (str[1] == str[strlen(str + 1)]) lenstr--;\n\n    if (lenstr & 1) {\n\n        cout << \"First\" << endl;\n\n    } else cout << \"Second\" << endl;\n\n}\n\n\n\nint main() {\n\n#ifdef local\n\n    freopen(\"data.txt\", \"r\", stdin);\n\n//    freopen(\"data.txt\", \"w\", stdout);\n\n#endif\n\n    work();\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "839",
        "source_code": "#include <cstdio>\n\n#include <iostream>\n\n#include <cstring>\n\n#include <algorithm>\n\nusing namespace std;\n\nconst int maxn=1e5+10;\n\nchar str[maxn];\n\nint main()\n\n{\n\n   cin>>str;\n\n   int len=strlen(str);\n\n   if (str[0]==str[len-1]){\n\n       if (len&1){\n\n         cout<<\"Second\\n\";\n\n\n\n       }\n\n       else cout<<\"First\\n\";\n\n\n\n   }\n\n   else {\n\n      if (len&1){\n\n         cout<<\"First\\n\";\n\n      }\n\n      else cout<<\"Second\\n\";\n\n   }\n\n\n\n   return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "840",
        "source_code": "#include <iostream>\n\n#include <algorithm>\n\n#include <cstdio>\n\n#include <cstdlib>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <stack>\n\n#include <queue>\n\n#include <vector>\n\n#include <map>\n\n#include <set>\n\nusing namespace std;\n\n#define ll long long\n\nchar s[300005];\n\n\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int l=strlen(s);\n\n    int x=l-2;\n\n    if(s[0]==s[l-1])\n\n    {\n\n        if(x%2==0) printf(\"First\");\n\n        else printf(\"Second\");\n\n    }\n\n    else\n\n    {\n\n        if(x%2==1) printf(\"First\");\n\n        else printf(\"Second\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "841",
        "source_code": "#include<bits/stdc++.h>\n\n#define rep(i,j,k) for(int i=(j);i<(k);i++)\n\n#define mp make_pair\n\n#define sz(a) (int)(a).size()\n\n#define pb push_back\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef pair<int,int> pii;\n\ntypedef pair<double,double> pdd;\n\ntypedef long double ld;\n\n//----head----\n\nchar str[100005];\n\nint main()\n\n{\n\n\tscanf(\"%s\",str);\n\n\tint n=strlen(str);\n\n\tint ans=(str[0]==str[n-1]);\n\n\tans^=(n%2);\n\n\tputs(ans?\"First\":\"Second\");\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "842",
        "source_code": "#include <iostream>\n\n#include <cstdlib>\n\n#include <algorithm>\n\n#include <cstdio>\n\n#include <cmath>\n\n#include <cstring>\n\n\n\nusing namespace std;\n\n\n\nchar s[100005];\n\n\n\nint main() {\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    if ((len&1)!=(s[0]==s[len-1])) printf(\"First\\n\"); else printf(\"Second\\n\");\n\n\n\n    return 0;\n\n}\n\n\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "843",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\nconst int maxn=1e5+5;\n\nchar a[maxn];\n\nint main()\n\n{\n\n    while(~scanf(\"%s\", a))\n\n    {\n\n        int len=strlen(a);\n\n        if(len&1)\n\n        {\n\n            if(a[0]==a[len-1])printf(\"Second\\n\");\n\n            else printf(\"First\\n\");\n\n        }\n\n        else\n\n        {\n\n            if(a[0]==a[len-1])printf(\"First\\n\");\n\n            else printf(\"Second\\n\");\n\n        }\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "844",
        "source_code": "#include<bits/stdc++.h>\n\n\n\nusing namespace std;\n\nconst int N=112345;\n\n\n\nchar s[N];\n\n\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    set<char>S;\n\n    for(int i=0;i<=len-1;i++)\n\n        S.insert(s[i]);\n\n    if(S.size()>2)\n\n    {\n\n        if(s[0]==s[len-1])\n\n        {\n\n            if ((len - 3) % 2 == 0)printf(\"Second\\n\");\n\n            else printf(\"First\\n\");\n\n        }\n\n        else {\n\n            if ((len - 2) % 2 == 0)printf(\"Second\\n\");\n\n            else printf(\"First\\n\");\n\n        }\n\n    }\n\n    else if(S.size()==2)\n\n    {\n\n        printf(\"Second\\n\");\n\n    }\n\n    else if(S.size()==1)\n\n    {\n\n        printf(\"Second\\n\");\n\n    }\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "845",
        "source_code": "#include<iostream>\n\n#include <math.h>\n\n#include <bits/stdc++.h>\n\n#define ll long long\n\n#define inf 0x3f3f3f3f\n\n#define maxn 310000\n\nusing namespace std;\n\nint vis[maxn];\n\nchar s[111111];\n\nint main()\n\n{\n\n    int i,j,n,jj=0,sum=0,k,flag;\n\n    cin>>s;\n\n    n=strlen(s);\n\n    if(n%2==0)\n\n    {\n\n        if(s[0]==s[n-1]) \n\n            printf(\"First\\n\");\n\n        else printf(\"Second\\n\");\n\n    }\n\n    if(n%2!=0)\n\n    {\n\n        if(s[0]!=s[n-1]) \n\n            printf(\"First\\n\");\n\n        else printf(\"Second\\n\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "846",
        "source_code": "/*QAQ\u4e09\u8fde\uff1a\u4ee5\u524d\u7684\u9898\u90fd\u8865\u4e86\u5417\uff0c\u4eca\u5929\u7684\u9898\u90fd\u505a\u4e86\u5417\uff0c\u4e0d\u4f1a\u7684\u7b97\u6cd5\u90fd\u4f1a\u4e86\u5417*/\n\n/*\u91d1\u6854\u9000\u5f79\u4e09\u8fde\uff1a\u9000\u5f79\u9009\u624b\u4e0d\u5b66\u4e0d\u4f1a\u4e0d\u7ec3*/\n\n#include <bits/stdc++.h>\n\n#define LDQ 1000000007\n\n#define QAQ 0x3f3f3f3f\n\n#define PI 3.14159265358979323846\n\nusing namespace std;\n\nint main()\n\n{\n\n    int i;\n\n    char s[100001];\n\n    scanf(\"%s\",s);\n\n    if(strlen(s)%2==0)\n\n    {\n\n        if(s[0]==s[strlen(s)-1])\n\n        {\n\n            printf(\"First\");\n\n        }\n\n        else\n\n        {\n\n            printf(\"Second\");\n\n        }\n\n    }\n\n    else\n\n    {\n\n        if(s[0]==s[strlen(s)-1])\n\n        {\n\n            printf(\"Second\");\n\n        }\n\n        else\n\n        {\n\n            printf(\"First\");\n\n        }\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "847",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n    string s;\n\n    cin >> s;\n\n    if(s[0] == s[s.size() - 1])\n\n        cout << (s.size() & 1 ? \"Second\" : \"First\");\n\n    else\n\n        cout << (s.size() & 1 ? \"First\" : \"Second\");\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "848",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint s1,s2,a;\n\nchar c[100010],c1,c2;\n\nint main(){\n\n\tscanf(\"%s\",c+1);\n\n\ta=strlen(c+1);\n\n\tc1=c[1],c2=c[a];\n\n\tif((c1==c2&&a%2==0)||c1!=c2&&a%2!=0) cout<<\"First\";\n\n\telse cout<<\"Second\"; \n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "849",
        "source_code": "#include <iostream>\n\nusing namespace std;\n\n\n\nint main(){\n\n\tstring s;\n\n\tcin >> s;\n\n\tint ans = s.size()-2;\n\n\t\n\n\tif(s[0]==s[s.size()-1]) ans-=1;\n\n\tif(ans&1) cout << \"First\";\t//\u957f\u5ea6\u4e3a\u5947\u6570\n\n\telse cout << \"Second\"; \n\n}",
        "optimized_code": "#include<cstdio>\n\nconst int N=100001;\n\nint main() {\n\n    int n=3;\n\n    char s[N];\n\n    scanf(\"%s\",s);\n\n    while(s[n])n++;\n\n    printf((s[0]==s[n-1] ^ n&1)?\"First\":\"Second\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "850",
        "source_code": "#include<bits/stdc++.h>\n\n#define LL long long\n\nusing namespace std;\n\nconst int maxn=1e5+10;\n\nint n;\n\nchar a[maxn];\n\nint main()\n\n{\n\n    while(scanf(\"%s\",a)!=EOF)\n\n    {\n\n        int ans=0;\n\n        int len=strlen(a);\n\n        for(int i=1; i<len-1; i++)\n\n            if(a[i-1]!=a[i+1])ans++;\n\n        if(ans==0)\n\n        {\n\n            printf(\"Second\\n\");\n\n            continue;\n\n        }\n\n        if(a[0]!=a[len-1])printf(\"%s\\n\",len%2?\"First\":\"Second\");\n\n        else printf(\"%s\\n\",len%2?\"Second\":\"First\");\n\n    }\n\n}\n\n\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nchar s[100003];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int l=strlen(s);\n\n    if((s[0]==s[l-1])!=(l%2==0)) puts(\"Second\");\n\n\telse puts(\"First\");\n\n}"
    },
    {
        "id": "851",
        "source_code": "#include<iostream>\n\n#include<cstring>\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[100000];\n\n    cin>>s;\n\n    long long t=strlen(s);\n\n    if(s[0]==s[strlen(s)-1]){\n\n    \tif(t%2==1) cout<<\"Second\"<<endl;\n\n    \telse cout<<\"First\"<<endl;\n\n\t}\n\n\telse{\n\n\t\tif(t%2==0) cout<<\"Second\"<<endl;\n\n    \telse cout<<\"First\"<<endl;\n\n\t}\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<cmath>\n\n#include<algorithm>\n\nusing namespace std;\n\nint n;\n\nchar s[100005];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s+1);\n\n\tn=strlen(s+1);\n\n\tif(s[1]==s[n])\n\n\t{\n\n\t\tif(n%2==0)\n\n\t\t\tputs(\"First\");\n\n\t\telse\n\n\t\t\tputs(\"Second\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif(n%2==0)\n\n\t\t\tputs(\"Second\");\n\n\t\telse\n\n\t\t\tputs(\"First\");\n\n\t}\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "852",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar a[100001]; \n\nint main()\n\n{\n\n\tscanf(\"%s\",a);\n\n\tint lena=strlen(a);\n\n\tif(a[0]==a[lena-1])\n\n\t{\n\n\t\tif((lena-2)%2==1)\n\n\t\t\tprintf(\"Second\");\n\n\t\tif((lena-2)%2==0)\n\n\t\t\tprintf(\"First\");\n\n\t}\n\n\telse{\n\n\t\tif((lena-2)%2==1)\n\n\t\t\tprintf(\"First\");\n\n\t\tif((lena-2)%2==0)\n\n\t\t\tprintf(\"Second\");\n\n\t}\n\n} ",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<cmath>\n\n#include<algorithm>\n\nusing namespace std;\n\nint n;\n\nchar s[100005];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s+1);\n\n\tn=strlen(s+1);\n\n\tif(s[1]==s[n])\n\n\t{\n\n\t\tif(n%2==0)\n\n\t\t\tputs(\"First\");\n\n\t\telse\n\n\t\t\tputs(\"Second\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif(n%2==0)\n\n\t\t\tputs(\"Second\");\n\n\t\telse\n\n\t\t\tputs(\"First\");\n\n\t}\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "853",
        "source_code": "/*         _    _____         _\n\n           \\`,\"\"   ,'7\"r-..__/ \\\n\n          ,'\\ `, ,',','    _/   \\\n\n         /   \\  7 / /     (   \\ |\n\n        J     / j  L______\\  / |\n\n        L   __JF\"\"\"/\"\"\\\"\\_,    /\n\n        L,-\"| O|  f O |  L_  _/\n\n        F   \\_ /  \\__/   `-  j|\n\n            .-'    `\"\"\"    ,' |          _..====.._\n\n            \\__/         r\"_  A        ,' _..---.._`,\n\n             `-.______,,-L// / \\  ___,' ,'_..:::.. `,`,\n\n                      j   / / / 7\"    `-<\"\"=:'  '':. \\ \\\n\n                     /   <,' /  F  . i , \\   `,    :T W I\n\n                     |    \\,'  /    >X<  |     \\   :| | L\n\n                     |     `._/    ' ! ` |      I  :| |  G\n\n                      \\           \\     /       |  :H T  |\n\n                     __>-.__   __,-\\   |        |  S P   |\n\n                    /     /|   | \\  \\  \\_       | 'A R   |\n\n                   /   __/ |   |  L  L   \\      K./ /    L\n\n                  /   |    |   4  I  I    |    E./ /   ,'\n\n                 J    \\    I    L F  I    |    // / _,'\n\n        _________|     |   F    |J   F    |   //_/-'\n\n        \\   __   |    /   J     |/  J     |  /=\"\n\n        \\\\  \\_\\  \\__,' \\  F     |   F     |\n\n        \\\\\\_____________/      F__/      F\n\n         \\\\| \u00bc\u00c6\u00cb\u00e3\u00bb\u00fa\u00b1\u00e0\u00b3\u00cc |_____/  (______/\n\n          /\u00b4\u00d3\u00c8\u00eb\u00c3\u00c5\u00b5\u00bd\u00c8\u00eb\u00cd\u00c1/\n\n*/\n\n#include<cstdio>\n\n#include<iostream>\n\n#include<algorithm>\n\n#include<cstring>\n\n#include<string> \n\nusing namespace std;\n\nint main(){\n\n\tstring s;\n\n\tcin>>s;\n\n\tint len=s.length();\n\n\tif(s[0]==s[len-1]){\n\n\t\tif(len%2==1){\n\n\t\t\tcout<<\"Second\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\telse{\n\n\t\t\tcout<<\"First\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\telse{\n\n\t\tif(len%2==1){\n\n\t\t\tcout<<\"First\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\telse{\n\n\t\t\tcout<<\"Second\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<cmath>\n\n#include<algorithm>\n\nusing namespace std;\n\nint n;\n\nchar s[100005];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s+1);\n\n\tn=strlen(s+1);\n\n\tif(s[1]==s[n])\n\n\t{\n\n\t\tif(n%2==0)\n\n\t\t\tputs(\"First\");\n\n\t\telse\n\n\t\t\tputs(\"Second\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif(n%2==0)\n\n\t\t\tputs(\"Second\");\n\n\t\telse\n\n\t\t\tputs(\"First\");\n\n\t}\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "854",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar a[100005];\n\nint main()\n\n{\n\n\tscanf(\"%s\",&a);\n\n\tif(a[0]==a[strlen(a)-1]){\n\n\t\tif(strlen(a)%2!=0){\n\n\t\t\tprintf(\"Second\\n\");\n\n\t\t}\n\n\t\telse{\n\n\t\t\tprintf(\"First\\n\");\n\n\t\t}\n\n\t}\n\n\telse{\n\n\t\tif(strlen(a)%2!=0){\n\n\t\t\tprintf(\"First\\n\");\n\n\t\t}\n\n\t\telse{\n\n\t\t\tprintf(\"Second\\n\");\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<cmath>\n\n#include<algorithm>\n\nusing namespace std;\n\nint n;\n\nchar s[100005];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s+1);\n\n\tn=strlen(s+1);\n\n\tif(s[1]==s[n])\n\n\t{\n\n\t\tif(n%2==0)\n\n\t\t\tputs(\"First\");\n\n\t\telse\n\n\t\t\tputs(\"Second\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif(n%2==0)\n\n\t\t\tputs(\"Second\");\n\n\t\telse\n\n\t\t\tputs(\"First\");\n\n\t}\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "855",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\n\n\nint main()\n\n{\n\n    cin >> s;\n\n    int len = s.length();\n\n    if(len & 1)\n\n    {\n\n        if(s[0] == s[len - 1]) cout << \"Second\";\n\n        else cout << \"First\";\n\n    }\n\n    else\n\n    {\n\n        if(s[0] ^ s[len - 1]) cout << \"Second\";\n\n        else cout << \"First\";\n\n    }\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<cmath>\n\n#include<algorithm>\n\nusing namespace std;\n\nint n;\n\nchar s[100005];\n\nint main()\n\n{\n\n\tscanf(\"%s\",s+1);\n\n\tn=strlen(s+1);\n\n\tif(s[1]==s[n])\n\n\t{\n\n\t\tif(n%2==0)\n\n\t\t\tputs(\"First\");\n\n\t\telse\n\n\t\t\tputs(\"Second\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif(n%2==0)\n\n\t\t\tputs(\"Second\");\n\n\t\telse\n\n\t\t\tputs(\"First\");\n\n\t}\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "856",
        "source_code": "#include<iostream>\n\n#include<cstring>\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[100000];\n\n    cin>>s;\n\n    long long t=strlen(s);\n\n    if(s[0]==s[strlen(s)-1]){\n\n    \tif(t%2==1) cout<<\"Second\"<<endl;\n\n    \telse cout<<\"First\"<<endl;\n\n\t}\n\n\telse{\n\n\t\tif(t%2==0) cout<<\"Second\"<<endl;\n\n    \telse cout<<\"First\"<<endl;\n\n\t}\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nchar s[100003];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int l=strlen(s);\n\n    if((s[0]==s[l-1])!=(l%2==0)) puts(\"Second\");\n\n\telse puts(\"First\");\n\n}"
    },
    {
        "id": "857",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar a[100001]; \n\nint main()\n\n{\n\n\tscanf(\"%s\",a);\n\n\tint lena=strlen(a);\n\n\tif(a[0]==a[lena-1])\n\n\t{\n\n\t\tif((lena-2)%2==1)\n\n\t\t\tprintf(\"Second\");\n\n\t\tif((lena-2)%2==0)\n\n\t\t\tprintf(\"First\");\n\n\t}\n\n\telse{\n\n\t\tif((lena-2)%2==1)\n\n\t\t\tprintf(\"First\");\n\n\t\tif((lena-2)%2==0)\n\n\t\t\tprintf(\"Second\");\n\n\t}\n\n} ",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nchar s[100003];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int l=strlen(s);\n\n    if((s[0]==s[l-1])!=(l%2==0)) puts(\"Second\");\n\n\telse puts(\"First\");\n\n}"
    },
    {
        "id": "858",
        "source_code": "/*         _    _____         _\n\n           \\`,\"\"   ,'7\"r-..__/ \\\n\n          ,'\\ `, ,',','    _/   \\\n\n         /   \\  7 / /     (   \\ |\n\n        J     / j  L______\\  / |\n\n        L   __JF\"\"\"/\"\"\\\"\\_,    /\n\n        L,-\"| O|  f O |  L_  _/\n\n        F   \\_ /  \\__/   `-  j|\n\n            .-'    `\"\"\"    ,' |          _..====.._\n\n            \\__/         r\"_  A        ,' _..---.._`,\n\n             `-.______,,-L// / \\  ___,' ,'_..:::.. `,`,\n\n                      j   / / / 7\"    `-<\"\"=:'  '':. \\ \\\n\n                     /   <,' /  F  . i , \\   `,    :T W I\n\n                     |    \\,'  /    >X<  |     \\   :| | L\n\n                     |     `._/    ' ! ` |      I  :| |  G\n\n                      \\           \\     /       |  :H T  |\n\n                     __>-.__   __,-\\   |        |  S P   |\n\n                    /     /|   | \\  \\  \\_       | 'A R   |\n\n                   /   __/ |   |  L  L   \\      K./ /    L\n\n                  /   |    |   4  I  I    |    E./ /   ,'\n\n                 J    \\    I    L F  I    |    // / _,'\n\n        _________|     |   F    |J   F    |   //_/-'\n\n        \\   __   |    /   J     |/  J     |  /=\"\n\n        \\\\  \\_\\  \\__,' \\  F     |   F     |\n\n        \\\\\\_____________/      F__/      F\n\n         \\\\| \u00bc\u00c6\u00cb\u00e3\u00bb\u00fa\u00b1\u00e0\u00b3\u00cc |_____/  (______/\n\n          /\u00b4\u00d3\u00c8\u00eb\u00c3\u00c5\u00b5\u00bd\u00c8\u00eb\u00cd\u00c1/\n\n*/\n\n#include<cstdio>\n\n#include<iostream>\n\n#include<algorithm>\n\n#include<cstring>\n\n#include<string> \n\nusing namespace std;\n\nint main(){\n\n\tstring s;\n\n\tcin>>s;\n\n\tint len=s.length();\n\n\tif(s[0]==s[len-1]){\n\n\t\tif(len%2==1){\n\n\t\t\tcout<<\"Second\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\telse{\n\n\t\t\tcout<<\"First\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\telse{\n\n\t\tif(len%2==1){\n\n\t\t\tcout<<\"First\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\telse{\n\n\t\t\tcout<<\"Second\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nchar s[100003];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int l=strlen(s);\n\n    if((s[0]==s[l-1])!=(l%2==0)) puts(\"Second\");\n\n\telse puts(\"First\");\n\n}"
    },
    {
        "id": "859",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar a[100005];\n\nint main()\n\n{\n\n\tscanf(\"%s\",&a);\n\n\tif(a[0]==a[strlen(a)-1]){\n\n\t\tif(strlen(a)%2!=0){\n\n\t\t\tprintf(\"Second\\n\");\n\n\t\t}\n\n\t\telse{\n\n\t\t\tprintf(\"First\\n\");\n\n\t\t}\n\n\t}\n\n\telse{\n\n\t\tif(strlen(a)%2!=0){\n\n\t\t\tprintf(\"First\\n\");\n\n\t\t}\n\n\t\telse{\n\n\t\t\tprintf(\"Second\\n\");\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nchar s[100003];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int l=strlen(s);\n\n    if((s[0]==s[l-1])!=(l%2==0)) puts(\"Second\");\n\n\telse puts(\"First\");\n\n}"
    },
    {
        "id": "860",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\n\n\nint main()\n\n{\n\n    cin >> s;\n\n    int len = s.length();\n\n    if(len & 1)\n\n    {\n\n        if(s[0] == s[len - 1]) cout << \"Second\";\n\n        else cout << \"First\";\n\n    }\n\n    else\n\n    {\n\n        if(s[0] ^ s[len - 1]) cout << \"Second\";\n\n        else cout << \"First\";\n\n    }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nchar s[100003];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int l=strlen(s);\n\n    if((s[0]==s[l-1])!=(l%2==0)) puts(\"Second\");\n\n\telse puts(\"First\");\n\n}"
    },
    {
        "id": "861",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring a;\n\nint main()\n\n{\n\n\tcin>>a;\n\n\tint l=a.size();\n\n\tif(a[0]==a[l-1])\n\n\t\tif(l&1) printf(\"Second\\n\");\n\n\t\telse printf(\"First\\n\");\n\n\telse \n\n\t\tif(l&1) printf(\"First\\n\");\n\n\t\telse printf(\"Second\\n\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nchar s[100003];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int l=strlen(s);\n\n    if((s[0]==s[l-1])!=(l%2==0)) puts(\"Second\");\n\n\telse puts(\"First\");\n\n}"
    },
    {
        "id": "862",
        "source_code": "#include<iostream>\n\n#include<cstring>\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[100000];\n\n    cin>>s;\n\n    long long t=strlen(s);\n\n    if(s[0]==s[strlen(s)-1]){\n\n    \tif(t%2==1) cout<<\"Second\"<<endl;\n\n    \telse cout<<\"First\"<<endl;\n\n\t}\n\n\telse{\n\n\t\tif(t%2==0) cout<<\"Second\"<<endl;\n\n    \telse cout<<\"First\"<<endl;\n\n\t}\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nint Len;\n\nchar s[ 100005 ];\n\nint main() {\n\n\tscanf (\"%s\", s);\n\n\tLen = strlen(s);\n\n\tprintf (\"%s\\n\", ((Len % 2 == 1) ^ (s[ 0 ] == s[ Len - 1 ])) ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "863",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar a[100001]; \n\nint main()\n\n{\n\n\tscanf(\"%s\",a);\n\n\tint lena=strlen(a);\n\n\tif(a[0]==a[lena-1])\n\n\t{\n\n\t\tif((lena-2)%2==1)\n\n\t\t\tprintf(\"Second\");\n\n\t\tif((lena-2)%2==0)\n\n\t\t\tprintf(\"First\");\n\n\t}\n\n\telse{\n\n\t\tif((lena-2)%2==1)\n\n\t\t\tprintf(\"First\");\n\n\t\tif((lena-2)%2==0)\n\n\t\t\tprintf(\"Second\");\n\n\t}\n\n} ",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nint Len;\n\nchar s[ 100005 ];\n\nint main() {\n\n\tscanf (\"%s\", s);\n\n\tLen = strlen(s);\n\n\tprintf (\"%s\\n\", ((Len % 2 == 1) ^ (s[ 0 ] == s[ Len - 1 ])) ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "864",
        "source_code": "/*         _    _____         _\n\n           \\`,\"\"   ,'7\"r-..__/ \\\n\n          ,'\\ `, ,',','    _/   \\\n\n         /   \\  7 / /     (   \\ |\n\n        J     / j  L______\\  / |\n\n        L   __JF\"\"\"/\"\"\\\"\\_,    /\n\n        L,-\"| O|  f O |  L_  _/\n\n        F   \\_ /  \\__/   `-  j|\n\n            .-'    `\"\"\"    ,' |          _..====.._\n\n            \\__/         r\"_  A        ,' _..---.._`,\n\n             `-.______,,-L// / \\  ___,' ,'_..:::.. `,`,\n\n                      j   / / / 7\"    `-<\"\"=:'  '':. \\ \\\n\n                     /   <,' /  F  . i , \\   `,    :T W I\n\n                     |    \\,'  /    >X<  |     \\   :| | L\n\n                     |     `._/    ' ! ` |      I  :| |  G\n\n                      \\           \\     /       |  :H T  |\n\n                     __>-.__   __,-\\   |        |  S P   |\n\n                    /     /|   | \\  \\  \\_       | 'A R   |\n\n                   /   __/ |   |  L  L   \\      K./ /    L\n\n                  /   |    |   4  I  I    |    E./ /   ,'\n\n                 J    \\    I    L F  I    |    // / _,'\n\n        _________|     |   F    |J   F    |   //_/-'\n\n        \\   __   |    /   J     |/  J     |  /=\"\n\n        \\\\  \\_\\  \\__,' \\  F     |   F     |\n\n        \\\\\\_____________/      F__/      F\n\n         \\\\| \u00bc\u00c6\u00cb\u00e3\u00bb\u00fa\u00b1\u00e0\u00b3\u00cc |_____/  (______/\n\n          /\u00b4\u00d3\u00c8\u00eb\u00c3\u00c5\u00b5\u00bd\u00c8\u00eb\u00cd\u00c1/\n\n*/\n\n#include<cstdio>\n\n#include<iostream>\n\n#include<algorithm>\n\n#include<cstring>\n\n#include<string> \n\nusing namespace std;\n\nint main(){\n\n\tstring s;\n\n\tcin>>s;\n\n\tint len=s.length();\n\n\tif(s[0]==s[len-1]){\n\n\t\tif(len%2==1){\n\n\t\t\tcout<<\"Second\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\telse{\n\n\t\t\tcout<<\"First\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\telse{\n\n\t\tif(len%2==1){\n\n\t\t\tcout<<\"First\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\telse{\n\n\t\t\tcout<<\"Second\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nint Len;\n\nchar s[ 100005 ];\n\nint main() {\n\n\tscanf (\"%s\", s);\n\n\tLen = strlen(s);\n\n\tprintf (\"%s\\n\", ((Len % 2 == 1) ^ (s[ 0 ] == s[ Len - 1 ])) ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "865",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar a[100005];\n\nint main()\n\n{\n\n\tscanf(\"%s\",&a);\n\n\tif(a[0]==a[strlen(a)-1]){\n\n\t\tif(strlen(a)%2!=0){\n\n\t\t\tprintf(\"Second\\n\");\n\n\t\t}\n\n\t\telse{\n\n\t\t\tprintf(\"First\\n\");\n\n\t\t}\n\n\t}\n\n\telse{\n\n\t\tif(strlen(a)%2!=0){\n\n\t\t\tprintf(\"First\\n\");\n\n\t\t}\n\n\t\telse{\n\n\t\t\tprintf(\"Second\\n\");\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nint Len;\n\nchar s[ 100005 ];\n\nint main() {\n\n\tscanf (\"%s\", s);\n\n\tLen = strlen(s);\n\n\tprintf (\"%s\\n\", ((Len % 2 == 1) ^ (s[ 0 ] == s[ Len - 1 ])) ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "866",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\n\n\nint main()\n\n{\n\n    cin >> s;\n\n    int len = s.length();\n\n    if(len & 1)\n\n    {\n\n        if(s[0] == s[len - 1]) cout << \"Second\";\n\n        else cout << \"First\";\n\n    }\n\n    else\n\n    {\n\n        if(s[0] ^ s[len - 1]) cout << \"Second\";\n\n        else cout << \"First\";\n\n    }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nint Len;\n\nchar s[ 100005 ];\n\nint main() {\n\n\tscanf (\"%s\", s);\n\n\tLen = strlen(s);\n\n\tprintf (\"%s\\n\", ((Len % 2 == 1) ^ (s[ 0 ] == s[ Len - 1 ])) ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "867",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring a;\n\nint main()\n\n{\n\n\tcin>>a;\n\n\tint l=a.size();\n\n\tif(a[0]==a[l-1])\n\n\t\tif(l&1) printf(\"Second\\n\");\n\n\t\telse printf(\"First\\n\");\n\n\telse \n\n\t\tif(l&1) printf(\"First\\n\");\n\n\t\telse printf(\"Second\\n\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nint Len;\n\nchar s[ 100005 ];\n\nint main() {\n\n\tscanf (\"%s\", s);\n\n\tLen = strlen(s);\n\n\tprintf (\"%s\\n\", ((Len % 2 == 1) ^ (s[ 0 ] == s[ Len - 1 ])) ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "868",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main() {\n\n\tstring s;\n\n\tcin>>s;\n\n\tif(s[0]==s[s.size()-1]) {\n\n\t\tif(s.size()%2==0) {\n\n\t\t\tcout<<\"First\"<<endl;\n\n\t\t} else {\n\n\t\t\tcout<<\"Second\"<<endl;\n\n\t\t}\n\n\t}\n\n\tif(s[0]!=s[s.size()-1]) {\n\n\t\tif(s.size()%2==1) {\n\n\t\t\tcout<<\"First\"<<endl;\n\n\t\t} else {\n\n\t\t\tcout<<\"Second\"<<endl;\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nint Len;\n\nchar s[ 100005 ];\n\nint main() {\n\n\tscanf (\"%s\", s);\n\n\tLen = strlen(s);\n\n\tprintf (\"%s\\n\", ((Len % 2 == 1) ^ (s[ 0 ] == s[ Len - 1 ])) ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "869",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n\n\nusing namespace std;\n\n\n\nchar s[100000+5];\n\n\n\nint main()\n\n{\n\n\tscanf(\"%s\",s+1);int len=strlen(s+1);\n\n\tif(s[1]==s[len] && len%2==1) puts(\"Second\");\n\n\telse if(s[1]==s[len] && len%2==0)  puts(\"First\");\n\n\telse if(s[1]!=s[len] && len%2==1) puts(\"First\");\n\n\telse if(s[1]!=s[len] && len%2==0)puts(\"Second\");\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nint Len;\n\nchar s[ 100005 ];\n\nint main() {\n\n\tscanf (\"%s\", s);\n\n\tLen = strlen(s);\n\n\tprintf (\"%s\\n\", ((Len % 2 == 1) ^ (s[ 0 ] == s[ Len - 1 ])) ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "870",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n  string a;\n\n  cin>>a;\n\n  int k=a.length();\n\n  if(a[0]==a[k-1])\n\n  {\n\n    if(k%2==0)\n\n\t{\n\n      cout<<\"First\"<<endl;\n\n      return 0;\n\n    }\n\n    else\n\n\t{\n\n      cout<<\"Second\"<<endl;\n\n      return 0;\n\n    }\n\n  }\n\n  else\n\n  {\n\n    if(k%2==0)\n\n\t{\n\n      cout<<\"Second\"<<endl;\n\n      return 0;\n\n    }\n\n    else\n\n\t{\n\n      cout<<\"First\"<<endl;\n\n      return 0;\n\n    }\n\n  }\n\n  return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nint Len;\n\nchar s[ 100005 ];\n\nint main() {\n\n\tscanf (\"%s\", s);\n\n\tLen = strlen(s);\n\n\tprintf (\"%s\\n\", ((Len % 2 == 1) ^ (s[ 0 ] == s[ Len - 1 ])) ? \"First\" : \"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "871",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n \n\nint main()\n\n{\n\n    string s;\n\n    while(cin>>s)\n\n    {\n\n        cout << ( (s[0]==s[s.length()-1])^(s.length()%2)?\"First\":\"Second\") << endl;\n\n    }\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\nchar s[100005];\n\ninline int getstring(char *_s){\n\n\tint l=0;\n\n\tfor(char ch=getchar();ch!='\\n';ch=getchar(),l++)\n\n\t\t_s[l]=ch;\n\n\treturn l;\n\n}\n\nint main(){\n\n\tint l=getstring(s);\n\n\tprintf(\"%s\",(s[0]==s[l-1])^(l%2)?\"First\":\"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "872",
        "source_code": "#include<string>\n\n#include<iostream>\n\nusing namespace std;\n\nstring s;\n\nint main(){\n\n\tcin>>s;\n\n\tif(s[0]==s[s.size()-1])\n\n\t  if(s.size()%2==1) cout<<\"Second\";\n\n\t  else cout<<\"First\";\n\n\telse\n\n\t  if(s.size()%2==1) cout<<\"First\";\n\n\t  else cout<<\"Second\";\n\n}",
        "optimized_code": "#include <cstdio>\n\nchar s[100005];\n\ninline int getstring(char *_s){\n\n\tint l=0;\n\n\tfor(char ch=getchar();ch!='\\n';ch=getchar(),l++)\n\n\t\t_s[l]=ch;\n\n\treturn l;\n\n}\n\nint main(){\n\n\tint l=getstring(s);\n\n\tprintf(\"%s\",(s[0]==s[l-1])^(l%2)?\"First\":\"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "873",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar s[100001],ss[100001];\n\nint main()\n\n{    \n\n\tscanf(\"%s\",s+1);\n\n\tregister int sum=0,ans=0,l=strlen(s+1);\n\n\twhile(1)\n\n\t{\n\n\t\tfor(register int i=2;i<l;++i)\n\n\t\t{\n\n\t\t\tif(s[i]!='\\0')\n\n\t\t\t{\n\n\t\t\t\tregister int x=i-1;\n\n\t\t\t\twhile(s[x]=='\\0')\n\n\t\t\t\t\t--x;\n\n\t\t\t\tif(s[x]!=s[i+1])\n\n\t\t\t\t\ts[i]='\\0',++sum;\n\n            }        \n\n\t\t}        \n\n\t\tregister int cnt=0;\n\n\t\tfor(register int i=1;i<=l;++i)\n\n\t\t\tif(s[i]!='\\0')\n\n\t\t\t\tss[++cnt]=s[i];\n\n\t\tfor(register int i=1;i<=l;++i)\n\n\t\t\ts[i]=ss[i];\n\n\t\tl=cnt;\n\n\t\tif(sum==ans)\n\n\t\t\tbreak;\n\n\t\tans=sum;\n\n\t}    \n\n\tif(sum%2) return printf(\"First\"),0;\n\n\telse return printf(\"Second\"),0;\n\n} ",
        "optimized_code": "#include <cstdio>\n\nchar s[100005];\n\ninline int getstring(char *_s){\n\n\tint l=0;\n\n\tfor(char ch=getchar();ch!='\\n';ch=getchar(),l++)\n\n\t\t_s[l]=ch;\n\n\treturn l;\n\n}\n\nint main(){\n\n\tint l=getstring(s);\n\n\tprintf(\"%s\",(s[0]==s[l-1])^(l%2)?\"First\":\"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "874",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint s1,s2,a;\n\nchar c[100010],c1,c2;\n\nint main(){\n\n\tscanf(\"%s\",c+1);\n\n\ta=strlen(c+1);\n\n\tc1=c[1],c2=c[a];\n\n\tif((c1==c2&&a%2==0)||c1!=c2&&a%2!=0) cout<<\"First\";\n\n\telse cout<<\"Second\"; \n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\nchar s[100005];\n\ninline int getstring(char *_s){\n\n\tint l=0;\n\n\tfor(char ch=getchar();ch!='\\n';ch=getchar(),l++)\n\n\t\t_s[l]=ch;\n\n\treturn l;\n\n}\n\nint main(){\n\n\tint l=getstring(s);\n\n\tprintf(\"%s\",(s[0]==s[l-1])^(l%2)?\"First\":\"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "875",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n\tstring d;\n\n\tcin>>d;\n\n\tint tot=0;\n\n\tint g=0;\n\n\tint l=d.size();\n\n\tif(d[0]==d[l-1])\n\n\t{\n\n\t\tif(l%2==0)\n\n\t\tcout<<\"First\";\n\n\t\telse cout<<\"Second\";\n\n\t}\n\n\telse{\n\n\t\tif(l%2==1)cout<<\"First\";\n\n\t\telse cout<<\"Second\";\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\nchar s[100005];\n\ninline int getstring(char *_s){\n\n\tint l=0;\n\n\tfor(char ch=getchar();ch!='\\n';ch=getchar(),l++)\n\n\t\t_s[l]=ch;\n\n\treturn l;\n\n}\n\nint main(){\n\n\tint l=getstring(s);\n\n\tprintf(\"%s\",(s[0]==s[l-1])^(l%2)?\"First\":\"Second\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "876",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n \n\nint main()\n\n{\n\n    string s;\n\n    while(cin>>s)\n\n    {\n\n        cout << ( (s[0]==s[s.length()-1])^(s.length()%2)?\"First\":\"Second\") << endl;\n\n    }\n\n    return 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\n#include<string.h>\n\n#include<math.h>\n\n#include<stdlib.h>\n\n#include<algorithm>\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[100005], ss[100005];\n\n    scanf(\"%s\", s);\n\n    int sum=0, ans=0, len=strlen(s);\n\n    while(1)\n\n    {\n\n        for(int i=1;i<len-1;i++)\n\n        {\n\n            if(s[i]!='\\0')\n\n            {\n\n                int x=i-1; \n\n                while(s[x]=='\\0')   x--;\n\n                if(s[x]!=s[i+1])\n\n                {\n\n                    s[i]='\\0';\n\n                    sum++;\n\n                }\n\n            }\n\n        }\n\n        int cnt=0;\n\n        for(int i=0;i<len;i++)\n\n            if(s[i]!='\\0')\n\n                ss[cnt++]=s[i];\n\n        for(int i=0;i<len;i++)\n\n            s[i]=ss[i];\n\n        len=cnt;\n\n        if(sum==ans)\n\n            break;\n\n        ans=sum;\n\n    }\n\n    if(sum%2)\n\n        printf(\"First\\n\");\n\n    else\n\n        printf(\"Second\\n\");\n\n    return 0;\n\n}"
    },
    {
        "id": "877",
        "source_code": "#include<string>\n\n#include<iostream>\n\nusing namespace std;\n\nstring s;\n\nint main(){\n\n\tcin>>s;\n\n\tif(s[0]==s[s.size()-1])\n\n\t  if(s.size()%2==1) cout<<\"Second\";\n\n\t  else cout<<\"First\";\n\n\telse\n\n\t  if(s.size()%2==1) cout<<\"First\";\n\n\t  else cout<<\"Second\";\n\n}",
        "optimized_code": "#include<stdio.h>\n\n#include<string.h>\n\n#include<math.h>\n\n#include<stdlib.h>\n\n#include<algorithm>\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[100005], ss[100005];\n\n    scanf(\"%s\", s);\n\n    int sum=0, ans=0, len=strlen(s);\n\n    while(1)\n\n    {\n\n        for(int i=1;i<len-1;i++)\n\n        {\n\n            if(s[i]!='\\0')\n\n            {\n\n                int x=i-1; \n\n                while(s[x]=='\\0')   x--;\n\n                if(s[x]!=s[i+1])\n\n                {\n\n                    s[i]='\\0';\n\n                    sum++;\n\n                }\n\n            }\n\n        }\n\n        int cnt=0;\n\n        for(int i=0;i<len;i++)\n\n            if(s[i]!='\\0')\n\n                ss[cnt++]=s[i];\n\n        for(int i=0;i<len;i++)\n\n            s[i]=ss[i];\n\n        len=cnt;\n\n        if(sum==ans)\n\n            break;\n\n        ans=sum;\n\n    }\n\n    if(sum%2)\n\n        printf(\"First\\n\");\n\n    else\n\n        printf(\"Second\\n\");\n\n    return 0;\n\n}"
    },
    {
        "id": "878",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar s[100001],ss[100001];\n\nint main()\n\n{    \n\n\tscanf(\"%s\",s+1);\n\n\tregister int sum=0,ans=0,l=strlen(s+1);\n\n\twhile(1)\n\n\t{\n\n\t\tfor(register int i=2;i<l;++i)\n\n\t\t{\n\n\t\t\tif(s[i]!='\\0')\n\n\t\t\t{\n\n\t\t\t\tregister int x=i-1;\n\n\t\t\t\twhile(s[x]=='\\0')\n\n\t\t\t\t\t--x;\n\n\t\t\t\tif(s[x]!=s[i+1])\n\n\t\t\t\t\ts[i]='\\0',++sum;\n\n            }        \n\n\t\t}        \n\n\t\tregister int cnt=0;\n\n\t\tfor(register int i=1;i<=l;++i)\n\n\t\t\tif(s[i]!='\\0')\n\n\t\t\t\tss[++cnt]=s[i];\n\n\t\tfor(register int i=1;i<=l;++i)\n\n\t\t\ts[i]=ss[i];\n\n\t\tl=cnt;\n\n\t\tif(sum==ans)\n\n\t\t\tbreak;\n\n\t\tans=sum;\n\n\t}    \n\n\tif(sum%2) return printf(\"First\"),0;\n\n\telse return printf(\"Second\"),0;\n\n} ",
        "optimized_code": "#include<stdio.h>\n\n#include<string.h>\n\n#include<math.h>\n\n#include<stdlib.h>\n\n#include<algorithm>\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[100005], ss[100005];\n\n    scanf(\"%s\", s);\n\n    int sum=0, ans=0, len=strlen(s);\n\n    while(1)\n\n    {\n\n        for(int i=1;i<len-1;i++)\n\n        {\n\n            if(s[i]!='\\0')\n\n            {\n\n                int x=i-1; \n\n                while(s[x]=='\\0')   x--;\n\n                if(s[x]!=s[i+1])\n\n                {\n\n                    s[i]='\\0';\n\n                    sum++;\n\n                }\n\n            }\n\n        }\n\n        int cnt=0;\n\n        for(int i=0;i<len;i++)\n\n            if(s[i]!='\\0')\n\n                ss[cnt++]=s[i];\n\n        for(int i=0;i<len;i++)\n\n            s[i]=ss[i];\n\n        len=cnt;\n\n        if(sum==ans)\n\n            break;\n\n        ans=sum;\n\n    }\n\n    if(sum%2)\n\n        printf(\"First\\n\");\n\n    else\n\n        printf(\"Second\\n\");\n\n    return 0;\n\n}"
    },
    {
        "id": "879",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint s1,s2,a;\n\nchar c[100010],c1,c2;\n\nint main(){\n\n\tscanf(\"%s\",c+1);\n\n\ta=strlen(c+1);\n\n\tc1=c[1],c2=c[a];\n\n\tif((c1==c2&&a%2==0)||c1!=c2&&a%2!=0) cout<<\"First\";\n\n\telse cout<<\"Second\"; \n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\n#include<string.h>\n\n#include<math.h>\n\n#include<stdlib.h>\n\n#include<algorithm>\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[100005], ss[100005];\n\n    scanf(\"%s\", s);\n\n    int sum=0, ans=0, len=strlen(s);\n\n    while(1)\n\n    {\n\n        for(int i=1;i<len-1;i++)\n\n        {\n\n            if(s[i]!='\\0')\n\n            {\n\n                int x=i-1; \n\n                while(s[x]=='\\0')   x--;\n\n                if(s[x]!=s[i+1])\n\n                {\n\n                    s[i]='\\0';\n\n                    sum++;\n\n                }\n\n            }\n\n        }\n\n        int cnt=0;\n\n        for(int i=0;i<len;i++)\n\n            if(s[i]!='\\0')\n\n                ss[cnt++]=s[i];\n\n        for(int i=0;i<len;i++)\n\n            s[i]=ss[i];\n\n        len=cnt;\n\n        if(sum==ans)\n\n            break;\n\n        ans=sum;\n\n    }\n\n    if(sum%2)\n\n        printf(\"First\\n\");\n\n    else\n\n        printf(\"Second\\n\");\n\n    return 0;\n\n}"
    },
    {
        "id": "880",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n\tstring d;\n\n\tcin>>d;\n\n\tint tot=0;\n\n\tint g=0;\n\n\tint l=d.size();\n\n\tif(d[0]==d[l-1])\n\n\t{\n\n\t\tif(l%2==0)\n\n\t\tcout<<\"First\";\n\n\t\telse cout<<\"Second\";\n\n\t}\n\n\telse{\n\n\t\tif(l%2==1)cout<<\"First\";\n\n\t\telse cout<<\"Second\";\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<stdio.h>\n\n#include<string.h>\n\n#include<math.h>\n\n#include<stdlib.h>\n\n#include<algorithm>\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[100005], ss[100005];\n\n    scanf(\"%s\", s);\n\n    int sum=0, ans=0, len=strlen(s);\n\n    while(1)\n\n    {\n\n        for(int i=1;i<len-1;i++)\n\n        {\n\n            if(s[i]!='\\0')\n\n            {\n\n                int x=i-1; \n\n                while(s[x]=='\\0')   x--;\n\n                if(s[x]!=s[i+1])\n\n                {\n\n                    s[i]='\\0';\n\n                    sum++;\n\n                }\n\n            }\n\n        }\n\n        int cnt=0;\n\n        for(int i=0;i<len;i++)\n\n            if(s[i]!='\\0')\n\n                ss[cnt++]=s[i];\n\n        for(int i=0;i<len;i++)\n\n            s[i]=ss[i];\n\n        len=cnt;\n\n        if(sum==ans)\n\n            break;\n\n        ans=sum;\n\n    }\n\n    if(sum%2)\n\n        printf(\"First\\n\");\n\n    else\n\n        printf(\"Second\\n\");\n\n    return 0;\n\n}"
    },
    {
        "id": "881",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n \n\nint main()\n\n{\n\n    string s;\n\n    while(cin>>s)\n\n    {\n\n        cout << ( (s[0]==s[s.length()-1])^(s.length()%2)?\"First\":\"Second\") << endl;\n\n    }\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nint main()\n\n{\n\n\tchar c[1000000];\n\n\tscanf(\"%s\",&c);\n\n\tint n=strlen(c);\n\n\tif (c[0]==c[n-1])\n\n\tif (n%2==0)\n\n\tprintf(\"First\");\n\n\telse\n\n\tprintf(\"Second\");\n\n\telse\n\n\tif (n%2!=0)\n\n\tprintf(\"First\");\n\n\telse\n\n\tprintf(\"Second\");\n\n}"
    },
    {
        "id": "882",
        "source_code": "#include<string>\n\n#include<iostream>\n\nusing namespace std;\n\nstring s;\n\nint main(){\n\n\tcin>>s;\n\n\tif(s[0]==s[s.size()-1])\n\n\t  if(s.size()%2==1) cout<<\"Second\";\n\n\t  else cout<<\"First\";\n\n\telse\n\n\t  if(s.size()%2==1) cout<<\"First\";\n\n\t  else cout<<\"Second\";\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nint main()\n\n{\n\n\tchar c[1000000];\n\n\tscanf(\"%s\",&c);\n\n\tint n=strlen(c);\n\n\tif (c[0]==c[n-1])\n\n\tif (n%2==0)\n\n\tprintf(\"First\");\n\n\telse\n\n\tprintf(\"Second\");\n\n\telse\n\n\tif (n%2!=0)\n\n\tprintf(\"First\");\n\n\telse\n\n\tprintf(\"Second\");\n\n}"
    },
    {
        "id": "883",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar s[100001],ss[100001];\n\nint main()\n\n{    \n\n\tscanf(\"%s\",s+1);\n\n\tregister int sum=0,ans=0,l=strlen(s+1);\n\n\twhile(1)\n\n\t{\n\n\t\tfor(register int i=2;i<l;++i)\n\n\t\t{\n\n\t\t\tif(s[i]!='\\0')\n\n\t\t\t{\n\n\t\t\t\tregister int x=i-1;\n\n\t\t\t\twhile(s[x]=='\\0')\n\n\t\t\t\t\t--x;\n\n\t\t\t\tif(s[x]!=s[i+1])\n\n\t\t\t\t\ts[i]='\\0',++sum;\n\n            }        \n\n\t\t}        \n\n\t\tregister int cnt=0;\n\n\t\tfor(register int i=1;i<=l;++i)\n\n\t\t\tif(s[i]!='\\0')\n\n\t\t\t\tss[++cnt]=s[i];\n\n\t\tfor(register int i=1;i<=l;++i)\n\n\t\t\ts[i]=ss[i];\n\n\t\tl=cnt;\n\n\t\tif(sum==ans)\n\n\t\t\tbreak;\n\n\t\tans=sum;\n\n\t}    \n\n\tif(sum%2) return printf(\"First\"),0;\n\n\telse return printf(\"Second\"),0;\n\n} ",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nint main()\n\n{\n\n\tchar c[1000000];\n\n\tscanf(\"%s\",&c);\n\n\tint n=strlen(c);\n\n\tif (c[0]==c[n-1])\n\n\tif (n%2==0)\n\n\tprintf(\"First\");\n\n\telse\n\n\tprintf(\"Second\");\n\n\telse\n\n\tif (n%2!=0)\n\n\tprintf(\"First\");\n\n\telse\n\n\tprintf(\"Second\");\n\n}"
    },
    {
        "id": "884",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint s1,s2,a;\n\nchar c[100010],c1,c2;\n\nint main(){\n\n\tscanf(\"%s\",c+1);\n\n\ta=strlen(c+1);\n\n\tc1=c[1],c2=c[a];\n\n\tif((c1==c2&&a%2==0)||c1!=c2&&a%2!=0) cout<<\"First\";\n\n\telse cout<<\"Second\"; \n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nint main()\n\n{\n\n\tchar c[1000000];\n\n\tscanf(\"%s\",&c);\n\n\tint n=strlen(c);\n\n\tif (c[0]==c[n-1])\n\n\tif (n%2==0)\n\n\tprintf(\"First\");\n\n\telse\n\n\tprintf(\"Second\");\n\n\telse\n\n\tif (n%2!=0)\n\n\tprintf(\"First\");\n\n\telse\n\n\tprintf(\"Second\");\n\n}"
    },
    {
        "id": "885",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n\tstring d;\n\n\tcin>>d;\n\n\tint tot=0;\n\n\tint g=0;\n\n\tint l=d.size();\n\n\tif(d[0]==d[l-1])\n\n\t{\n\n\t\tif(l%2==0)\n\n\t\tcout<<\"First\";\n\n\t\telse cout<<\"Second\";\n\n\t}\n\n\telse{\n\n\t\tif(l%2==1)cout<<\"First\";\n\n\t\telse cout<<\"Second\";\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nint main()\n\n{\n\n\tchar c[1000000];\n\n\tscanf(\"%s\",&c);\n\n\tint n=strlen(c);\n\n\tif (c[0]==c[n-1])\n\n\tif (n%2==0)\n\n\tprintf(\"First\");\n\n\telse\n\n\tprintf(\"Second\");\n\n\telse\n\n\tif (n%2!=0)\n\n\tprintf(\"First\");\n\n\telse\n\n\tprintf(\"Second\");\n\n}"
    },
    {
        "id": "886",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n \n\nint main()\n\n{\n\n    string s;\n\n    while(cin>>s)\n\n    {\n\n        cout << ( (s[0]==s[s.length()-1])^(s.length()%2)?\"First\":\"Second\") << endl;\n\n    }\n\n    return 0;\n\n}",
        "optimized_code": "#include<algorithm>\n\n#include<cstring>\n\n#include<stdio.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tchar a[100005];\n\n\tscanf(\"%s\",a+1);\n\n\tn=strlen(a+1);\n\n\tif((a[1]==a[n]&&n%2==1)||(a[1]!=a[n]&&n%2!=1))printf(\"Second\\n\");\n\n\telse printf(\"First\\n\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "887",
        "source_code": "#include<string>\n\n#include<iostream>\n\nusing namespace std;\n\nstring s;\n\nint main(){\n\n\tcin>>s;\n\n\tif(s[0]==s[s.size()-1])\n\n\t  if(s.size()%2==1) cout<<\"Second\";\n\n\t  else cout<<\"First\";\n\n\telse\n\n\t  if(s.size()%2==1) cout<<\"First\";\n\n\t  else cout<<\"Second\";\n\n}",
        "optimized_code": "#include<algorithm>\n\n#include<cstring>\n\n#include<stdio.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tchar a[100005];\n\n\tscanf(\"%s\",a+1);\n\n\tn=strlen(a+1);\n\n\tif((a[1]==a[n]&&n%2==1)||(a[1]!=a[n]&&n%2!=1))printf(\"Second\\n\");\n\n\telse printf(\"First\\n\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "888",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nchar s[100001],ss[100001];\n\nint main()\n\n{    \n\n\tscanf(\"%s\",s+1);\n\n\tregister int sum=0,ans=0,l=strlen(s+1);\n\n\twhile(1)\n\n\t{\n\n\t\tfor(register int i=2;i<l;++i)\n\n\t\t{\n\n\t\t\tif(s[i]!='\\0')\n\n\t\t\t{\n\n\t\t\t\tregister int x=i-1;\n\n\t\t\t\twhile(s[x]=='\\0')\n\n\t\t\t\t\t--x;\n\n\t\t\t\tif(s[x]!=s[i+1])\n\n\t\t\t\t\ts[i]='\\0',++sum;\n\n            }        \n\n\t\t}        \n\n\t\tregister int cnt=0;\n\n\t\tfor(register int i=1;i<=l;++i)\n\n\t\t\tif(s[i]!='\\0')\n\n\t\t\t\tss[++cnt]=s[i];\n\n\t\tfor(register int i=1;i<=l;++i)\n\n\t\t\ts[i]=ss[i];\n\n\t\tl=cnt;\n\n\t\tif(sum==ans)\n\n\t\t\tbreak;\n\n\t\tans=sum;\n\n\t}    \n\n\tif(sum%2) return printf(\"First\"),0;\n\n\telse return printf(\"Second\"),0;\n\n} ",
        "optimized_code": "#include<algorithm>\n\n#include<cstring>\n\n#include<stdio.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tchar a[100005];\n\n\tscanf(\"%s\",a+1);\n\n\tn=strlen(a+1);\n\n\tif((a[1]==a[n]&&n%2==1)||(a[1]!=a[n]&&n%2!=1))printf(\"Second\\n\");\n\n\telse printf(\"First\\n\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "889",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint s1,s2,a;\n\nchar c[100010],c1,c2;\n\nint main(){\n\n\tscanf(\"%s\",c+1);\n\n\ta=strlen(c+1);\n\n\tc1=c[1],c2=c[a];\n\n\tif((c1==c2&&a%2==0)||c1!=c2&&a%2!=0) cout<<\"First\";\n\n\telse cout<<\"Second\"; \n\n\treturn 0;\n\n}",
        "optimized_code": "#include<algorithm>\n\n#include<cstring>\n\n#include<stdio.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tchar a[100005];\n\n\tscanf(\"%s\",a+1);\n\n\tn=strlen(a+1);\n\n\tif((a[1]==a[n]&&n%2==1)||(a[1]!=a[n]&&n%2!=1))printf(\"Second\\n\");\n\n\telse printf(\"First\\n\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "890",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n\tstring d;\n\n\tcin>>d;\n\n\tint tot=0;\n\n\tint g=0;\n\n\tint l=d.size();\n\n\tif(d[0]==d[l-1])\n\n\t{\n\n\t\tif(l%2==0)\n\n\t\tcout<<\"First\";\n\n\t\telse cout<<\"Second\";\n\n\t}\n\n\telse{\n\n\t\tif(l%2==1)cout<<\"First\";\n\n\t\telse cout<<\"Second\";\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<algorithm>\n\n#include<cstring>\n\n#include<stdio.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tchar a[100005];\n\n\tscanf(\"%s\",a+1);\n\n\tn=strlen(a+1);\n\n\tif((a[1]==a[n]&&n%2==1)||(a[1]!=a[n]&&n%2!=1))printf(\"Second\\n\");\n\n\telse printf(\"First\\n\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "891",
        "source_code": "#include<cstdio>\n\n#include<string>\n\n#include<iostream>\n\n#include<algorithm>\n\n#include<cmath>\n\n#include<vector>\n\n#define inf 99999999\n\nusing namespace std;\n\ntypedef double db;\n\ntypedef long long ll;\n\nstring s;\n\nint main()\n\n{\n\n\tcin>>s;\n\n\tif(s[0]==s[s.size()-1])\n\n\t\tif(s.size()&1)\n\n\t\t\tcout<<\"Second\"<<endl;\n\n\t\telse\n\n\t\t\tcout<<\"First\"<<endl; \n\n\telse\n\n\t\tif(s.size()&1)\n\n\t\t\tcout<<\"First\"<<endl;\n\n\t\telse\n\n\t\t\tcout<<\"Second\"<<endl;\n\n\treturn 0;\n\n}\n\n\n",
        "optimized_code": "#include<algorithm>\n\n#include<cstring>\n\n#include<stdio.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tchar a[100005];\n\n\tscanf(\"%s\",a+1);\n\n\tn=strlen(a+1);\n\n\tif((a[1]==a[n]&&n%2==1)||(a[1]!=a[n]&&n%2!=1))printf(\"Second\\n\");\n\n\telse printf(\"First\\n\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "892",
        "source_code": "#include<iostream>\n\n#include<string>\n\nusing namespace std;\n\nint main()\n\n{\n\n    string s;\n\n    cin>>s;\n\n    int l=s.length();\n\n    if(s[0]==s[l-1])\n\n\t{\n\n        if(l%2==0)\n\n\t\t{\n\n            cout<<\"First\";\n\n            return 0;\n\n        }\n\n        else\n\n\t\t{\n\n            cout<<\"Second\";\n\n            return 0;\n\n        }\n\n    }\n\n    else{\n\n        if(l%2==0)\n\n\t\t{\n\n            cout<<\"Second\";\n\n            return 0;\n\n        }\n\n        else\n\n\t\t{\n\n            cout<<\"First\";\n\n            return 0;\n\n        }\n\n    }\n\n}",
        "optimized_code": "#include<algorithm>\n\n#include<cstring>\n\n#include<stdio.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tchar a[100005];\n\n\tscanf(\"%s\",a+1);\n\n\tn=strlen(a+1);\n\n\tif((a[1]==a[n]&&n%2==1)||(a[1]!=a[n]&&n%2!=1))printf(\"Second\\n\");\n\n\telse printf(\"First\\n\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "893",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nstring a;\n\nint b;\n\nint main()\n\n{\n\ncin>>a;\n\nb=a.size();\n\nif(a[0]==a[b-1])\n\n{\n\nif(b%2==0)\n\n{\n\ncout<<\"First\"<<endl;\n\nreturn 0;\n\n}\n\nelse\n\n{\n\ncout<<\"Second\"<<endl;\n\nreturn 0;\n\n}\n\n}\n\nelse\n\n{\n\nif(b%2==0){\n\ncout<<\"Second\"<<endl;\n\nreturn 0;\n\n}\n\nelse\n\n{\n\ncout<<\"First\"<<endl;\n\nreturn 0;\n\n}\n\n}\n\n}",
        "optimized_code": "#include<algorithm>\n\n#include<cstring>\n\n#include<stdio.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tchar a[100005];\n\n\tscanf(\"%s\",a+1);\n\n\tn=strlen(a+1);\n\n\tif((a[1]==a[n]&&n%2==1)||(a[1]!=a[n]&&n%2!=1))printf(\"Second\\n\");\n\n\telse printf(\"First\\n\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "894",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    string s;\n\n    cin>>s;\n\n    return 0&(int)printf(\"%s\",((s[0]==s[s.length()-1])^(s.length()%2))?\"First\":\"Second\");\n\n}",
        "optimized_code": "#include<algorithm>\n\n#include<cstring>\n\n#include<stdio.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tchar a[100005];\n\n\tscanf(\"%s\",a+1);\n\n\tn=strlen(a+1);\n\n\tif((a[1]==a[n]&&n%2==1)||(a[1]!=a[n]&&n%2!=1))printf(\"Second\\n\");\n\n\telse printf(\"First\\n\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "895",
        "source_code": "#include \"cstdio\"\n\n#include \"string\"\n\n#include \"iostream\"\n\nusing namespace std;\n\nint main(){\n\n\tstring s;\n\n\tcin>>s;\n\n\tint x=s.size();\n\n\tif(s[0]==s[x-1]){\n\n\tif(x%2==0){\n\n\t\tprintf(\"First\\n\");return 0;\n\n\t}\n\n\telse{\n\n\t\tprintf(\"Second\\n\");return 0;\n\n\t}\n\n\t}\n\n\telse{\n\n\t\tif(x%2==0){\n\n\t\t    printf(\"Second\\n\");return 0;\n\n\t    }\n\n\t    else {\n\n\t\t    printf(\"First\\n\");return 0;\n\n\t    }\n\n\t}\n\n}",
        "optimized_code": "#include<algorithm>\n\n#include<cstring>\n\n#include<stdio.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tchar a[100005];\n\n\tscanf(\"%s\",a+1);\n\n\tn=strlen(a+1);\n\n\tif((a[1]==a[n]&&n%2==1)||(a[1]!=a[n]&&n%2!=1))printf(\"Second\\n\");\n\n\telse printf(\"First\\n\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "896",
        "source_code": "#include <iostream>\n\n#include <cstring>\n\n\n\nusing namespace std;\n\n\n\nstring s;\n\n\n\nint main()\n\n{\n\n\tcin >> s;\n\n\tif (s[0] == s[s.length() - 1] && s.length() % 2) cout << \"Second\" << endl;\n\n\telse if (s[0] == s[s.length() - 1] || s.length() % 2) cout << \"First\" << endl;\n\n\telse cout << \"Second\" << endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<algorithm>\n\n#include<cstring>\n\n#include<stdio.h>\n\nusing namespace std;\n\nint main(){\n\n\tint n;\n\n\tchar a[100005];\n\n\tscanf(\"%s\",a+1);\n\n\tn=strlen(a+1);\n\n\tif((a[1]==a[n]&&n%2==1)||(a[1]!=a[n]&&n%2!=1))printf(\"Second\\n\");\n\n\telse printf(\"First\\n\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "897",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    string s;\n\n    cin>>s;\n\n    if(s[0]==s[s.length()-1])\n\n    {\n\n        if(s.length()%2==1) cout <<\"Second\\n\";\n\n        else cout <<\"First\\n\";\n\n    }\n\n    else\n\n    {\n\n        if(s.length()%2==0) cout <<\"Second\\n\";\n\n        else cout <<\"First\\n\";\n\n    }\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nchar s[100005];\n\nint len;\n\nint main(){\n\n    scanf(\"%s\", s), len = strlen(s);\n\n    if (s[0] == s[len - 1]) puts(len & 1 ? \"Second\" : \"First\");\n\n    else puts(len & 1 ? \"First\" : \"Second\");\n\n}"
    },
    {
        "id": "898",
        "source_code": "#include <bits/stdc++.h>\n\n#define LL long long\n\nusing namespace std;\n\n\n\nconst int N=1e5+10;\n\nint len,Cnt;\n\nchar a[N];\n\n\n\nint main ()\n\n{\n\n\tscanf (\"%s\", a+1);\n\n\tlen=strlen (a+1);\n\n\tfor (int i=1;i<=len>>1;++i)\n\n\t\tif (a[i]!=a[len-i+1]) Cnt++;\n\n\tif (Cnt==0) {\n\n\t\tputs (\"Second\");\n\n\t\treturn 0;\n\n\t}\t\n\n\ta[1]==a[len]? (len & 1?puts (\"Second\") : puts (\"First\") ) : (len & 1?puts (\"First\") : puts (\"Second\") );\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nchar s[100005];\n\nint len;\n\nint main(){\n\n    scanf(\"%s\", s), len = strlen(s);\n\n    if (s[0] == s[len - 1]) puts(len & 1 ? \"Second\" : \"First\");\n\n    else puts(len & 1 ? \"First\" : \"Second\");\n\n}"
    },
    {
        "id": "899",
        "source_code": "#include<iostream>\n\n#include<cstring>\n\nusing namespace std;\n\nstring s;\n\nint l;\n\nint main()\n\n{\n\n\tcin>>s;\n\n\tl=s.size();\n\n\tif(s[0]==s[l-1])\n\n\t{\n\n\t\tif(l%2==0) cout<<\"First\";\n\n\t\telse cout<<\"Second\";\n\n\t\treturn 0;\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif(l%2==0) cout<<\"Second\";\n\n\t\telse cout<<\"First\";\n\n\t\treturn 0;\n\n\t}\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nchar s[100005];\n\nint len;\n\nint main(){\n\n    scanf(\"%s\", s), len = strlen(s);\n\n    if (s[0] == s[len - 1]) puts(len & 1 ? \"Second\" : \"First\");\n\n    else puts(len & 1 ? \"First\" : \"Second\");\n\n}"
    },
    {
        "id": "900",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint l,sum=0;\n\nconst int maxn=1e5+10;\n\nchar t[maxn];\n\nint main()\n\n{\n\n\twhile(scanf(\"%s\",t)!=EOF)\n\n\t{\n\n\t   l=strlen(t);\n\n\t   for(int i=1;i<l-1;i++)\n\n\t\t  if(t[i-1]!=t[i+1]) sum++;\n\n\t   if(sum==0)\n\n\t   {\n\n\t\tprintf(\"Second\\n\");\n\n\t\tcontinue;\n\n\t    }\n\n\t   if(t[0]!=t[l-1])\n\n\t   {\n\n\t\t  printf(\"%s\\n\",l%2?\"First\":\"Second\");\n\n       }\n\n       else\n\n\t   {\n\n\t\t  printf(\"%s\\n\",l%2?\"Second\":\"First\");\n\n\t   }\n\n\t}\n\n\t\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nchar s[100005];\n\nint len;\n\nint main(){\n\n    scanf(\"%s\", s), len = strlen(s);\n\n    if (s[0] == s[len - 1]) puts(len & 1 ? \"Second\" : \"First\");\n\n    else puts(len & 1 ? \"First\" : \"Second\");\n\n}"
    },
    {
        "id": "901",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nchar s[1000001];\n\nlong long a=0,b=0;\n\nint main()\n\n{\n\n    cin>>s;\n\n    a=strlen(s)-2;\n\n    for (int i=0,j=strlen(s)-1;i<j;i++,j--)\n\n    {\n\n        if (s[i]==s[j])\n\n        b++;\n\n    }\n\n    if (b==(a+2)/2)\n\n    cout<<\"Second\"<<endl;\n\n    else\n\n    {\n\n    if (s[0]==s[strlen(s)-1])\n\n    {\n\n        a=a-1;\n\n        if (a%2==0)\n\n        cout<<\"Second\"<<endl;\n\n        else\n\n        cout<<\"First\"<<endl;\n\n    }\n\n    else\n\n    {\n\n    if (a%2==0)\n\n    cout<<\"Second\"<<endl;\n\n    else\n\n    cout<<\"First\"<<endl;\t\n\n    }\n\n    }\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <cstring>\n\nchar s[100005];\n\nint len;\n\nint main(){\n\n    scanf(\"%s\", s), len = strlen(s);\n\n    if (s[0] == s[len - 1]) puts(len & 1 ? \"Second\" : \"First\");\n\n    else puts(len & 1 ? \"First\" : \"Second\");\n\n}"
    },
    {
        "id": "902",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    string s;\n\n    cin>>s;\n\n    if(s[0]==s[s.length()-1])\n\n    {\n\n        if(s.length()%2==1) cout <<\"Second\\n\";\n\n        else cout <<\"First\\n\";\n\n    }\n\n    else\n\n    {\n\n        if(s.length()%2==0) cout <<\"Second\\n\";\n\n        else cout <<\"First\\n\";\n\n    }\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<queue>\n\n#include<cmath>\n\nusing namespace std;\n\nchar s[100001];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    if(s[0]==s[len-1])\n\n    {\n\n        if(len%2==1)\n\n    printf(\"Second\");\n\n        else\n\n    printf(\"First\");\n\n    }\n\n    else\n\n    {\n\n        if(len%2==1)\n\n    printf(\"First\");\n\n        else\n\n    printf(\"Second\");\n\n    }\n\n    return 0;\n\n}"
    },
    {
        "id": "903",
        "source_code": "#include <bits/stdc++.h>\n\n#define LL long long\n\nusing namespace std;\n\n\n\nconst int N=1e5+10;\n\nint len,Cnt;\n\nchar a[N];\n\n\n\nint main ()\n\n{\n\n\tscanf (\"%s\", a+1);\n\n\tlen=strlen (a+1);\n\n\tfor (int i=1;i<=len>>1;++i)\n\n\t\tif (a[i]!=a[len-i+1]) Cnt++;\n\n\tif (Cnt==0) {\n\n\t\tputs (\"Second\");\n\n\t\treturn 0;\n\n\t}\t\n\n\ta[1]==a[len]? (len & 1?puts (\"Second\") : puts (\"First\") ) : (len & 1?puts (\"First\") : puts (\"Second\") );\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<queue>\n\n#include<cmath>\n\nusing namespace std;\n\nchar s[100001];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    if(s[0]==s[len-1])\n\n    {\n\n        if(len%2==1)\n\n    printf(\"Second\");\n\n        else\n\n    printf(\"First\");\n\n    }\n\n    else\n\n    {\n\n        if(len%2==1)\n\n    printf(\"First\");\n\n        else\n\n    printf(\"Second\");\n\n    }\n\n    return 0;\n\n}"
    },
    {
        "id": "904",
        "source_code": "#include<iostream>\n\n#include<cstring>\n\nusing namespace std;\n\nstring s;\n\nint l;\n\nint main()\n\n{\n\n\tcin>>s;\n\n\tl=s.size();\n\n\tif(s[0]==s[l-1])\n\n\t{\n\n\t\tif(l%2==0) cout<<\"First\";\n\n\t\telse cout<<\"Second\";\n\n\t\treturn 0;\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif(l%2==0) cout<<\"Second\";\n\n\t\telse cout<<\"First\";\n\n\t\treturn 0;\n\n\t}\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<queue>\n\n#include<cmath>\n\nusing namespace std;\n\nchar s[100001];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    if(s[0]==s[len-1])\n\n    {\n\n        if(len%2==1)\n\n    printf(\"Second\");\n\n        else\n\n    printf(\"First\");\n\n    }\n\n    else\n\n    {\n\n        if(len%2==1)\n\n    printf(\"First\");\n\n        else\n\n    printf(\"Second\");\n\n    }\n\n    return 0;\n\n}"
    },
    {
        "id": "905",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint l,sum=0;\n\nconst int maxn=1e5+10;\n\nchar t[maxn];\n\nint main()\n\n{\n\n\twhile(scanf(\"%s\",t)!=EOF)\n\n\t{\n\n\t   l=strlen(t);\n\n\t   for(int i=1;i<l-1;i++)\n\n\t\t  if(t[i-1]!=t[i+1]) sum++;\n\n\t   if(sum==0)\n\n\t   {\n\n\t\tprintf(\"Second\\n\");\n\n\t\tcontinue;\n\n\t    }\n\n\t   if(t[0]!=t[l-1])\n\n\t   {\n\n\t\t  printf(\"%s\\n\",l%2?\"First\":\"Second\");\n\n       }\n\n       else\n\n\t   {\n\n\t\t  printf(\"%s\\n\",l%2?\"Second\":\"First\");\n\n\t   }\n\n\t}\n\n\t\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<queue>\n\n#include<cmath>\n\nusing namespace std;\n\nchar s[100001];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    if(s[0]==s[len-1])\n\n    {\n\n        if(len%2==1)\n\n    printf(\"Second\");\n\n        else\n\n    printf(\"First\");\n\n    }\n\n    else\n\n    {\n\n        if(len%2==1)\n\n    printf(\"First\");\n\n        else\n\n    printf(\"Second\");\n\n    }\n\n    return 0;\n\n}"
    },
    {
        "id": "906",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nchar s[1000001];\n\nlong long a=0,b=0;\n\nint main()\n\n{\n\n    cin>>s;\n\n    a=strlen(s)-2;\n\n    for (int i=0,j=strlen(s)-1;i<j;i++,j--)\n\n    {\n\n        if (s[i]==s[j])\n\n        b++;\n\n    }\n\n    if (b==(a+2)/2)\n\n    cout<<\"Second\"<<endl;\n\n    else\n\n    {\n\n    if (s[0]==s[strlen(s)-1])\n\n    {\n\n        a=a-1;\n\n        if (a%2==0)\n\n        cout<<\"Second\"<<endl;\n\n        else\n\n        cout<<\"First\"<<endl;\n\n    }\n\n    else\n\n    {\n\n    if (a%2==0)\n\n    cout<<\"Second\"<<endl;\n\n    else\n\n    cout<<\"First\"<<endl;\t\n\n    }\n\n    }\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<queue>\n\n#include<cmath>\n\nusing namespace std;\n\nchar s[100001];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    if(s[0]==s[len-1])\n\n    {\n\n        if(len%2==1)\n\n    printf(\"Second\");\n\n        else\n\n    printf(\"First\");\n\n    }\n\n    else\n\n    {\n\n        if(len%2==1)\n\n    printf(\"First\");\n\n        else\n\n    printf(\"Second\");\n\n    }\n\n    return 0;\n\n}"
    },
    {
        "id": "907",
        "source_code": "#include<iostream>\n\n#include<cstring>\n\nusing namespace std;\n\nint main()\n\n{\n\n\t//freopen(\"xx.in\",\"r\",stdin);\n\n\tstring s;\n\n\tcin>>s;\n\n\tint len=s.length();\n\n\tif(s[0]^s[len-1])\n\n\t{\n\n\t\tif(len&1) cout<<\"First\"<<endl;\n\n\t\telse cout<<\"Second\"<<endl;\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif(len&1) cout<<\"Second\"<<endl;\n\n\t\telse cout<<\"First\"<<endl;\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<queue>\n\n#include<cmath>\n\nusing namespace std;\n\nchar s[100001];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    if(s[0]==s[len-1])\n\n    {\n\n        if(len%2==1)\n\n    printf(\"Second\");\n\n        else\n\n    printf(\"First\");\n\n    }\n\n    else\n\n    {\n\n        if(len%2==1)\n\n    printf(\"First\");\n\n        else\n\n    printf(\"Second\");\n\n    }\n\n    return 0;\n\n}"
    },
    {
        "id": "908",
        "source_code": "#include<iostream>\n\n#include<iomanip>\n\n#include<cstring>\n\n#include<cstdio>\n\n#include<cmath>\n\n#include<algorithm>\n\n#include<set>\n\nusing namespace std;\n\nstring s;\n\nint main() {\n\n    cin>>s;\n\n    int n=s.length();\n\n    s=' '+s;\n\n    if(s[1]==s[n]){\n\n    \tif(n%2==1)puts(\"Second\");\n\n    \telse puts(\"First\");\n\n\t}\n\n\telse {\n\n\t\tif(n%2==0)puts(\"Second\");\n\n    \telse puts(\"First\");\n\n\t}\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<queue>\n\n#include<cmath>\n\nusing namespace std;\n\nchar s[100001];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    if(s[0]==s[len-1])\n\n    {\n\n        if(len%2==1)\n\n    printf(\"Second\");\n\n        else\n\n    printf(\"First\");\n\n    }\n\n    else\n\n    {\n\n        if(len%2==1)\n\n    printf(\"First\");\n\n        else\n\n    printf(\"Second\");\n\n    }\n\n    return 0;\n\n}"
    },
    {
        "id": "909",
        "source_code": "#include<iostream>\n\nusing namespace std;\n\nstring s;\n\nint main()\n\n{\n\n\tcin>>s;\n\n\tint l=s.length();\n\n\tif(s[0]==s[l-1])\n\n\t{\n\n\t\tif(l%2==0) cout<<\"First\"<<endl;\n\n\t\telse cout<<\"Second\"<<endl;\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif(l%2==0) cout<<\"Second\"<<endl;\n\n\t\telse cout<<\"First\"<<endl;\n\n\t}\n\n\treturn 0;\n\n} ",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<queue>\n\n#include<cmath>\n\nusing namespace std;\n\nchar s[100001];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    if(s[0]==s[len-1])\n\n    {\n\n        if(len%2==1)\n\n    printf(\"Second\");\n\n        else\n\n    printf(\"First\");\n\n    }\n\n    else\n\n    {\n\n        if(len%2==1)\n\n    printf(\"First\");\n\n        else\n\n    printf(\"Second\");\n\n    }\n\n    return 0;\n\n}"
    },
    {
        "id": "910",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\nint main()\n\n{\n\n\tcin>>s;\n\n\tif(s[0]==s[s.size()-1]){\n\n\t\tif(s.size()%2==0){\n\n\t\t\tcout<<\"First\"<<endl;\n\n\t\t}\n\n\t\telse{\n\n\t\t\tcout<<\"Second\"<<endl;\n\n\t\t}\n\n\t}\n\n\telse{\n\n\t\tif(s.size()%2!=0){\n\n\t\t\tcout<<\"First\"<<endl;\n\n\t\t}\n\n\t\telse{\n\n\t\t\tcout<<\"Second\"<<endl;\n\n\t\t}\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<queue>\n\n#include<cmath>\n\nusing namespace std;\n\nchar s[100001];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    if(s[0]==s[len-1])\n\n    {\n\n        if(len%2==1)\n\n    printf(\"Second\");\n\n        else\n\n    printf(\"First\");\n\n    }\n\n    else\n\n    {\n\n        if(len%2==1)\n\n    printf(\"First\");\n\n        else\n\n    printf(\"Second\");\n\n    }\n\n    return 0;\n\n}"
    },
    {
        "id": "911",
        "source_code": "#include <stdio.h>\n\n#include <string.h>\n\n#include <stdlib.h>\n\n#include <iostream>\n\n#include <algorithm>\n\n#include <set>\n\n#include <queue>\n\nusing namespace std;\n\nchar s[100005];\n\nint main(){\n\n\tint n,i,j,k,o,p,l;\n\n\tscanf(\"%s\",s+1);\n\n\tn=strlen(s+1);\n\n\tint ok=1;\n\n\tfor(i=3;i<=n;i++)\n\n\tif(s[i]!=s[i-2]){ok=0;break;}\n\n\tif(ok==1)printf(\"Second\");\n\n\telse{\n\n\tif(s[1]==s[n]){\n\n\tif(n%2==0)printf(\"First\");\n\n\telse printf(\"Second\");\n\n\t}\n\n\telse{\n\n\tif(n%2==1)printf(\"First\");\n\n\telse printf(\"Second\");\n\n\t}\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<queue>\n\n#include<cmath>\n\nusing namespace std;\n\nchar s[100001];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    if(s[0]==s[len-1])\n\n    {\n\n        if(len%2==1)\n\n    printf(\"Second\");\n\n        else\n\n    printf(\"First\");\n\n    }\n\n    else\n\n    {\n\n        if(len%2==1)\n\n    printf(\"First\");\n\n        else\n\n    printf(\"Second\");\n\n    }\n\n    return 0;\n\n}"
    },
    {
        "id": "912",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nstring s;\n\nint main(){\n\n    cin>>s;int l=s.size();\n\n    if(s[0]==s[l-1]) if(l&1) puts(\"Second\");else puts(\"First\");\n\n    else if(!(l&1)) puts(\"Second\");else puts(\"First\");\n\n    return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<queue>\n\n#include<cmath>\n\nusing namespace std;\n\nchar s[100001];\n\nint main()\n\n{\n\n    scanf(\"%s\",s);\n\n    int len=strlen(s);\n\n    if(s[0]==s[len-1])\n\n    {\n\n        if(len%2==1)\n\n    printf(\"Second\");\n\n        else\n\n    printf(\"First\");\n\n    }\n\n    else\n\n    {\n\n        if(len%2==1)\n\n    printf(\"First\");\n\n        else\n\n    printf(\"Second\");\n\n    }\n\n    return 0;\n\n}"
    },
    {
        "id": "913",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <map>\n\n\n\nusing namespace std;\n\n\n\nchar str[110000];\n\n\n\nint main()\n\n{\n\n\tcin>>str;\n\n\tint flag = 1;\n\n\tint len;\n\n\tlen = strlen(str);\n\n\tfor(int i = 0;i < len - 2;i++)\n\n\t{\n\n\t\tif(str[i] != str[i+2])\n\n\t\t{\n\n\t\t\tflag = 0;\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tif(flag)\n\n\t\tcout<<\"Second\"<<endl;\n\n\telse if(str[0] == str[len-1] && len % 2)\n\n\t\tcout<<\"Second\"<<endl;\n\n\telse if(len % 2)\n\n\t\tcout<<\"First\"<<endl;\n\n\telse if(str[0] == str[len-1] && len % 2 == 0)\n\n\t\tcout<<\"First\"<<endl;\n\n\telse\n\n\t\tcout<<\"Second\"<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <string.h>\n\n#include <stdio.h>\n\n#include <stdlib.h>\n\nusing namespace std;\n\nchar ch[555555];\n\nint main()\n\n{\n\n    scanf(\"%s\",ch);\n\n    int len=strlen(ch);\n\n    if(ch[0]==ch[len-1])\n\n    {\n\n        if((len-2)%2==0)\n\n        {\n\n            printf(\"First\\n\");\n\n        }\n\n        else\n\n        {\n\n            printf(\"Second\\n\");\n\n        }\n\n    }\n\n    else\n\n    {\n\n        if((len-2)%2==0)\n\n        {\n\n            printf(\"Second\\n\");\n\n        }\n\n        else\n\n        {\n\n            printf(\"First\\n\");\n\n        }\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "914",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nint main () {\n\n    char str[100005];\n\n    scanf(\"%s\", str);\n\n    int len=strlen(str);\n\n    if(str[0]==str[len-1]) {\n\n        if(len&1) puts(\"Second\");\n\n        else puts(\"First\");\n\n    } else {\n\n        if(len&1) puts(\"First\");\n\n        else puts(\"Second\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <string.h>\n\n#include <stdio.h>\n\n#include <stdlib.h>\n\nusing namespace std;\n\nchar ch[555555];\n\nint main()\n\n{\n\n    scanf(\"%s\",ch);\n\n    int len=strlen(ch);\n\n    if(ch[0]==ch[len-1])\n\n    {\n\n        if((len-2)%2==0)\n\n        {\n\n            printf(\"First\\n\");\n\n        }\n\n        else\n\n        {\n\n            printf(\"Second\\n\");\n\n        }\n\n    }\n\n    else\n\n    {\n\n        if((len-2)%2==0)\n\n        {\n\n            printf(\"Second\\n\");\n\n        }\n\n        else\n\n        {\n\n            printf(\"First\\n\");\n\n        }\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "915",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#define ms(x) memset(x, 0, sizeof(x))\n\n#define inf 0x3f3f3f3f\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[123456];\n\n    int cnt[27], book[27];\n\n    while(scanf(\"%s\",s)!=EOF){\n\n        ms(cnt);\n\n        int len = strlen(s), s1 = 0, s2 = 0;\n\n        if(s[0] == s[len-1]) len--;\n\n        if(len%=2) {printf(\"First\\n\");}\n\n        else printf(\"Second\\n\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <string.h>\n\n#include <stdio.h>\n\n#include <stdlib.h>\n\nusing namespace std;\n\nchar ch[555555];\n\nint main()\n\n{\n\n    scanf(\"%s\",ch);\n\n    int len=strlen(ch);\n\n    if(ch[0]==ch[len-1])\n\n    {\n\n        if((len-2)%2==0)\n\n        {\n\n            printf(\"First\\n\");\n\n        }\n\n        else\n\n        {\n\n            printf(\"Second\\n\");\n\n        }\n\n    }\n\n    else\n\n    {\n\n        if((len-2)%2==0)\n\n        {\n\n            printf(\"Second\\n\");\n\n        }\n\n        else\n\n        {\n\n            printf(\"First\\n\");\n\n        }\n\n    }\n\n    return 0;\n\n}\n"
    },
    {
        "id": "916",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <map>\n\n\n\nusing namespace std;\n\n\n\nchar str[110000];\n\n\n\nint main()\n\n{\n\n\tcin>>str;\n\n\tint flag = 1;\n\n\tint len;\n\n\tlen = strlen(str);\n\n\tfor(int i = 0;i < len - 2;i++)\n\n\t{\n\n\t\tif(str[i] != str[i+2])\n\n\t\t{\n\n\t\t\tflag = 0;\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tif(flag)\n\n\t\tcout<<\"Second\"<<endl;\n\n\telse if(str[0] == str[len-1] && len % 2)\n\n\t\tcout<<\"Second\"<<endl;\n\n\telse if(len % 2)\n\n\t\tcout<<\"First\"<<endl;\n\n\telse if(str[0] == str[len-1] && len % 2 == 0)\n\n\t\tcout<<\"First\"<<endl;\n\n\telse\n\n\t\tcout<<\"Second\"<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\n#include <algorithm>\n\nusing namespace std;\n\nconst int N = 1e5 + 10;\n\nchar s[N];\n\n\n\nint main()\n\n{\n\n\tscanf(\"%s\",s);\n\n\tint len = strlen(s);\n\n\tint cnt = len - 2;\n\n\tif (s[0] == s[len - 1])\n\n\t{\n\n\t\tif (cnt % 2) puts(\"Second\");\n\n\t\telse puts(\"First\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif (cnt % 2 == 0) puts(\"Second\");\n\n\t\telse puts(\"First\");\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "917",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nint main () {\n\n    char str[100005];\n\n    scanf(\"%s\", str);\n\n    int len=strlen(str);\n\n    if(str[0]==str[len-1]) {\n\n        if(len&1) puts(\"Second\");\n\n        else puts(\"First\");\n\n    } else {\n\n        if(len&1) puts(\"First\");\n\n        else puts(\"Second\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\n#include <algorithm>\n\nusing namespace std;\n\nconst int N = 1e5 + 10;\n\nchar s[N];\n\n\n\nint main()\n\n{\n\n\tscanf(\"%s\",s);\n\n\tint len = strlen(s);\n\n\tint cnt = len - 2;\n\n\tif (s[0] == s[len - 1])\n\n\t{\n\n\t\tif (cnt % 2) puts(\"Second\");\n\n\t\telse puts(\"First\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif (cnt % 2 == 0) puts(\"Second\");\n\n\t\telse puts(\"First\");\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "918",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#define ms(x) memset(x, 0, sizeof(x))\n\n#define inf 0x3f3f3f3f\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[123456];\n\n    int cnt[27], book[27];\n\n    while(scanf(\"%s\",s)!=EOF){\n\n        ms(cnt);\n\n        int len = strlen(s), s1 = 0, s2 = 0;\n\n        if(s[0] == s[len-1]) len--;\n\n        if(len%=2) {printf(\"First\\n\");}\n\n        else printf(\"Second\\n\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\n#include <algorithm>\n\nusing namespace std;\n\nconst int N = 1e5 + 10;\n\nchar s[N];\n\n\n\nint main()\n\n{\n\n\tscanf(\"%s\",s);\n\n\tint len = strlen(s);\n\n\tint cnt = len - 2;\n\n\tif (s[0] == s[len - 1])\n\n\t{\n\n\t\tif (cnt % 2) puts(\"Second\");\n\n\t\telse puts(\"First\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif (cnt % 2 == 0) puts(\"Second\");\n\n\t\telse puts(\"First\");\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "919",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n \n\nint main()\n\n{\n\n    string s;\n\n    cin>>s;\n\n    int len = s.length();\n\n    if(s[0] == s[len-1])\n\n        if(len&1)printf(\"Second\\n\");\n\n        else printf(\"First\\n\");\n\n    else\n\n        if(len&1)printf(\"First\\n\");\n\n        else printf(\"Second\\n\");\n\n}",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\n#include <algorithm>\n\nusing namespace std;\n\nconst int N = 1e5 + 10;\n\nchar s[N];\n\n\n\nint main()\n\n{\n\n\tscanf(\"%s\",s);\n\n\tint len = strlen(s);\n\n\tint cnt = len - 2;\n\n\tif (s[0] == s[len - 1])\n\n\t{\n\n\t\tif (cnt % 2) puts(\"Second\");\n\n\t\telse puts(\"First\");\n\n\t}\n\n\telse\n\n\t{\n\n\t\tif (cnt % 2 == 0) puts(\"Second\");\n\n\t\telse puts(\"First\");\n\n\t}\n\n\treturn 0;\n\n}"
    },
    {
        "id": "920",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <map>\n\n\n\nusing namespace std;\n\n\n\nchar str[110000];\n\n\n\nint main()\n\n{\n\n\tcin>>str;\n\n\tint flag = 1;\n\n\tint len;\n\n\tlen = strlen(str);\n\n\tfor(int i = 0;i < len - 2;i++)\n\n\t{\n\n\t\tif(str[i] != str[i+2])\n\n\t\t{\n\n\t\t\tflag = 0;\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tif(flag)\n\n\t\tcout<<\"Second\"<<endl;\n\n\telse if(str[0] == str[len-1] && len % 2)\n\n\t\tcout<<\"Second\"<<endl;\n\n\telse if(len % 2)\n\n\t\tcout<<\"First\"<<endl;\n\n\telse if(str[0] == str[len-1] && len % 2 == 0)\n\n\t\tcout<<\"First\"<<endl;\n\n\telse\n\n\t\tcout<<\"Second\"<<endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nchar s[1000005];\n\nbool bo;\n\nlong long ji;\n\nint main(){\n\n \tscanf(\"%s\",&s);\n\n \tlong long len=strlen(s);\n\n \tfor(long long i=0;i<len-1;i++)\n\n\t {\n\n \t \tif(s[i]!=s[i+1])\n\n\t\tbo=1;\n\n\t}\n\n\tif(bo==1)\n\n\t{\n\n\t\tif(s[0]!=s[len-1])\n\n \t\tji=len-2;\n\n \t\telse ji=len-3;\n\n\t}\n\n\telse ji=0;\n\n \tif(ji%2==1)printf(\"First\"); \n\n \telse printf(\"Second\");\n\n\t\t\treturn 0;\n\n}\n\n\n"
    },
    {
        "id": "921",
        "source_code": "#include <bits/stdc++.h>\n\n\n\nusing namespace std;\n\n\n\nint main () {\n\n    char str[100005];\n\n    scanf(\"%s\", str);\n\n    int len=strlen(str);\n\n    if(str[0]==str[len-1]) {\n\n        if(len&1) puts(\"Second\");\n\n        else puts(\"First\");\n\n    } else {\n\n        if(len&1) puts(\"First\");\n\n        else puts(\"Second\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nchar s[1000005];\n\nbool bo;\n\nlong long ji;\n\nint main(){\n\n \tscanf(\"%s\",&s);\n\n \tlong long len=strlen(s);\n\n \tfor(long long i=0;i<len-1;i++)\n\n\t {\n\n \t \tif(s[i]!=s[i+1])\n\n\t\tbo=1;\n\n\t}\n\n\tif(bo==1)\n\n\t{\n\n\t\tif(s[0]!=s[len-1])\n\n \t\tji=len-2;\n\n \t\telse ji=len-3;\n\n\t}\n\n\telse ji=0;\n\n \tif(ji%2==1)printf(\"First\"); \n\n \telse printf(\"Second\");\n\n\t\t\treturn 0;\n\n}\n\n\n"
    },
    {
        "id": "922",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\n#include <cstring>\n\n#include <algorithm>\n\n#define ms(x) memset(x, 0, sizeof(x))\n\n#define inf 0x3f3f3f3f\n\nusing namespace std;\n\nint main()\n\n{\n\n    char s[123456];\n\n    int cnt[27], book[27];\n\n    while(scanf(\"%s\",s)!=EOF){\n\n        ms(cnt);\n\n        int len = strlen(s), s1 = 0, s2 = 0;\n\n        if(s[0] == s[len-1]) len--;\n\n        if(len%=2) {printf(\"First\\n\");}\n\n        else printf(\"Second\\n\");\n\n    }\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nchar s[1000005];\n\nbool bo;\n\nlong long ji;\n\nint main(){\n\n \tscanf(\"%s\",&s);\n\n \tlong long len=strlen(s);\n\n \tfor(long long i=0;i<len-1;i++)\n\n\t {\n\n \t \tif(s[i]!=s[i+1])\n\n\t\tbo=1;\n\n\t}\n\n\tif(bo==1)\n\n\t{\n\n\t\tif(s[0]!=s[len-1])\n\n \t\tji=len-2;\n\n \t\telse ji=len-3;\n\n\t}\n\n\telse ji=0;\n\n \tif(ji%2==1)printf(\"First\"); \n\n \telse printf(\"Second\");\n\n\t\t\treturn 0;\n\n}\n\n\n"
    },
    {
        "id": "923",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n \n\nint main()\n\n{\n\n    string s;\n\n    cin>>s;\n\n    int len = s.length();\n\n    if(s[0] == s[len-1])\n\n        if(len&1)printf(\"Second\\n\");\n\n        else printf(\"First\\n\");\n\n    else\n\n        if(len&1)printf(\"First\\n\");\n\n        else printf(\"Second\\n\");\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nchar s[1000005];\n\nbool bo;\n\nlong long ji;\n\nint main(){\n\n \tscanf(\"%s\",&s);\n\n \tlong long len=strlen(s);\n\n \tfor(long long i=0;i<len-1;i++)\n\n\t {\n\n \t \tif(s[i]!=s[i+1])\n\n\t\tbo=1;\n\n\t}\n\n\tif(bo==1)\n\n\t{\n\n\t\tif(s[0]!=s[len-1])\n\n \t\tji=len-2;\n\n \t\telse ji=len-3;\n\n\t}\n\n\telse ji=0;\n\n \tif(ji%2==1)printf(\"First\"); \n\n \telse printf(\"Second\");\n\n\t\t\treturn 0;\n\n}\n\n\n"
    },
    {
        "id": "924",
        "source_code": "#include<iostream>//\u6253\u8868\u505a\u6cd5\uff0c\u5371\u9669\u52a8\u4f5c\uff0c\u8bf7\u52ff\u6548\u4eff \n\n#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nchar s[1000005];\n\nbool bo;\n\nlong long ji;\n\nint main(){\n\n\tscanf(\"%s\",&s);\n\n\tlong long len=strlen(s);\n\n\tfor(long long i=0;i<len-1;i++){\n\n\t\tif(s[i]!=s[i+1])bo=1;\n\n\t}\n\n\tif(bo=1){\n\n\t\tif(s[0]!=s[len-1])\n\n\t\t\tji=len-2;\n\n\t\telse ji=len-3;\n\n\t}\n\n\telse ji=0;\n\n\tif(ji%2==1)cout<<\"First\";\n\n\telse cout<<\"Second\";\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nchar s[1000005];\n\nbool bo;\n\nlong long ji;\n\nint main(){\n\n \tscanf(\"%s\",&s);\n\n \tlong long len=strlen(s);\n\n \tfor(long long i=0;i<len-1;i++)\n\n\t {\n\n \t \tif(s[i]!=s[i+1])\n\n\t\tbo=1;\n\n\t}\n\n\tif(bo==1)\n\n\t{\n\n\t\tif(s[0]!=s[len-1])\n\n \t\tji=len-2;\n\n \t\telse ji=len-3;\n\n\t}\n\n\telse ji=0;\n\n \tif(ji%2==1)printf(\"First\"); \n\n \telse printf(\"Second\");\n\n\t\t\treturn 0;\n\n}\n\n\n"
    },
    {
        "id": "925",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nchar s[1000001];\n\nlong long a=0,b=0;\n\nint main()\n\n{\n\n\tcin>>s;\n\n\ta=strlen(s);\n\n\tfor (int i=0,j=strlen(s)-1;i<j;i++,j--)\n\n\t{\n\n\t\tif (s[i]==s[j])\n\n\t\tb++;\n\n\t}\n\n\tif (b==(a+2)/2)\n\n\tcout<<\"Second\";\n\n\telse\n\n\t{\n\n\tif (s[0]==s[strlen(s)-1])\n\n\t{\n\n\t\ta=a-1;\n\n\t\tif (a%2==0)\n\n\t\tcout<<\"Second\";\n\n\t\telse\n\n\t\tcout<<\"First\";\n\n\t}\n\n\telse\n\n\t{\n\n\tif (a%2==0)\n\n\tcout<<\"Second\";\n\n\telse\n\n\tcout<<\"First\";\t\n\n\t}\n\n\t}\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\nusing namespace std;\n\nchar s[1000005];\n\nbool bo;\n\nlong long ji;\n\nint main(){\n\n \tscanf(\"%s\",&s);\n\n \tlong long len=strlen(s);\n\n \tfor(long long i=0;i<len-1;i++)\n\n\t {\n\n \t \tif(s[i]!=s[i+1])\n\n\t\tbo=1;\n\n\t}\n\n\tif(bo==1)\n\n\t{\n\n\t\tif(s[0]!=s[len-1])\n\n \t\tji=len-2;\n\n \t\telse ji=len-3;\n\n\t}\n\n\telse ji=0;\n\n \tif(ji%2==1)printf(\"First\"); \n\n \telse printf(\"Second\");\n\n\t\t\treturn 0;\n\n}\n\n\n"
    },
    {
        "id": "926",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\nusing namespace std;\n\nbool dp[1000001];\n\nbool isprime(int& x){\n\n  for(int i = 2 ; i * i <= x ; i++ ) if( x % i == 0) return true;\n\n  return false;\n\n}\n\nint solve(int i){\n\n  while(true){ if(dp[i] && !isprime(i)) return i; i--; }\n\n}\n\nint main(){\n\n  int n,x,data[30],ans;\n\n  while(cin >> n >> x , n){\n\n    fill_n(dp,1000001,false); dp[0] = true;\n\n    for(int i = 0 ; i < n ; i++ ) cin >> data[i];\n\n    for(int i = 0 ; i <= x ; i++ ){\n\n      if(dp[i]) for(int j = 0 ; j < n ; j++ )\n\n        if(i + data[j] <= x) dp[i+data[j]] = true;\n\n    }\n\n    if(1 < (ans = solve(x))) cout << ans << endl;\n\n    else cout << \"NA\" << endl;\n\n  }\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\nusing namespace std;\n\nbool dp[1000001];\n\nbool isprime(int& x){\n\n  for(int i = 2 ; i * i <= x ; i++ ) if( x % i == 0) return true;\n\n  return x == 1;\n\n}\n\nint solve(int i){\n\n  while(true){ if(dp[i] && !isprime(i)) return i; i--; }\n\n}\n\nint main(){\n\n  int n,x,data[30],ans; dp[0] = true;\n\n  while(cin >> n >> x , n){\n\n    for(int i = 1 ; i <= x ; i++ ) dp[i] = false;\n\n    for(int i = 0 ; i < n ; i++ ) cin >> data[i];\n\n    for(int i = 0 ; i <= x ; i++ ){\n\n      if(dp[i]) for(int j = 0 ; j < n ; j++ )\n\n        if(i + data[j] <= x) dp[i+data[j]] = true;\n\n    }\n\n    if(ans = solve(x)) cout << ans << endl;\n\n    else cout << \"NA\" << endl;\n\n  }\n\n}"
    },
    {
        "id": "927",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\nusing namespace std;\n\nbool dp[1000001];\n\nbool isprime(int& x){\n\n  for(int i = 2 ; i * i <= x ; i++ ) if( x % i == 0) return true;\n\n  return false;\n\n}\n\nint solve(int i){\n\n  while(true){ if(dp[i] && !isprime(i)) return i; i--; }\n\n}\n\nint main(){\n\n  int n,x,data[30],ans;\n\n  while(cin >> n >> x , n){\n\n    fill_n(dp,1000001,false); dp[0] = true;\n\n    for(int i = 0 ; i < n ; i++ ) cin >> data[i];\n\n    for(int i = 0 ; i <= x ; i++ ){\n\n      if(dp[i]) for(int j = 0 ; j < n ; j++ )\n\n        if(i + data[j] <= x) dp[i+data[j]] = true;\n\n    }\n\n    if(1 < (ans = solve(x))) cout << ans << endl;\n\n    else cout << \"NA\" << endl;\n\n  }\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\nusing namespace std;\n\nbool dp[1000001];\n\nbool isprime(int& x){\n\n  for(int i = 2 ; i * i <= x ; i++ ) if( x % i == 0) return true;\n\n  return x == 1;\n\n}\n\nint solve(int i){\n\n  while(true){\n\n    if(dp[i] && !isprime(i)) return i;\n\n    i--;\n\n  }\n\n}\n\nint main(){\n\n  int n,x,data,ans;\n\n  dp[0] = true;\n\n  while(cin >> n >> x , n){\n\n    for(int i = 1 ; i <= x ; i++ ) dp[i] = false;\n\n    for(int i = 0 ; i < n ; i++ ){\n\n      cin >> data;\n\n      for(int i = data ; i <= x ; i++ ) if(dp[i-data]) dp[i] = true;\n\n    }\n\n    if(ans = solve(x)) cout << ans << endl;\n\n    else cout << \"NA\" << endl;\n\n  }\n\n}"
    },
    {
        "id": "928",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\nusing namespace std;\n\nbool dp[1000001];\n\nbool isprime(int& x){\n\n  for(int i = 2 ; i * i <= x ; i++ ) if( x % i == 0) return true;\n\n  return x == 1;\n\n}\n\nint solve(int i){\n\n  while(true){ if(dp[i] && !isprime(i)) return i; i--; }\n\n}\n\nint main(){\n\n  int n,x,data[30],ans; dp[0] = true;\n\n  while(cin >> n >> x , n){\n\n    for(int i = 1 ; i <= x ; i++ ) dp[i] = false;\n\n    for(int i = 0 ; i < n ; i++ ) cin >> data[i];\n\n    for(int i = 0 ; i <= x ; i++ ){\n\n      if(dp[i]) for(int j = 0 ; j < n ; j++ )\n\n        if(i + data[j] <= x) dp[i+data[j]] = true;\n\n    }\n\n    if(ans = solve(x)) cout << ans << endl;\n\n    else cout << \"NA\" << endl;\n\n  }\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<algorithm>\n\nusing namespace std;\n\nbool dp[1000001];\n\nbool isprime(int& x){\n\n  for(int i = 2 ; i * i <= x ; i++ ) if( x % i == 0) return true;\n\n  return x == 1;\n\n}\n\nint solve(int i){\n\n  while(true){\n\n    if(dp[i] && !isprime(i)) return i;\n\n    i--;\n\n  }\n\n}\n\nint main(){\n\n  int n,x,data,ans;\n\n  dp[0] = true;\n\n  while(cin >> n >> x , n){\n\n    for(int i = 1 ; i <= x ; i++ ) dp[i] = false;\n\n    for(int i = 0 ; i < n ; i++ ){\n\n      cin >> data;\n\n      for(int i = data ; i <= x ; i++ ) if(dp[i-data]) dp[i] = true;\n\n    }\n\n    if(ans = solve(x)) cout << ans << endl;\n\n    else cout << \"NA\" << endl;\n\n  }\n\n}"
    },
    {
        "id": "929",
        "source_code": "#include <cstdio>\n\n#include <iostream>\n\n#include <algorithm>\n\n\n\nusing namespace std;\n\n\n\n\n\nint an[105];\n\nint ans,a,b,c;\n\n\n\nint main()\n\n{\n\n\tcin >> a >> b >> c;\n\n\tan[a]++;\n\n\tan[b]++;\n\n\tan[c]++;\n\n\tfor(int i = 0; i < 105; i++){\n\n\t\tans = max(ans,an[i]);\n\n\t}\n\n\tcout << (3-ans+1) << endl;\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\nint main(){\n\n\tint a,b,c;\n\n\tscanf(\"%d %d %d\",&a,&b,&c);\n\n\tif(a != b && b != c && a != c) printf(\"3\\n\");\n\n\telse if(a == b && b == c) printf(\"1\\n\");\n\n\telse printf(\"2\\n\");\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "930",
        "source_code": "\n\n#include<bits/stdc++.h>\n\n#define lln long long int\n\n#define llu unsigned lln\n\n#define sc(n) scanf(\"%d\",&n);\n\n#define scl(n) scanf(\"%lld\",&n);\n\n#define scd(n) scanf(\"%lf\",&n);\n\n#define pf(res) printf(\"%d\\n\",res);\n\n#define pfl(res) printf(\"%lld\\n\",res);\n\n#define pfd(res) printf(\"%lf\\n\",res);\n\n#define maxii 200005\n\nusing namespace std;\n\ntypedef pair<int,int> pii;\n\ntypedef pair<lln,lln> pll;\n\n vector<int> vi[maxii];\n\n vector<int>::iterator child;\n\ntypedef vector<lln> vl;\n\ntypedef vector<pii> vii;\n\ntypedef vector<pll> vll;\n\n\n\n\n\nint arr[maxii];\n\nint arr2[maxii];\n\n\n\n\n\nint main()\n\n{\n\n   set<int>st;\n\n   int a,b,c;\n\n   cin>>a>>b>>c;\n\n   st.insert(a);\n\n   st.insert(b);\n\n   st.insert(c);\n\n   cout<<st.size();\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main(){\n\n\n\n    int a,b,c; cin >> a >> b >> c;\n\n\n\n    int cnt = 0;\n\n    if(a != b)cnt++;\n\n    if(a != c)cnt++;\n\n    if(b != c)cnt++;\n\n    if(cnt != 0)cout << cnt;\n\n    else cout << 1;\n\n\n\n}"
    },
    {
        "id": "931",
        "source_code": "\n\n#include<bits/stdc++.h>\n\n#define lln long long int\n\n#define llu unsigned lln\n\n#define sc(n) scanf(\"%d\",&n);\n\n#define scl(n) scanf(\"%lld\",&n);\n\n#define scd(n) scanf(\"%lf\",&n);\n\n#define pf(res) printf(\"%d\\n\",res);\n\n#define pfl(res) printf(\"%lld\\n\",res);\n\n#define pfd(res) printf(\"%lf\\n\",res);\n\n#define maxii 200005\n\nusing namespace std;\n\ntypedef pair<int,int> pii;\n\ntypedef pair<lln,lln> pll;\n\n vector<int> vi[maxii];\n\n vector<int>::iterator child;\n\ntypedef vector<lln> vl;\n\ntypedef vector<pii> vii;\n\ntypedef vector<pll> vll;\n\n\n\n\n\nint arr[maxii];\n\nint arr2[maxii];\n\n\n\n\n\nint main()\n\n{\n\n   set<int>st;\n\n   int a,b,c;\n\n   cin>>a>>b>>c;\n\n   st.insert(a);\n\n   st.insert(b);\n\n   st.insert(c);\n\n   cout<<st.size();\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include <iostream>  \n\n#include <string.h> \n\nusing namespace std;\n\nint main() {\n\n    int a, b, c, d;\n\n    cin >> a >> b >> c ;\n\n    if (a == b&&b == c)\n\n        cout << 1;\n\n    else if (a != b && b != c && c != a)\n\n        cout << 3;\n\n    else \n\n        cout<<2;\n\n    return 0;\n\n}\n\n \n"
    },
    {
        "id": "932",
        "source_code": "\n\n#include<bits/stdc++.h>\n\n#define lln long long int\n\n#define llu unsigned lln\n\n#define sc(n) scanf(\"%d\",&n);\n\n#define scl(n) scanf(\"%lld\",&n);\n\n#define scd(n) scanf(\"%lf\",&n);\n\n#define pf(res) printf(\"%d\\n\",res);\n\n#define pfl(res) printf(\"%lld\\n\",res);\n\n#define pfd(res) printf(\"%lf\\n\",res);\n\n#define maxii 200005\n\nusing namespace std;\n\ntypedef pair<int,int> pii;\n\ntypedef pair<lln,lln> pll;\n\n vector<int> vi[maxii];\n\n vector<int>::iterator child;\n\ntypedef vector<lln> vl;\n\ntypedef vector<pii> vii;\n\ntypedef vector<pll> vll;\n\n\n\n\n\nint arr[maxii];\n\nint arr2[maxii];\n\n\n\n\n\nint main()\n\n{\n\n   set<int>st;\n\n   int a,b,c;\n\n   cin>>a>>b>>c;\n\n   st.insert(a);\n\n   st.insert(b);\n\n   st.insert(c);\n\n   cout<<st.size();\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n\n{\n\n    int a,b,c;\n\n    cin>>a>>b>>c;\n\n    if (a!=b&& b!=c&&a!=c)\n\n        cout<<3;\n\n    else if (a==b&&a==c)\n\n        cout<<1;\n\n    else if (a==c||a==b||b==c)\n\n        cout<<2;\n\n\n\nreturn 0;\n\n}\n\n\n\n\n"
    },
    {
        "id": "933",
        "source_code": "\n\n#include<bits/stdc++.h>\n\n#define lln long long int\n\n#define llu unsigned lln\n\n#define sc(n) scanf(\"%d\",&n);\n\n#define scl(n) scanf(\"%lld\",&n);\n\n#define scd(n) scanf(\"%lf\",&n);\n\n#define pf(res) printf(\"%d\\n\",res);\n\n#define pfl(res) printf(\"%lld\\n\",res);\n\n#define pfd(res) printf(\"%lf\\n\",res);\n\n#define maxii 200005\n\nusing namespace std;\n\ntypedef pair<int,int> pii;\n\ntypedef pair<lln,lln> pll;\n\n vector<int> vi[maxii];\n\n vector<int>::iterator child;\n\ntypedef vector<lln> vl;\n\ntypedef vector<pii> vii;\n\ntypedef vector<pll> vll;\n\n\n\n\n\nint arr[maxii];\n\nint arr2[maxii];\n\n\n\n\n\nint main()\n\n{\n\n   set<int>st;\n\n   int a,b,c;\n\n   cin>>a>>b>>c;\n\n   st.insert(a);\n\n   st.insert(b);\n\n   st.insert(c);\n\n   cout<<st.size();\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include<iostream>\n\n#include<set>\n\n#include<vector>\n\n#include<string>\n\n#include<iterator>\n\n#include<iomanip>\n\n#include<cmath>\n\n#include<map>\n\n#include<string.h>\n\n#include<algorithm>\n\n\n\nusing namespace std;\n\nvoid ll(){\n\n\tstd::ios_base::sync_with_stdio(0);\n\n\tcin.tie(NULL);\n\n\tcout.tie(0);\n\n}\n\n\n\nint main() {\n\n\n\n\tll();\n\n\t \n\n\tint a, b, c;\n\n\tcin >> a >> b >> c;\n\n\tif ((a != b&&a==c)||(a==b&&a!=c)||(b==c&&c!=a))\n\n\t\tcout << 2 << endl;\n\n\telse if (a != b&&a != c&&b != c)\n\n\t\tcout << 3 << endl;\n\n\telse if (a == b&&a == c)\n\n\t\tcout << 1 << endl;\n\n\t\n\n\n\n}\n\n\n\n\n\n\n"
    },
    {
        "id": "934",
        "source_code": "\n\n#include<bits/stdc++.h>\n\n#define lln long long int\n\n#define llu unsigned lln\n\n#define sc(n) scanf(\"%d\",&n);\n\n#define scl(n) scanf(\"%lld\",&n);\n\n#define scd(n) scanf(\"%lf\",&n);\n\n#define pf(res) printf(\"%d\\n\",res);\n\n#define pfl(res) printf(\"%lld\\n\",res);\n\n#define pfd(res) printf(\"%lf\\n\",res);\n\n#define maxii 200005\n\nusing namespace std;\n\ntypedef pair<int,int> pii;\n\ntypedef pair<lln,lln> pll;\n\n vector<int> vi[maxii];\n\n vector<int>::iterator child;\n\ntypedef vector<lln> vl;\n\ntypedef vector<pii> vii;\n\ntypedef vector<pll> vll;\n\n\n\n\n\nint arr[maxii];\n\nint arr2[maxii];\n\n\n\n\n\nint main()\n\n{\n\n   set<int>st;\n\n   int a,b,c;\n\n   cin>>a>>b>>c;\n\n   st.insert(a);\n\n   st.insert(b);\n\n   st.insert(c);\n\n   cout<<st.size();\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n",
        "optimized_code": "#include<iostream>\n\nusing namespace std;\n\nint main()\n\n{\n\n\tint a, b, c, d;\n\n\tcin >> a >> b >> c;\n\n\tif (a == b && a == c)\n\n\t\tcout << 1;\n\n\telse if (a != b && a != c&&b!=c)\n\n\t\tcout << 3;\n\n\telse\n\n\t\tcout << 2;\n\n}\n"
    },
    {
        "id": "936",
        "source_code": "#include<iostream>\n\n#include<set>\n\nusing namespace std;\n\nint main()\n\n{\n\n    set<int> s;\n\n    int a;\n\n    for(int i=0;i<3;i++)\n\n    {\n\n        cin>>a;\n\n        s.insert(a);\n\n    }\n\n    cout<<s.size()<<endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main()\n\n{\n\n\tint a[3]={0};\n\n\tint i,j,x;\n\n\tint k=0;\n\n\tfor(i=0;i<3;i++)\n\n\t{\n\n\tscanf(\"%d\",&x);\n\n\ta[i]=x;\n\n\t}\n\n\tfor(i=0;i<2;i++)\n\n\t{\n\n\t\tfor(j=i+1;j<3;j++)\n\n\t\t{\n\n\t\t\tif(a[0]==a[1]&&a[1]==a[2])\n\n\t\t\tk=1;\n\n\t\t \telse if(a[i]!=a[j])\n\n\t\t\tk++;\n\n\t\t\t\n\n\t\t}\n\n\t}\n\n\tprintf(\"%d\\n\",k);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "937",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<cmath>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst ll mod=998244353;\n\nll n,m,ny[1100000],jc[1100000];\n\nll c(ll n,ll m)\n\n{\n\n    return (ll)jc[n]*ny[m]%mod*ny[n-m]%mod;\n\n}\n\n \n\nint main()\n\n{\n\n    cin>>n>>m;\n\n    if(n<=m)swap(n,m);\n\n    jc[0]=jc[1]=ny[0]=ny[1]=1;\n\n    for(int i=2;i<=n+m;i++)jc[i]=(ll)jc[i-1]*i%mod,ny[i]=(ll)(mod-mod/i)*ny[mod%i]%mod;\n\n    for(int i=2;i<=n+m;i++)ny[i]=(ll)ny[i-1]*ny[i]%mod;\n\n    ll ans=0;\n\n    for(int i=1;i<=m;i++)\n\n    {\n\n        ans+=(ll)c(n+m-i*2,n-i)%mod*c(i*2,i)%mod;\n\n        ans%=mod;\n\n    }\n\n    ans=(ll)ans*ny[n+m]%mod*jc[n]%mod*jc[m]%mod*ny[2]%mod;\n\n    ans+=n;\n\n    ans%=mod;\n\n     \n\n    cout<<ans<<endl;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\nconst int N=1000005,Mod=998244353;\n\nint fac[N],inv[N];\n\ninline int qpow(int a,int b){\n\n\tint ans=1;\n\n\twhile (b){\n\n\t\tif (b&1) ans=(1ll*ans*a)%Mod;\n\n\t\ta=(1ll*a*a)%Mod,b>>=1;\n\n\t}\n\n\treturn ans;\n\n}\n\ninline int Min(int a,int b){\n\n\treturn a<b?a:b;\n\n}\n\ninline int Max(int a,int b){\n\n\treturn a>b?a:b;\n\n}\n\ninline int C(int n,int m){\n\n\treturn 1ll*fac[n]*inv[m]%Mod*inv[n-m]%Mod;\n\n}\n\nint main (){\n\n\tint n,m;scanf (\"%d%d\",&n,&m);\n\n\tfac[0]=1;\n\n\tfor (int i=1;i<=n+m;i++) fac[i]=1ll*fac[i-1]*i%Mod;\n\n\tinv[n+m]=qpow(fac[n+m],Mod-2);\n\n\tfor (int i=n+m-1;i>=0;i--) inv[i]=1ll*inv[i+1]*(i+1)%Mod;\n\n\tint t=Min(n,m),ans=0;\n\n\tfor (int i=1;i<=t;i++) ans=(1ll*ans+1ll*C(i*2,i)*C(n+m-2*i,n-i))%Mod;\n\n\tans=1ll*ans*qpow(2,Mod-2)%Mod*qpow(C(n+m,n),Mod-2)%Mod;\n\n\tprintf (\"%d\",(ans+Max(n,m))%Mod);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "938",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<cmath>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst ll mod=998244353;\n\nll n,m,ny[1100000],jc[1100000];\n\nll c(ll n,ll m)\n\n{\n\n    return (ll)jc[n]*ny[m]%mod*ny[n-m]%mod;\n\n}\n\n \n\nint main()\n\n{\n\n    cin>>n>>m;\n\n    if(n<=m)swap(n,m);\n\n    jc[0]=jc[1]=ny[0]=ny[1]=1;\n\n    for(int i=2;i<=n+m;i++)jc[i]=(ll)jc[i-1]*i%mod,ny[i]=(ll)(mod-mod/i)*ny[mod%i]%mod;\n\n    for(int i=2;i<=n+m;i++)ny[i]=(ll)ny[i-1]*ny[i]%mod;\n\n    ll ans=0;\n\n    for(int i=1;i<=m;i++)\n\n    {\n\n        ans+=(ll)c(n+m-i*2,n-i)%mod*c(i*2,i)%mod;\n\n        ans%=mod;\n\n    }\n\n    ans=(ll)ans*ny[n+m]%mod*jc[n]%mod*jc[m]%mod*ny[2]%mod;\n\n    ans+=n;\n\n    ans%=mod;\n\n     \n\n    cout<<ans<<endl;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\nconst int N=1000005,Mod=998244353;\n\nint fac[N],inv[N];\n\ninline int qpow(int a,int b){\n\n\tint ans=1;\n\n\twhile (b){\n\n\t\tif (b&1) ans=(1ll*ans*a)%Mod;\n\n\t\ta=(1ll*a*a)%Mod,b>>=1;\n\n\t}\n\n\treturn ans;\n\n}\n\ninline int Min(int a,int b){\n\n\treturn a<b?a:b;\n\n}\n\ninline int Max(int a,int b){\n\n\treturn a>b?a:b;\n\n}\n\ninline int C(int n,int m){\n\n\treturn 1ll*fac[n]*inv[m]%Mod*inv[n-m]%Mod;\n\n}\n\nint main (){\n\n\tint n,m;scanf (\"%d%d\",&n,&m);\n\n\tfac[0]=1;\n\n\tfor (int i=1;i<=n+m;i++) fac[i]=1ll*fac[i-1]*i%Mod;\n\n\tinv[n+m]=qpow(fac[n+m],Mod-2);\n\n\tfor (int i=n+m-1;i>=0;i--) inv[i]=1ll*inv[i+1]*(i+1)%Mod;\n\n\tint t=Min(n,m),ans=0;\n\n\tfor (int i=1;i<=t;i++) ans=(1ll*ans+1ll*C(i*2,i)*C(n+m-2*i,n-i))%Mod;\n\n\tans=1ll*ans*qpow(2,Mod-2)%Mod*qpow(C(n+m,n),Mod-2)%Mod;\n\n\tprintf (\"%d\",(ans+Max(n,m))%Mod);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "939",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<cmath>\n\n\n\nusing namespace std;\n\nconst int N=1000005;\n\nconst int MOD=998244353;\n\ntypedef long long LL;\n\n\n\nint n,m,fac[N],inv[N];\n\nint Ans1,Ans2;\n\n\n\n//LL gcd(LL x,LL y) {\n\n//\tif(!y) return x;\n\n//\treturn gcd(y,x%y);\n\n//}\n\n//\n\n//struct Data{\n\n//\tLL x,y;\n\n//\tData(LL _x=0,LL _y=0) {x=_x; y=_y;}\n\n//\tfriend Data operator+(const Data A,const Data B){\n\n//\t\tData ret; ret.y=A.y*B.y; ret.x=A.x*B.y+A.y*B.x;\n\n//\t\tLL tmp=gcd(ret.x,ret.y); ret.x/=tmp; ret.y/=tmp;\n\n//\t\treturn ret;\n\n//\t}\n\n//\tfriend Data operator*(const Data A,const Data B){\n\n//\t\tData ret; ret.x=A.x*B.x; ret.y=A.y*B.y;\n\n//\t\tLL tmp=gcd(ret.x,ret.y); ret.x/=tmp; ret.y/=tmp;\n\n//\t\treturn ret;\n\n//\t}\n\n//}ans;\n\n\n\ninline int fast_pow(int x,int y){\n\n\tint ret=1;\n\n\tfor(;y;y>>=1){\n\n\t\tif(y&1) ret=(LL)ret*x%MOD;\n\n\t\tx=(LL)x*x%MOD;\n\n\t}\n\n\treturn ret;\n\n}\n\n\n\ninline int C(int x,int y){\n\n\treturn (LL)fac[x]*inv[y]%MOD*inv[x-y]%MOD;\n\n}\n\n\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tif(n>m) swap(n,m); fac[0]=inv[0]=1;\n\n\tint i;\n\n\tfor(i=1;i<=n+m;i+=4){\n\n\t\tfac[i]=1ll*fac[i-1]*i%MOD;\n\n\t\tfac[i+1]=1ll*fac[i]*(i+1)%MOD;\n\n\t\tfac[i+2]=1ll*fac[i+1]*(i+2)%MOD;\n\n\t\tfac[i+3]=1ll*fac[i+2]*(i+3)%MOD;\n\n\t}\n\n\tfor(;i<=n+m;i++) fac[i]=fac[i-1]*i%MOD;\n\n\tinv[n+m]=fast_pow(fac[n+m],MOD-2);\n\n\tfor(int i=n+m-1;~i;i--) inv[i]=1ll*inv[i+1]*(i+1)%MOD;\n\n\tAns1=1ll*2*m*C(n+m,n)%MOD; Ans2=fast_pow(C(n+m,n)*2%MOD,MOD-2);\n\n\tfor(int i=1;i<=n;i++) {\n\n\t\tAns1=Ans1+1ll*C(n-i+m-i,n-i)*C(i+i,i)%MOD;\t\n\n\t\tAns1%=MOD;\n\n\t}\n\n\tprintf(\"%lld\\n\",1ll*Ans1*Ans2%MOD);\n\n//\tans=ans+Data(1,2)*Data(C(n-i+m-i,n-i)*C(i+i,i),C(n+m,n));\n\n//\tprintf(\"%lld\\n\",1ll*ans.x*fast_pow(ans.y,MOD-2)%MOD);\n\n\treturn 0;\t\n\n}",
        "optimized_code": "#include <cstdio>\n\nconst int N=1000005,Mod=998244353;\n\nint fac[N],inv[N];\n\ninline int qpow(int a,int b){\n\n\tint ans=1;\n\n\twhile (b){\n\n\t\tif (b&1) ans=(1ll*ans*a)%Mod;\n\n\t\ta=(1ll*a*a)%Mod,b>>=1;\n\n\t}\n\n\treturn ans;\n\n}\n\ninline int Min(int a,int b){\n\n\treturn a<b?a:b;\n\n}\n\ninline int Max(int a,int b){\n\n\treturn a>b?a:b;\n\n}\n\ninline int C(int n,int m){\n\n\treturn 1ll*fac[n]*inv[m]%Mod*inv[n-m]%Mod;\n\n}\n\nint main (){\n\n\tint n,m;scanf (\"%d%d\",&n,&m);\n\n\tfac[0]=1;\n\n\tfor (int i=1;i<=n+m;i++) fac[i]=1ll*fac[i-1]*i%Mod;\n\n\tinv[n+m]=qpow(fac[n+m],Mod-2);\n\n\tfor (int i=n+m-1;i>=0;i--) inv[i]=1ll*inv[i+1]*(i+1)%Mod;\n\n\tint t=Min(n,m),ans=0;\n\n\tfor (int i=1;i<=t;i++) ans=(1ll*ans+1ll*C(i*2,i)*C(n+m-2*i,n-i))%Mod;\n\n\tans=1ll*ans*qpow(2,Mod-2)%Mod*qpow(C(n+m,n),Mod-2)%Mod;\n\n\tprintf (\"%d\",(ans+Max(n,m))%Mod);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "940",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<cmath>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst ll mod=998244353;\n\nll n,m,ny[1100000],jc[1100000];\n\nll c(ll n,ll m)\n\n{\n\n    return (ll)jc[n]*ny[m]%mod*ny[n-m]%mod;\n\n}\n\n \n\nint main()\n\n{\n\n    cin>>n>>m;\n\n    if(n<=m)swap(n,m);\n\n    jc[0]=jc[1]=ny[0]=ny[1]=1;\n\n    for(int i=2;i<=n+m;i++)jc[i]=(ll)jc[i-1]*i%mod,ny[i]=(ll)(mod-mod/i)*ny[mod%i]%mod;\n\n    for(int i=2;i<=n+m;i++)ny[i]=(ll)ny[i-1]*ny[i]%mod;\n\n    ll ans=0;\n\n    for(int i=1;i<=m;i++)\n\n    {\n\n        ans+=(ll)c(n+m-i*2,n-i)%mod*c(i*2,i)%mod;\n\n        ans%=mod;\n\n    }\n\n    ans=(ll)ans*ny[n+m]%mod*jc[n]%mod*jc[m]%mod*ny[2]%mod;\n\n    ans+=n;\n\n    ans%=mod;\n\n     \n\n    cout<<ans<<endl;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;const int N=3*1e6+10;typedef long long ll;const ll mod=998244353;\n\ninline ll po(ll a,ll p){ll r=1;for(;p;p>>=1,a=a*a%mod)if(p&1)r=r*a%mod;return r;}\n\nint n;int m;ll fac[N];ll ifac[N];\n\ninline ll c(int a,int b){return fac[a]*ifac[b]%mod*ifac[a-b]%mod;}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);if(n<m)swap(n,m);\n\n\tfac[0]=1;for(int i=1;i<=n+m;i++)fac[i]=fac[i-1]*i%mod;ifac[0]=ifac[1]=1;\n\n\tfor(int i=2;i<=n+m;i++)ifac[i]=(mod-mod/i)*ifac[mod%i]%mod;\n\n\tfor(int i=1;i<=n+m;i++)(ifac[i]*=ifac[i-1])%=mod;\n\n\tll tans=0;for(int i=1;i<=m;i++)\n\n\t\t(tans+=c(i+i-1,i)*c(n+m-i-i,n-i))%=mod;\n\n\ttans=(mod-tans)%mod;(tans+=(n-m)*c(m+n,m-1))%=mod;\n\n\tif(m!=n)\n\n\t{\n\n\t\tfor(int i=1;i<=m;i++)\n\n\t\t\t(tans+=c(m+i,i)*i%mod*c(n-i-1,m-i))%=mod;\t\n\n\t}else (tans+=c(n+m,m)*m)%=mod;\n\n\ttans=tans*po(c(n+m,m),mod-2)%mod;\n\n\ttans=(n+m+mod-tans)%mod;\n\n\tprintf(\"%lld\\n\",tans);return 0;\n\n}"
    },
    {
        "id": "941",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<cmath>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst ll mod=998244353;\n\nll n,m,ny[1100000],jc[1100000];\n\nll c(ll n,ll m)\n\n{\n\n    return (ll)jc[n]*ny[m]%mod*ny[n-m]%mod;\n\n}\n\n \n\nint main()\n\n{\n\n    cin>>n>>m;\n\n    if(n<=m)swap(n,m);\n\n    jc[0]=jc[1]=ny[0]=ny[1]=1;\n\n    for(int i=2;i<=n+m;i++)jc[i]=(ll)jc[i-1]*i%mod,ny[i]=(ll)(mod-mod/i)*ny[mod%i]%mod;\n\n    for(int i=2;i<=n+m;i++)ny[i]=(ll)ny[i-1]*ny[i]%mod;\n\n    ll ans=0;\n\n    for(int i=1;i<=m;i++)\n\n    {\n\n        ans+=(ll)c(n+m-i*2,n-i)%mod*c(i*2,i)%mod;\n\n        ans%=mod;\n\n    }\n\n    ans=(ll)ans*ny[n+m]%mod*jc[n]%mod*jc[m]%mod*ny[2]%mod;\n\n    ans+=n;\n\n    ans%=mod;\n\n     \n\n    cout<<ans<<endl;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;const int N=3*1e6+10;typedef long long ll;const ll mod=998244353;\n\ninline ll po(ll a,ll p){ll r=1;for(;p;p>>=1,a=a*a%mod)if(p&1)r=r*a%mod;return r;}\n\nint n;int m;ll fac[N];ll ifac[N];\n\ninline ll c(int a,int b){return fac[a]*ifac[b]%mod*ifac[a-b]%mod;}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);if(n<m)swap(n,m);\n\n\tfac[0]=1;for(int i=1;i<=n+m;i++)fac[i]=fac[i-1]*i%mod;ifac[0]=ifac[1]=1;\n\n\tfor(int i=2;i<=n+m;i++)ifac[i]=(mod-mod/i)*ifac[mod%i]%mod;\n\n\tfor(int i=1;i<=n+m;i++)(ifac[i]*=ifac[i-1])%=mod;\n\n\tll tans=0;for(int i=1;i<=m;i++)\n\n\t\t(tans+=c(i+i-1,i)*c(n+m-i-i,n-i))%=mod;\n\n\ttans=(mod-tans)%mod;(tans+=(n-m)*c(m+n,m-1))%=mod;\n\n\tif(m!=n)\n\n\t{\n\n\t\tfor(int i=1;i<=m;i++)\n\n\t\t\t(tans+=c(m+i,i)*i%mod*c(n-i-1,m-i))%=mod;\t\n\n\t}else (tans+=c(n+m,m)*m)%=mod;\n\n\ttans=tans*po(c(n+m,m),mod-2)%mod;\n\n\ttans=(n+m+mod-tans)%mod;\n\n\tprintf(\"%lld\\n\",tans);return 0;\n\n}"
    },
    {
        "id": "942",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<cmath>\n\n\n\nusing namespace std;\n\nconst int N=1000005;\n\nconst int MOD=998244353;\n\ntypedef long long LL;\n\n\n\nint n,m,fac[N],inv[N];\n\nint Ans1,Ans2;\n\n\n\n//LL gcd(LL x,LL y) {\n\n//\tif(!y) return x;\n\n//\treturn gcd(y,x%y);\n\n//}\n\n//\n\n//struct Data{\n\n//\tLL x,y;\n\n//\tData(LL _x=0,LL _y=0) {x=_x; y=_y;}\n\n//\tfriend Data operator+(const Data A,const Data B){\n\n//\t\tData ret; ret.y=A.y*B.y; ret.x=A.x*B.y+A.y*B.x;\n\n//\t\tLL tmp=gcd(ret.x,ret.y); ret.x/=tmp; ret.y/=tmp;\n\n//\t\treturn ret;\n\n//\t}\n\n//\tfriend Data operator*(const Data A,const Data B){\n\n//\t\tData ret; ret.x=A.x*B.x; ret.y=A.y*B.y;\n\n//\t\tLL tmp=gcd(ret.x,ret.y); ret.x/=tmp; ret.y/=tmp;\n\n//\t\treturn ret;\n\n//\t}\n\n//}ans;\n\n\n\ninline int fast_pow(int x,int y){\n\n\tint ret=1;\n\n\tfor(;y;y>>=1){\n\n\t\tif(y&1) ret=(LL)ret*x%MOD;\n\n\t\tx=(LL)x*x%MOD;\n\n\t}\n\n\treturn ret;\n\n}\n\n\n\ninline int C(int x,int y){\n\n\treturn (LL)fac[x]*inv[y]%MOD*inv[x-y]%MOD;\n\n}\n\n\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tif(n>m) swap(n,m); fac[0]=inv[0]=1;\n\n\tint i;\n\n\tfor(i=1;i<=n+m;i+=4){\n\n\t\tfac[i]=1ll*fac[i-1]*i%MOD;\n\n\t\tfac[i+1]=1ll*fac[i]*(i+1)%MOD;\n\n\t\tfac[i+2]=1ll*fac[i+1]*(i+2)%MOD;\n\n\t\tfac[i+3]=1ll*fac[i+2]*(i+3)%MOD;\n\n\t}\n\n\tfor(;i<=n+m;i++) fac[i]=fac[i-1]*i%MOD;\n\n\tinv[n+m]=fast_pow(fac[n+m],MOD-2);\n\n\tfor(int i=n+m-1;~i;i--) inv[i]=1ll*inv[i+1]*(i+1)%MOD;\n\n\tAns1=1ll*2*m*C(n+m,n)%MOD; Ans2=fast_pow(C(n+m,n)*2%MOD,MOD-2);\n\n\tfor(int i=1;i<=n;i++) {\n\n\t\tAns1=Ans1+1ll*C(n-i+m-i,n-i)*C(i+i,i)%MOD;\t\n\n\t\tAns1%=MOD;\n\n\t}\n\n\tprintf(\"%lld\\n\",1ll*Ans1*Ans2%MOD);\n\n//\tans=ans+Data(1,2)*Data(C(n-i+m-i,n-i)*C(i+i,i),C(n+m,n));\n\n//\tprintf(\"%lld\\n\",1ll*ans.x*fast_pow(ans.y,MOD-2)%MOD);\n\n\treturn 0;\t\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;const int N=3*1e6+10;typedef long long ll;const ll mod=998244353;\n\ninline ll po(ll a,ll p){ll r=1;for(;p;p>>=1,a=a*a%mod)if(p&1)r=r*a%mod;return r;}\n\nint n;int m;ll fac[N];ll ifac[N];\n\ninline ll c(int a,int b){return fac[a]*ifac[b]%mod*ifac[a-b]%mod;}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);if(n<m)swap(n,m);\n\n\tfac[0]=1;for(int i=1;i<=n+m;i++)fac[i]=fac[i-1]*i%mod;ifac[0]=ifac[1]=1;\n\n\tfor(int i=2;i<=n+m;i++)ifac[i]=(mod-mod/i)*ifac[mod%i]%mod;\n\n\tfor(int i=1;i<=n+m;i++)(ifac[i]*=ifac[i-1])%=mod;\n\n\tll tans=0;for(int i=1;i<=m;i++)\n\n\t\t(tans+=c(i+i-1,i)*c(n+m-i-i,n-i))%=mod;\n\n\ttans=(mod-tans)%mod;(tans+=(n-m)*c(m+n,m-1))%=mod;\n\n\tif(m!=n)\n\n\t{\n\n\t\tfor(int i=1;i<=m;i++)\n\n\t\t\t(tans+=c(m+i,i)*i%mod*c(n-i-1,m-i))%=mod;\t\n\n\t}else (tans+=c(n+m,m)*m)%=mod;\n\n\ttans=tans*po(c(n+m,m),mod-2)%mod;\n\n\ttans=(n+m+mod-tans)%mod;\n\n\tprintf(\"%lld\\n\",tans);return 0;\n\n}"
    },
    {
        "id": "943",
        "source_code": "#include<bits/stdc++.h>\n\n#define N 1000005\n\n#define p 998244353\n\n#define int long long \n\nusing namespace std;\n\n\n\ninline void rd(int &x){\n\n\tx=0;char ch=0;int w=0;\n\n\twhile(!isdigit(ch)) ch=getchar(),w|=ch=='-';\n\n\twhile( isdigit(ch)) x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n\n\tx=w?-x:x;\n\n}\n\n\n\nint n,m,ans;\n\nint f[N],inv[N];\n\n\n\ninline int POW(int a,int b=p-2,int ans=1){\n\n\tfor(;b;b>>=1,a=a*a%p)\n\n\t\tif(b&1) ans=ans*a%p;\n\n\treturn ans;\n\n}\n\n\n\ninline int C(int n,int m){\n\n\treturn f[n]*inv[m]%p*inv[n-m]%p;\n\n}\n\nsigned main(){\n\n\tcin>>n>>m;if(n<m) swap(n,m);\n\n\tfor(int i=f[0]=inv[0]=1;i<=n+m;i++)\n\n\t\tf[i]=f[i-1]*i%p,inv[i]=POW(f[i]);\n\n\tfor(int i=1;i<=m;i++)\n\n\t\tans=(ans+C(i<<1,i)*C(n-i+m-i,n-i))%p;\n\n\tans=ans*inv[2]%p*POW(C(n+m,n))%p;\n\n\tcout<<(ans+n)%p;\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n\n\nconst int maxn = 1000005, P = 998244353;\n\nint n, m, fac[maxn], ifac[maxn];\n\n\n\nint power(int a, int x)\n\n{\n\n\tint ans = 1;\n\n\tfor (; x; x >>= 1, a = 1LL * a * a % P)\n\n\t\tif (x & 1)\n\n\t\t\tans = 1LL * ans * a % P;\n\n\treturn ans;\n\n}\n\nint binom(int n, int m)\n\n{\n\n\tif (n < m || m < 0)\n\n\t\treturn 0;\n\n\treturn 1LL * fac[n] * ifac[m] % P * ifac[n - m] % P;\n\n}\n\n\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tif (n < m)\n\n\t\tstd::swap(n, m);\n\n\tfac[0] = 1;\n\n\tfor (int i = 1; i <= n + m; ++i)\n\n\t\tfac[i] = 1LL * fac[i - 1] * i % P;\n\n\tifac[n + m] = power(fac[n + m], P - 2);\n\n\tfor (int i = n + m; i; --i)\n\n\t\tifac[i - 1] = 1LL * ifac[i] * i % P;\n\n\tint ans = 0;\n\n\tfor (int i = 1; i <= m; ++i)\n\n\t\tans = (ans + 1LL * binom(2 * i, i) * binom(n + m - 2 * i, n - i)) % P;\n\n\tans = 1LL * ans * power(2 * binom(n + m, n) % P, P - 2) % P;\n\n\tans = (ans + n) % P;\n\n\tprintf(\"%d\\n\", ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "944",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<cmath>\n\n\n\nusing namespace std;\n\nconst int N=1000005;\n\nconst int MOD=998244353;\n\ntypedef long long LL;\n\n\n\nint n,m,fac[N],inv[N];\n\nint Ans1,Ans2;\n\n\n\n//LL gcd(LL x,LL y) {\n\n//\tif(!y) return x;\n\n//\treturn gcd(y,x%y);\n\n//}\n\n//\n\n//struct Data{\n\n//\tLL x,y;\n\n//\tData(LL _x=0,LL _y=0) {x=_x; y=_y;}\n\n//\tfriend Data operator+(const Data A,const Data B){\n\n//\t\tData ret; ret.y=A.y*B.y; ret.x=A.x*B.y+A.y*B.x;\n\n//\t\tLL tmp=gcd(ret.x,ret.y); ret.x/=tmp; ret.y/=tmp;\n\n//\t\treturn ret;\n\n//\t}\n\n//\tfriend Data operator*(const Data A,const Data B){\n\n//\t\tData ret; ret.x=A.x*B.x; ret.y=A.y*B.y;\n\n//\t\tLL tmp=gcd(ret.x,ret.y); ret.x/=tmp; ret.y/=tmp;\n\n//\t\treturn ret;\n\n//\t}\n\n//}ans;\n\n\n\ninline int fast_pow(int x,int y){\n\n\tint ret=1;\n\n\tfor(;y;y>>=1){\n\n\t\tif(y&1) ret=(LL)ret*x%MOD;\n\n\t\tx=(LL)x*x%MOD;\n\n\t}\n\n\treturn ret;\n\n}\n\n\n\ninline int C(int x,int y){\n\n\treturn (LL)fac[x]*inv[y]%MOD*inv[x-y]%MOD;\n\n}\n\n\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tif(n>m) swap(n,m); fac[0]=inv[0]=1;\n\n\tint i;\n\n\tfor(i=1;i<=n+m;i+=4){\n\n\t\tfac[i]=1ll*fac[i-1]*i%MOD;\n\n\t\tfac[i+1]=1ll*fac[i]*(i+1)%MOD;\n\n\t\tfac[i+2]=1ll*fac[i+1]*(i+2)%MOD;\n\n\t\tfac[i+3]=1ll*fac[i+2]*(i+3)%MOD;\n\n\t}\n\n\tfor(;i<=n+m;i++) fac[i]=fac[i-1]*i%MOD;\n\n\tinv[n+m]=fast_pow(fac[n+m],MOD-2);\n\n\tfor(int i=n+m-1;~i;i--) inv[i]=1ll*inv[i+1]*(i+1)%MOD;\n\n\tAns1=1ll*2*m*C(n+m,n)%MOD; Ans2=fast_pow(C(n+m,n)*2%MOD,MOD-2);\n\n\tfor(int i=1;i<=n;i++) {\n\n\t\tAns1=Ans1+1ll*C(n-i+m-i,n-i)*C(i+i,i)%MOD;\t\n\n\t\tAns1%=MOD;\n\n\t}\n\n\tprintf(\"%lld\\n\",1ll*Ans1*Ans2%MOD);\n\n//\tans=ans+Data(1,2)*Data(C(n-i+m-i,n-i)*C(i+i,i),C(n+m,n));\n\n//\tprintf(\"%lld\\n\",1ll*ans.x*fast_pow(ans.y,MOD-2)%MOD);\n\n\treturn 0;\t\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n\n\nconst int maxn = 1000005, P = 998244353;\n\nint n, m, fac[maxn], ifac[maxn];\n\n\n\nint power(int a, int x)\n\n{\n\n\tint ans = 1;\n\n\tfor (; x; x >>= 1, a = 1LL * a * a % P)\n\n\t\tif (x & 1)\n\n\t\t\tans = 1LL * ans * a % P;\n\n\treturn ans;\n\n}\n\nint binom(int n, int m)\n\n{\n\n\tif (n < m || m < 0)\n\n\t\treturn 0;\n\n\treturn 1LL * fac[n] * ifac[m] % P * ifac[n - m] % P;\n\n}\n\n\n\nint main()\n\n{\n\n\tscanf(\"%d%d\", &n, &m);\n\n\tif (n < m)\n\n\t\tstd::swap(n, m);\n\n\tfac[0] = 1;\n\n\tfor (int i = 1; i <= n + m; ++i)\n\n\t\tfac[i] = 1LL * fac[i - 1] * i % P;\n\n\tifac[n + m] = power(fac[n + m], P - 2);\n\n\tfor (int i = n + m; i; --i)\n\n\t\tifac[i - 1] = 1LL * ifac[i] * i % P;\n\n\tint ans = 0;\n\n\tfor (int i = 1; i <= m; ++i)\n\n\t\tans = (ans + 1LL * binom(2 * i, i) * binom(n + m - 2 * i, n - i)) % P;\n\n\tans = 1LL * ans * power(2 * binom(n + m, n) % P, P - 2) % P;\n\n\tans = (ans + n) % P;\n\n\tprintf(\"%d\\n\", ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "945",
        "source_code": "#include<bits/stdc++.h>\n\n#define N 1000005\n\n#define p 998244353\n\n#define int long long \n\nusing namespace std;\n\n\n\ninline void rd(int &x){\n\n\tx=0;char ch=0;int w=0;\n\n\twhile(!isdigit(ch)) ch=getchar(),w|=ch=='-';\n\n\twhile( isdigit(ch)) x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n\n\tx=w?-x:x;\n\n}\n\n\n\nint n,m,ans;\n\nint f[N],inv[N];\n\n\n\ninline int POW(int a,int b=p-2,int ans=1){\n\n\tfor(;b;b>>=1,a=a*a%p)\n\n\t\tif(b&1) ans=ans*a%p;\n\n\treturn ans;\n\n}\n\n\n\ninline int C(int n,int m){\n\n\treturn f[n]*inv[m]%p*inv[n-m]%p;\n\n}\n\nsigned main(){\n\n\tcin>>n>>m;if(n<m) swap(n,m);\n\n\tfor(int i=f[0]=inv[0]=1;i<=n+m;i++)\n\n\t\tf[i]=f[i-1]*i%p,inv[i]=POW(f[i]);\n\n\tfor(int i=1;i<=m;i++)\n\n\t\tans=(ans+C(i<<1,i)*C(n-i+m-i,n-i))%p;\n\n\tans=ans*inv[2]%p*POW(C(n+m,n))%p;\n\n\tcout<<(ans+n)%p;\n\n}",
        "optimized_code": "/*\n\nAT2705 Yes or No\n\nn\u4e3ayes\u7684\u9898\u6570\uff0cm\u4e3ano\u7684\u9898\u6570\n\n\u5f53n>m\u7684\u65f6\u5019\uff0c\u731cyes\n\n\u5f53n<m\u7684\u65f6\u5019\uff0c\u731cno\n\n\u8fd9\u6837\u731c\u4e00\u5b9a\u80fd\u4fdd\u8bc1\u731c\u5bf9max(n,m)\u6b21\n\n\u8003\u8651n=m\u65f6\u731c\u5bf9\u7684\u671f\u671b\n\n\u731c\u5bf9\u7684\u6982\u7387\uff08\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff09\u662fn/(n+m)=1/2\n\n\u8003\u8651\u8d70\u5230(i,i)\u8fd9\u4e2a\u70b9\u7684\u65b9\u6848\u6570\n\nC(2i,i)*(n-i+m-i,n-i)\n\n\u524d2i\u6b65\u94a6\u5b9ai\u6b65\u5411\u53f3\u8d70\uff08\u5269\u4f59i\u6b65\u5411\u4e0a\u8d70\uff09\n\n\u540en-i+m-i\u6b65\u94a6\u5b9an-i\u6b65\u5411\u53f3\u8d70\uff08\u5269\u4f59m-i\u6b65\u5411\u4e0a\u8d70\uff09\uff0c\u4ee5\u514d\u8d70\u51fa\u7f51\u683c\n\n\u6545\u8d70\u5230(i,i)\u7684\u6982\u7387\u662fsigma(C(2i,i)*(n-i+m-i,n-i))/C(n+m,n)\n\nC(n+m,n)\u662f\u603b\u65b9\u6848\u6570 \n\n\u5f53n=m\u65f6\u7684\u671f\u671b\u8d21\u732e\u662f(1/2)*sigma(C(2i,i)*(n-i+m-i,n-i))/C(n+m,n) i=1~min(n,m)\n\n*/ \n\n#include <cstdio>\n\ntypedef long long ll;\n\n#define ri register int\n\n#pragma GCC optimize(1)\n\n#pragma GCC optimize(2)\n\n#pragma GCC optimize(3)\n\n#pragma GCC optimize(\"Ofast\") \n\nconst int N=1000005,mod=998244353;\n\nint fac[N],inv[N];\n\ninline int C(ri n,ri m){\n\n\treturn (ll)fac[n]*inv[m]%mod*inv[n-m]%mod;\n\n}\n\ninline int max(ri x,ri y){\n\n\treturn x>y ? x:y;\n\n}\n\ninline int min(ri x,ri y){\n\n\treturn x<y ? x:y;\n\n}\n\ninline void add(int &x,ri y){\n\n\tx+=y;\n\n\tif(x>=mod) x-=mod;\n\n}\n\ninline int Pow(ri a,ri b){\n\n\tri ans=1;\n\n\tfor(;b;b>>=1,a=(ll)a*a%mod)\n\n\t\tif(b&1) ans=(ll)ans*a%mod;\n\n\treturn ans;\n\n}\n\nint main(){\n\n\tri n,m,i,sum,yes;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tsum=n+m;\n\n\tfac[0]=inv[0]=1;\n\n\tfor(i=1;i<=sum;++i) fac[i]=(ll)fac[i-1]*i%mod;\n\n\tinv[sum]=Pow(fac[sum],mod-2);\n\n\tfor(i=sum-1;i;--i) inv[i]=(ll)inv[i+1]*(i+1)%mod;\n\n\tyes=0;\n\n\tfor(i=min(n,m);i;--i) add(yes,(ll)C(2*i,i)*C(n-i+m-i,n-i)%mod);\n\n\tyes=(ll)yes*Pow(C(n+m,n),mod-2)%mod*inv[2]%mod;\n\n\tadd(yes,max(n,m));\n\n\tprintf(\"%d\\n\",yes);\n\n    return 0;\n\n}"
    },
    {
        "id": "946",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<cmath>\n\n\n\nusing namespace std;\n\nconst int N=1000005;\n\nconst int MOD=998244353;\n\ntypedef long long LL;\n\n\n\nint n,m,fac[N],inv[N];\n\nint Ans1,Ans2;\n\n\n\n//LL gcd(LL x,LL y) {\n\n//\tif(!y) return x;\n\n//\treturn gcd(y,x%y);\n\n//}\n\n//\n\n//struct Data{\n\n//\tLL x,y;\n\n//\tData(LL _x=0,LL _y=0) {x=_x; y=_y;}\n\n//\tfriend Data operator+(const Data A,const Data B){\n\n//\t\tData ret; ret.y=A.y*B.y; ret.x=A.x*B.y+A.y*B.x;\n\n//\t\tLL tmp=gcd(ret.x,ret.y); ret.x/=tmp; ret.y/=tmp;\n\n//\t\treturn ret;\n\n//\t}\n\n//\tfriend Data operator*(const Data A,const Data B){\n\n//\t\tData ret; ret.x=A.x*B.x; ret.y=A.y*B.y;\n\n//\t\tLL tmp=gcd(ret.x,ret.y); ret.x/=tmp; ret.y/=tmp;\n\n//\t\treturn ret;\n\n//\t}\n\n//}ans;\n\n\n\ninline int fast_pow(int x,int y){\n\n\tint ret=1;\n\n\tfor(;y;y>>=1){\n\n\t\tif(y&1) ret=(LL)ret*x%MOD;\n\n\t\tx=(LL)x*x%MOD;\n\n\t}\n\n\treturn ret;\n\n}\n\n\n\ninline int C(int x,int y){\n\n\treturn (LL)fac[x]*inv[y]%MOD*inv[x-y]%MOD;\n\n}\n\n\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tif(n>m) swap(n,m); fac[0]=inv[0]=1;\n\n\tint i;\n\n\tfor(i=1;i<=n+m;i+=4){\n\n\t\tfac[i]=1ll*fac[i-1]*i%MOD;\n\n\t\tfac[i+1]=1ll*fac[i]*(i+1)%MOD;\n\n\t\tfac[i+2]=1ll*fac[i+1]*(i+2)%MOD;\n\n\t\tfac[i+3]=1ll*fac[i+2]*(i+3)%MOD;\n\n\t}\n\n\tfor(;i<=n+m;i++) fac[i]=fac[i-1]*i%MOD;\n\n\tinv[n+m]=fast_pow(fac[n+m],MOD-2);\n\n\tfor(int i=n+m-1;~i;i--) inv[i]=1ll*inv[i+1]*(i+1)%MOD;\n\n\tAns1=1ll*2*m*C(n+m,n)%MOD; Ans2=fast_pow(C(n+m,n)*2%MOD,MOD-2);\n\n\tfor(int i=1;i<=n;i++) {\n\n\t\tAns1=Ans1+1ll*C(n-i+m-i,n-i)*C(i+i,i)%MOD;\t\n\n\t\tAns1%=MOD;\n\n\t}\n\n\tprintf(\"%lld\\n\",1ll*Ans1*Ans2%MOD);\n\n//\tans=ans+Data(1,2)*Data(C(n-i+m-i,n-i)*C(i+i,i),C(n+m,n));\n\n//\tprintf(\"%lld\\n\",1ll*ans.x*fast_pow(ans.y,MOD-2)%MOD);\n\n\treturn 0;\t\n\n}",
        "optimized_code": "/*\n\nAT2705 Yes or No\n\nn\u4e3ayes\u7684\u9898\u6570\uff0cm\u4e3ano\u7684\u9898\u6570\n\n\u5f53n>m\u7684\u65f6\u5019\uff0c\u731cyes\n\n\u5f53n<m\u7684\u65f6\u5019\uff0c\u731cno\n\n\u8fd9\u6837\u731c\u4e00\u5b9a\u80fd\u4fdd\u8bc1\u731c\u5bf9max(n,m)\u6b21\n\n\u8003\u8651n=m\u65f6\u731c\u5bf9\u7684\u671f\u671b\n\n\u731c\u5bf9\u7684\u6982\u7387\uff08\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff09\u662fn/(n+m)=1/2\n\n\u8003\u8651\u8d70\u5230(i,i)\u8fd9\u4e2a\u70b9\u7684\u65b9\u6848\u6570\n\nC(2i,i)*(n-i+m-i,n-i)\n\n\u524d2i\u6b65\u94a6\u5b9ai\u6b65\u5411\u53f3\u8d70\uff08\u5269\u4f59i\u6b65\u5411\u4e0a\u8d70\uff09\n\n\u540en-i+m-i\u6b65\u94a6\u5b9an-i\u6b65\u5411\u53f3\u8d70\uff08\u5269\u4f59m-i\u6b65\u5411\u4e0a\u8d70\uff09\uff0c\u4ee5\u514d\u8d70\u51fa\u7f51\u683c\n\n\u6545\u8d70\u5230(i,i)\u7684\u6982\u7387\u662fsigma(C(2i,i)*(n-i+m-i,n-i))/C(n+m,n)\n\nC(n+m,n)\u662f\u603b\u65b9\u6848\u6570 \n\n\u5f53n=m\u65f6\u7684\u671f\u671b\u8d21\u732e\u662f(1/2)*sigma(C(2i,i)*(n-i+m-i,n-i))/C(n+m,n) i=1~min(n,m)\n\n*/ \n\n#include <cstdio>\n\ntypedef long long ll;\n\n#define ri register int\n\n#pragma GCC optimize(1)\n\n#pragma GCC optimize(2)\n\n#pragma GCC optimize(3)\n\n#pragma GCC optimize(\"Ofast\") \n\nconst int N=1000005,mod=998244353;\n\nint fac[N],inv[N];\n\ninline int C(ri n,ri m){\n\n\treturn (ll)fac[n]*inv[m]%mod*inv[n-m]%mod;\n\n}\n\ninline int max(ri x,ri y){\n\n\treturn x>y ? x:y;\n\n}\n\ninline int min(ri x,ri y){\n\n\treturn x<y ? x:y;\n\n}\n\ninline void add(int &x,ri y){\n\n\tx+=y;\n\n\tif(x>=mod) x-=mod;\n\n}\n\ninline int Pow(ri a,ri b){\n\n\tri ans=1;\n\n\tfor(;b;b>>=1,a=(ll)a*a%mod)\n\n\t\tif(b&1) ans=(ll)ans*a%mod;\n\n\treturn ans;\n\n}\n\nint main(){\n\n\tri n,m,i,sum,yes;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tsum=n+m;\n\n\tfac[0]=inv[0]=1;\n\n\tfor(i=1;i<=sum;++i) fac[i]=(ll)fac[i-1]*i%mod;\n\n\tinv[sum]=Pow(fac[sum],mod-2);\n\n\tfor(i=sum-1;i;--i) inv[i]=(ll)inv[i+1]*(i+1)%mod;\n\n\tyes=0;\n\n\tfor(i=min(n,m);i;--i) add(yes,(ll)C(2*i,i)*C(n-i+m-i,n-i)%mod);\n\n\tyes=(ll)yes*Pow(C(n+m,n),mod-2)%mod*inv[2]%mod;\n\n\tadd(yes,max(n,m));\n\n\tprintf(\"%d\\n\",yes);\n\n    return 0;\n\n}"
    },
    {
        "id": "947",
        "source_code": "#pragma GCC optimize(\"Ofast\")\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define rep(i_, s_, t_) for (ll i_ = (s_); i_ <= (t_); ++i_)\n\n#define re(i_, s_, t_) for (ll i_ = (s_); i_ < (t_); ++i_)\n\n#define per(i_, s_, t_) for (ll i_ = (s_); i_ >= (t_); --i_)\n\ntypedef long long ll;\n\nconst ll P = 998244353, N = 1e6 + 5;\n\nll fac[N];\n\nll ans;\n\nll qpow(ll x, ll t = P - 2) {\n\n\tll res = 1;\n\n\tfor (; t; t >>= 1, x = 1LL * x * x % P)\n\n\t\tif (t & 1)\n\n\t\t\tres = 1LL * res * x % P;\n\n\treturn res;\n\n}\n\nll C(ll m, ll n) { return 1LL * fac[m] * qpow(fac[m - n]) % P * qpow(fac[n]) % P; }\n\nint main() {\n\n\tll n, m;\n\n\tscanf(\"%lld%lld\", &n, &m);\n\n\tif (n > m)\n\n\t\tswap(n, m);\n\n\tfac[0] = fac[1] = 1;\n\n\trep (i, 2, n + m)\n\n\t\tfac[i] = 1ll * fac[i - 1] * i % P;\n\n\trep (i, 1, n)\n\n\t\tans = (ans + C(n + m - 2 * i, n - i) * C(2 * i, i) % P) % P;\n\n\tans = ans * fac[n] % P * fac[m] % P * qpow(fac[n + m]) % P * qpow(2) % P;\n\n\tprintf(\"%lld\\n\", (m + ans) % P);\n\n\treturn 0;\n\n}",
        "optimized_code": "/*\n\nAT2705 Yes or No\n\nn\u4e3ayes\u7684\u9898\u6570\uff0cm\u4e3ano\u7684\u9898\u6570\n\n\u5f53n>m\u7684\u65f6\u5019\uff0c\u731cyes\n\n\u5f53n<m\u7684\u65f6\u5019\uff0c\u731cno\n\n\u8fd9\u6837\u731c\u4e00\u5b9a\u80fd\u4fdd\u8bc1\u731c\u5bf9max(n,m)\u6b21\n\n\u8003\u8651n=m\u65f6\u731c\u5bf9\u7684\u671f\u671b\n\n\u731c\u5bf9\u7684\u6982\u7387\uff08\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff09\u662fn/(n+m)=1/2\n\n\u8003\u8651\u8d70\u5230(i,i)\u8fd9\u4e2a\u70b9\u7684\u65b9\u6848\u6570\n\nC(2i,i)*(n-i+m-i,n-i)\n\n\u524d2i\u6b65\u94a6\u5b9ai\u6b65\u5411\u53f3\u8d70\uff08\u5269\u4f59i\u6b65\u5411\u4e0a\u8d70\uff09\n\n\u540en-i+m-i\u6b65\u94a6\u5b9an-i\u6b65\u5411\u53f3\u8d70\uff08\u5269\u4f59m-i\u6b65\u5411\u4e0a\u8d70\uff09\uff0c\u4ee5\u514d\u8d70\u51fa\u7f51\u683c\n\n\u6545\u8d70\u5230(i,i)\u7684\u6982\u7387\u662fsigma(C(2i,i)*(n-i+m-i,n-i))/C(n+m,n)\n\nC(n+m,n)\u662f\u603b\u65b9\u6848\u6570 \n\n\u5f53n=m\u65f6\u7684\u671f\u671b\u8d21\u732e\u662f(1/2)*sigma(C(2i,i)*(n-i+m-i,n-i))/C(n+m,n) i=1~min(n,m)\n\n*/ \n\n#include <cstdio>\n\ntypedef long long ll;\n\n#define ri register int\n\n#pragma GCC optimize(1)\n\n#pragma GCC optimize(2)\n\n#pragma GCC optimize(3)\n\n#pragma GCC optimize(\"Ofast\") \n\nconst int N=1000005,mod=998244353;\n\nint fac[N],inv[N];\n\ninline int C(ri n,ri m){\n\n\treturn (ll)fac[n]*inv[m]%mod*inv[n-m]%mod;\n\n}\n\ninline int max(ri x,ri y){\n\n\treturn x>y ? x:y;\n\n}\n\ninline int min(ri x,ri y){\n\n\treturn x<y ? x:y;\n\n}\n\ninline void add(int &x,ri y){\n\n\tx+=y;\n\n\tif(x>=mod) x-=mod;\n\n}\n\ninline int Pow(ri a,ri b){\n\n\tri ans=1;\n\n\tfor(;b;b>>=1,a=(ll)a*a%mod)\n\n\t\tif(b&1) ans=(ll)ans*a%mod;\n\n\treturn ans;\n\n}\n\nint main(){\n\n\tri n,m,i,sum,yes;\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tsum=n+m;\n\n\tfac[0]=inv[0]=1;\n\n\tfor(i=1;i<=sum;++i) fac[i]=(ll)fac[i-1]*i%mod;\n\n\tinv[sum]=Pow(fac[sum],mod-2);\n\n\tfor(i=sum-1;i;--i) inv[i]=(ll)inv[i+1]*(i+1)%mod;\n\n\tyes=0;\n\n\tfor(i=min(n,m);i;--i) add(yes,(ll)C(2*i,i)*C(n-i+m-i,n-i)%mod);\n\n\tyes=(ll)yes*Pow(C(n+m,n),mod-2)%mod*inv[2]%mod;\n\n\tadd(yes,max(n,m));\n\n\tprintf(\"%d\\n\",yes);\n\n    return 0;\n\n}"
    },
    {
        "id": "948",
        "source_code": "#include<bits/stdc++.h>\n\n#define N 1000005\n\n#define p 998244353\n\n#define int long long \n\nusing namespace std;\n\n\n\ninline void rd(int &x){\n\n\tx=0;char ch=0;int w=0;\n\n\twhile(!isdigit(ch)) ch=getchar(),w|=ch=='-';\n\n\twhile( isdigit(ch)) x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n\n\tx=w?-x:x;\n\n}\n\n\n\nint n,m,ans;\n\nint f[N],inv[N];\n\n\n\ninline int POW(int a,int b=p-2,int ans=1){\n\n\tfor(;b;b>>=1,a=a*a%p)\n\n\t\tif(b&1) ans=ans*a%p;\n\n\treturn ans;\n\n}\n\n\n\ninline int C(int n,int m){\n\n\treturn f[n]*inv[m]%p*inv[n-m]%p;\n\n}\n\nsigned main(){\n\n\tcin>>n>>m;if(n<m) swap(n,m);\n\n\tfor(int i=f[0]=inv[0]=1;i<=n+m;i++)\n\n\t\tf[i]=f[i-1]*i%p,inv[i]=POW(f[i]);\n\n\tfor(int i=1;i<=m;i++)\n\n\t\tans=(ans+C(i<<1,i)*C(n-i+m-i,n-i))%p;\n\n\tans=ans*inv[2]%p*POW(C(n+m,n))%p;\n\n\tcout<<(ans+n)%p;\n\n}",
        "optimized_code": "#include<cstdio>\n\n\n\nconst int mod=998244353,N=1000005;\n\n\n\nint fexp(int a,int b)\n\n{\n\n\tint x=1;\n\n\tfor(;b;b>>=1,a=1LL*a*a%mod)\n\n\t\tif(b&1)x=1LL*x*a%mod;\n\n\treturn x;\n\n}\n\n\n\nint n,m,ans,fac[N],ifac[N];\n\n\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tn+=m;\n\n\tfac[0]=1;\n\n\tfor(int i=1; i<=n; ++i)fac[i]=1LL*i*fac[i-1]%mod;\n\n\tifac[n]=fexp(fac[n],mod-2);\n\n\tfor(int i=n-1; ~i; --i)ifac[i]=1LL*(i+1)*ifac[i+1]%mod;\n\n\tn-=m;\n\n\tif(n<m){int k=n;n=m;m=k;}\n\n\tfor(int x=1; x<=m; ++x)\n\n\t\tans=(ans+1LL*fac[x+x]*ifac[x]%mod*ifac[x]%mod*fac[n-x+m-x]%mod*ifac[n-x]%mod*ifac[m-x])%mod;\n\n\tans=1LL*ans*ifac[2]%mod*ifac[n+m]%mod*fac[n]%mod*fac[m]%mod;\n\n\tprintf(\"%d\",(ans+n)%mod);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "949",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<cmath>\n\n\n\nusing namespace std;\n\nconst int N=1000005;\n\nconst int MOD=998244353;\n\ntypedef long long LL;\n\n\n\nint n,m,fac[N],inv[N];\n\nint Ans1,Ans2;\n\n\n\n//LL gcd(LL x,LL y) {\n\n//\tif(!y) return x;\n\n//\treturn gcd(y,x%y);\n\n//}\n\n//\n\n//struct Data{\n\n//\tLL x,y;\n\n//\tData(LL _x=0,LL _y=0) {x=_x; y=_y;}\n\n//\tfriend Data operator+(const Data A,const Data B){\n\n//\t\tData ret; ret.y=A.y*B.y; ret.x=A.x*B.y+A.y*B.x;\n\n//\t\tLL tmp=gcd(ret.x,ret.y); ret.x/=tmp; ret.y/=tmp;\n\n//\t\treturn ret;\n\n//\t}\n\n//\tfriend Data operator*(const Data A,const Data B){\n\n//\t\tData ret; ret.x=A.x*B.x; ret.y=A.y*B.y;\n\n//\t\tLL tmp=gcd(ret.x,ret.y); ret.x/=tmp; ret.y/=tmp;\n\n//\t\treturn ret;\n\n//\t}\n\n//}ans;\n\n\n\ninline int fast_pow(int x,int y){\n\n\tint ret=1;\n\n\tfor(;y;y>>=1){\n\n\t\tif(y&1) ret=(LL)ret*x%MOD;\n\n\t\tx=(LL)x*x%MOD;\n\n\t}\n\n\treturn ret;\n\n}\n\n\n\ninline int C(int x,int y){\n\n\treturn (LL)fac[x]*inv[y]%MOD*inv[x-y]%MOD;\n\n}\n\n\n\nint main(){\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tif(n>m) swap(n,m); fac[0]=inv[0]=1;\n\n\tint i;\n\n\tfor(i=1;i<=n+m;i+=4){\n\n\t\tfac[i]=1ll*fac[i-1]*i%MOD;\n\n\t\tfac[i+1]=1ll*fac[i]*(i+1)%MOD;\n\n\t\tfac[i+2]=1ll*fac[i+1]*(i+2)%MOD;\n\n\t\tfac[i+3]=1ll*fac[i+2]*(i+3)%MOD;\n\n\t}\n\n\tfor(;i<=n+m;i++) fac[i]=fac[i-1]*i%MOD;\n\n\tinv[n+m]=fast_pow(fac[n+m],MOD-2);\n\n\tfor(int i=n+m-1;~i;i--) inv[i]=1ll*inv[i+1]*(i+1)%MOD;\n\n\tAns1=1ll*2*m*C(n+m,n)%MOD; Ans2=fast_pow(C(n+m,n)*2%MOD,MOD-2);\n\n\tfor(int i=1;i<=n;i++) {\n\n\t\tAns1=Ans1+1ll*C(n-i+m-i,n-i)*C(i+i,i)%MOD;\t\n\n\t\tAns1%=MOD;\n\n\t}\n\n\tprintf(\"%lld\\n\",1ll*Ans1*Ans2%MOD);\n\n//\tans=ans+Data(1,2)*Data(C(n-i+m-i,n-i)*C(i+i,i),C(n+m,n));\n\n//\tprintf(\"%lld\\n\",1ll*ans.x*fast_pow(ans.y,MOD-2)%MOD);\n\n\treturn 0;\t\n\n}",
        "optimized_code": "#include<cstdio>\n\n\n\nconst int mod=998244353,N=1000005;\n\n\n\nint fexp(int a,int b)\n\n{\n\n\tint x=1;\n\n\tfor(;b;b>>=1,a=1LL*a*a%mod)\n\n\t\tif(b&1)x=1LL*x*a%mod;\n\n\treturn x;\n\n}\n\n\n\nint n,m,ans,fac[N],ifac[N];\n\n\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tn+=m;\n\n\tfac[0]=1;\n\n\tfor(int i=1; i<=n; ++i)fac[i]=1LL*i*fac[i-1]%mod;\n\n\tifac[n]=fexp(fac[n],mod-2);\n\n\tfor(int i=n-1; ~i; --i)ifac[i]=1LL*(i+1)*ifac[i+1]%mod;\n\n\tn-=m;\n\n\tif(n<m){int k=n;n=m;m=k;}\n\n\tfor(int x=1; x<=m; ++x)\n\n\t\tans=(ans+1LL*fac[x+x]*ifac[x]%mod*ifac[x]%mod*fac[n-x+m-x]%mod*ifac[n-x]%mod*ifac[m-x])%mod;\n\n\tans=1LL*ans*ifac[2]%mod*ifac[n+m]%mod*fac[n]%mod*fac[m]%mod;\n\n\tprintf(\"%d\",(ans+n)%mod);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "950",
        "source_code": "#pragma GCC optimize(\"Ofast\")\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define rep(i_, s_, t_) for (ll i_ = (s_); i_ <= (t_); ++i_)\n\n#define re(i_, s_, t_) for (ll i_ = (s_); i_ < (t_); ++i_)\n\n#define per(i_, s_, t_) for (ll i_ = (s_); i_ >= (t_); --i_)\n\ntypedef long long ll;\n\nconst ll P = 998244353, N = 1e6 + 5;\n\nll fac[N];\n\nll ans;\n\nll qpow(ll x, ll t = P - 2) {\n\n\tll res = 1;\n\n\tfor (; t; t >>= 1, x = 1LL * x * x % P)\n\n\t\tif (t & 1)\n\n\t\t\tres = 1LL * res * x % P;\n\n\treturn res;\n\n}\n\nll C(ll m, ll n) { return 1LL * fac[m] * qpow(fac[m - n]) % P * qpow(fac[n]) % P; }\n\nint main() {\n\n\tll n, m;\n\n\tscanf(\"%lld%lld\", &n, &m);\n\n\tif (n > m)\n\n\t\tswap(n, m);\n\n\tfac[0] = fac[1] = 1;\n\n\trep (i, 2, n + m)\n\n\t\tfac[i] = 1ll * fac[i - 1] * i % P;\n\n\trep (i, 1, n)\n\n\t\tans = (ans + C(n + m - 2 * i, n - i) * C(2 * i, i) % P) % P;\n\n\tans = ans * fac[n] % P * fac[m] % P * qpow(fac[n + m]) % P * qpow(2) % P;\n\n\tprintf(\"%lld\\n\", (m + ans) % P);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n\n\nconst int mod=998244353,N=1000005;\n\n\n\nint fexp(int a,int b)\n\n{\n\n\tint x=1;\n\n\tfor(;b;b>>=1,a=1LL*a*a%mod)\n\n\t\tif(b&1)x=1LL*x*a%mod;\n\n\treturn x;\n\n}\n\n\n\nint n,m,ans,fac[N],ifac[N];\n\n\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tn+=m;\n\n\tfac[0]=1;\n\n\tfor(int i=1; i<=n; ++i)fac[i]=1LL*i*fac[i-1]%mod;\n\n\tifac[n]=fexp(fac[n],mod-2);\n\n\tfor(int i=n-1; ~i; --i)ifac[i]=1LL*(i+1)*ifac[i+1]%mod;\n\n\tn-=m;\n\n\tif(n<m){int k=n;n=m;m=k;}\n\n\tfor(int x=1; x<=m; ++x)\n\n\t\tans=(ans+1LL*fac[x+x]*ifac[x]%mod*ifac[x]%mod*fac[n-x+m-x]%mod*ifac[n-x]%mod*ifac[m-x])%mod;\n\n\tans=1LL*ans*ifac[2]%mod*ifac[n+m]%mod*fac[n]%mod*fac[m]%mod;\n\n\tprintf(\"%d\",(ans+n)%mod);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "951",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cstring>\n\n#include<cmath>\n\n#include<algorithm>\n\n#include<vector>\n\n#include<set>\n\n#include<map>\n\n#include<unordered_map>\n\nusing namespace std;\n\n#define ri register int\n\n#define il inline\n\n#define pb emplace_back\n\n#define solid const auto &\n\n#define enter putchar('\\n')\n\n#define Size(x) ((int)x.size())\n\n#define mem(x,y) memset(x,y,sizeof(x))\n\n#define gm int mid((l+r)>>1)\n\n#define mp make_pair\n\n#define fi first\n\n#define se second\n\ntypedef long long LL;\n\ntypedef unsigned long long ull;\n\ntypedef pair<int,int> pii;\n\ntemplate<class T>il void in(T &x)\n\n{\n\n\tx=0; char c=getchar(); bool f=0;\n\n\twhile(!isdigit(c)) f|=(c=='-'),c=getchar();\n\n\twhile(isdigit(c)) x=x*10+(c^'0'),c=getchar();\n\n\tf?x=-x:0;\n\n}\n\ntemplate<class T>il void out(T x,const char c='\\n')\n\n{\n\n\tstatic short st[30]; short tp=0;\n\n\tif(x<0) putchar('-'),x=-x;\n\n\tdo st[++tp]=x%10,x/=10; while(x);\n\n\twhile(tp) putchar('0'|st[tp--]);\n\n\tputchar(c);\n\n}\n\ntemplate<class T>il void err(const T &x,const char c='\\n') {cerr<<x<<c;}\n\ntemplate<class T,class ...Args>il void err(const T &x,const Args &...args) {err(x,' '),err(args...);}\n\nconst int md=998244353;\n\nil int qpow(int a,int b) {int r=1; for(; b; b>>=1,a=(LL)a*a%md) if(b&1) r=(LL)r*a%md; return r;}\n\nil int fit(const int x) {return x>=md?x-md:x;}\n\nnamespace i207M\n\n{\n\nconst int N=1000005;\n\nint fac[N],ifac[N];\n\nvoid prework(int n)\n\n{\n\n\tfac[0]=1;\n\n\tfor(ri i=1;i<=n;++i) fac[i]=(LL)fac[i-1]*i%md;\n\n\tifac[n]=qpow(fac[n],md-2);\n\n\tfor(ri i=n;i>=1;--i) ifac[i-1]=(LL)ifac[i]*i%md;\n\n}\n\nil int C(int n,int m) {return (LL)fac[n]*ifac[m]%md*ifac[n-m]%md;}\n\nint n,m;\n\nsigned main()\n\n{\n\n#ifdef M207\n\n\tfreopen(\"in.in\",\"r\",stdin);\n\n#endif\n\n\tin(n),in(m);\n\n\tif(n>m) swap(n,m);\n\n\tprework(n+m);\n\n\tint ans=0;\n\n\tfor(ri i=1;i<=n;++i)\n\n\t\tans=(ans+(LL)C(2*i,i)*C(n-i+m-i,n-i))%md;\n\n\tans=(LL)ans*qpow(C(n+m,n),md-2)%md*(md+1)/2%md;\n\n\tans=fit(ans+m);\n\n\tout(ans);\n\n\treturn 0;\n\n}\n\n}\n\nsigned main()\n\n{\n\n\ti207M::main();\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n\n\nconst int mod=998244353,N=1000005;\n\n\n\nint fexp(int a,int b)\n\n{\n\n\tint x=1;\n\n\tfor(;b;b>>=1,a=1LL*a*a%mod)\n\n\t\tif(b&1)x=1LL*x*a%mod;\n\n\treturn x;\n\n}\n\n\n\nint n,m,ans,fac[N],ifac[N];\n\n\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tn+=m;\n\n\tfac[0]=1;\n\n\tfor(int i=1; i<=n; ++i)fac[i]=1LL*i*fac[i-1]%mod;\n\n\tifac[n]=fexp(fac[n],mod-2);\n\n\tfor(int i=n-1; ~i; --i)ifac[i]=1LL*(i+1)*ifac[i+1]%mod;\n\n\tn-=m;\n\n\tif(n<m){int k=n;n=m;m=k;}\n\n\tfor(int x=1; x<=m; ++x)\n\n\t\tans=(ans+1LL*fac[x+x]*ifac[x]%mod*ifac[x]%mod*fac[n-x+m-x]%mod*ifac[n-x]%mod*ifac[m-x])%mod;\n\n\tans=1LL*ans*ifac[2]%mod*ifac[n+m]%mod*fac[n]%mod*fac[m]%mod;\n\n\tprintf(\"%d\",(ans+n)%mod);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "952",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<cmath>\n\n#include<cstring>\n\nusing namespace std;\n\n#define MAXN 1000000\n\n#define MOD 998244353\n\n#define LL long long\n\nint n,m;\n\nint inv[MAXN+5],fac[MAXN+5];\n\nint ans;\n\nint fst_pow(int a,int b)\n\n{\n\n\tint res=1;\n\n\twhile(b)\n\n\t{\n\n\t\tif(b&1)res=(1LL*res*a)%MOD;\n\n\t\ta=(1LL*a*a)%MOD;\n\n\t\tb>>=1;\n\n\t}\n\n\treturn res;\n\n}\n\nvoid prepare()\n\n{\n\n\tfac[0]=1;\n\n\tfor(int i=1;i<=n+m;i++)\n\n\tfac[i]=(1LL*fac[i-1]*i)%MOD;\n\n\tinv[n+m]=fst_pow(fac[n+m],MOD-2);\n\n\tfor(int i=n+m-1;i>=0;i--)\n\n\tinv[i]=(1LL*inv[i+1]*(i+1))%MOD;\n\n}\n\nint Comb(int a,int b)\n\n{\n\n\treturn 1LL*(1LL*fac[a]*inv[a-b]%MOD)*inv[b]%MOD;\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tif(n<m)swap(n,m);\n\n\tprepare();\n\n\tfor(int i=1;i<=m;i++)\n\n\t\tans=(ans+1LL*Comb(2*i,i)*Comb(n+m-2*i,n-i)%MOD)%MOD;\n\n\tans=1LL*ans*fst_pow(Comb(m+n,n),MOD-2)%MOD;\n\n\tans=1LL*ans*fst_pow(2,MOD-2)%MOD;\n\n\tprintf(\"%d\",ans+n);\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<algorithm>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst int N=1000005,md=998244353;\n\nint n,m,ans;\n\nint nyc[N],fac[N],facn[N];\n\ninline int exgcd(int a,int b,int &x,int &y)\n\n{\n\n\tif(b==0)\n\n\t{\n\n\t\tx=1;\n\n\t\ty=0;\n\n\t\treturn a;\n\n\t}\n\n\tint t=exgcd(b,a%b,y,x);\n\n\ty-=a/b*x;\n\n\treturn t;\n\n}\n\ninline int inv(int a)\n\n{\n\n\tint x=0,y=0;\n\n\texgcd(a,md,x,y);\n\n\treturn (x+md)%md;\n\n}\n\ninline int C(int n,int m)\n\n{\n\n\treturn (ll)fac[n]*facn[m]%md*facn[n-m]%md;\n\n}\n\ninline int Cn(int n,int m)\n\n{\n\n\treturn (ll)facn[n]*fac[m]%md*fac[n-m]%md;\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tinv(1);\n\n\tnyc[1]=1;\n\n\tfac[0]=facn[0]=fac[1]=facn[1]=1;\n\n\tfor(int i=2;i<=n+m;i++)\n\n\t{\n\n\t\tnyc[i]=(ll)(md-md/i)*nyc[md%i]%md;\n\n\t\tfac[i]=(ll)fac[i-1]*i%md;\n\n\t\tfacn[i]=(ll)facn[i-1]*nyc[i]%md;\n\n\t}\n\n\tfor(int i=1;i<=n&&i<=m;i++)\n\n\t\tans=(ans+(ll)C(n+m-2*i,n-i)*C(2*i,i)%md)%md;\n\n\tans=(ll)ans*nyc[2]%md*Cn(n+m,n)%md;\n\n\tans=(ans+max(n,m))%md;\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n\n}\n"
    },
    {
        "id": "953",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<algorithm>\n\n#include<cmath>\n\n#include<cstring>\n\nusing namespace std;\n\n#define MAXN 1000000\n\n#define MOD 998244353\n\n#define LL long long\n\nint n,m;\n\nint inv[MAXN+5],fac[MAXN+5];\n\nint ans;\n\nint fst_pow(int a,int b)\n\n{\n\n\tint res=1;\n\n\twhile(b)\n\n\t{\n\n\t\tif(b&1)res=(1LL*res*a)%MOD;\n\n\t\ta=(1LL*a*a)%MOD;\n\n\t\tb>>=1;\n\n\t}\n\n\treturn res;\n\n}\n\nvoid prepare()\n\n{\n\n\tfac[0]=1;\n\n\tfor(int i=1;i<=n+m;i++)\n\n\tfac[i]=(1LL*fac[i-1]*i)%MOD;\n\n\tinv[n+m]=fst_pow(fac[n+m],MOD-2);\n\n\tfor(int i=n+m-1;i>=0;i--)\n\n\tinv[i]=(1LL*inv[i+1]*(i+1))%MOD;\n\n}\n\nint Comb(int a,int b)\n\n{\n\n\treturn 1LL*(1LL*fac[a]*inv[a-b]%MOD)*inv[b]%MOD;\n\n}\n\nint main()\n\n{\n\n\tscanf(\"%d%d\",&n,&m);\n\n\tif(n<m)swap(n,m);\n\n\tprepare();\n\n\tfor(int i=1;i<=m;i++)\n\n\t\tans=(ans+1LL*Comb(2*i,i)*Comb(n+m-2*i,n-i)%MOD)%MOD;\n\n\tans=1LL*ans*fst_pow(Comb(m+n,n),MOD-2)%MOD;\n\n\tans=1LL*ans*fst_pow(2,MOD-2)%MOD;\n\n\tprintf(\"%d\",ans+n);\n\n}\n",
        "optimized_code": "#if 0\n\ndate +%Y.%m.%d\n\n\n\n\u6734\u7d20 DP \u8bbe f[i][j] \u8868\u793a n, m \u5206\u522b\u4e3a i, j \u65f6\u7684\u7b54\u6848\u3002\n\n\u8003\u8651\u6bcf\u4e2a f[i][j] \u5bf9\u6700\u540e f[n][m] \u7684\u8d21\u732e\uff0c\n\n\u8bbe g[n][m] \u8868\u793a\u6240\u6709 i != j \u7684 f[i][j] \u5bf9 f[n][m] \u7684\u8d21\u732e\u548c\uff0c\n\n\u5047\u8bbe n > m \uff0c\u7531 f \u7684\u9012\u63a8\u5f0f\u53ef\u4ee5\u5f97\u51fa g[n][m] = g[n][m - 1] \uff0c\n\n\u8fdb\u4e00\u6b65\u7684\uff0cg[n][m] = max(n, m) \u3002\n\n\n\n\u90a3\u4e48\u73b0\u5728\u7684\u95ee\u9898\u662f\u8ba1\u7b97\u6bcf\u4e2a f[i][i] \u5bf9 f[n][m] \u7684\u8d21\u732e\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u6bcf\u6761\u8f6c\u79fb\u8def\u5f84\u4e0a\u7684 f[i][i] \u7684\u8d21\u732e\u662f 1 / 2 \uff0c\n\n\u90a3\u4e48 f[i][i] \u7684\u8d21\u732e\u5c31\u662f 1 / 2 \u4e58\u4e0a\u8f6c\u79fb\u5230 f[i][i] \u7684\u7cfb\u6570\uff0c\u5373\u6982\u7387\uff0c\n\n\u800c\u8fd9\u4e2a\u6982\u7387\u5c31\u662f\u7ecf\u8fc7 f[i][i] \u7684\u8f6c\u79fb\u4e0a\u7684\u8def\u5f84\u6570\u9664\u4ee5\u603b\u8def\u5f84\u6570\u3002\n\n#endif\n\n#include <cstdio>\n\n#include <algorithm>\n\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\n\n\ntypedef long long lolong;\n\ninline int input() { int x; scanf(\"%d\", &x); return x; }\n\n\n\nconst int maxn = 500005, mod = 998244353;\n\nlolong fac[maxn << 1];\n\n\n\ninline lolong power(lolong x, int k) {\n\n\tif(k < 0) k += mod - 1;\n\n\tlolong res = 1;\n\n\twhile(k) {\n\n\t\tif(k & 1) (res *= x) %= mod;\n\n\t\t(x *= x) %= mod;\n\n\t\tk >>= 1;\n\n\t}\n\n\treturn res;\n\n}\n\n\n\ninline lolong C(int n, int m) {\n\n\treturn fac[n] * power(fac[m], -1) % mod * power(fac[n - m], -1) % mod;\n\n}\n\n\n\nint main() {\n\n\tint n = input(), m = input();\n\n\tfac[0] = 1;\n\n\tfor(int i = 1; i <= n + m; i ++)\n\n\t\tfac[i] = fac[i - 1] * i % mod;\n\n\tlolong ans = 0;\n\n\tfor(int i = 1; i <= n and i <= m; i ++)\n\n\t\tdebug(\"%lld\\n\", ans),\n\n\t\tans += C(i << 1, i) * C(n + m - (i << 1), n - i) % mod;\n\n\tans %= mod;\n\n\t(ans *= power(2 * C(n + m, n) % mod, -1)) %= mod;\n\n\t ans += std::max(n, m);\n\n\tprintf(\"%lld\\n\", ans);\n\n}"
    },
    {
        "id": "954",
        "source_code": "#include <bits/stdc++.h>\n\n#define rep(i, j, k) for(int i = j; i <= k; ++i)\n\n#define dep(i, j, k) for(int i = j; i >= k; --i)\n\n#define inv(x) (ksm(x, P - 2))\n\n\n\nusing namespace std;\n\n\n\nconst int maxn = 1e6 + 5;\n\nconst int P = 998244353;\n\n\n\nint n, m, fac[maxn], ifac[maxn], ans;\n\n\n\ninline int read() {\n\n\tchar ch = getchar(); int u = 0, f = 1;\n\n\twhile(!isdigit(ch)) { if(ch == '-') f = -1; ch = getchar(); }\n\n\twhile(isdigit(ch))  { u = u * 10 + ch - 48; ch = getchar(); } return u * f;\n\n}\n\n\n\ninline int pls(int x, int y) { x += y; return x >= P ? x - P : x; }\n\ninline int dec(int x, int y) { x -= y; return x < 0 ? x + P : x; }\n\ninline int ksm(int x, int k, int rnt = 1) {\n\n\tfor(int i = k; i; i >>= 1, x = 1ll * x * x % P) if(i & 1) rnt = 1ll * rnt * x % P;\n\n\treturn rnt;\n\n}\n\n\n\nconst int inv2 = inv(2);\n\n\n\ninline int C(int n, int m) { return 1ll * fac[n] * ifac[n - m] % P * ifac[m] % P; }\n\n\n\nint main() {\n\n\tn = read(); m = read(); fac[0] = 1; int N = n + m;\n\n\tif(n < m) swap(n, m);\n\n\trep(i, 1, N) fac[i] = 1ll * fac[i - 1] * i % P;\n\n\tifac[N - 1] = inv(fac[N - 1]);\n\n\tdep(i, N - 2, 0) ifac[i] = 1ll * ifac[i + 1] * (i + 1) % P;\n\n\trep(i, 1, m) ans = pls(ans, 1ll * C(i + i, i) * C(N - 2 * i, n - i) % P);\n\n\tans = 1ll * ans * inv(2ll * C(N, n) % P) % P;\n\n\tcout << pls(ans, n) << endl;\n\n\treturn 0;\n\n}\n\n/*\n\n*/",
        "optimized_code": "#if 0\n\ndate +%Y.%m.%d\n\n\n\n\u6734\u7d20 DP \u8bbe f[i][j] \u8868\u793a n, m \u5206\u522b\u4e3a i, j \u65f6\u7684\u7b54\u6848\u3002\n\n\u8003\u8651\u6bcf\u4e2a f[i][j] \u5bf9\u6700\u540e f[n][m] \u7684\u8d21\u732e\uff0c\n\n\u8bbe g[n][m] \u8868\u793a\u6240\u6709 i != j \u7684 f[i][j] \u5bf9 f[n][m] \u7684\u8d21\u732e\u548c\uff0c\n\n\u5047\u8bbe n > m \uff0c\u7531 f \u7684\u9012\u63a8\u5f0f\u53ef\u4ee5\u5f97\u51fa g[n][m] = g[n][m - 1] \uff0c\n\n\u8fdb\u4e00\u6b65\u7684\uff0cg[n][m] = max(n, m) \u3002\n\n\n\n\u90a3\u4e48\u73b0\u5728\u7684\u95ee\u9898\u662f\u8ba1\u7b97\u6bcf\u4e2a f[i][i] \u5bf9 f[n][m] \u7684\u8d21\u732e\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u6bcf\u6761\u8f6c\u79fb\u8def\u5f84\u4e0a\u7684 f[i][i] \u7684\u8d21\u732e\u662f 1 / 2 \uff0c\n\n\u90a3\u4e48 f[i][i] \u7684\u8d21\u732e\u5c31\u662f 1 / 2 \u4e58\u4e0a\u8f6c\u79fb\u5230 f[i][i] \u7684\u7cfb\u6570\uff0c\u5373\u6982\u7387\uff0c\n\n\u800c\u8fd9\u4e2a\u6982\u7387\u5c31\u662f\u7ecf\u8fc7 f[i][i] \u7684\u8f6c\u79fb\u4e0a\u7684\u8def\u5f84\u6570\u9664\u4ee5\u603b\u8def\u5f84\u6570\u3002\n\n#endif\n\n#include <cstdio>\n\n#include <algorithm>\n\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\n\n\ntypedef long long lolong;\n\ninline int input() { int x; scanf(\"%d\", &x); return x; }\n\n\n\nconst int maxn = 500005, mod = 998244353;\n\nlolong fac[maxn << 1];\n\n\n\ninline lolong power(lolong x, int k) {\n\n\tif(k < 0) k += mod - 1;\n\n\tlolong res = 1;\n\n\twhile(k) {\n\n\t\tif(k & 1) (res *= x) %= mod;\n\n\t\t(x *= x) %= mod;\n\n\t\tk >>= 1;\n\n\t}\n\n\treturn res;\n\n}\n\n\n\ninline lolong C(int n, int m) {\n\n\treturn fac[n] * power(fac[m], -1) % mod * power(fac[n - m], -1) % mod;\n\n}\n\n\n\nint main() {\n\n\tint n = input(), m = input();\n\n\tfac[0] = 1;\n\n\tfor(int i = 1; i <= n + m; i ++)\n\n\t\tfac[i] = fac[i - 1] * i % mod;\n\n\tlolong ans = 0;\n\n\tfor(int i = 1; i <= n and i <= m; i ++)\n\n\t\tdebug(\"%lld\\n\", ans),\n\n\t\tans += C(i << 1, i) * C(n + m - (i << 1), n - i) % mod;\n\n\tans %= mod;\n\n\t(ans *= power(2 * C(n + m, n) % mod, -1)) %= mod;\n\n\t ans += std::max(n, m);\n\n\tprintf(\"%lld\\n\", ans);\n\n}"
    },
    {
        "id": "955",
        "source_code": "/* Your prologue will be the story. */\n\n/* Copyright by HenryLi */\n\n#include<iostream>\n\n#include<algorithm>\n\n#include<queue>\n\n#include<string>\n\n#include<map>\n\n#include<vector>\n\n#include<set>\n\n#include<sstream>\n\n#include<stack>\n\n#include<ctime>\n\n#include<cmath>\n\n#include<cctype>\n\n#include<climits>\n\n#include<cstring>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<iomanip>\n\n#include<bitset>\n\n#include<complex>\n\nusing namespace std;\n\ntemplate <class _T> inline void read(_T &_x) {\n\n\tint _t; bool _flag=false;\n\n\twhile((_t=getchar())!='-'&&(_t<'0'||_t>'9')) ;\n\n\tif(_t=='-') _flag=true,_t=getchar(); _x=_t-'0';\n\n\twhile((_t=getchar())>='0'&&_t<='9') _x=_x*10+_t-'0';\n\n\tif(_flag) _x=-_x;\n\n}\n\ntypedef long long LL;\n\nconst int maxn = 200010;\n\nint n, a[maxn];\n\nset<int> s;\n\nint main() {\n\n\t//freopen(\"C.in\",\"r\",stdin);\n\n\t//freopen(\"C.out\",\"w\",stdout);\n\n\tread(n);\n\n\tfor (int i = 1; i <= n; ++i) {\n\n\t\tread(a[i]);\n\n\t\tif (a[i] >= i || a[i] - a[i - 1] > 1) {\n\n\t\t\tputs(\"-1\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\tLL ans = 0;\n\n\tfor (int i = n; i >= 1; --i) {\n\n\t\tif (s.find(a[i] - i) != s.end()) continue;\n\n\t\ts.insert(a[i] - i);\n\n\t\tans += a[i];\n\n\t}\n\n\tcout << ans << endl;\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nint a[200005],n;\n\nlong long ans;\n\nint main()\n\n{\n\n\tscanf(\"%d\",&n);\n\n\tfor(int i=1;i<=n;++i)scanf(\"%d\",a+i);\n\n\tif(a[1]){puts(\"-1\");return 0;}\n\n\tfor(int i=2;i<=n;++i)if(a[i]<=a[i-1])ans+=a[i];\n\n\telse if(a[i]==a[i-1]+1)ans++;\n\n\telse {puts(\"-1\");return 0;}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "956",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint n,arr[200009];\n\n\n\nint main()\n\n{\n\n    scanf(\"%d\",&n);\n\n    for(int i=1;i<=n;i++)scanf(\"%d\",&arr[i]);\n\n    if(arr[1]>0)\n\n    {\n\n        printf(\"-1\\n\");\n\n        return 0;\n\n    }\n\n    long long ans=0;\n\n    for(int i=1;i<=n;i++)\n\n    {\n\n        if(arr[i]-arr[i-1]>1)\n\n        {\n\n            printf(\"-1\\n\");\n\n            return 0;\n\n        }\n\n        if(arr[i]-arr[i-1]==1)continue;\n\n        ans+=arr[i-1];\n\n    }\n\n    ans+=arr[n];\n\n    printf(\"%lld\\n\",ans);\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nint a[200005],n;\n\nlong long ans;\n\nint main()\n\n{\n\n\tscanf(\"%d\",&n);\n\n\tfor(int i=1;i<=n;++i)scanf(\"%d\",a+i);\n\n\tif(a[1]){puts(\"-1\");return 0;}\n\n\tfor(int i=2;i<=n;++i)if(a[i]<=a[i-1])ans+=a[i];\n\n\telse if(a[i]==a[i-1]+1)ans++;\n\n\telse {puts(\"-1\");return 0;}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "957",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ninline long long read(){\n\n\tlong long x=0,f=1;char ch=getchar();\n\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\n\treturn x*f;\n\n}\n\n#define MN 200005\n\nlong long n,a[MN];\n\nlong long ans;\n\nint main(){\n\n\tn=read();bool ok=0;\n\n\ta[1]=read();if(a[1]>0) ok=1;\n\n\tregister int i,j;\n\n\tfor(i=2;i<=n;i++){\n\n\t\ta[i]=read();\n\n\t\tif(a[i]-a[i-1]>1) ok=1;\n\n\t}\n\n\tif(ok){\n\n\t\tputs(\"-1\");\n\n\t\treturn 0;\n\n\t}\n\n\ti=j=2;\n\n\twhile(i<=n){\n\n\t\tfor(;a[j+1]==a[j]+1;j++);\n\n\t\tans+=a[j];i=j+1;j++;\n\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<cstdio>\n\nint n,a[200001];\n\nlong long ans=0;\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);\n\n\tif(a[1]!=0){\n\n\t\tputs(\"-1\");return 0;\n\n\t}\n\n\tfor(int i=1;i<n;i++){\n\n\t\tif(a[i+1]-a[i]>1){\n\n\t\t\tputs(\"-1\");return 0;\n\n\t\t}\n\n\t\tif(a[i+1]-a[i]==1) ans++;\n\n\t\telse ans+=1ll*a[i+1];\n\n\t}\n\n\tprintf(\"%lld\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "958",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ninline long long read(){\n\n\tlong long x=0,f=1;char ch=getchar();\n\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\n\treturn x*f;\n\n}\n\n#define MN 200005\n\nlong long n,a[MN];\n\nlong long ans;\n\nint main(){\n\n\tn=read();bool ok=0;\n\n\ta[1]=read();if(a[1]>0) ok=1;\n\n\tregister int i,j;\n\n\tfor(i=2;i<=n;i++){\n\n\t\ta[i]=read();\n\n\t\tif(a[i]-a[i-1]>1) ok=1;\n\n\t}\n\n\tif(ok){\n\n\t\tputs(\"-1\");\n\n\t\treturn 0;\n\n\t}\n\n\ti=j=2;\n\n\twhile(i<=n){\n\n\t\tfor(;a[j+1]==a[j]+1;j++);\n\n\t\tans+=a[j];i=j+1;j++;\n\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\n#include<algorithm>\n\n#define maxn 200005\n\n#define inf 0x3f3f3f3f\n\nusing namespace std;\n\ntypedef long int ll;\n\nint main()\n\n{\n\n    int n, t, x;\n\n    long long ans = 0;\n\n    scanf(\"%d %d\", &n, &t);\n\n    if (t) return 0 & puts(\"-1\");\n\n    while(--n){\n\n        scanf(\"%d\", &x);\n\n        if (x <= t) ans += x;\n\n        else if (x == t + 1) ++ans;\n\n        else return 0 & puts(\"-1\");\n\n        t = x;\n\n    }\n\n    printf(\"%lld\\n\", ans);\n\n    return 0;\n\n}\n"
    },
    {
        "id": "959",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ninline long long read(){\n\n\tlong long x=0,f=1;char ch=getchar();\n\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\n\treturn x*f;\n\n}\n\n#define MN 200005\n\nlong long n,a[MN];\n\nlong long ans;\n\nint main(){\n\n\tn=read();bool ok=0;\n\n\ta[1]=read();if(a[1]>0) ok=1;\n\n\tregister int i,j;\n\n\tfor(i=2;i<=n;i++){\n\n\t\ta[i]=read();\n\n\t\tif(a[i]-a[i-1]>1) ok=1;\n\n\t}\n\n\tif(ok){\n\n\t\tputs(\"-1\");\n\n\t\treturn 0;\n\n\t}\n\n\ti=j=2;\n\n\twhile(i<=n){\n\n\t\tfor(;a[j+1]==a[j]+1;j++);\n\n\t\tans+=a[j];i=j+1;j++;\n\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\n#include<algorithm>\n\n#define maxn 200005\n\n#define inf 0x3f3f3f3f\n\nusing namespace std;\n\ntypedef long int ll;\n\nint main()\n\n{\n\n    int n, t, x;\n\n    long long ans = 0;\n\n    scanf(\"%d %d\", &n, &t);\n\n    if (t) return 0 & puts(\"-1\");\n\n    while(--n){\n\n        scanf(\"%d\", &x);\n\n        if (x <= t) ans += x;\n\n        else if (x == t + 1) ++ans;\n\n        else return 0 & puts(\"-1\");\n\n        t = x;\n\n    }\n\n    printf(\"%lld\\n\", ans);\n\n    return 0;\n\n}\n"
    },
    {
        "id": "960",
        "source_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<cmath>\n\n#include<iostream>\n\n#include<cstdlib>\n\n#include<map>\n\n#include<stack>\n\n#include<algorithm>\n\nusing namespace std;\n\nconst int N = 300000;\n\n\n\nint main()\n\n{\n\n    int n,ch[N];\n\n    long long int ans=0;\n\n    scanf(\"%d\",&n);\n\n    for(int i=0;i<n;i++)\n\n        scanf(\"%d\",&ch[i]);\n\n    if(ch[0]!=0) {printf(\"-1\\n\");return 0;}\n\n    for(int i=1;i<n;i++)\n\n    {\n\n        if(ch[i]-ch[i-1]>=2) {printf(\"-1\\n\");return 0;}\n\n        else if(ch[i]-ch[i-1]==1) ans++;\n\n        else ans+=ch[i];\n\n    }\n\n    printf(\"%lld\\n\",ans);\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\n#include<algorithm>\n\n#define maxn 200005\n\n#define inf 0x3f3f3f3f\n\nusing namespace std;\n\ntypedef long int ll;\n\nint main()\n\n{\n\n    int n, t, x;\n\n    long long ans = 0;\n\n    scanf(\"%d %d\", &n, &t);\n\n    if (t) return 0 & puts(\"-1\");\n\n    while(--n){\n\n        scanf(\"%d\", &x);\n\n        if (x <= t) ans += x;\n\n        else if (x == t + 1) ++ans;\n\n        else return 0 & puts(\"-1\");\n\n        t = x;\n\n    }\n\n    printf(\"%lld\\n\", ans);\n\n    return 0;\n\n}\n"
    },
    {
        "id": "961",
        "source_code": "#include <iostream>\n\n#include <cstdio>\n\nusing namespace std;\n\nlong long n, s, mx, a[200005];\n\nint main() {\n\n\tlong long i;\n\n\tscanf(\"%lld\", &n);\n\n\tfor(i=1; i<=n; i++) scanf(\"%lld\", a+i);\n\n\tfor(i=n; i; i--) {\n\n\t\tmx = max(mx-1, a[i]);\n\n\t\tif(a[i]<mx) mx=i=1;\n\n\t\telse if(a[i] == a[i-1]+1) s++;\n\n\t\telse s += a[i];\n\n\t}\n\n\tprintf(\"%lld\", mx>0 ? -1 : s);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\nlong long n, s, a[200005];\n\nint main() {\n\n\tscanf(\"%lld%lld\", &n, a);\n\n\tif(a[0]>0) return !puts(\"-1\");\n\n\tfor(long long i=1; i<n; i++) {\n\n\t\tscanf(\"%lld\", a+i);\n\n\t\tif(a[i] - a[i-1] > 1) return !puts(\"-1\");\n\n\t\telse if(a[i] == a[i-1]+1) s++;\n\n\t\telse s += a[i];\n\n\t}\n\n\tprintf(\"%lld\", s);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "962",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\nint main(void){\n\n    long n;\n\n    cin >> n;\n\n    vector<long> a(n+1);\n\n    a[0] = -1;\n\n    for(long i=1; i<=n; i++){\n\n        cin >> a[i];\n\n    }\n\n    long count=-1;\n\n    for(long i=n; i>=1; i--){\n\n        long d = a[i]-a[i-1];\n\n        if(d>=2){\n\n            cout << -1 << endl;\n\n            return 0;\n\n        }else if(d<0){\n\n            count += a[i];\n\n        }else if(d==1){\n\n            count++;\n\n        }else{\n\n            count += a[i];\n\n        }\n\n    }\n\n    cout << count << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\n#define N 200000\n\n\n\nlong a[N+1];\n\n\n\nint main(void){\n\n    long n;\n\n    scanf(\"%ld\", &n);\n\n    a[0] = -1;\n\n    for(long i=1; i<=n; i++){\n\n        scanf(\"%ld\", a+i);\n\n    }\n\n    long count=-1;\n\n    for(long i=n; i>=1; i--){\n\n        long d = a[i]-a[i-1];\n\n        if(d>=2){\n\n            puts(\"-1\");\n\n            return 0;\n\n        }else if(d==1){\n\n            count++;\n\n        }else{\n\n            count += a[i];\n\n        }\n\n    }\n\n    printf(\"%ld\\n\", count);\n\n    return 0;\n\n}\n\n\n"
    },
    {
        "id": "963",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\nusing namespace std;\n\nint a[201000];long long ans=0;\n\nint main()\n\n{\n\n\tint n;scanf(\"%d\",&n);\n\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",&a[i]);\n\n\tif(a[1]!=0)return 0*puts(\"-1\");\n\n\tint now=0;\n\n\tfor(int i=n;i>=2;i--)\n\n\t{\n\n\t\tif(a[i]<now)return 0*puts(\"-1\");\n\n\t\telse if(a[i]==now){if(a[i]!=0)now--;}\n\n\t\telse now=a[i]-1,ans+=a[i];\n\n\t}\n\n\tif(now!=0)return 0*puts(\"-1\");\n\n\tprintf(\"%lld\",ans);return 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cctype>\n\n#include<cstring>\n\n#include<ctime>\n\n#include<cstdlib>\n\n#include<algorithm>\n\n#define max(a,b) (a>b?a:b)\n\n#define min(a,b) (a<b?a:b)\n\n#define reg register\n\ntypedef long long ll;\n\ntemplate<typename T>inline T read(){\n\n    reg T x=0;reg short f=1;reg char c=getchar();\n\n    for(;!isdigit(c);f=c=='-'?-1:1,c=getchar());\n\n    for(;isdigit(c);x=x*10+(c^48),c=getchar());\n\n    return x*f;\n\n}\n\nint n,a[200005]={-1};\n\nint main(){\n\n\tn=read<int>();reg ll ans=0;\n\n\tfor(reg int i=1;i<=n;i++)\n\n\t\tif((a[i]=read<int>())-a[i-1]>1)return 0*puts(\"-1\");\n\n\tfor(reg int i=2;i<=n;i++)\n\n\t\tif(a[i]>a[i-1])ans++;\n\n\t\telse ans+=a[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "964",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<cstdlib>\n\n#include<algorithm>\n\n#include<cmath>\n\n#define ll long long\n\nusing namespace std;\n\nint n,now;\n\nll ans=0;\n\nint a[200010];\n\nint main(){\n\n\tscanf(\"%d\",&n);\n\n\tint i,j;\n\n\tfor(i=1;i<=n;++i){\n\n\t\tscanf(\"%d\",&a[i]);\n\n\t}\n\n\tif(a[1]!=0){\n\n\t\tprintf(\"-1\\n\");return 0;\n\n\t}\n\n\tnow=0;\n\n\tfor(i=n;i>=1;--i){\n\n\t\tif(a[i]<now){\n\n\t\t\tprintf(\"-1\\n\");return 0;\n\n\t\t}\n\n\t\tif(a[i]>now){\n\n\t\t\tnow=a[i];ans=ans+(ll)a[i];\n\n\t\t}\n\n\t\tnow--;now=max(now,0);\n\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<cstdio>\n\n#include<cctype>\n\n#include<cstring>\n\n#include<ctime>\n\n#include<cstdlib>\n\n#include<algorithm>\n\n#define max(a,b) (a>b?a:b)\n\n#define min(a,b) (a<b?a:b)\n\n#define reg register\n\ntypedef long long ll;\n\ntemplate<typename T>inline T read(){\n\n    reg T x=0;reg short f=1;reg char c=getchar();\n\n    for(;!isdigit(c);f=c=='-'?-1:1,c=getchar());\n\n    for(;isdigit(c);x=x*10+(c^48),c=getchar());\n\n    return x*f;\n\n}\n\nint n,a[200005]={-1};\n\nint main(){\n\n\tn=read<int>();reg ll ans=0;\n\n\tfor(reg int i=1;i<=n;i++)\n\n\t\tif((a[i]=read<int>())-a[i-1]>1)return 0*puts(\"-1\");\n\n\tfor(reg int i=2;i<=n;i++)\n\n\t\tif(a[i]>a[i-1])ans++;\n\n\t\telse ans+=a[i];\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n\n}"
    },
    {
        "id": "965",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<cmath>\n\ntypedef long long ll;\n\nusing namespace std;\n\nll a[200000+50]={0};\n\nint main ()\n\n{\n\n\tll n,i;\n\n\tcin>>n;\n\n\tfor(i=0;i<n;i++)\n\n\t\tcin>>a[i];\n\n\tif(a[0]!=0)\n\n\t{\n\n\t\tcout<<\"-1\"<<endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor(i=1;i<n;i++)\n\n\t{\n\n\t\tif(a[i]-a[i-1]>1&&a[i]!=1)\n\n\t\t{\n\n\t\t\tcout<<\"-1\"<<endl;\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\tll ans=0;\n\n\tfor(i=1;i<n;i++)\n\n\t{\n\n\t\tif(a[i-1]<a[i])\n\n\t\t\tans+=1;\n\n\t\telse\n\n\t\t\tans+=a[i];\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n } ",
        "optimized_code": "#include <cstdio>\n\nusing namespace std;\n\nint v[200005];\n\nint main() {\n\n    int n;\n\n    scanf(\"%d\",&n);\n\n    bool f=true;\n\n    long long s=0;\n\n    for(int i=0;i<n;i++)\n\n        scanf(\"%d\",&v[i]);\n\n    for(int i=n;i--;)\n\n    {\n\n        if(v[i]>i||(i<n-1&&v[i]+1<v[i+1]))\n\n            f=false;\n\n        else if(i<n-1&&v[i]+1==v[i+1])continue;\n\n        else s+=v[i];\n\n    }\n\n    if(f)\n\n        printf(\"%lld\\n\",s);\n\n    else\n\n        printf(\"-1\\n\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "966",
        "source_code": "#include<cstdio>\n\n#include<cstdlib>\n\n#include<iostream>\n\n#include<queue>\n\n#include<string>\n\n#include<map>\n\n#include<vector>\n\n#include<algorithm>\n\n#include<cstring>\n\nusing namespace std ;\n\nconst int dx[]={1,-1,0,0},dy[]={0,0,1,-1};\n\nint n;\n\nlong long a[200000+5];\n\nint main()\n\n{\n\n    while(~scanf(\"%d\",&n))\n\n    {\n\n        bool flag=1;\n\n        long long sum=0;\n\n        for(int i=0;i<n;i++)\n\n        {\n\n            scanf(\"%lld\",&a[i]);\n\n        }\n\n        int x=-1;\n\n        for(int i=0;i<n;i++)\n\n        {\n\n            x++;\n\n            if(!flag) break;\n\n            if(a[i]>x) {flag=0;break;}\n\n            if(a[i])\n\n            {\n\n               if(a[i-1]>=a[i]) sum+=a[i];\n\n               else if(a[i]-a[i-1]==1) sum++;\n\n               else flag=0;\n\n            }\n\n            else\n\n            {\n\n                x=0;\n\n            }\n\n        }\n\n        printf(\"%lld\\n\",flag?sum:-1);\n\n\n\n    }\n\n\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\nusing namespace std;\n\nint v[200005];\n\nint main() {\n\n    int n;\n\n    scanf(\"%d\",&n);\n\n    bool f=true;\n\n    long long s=0;\n\n    for(int i=0;i<n;i++)\n\n        scanf(\"%d\",&v[i]);\n\n    for(int i=n;i--;)\n\n    {\n\n        if(v[i]>i||(i<n-1&&v[i]+1<v[i+1]))\n\n            f=false;\n\n        else if(i<n-1&&v[i]+1==v[i+1])continue;\n\n        else s+=v[i];\n\n    }\n\n    if(f)\n\n        printf(\"%lld\\n\",s);\n\n    else\n\n        printf(\"-1\\n\");\n\n    return 0;\n\n}\n"
    },
    {
        "id": "967",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<cmath>\n\ntypedef long long ll;\n\nusing namespace std;\n\nll a[200000+50]={0};\n\nint main ()\n\n{\n\n\tll n,i;\n\n\tcin>>n;\n\n\tfor(i=0;i<n;i++)\n\n\t\tcin>>a[i];\n\n\tif(a[0]!=0)\n\n\t{\n\n\t\tcout<<\"-1\"<<endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor(i=1;i<n;i++)\n\n\t{\n\n\t\tif(a[i]-a[i-1]>1&&a[i]!=1)\n\n\t\t{\n\n\t\t\tcout<<\"-1\"<<endl;\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\tll ans=0;\n\n\tfor(i=1;i<n;i++)\n\n\t{\n\n\t\tif(a[i-1]<a[i])\n\n\t\t\tans+=1;\n\n\t\telse\n\n\t\t\tans+=a[i];\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n } ",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\n#define R register\n\n#define MN 200005\n\ntypedef long long ll;\n\nnamespace IO{\n\n\tinline int read(){\n\n\t\tR int x; R bool f; R char c;\n\n\t\tfor (f=0; (c=getchar())<'0'||c>'9'; f=c=='-');\n\n\t\tfor (x=c^'0'; (c=getchar())>='0'&&c<='9'; x=(x<<1)+(x<<3)+(c^'0'));\n\n\t\treturn f?-x:x;\n\n\t}\n\n}\n\nnamespace sol{\n\n\tint n,v[MN]={-1};ll ans;\n\n\tvoid main(){\n\n\t\tn=IO::read();\n\n\t\tfor (R int i=1; i<=n; ++i)\n\n\t\t\tif (v[i-1]+1<(v[i]=IO::read())) return (void)(puts(\"-1\"));\n\n\t\tfor (R int i=1; i<=n; ++i)\n\n\t\t\tif (v[i]>=v[i+1]||i==n) ans+=v[i];\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t}\n\n}\n\nint main(){sol::main();return 0;}"
    },
    {
        "id": "968",
        "source_code": "#include<cstdio>\n\n#include<cstdlib>\n\n#include<iostream>\n\n#include<queue>\n\n#include<string>\n\n#include<map>\n\n#include<vector>\n\n#include<algorithm>\n\n#include<cstring>\n\nusing namespace std ;\n\nconst int dx[]={1,-1,0,0},dy[]={0,0,1,-1};\n\nint n;\n\nlong long a[200000+5];\n\nint main()\n\n{\n\n    while(~scanf(\"%d\",&n))\n\n    {\n\n        bool flag=1;\n\n        long long sum=0;\n\n        for(int i=0;i<n;i++)\n\n        {\n\n            scanf(\"%lld\",&a[i]);\n\n        }\n\n        int x=-1;\n\n        for(int i=0;i<n;i++)\n\n        {\n\n            x++;\n\n            if(!flag) break;\n\n            if(a[i]>x) {flag=0;break;}\n\n            if(a[i])\n\n            {\n\n               if(a[i-1]>=a[i]) sum+=a[i];\n\n               else if(a[i]-a[i-1]==1) sum++;\n\n               else flag=0;\n\n            }\n\n            else\n\n            {\n\n                x=0;\n\n            }\n\n        }\n\n        printf(\"%lld\\n\",flag?sum:-1);\n\n\n\n    }\n\n\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n#include <string.h>\n\n#define R register\n\n#define MN 200005\n\ntypedef long long ll;\n\nnamespace IO{\n\n\tinline int read(){\n\n\t\tR int x; R bool f; R char c;\n\n\t\tfor (f=0; (c=getchar())<'0'||c>'9'; f=c=='-');\n\n\t\tfor (x=c^'0'; (c=getchar())>='0'&&c<='9'; x=(x<<1)+(x<<3)+(c^'0'));\n\n\t\treturn f?-x:x;\n\n\t}\n\n}\n\nnamespace sol{\n\n\tint n,v[MN]={-1};ll ans;\n\n\tvoid main(){\n\n\t\tn=IO::read();\n\n\t\tfor (R int i=1; i<=n; ++i)\n\n\t\t\tif (v[i-1]+1<(v[i]=IO::read())) return (void)(puts(\"-1\"));\n\n\t\tfor (R int i=1; i<=n; ++i)\n\n\t\t\tif (v[i]>=v[i+1]||i==n) ans+=v[i];\n\n\t\tprintf(\"%lld\\n\",ans);\n\n\t}\n\n}\n\nint main(){sol::main();return 0;}"
    },
    {
        "id": "969",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<cmath>\n\ntypedef long long ll;\n\nusing namespace std;\n\nll a[200000+50]={0};\n\nint main ()\n\n{\n\n\tll n,i;\n\n\tcin>>n;\n\n\tfor(i=0;i<n;i++)\n\n\t\tcin>>a[i];\n\n\tif(a[0]!=0)\n\n\t{\n\n\t\tcout<<\"-1\"<<endl;\n\n\t\treturn 0;\n\n\t}\n\n\tfor(i=1;i<n;i++)\n\n\t{\n\n\t\tif(a[i]-a[i-1]>1&&a[i]!=1)\n\n\t\t{\n\n\t\t\tcout<<\"-1\"<<endl;\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\tll ans=0;\n\n\tfor(i=1;i<n;i++)\n\n\t{\n\n\t\tif(a[i-1]<a[i])\n\n\t\t\tans+=1;\n\n\t\telse\n\n\t\t\tans+=a[i];\n\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n\n } ",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <cstring>\n\n#define INF 0x3f3f3f3f\n\n#define LL long long\n\n#define MAX 100010\n\nusing namespace std;\n\nint a[200010];\n\nlong long sum=0;\n\nint main()\n\n{\n\n    int N;\n\n    scanf(\"%d\",&N);\n\n    for(int i=0; i<N; i++)\n\n        scanf(\"%d\",&a[i]);\n\n    if(a[0]!=0)\n\n    {\n\n        printf(\"-1\\n\");\n\n        return 0;\n\n    }\n\n    for(int i=1; i<N; i++)\n\n    {\n\n        if(a[i]-a[i-1]>1)\n\n        {\n\n            printf(\"-1\\n\");\n\n            return 0;\n\n        }\n\n        else if(a[i]-a[i-1]==1)\n\n            sum++;\n\n        else\n\n            sum+=a[i];\n\n    }\n\n    printf(\"%lld\\n\",sum);\n\n    return 0;\n\n}\n"
    },
    {
        "id": "970",
        "source_code": "#include<cstdio>\n\n#include<cstdlib>\n\n#include<iostream>\n\n#include<queue>\n\n#include<string>\n\n#include<map>\n\n#include<vector>\n\n#include<algorithm>\n\n#include<cstring>\n\nusing namespace std ;\n\nconst int dx[]={1,-1,0,0},dy[]={0,0,1,-1};\n\nint n;\n\nlong long a[200000+5];\n\nint main()\n\n{\n\n    while(~scanf(\"%d\",&n))\n\n    {\n\n        bool flag=1;\n\n        long long sum=0;\n\n        for(int i=0;i<n;i++)\n\n        {\n\n            scanf(\"%lld\",&a[i]);\n\n        }\n\n        int x=-1;\n\n        for(int i=0;i<n;i++)\n\n        {\n\n            x++;\n\n            if(!flag) break;\n\n            if(a[i]>x) {flag=0;break;}\n\n            if(a[i])\n\n            {\n\n               if(a[i-1]>=a[i]) sum+=a[i];\n\n               else if(a[i]-a[i-1]==1) sum++;\n\n               else flag=0;\n\n            }\n\n            else\n\n            {\n\n                x=0;\n\n            }\n\n        }\n\n        printf(\"%lld\\n\",flag?sum:-1);\n\n\n\n    }\n\n\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <cstring>\n\n#define INF 0x3f3f3f3f\n\n#define LL long long\n\n#define MAX 100010\n\nusing namespace std;\n\nint a[200010];\n\nlong long sum=0;\n\nint main()\n\n{\n\n    int N;\n\n    scanf(\"%d\",&N);\n\n    for(int i=0; i<N; i++)\n\n        scanf(\"%d\",&a[i]);\n\n    if(a[0]!=0)\n\n    {\n\n        printf(\"-1\\n\");\n\n        return 0;\n\n    }\n\n    for(int i=1; i<N; i++)\n\n    {\n\n        if(a[i]-a[i-1]>1)\n\n        {\n\n            printf(\"-1\\n\");\n\n            return 0;\n\n        }\n\n        else if(a[i]-a[i-1]==1)\n\n            sum++;\n\n        else\n\n            sum+=a[i];\n\n    }\n\n    printf(\"%lld\\n\",sum);\n\n    return 0;\n\n}\n"
    },
    {
        "id": "971",
        "source_code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,a,l;\n\nlong long ans;\n\ninline int read(){\n\n    int x=0,f=1;char ch=getchar();\n\n    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\n    while(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\n    return x*f;\n\n}\n\nint main(){\n\n\tn=read(),a=read();\n\n\tif(a>0){\n\n\t\tputs(\"-1\");\n\n\t\treturn 0;\n\n\t}\n\n\tl=a;\n\n\tfor(int i=2;i<=n;++i){\n\n\t\ta=read();\n\n\t\tif(a==l+1) ans++;\n\n\t\telse if(a<l+1) ans+=a;\n\n\t\telse{\n\n\t\t\tputs(\"-1\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tl=a;\n\n\t}\n\n\tprintf(\"%lld\",ans);\n\n}",
        "optimized_code": "#include <cstdio>\n\n#include <algorithm>\n\n#include <cstring>\n\n#define INF 0x3f3f3f3f\n\n#define LL long long\n\n#define MAX 100010\n\nusing namespace std;\n\nint a[200010];\n\nlong long sum=0;\n\nint main()\n\n{\n\n    int N;\n\n    scanf(\"%d\",&N);\n\n    for(int i=0; i<N; i++)\n\n        scanf(\"%d\",&a[i]);\n\n    if(a[0]!=0)\n\n    {\n\n        printf(\"-1\\n\");\n\n        return 0;\n\n    }\n\n    for(int i=1; i<N; i++)\n\n    {\n\n        if(a[i]-a[i-1]>1)\n\n        {\n\n            printf(\"-1\\n\");\n\n            return 0;\n\n        }\n\n        else if(a[i]-a[i-1]==1)\n\n            sum++;\n\n        else\n\n            sum+=a[i];\n\n    }\n\n    printf(\"%lld\\n\",sum);\n\n    return 0;\n\n}\n"
    },
    {
        "id": "972",
        "source_code": "\n\n\n\n#include<iostream>\n\nusing namespace std;\n\ntypedef long long ll;\n\nll a[200005];\n\nint main(){\n\n\tll n;while(cin>>n){\n\n\ta[0]=0;\n\n\tll sum=0;\n\n\tbool flag=true;\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tcin>>a[i];\n\n\t\tif(a[1]!=0||a[i]>a[i-1]+1){\n\n\t\t\t//cout<<\"-1\"<<endl;\n\n\t\t\tflag=false;//break;\n\n\t\t}\n\n\t\telse if(a[i-1]!=0&&a[i]==(a[i-1]+1)){\n\n\t\t\t\tsum+=1;//(a[i]-a[i-1]);\n\n\t\t\t\t}\n\n\t\telse sum+=a[i];}\n\n\t\tif(flag==true)\n\n\t\tcout<<sum<<endl;\n\n\telse cout<<\"-1\"<<endl;\n\n\t}\n\nreturn 0;}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#define MN 200005\n\n#define ll long long\n\nusing namespace std;\n\ninline int in(){\n\n    int x=0;bool f=0; char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\nll res;\n\nint a[MN],n;\n\nint main()\n\n{\n\n\tn=in();\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (a[i]-a[i-1]>=2||a[i]>=i) {printf(\"-1\");return 0;}\n\n\t\telse if (a[i]-a[i-1]==1) ++res;\n\n\t\telse res+=1ll*a[i];\n\n\t}printf(\"%lld\",res);return 0;\n\n}"
    },
    {
        "id": "973",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define mp make_pair\n\n#define pb push_back\n\n\n\ntypedef pair<int, int> ii;\n\ntypedef long long ll;\n\ntypedef pair<ll, ll> l4;\n\n\n\nconst int maxn = 2e5+1;\n\nint a[maxn], n;\n\ninline void end()\n\n{\n\n  puts(\"-1\");\n\n  exit(0);\n\n}\n\nint main()\n\n{\n\n  scanf(\"%d\", &n);\n\n  for (int i = 1; i <= n; ++i)\n\n    scanf(\"%d\", a+i);\n\n  if (a[1] != 0)\n\n    end();\n\n  for (int i = 1; i <= n-1; ++i)\n\n    if (a[i] < a[i+1]-1)\n\n      end();\n\n  deque<int> dq;\n\n  ll base = 0;\n\n  ll ans = 0;\n\n  for (int i = n; i >= 1; --i, --base)\n\n    {\n\n      while (!dq.empty() && dq.front()+base <= 0)\n\n        dq.pop_front();\n\n      if (a[i] == 0)\n\n        continue;\n\n      if (dq.empty() || dq.back()+base != a[i])\n\n        dq.push_back(a[i]-base);\n\n      ans += dq.size();\n\n    }\n\n  printf(\"%lld\\n\", ans);\n\n}\n",
        "optimized_code": "#include<cstdio>\n\n#include<cstring>\n\n#include<algorithm>\n\n#define MN 200005\n\n#define ll long long\n\nusing namespace std;\n\ninline int in(){\n\n    int x=0;bool f=0; char c;\n\n    for (;(c=getchar())<'0'||c>'9';f=c=='-');\n\n    for (x=c-'0';(c=getchar())>='0'&&c<='9';x=(x<<3)+(x<<1)+c-'0');\n\n    return f?-x:x;\n\n}\n\nll res;\n\nint a[MN],n;\n\nint main()\n\n{\n\n\tn=in();\n\n\tfor (int i=1;i<=n;++i) a[i]=in();\n\n\tfor (int i=1;i<=n;++i){\n\n\t\tif (a[i]-a[i-1]>=2||a[i]>=i) {printf(\"-1\");return 0;}\n\n\t\telse if (a[i]-a[i-1]==1) ++res;\n\n\t\telse res+=1ll*a[i];\n\n\t}printf(\"%lld\",res);return 0;\n\n}"
    },
    {
        "id": "974",
        "source_code": "\n\n\n\n#include<iostream>\n\nusing namespace std;\n\ntypedef long long ll;\n\nll a[200005];\n\nint main(){\n\n\tll n;while(cin>>n){\n\n\ta[0]=0;\n\n\tll sum=0;\n\n\tbool flag=true;\n\n\tfor(int i=1;i<=n;i++){\n\n\t\tcin>>a[i];\n\n\t\tif(a[1]!=0||a[i]>a[i-1]+1){\n\n\t\t\t//cout<<\"-1\"<<endl;\n\n\t\t\tflag=false;//break;\n\n\t\t}\n\n\t\telse if(a[i-1]!=0&&a[i]==(a[i-1]+1)){\n\n\t\t\t\tsum+=1;//(a[i]-a[i-1]);\n\n\t\t\t\t}\n\n\t\telse sum+=a[i];}\n\n\t\tif(flag==true)\n\n\t\tcout<<sum<<endl;\n\n\telse cout<<\"-1\"<<endl;\n\n\t}\n\nreturn 0;}\n",
        "optimized_code": "#include <cstdio>\n\n\n\nconst int maxn=200000;\n\n\n\nint read()\n\n{\n\n  int x=0,f=1;\n\n  char ch=getchar();\n\n  while((ch<'0')||(ch>'9'))\n\n    {\n\n      if(ch=='-')\n\n        {\n\n          f=-f;\n\n        }\n\n      ch=getchar();\n\n    }\n\n  while((ch>='0')&&(ch<='9'))\n\n    {\n\n      x=x*10+ch-'0';\n\n      ch=getchar();\n\n    }\n\n  return x*f;\n\n}\n\n\n\nint n,a[maxn+10];\n\nlong long ans;\n\n\n\nint main()\n\n{\n\n  n=read();\n\n  for(int i=1; i<=n; ++i)\n\n    {\n\n      a[i]=read();\n\n      if(a[i]>=i)\n\n        {\n\n          puts(\"-1\");\n\n          return 0;\n\n        }\n\n    }\n\n  for(int i=2; i<=n; ++i)\n\n    {\n\n      if(a[i]>a[i-1]+1)\n\n        {\n\n          puts(\"-1\");\n\n          return 0;\n\n        }\n\n      if(a[i]==a[i-1]+1)\n\n        {\n\n          ++ans;\n\n        }\n\n      else\n\n        {\n\n          ans+=a[i];\n\n        }\n\n    }\n\n  printf(\"%lld\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "975",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n\n\n#define mp make_pair\n\n#define pb push_back\n\n\n\ntypedef pair<int, int> ii;\n\ntypedef long long ll;\n\ntypedef pair<ll, ll> l4;\n\n\n\nconst int maxn = 2e5+1;\n\nint a[maxn], n;\n\ninline void end()\n\n{\n\n  puts(\"-1\");\n\n  exit(0);\n\n}\n\nint main()\n\n{\n\n  scanf(\"%d\", &n);\n\n  for (int i = 1; i <= n; ++i)\n\n    scanf(\"%d\", a+i);\n\n  if (a[1] != 0)\n\n    end();\n\n  for (int i = 1; i <= n-1; ++i)\n\n    if (a[i] < a[i+1]-1)\n\n      end();\n\n  deque<int> dq;\n\n  ll base = 0;\n\n  ll ans = 0;\n\n  for (int i = n; i >= 1; --i, --base)\n\n    {\n\n      while (!dq.empty() && dq.front()+base <= 0)\n\n        dq.pop_front();\n\n      if (a[i] == 0)\n\n        continue;\n\n      if (dq.empty() || dq.back()+base != a[i])\n\n        dq.push_back(a[i]-base);\n\n      ans += dq.size();\n\n    }\n\n  printf(\"%lld\\n\", ans);\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n\n\nconst int maxn=200000;\n\n\n\nint read()\n\n{\n\n  int x=0,f=1;\n\n  char ch=getchar();\n\n  while((ch<'0')||(ch>'9'))\n\n    {\n\n      if(ch=='-')\n\n        {\n\n          f=-f;\n\n        }\n\n      ch=getchar();\n\n    }\n\n  while((ch>='0')&&(ch<='9'))\n\n    {\n\n      x=x*10+ch-'0';\n\n      ch=getchar();\n\n    }\n\n  return x*f;\n\n}\n\n\n\nint n,a[maxn+10];\n\nlong long ans;\n\n\n\nint main()\n\n{\n\n  n=read();\n\n  for(int i=1; i<=n; ++i)\n\n    {\n\n      a[i]=read();\n\n      if(a[i]>=i)\n\n        {\n\n          puts(\"-1\");\n\n          return 0;\n\n        }\n\n    }\n\n  for(int i=2; i<=n; ++i)\n\n    {\n\n      if(a[i]>a[i-1]+1)\n\n        {\n\n          puts(\"-1\");\n\n          return 0;\n\n        }\n\n      if(a[i]==a[i-1]+1)\n\n        {\n\n          ++ans;\n\n        }\n\n      else\n\n        {\n\n          ans+=a[i];\n\n        }\n\n    }\n\n  printf(\"%lld\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "976",
        "source_code": "#include<bits/stdc++.h>\n\n#define fi first\n\n#define se second\n\n#define LL long long\n\n\n\nusing namespace std;\n\nconst int maxn = 2e5 + 5;\n\ntypedef pair<int, int> P;\n\n\n\nint a[maxn];\n\n\n\nint main() {\n\n#ifdef TT\n\n    freopen(\"xxx.in\", \"r\", stdin);\n\n#endif // TT\n\n    int n, i, x;\n\n    LL ans = 0;\n\n    scanf(\"%d\", &n);\n\n    for(i = 0;i < n; i++) scanf(\"%d\", &a[i]);\n\n    for(i = n - 1, x = 0;i >= 0; i--) {\n\n        if(a[i] > i || a[i] < x) return puts(\"-1\"), 0;\n\n        if(a[i] > x) {\n\n            ans += a[i];\n\n            x = a[i];\n\n        }\n\n        x = max(x - 1, 0);\n\n    }\n\n    cout << ans << endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <cstdio>\n\n\n\nconst int maxn=200000;\n\n\n\nint read()\n\n{\n\n  int x=0,f=1;\n\n  char ch=getchar();\n\n  while((ch<'0')||(ch>'9'))\n\n    {\n\n      if(ch=='-')\n\n        {\n\n          f=-f;\n\n        }\n\n      ch=getchar();\n\n    }\n\n  while((ch>='0')&&(ch<='9'))\n\n    {\n\n      x=x*10+ch-'0';\n\n      ch=getchar();\n\n    }\n\n  return x*f;\n\n}\n\n\n\nint n,a[maxn+10];\n\nlong long ans;\n\n\n\nint main()\n\n{\n\n  n=read();\n\n  for(int i=1; i<=n; ++i)\n\n    {\n\n      a[i]=read();\n\n      if(a[i]>=i)\n\n        {\n\n          puts(\"-1\");\n\n          return 0;\n\n        }\n\n    }\n\n  for(int i=2; i<=n; ++i)\n\n    {\n\n      if(a[i]>a[i-1]+1)\n\n        {\n\n          puts(\"-1\");\n\n          return 0;\n\n        }\n\n      if(a[i]==a[i-1]+1)\n\n        {\n\n          ++ans;\n\n        }\n\n      else\n\n        {\n\n          ans+=a[i];\n\n        }\n\n    }\n\n  printf(\"%lld\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "977",
        "source_code": "#include <bits/stdc++.h>\n\n#define ll long long\n\nusing namespace std;\n\nconst int N = 2e5 + 5;\n\nint a[N];\n\nvoid kill() {\n\n\tcout << \"-1\\n\";\n\n\texit(0);\n\n}\n\nint main() {\n\n\tios_base::sync_with_stdio(0);\n\n\tcin.tie(0);\n\n\tint n;\n\n\tcin >> n;\n\n\tfor (int i = 1; i <= n; i++)\n\n\t\tcin >> a[i];\n\n\ta[0] = -1;\n\n\tfor (int i = 1; i <= n; i++)\n\n\t\tif (a[i] - a[i - 1] > 1) kill();\n\n\tll ans = 0;\n\n\tfor (int i = 1; i <= n; i++) {\n\n\t\tif (!a[i]) continue;\n\n\t\tans++;\n\n\t\tif (a[i - 1] + 1 != a[i]) ans += a[i] - 1;\n\n\t}\n\n\tcout << ans << endl;\n\n\treturn 0;\n\n}\n\n\n",
        "optimized_code": "#include <cstdio>\n\n\n\nconst int maxn=200000;\n\n\n\nint read()\n\n{\n\n  int x=0,f=1;\n\n  char ch=getchar();\n\n  while((ch<'0')||(ch>'9'))\n\n    {\n\n      if(ch=='-')\n\n        {\n\n          f=-f;\n\n        }\n\n      ch=getchar();\n\n    }\n\n  while((ch>='0')&&(ch<='9'))\n\n    {\n\n      x=x*10+ch-'0';\n\n      ch=getchar();\n\n    }\n\n  return x*f;\n\n}\n\n\n\nint n,a[maxn+10];\n\nlong long ans;\n\n\n\nint main()\n\n{\n\n  n=read();\n\n  for(int i=1; i<=n; ++i)\n\n    {\n\n      a[i]=read();\n\n      if(a[i]>=i)\n\n        {\n\n          puts(\"-1\");\n\n          return 0;\n\n        }\n\n    }\n\n  for(int i=2; i<=n; ++i)\n\n    {\n\n      if(a[i]>a[i-1]+1)\n\n        {\n\n          puts(\"-1\");\n\n          return 0;\n\n        }\n\n      if(a[i]==a[i-1]+1)\n\n        {\n\n          ++ans;\n\n        }\n\n      else\n\n        {\n\n          ans+=a[i];\n\n        }\n\n    }\n\n  printf(\"%lld\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "978",
        "source_code": "#include <iostream>\n\n#include <string.h>\n\n\n\nusing namespace std;\n\n\n\nint N[210000];\n\nlong long ans,n;\n\n\n\nbool mtime()\n\n{\n\n    for(int i=1; i<n; i++)\n\n    {\n\n        if(N[i]-N[i-1]>1||N[i]>i)\n\n            return true;\n\n    }\n\n    return false;\n\n}\n\n\n\nint main()\n\n{\n\n    cin>>n;\n\n    for(int i=0; i<n; i++)\n\n    {\n\n        cin>>N[i];\n\n    }\n\n    if(N[0]!=0||mtime())\n\n    {\n\n        cout<<-1<<endl;\n\n        return 0;\n\n    }\n\n    ans=0;\n\n    ans+=N[n-1];\n\n    for(int i=n-2; i>0; i--)\n\n    {\n\n        if(N[i]-N[i+1]>-1)\n\n            ans+=N[i];\n\n    }\n\n    cout<<ans<<endl;\n\n    return 0;\n\n}",
        "optimized_code": "#include <cstdio>\n\n\n\nconst int maxn=200000;\n\n\n\nint read()\n\n{\n\n  int x=0,f=1;\n\n  char ch=getchar();\n\n  while((ch<'0')||(ch>'9'))\n\n    {\n\n      if(ch=='-')\n\n        {\n\n          f=-f;\n\n        }\n\n      ch=getchar();\n\n    }\n\n  while((ch>='0')&&(ch<='9'))\n\n    {\n\n      x=x*10+ch-'0';\n\n      ch=getchar();\n\n    }\n\n  return x*f;\n\n}\n\n\n\nint n,a[maxn+10];\n\nlong long ans;\n\n\n\nint main()\n\n{\n\n  n=read();\n\n  for(int i=1; i<=n; ++i)\n\n    {\n\n      a[i]=read();\n\n      if(a[i]>=i)\n\n        {\n\n          puts(\"-1\");\n\n          return 0;\n\n        }\n\n    }\n\n  for(int i=2; i<=n; ++i)\n\n    {\n\n      if(a[i]>a[i-1]+1)\n\n        {\n\n          puts(\"-1\");\n\n          return 0;\n\n        }\n\n      if(a[i]==a[i-1]+1)\n\n        {\n\n          ++ans;\n\n        }\n\n      else\n\n        {\n\n          ans+=a[i];\n\n        }\n\n    }\n\n  printf(\"%lld\\n\",ans);\n\n  return 0;\n\n}"
    },
    {
        "id": "979",
        "source_code": "#include<iostream>\n\n#include<sstream>\n\n#include<algorithm>\n\n#include<set>\n\n#include<map>\n\n#include<queue>\n\n#include<complex>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cstring>\n\n#include<cassert>\n\nusing namespace std;\n\n\n\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n\n#define each(i,c) for(__typeof(c.begin()) i=c.begin();i!=c.end();i++)\n\n#define pb push_back\n\n#define mp make_pair\n\n#define all(c) c.begin(),c.end()\n\n#define dbg(x) cerr<<__LINE__<<\": \"<<#x<<\" = \"<<(x)<<endl\n\n\n\ntypedef long long ll;\n\ntypedef vector<int> vi;\n\ntypedef pair<int,int> pi;\n\nconst int inf=(int)1e9;\n\nconst double EPS=1e-9, INF=1e12;\n\n\n\nconst int mod = (int)1e8 + 7;\n\nint h, w, pw[11];\n\nchar in[12][12];\n\nint dp[2][11][3][60000];\n\n\n\nint main(){\n\n\tpw[0] = 1;\n\n\trep(i, 10) pw[i + 1] = pw[i] * 3;\n\n\t\n\n\tcin >> h >> w;\n\n\trep(i, h) cin >> in[i];\n\n\t\n\n\tint cur = 0, next = 1;\n\n\tdp[0][0][0][0] = 1;\n\n\t\n\n\trep(i, h){\n\n\t\tmemset(dp[next], 0, sizeof(dp[next]));\n\n\t\trep(j, w){\n\n\t\t\trep(l, 3) rep(u, pw[w]) if(dp[cur][j][l][u]){\n\n\t\t\t\t\n\n\t\t\t\tint tu = u / pw[j] % 3;\n\n\t\t\t\t\n\n\t\t\t\tif(in[i][j] == '.'){\n\n\t\t\t\t\tif(tu && l) continue;\n\n\t\t\t\t\t(dp[cur][j + 1][l][u] += dp[cur][j][l][u]) %= mod;\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\tint rest = in[i][j] - '0' - tu - l;\n\n\t\t\t\trep(nl, 3){\n\n\t\t\t\t\tint nu = rest - nl;\n\n\t\t\t\t\tif(nu < 0 || nu > 2) continue;\n\n\t\t\t\t\t(dp[cur][j + 1][nl][u + pw[j] * (nu - tu)] += dp[cur][j][l][u]) %= mod;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\trep(u, pw[w]) dp[next][0][0][u] = dp[cur][w][0][u];\n\n\t\tswap(cur, next);\n\n\t}\n\n\tcout << dp[cur][0][0][0] << endl;\n\n\t\n\n\treturn 0;\n\n}",
        "optimized_code": "#include<iostream>\n\n#include<sstream>\n\n#include<algorithm>\n\n#include<set>\n\n#include<map>\n\n#include<queue>\n\n#include<complex>\n\n#include<cstdio>\n\n#include<cstdlib>\n\n#include<cstring>\n\n#include<cassert>\n\nusing namespace std;\n\n\n\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n\n#define each(i,c) for(__typeof(c.begin()) i=c.begin();i!=c.end();i++)\n\n#define pb push_back\n\n#define mp make_pair\n\n#define all(c) c.begin(),c.end()\n\n#define dbg(x) cerr<<__LINE__<<\": \"<<#x<<\" = \"<<(x)<<endl\n\n\n\ntypedef long long ll;\n\ntypedef vector<int> vi;\n\ntypedef pair<int,int> pi;\n\nconst int inf=(int)1e9;\n\nconst double EPS=1e-9, INF=1e12;\n\n\n\nconst int mod = (int)1e8 + 7;\n\nint h, w, pw[11];\n\nchar in[12][12];\n\nint dp[2][3][60000];\n\n\n\nint main(){\n\n\tpw[0] = 1;\n\n\trep(i, 10) pw[i + 1] = pw[i] * 3;\n\n\t\n\n\tcin >> h >> w;\n\n\trep(i, h) cin >> in[i];\n\n\t\n\n\tint cur = 0, next = 1;\n\n\tdp[0][0][0] = 1;\n\n\t\n\n\trep(i, h) rep(j, w){\n\n\t\tmemset(dp[next], 0, sizeof(dp[next]));\n\n\t\trep(l, 3) rep(u, pw[w]) if(dp[cur][l][u]){\n\n\t\t\t\n\n\t\t\tint tu = u / pw[j] % 3;\n\n\t\t\t\n\n\t\t\tif(in[i][j] == '.'){\n\n\t\t\t\tif(tu && l) continue;\n\n\t\t\t\tif(l == 0 || j < w - 1) (dp[next][l][u] += dp[cur][l][u]) %= mod;\n\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tint rest = in[i][j] - '0' - tu - l;\n\n\t\t\trep(nl, 3){\n\n\t\t\t\tint nu = rest - nl;\n\n\t\t\t\tif(nu < 0 || nu > 2) continue;\n\n\t\t\t\tif(nl == 0 || j < w - 1)\n\n\t\t\t\t\t(dp[next][nl][u + pw[j] * (nu - tu)] += dp[cur][l][u]) %= mod;\n\n\t\t\t}\n\n\t\t}\n\n\t\tswap(cur, next);\n\n\t}\n\n\tcout << dp[cur][0][0] << endl;\n\n\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "980",
        "source_code": "#include <cstdio>\n\n#include <queue>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <iostream>\n\n#include <set>\n\n#include <map>\n\n#include <string>\n\n#include <algorithm>\n\nusing namespace std;\n\n#include <string>\n\n#include <cstdio>\n\n#define ll long long\n\n#define TLE std::ios::sync_with_stdio(false);cin.tie(NULL);cout.tie(NULL);\n\ntypedef pair<int,int> pii;\n\nconst ll mod = 1000000007 ;\n\nconst int INF=0x3f3f3f3f;\n\n#define test(n) cout<<\"Test \"<<n<<endl;\n\n#define pb push_back\n\n#define rp(n) for(int i=1;i<=n;i++)\n\n#define rep(n,m) for(int i=1;i<=n;i++) for(int j=1;j<=m;j++)\n\nll ksm(ll x,ll n){ll ans=1;while (n){if (n&1)ans=(ans*x)%mod;x=x*x%mod;n>>=1;}return ans;}\n\nusing namespace std;\n\ndouble pi = atan(1.0)*4 ;\n\nconst int mxn = 1e3+7 ;\n\nint n,t,m,k,l,r;\n\n/// ll mat[mxn][mxn], prime[mxn], isprime[mxn];\n\nll phi[mxn];\n\nstring str;char ch[27][27] ;\n\nint a[mxn][mxn];\n\nll exgcd(ll a,ll b, ll &x ,ll &y)\n\n{\n\n    if(!a&&!b) return -1;/// \u65e0\u6700\u5927\u516c\u7ea6\u6570\n\n    if(!b) {x=1,y=0;return a;}\n\n    ll d=exgcd(b,a%b,y,x);\n\n    y-=a/b*x ;\n\n    return d;\n\n}\n\nint vis[mxn][mxn];\n\nint main()\n\n{\n\n\n\n    rep(3,3) vis[i][j] = 0 ;\n\n    map<int,pair<int,int> >mp;\n\n    rep(3,3) {cin>>a[i][j];mp[ a[i][j] ] = {i,j} ;}\n\n    cin>>n;\n\n    rp(n){ cin>>k;pair<int,int>tmp = mp[k];\n\n\n\n    if(mp.find(k)!=mp.end() && tmp.first<=3 && tmp.second<=3 && tmp.first>0 && tmp.second>0)\n\n        vis[ tmp.first ][ tmp.second ] = 1 ;\n\n    }\n\n    int f1 = 0 ;\n\n    for(int i=1;i<=3;i++)\n\n    {\n\n        int ans = 0 ;\n\n        for(int j=1;j<=3;j++)\n\n            if(vis[i][j]==1)\n\n                ans++;\n\n        if(ans==3) {cout<<\"Yes\"<<endl;f1=1;break;}\n\n    }\n\n    if(!f1)\n\n    {\n\n        if(vis[1][1]&&vis[2][2]&&vis[3][3] || vis[1][3]&&vis[2][2]&&vis[3][1])\n\n            {cout<<\"Yes\"<<endl;f1=1;}\n\n    }\n\n    if(!f1)\n\n    {\n\n        for(int i=1;i<=3;i++)\n\n        {\n\n            int ans = 0 ;\n\n            for(int j=1;j<=3;j++)\n\n                if(vis[j][i]==1)\n\n                    ans++;\n\n            if(ans==3) {cout<<\"Yes\"<<endl;f1=1;break;}\n\n        }\n\n    }\n\n    if(!f1) cout<<\"No\"<<endl;\n\n}\n\n\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\tint a[3][3], c[3][3]={0};\n\n\tfor(int i=0;i<3;i++){\n\n\t\tfor(int j=0;j<3;j++){\n\n\t\t\tscanf(\"%d\", &a[i][j]);\n\n\t\t}\n\n\t}\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\tint b[N];\n\n\tfor(int i=0;i<N;i++){\n\n\t\tscanf(\"%d\", &b[i]);\n\n\t}\n\n\tfor(int k=0;k<N;k++){\n\n\t\tfor(int i=0;i<3;i++){\n\n\t\t\tfor(int j=0;j<3;j++){\n\n\t\t\t\tif(a[i][j] == b[k]){\n\n\t\t\t\t\tc[i][j]++;\t\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfor(int i=0; i<N; i++){\n\n\t\tif(c[i][0]+c[i][1]+c[i][2] == 3){\n\n\t\t\tprintf(\"Yes\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tif(c[0][i]+c[1][i]+c[2][i] == 3){\n\n\t\t\tprintf(\"Yes\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\tif(c[0][0]+c[1][1]+c[2][2] == 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(c[2][0]+c[1][1]+c[0][2] == 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tprintf(\"No\\n\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "981",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<string>\n\n#include<algorithm>\n\n#include<queue>\n\n#include<stack>\n\n#include<vector>\n\n#include<set>\n\n#include<map>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint main()\n\n{\n\n    int s[5][5];\n\n    for(int i=1; i<=3; i++)\n\n    {\n\n        for(int j=1; j<=3; j++)\n\n        {\n\n            cin>>s[i][j];\n\n        }\n\n    }\n\n    int n;\n\n    int b[5][5]= {0};\n\n    cin>>n;\n\n    while(n--)\n\n    {\n\n        int x;\n\n        cin>>x;\n\n        for(int i=1; i<=3; i++)\n\n        {\n\n            int ff=0;\n\n            for(int j=1; j<=3; j++)\n\n            {\n\n                if(s[i][j]==x&&b[i][j]==0)\n\n                {\n\n                    b[i][j]=1;\n\n                    ff=1;\n\n                    break;\n\n                }\n\n            }\n\n            if(ff==1)\n\n                break;\n\n        }\n\n    }\n\n    int flag=0;\n\n    for(int i=1;i<=3;i++)\n\n    {\n\n        if(b[i][1]==1&&b[i][2]==1&&b[i][3]==1)\n\n        {flag=1;break;}\n\n        if(b[1][i]==1&&b[2][i]==1&&b[3][i]==1)\n\n        {flag=1;break;}\n\n    }\n\n    if(b[1][1]==1&&b[2][2]==1&&b[3][3]==1)\n\n        flag=1;\n\n    if(b[1][3]==1&&b[2][2]==1&&b[3][1]==1)\n\n        flag=1;\n\n    if(flag==1)\n\n        cout<<\"Yes\"<<endl;\n\n    else cout<<\"No\"<<endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\tint a[3][3], c[3][3]={0};\n\n\tfor(int i=0;i<3;i++){\n\n\t\tfor(int j=0;j<3;j++){\n\n\t\t\tscanf(\"%d\", &a[i][j]);\n\n\t\t}\n\n\t}\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\tint b[N];\n\n\tfor(int i=0;i<N;i++){\n\n\t\tscanf(\"%d\", &b[i]);\n\n\t}\n\n\tfor(int k=0;k<N;k++){\n\n\t\tfor(int i=0;i<3;i++){\n\n\t\t\tfor(int j=0;j<3;j++){\n\n\t\t\t\tif(a[i][j] == b[k]){\n\n\t\t\t\t\tc[i][j]++;\t\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfor(int i=0; i<N; i++){\n\n\t\tif(c[i][0]+c[i][1]+c[i][2] == 3){\n\n\t\t\tprintf(\"Yes\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tif(c[0][i]+c[1][i]+c[2][i] == 3){\n\n\t\t\tprintf(\"Yes\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\tif(c[0][0]+c[1][1]+c[2][2] == 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(c[2][0]+c[1][1]+c[0][2] == 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tprintf(\"No\\n\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "982",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\nusing namespace std;\n\nint a[5][5];\n\nint b[15];\n\nint ans=0,t=0,teil=0,head=0;\n\nint main()\n\n{\n\n\tint n;\n\n\tfor(int i=1;i<=3;i++)\n\n\t{\n\n\t\tfor(int j=1;j<=3;j++)\n\n\t\t{\n\n\t\t\tcin>>a[i][j];\n\n\t\t}\n\n\t}\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>b[i];\n\n\t}\n\n\tfor(int i=1;i<=3;i++)\n\n\t{\n\n\t\tans=0;\n\n\t\tt=0;\n\n\t\tfor(int j=1;j<=3;j++)\n\n\t\t{\n\n\t\t\tfor(int k=1;k<=n;k++)\n\n\t\t\t{\n\n\t\t\t\tif(a[i][j]==b[k])\n\n\t\t\t\t{\n\n\t\t\t\t\tans++;\n\n\t\t\t\t}\n\n\t\t\t\tif(a[j][i]==b[k])\n\n\t\t\t\t{\n\n\t\t\t\t\tt++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif(ans==3||t==3) break;\n\n\t}\n\n\tfor(int i=1;i<=3;i++)\n\n\t{\n\n\t\tfor(int j=1;j<=n;j++)\n\n\t\t{\n\n\t\t\tif(a[i][i]==b[j])\n\n\t\t\t{\n\n\t\t\t\tteil++;\n\n\t\t\t}\n\n\t\t\tif(a[4-i][i]==b[j])\n\n\t\t\t{\n\n\t\t\t\thead++;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tif(teil==3||head==3||ans==3||t==3) cout<<\"Yes\"<<endl;\n\n\telse cout<<\"No\"<<endl;\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\tint a[3][3], c[3][3]={0};\n\n\tfor(int i=0;i<3;i++){\n\n\t\tfor(int j=0;j<3;j++){\n\n\t\t\tscanf(\"%d\", &a[i][j]);\n\n\t\t}\n\n\t}\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\tint b[N];\n\n\tfor(int i=0;i<N;i++){\n\n\t\tscanf(\"%d\", &b[i]);\n\n\t}\n\n\tfor(int k=0;k<N;k++){\n\n\t\tfor(int i=0;i<3;i++){\n\n\t\t\tfor(int j=0;j<3;j++){\n\n\t\t\t\tif(a[i][j] == b[k]){\n\n\t\t\t\t\tc[i][j]++;\t\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfor(int i=0; i<N; i++){\n\n\t\tif(c[i][0]+c[i][1]+c[i][2] == 3){\n\n\t\t\tprintf(\"Yes\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tif(c[0][i]+c[1][i]+c[2][i] == 3){\n\n\t\t\tprintf(\"Yes\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\tif(c[0][0]+c[1][1]+c[2][2] == 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(c[2][0]+c[1][1]+c[0][2] == 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tprintf(\"No\\n\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "983",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\n    int arr[3][3];\n\n    for (int i=0;i<3;i++){\n\n        for (int j=0;j<3;j++){\n\n            cin>>arr[i][j];\n\n        }\n\n    }\n\n    int t,stop=0,win=0;\n\n    cin>>t;\n\n    for (int k=0;k<t;k++){\n\n        int b;\n\n        cin>>b;\n\n    for (int i=0;i<3;i++){\n\n        for (int j=0;j<3;j++){\n\n            if (arr[i][j]==b)\n\n                arr[i][j]=-1;\n\n            }\n\n        }\n\n    }\n\n        for (int i=0;i<3;i++){\n\n        if (arr[i][0]==arr[i][1] and arr[i][1]==arr[i][2] and arr[i][2]==-1)\n\n            win =1;\n\n        else if (arr[0][i]==arr[1][i] and arr[1][i]==arr[2][i] and arr[2][i]==-1)\n\n            win =1;\n\n     }\n\n    if (arr[0][0]==arr[1][1] and arr[1][1]==arr[2][2] and arr[2][2]==-1)\n\n            win=1;\n\n    if (arr[0][2]==arr[1][1] and arr[1][1]==arr[2][0] and arr[2][0]==-1)\n\n            win=1;\n\n    if (win){\n\n         cout<<\"Yes\";\n\n         return 0;\n\n    }\n\n    cout<<\"No\"<<endl;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\tint a[3][3], c[3][3]={0};\n\n\tfor(int i=0;i<3;i++){\n\n\t\tfor(int j=0;j<3;j++){\n\n\t\t\tscanf(\"%d\", &a[i][j]);\n\n\t\t}\n\n\t}\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\tint b[N];\n\n\tfor(int i=0;i<N;i++){\n\n\t\tscanf(\"%d\", &b[i]);\n\n\t}\n\n\tfor(int k=0;k<N;k++){\n\n\t\tfor(int i=0;i<3;i++){\n\n\t\t\tfor(int j=0;j<3;j++){\n\n\t\t\t\tif(a[i][j] == b[k]){\n\n\t\t\t\t\tc[i][j]++;\t\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfor(int i=0; i<N; i++){\n\n\t\tif(c[i][0]+c[i][1]+c[i][2] == 3){\n\n\t\t\tprintf(\"Yes\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tif(c[0][i]+c[1][i]+c[2][i] == 3){\n\n\t\t\tprintf(\"Yes\\n\");\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\tif(c[0][0]+c[1][1]+c[2][2] == 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tif(c[2][0]+c[1][1]+c[0][2] == 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}\n\n\tprintf(\"No\\n\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "984",
        "source_code": "#include <cstdio>\n\n#include <queue>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <iostream>\n\n#include <set>\n\n#include <map>\n\n#include <string>\n\n#include <algorithm>\n\nusing namespace std;\n\n#include <string>\n\n#include <cstdio>\n\n#define ll long long\n\n#define TLE std::ios::sync_with_stdio(false);cin.tie(NULL);cout.tie(NULL);\n\ntypedef pair<int,int> pii;\n\nconst ll mod = 1000000007 ;\n\nconst int INF=0x3f3f3f3f;\n\n#define test(n) cout<<\"Test \"<<n<<endl;\n\n#define pb push_back\n\n#define rp(n) for(int i=1;i<=n;i++)\n\n#define rep(n,m) for(int i=1;i<=n;i++) for(int j=1;j<=m;j++)\n\nll ksm(ll x,ll n){ll ans=1;while (n){if (n&1)ans=(ans*x)%mod;x=x*x%mod;n>>=1;}return ans;}\n\nusing namespace std;\n\ndouble pi = atan(1.0)*4 ;\n\nconst int mxn = 1e3+7 ;\n\nint n,t,m,k,l,r;\n\n/// ll mat[mxn][mxn], prime[mxn], isprime[mxn];\n\nll phi[mxn];\n\nstring str;char ch[27][27] ;\n\nint a[mxn][mxn];\n\nll exgcd(ll a,ll b, ll &x ,ll &y)\n\n{\n\n    if(!a&&!b) return -1;/// \u65e0\u6700\u5927\u516c\u7ea6\u6570\n\n    if(!b) {x=1,y=0;return a;}\n\n    ll d=exgcd(b,a%b,y,x);\n\n    y-=a/b*x ;\n\n    return d;\n\n}\n\nint vis[mxn][mxn];\n\nint main()\n\n{\n\n\n\n    rep(3,3) vis[i][j] = 0 ;\n\n    map<int,pair<int,int> >mp;\n\n    rep(3,3) {cin>>a[i][j];mp[ a[i][j] ] = {i,j} ;}\n\n    cin>>n;\n\n    rp(n){ cin>>k;pair<int,int>tmp = mp[k];\n\n\n\n    if(mp.find(k)!=mp.end() && tmp.first<=3 && tmp.second<=3 && tmp.first>0 && tmp.second>0)\n\n        vis[ tmp.first ][ tmp.second ] = 1 ;\n\n    }\n\n    int f1 = 0 ;\n\n    for(int i=1;i<=3;i++)\n\n    {\n\n        int ans = 0 ;\n\n        for(int j=1;j<=3;j++)\n\n            if(vis[i][j]==1)\n\n                ans++;\n\n        if(ans==3) {cout<<\"Yes\"<<endl;f1=1;break;}\n\n    }\n\n    if(!f1)\n\n    {\n\n        if(vis[1][1]&&vis[2][2]&&vis[3][3] || vis[1][3]&&vis[2][2]&&vis[3][1])\n\n            {cout<<\"Yes\"<<endl;f1=1;}\n\n    }\n\n    if(!f1)\n\n    {\n\n        for(int i=1;i<=3;i++)\n\n        {\n\n            int ans = 0 ;\n\n            for(int j=1;j<=3;j++)\n\n                if(vis[j][i]==1)\n\n                    ans++;\n\n            if(ans==3) {cout<<\"Yes\"<<endl;f1=1;break;}\n\n        }\n\n    }\n\n    if(!f1) cout<<\"No\"<<endl;\n\n}\n\n\n",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint na;\n\n\tint a[10];\n\n\tint angka[3][3];\n\n\tint tanda[3][3];\n\n\t\n\n\tfor(int i=0;i<3;i++){\n\n\t\tfor(int j=0;j<3;j++){\n\n\t\t\tscanf(\"%d\", &angka[i][j]);\n\n\t\t}\n\n\t}\n\n\tscanf(\"%d\", &na);\n\n\tfor(int c=0;c<na;c++){\n\n\t\tscanf(\"%d\", &a[c]);\n\n\tfor(int  l = 0 ; l < 3 ; l++ ) {\n\n        for(int k = 0 ; k < 3 ; k++ ){\n\n            if( a[c] == angka[l][k] ){\n\n                tanda[l][k] = 1;\n\n                }\n\n            }\n\n        }\n\n    }\n\n\n\n    if( (tanda[1][1] == 1 && tanda[2][2] == 1 && tanda[0][0] == 1  )\n\n    || (tanda[2][0] == 1 && tanda[1][1] == 1 && tanda[0][2] == 1  )\n\n    || (tanda[0][0] == 1 && tanda[0][1] == 1 && tanda[0][2] == 1  )\n\n    || (tanda[1][0] == 1 && tanda[1][1] == 1 && tanda[1][2] == 1  )\n\n    || (tanda[2][0] == 1 && tanda[2][1] == 1 && tanda[2][2] == 1  )\n\n    || (tanda[0][0] == 1 && tanda[1][0] == 1 && tanda[2][0] == 1  )\n\n    || (tanda[0][1] == 1 && tanda[1][1] == 1 && tanda[2][1] == 1  )\n\n    || (tanda[0][2] == 1 && tanda[1][2] == 1 && tanda[2][2] == 1  )\n\n    ) {\n\n        printf(\"Yes\\n\");\n\n    } else {\n\n        printf(\"No\\n\");\n\n    }\n\n\treturn 0;\n\n}"
    },
    {
        "id": "985",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<string>\n\n#include<algorithm>\n\n#include<queue>\n\n#include<stack>\n\n#include<vector>\n\n#include<set>\n\n#include<map>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint main()\n\n{\n\n    int s[5][5];\n\n    for(int i=1; i<=3; i++)\n\n    {\n\n        for(int j=1; j<=3; j++)\n\n        {\n\n            cin>>s[i][j];\n\n        }\n\n    }\n\n    int n;\n\n    int b[5][5]= {0};\n\n    cin>>n;\n\n    while(n--)\n\n    {\n\n        int x;\n\n        cin>>x;\n\n        for(int i=1; i<=3; i++)\n\n        {\n\n            int ff=0;\n\n            for(int j=1; j<=3; j++)\n\n            {\n\n                if(s[i][j]==x&&b[i][j]==0)\n\n                {\n\n                    b[i][j]=1;\n\n                    ff=1;\n\n                    break;\n\n                }\n\n            }\n\n            if(ff==1)\n\n                break;\n\n        }\n\n    }\n\n    int flag=0;\n\n    for(int i=1;i<=3;i++)\n\n    {\n\n        if(b[i][1]==1&&b[i][2]==1&&b[i][3]==1)\n\n        {flag=1;break;}\n\n        if(b[1][i]==1&&b[2][i]==1&&b[3][i]==1)\n\n        {flag=1;break;}\n\n    }\n\n    if(b[1][1]==1&&b[2][2]==1&&b[3][3]==1)\n\n        flag=1;\n\n    if(b[1][3]==1&&b[2][2]==1&&b[3][1]==1)\n\n        flag=1;\n\n    if(flag==1)\n\n        cout<<\"Yes\"<<endl;\n\n    else cout<<\"No\"<<endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint na;\n\n\tint a[10];\n\n\tint angka[3][3];\n\n\tint tanda[3][3];\n\n\t\n\n\tfor(int i=0;i<3;i++){\n\n\t\tfor(int j=0;j<3;j++){\n\n\t\t\tscanf(\"%d\", &angka[i][j]);\n\n\t\t}\n\n\t}\n\n\tscanf(\"%d\", &na);\n\n\tfor(int c=0;c<na;c++){\n\n\t\tscanf(\"%d\", &a[c]);\n\n\tfor(int  l = 0 ; l < 3 ; l++ ) {\n\n        for(int k = 0 ; k < 3 ; k++ ){\n\n            if( a[c] == angka[l][k] ){\n\n                tanda[l][k] = 1;\n\n                }\n\n            }\n\n        }\n\n    }\n\n\n\n    if( (tanda[1][1] == 1 && tanda[2][2] == 1 && tanda[0][0] == 1  )\n\n    || (tanda[2][0] == 1 && tanda[1][1] == 1 && tanda[0][2] == 1  )\n\n    || (tanda[0][0] == 1 && tanda[0][1] == 1 && tanda[0][2] == 1  )\n\n    || (tanda[1][0] == 1 && tanda[1][1] == 1 && tanda[1][2] == 1  )\n\n    || (tanda[2][0] == 1 && tanda[2][1] == 1 && tanda[2][2] == 1  )\n\n    || (tanda[0][0] == 1 && tanda[1][0] == 1 && tanda[2][0] == 1  )\n\n    || (tanda[0][1] == 1 && tanda[1][1] == 1 && tanda[2][1] == 1  )\n\n    || (tanda[0][2] == 1 && tanda[1][2] == 1 && tanda[2][2] == 1  )\n\n    ) {\n\n        printf(\"Yes\\n\");\n\n    } else {\n\n        printf(\"No\\n\");\n\n    }\n\n\treturn 0;\n\n}"
    },
    {
        "id": "986",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\nusing namespace std;\n\nint a[5][5];\n\nint b[15];\n\nint ans=0,t=0,teil=0,head=0;\n\nint main()\n\n{\n\n\tint n;\n\n\tfor(int i=1;i<=3;i++)\n\n\t{\n\n\t\tfor(int j=1;j<=3;j++)\n\n\t\t{\n\n\t\t\tcin>>a[i][j];\n\n\t\t}\n\n\t}\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>b[i];\n\n\t}\n\n\tfor(int i=1;i<=3;i++)\n\n\t{\n\n\t\tans=0;\n\n\t\tt=0;\n\n\t\tfor(int j=1;j<=3;j++)\n\n\t\t{\n\n\t\t\tfor(int k=1;k<=n;k++)\n\n\t\t\t{\n\n\t\t\t\tif(a[i][j]==b[k])\n\n\t\t\t\t{\n\n\t\t\t\t\tans++;\n\n\t\t\t\t}\n\n\t\t\t\tif(a[j][i]==b[k])\n\n\t\t\t\t{\n\n\t\t\t\t\tt++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif(ans==3||t==3) break;\n\n\t}\n\n\tfor(int i=1;i<=3;i++)\n\n\t{\n\n\t\tfor(int j=1;j<=n;j++)\n\n\t\t{\n\n\t\t\tif(a[i][i]==b[j])\n\n\t\t\t{\n\n\t\t\t\tteil++;\n\n\t\t\t}\n\n\t\t\tif(a[4-i][i]==b[j])\n\n\t\t\t{\n\n\t\t\t\thead++;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tif(teil==3||head==3||ans==3||t==3) cout<<\"Yes\"<<endl;\n\n\telse cout<<\"No\"<<endl;\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint na;\n\n\tint a[10];\n\n\tint angka[3][3];\n\n\tint tanda[3][3];\n\n\t\n\n\tfor(int i=0;i<3;i++){\n\n\t\tfor(int j=0;j<3;j++){\n\n\t\t\tscanf(\"%d\", &angka[i][j]);\n\n\t\t}\n\n\t}\n\n\tscanf(\"%d\", &na);\n\n\tfor(int c=0;c<na;c++){\n\n\t\tscanf(\"%d\", &a[c]);\n\n\tfor(int  l = 0 ; l < 3 ; l++ ) {\n\n        for(int k = 0 ; k < 3 ; k++ ){\n\n            if( a[c] == angka[l][k] ){\n\n                tanda[l][k] = 1;\n\n                }\n\n            }\n\n        }\n\n    }\n\n\n\n    if( (tanda[1][1] == 1 && tanda[2][2] == 1 && tanda[0][0] == 1  )\n\n    || (tanda[2][0] == 1 && tanda[1][1] == 1 && tanda[0][2] == 1  )\n\n    || (tanda[0][0] == 1 && tanda[0][1] == 1 && tanda[0][2] == 1  )\n\n    || (tanda[1][0] == 1 && tanda[1][1] == 1 && tanda[1][2] == 1  )\n\n    || (tanda[2][0] == 1 && tanda[2][1] == 1 && tanda[2][2] == 1  )\n\n    || (tanda[0][0] == 1 && tanda[1][0] == 1 && tanda[2][0] == 1  )\n\n    || (tanda[0][1] == 1 && tanda[1][1] == 1 && tanda[2][1] == 1  )\n\n    || (tanda[0][2] == 1 && tanda[1][2] == 1 && tanda[2][2] == 1  )\n\n    ) {\n\n        printf(\"Yes\\n\");\n\n    } else {\n\n        printf(\"No\\n\");\n\n    }\n\n\treturn 0;\n\n}"
    },
    {
        "id": "987",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\n    int arr[3][3];\n\n    for (int i=0;i<3;i++){\n\n        for (int j=0;j<3;j++){\n\n            cin>>arr[i][j];\n\n        }\n\n    }\n\n    int t,stop=0,win=0;\n\n    cin>>t;\n\n    for (int k=0;k<t;k++){\n\n        int b;\n\n        cin>>b;\n\n    for (int i=0;i<3;i++){\n\n        for (int j=0;j<3;j++){\n\n            if (arr[i][j]==b)\n\n                arr[i][j]=-1;\n\n            }\n\n        }\n\n    }\n\n        for (int i=0;i<3;i++){\n\n        if (arr[i][0]==arr[i][1] and arr[i][1]==arr[i][2] and arr[i][2]==-1)\n\n            win =1;\n\n        else if (arr[0][i]==arr[1][i] and arr[1][i]==arr[2][i] and arr[2][i]==-1)\n\n            win =1;\n\n     }\n\n    if (arr[0][0]==arr[1][1] and arr[1][1]==arr[2][2] and arr[2][2]==-1)\n\n            win=1;\n\n    if (arr[0][2]==arr[1][1] and arr[1][1]==arr[2][0] and arr[2][0]==-1)\n\n            win=1;\n\n    if (win){\n\n         cout<<\"Yes\";\n\n         return 0;\n\n    }\n\n    cout<<\"No\"<<endl;\n\n}",
        "optimized_code": "#include<stdio.h>\n\nint main(){\n\n\tint na;\n\n\tint a[10];\n\n\tint angka[3][3];\n\n\tint tanda[3][3];\n\n\t\n\n\tfor(int i=0;i<3;i++){\n\n\t\tfor(int j=0;j<3;j++){\n\n\t\t\tscanf(\"%d\", &angka[i][j]);\n\n\t\t}\n\n\t}\n\n\tscanf(\"%d\", &na);\n\n\tfor(int c=0;c<na;c++){\n\n\t\tscanf(\"%d\", &a[c]);\n\n\tfor(int  l = 0 ; l < 3 ; l++ ) {\n\n        for(int k = 0 ; k < 3 ; k++ ){\n\n            if( a[c] == angka[l][k] ){\n\n                tanda[l][k] = 1;\n\n                }\n\n            }\n\n        }\n\n    }\n\n\n\n    if( (tanda[1][1] == 1 && tanda[2][2] == 1 && tanda[0][0] == 1  )\n\n    || (tanda[2][0] == 1 && tanda[1][1] == 1 && tanda[0][2] == 1  )\n\n    || (tanda[0][0] == 1 && tanda[0][1] == 1 && tanda[0][2] == 1  )\n\n    || (tanda[1][0] == 1 && tanda[1][1] == 1 && tanda[1][2] == 1  )\n\n    || (tanda[2][0] == 1 && tanda[2][1] == 1 && tanda[2][2] == 1  )\n\n    || (tanda[0][0] == 1 && tanda[1][0] == 1 && tanda[2][0] == 1  )\n\n    || (tanda[0][1] == 1 && tanda[1][1] == 1 && tanda[2][1] == 1  )\n\n    || (tanda[0][2] == 1 && tanda[1][2] == 1 && tanda[2][2] == 1  )\n\n    ) {\n\n        printf(\"Yes\\n\");\n\n    } else {\n\n        printf(\"No\\n\");\n\n    }\n\n\treturn 0;\n\n}"
    },
    {
        "id": "988",
        "source_code": "#include <cstdio>\n\n#include <queue>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <iostream>\n\n#include <set>\n\n#include <map>\n\n#include <string>\n\n#include <algorithm>\n\nusing namespace std;\n\n#include <string>\n\n#include <cstdio>\n\n#define ll long long\n\n#define TLE std::ios::sync_with_stdio(false);cin.tie(NULL);cout.tie(NULL);\n\ntypedef pair<int,int> pii;\n\nconst ll mod = 1000000007 ;\n\nconst int INF=0x3f3f3f3f;\n\n#define test(n) cout<<\"Test \"<<n<<endl;\n\n#define pb push_back\n\n#define rp(n) for(int i=1;i<=n;i++)\n\n#define rep(n,m) for(int i=1;i<=n;i++) for(int j=1;j<=m;j++)\n\nll ksm(ll x,ll n){ll ans=1;while (n){if (n&1)ans=(ans*x)%mod;x=x*x%mod;n>>=1;}return ans;}\n\nusing namespace std;\n\ndouble pi = atan(1.0)*4 ;\n\nconst int mxn = 1e3+7 ;\n\nint n,t,m,k,l,r;\n\n/// ll mat[mxn][mxn], prime[mxn], isprime[mxn];\n\nll phi[mxn];\n\nstring str;char ch[27][27] ;\n\nint a[mxn][mxn];\n\nll exgcd(ll a,ll b, ll &x ,ll &y)\n\n{\n\n    if(!a&&!b) return -1;/// \u65e0\u6700\u5927\u516c\u7ea6\u6570\n\n    if(!b) {x=1,y=0;return a;}\n\n    ll d=exgcd(b,a%b,y,x);\n\n    y-=a/b*x ;\n\n    return d;\n\n}\n\nint vis[mxn][mxn];\n\nint main()\n\n{\n\n\n\n    rep(3,3) vis[i][j] = 0 ;\n\n    map<int,pair<int,int> >mp;\n\n    rep(3,3) {cin>>a[i][j];mp[ a[i][j] ] = {i,j} ;}\n\n    cin>>n;\n\n    rp(n){ cin>>k;pair<int,int>tmp = mp[k];\n\n\n\n    if(mp.find(k)!=mp.end() && tmp.first<=3 && tmp.second<=3 && tmp.first>0 && tmp.second>0)\n\n        vis[ tmp.first ][ tmp.second ] = 1 ;\n\n    }\n\n    int f1 = 0 ;\n\n    for(int i=1;i<=3;i++)\n\n    {\n\n        int ans = 0 ;\n\n        for(int j=1;j<=3;j++)\n\n            if(vis[i][j]==1)\n\n                ans++;\n\n        if(ans==3) {cout<<\"Yes\"<<endl;f1=1;break;}\n\n    }\n\n    if(!f1)\n\n    {\n\n        if(vis[1][1]&&vis[2][2]&&vis[3][3] || vis[1][3]&&vis[2][2]&&vis[3][1])\n\n            {cout<<\"Yes\"<<endl;f1=1;}\n\n    }\n\n    if(!f1)\n\n    {\n\n        for(int i=1;i<=3;i++)\n\n        {\n\n            int ans = 0 ;\n\n            for(int j=1;j<=3;j++)\n\n                if(vis[j][i]==1)\n\n                    ans++;\n\n            if(ans==3) {cout<<\"Yes\"<<endl;f1=1;break;}\n\n        }\n\n    }\n\n    if(!f1) cout<<\"No\"<<endl;\n\n}\n\n\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint matrix[3][3];\n\n\tint bingo [3][3] = {0};\n\n\t\n\n\tfor(int i=0; i<3; i++){\n\n\t\tfor(int j=0; j<3; j++){\n\n\t\t\tscanf(\"%d\", &matrix[i][j]);\n\n\t\t}\n\n\t}\n\n\t\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\t\n\n\tfor(int k=0; k<N; k++){\n\n\t\tint a;\n\n\t\tscanf(\"%d\", &a);\n\n\t\tfor(int i= 0; i<3; i++){\n\n\t\t\tfor(int j = 0; j<3; j++){\n\n\t\t\t\tif(matrix[i][j] == a){\n\n\t\t\t\t\tbingo[i][j] = 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t\n\n\tif(bingo[0][0] + bingo[1][1] + bingo[2][2] == 3 || bingo[0][2] +bingo[1][1] +bingo[2][0] == 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}for(int i = 0; i < 3;i++){\n\n\tif(bingo[i][0]+bingo[i][1]+bingo[i][2]==3||bingo[0][i]+bingo[1][i]+bingo[2][i]== 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}\n\n}\n\nprintf(\"No\\n\");\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "989",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<string>\n\n#include<algorithm>\n\n#include<queue>\n\n#include<stack>\n\n#include<vector>\n\n#include<set>\n\n#include<map>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint main()\n\n{\n\n    int s[5][5];\n\n    for(int i=1; i<=3; i++)\n\n    {\n\n        for(int j=1; j<=3; j++)\n\n        {\n\n            cin>>s[i][j];\n\n        }\n\n    }\n\n    int n;\n\n    int b[5][5]= {0};\n\n    cin>>n;\n\n    while(n--)\n\n    {\n\n        int x;\n\n        cin>>x;\n\n        for(int i=1; i<=3; i++)\n\n        {\n\n            int ff=0;\n\n            for(int j=1; j<=3; j++)\n\n            {\n\n                if(s[i][j]==x&&b[i][j]==0)\n\n                {\n\n                    b[i][j]=1;\n\n                    ff=1;\n\n                    break;\n\n                }\n\n            }\n\n            if(ff==1)\n\n                break;\n\n        }\n\n    }\n\n    int flag=0;\n\n    for(int i=1;i<=3;i++)\n\n    {\n\n        if(b[i][1]==1&&b[i][2]==1&&b[i][3]==1)\n\n        {flag=1;break;}\n\n        if(b[1][i]==1&&b[2][i]==1&&b[3][i]==1)\n\n        {flag=1;break;}\n\n    }\n\n    if(b[1][1]==1&&b[2][2]==1&&b[3][3]==1)\n\n        flag=1;\n\n    if(b[1][3]==1&&b[2][2]==1&&b[3][1]==1)\n\n        flag=1;\n\n    if(flag==1)\n\n        cout<<\"Yes\"<<endl;\n\n    else cout<<\"No\"<<endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint matrix[3][3];\n\n\tint bingo [3][3] = {0};\n\n\t\n\n\tfor(int i=0; i<3; i++){\n\n\t\tfor(int j=0; j<3; j++){\n\n\t\t\tscanf(\"%d\", &matrix[i][j]);\n\n\t\t}\n\n\t}\n\n\t\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\t\n\n\tfor(int k=0; k<N; k++){\n\n\t\tint a;\n\n\t\tscanf(\"%d\", &a);\n\n\t\tfor(int i= 0; i<3; i++){\n\n\t\t\tfor(int j = 0; j<3; j++){\n\n\t\t\t\tif(matrix[i][j] == a){\n\n\t\t\t\t\tbingo[i][j] = 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t\n\n\tif(bingo[0][0] + bingo[1][1] + bingo[2][2] == 3 || bingo[0][2] +bingo[1][1] +bingo[2][0] == 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}for(int i = 0; i < 3;i++){\n\n\tif(bingo[i][0]+bingo[i][1]+bingo[i][2]==3||bingo[0][i]+bingo[1][i]+bingo[2][i]== 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}\n\n}\n\nprintf(\"No\\n\");\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "990",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\nusing namespace std;\n\nint a[5][5];\n\nint b[15];\n\nint ans=0,t=0,teil=0,head=0;\n\nint main()\n\n{\n\n\tint n;\n\n\tfor(int i=1;i<=3;i++)\n\n\t{\n\n\t\tfor(int j=1;j<=3;j++)\n\n\t\t{\n\n\t\t\tcin>>a[i][j];\n\n\t\t}\n\n\t}\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>b[i];\n\n\t}\n\n\tfor(int i=1;i<=3;i++)\n\n\t{\n\n\t\tans=0;\n\n\t\tt=0;\n\n\t\tfor(int j=1;j<=3;j++)\n\n\t\t{\n\n\t\t\tfor(int k=1;k<=n;k++)\n\n\t\t\t{\n\n\t\t\t\tif(a[i][j]==b[k])\n\n\t\t\t\t{\n\n\t\t\t\t\tans++;\n\n\t\t\t\t}\n\n\t\t\t\tif(a[j][i]==b[k])\n\n\t\t\t\t{\n\n\t\t\t\t\tt++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif(ans==3||t==3) break;\n\n\t}\n\n\tfor(int i=1;i<=3;i++)\n\n\t{\n\n\t\tfor(int j=1;j<=n;j++)\n\n\t\t{\n\n\t\t\tif(a[i][i]==b[j])\n\n\t\t\t{\n\n\t\t\t\tteil++;\n\n\t\t\t}\n\n\t\t\tif(a[4-i][i]==b[j])\n\n\t\t\t{\n\n\t\t\t\thead++;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tif(teil==3||head==3||ans==3||t==3) cout<<\"Yes\"<<endl;\n\n\telse cout<<\"No\"<<endl;\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint matrix[3][3];\n\n\tint bingo [3][3] = {0};\n\n\t\n\n\tfor(int i=0; i<3; i++){\n\n\t\tfor(int j=0; j<3; j++){\n\n\t\t\tscanf(\"%d\", &matrix[i][j]);\n\n\t\t}\n\n\t}\n\n\t\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\t\n\n\tfor(int k=0; k<N; k++){\n\n\t\tint a;\n\n\t\tscanf(\"%d\", &a);\n\n\t\tfor(int i= 0; i<3; i++){\n\n\t\t\tfor(int j = 0; j<3; j++){\n\n\t\t\t\tif(matrix[i][j] == a){\n\n\t\t\t\t\tbingo[i][j] = 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t\n\n\tif(bingo[0][0] + bingo[1][1] + bingo[2][2] == 3 || bingo[0][2] +bingo[1][1] +bingo[2][0] == 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}for(int i = 0; i < 3;i++){\n\n\tif(bingo[i][0]+bingo[i][1]+bingo[i][2]==3||bingo[0][i]+bingo[1][i]+bingo[2][i]== 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}\n\n}\n\nprintf(\"No\\n\");\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "991",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\n    int arr[3][3];\n\n    for (int i=0;i<3;i++){\n\n        for (int j=0;j<3;j++){\n\n            cin>>arr[i][j];\n\n        }\n\n    }\n\n    int t,stop=0,win=0;\n\n    cin>>t;\n\n    for (int k=0;k<t;k++){\n\n        int b;\n\n        cin>>b;\n\n    for (int i=0;i<3;i++){\n\n        for (int j=0;j<3;j++){\n\n            if (arr[i][j]==b)\n\n                arr[i][j]=-1;\n\n            }\n\n        }\n\n    }\n\n        for (int i=0;i<3;i++){\n\n        if (arr[i][0]==arr[i][1] and arr[i][1]==arr[i][2] and arr[i][2]==-1)\n\n            win =1;\n\n        else if (arr[0][i]==arr[1][i] and arr[1][i]==arr[2][i] and arr[2][i]==-1)\n\n            win =1;\n\n     }\n\n    if (arr[0][0]==arr[1][1] and arr[1][1]==arr[2][2] and arr[2][2]==-1)\n\n            win=1;\n\n    if (arr[0][2]==arr[1][1] and arr[1][1]==arr[2][0] and arr[2][0]==-1)\n\n            win=1;\n\n    if (win){\n\n         cout<<\"Yes\";\n\n         return 0;\n\n    }\n\n    cout<<\"No\"<<endl;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main(){\n\n\t\n\n\tint matrix[3][3];\n\n\tint bingo [3][3] = {0};\n\n\t\n\n\tfor(int i=0; i<3; i++){\n\n\t\tfor(int j=0; j<3; j++){\n\n\t\t\tscanf(\"%d\", &matrix[i][j]);\n\n\t\t}\n\n\t}\n\n\t\n\n\tint N;\n\n\tscanf(\"%d\", &N);\n\n\t\n\n\tfor(int k=0; k<N; k++){\n\n\t\tint a;\n\n\t\tscanf(\"%d\", &a);\n\n\t\tfor(int i= 0; i<3; i++){\n\n\t\t\tfor(int j = 0; j<3; j++){\n\n\t\t\t\tif(matrix[i][j] == a){\n\n\t\t\t\t\tbingo[i][j] = 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t\n\n\tif(bingo[0][0] + bingo[1][1] + bingo[2][2] == 3 || bingo[0][2] +bingo[1][1] +bingo[2][0] == 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}for(int i = 0; i < 3;i++){\n\n\tif(bingo[i][0]+bingo[i][1]+bingo[i][2]==3||bingo[0][i]+bingo[1][i]+bingo[2][i]== 3){\n\n\t\tprintf(\"Yes\\n\");\n\n\t\treturn 0;\n\n\t}\n\n}\n\nprintf(\"No\\n\");\t\n\n\treturn 0;\n\n}"
    },
    {
        "id": "992",
        "source_code": "#include <cstdio>\n\n#include <queue>\n\n#include <cmath>\n\n#include <algorithm>\n\n#include <iostream>\n\n#include <set>\n\n#include <map>\n\n#include <string>\n\n#include <algorithm>\n\nusing namespace std;\n\n#include <string>\n\n#include <cstdio>\n\n#define ll long long\n\n#define TLE std::ios::sync_with_stdio(false);cin.tie(NULL);cout.tie(NULL);\n\ntypedef pair<int,int> pii;\n\nconst ll mod = 1000000007 ;\n\nconst int INF=0x3f3f3f3f;\n\n#define test(n) cout<<\"Test \"<<n<<endl;\n\n#define pb push_back\n\n#define rp(n) for(int i=1;i<=n;i++)\n\n#define rep(n,m) for(int i=1;i<=n;i++) for(int j=1;j<=m;j++)\n\nll ksm(ll x,ll n){ll ans=1;while (n){if (n&1)ans=(ans*x)%mod;x=x*x%mod;n>>=1;}return ans;}\n\nusing namespace std;\n\ndouble pi = atan(1.0)*4 ;\n\nconst int mxn = 1e3+7 ;\n\nint n,t,m,k,l,r;\n\n/// ll mat[mxn][mxn], prime[mxn], isprime[mxn];\n\nll phi[mxn];\n\nstring str;char ch[27][27] ;\n\nint a[mxn][mxn];\n\nll exgcd(ll a,ll b, ll &x ,ll &y)\n\n{\n\n    if(!a&&!b) return -1;/// \u65e0\u6700\u5927\u516c\u7ea6\u6570\n\n    if(!b) {x=1,y=0;return a;}\n\n    ll d=exgcd(b,a%b,y,x);\n\n    y-=a/b*x ;\n\n    return d;\n\n}\n\nint vis[mxn][mxn];\n\nint main()\n\n{\n\n\n\n    rep(3,3) vis[i][j] = 0 ;\n\n    map<int,pair<int,int> >mp;\n\n    rep(3,3) {cin>>a[i][j];mp[ a[i][j] ] = {i,j} ;}\n\n    cin>>n;\n\n    rp(n){ cin>>k;pair<int,int>tmp = mp[k];\n\n\n\n    if(mp.find(k)!=mp.end() && tmp.first<=3 && tmp.second<=3 && tmp.first>0 && tmp.second>0)\n\n        vis[ tmp.first ][ tmp.second ] = 1 ;\n\n    }\n\n    int f1 = 0 ;\n\n    for(int i=1;i<=3;i++)\n\n    {\n\n        int ans = 0 ;\n\n        for(int j=1;j<=3;j++)\n\n            if(vis[i][j]==1)\n\n                ans++;\n\n        if(ans==3) {cout<<\"Yes\"<<endl;f1=1;break;}\n\n    }\n\n    if(!f1)\n\n    {\n\n        if(vis[1][1]&&vis[2][2]&&vis[3][3] || vis[1][3]&&vis[2][2]&&vis[3][1])\n\n            {cout<<\"Yes\"<<endl;f1=1;}\n\n    }\n\n    if(!f1)\n\n    {\n\n        for(int i=1;i<=3;i++)\n\n        {\n\n            int ans = 0 ;\n\n            for(int j=1;j<=3;j++)\n\n                if(vis[j][i]==1)\n\n                    ans++;\n\n            if(ans==3) {cout<<\"Yes\"<<endl;f1=1;break;}\n\n        }\n\n    }\n\n    if(!f1) cout<<\"No\"<<endl;\n\n}\n\n\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint trix1[4][4], Zx, Xy;\n\n\t\tfor (int u = 0; u < 3; u++) {\n\n\t\t\tfor (int i = 0; i < 3; i++) {\n\n\t\t\t\tscanf(\"%d\", &trix1[u][i]);\n\n\t\t\t}\n\n\t\t}\n\n\t\tint trix2[4][4] = {};\n\n\t\tscanf(\"%d\", &Zx);\n\n\t\tfor(int o = 0; o < Zx; o++) {\n\n\t\t\tscanf(\"%d\", &Xy);\n\n\t\t\tfor (int u = 0; u < 3; u++) {\n\n\t\t\t\tfor (int i = 0; i < 3; i++) {\n\n\t\t\t\t\tif (Xy == trix1[u][i]) {\n\n\t\t\t\t\t\ttrix2[u][i]++;\n\n\t\t\t\t\t  \tif ((trix2[0][0] > 0 && trix2[0][1] > 0 && trix2[0][2] > 0) || (trix2[1][0] > 0 && trix2[1][1] > 0 && trix2[1][2] > 0) || (trix2[2][0] > 0 && trix2[2][1] > 0 && trix2[2][2] > 0) || (trix2[0][0] > 0 && trix2[1][0] > 0 && trix2[2][0] > 0) || (trix2[0][1] > 0 && trix2[1][1] > 0 && trix2[2][1] > 0) || (trix2[0][2] > 0 && trix2[1][2] > 0 && trix2[2][2] > 0) || (trix2[0][2] > 0 && trix2[1][1] > 0 && trix2[2][0] > 0) || (trix2[0][0] > 0 && trix2[1][1] > 0 && trix2[2][2] > 0)) {\n\n\t\t\t\t\t  \t\tprintf(\"Yes\\n\");\n\n\t\t\t\t\t  \t\treturn 0;\n\n\t\t\t\t\t  \t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\tprintf(\"No\\n\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "993",
        "source_code": "#include<iostream>\n\n#include<cstdio>\n\n#include<cstring>\n\n#include<string>\n\n#include<algorithm>\n\n#include<queue>\n\n#include<stack>\n\n#include<vector>\n\n#include<set>\n\n#include<map>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint main()\n\n{\n\n    int s[5][5];\n\n    for(int i=1; i<=3; i++)\n\n    {\n\n        for(int j=1; j<=3; j++)\n\n        {\n\n            cin>>s[i][j];\n\n        }\n\n    }\n\n    int n;\n\n    int b[5][5]= {0};\n\n    cin>>n;\n\n    while(n--)\n\n    {\n\n        int x;\n\n        cin>>x;\n\n        for(int i=1; i<=3; i++)\n\n        {\n\n            int ff=0;\n\n            for(int j=1; j<=3; j++)\n\n            {\n\n                if(s[i][j]==x&&b[i][j]==0)\n\n                {\n\n                    b[i][j]=1;\n\n                    ff=1;\n\n                    break;\n\n                }\n\n            }\n\n            if(ff==1)\n\n                break;\n\n        }\n\n    }\n\n    int flag=0;\n\n    for(int i=1;i<=3;i++)\n\n    {\n\n        if(b[i][1]==1&&b[i][2]==1&&b[i][3]==1)\n\n        {flag=1;break;}\n\n        if(b[1][i]==1&&b[2][i]==1&&b[3][i]==1)\n\n        {flag=1;break;}\n\n    }\n\n    if(b[1][1]==1&&b[2][2]==1&&b[3][3]==1)\n\n        flag=1;\n\n    if(b[1][3]==1&&b[2][2]==1&&b[3][1]==1)\n\n        flag=1;\n\n    if(flag==1)\n\n        cout<<\"Yes\"<<endl;\n\n    else cout<<\"No\"<<endl;\n\n    return 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint trix1[4][4], Zx, Xy;\n\n\t\tfor (int u = 0; u < 3; u++) {\n\n\t\t\tfor (int i = 0; i < 3; i++) {\n\n\t\t\t\tscanf(\"%d\", &trix1[u][i]);\n\n\t\t\t}\n\n\t\t}\n\n\t\tint trix2[4][4] = {};\n\n\t\tscanf(\"%d\", &Zx);\n\n\t\tfor(int o = 0; o < Zx; o++) {\n\n\t\t\tscanf(\"%d\", &Xy);\n\n\t\t\tfor (int u = 0; u < 3; u++) {\n\n\t\t\t\tfor (int i = 0; i < 3; i++) {\n\n\t\t\t\t\tif (Xy == trix1[u][i]) {\n\n\t\t\t\t\t\ttrix2[u][i]++;\n\n\t\t\t\t\t  \tif ((trix2[0][0] > 0 && trix2[0][1] > 0 && trix2[0][2] > 0) || (trix2[1][0] > 0 && trix2[1][1] > 0 && trix2[1][2] > 0) || (trix2[2][0] > 0 && trix2[2][1] > 0 && trix2[2][2] > 0) || (trix2[0][0] > 0 && trix2[1][0] > 0 && trix2[2][0] > 0) || (trix2[0][1] > 0 && trix2[1][1] > 0 && trix2[2][1] > 0) || (trix2[0][2] > 0 && trix2[1][2] > 0 && trix2[2][2] > 0) || (trix2[0][2] > 0 && trix2[1][1] > 0 && trix2[2][0] > 0) || (trix2[0][0] > 0 && trix2[1][1] > 0 && trix2[2][2] > 0)) {\n\n\t\t\t\t\t  \t\tprintf(\"Yes\\n\");\n\n\t\t\t\t\t  \t\treturn 0;\n\n\t\t\t\t\t  \t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\tprintf(\"No\\n\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "994",
        "source_code": "#include<iostream>\n\n#include<algorithm>\n\nusing namespace std;\n\nint a[5][5];\n\nint b[15];\n\nint ans=0,t=0,teil=0,head=0;\n\nint main()\n\n{\n\n\tint n;\n\n\tfor(int i=1;i<=3;i++)\n\n\t{\n\n\t\tfor(int j=1;j<=3;j++)\n\n\t\t{\n\n\t\t\tcin>>a[i][j];\n\n\t\t}\n\n\t}\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\n\t{\n\n\t\tcin>>b[i];\n\n\t}\n\n\tfor(int i=1;i<=3;i++)\n\n\t{\n\n\t\tans=0;\n\n\t\tt=0;\n\n\t\tfor(int j=1;j<=3;j++)\n\n\t\t{\n\n\t\t\tfor(int k=1;k<=n;k++)\n\n\t\t\t{\n\n\t\t\t\tif(a[i][j]==b[k])\n\n\t\t\t\t{\n\n\t\t\t\t\tans++;\n\n\t\t\t\t}\n\n\t\t\t\tif(a[j][i]==b[k])\n\n\t\t\t\t{\n\n\t\t\t\t\tt++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif(ans==3||t==3) break;\n\n\t}\n\n\tfor(int i=1;i<=3;i++)\n\n\t{\n\n\t\tfor(int j=1;j<=n;j++)\n\n\t\t{\n\n\t\t\tif(a[i][i]==b[j])\n\n\t\t\t{\n\n\t\t\t\tteil++;\n\n\t\t\t}\n\n\t\t\tif(a[4-i][i]==b[j])\n\n\t\t\t{\n\n\t\t\t\thead++;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tif(teil==3||head==3||ans==3||t==3) cout<<\"Yes\"<<endl;\n\n\telse cout<<\"No\"<<endl;\n\n\treturn 0;\n\n}\n",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint trix1[4][4], Zx, Xy;\n\n\t\tfor (int u = 0; u < 3; u++) {\n\n\t\t\tfor (int i = 0; i < 3; i++) {\n\n\t\t\t\tscanf(\"%d\", &trix1[u][i]);\n\n\t\t\t}\n\n\t\t}\n\n\t\tint trix2[4][4] = {};\n\n\t\tscanf(\"%d\", &Zx);\n\n\t\tfor(int o = 0; o < Zx; o++) {\n\n\t\t\tscanf(\"%d\", &Xy);\n\n\t\t\tfor (int u = 0; u < 3; u++) {\n\n\t\t\t\tfor (int i = 0; i < 3; i++) {\n\n\t\t\t\t\tif (Xy == trix1[u][i]) {\n\n\t\t\t\t\t\ttrix2[u][i]++;\n\n\t\t\t\t\t  \tif ((trix2[0][0] > 0 && trix2[0][1] > 0 && trix2[0][2] > 0) || (trix2[1][0] > 0 && trix2[1][1] > 0 && trix2[1][2] > 0) || (trix2[2][0] > 0 && trix2[2][1] > 0 && trix2[2][2] > 0) || (trix2[0][0] > 0 && trix2[1][0] > 0 && trix2[2][0] > 0) || (trix2[0][1] > 0 && trix2[1][1] > 0 && trix2[2][1] > 0) || (trix2[0][2] > 0 && trix2[1][2] > 0 && trix2[2][2] > 0) || (trix2[0][2] > 0 && trix2[1][1] > 0 && trix2[2][0] > 0) || (trix2[0][0] > 0 && trix2[1][1] > 0 && trix2[2][2] > 0)) {\n\n\t\t\t\t\t  \t\tprintf(\"Yes\\n\");\n\n\t\t\t\t\t  \t\treturn 0;\n\n\t\t\t\t\t  \t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\tprintf(\"No\\n\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "995",
        "source_code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\n    int arr[3][3];\n\n    for (int i=0;i<3;i++){\n\n        for (int j=0;j<3;j++){\n\n            cin>>arr[i][j];\n\n        }\n\n    }\n\n    int t,stop=0,win=0;\n\n    cin>>t;\n\n    for (int k=0;k<t;k++){\n\n        int b;\n\n        cin>>b;\n\n    for (int i=0;i<3;i++){\n\n        for (int j=0;j<3;j++){\n\n            if (arr[i][j]==b)\n\n                arr[i][j]=-1;\n\n            }\n\n        }\n\n    }\n\n        for (int i=0;i<3;i++){\n\n        if (arr[i][0]==arr[i][1] and arr[i][1]==arr[i][2] and arr[i][2]==-1)\n\n            win =1;\n\n        else if (arr[0][i]==arr[1][i] and arr[1][i]==arr[2][i] and arr[2][i]==-1)\n\n            win =1;\n\n     }\n\n    if (arr[0][0]==arr[1][1] and arr[1][1]==arr[2][2] and arr[2][2]==-1)\n\n            win=1;\n\n    if (arr[0][2]==arr[1][1] and arr[1][1]==arr[2][0] and arr[2][0]==-1)\n\n            win=1;\n\n    if (win){\n\n         cout<<\"Yes\";\n\n         return 0;\n\n    }\n\n    cout<<\"No\"<<endl;\n\n}",
        "optimized_code": "#include <stdio.h>\n\n\n\nint main() {\n\n\tint trix1[4][4], Zx, Xy;\n\n\t\tfor (int u = 0; u < 3; u++) {\n\n\t\t\tfor (int i = 0; i < 3; i++) {\n\n\t\t\t\tscanf(\"%d\", &trix1[u][i]);\n\n\t\t\t}\n\n\t\t}\n\n\t\tint trix2[4][4] = {};\n\n\t\tscanf(\"%d\", &Zx);\n\n\t\tfor(int o = 0; o < Zx; o++) {\n\n\t\t\tscanf(\"%d\", &Xy);\n\n\t\t\tfor (int u = 0; u < 3; u++) {\n\n\t\t\t\tfor (int i = 0; i < 3; i++) {\n\n\t\t\t\t\tif (Xy == trix1[u][i]) {\n\n\t\t\t\t\t\ttrix2[u][i]++;\n\n\t\t\t\t\t  \tif ((trix2[0][0] > 0 && trix2[0][1] > 0 && trix2[0][2] > 0) || (trix2[1][0] > 0 && trix2[1][1] > 0 && trix2[1][2] > 0) || (trix2[2][0] > 0 && trix2[2][1] > 0 && trix2[2][2] > 0) || (trix2[0][0] > 0 && trix2[1][0] > 0 && trix2[2][0] > 0) || (trix2[0][1] > 0 && trix2[1][1] > 0 && trix2[2][1] > 0) || (trix2[0][2] > 0 && trix2[1][2] > 0 && trix2[2][2] > 0) || (trix2[0][2] > 0 && trix2[1][1] > 0 && trix2[2][0] > 0) || (trix2[0][0] > 0 && trix2[1][1] > 0 && trix2[2][2] > 0)) {\n\n\t\t\t\t\t  \t\tprintf(\"Yes\\n\");\n\n\t\t\t\t\t  \t\treturn 0;\n\n\t\t\t\t\t  \t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\tprintf(\"No\\n\");\n\n\treturn 0;\n\n}"
    },
    {
        "id": "1000",
        "source_code": "#define _USE_MATH_DEFINES\n\n\n\n#include <iostream>\n\n#include <math.h> \n\n#include <vector>\n\n#include <algorithm>\n\n#include <iomanip>      // std::setprecision\n\n#include <map>\n\n#include <unordered_map>\n\n#include <string>\n\n#include <set>\n\n#include <unordered_set>\n\n#include <sstream>\n\n\n\nusing namespace std;\n\n\n\nint main()\n\n{\n\n\tint N;\n\n\tstd::set<int> nums;\n\n\tvector<vector<int>> card(3,std::vector<int>(3,0));\n\n\tfor (int i = 0; i < 3; ++i)\n\n\t{\n\n\t\tfor (int j = 0; j < 3; ++j)\n\n\t\t{\n\n\t\t\tint input;\n\n\t\t\tstd::cin >> input;\n\n\t\t\tcard[i][j] = input;\n\n\t\t}\n\n\t}\n\n\n\n\tstd::cin >> N;\n\n\tfor (int k = 0; k < N; ++k)\n\n\t{\n\n\t\tint num;\n\n\t\tstd::cin >> num;\n\n\t\tnums.insert(num);\n\n\t}\n\n\t//check rows\n\n\tfor (int i = 0; i < 3; ++i)\n\n\t{\n\n\t\tint counter = 0;\n\n\t\tfor (int j = 0; j < 3; ++j)\n\n\t\t{\n\n\t\t\tif (nums.find(card[i][j]) != nums.end())\n\n\t\t\t{\n\n\t\t\t\tcounter++;\n\n\t\t\t}\n\n\t\t\telse\n\n\t\t\t{\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif (counter == 3)\n\n\t\t{\n\n\t\t\tstd::cout << \"Yes\\n\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\t//check columns\n\n\tfor (int i = 0; i < 3; ++i)\n\n\t{\n\n\t\tint counter = 0;\n\n\t\tfor (int j = 0; j < 3; ++j)\n\n\t\t{\n\n\t\t\tif (nums.find(card[j][i]) != nums.end())\n\n\t\t\t{\n\n\t\t\t\tcounter++;\n\n\t\t\t}\n\n\t\t\telse\n\n\t\t\t{\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif (counter == 3)\n\n\t\t{\n\n\t\t\tstd::cout << \"Yes\\n\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\n\n\t\tint counter = 0;\n\n\t\tfor (int j = 0; j < 3; ++j)\n\n\t\t{\n\n\t\t\tif (nums.find(card[j][j]) != nums.end())\n\n\t\t\t{\n\n\t\t\t\tcounter++;\n\n\t\t\t}\n\n\t\t\telse\n\n\t\t\t{\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif (counter == 3)\n\n\t\t{\n\n\t\t\tstd::cout << \"Yes\\n\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tcounter = 0;\n\n\t\tfor (int j = 0; j < 3; ++j)\n\n\t\t{\n\n\t\t\tif (nums.find(card[j][2-j]) != nums.end())\n\n\t\t\t{\n\n\t\t\t\tcounter++;\n\n\t\t\t}\n\n\t\t\telse\n\n\t\t\t{\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif (counter == 3)\n\n\t\t{\n\n\t\t\tstd::cout << \"Yes\\n\";\n\n\t\t\treturn 0;\n\n\t\t}\n\n\tstd::cout << \"No\\n\";\n\n\n\n}\n",
        "optimized_code": "#include<stdio.h>\n\n\n\nint main(){\n\n\tint n[3][3];\n\n\tint bing[9];\n\n\tint ctr[3][3]={0};\n\n\tfor(int i=0; i<3; i++){\n\n\t\tfor(int j=0; j<3; j++){\n\n\t\t\tscanf(\"%d\", &n[i][j]);\n\n\t\t}\n\n\t}\n\n\tint tc;\n\n\tscanf(\"%d\", &tc);\n\n\tfor(int i; i<tc; i++){\n\n\t\tscanf(\"%d\", &bing[i]);\n\n\t\tif(bing[i] == n[0][0]){\n\n\t\t\tctr[0][0]++;\n\n\t\t}\n\n\t\telse if(bing[i] == n[0][1]){\n\n\t\t\tctr[0][1]++;\n\n\t\t}\n\n\t\telse if(bing[i] == n[0][2]){\n\n\t\t\tctr[0][2]++;\n\n\t\t}\n\n\t\telse if(bing[i] == n[1][0]){\n\n\t\t\tctr[1][0]++;\n\n\t\t}\n\n\t\telse if(bing[i] == n[1][1]){\n\n\t\t\tctr[1][1]++;\n\n\t\t}\n\n\t\telse if(bing[i] == n[1][2]){\n\n\t\t\tctr[1][2]++;\n\n\t\t}\n\n\t\telse if(bing[i] == n[2][0]){\n\n\t\t\tctr[2][0]++;\n\n\t\t}\n\n\t\telse if(bing[i] == n[2][1]){\n\n\t\t\tctr[2][1]++;\n\n\t\t}\n\n\t\telse if(bing[i] == n[2][2]){\n\n\t\t\tctr[2][2]++;\n\n\t\t}\n\n\t}\n\n\tif(ctr[0][0]>0 && ctr[0][1]>0 && ctr[0][2]>0){\n\n\t\tprintf(\"Yes\\n\");\n\n\t}\n\n\telse if(ctr[1][0]>0 && ctr[1][1]>0 && ctr[1][2]>0){\n\n\t\tprintf(\"Yes\\n\");\n\n\t}\n\n\telse if(ctr[2][0]>0 && ctr[2][1]>0 && ctr[2][2]>0){\n\n\t\tprintf(\"Yes\\n\");\n\n\t}\n\n\telse if(ctr[0][0]>0 && ctr[1][0]>0 && ctr[2][0]>0){\n\n\t\tprintf(\"Yes\\n\");\n\n\t}\n\n\telse if(ctr[0][1]>0 && ctr[1][1]>0 && ctr[2][1]>0){\n\n\t\tprintf(\"Yes\\n\");\n\n\t}\n\n\telse if(ctr[0][2]>0 && ctr[1][2]>0 && ctr[2][2]>0){\n\n\t\tprintf(\"Yes\\n\");\n\n\t}\n\n\telse if(ctr[0][0]>0 && ctr[1][1]>0 && ctr[2][2]>0){\n\n\t\tprintf(\"Yes\\n\");\n\n\t}\n\n\telse if(ctr[0][2]>0 && ctr[1][1]>0 && ctr[2][0]>0){\n\n\t\tprintf(\"Yes\\n\");\n\n\t}\n\n\telse{\n\n\t\tprintf(\"No\\n\");\n\n\t}\n\n\treturn 0;\n\n}"
    }
]